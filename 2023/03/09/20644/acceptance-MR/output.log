rm: cannot remove '/home/runner/work/ozone/ozone/hadoop-ozone/dist/target/ozone-1.4.0-SNAPSHOT/compose/result/*': No such file or directory
Executing test in ozone-mr
rm: cannot remove '/home/runner/work/ozone/ozone/hadoop-ozone/dist/target/ozone-1.4.0-SNAPSHOT/compose/ozone-mr/result/*': No such file or directory
Executing test in hadoop27
Removing network hadoop27_default
Network hadoop27_default not found.
Creating network "hadoop27_default" with the default driver
Pulling datanode (apache/ozone-runner:20230104-1)...
20230104-1: Pulling from apache/ozone-runner
Digest: sha256:bc4c3ecdf9e653e2287e8b99449222807ee6011b520beae9a8874d9b8fc037f3
Status: Downloaded newer image for apache/ozone-runner:20230104-1
Pulling rm (flokkr/hadoop:2.7.3)...
2.7.3: Pulling from flokkr/hadoop
Digest: sha256:e791dc9bfa858e24443e1f1d70bfacf8382e0b8b9c4063fee38a460c26967b8e
Status: Downloaded newer image for flokkr/hadoop:2.7.3
Creating hadoop27_s3g_1 ... 
Creating hadoop27_datanode_1 ... 
Creating hadoop27_datanode_2 ... 
Creating hadoop27_rm_1       ... 
Creating hadoop27_scm_1      ... 
Creating hadoop27_datanode_3 ... 
Creating hadoop27_nm_1       ... 
Creating hadoop27_om_1       ... 
Creating hadoop27_rm_1       ... done
Creating hadoop27_datanode_2 ... done
Creating hadoop27_s3g_1      ... done
Creating hadoop27_nm_1       ... done
Creating hadoop27_datanode_3 ... done
Creating hadoop27_om_1       ... done
Creating hadoop27_datanode_1 ... done
Creating hadoop27_scm_1      ... done
SECONDS: 50
com.google.protobuf.ServiceException: java.net.ConnectException: Call From scm/172.18.0.7 to scm:9860 failed on connection exception: java.net.ConnectException: Connection refused; For more details see: http://wiki.apache.org/hadoop/ConnectionRefused, while invoking $Proxy19.submitRequest over nodeId=scmNodeId,nodeAddress=scm/172.18.0.7:9860 after 1 failover attempts. Trying to failover after sleeping for 2000ms. com.google.protobuf.ServiceException: java.net.ConnectException: Call From scm/172.18.0.7 to scm:9860 failed on connection exception: java.net.ConnectException: Connection refused; For more details see: http://wiki.apache.org/hadoop/ConnectionRefused, while invoking $Proxy19.submitRequest over nodeId=scmNodeId,nodeAddress=scm/172.18.0.7:9860 after 2 failover attempts. Trying to failover after sleeping for 2000ms. com.google.protobuf.ServiceException: org.apache.hadoop.ipc.RemoteException(org.apache.hadoop.hdds.ratis.ServerNotLeaderException): Server:79e29d7f-fb48-4da7-87dc-f5f116b383b0 is not the leader. Could not determine the leader node. at org.apache.hadoop.hdds.ratis.ServerNotLeaderException.convertToNotLeaderException(ServerNotLeaderException.java:109) at org.apache.hadoop.hdds.scm.ha.RatisUtil.checkRatisException(RatisUtil.java:246) at org.apache.hadoop.hdds.scm.protocol.StorageContainerLocationProtocolServerSideTranslatorPB.submitRequest(StorageContainerLocationProtocolServerSideTranslatorPB.java:197) at org.apache.hadoop.hdds.protocol.proto.StorageContainerLocationProtocolProtos$StorageContainerLocationProtocolService$2.callBlockingMethod(StorageContainerLocationProtocolProtos.java:64993) at org.apache.hadoop.ipc.ProtobufRpcEngine$Server.processCall(ProtobufRpcEngine.java:465) at org.apache.hadoop.ipc.ProtobufRpcEngine2$Server$ProtoBufRpcInvoker.call(ProtobufRpcEngine2.java:578) at org.apache.hadoop.ipc.ProtobufRpcEngine2$Server$ProtoBufRpcInvoker.call(ProtobufRpcEngine2.java:556) at org.apache.hadoop.ipc.RPC$Server.call(RPC.java:1093) at org.apache.hadoop.ipc.Server$RpcCall.run(Server.java:1043) at org.apache.hadoop.ipc.Server$RpcCall.run(Server.java:971) at java.base/java.security.AccessController.doPrivileged(Native Method) at java.base/javax.security.auth.Subject.doAs(Subject.java:423) at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1878) at org.apache.hadoop.ipc.Server$Handler.run(Server.java:2976) , while invoking $Proxy19.submitRequest over nodeId=scmNodeId,nodeAddress=scm/172.18.0.7:9860 after 3 failover attempts. Trying to failover after sleeping for 2000ms. com.google.protobuf.ServiceException: org.apache.hadoop.ipc.RemoteException(org.apache.hadoop.hdds.ratis.ServerNotLeaderException): Server:79e29d7f-fb48-4da7-87dc-f5f116b383b0 is not the leader. Could not determine the leader node. at org.apache.hadoop.hdds.ratis.ServerNotLeaderException.convertToNotLeaderException(ServerNotLeaderException.java:109) at org.apache.hadoop.hdds.scm.ha.RatisUtil.checkRatisException(RatisUtil.java:246) at org.apache.hadoop.hdds.scm.protocol.StorageContainerLocationProtocolServerSideTranslatorPB.submitRequest(StorageContainerLocationProtocolServerSideTranslatorPB.java:197) at org.apache.hadoop.hdds.protocol.proto.StorageContainerLocationProtocolProtos$StorageContainerLocationProtocolService$2.callBlockingMethod(StorageContainerLocationProtocolProtos.java:64993) at org.apache.hadoop.ipc.ProtobufRpcEngine$Server.processCall(ProtobufRpcEngine.java:465) at org.apache.hadoop.ipc.ProtobufRpcEngine2$Server$ProtoBufRpcInvoker.call(ProtobufRpcEngine2.java:578) at org.apache.hadoop.ipc.ProtobufRpcEngine2$Server$ProtoBufRpcInvoker.call(ProtobufRpcEngine2.java:556) at org.apache.hadoop.ipc.RPC$Server.call(RPC.java:1093) at org.apache.hadoop.ipc.Server$RpcCall.run(Server.java:1043) at org.apache.hadoop.ipc.Server$RpcCall.run(Server.java:971) at java.base/java.security.AccessController.doPrivileged(Native Method) at java.base/javax.security.auth.Subject.doAs(Subject.java:423) at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1878) at org.apache.hadoop.ipc.Server$Handler.run(Server.java:2976) , while invoking $Proxy19.submitRequest over nodeId=scmNodeId,nodeAddress=scm/172.18.0.7:9860 after 4 failover attempts. Trying to failover after sleeping for 2000ms. com.google.protobuf.ServiceException: org.apache.hadoop.ipc.RemoteException(org.apache.hadoop.hdds.ratis.ServerNotLeaderException): Server:79e29d7f-fb48-4da7-87dc-f5f116b383b0 is not the leader. Could not determine the leader node. at org.apache.hadoop.hdds.ratis.ServerNotLeaderException.convertToNotLeaderException(ServerNotLeaderException.java:109) at org.apache.hadoop.hdds.scm.ha.RatisUtil.checkRatisException(RatisUtil.java:246) at org.apache.hadoop.hdds.scm.protocol.StorageContainerLocationProtocolServerSideTranslatorPB.submitRequest(StorageContainerLocationProtocolServerSideTranslatorPB.java:197) at org.apache.hadoop.hdds.protocol.proto.StorageContainerLocationProtocolProtos$StorageContainerLocationProtocolService$2.callBlockingMethod(StorageContainerLocationProtocolProtos.java:64993) at org.apache.hadoop.ipc.ProtobufRpcEngine$Server.processCall(ProtobufRpcEngine.java:465) at org.apache.hadoop.ipc.ProtobufRpcEngine2$Server$ProtoBufRpcInvoker.call(ProtobufRpcEngine2.java:578) at org.apache.hadoop.ipc.ProtobufRpcEngine2$Server$ProtoBufRpcInvoker.call(ProtobufRpcEngine2.java:556) at org.apache.hadoop.ipc.RPC$Server.call(RPC.java:1093) at org.apache.hadoop.ipc.Server$RpcCall.run(Server.java:1043) at org.apache.hadoop.ipc.Server$RpcCall.run(Server.java:971) at java.base/java.security.AccessController.doPrivileged(Native Method) at java.base/javax.security.auth.Subject.doAs(Subject.java:423) at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1878) at org.apache.hadoop.ipc.Server$Handler.run(Server.java:2976) , while invoking $Proxy19.submitRequest over nodeId=scmNodeId,nodeAddress=scm/172.18.0.7:9860 after 5 failover attempts. Trying to failover after sleeping for 2000ms. SCM is in safe mode. validated:false, DataNodeSafeModeRule, registered datanodes (=2) >= required datanodes (=3) validated:false, HealthyPipelineSafeModeRule, healthy Ratis/THREE pipelines (=0) >= healthyPipelineThresholdCount (=1) validated:true, ContainerSafeModeRule, % of containers with at least one reported replica (=1.00) >= safeModeCutoff (=0.99) validated:true, AtleastOneDatanodeReportedRule, reported Ratis/THREE pipelines with at least one datanode (=0) >= threshold (=0)
SECONDS: 65
SCM is out of safe mode.
Safe mode is off
No OM HA service, no need to wait
==============================================================================
Createmrenv :: Create directories required for MR test                        
==============================================================================
Create test volume, bucket and key                                    | PASS |
------------------------------------------------------------------------------
Create user dir for hadoop                                            | PASS |
------------------------------------------------------------------------------
Createmrenv :: Create directories required for MR test                | PASS |
2 tests, 2 passed, 0 failed
==============================================================================
Output:  /tmp/smoketest/hadoop27/result/robot-hadoop27-hadoop27-createmrenv-scm.xml
==============================================================================
hadoopfs-o3fs :: Test ozone fs with hadoopfs                                  
==============================================================================
Test hadoop dfs                                                       | PASS |
------------------------------------------------------------------------------
hadoopfs-o3fs :: Test ozone fs with hadoopfs                          | PASS |
1 critical test, 1 passed, 0 failed
1 test total, 1 passed, 0 failed
==============================================================================
Output:  /tmp/smoketest/hadoop27/result/robot-hadoop27-hadoop27-createmrenv-scm-1.xml
==============================================================================
mapreduce-o3fs :: Execute MR jobs                                             
==============================================================================
Execute PI calculation                                                | PASS |
------------------------------------------------------------------------------
Execute WordCount                                                     | PASS |
------------------------------------------------------------------------------
mapreduce-o3fs :: Execute MR jobs                                     | PASS |
2 critical tests, 2 passed, 0 failed
2 tests total, 2 passed, 0 failed
==============================================================================
Output:  /tmp/smoketest/hadoop27/result/robot-hadoop27-hadoop27-createmrenv-scm-2.xml
==============================================================================
hadoopfs-ofs :: Test ozone fs with hadoopfs                                   
==============================================================================
Test hadoop dfs                                                       | PASS |
------------------------------------------------------------------------------
hadoopfs-ofs :: Test ozone fs with hadoopfs                           | PASS |
1 critical test, 1 passed, 0 failed
1 test total, 1 passed, 0 failed
==============================================================================
Output:  /tmp/smoketest/hadoop27/result/robot-hadoop27-hadoop27-createmrenv-scm-3.xml
==============================================================================
mapreduce-ofs :: Execute MR jobs                                              
==============================================================================
Execute PI calculation                                                | PASS |
------------------------------------------------------------------------------
Execute WordCount                                                     | PASS |
------------------------------------------------------------------------------
mapreduce-ofs :: Execute MR jobs                                      | PASS |
2 critical tests, 2 passed, 0 failed
2 tests total, 2 passed, 0 failed
==============================================================================
Output:  /tmp/smoketest/hadoop27/result/robot-hadoop27-hadoop27-createmrenv-scm-4.xml
Stopping hadoop27_om_1       ... 
Stopping hadoop27_datanode_1 ... 
Stopping hadoop27_scm_1      ... 
Stopping hadoop27_nm_1       ... 
Stopping hadoop27_datanode_3 ... 
Stopping hadoop27_datanode_2 ... 
Stopping hadoop27_s3g_1      ... 
Stopping hadoop27_rm_1       ... 
Stopping hadoop27_rm_1       ... done
Stopping hadoop27_nm_1       ... done
Stopping hadoop27_s3g_1      ... done
Stopping hadoop27_om_1       ... done
Stopping hadoop27_datanode_3 ... done
Stopping hadoop27_datanode_1 ... done
Stopping hadoop27_datanode_2 ... done
Stopping hadoop27_scm_1      ... done
Removing hadoop27_om_1       ... 
Removing hadoop27_datanode_1 ... 
Removing hadoop27_scm_1      ... 
Removing hadoop27_nm_1       ... 
Removing hadoop27_datanode_3 ... 
Removing hadoop27_datanode_2 ... 
Removing hadoop27_s3g_1      ... 
Removing hadoop27_rm_1       ... 
Removing hadoop27_rm_1       ... done
Removing hadoop27_scm_1      ... done
Removing hadoop27_om_1       ... done
Removing hadoop27_datanode_3 ... done
Removing hadoop27_s3g_1      ... done
Removing hadoop27_datanode_1 ... done
Removing hadoop27_datanode_2 ... done
Removing hadoop27_nm_1       ... done
Removing network hadoop27_default
Log:     /home/runner/work/ozone/ozone/hadoop-ozone/dist/target/ozone-1.4.0-SNAPSHOT/compose/ozone-mr/hadoop27/result/log.html
Report:  /home/runner/work/ozone/ozone/hadoop-ozone/dist/target/ozone-1.4.0-SNAPSHOT/compose/ozone-mr/hadoop27/result/report.html
Output:  /home/runner/work/ozone/ozone/hadoop-ozone/dist/target/ozone-1.4.0-SNAPSHOT/compose/ozone-mr/result/hadoop27.xml
removed 'hadoop27/result/robot-hadoop27-hadoop27-createmrenv-scm-1.xml'
removed 'hadoop27/result/robot-hadoop27-hadoop27-createmrenv-scm-2.xml'
removed 'hadoop27/result/robot-hadoop27-hadoop27-createmrenv-scm-3.xml'
removed 'hadoop27/result/robot-hadoop27-hadoop27-createmrenv-scm-4.xml'
removed 'hadoop27/result/robot-hadoop27-hadoop27-createmrenv-scm.xml'
removed 'hadoop27/result/log.html'
removed 'hadoop27/result/report.html'
renamed 'hadoop27/result/dn-audit-0ae83c2a69a2.log' -> '/home/runner/work/ozone/ozone/hadoop-ozone/dist/target/ozone-1.4.0-SNAPSHOT/compose/ozone-mr/result/hadoop27/dn-audit-0ae83c2a69a2.log'
renamed 'hadoop27/result/dn-audit-c18b5794c825.log' -> '/home/runner/work/ozone/ozone/hadoop-ozone/dist/target/ozone-1.4.0-SNAPSHOT/compose/ozone-mr/result/hadoop27/dn-audit-c18b5794c825.log'
renamed 'hadoop27/result/dn-audit-e7a644873fe3.log' -> '/home/runner/work/ozone/ozone/hadoop-ozone/dist/target/ozone-1.4.0-SNAPSHOT/compose/ozone-mr/result/hadoop27/dn-audit-e7a644873fe3.log'
renamed 'hadoop27/result/docker-hadoop27-hadoop27-createmrenv-scm.log' -> '/home/runner/work/ozone/ozone/hadoop-ozone/dist/target/ozone-1.4.0-SNAPSHOT/compose/ozone-mr/result/hadoop27/docker-hadoop27-hadoop27-createmrenv-scm.log'
renamed 'hadoop27/result/om-audit-om.log' -> '/home/runner/work/ozone/ozone/hadoop-ozone/dist/target/ozone-1.4.0-SNAPSHOT/compose/ozone-mr/result/hadoop27/om-audit-om.log'
renamed 'hadoop27/result/s3g-audit-s3g.log' -> '/home/runner/work/ozone/ozone/hadoop-ozone/dist/target/ozone-1.4.0-SNAPSHOT/compose/ozone-mr/result/hadoop27/s3g-audit-s3g.log'
renamed 'hadoop27/result/scm-audit-scm.log' -> '/home/runner/work/ozone/ozone/hadoop-ozone/dist/target/ozone-1.4.0-SNAPSHOT/compose/ozone-mr/result/hadoop27/scm-audit-scm.log'
Executing test in hadoop31
Removing network hadoop31_default
Network hadoop31_default not found.
Creating network "hadoop31_default" with the default driver
Pulling rm (flokkr/hadoop:3.1.2)...
3.1.2: Pulling from flokkr/hadoop
Digest: sha256:1a24784735a3f243d7c0b2d1f49e74c42bb2ae8d7fc0f24aca2c740875f379f5
Status: Downloaded newer image for flokkr/hadoop:3.1.2
Creating hadoop31_rm_1 ... 
Creating hadoop31_om_1 ... 
Creating hadoop31_s3g_1 ... 
Creating hadoop31_nm_1  ... 
Creating hadoop31_datanode_1 ... 
Creating hadoop31_datanode_2 ... 
Creating hadoop31_datanode_3 ... 
Creating hadoop31_scm_1      ... 
Creating hadoop31_rm_1       ... done
Creating hadoop31_nm_1       ... done
Creating hadoop31_datanode_1 ... done
Creating hadoop31_om_1       ... done
Creating hadoop31_datanode_3 ... done
Creating hadoop31_datanode_2 ... done
Creating hadoop31_scm_1      ... done
Creating hadoop31_s3g_1      ... done
SECONDS: 53
com.google.protobuf.ServiceException: java.net.ConnectException: Call From scm/172.19.0.8 to scm:9860 failed on connection exception: java.net.ConnectException: Connection refused; For more details see: http://wiki.apache.org/hadoop/ConnectionRefused, while invoking $Proxy19.submitRequest over nodeId=scmNodeId,nodeAddress=scm/172.19.0.8:9860 after 1 failover attempts. Trying to failover after sleeping for 2000ms. com.google.protobuf.ServiceException: java.net.ConnectException: Call From scm/172.19.0.8 to scm:9860 failed on connection exception: java.net.ConnectException: Connection refused; For more details see: http://wiki.apache.org/hadoop/ConnectionRefused, while invoking $Proxy19.submitRequest over nodeId=scmNodeId,nodeAddress=scm/172.19.0.8:9860 after 2 failover attempts. Trying to failover after sleeping for 2000ms. com.google.protobuf.ServiceException: java.net.ConnectException: Call From scm/172.19.0.8 to scm:9860 failed on connection exception: java.net.ConnectException: Connection refused; For more details see: http://wiki.apache.org/hadoop/ConnectionRefused, while invoking $Proxy19.submitRequest over nodeId=scmNodeId,nodeAddress=scm/172.19.0.8:9860 after 3 failover attempts. Trying to failover after sleeping for 2000ms. com.google.protobuf.ServiceException: org.apache.hadoop.ipc.RemoteException(org.apache.hadoop.hdds.ratis.ServerNotLeaderException): Server:e5c9474a-9d3c-4750-bd09-ecf7e656cad8 is not the leader. Could not determine the leader node. at org.apache.hadoop.hdds.ratis.ServerNotLeaderException.convertToNotLeaderException(ServerNotLeaderException.java:109) at org.apache.hadoop.hdds.scm.ha.RatisUtil.checkRatisException(RatisUtil.java:246) at org.apache.hadoop.hdds.scm.protocol.StorageContainerLocationProtocolServerSideTranslatorPB.submitRequest(StorageContainerLocationProtocolServerSideTranslatorPB.java:197) at org.apache.hadoop.hdds.protocol.proto.StorageContainerLocationProtocolProtos$StorageContainerLocationProtocolService$2.callBlockingMethod(StorageContainerLocationProtocolProtos.java:64993) at org.apache.hadoop.ipc.ProtobufRpcEngine$Server.processCall(ProtobufRpcEngine.java:465) at org.apache.hadoop.ipc.ProtobufRpcEngine2$Server$ProtoBufRpcInvoker.call(ProtobufRpcEngine2.java:578) at org.apache.hadoop.ipc.ProtobufRpcEngine2$Server$ProtoBufRpcInvoker.call(ProtobufRpcEngine2.java:556) at org.apache.hadoop.ipc.RPC$Server.call(RPC.java:1093) at org.apache.hadoop.ipc.Server$RpcCall.run(Server.java:1043) at org.apache.hadoop.ipc.Server$RpcCall.run(Server.java:971) at java.base/java.security.AccessController.doPrivileged(Native Method) at java.base/javax.security.auth.Subject.doAs(Subject.java:423) at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1878) at org.apache.hadoop.ipc.Server$Handler.run(Server.java:2976) , while invoking $Proxy19.submitRequest over nodeId=scmNodeId,nodeAddress=scm/172.19.0.8:9860 after 4 failover attempts. Trying to failover after sleeping for 2000ms. com.google.protobuf.ServiceException: org.apache.hadoop.ipc.RemoteException(org.apache.hadoop.hdds.ratis.ServerNotLeaderException): Server:e5c9474a-9d3c-4750-bd09-ecf7e656cad8 is not the leader. Could not determine the leader node. at org.apache.hadoop.hdds.ratis.ServerNotLeaderException.convertToNotLeaderException(ServerNotLeaderException.java:109) at org.apache.hadoop.hdds.scm.ha.RatisUtil.checkRatisException(RatisUtil.java:246) at org.apache.hadoop.hdds.scm.protocol.StorageContainerLocationProtocolServerSideTranslatorPB.submitRequest(StorageContainerLocationProtocolServerSideTranslatorPB.java:197) at org.apache.hadoop.hdds.protocol.proto.StorageContainerLocationProtocolProtos$StorageContainerLocationProtocolService$2.callBlockingMethod(StorageContainerLocationProtocolProtos.java:64993) at org.apache.hadoop.ipc.ProtobufRpcEngine$Server.processCall(ProtobufRpcEngine.java:465) at org.apache.hadoop.ipc.ProtobufRpcEngine2$Server$ProtoBufRpcInvoker.call(ProtobufRpcEngine2.java:578) at org.apache.hadoop.ipc.ProtobufRpcEngine2$Server$ProtoBufRpcInvoker.call(ProtobufRpcEngine2.java:556) at org.apache.hadoop.ipc.RPC$Server.call(RPC.java:1093) at org.apache.hadoop.ipc.Server$RpcCall.run(Server.java:1043) at org.apache.hadoop.ipc.Server$RpcCall.run(Server.java:971) at java.base/java.security.AccessController.doPrivileged(Native Method) at java.base/javax.security.auth.Subject.doAs(Subject.java:423) at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1878) at org.apache.hadoop.ipc.Server$Handler.run(Server.java:2976) , while invoking $Proxy19.submitRequest over nodeId=scmNodeId,nodeAddress=scm/172.19.0.8:9860 after 5 failover attempts. Trying to failover after sleeping for 2000ms. com.google.protobuf.ServiceException: org.apache.hadoop.ipc.RemoteException(org.apache.hadoop.hdds.ratis.ServerNotLeaderException): Server:e5c9474a-9d3c-4750-bd09-ecf7e656cad8 is not the leader. Could not determine the leader node. at org.apache.hadoop.hdds.ratis.ServerNotLeaderException.convertToNotLeaderException(ServerNotLeaderException.java:109) at org.apache.hadoop.hdds.scm.ha.RatisUtil.checkRatisException(RatisUtil.java:246) at org.apache.hadoop.hdds.scm.protocol.StorageContainerLocationProtocolServerSideTranslatorPB.submitRequest(StorageContainerLocationProtocolServerSideTranslatorPB.java:197) at org.apache.hadoop.hdds.protocol.proto.StorageContainerLocationProtocolProtos$StorageContainerLocationProtocolService$2.callBlockingMethod(StorageContainerLocationProtocolProtos.java:64993) at org.apache.hadoop.ipc.ProtobufRpcEngine$Server.processCall(ProtobufRpcEngine.java:465) at org.apache.hadoop.ipc.ProtobufRpcEngine2$Server$ProtoBufRpcInvoker.call(ProtobufRpcEngine2.java:578) at org.apache.hadoop.ipc.ProtobufRpcEngine2$Server$ProtoBufRpcInvoker.call(ProtobufRpcEngine2.java:556) at org.apache.hadoop.ipc.RPC$Server.call(RPC.java:1093) at org.apache.hadoop.ipc.Server$RpcCall.run(Server.java:1043) at org.apache.hadoop.ipc.Server$RpcCall.run(Server.java:971) at java.base/java.security.AccessController.doPrivileged(Native Method) at java.base/javax.security.auth.Subject.doAs(Subject.java:423) at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1878) at org.apache.hadoop.ipc.Server$Handler.run(Server.java:2976) , while invoking $Proxy19.submitRequest over nodeId=scmNodeId,nodeAddress=scm/172.19.0.8:9860 after 6 failover attempts. Trying to failover after sleeping for 2000ms. SCM is in safe mode. validated:false, DataNodeSafeModeRule, registered datanodes (=0) >= required datanodes (=3) validated:false, HealthyPipelineSafeModeRule, healthy Ratis/THREE pipelines (=0) >= healthyPipelineThresholdCount (=1) validated:true, ContainerSafeModeRule, % of containers with at least one reported replica (=1.00) >= safeModeCutoff (=0.99) validated:true, AtleastOneDatanodeReportedRule, reported Ratis/THREE pipelines with at least one datanode (=0) >= threshold (=0)
SECONDS: 71
SCM is out of safe mode.
Safe mode is off
No OM HA service, no need to wait
==============================================================================
Createmrenv :: Create directories required for MR test                        
==============================================================================
Create test volume, bucket and key                                    | PASS |
------------------------------------------------------------------------------
Create user dir for hadoop                                            | PASS |
------------------------------------------------------------------------------
Createmrenv :: Create directories required for MR test                | PASS |
2 tests, 2 passed, 0 failed
==============================================================================
Output:  /tmp/smoketest/hadoop31/result/robot-hadoop31-hadoop31-createmrenv-scm.xml
==============================================================================
hadoopfs-o3fs :: Test ozone fs with hadoopfs                                  
==============================================================================
Test hadoop dfs                                                       | PASS |
------------------------------------------------------------------------------
hadoopfs-o3fs :: Test ozone fs with hadoopfs                          | PASS |
1 critical test, 1 passed, 0 failed
1 test total, 1 passed, 0 failed
==============================================================================
Output:  /tmp/smoketest/hadoop31/result/robot-hadoop31-hadoop31-createmrenv-scm-1.xml
==============================================================================
mapreduce-o3fs :: Execute MR jobs                                             
==============================================================================
Execute PI calculation                                                | PASS |
------------------------------------------------------------------------------
Execute WordCount                                                     | PASS |
------------------------------------------------------------------------------
mapreduce-o3fs :: Execute MR jobs                                     | PASS |
2 critical tests, 2 passed, 0 failed
2 tests total, 2 passed, 0 failed
==============================================================================
Output:  /tmp/smoketest/hadoop31/result/robot-hadoop31-hadoop31-createmrenv-scm-2.xml
==============================================================================
hadoopfs-ofs :: Test ozone fs with hadoopfs                                   
==============================================================================
Test hadoop dfs                                                       | PASS |
------------------------------------------------------------------------------
hadoopfs-ofs :: Test ozone fs with hadoopfs                           | PASS |
1 critical test, 1 passed, 0 failed
1 test total, 1 passed, 0 failed
==============================================================================
Output:  /tmp/smoketest/hadoop31/result/robot-hadoop31-hadoop31-createmrenv-scm-3.xml
==============================================================================
mapreduce-ofs :: Execute MR jobs                                              
==============================================================================
Execute PI calculation                                                | PASS |
------------------------------------------------------------------------------
Execute WordCount                                                     | PASS |
------------------------------------------------------------------------------
mapreduce-ofs :: Execute MR jobs                                      | PASS |
2 critical tests, 2 passed, 0 failed
2 tests total, 2 passed, 0 failed
==============================================================================
Output:  /tmp/smoketest/hadoop31/result/robot-hadoop31-hadoop31-createmrenv-scm-4.xml
Stopping hadoop31_scm_1      ... 
Stopping hadoop31_datanode_3 ... 
Stopping hadoop31_datanode_1 ... 
Stopping hadoop31_datanode_2 ... 
Stopping hadoop31_nm_1       ... 
Stopping hadoop31_om_1       ... 
Stopping hadoop31_s3g_1      ... 
Stopping hadoop31_rm_1       ... 
Stopping hadoop31_nm_1       ... done
Stopping hadoop31_rm_1       ... done
Stopping hadoop31_s3g_1      ... done
Stopping hadoop31_om_1       ... done
Stopping hadoop31_datanode_2 ... done
Stopping hadoop31_datanode_3 ... done
Stopping hadoop31_datanode_1 ... done
Stopping hadoop31_scm_1      ... done
Removing hadoop31_scm_1      ... 
Removing hadoop31_datanode_3 ... 
Removing hadoop31_datanode_1 ... 
Removing hadoop31_datanode_2 ... 
Removing hadoop31_nm_1       ... 
Removing hadoop31_om_1       ... 
Removing hadoop31_s3g_1      ... 
Removing hadoop31_rm_1       ... 
Removing hadoop31_om_1       ... done
Removing hadoop31_datanode_3 ... done
Removing hadoop31_datanode_2 ... done
Removing hadoop31_datanode_1 ... done
Removing hadoop31_s3g_1      ... done
Removing hadoop31_scm_1      ... done
Removing hadoop31_rm_1       ... done
Removing hadoop31_nm_1       ... done
Removing network hadoop31_default
Log:     /home/runner/work/ozone/ozone/hadoop-ozone/dist/target/ozone-1.4.0-SNAPSHOT/compose/ozone-mr/hadoop31/result/log.html
Report:  /home/runner/work/ozone/ozone/hadoop-ozone/dist/target/ozone-1.4.0-SNAPSHOT/compose/ozone-mr/hadoop31/result/report.html
Untagged: flokkr/hadoop:3.1.2
Untagged: flokkr/hadoop@sha256:1a24784735a3f243d7c0b2d1f49e74c42bb2ae8d7fc0f24aca2c740875f379f5
Deleted: sha256:16c3587f922f8fb5e1b0ac05de821efd30d04d85836aaa10a2df79dd1f92f615
Deleted: sha256:010620410c1e290373202ccc6f4442d3354cef0923d714584b73d0e736f2c205
Deleted: sha256:58dbdfa32985cd3e46f4e5850b907165cce65888d72bdfb664296c1f522323f6
Deleted: sha256:6b56022c9f422dc0caf5f6f96ae46bcf482a8d5447868cf8dee4d40dc87c965c
Deleted: sha256:26cbf04863ce6238d4bd93150f7072cd4c4d1a1914970abd8ba9fc2ea2b3a947
Deleted: sha256:ac193886605465fa3803c944393eb4d1717cca0dffd84a3dc692b1871974f205
Deleted: sha256:6b9224926483f93910c167e35e2cf0a186c2203cff0a71fc19986a6db3033750
Output:  /home/runner/work/ozone/ozone/hadoop-ozone/dist/target/ozone-1.4.0-SNAPSHOT/compose/ozone-mr/result/hadoop31.xml
removed 'hadoop31/result/robot-hadoop31-hadoop31-createmrenv-scm-1.xml'
removed 'hadoop31/result/robot-hadoop31-hadoop31-createmrenv-scm-2.xml'
removed 'hadoop31/result/robot-hadoop31-hadoop31-createmrenv-scm-3.xml'
removed 'hadoop31/result/robot-hadoop31-hadoop31-createmrenv-scm-4.xml'
removed 'hadoop31/result/robot-hadoop31-hadoop31-createmrenv-scm.xml'
removed 'hadoop31/result/log.html'
removed 'hadoop31/result/report.html'
renamed 'hadoop31/result/dn-audit-35a70c751bbe.log' -> '/home/runner/work/ozone/ozone/hadoop-ozone/dist/target/ozone-1.4.0-SNAPSHOT/compose/ozone-mr/result/hadoop31/dn-audit-35a70c751bbe.log'
renamed 'hadoop31/result/dn-audit-3eb7976619cb.log' -> '/home/runner/work/ozone/ozone/hadoop-ozone/dist/target/ozone-1.4.0-SNAPSHOT/compose/ozone-mr/result/hadoop31/dn-audit-3eb7976619cb.log'
renamed 'hadoop31/result/dn-audit-af3a03608447.log' -> '/home/runner/work/ozone/ozone/hadoop-ozone/dist/target/ozone-1.4.0-SNAPSHOT/compose/ozone-mr/result/hadoop31/dn-audit-af3a03608447.log'
renamed 'hadoop31/result/docker-hadoop31-hadoop31-createmrenv-scm.log' -> '/home/runner/work/ozone/ozone/hadoop-ozone/dist/target/ozone-1.4.0-SNAPSHOT/compose/ozone-mr/result/hadoop31/docker-hadoop31-hadoop31-createmrenv-scm.log'
renamed 'hadoop31/result/om-audit-om.log' -> '/home/runner/work/ozone/ozone/hadoop-ozone/dist/target/ozone-1.4.0-SNAPSHOT/compose/ozone-mr/result/hadoop31/om-audit-om.log'
renamed 'hadoop31/result/s3g-audit-s3g.log' -> '/home/runner/work/ozone/ozone/hadoop-ozone/dist/target/ozone-1.4.0-SNAPSHOT/compose/ozone-mr/result/hadoop31/s3g-audit-s3g.log'
renamed 'hadoop31/result/scm-audit-scm.log' -> '/home/runner/work/ozone/ozone/hadoop-ozone/dist/target/ozone-1.4.0-SNAPSHOT/compose/ozone-mr/result/hadoop31/scm-audit-scm.log'
Executing test in hadoop32
Removing network hadoop32_default
Network hadoop32_default not found.
Creating network "hadoop32_default" with the default driver
Pulling rm (flokkr/hadoop:3.2.2)...
3.2.2: Pulling from flokkr/hadoop
Digest: sha256:958a6c5a3af4a01b3347ccc57052df78033e401fd9dff965148b0939782e2c9e
Status: Downloaded newer image for flokkr/hadoop:3.2.2
Creating hadoop32_rm_1 ... 
Creating hadoop32_s3g_1 ... 
Creating hadoop32_om_1  ... 
Creating hadoop32_nm_1  ... 
Creating hadoop32_datanode_1 ... 
Creating hadoop32_datanode_2 ... 
Creating hadoop32_datanode_3 ... 
Creating hadoop32_scm_1      ... 
Creating hadoop32_rm_1       ... done
Creating hadoop32_datanode_1 ... done
Creating hadoop32_om_1       ... done
Creating hadoop32_s3g_1      ... done
Creating hadoop32_datanode_3 ... done
Creating hadoop32_nm_1       ... done
Creating hadoop32_datanode_2 ... done
Creating hadoop32_scm_1      ... done
SECONDS: 62
com.google.protobuf.ServiceException: java.net.ConnectException: Call From scm/172.20.0.6 to scm:9860 failed on connection exception: java.net.ConnectException: Connection refused; For more details see: http://wiki.apache.org/hadoop/ConnectionRefused, while invoking $Proxy20.submitRequest over nodeId=scmNodeId,nodeAddress=scm/172.20.0.6:9860 after 1 failover attempts. Trying to failover after sleeping for 2000ms. com.google.protobuf.ServiceException: java.net.ConnectException: Call From scm/172.20.0.6 to scm:9860 failed on connection exception: java.net.ConnectException: Connection refused; For more details see: http://wiki.apache.org/hadoop/ConnectionRefused, while invoking $Proxy20.submitRequest over nodeId=scmNodeId,nodeAddress=scm/172.20.0.6:9860 after 2 failover attempts. Trying to failover after sleeping for 2000ms. com.google.protobuf.ServiceException: java.net.ConnectException: Call From scm/172.20.0.6 to scm:9860 failed on connection exception: java.net.ConnectException: Connection refused; For more details see: http://wiki.apache.org/hadoop/ConnectionRefused, while invoking $Proxy20.submitRequest over nodeId=scmNodeId,nodeAddress=scm/172.20.0.6:9860 after 3 failover attempts. Trying to failover after sleeping for 2000ms. com.google.protobuf.ServiceException: java.net.ConnectException: Call From scm/172.20.0.6 to scm:9860 failed on connection exception: java.net.ConnectException: Connection refused; For more details see: http://wiki.apache.org/hadoop/ConnectionRefused, while invoking $Proxy20.submitRequest over nodeId=scmNodeId,nodeAddress=scm/172.20.0.6:9860 after 4 failover attempts. Trying to failover after sleeping for 2000ms. com.google.protobuf.ServiceException: java.net.ConnectException: Call From scm/172.20.0.6 to scm:9860 failed on connection exception: java.net.ConnectException: Connection refused; For more details see: http://wiki.apache.org/hadoop/ConnectionRefused, while invoking $Proxy20.submitRequest over nodeId=scmNodeId,nodeAddress=scm/172.20.0.6:9860 after 5 failover attempts. Trying to failover after sleeping for 2000ms. com.google.protobuf.ServiceException: org.apache.hadoop.ipc.RemoteException(org.apache.hadoop.hdds.ratis.ServerNotLeaderException): Server:edbd4964-1984-4977-b070-0a4bad82d755 is not the leader. Could not determine the leader node. at org.apache.hadoop.hdds.ratis.ServerNotLeaderException.convertToNotLeaderException(ServerNotLeaderException.java:109) at org.apache.hadoop.hdds.scm.ha.RatisUtil.checkRatisException(RatisUtil.java:246) at org.apache.hadoop.hdds.scm.protocol.StorageContainerLocationProtocolServerSideTranslatorPB.submitRequest(StorageContainerLocationProtocolServerSideTranslatorPB.java:197) at org.apache.hadoop.hdds.protocol.proto.StorageContainerLocationProtocolProtos$StorageContainerLocationProtocolService$2.callBlockingMethod(StorageContainerLocationProtocolProtos.java:64993) at org.apache.hadoop.ipc.ProtobufRpcEngine$Server.processCall(ProtobufRpcEngine.java:465) at org.apache.hadoop.ipc.ProtobufRpcEngine2$Server$ProtoBufRpcInvoker.call(ProtobufRpcEngine2.java:578) at org.apache.hadoop.ipc.ProtobufRpcEngine2$Server$ProtoBufRpcInvoker.call(ProtobufRpcEngine2.java:556) at org.apache.hadoop.ipc.RPC$Server.call(RPC.java:1093) at org.apache.hadoop.ipc.Server$RpcCall.run(Server.java:1043) at org.apache.hadoop.ipc.Server$RpcCall.run(Server.java:971) at java.base/java.security.AccessController.doPrivileged(Native Method) at java.base/javax.security.auth.Subject.doAs(Subject.java:423) at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1878) at org.apache.hadoop.ipc.Server$Handler.run(Server.java:2976) , while invoking $Proxy20.submitRequest over nodeId=scmNodeId,nodeAddress=scm/172.20.0.6:9860 after 6 failover attempts. Trying to failover after sleeping for 2000ms. com.google.protobuf.ServiceException: org.apache.hadoop.ipc.RemoteException(org.apache.hadoop.hdds.ratis.ServerNotLeaderException): Server:edbd4964-1984-4977-b070-0a4bad82d755 is not the leader. Could not determine the leader node. at org.apache.hadoop.hdds.ratis.ServerNotLeaderException.convertToNotLeaderException(ServerNotLeaderException.java:109) at org.apache.hadoop.hdds.scm.ha.RatisUtil.checkRatisException(RatisUtil.java:246) at org.apache.hadoop.hdds.scm.protocol.StorageContainerLocationProtocolServerSideTranslatorPB.submitRequest(StorageContainerLocationProtocolServerSideTranslatorPB.java:197) at org.apache.hadoop.hdds.protocol.proto.StorageContainerLocationProtocolProtos$StorageContainerLocationProtocolService$2.callBlockingMethod(StorageContainerLocationProtocolProtos.java:64993) at org.apache.hadoop.ipc.ProtobufRpcEngine$Server.processCall(ProtobufRpcEngine.java:465) at org.apache.hadoop.ipc.ProtobufRpcEngine2$Server$ProtoBufRpcInvoker.call(ProtobufRpcEngine2.java:578) at org.apache.hadoop.ipc.ProtobufRpcEngine2$Server$ProtoBufRpcInvoker.call(ProtobufRpcEngine2.java:556) at org.apache.hadoop.ipc.RPC$Server.call(RPC.java:1093) at org.apache.hadoop.ipc.Server$RpcCall.run(Server.java:1043) at org.apache.hadoop.ipc.Server$RpcCall.run(Server.java:971) at java.base/java.security.AccessController.doPrivileged(Native Method) at java.base/javax.security.auth.Subject.doAs(Subject.java:423) at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1878) at org.apache.hadoop.ipc.Server$Handler.run(Server.java:2976) , while invoking $Proxy20.submitRequest over nodeId=scmNodeId,nodeAddress=scm/172.20.0.6:9860 after 7 failover attempts. Trying to failover after sleeping for 2000ms. com.google.protobuf.ServiceException: org.apache.hadoop.ipc.RemoteException(org.apache.hadoop.hdds.ratis.ServerNotLeaderException): Server:edbd4964-1984-4977-b070-0a4bad82d755 is not the leader. Could not determine the leader node. at org.apache.hadoop.hdds.ratis.ServerNotLeaderException.convertToNotLeaderException(ServerNotLeaderException.java:109) at org.apache.hadoop.hdds.scm.ha.RatisUtil.checkRatisException(RatisUtil.java:246) at org.apache.hadoop.hdds.scm.protocol.StorageContainerLocationProtocolServerSideTranslatorPB.submitRequest(StorageContainerLocationProtocolServerSideTranslatorPB.java:197) at org.apache.hadoop.hdds.protocol.proto.StorageContainerLocationProtocolProtos$StorageContainerLocationProtocolService$2.callBlockingMethod(StorageContainerLocationProtocolProtos.java:64993) at org.apache.hadoop.ipc.ProtobufRpcEngine$Server.processCall(ProtobufRpcEngine.java:465) at org.apache.hadoop.ipc.ProtobufRpcEngine2$Server$ProtoBufRpcInvoker.call(ProtobufRpcEngine2.java:578) at org.apache.hadoop.ipc.ProtobufRpcEngine2$Server$ProtoBufRpcInvoker.call(ProtobufRpcEngine2.java:556) at org.apache.hadoop.ipc.RPC$Server.call(RPC.java:1093) at org.apache.hadoop.ipc.Server$RpcCall.run(Server.java:1043) at org.apache.hadoop.ipc.Server$RpcCall.run(Server.java:971) at java.base/java.security.AccessController.doPrivileged(Native Method) at java.base/javax.security.auth.Subject.doAs(Subject.java:423) at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1878) at org.apache.hadoop.ipc.Server$Handler.run(Server.java:2976) , while invoking $Proxy20.submitRequest over nodeId=scmNodeId,nodeAddress=scm/172.20.0.6:9860 after 8 failover attempts. Trying to failover after sleeping for 2000ms. SCM is in safe mode. validated:true, DataNodeSafeModeRule, registered datanodes (=3) >= required datanodes (=3) validated:false, HealthyPipelineSafeModeRule, healthy Ratis/THREE pipelines (=0) >= healthyPipelineThresholdCount (=1) validated:true, ContainerSafeModeRule, % of containers with at least one reported replica (=1.00) >= safeModeCutoff (=0.99) validated:true, AtleastOneDatanodeReportedRule, reported Ratis/THREE pipelines with at least one datanode (=0) >= threshold (=0)
SECONDS: 81
SCM is out of safe mode.
Safe mode is off
No OM HA service, no need to wait
==============================================================================
Createmrenv :: Create directories required for MR test                        
==============================================================================
Create test volume, bucket and key                                    | PASS |
------------------------------------------------------------------------------
Create user dir for hadoop                                            | PASS |
------------------------------------------------------------------------------
Createmrenv :: Create directories required for MR test                | PASS |
2 tests, 2 passed, 0 failed
==============================================================================
Output:  /tmp/smoketest/hadoop32/result/robot-hadoop32-hadoop32-createmrenv-scm.xml
==============================================================================
hadoopfs-o3fs :: Test ozone fs with hadoopfs                                  
==============================================================================
Test hadoop dfs                                                       | PASS |
------------------------------------------------------------------------------
hadoopfs-o3fs :: Test ozone fs with hadoopfs                          | PASS |
1 critical test, 1 passed, 0 failed
1 test total, 1 passed, 0 failed
==============================================================================
Output:  /tmp/smoketest/hadoop32/result/robot-hadoop32-hadoop32-createmrenv-scm-1.xml
==============================================================================
mapreduce-o3fs :: Execute MR jobs                                             
==============================================================================
Execute PI calculation                                                | PASS |
------------------------------------------------------------------------------
Execute WordCount                                                     | PASS |
------------------------------------------------------------------------------
mapreduce-o3fs :: Execute MR jobs                                     | PASS |
2 critical tests, 2 passed, 0 failed
2 tests total, 2 passed, 0 failed
==============================================================================
Output:  /tmp/smoketest/hadoop32/result/robot-hadoop32-hadoop32-createmrenv-scm-2.xml
==============================================================================
hadoopfs-ofs :: Test ozone fs with hadoopfs                                   
==============================================================================
Test hadoop dfs                                                       | PASS |
------------------------------------------------------------------------------
hadoopfs-ofs :: Test ozone fs with hadoopfs                           | PASS |
1 critical test, 1 passed, 0 failed
1 test total, 1 passed, 0 failed
==============================================================================
Output:  /tmp/smoketest/hadoop32/result/robot-hadoop32-hadoop32-createmrenv-scm-3.xml
==============================================================================
mapreduce-ofs :: Execute MR jobs                                              
==============================================================================
Execute PI calculation                                                | PASS |
------------------------------------------------------------------------------
Execute WordCount                                                     | PASS |
------------------------------------------------------------------------------
mapreduce-ofs :: Execute MR jobs                                      | PASS |
2 critical tests, 2 passed, 0 failed
2 tests total, 2 passed, 0 failed
==============================================================================
Output:  /tmp/smoketest/hadoop32/result/robot-hadoop32-hadoop32-createmrenv-scm-4.xml
Stopping hadoop32_datanode_3 ... 
Stopping hadoop32_datanode_2 ... 
Stopping hadoop32_nm_1       ... 
Stopping hadoop32_scm_1      ... 
Stopping hadoop32_datanode_1 ... 
Stopping hadoop32_s3g_1      ... 
Stopping hadoop32_om_1       ... 
Stopping hadoop32_rm_1       ... 
Stopping hadoop32_nm_1       ... done
Stopping hadoop32_rm_1       ... done
Stopping hadoop32_s3g_1      ... done
Stopping hadoop32_om_1       ... done
Stopping hadoop32_datanode_3 ... done
Stopping hadoop32_datanode_2 ... done
Stopping hadoop32_datanode_1 ... done
Stopping hadoop32_scm_1      ... done
Removing hadoop32_datanode_3 ... 
Removing hadoop32_datanode_2 ... 
Removing hadoop32_nm_1       ... 
Removing hadoop32_scm_1      ... 
Removing hadoop32_datanode_1 ... 
Removing hadoop32_s3g_1      ... 
Removing hadoop32_om_1       ... 
Removing hadoop32_rm_1       ... 
Removing hadoop32_s3g_1      ... done
Removing hadoop32_om_1       ... done
Removing hadoop32_rm_1       ... done
Removing hadoop32_datanode_3 ... done
Removing hadoop32_datanode_1 ... done
Removing hadoop32_nm_1       ... done
Removing hadoop32_datanode_2 ... done
Removing hadoop32_scm_1      ... done
Removing network hadoop32_default
Log:     /home/runner/work/ozone/ozone/hadoop-ozone/dist/target/ozone-1.4.0-SNAPSHOT/compose/ozone-mr/hadoop32/result/log.html
Report:  /home/runner/work/ozone/ozone/hadoop-ozone/dist/target/ozone-1.4.0-SNAPSHOT/compose/ozone-mr/hadoop32/result/report.html
Output:  /home/runner/work/ozone/ozone/hadoop-ozone/dist/target/ozone-1.4.0-SNAPSHOT/compose/ozone-mr/result/hadoop32.xml
removed 'hadoop32/result/robot-hadoop32-hadoop32-createmrenv-scm-1.xml'
removed 'hadoop32/result/robot-hadoop32-hadoop32-createmrenv-scm-2.xml'
removed 'hadoop32/result/robot-hadoop32-hadoop32-createmrenv-scm-3.xml'
removed 'hadoop32/result/robot-hadoop32-hadoop32-createmrenv-scm-4.xml'
removed 'hadoop32/result/robot-hadoop32-hadoop32-createmrenv-scm.xml'
removed 'hadoop32/result/log.html'
removed 'hadoop32/result/report.html'
renamed 'hadoop32/result/dn-audit-3ea5b8897d98.log' -> '/home/runner/work/ozone/ozone/hadoop-ozone/dist/target/ozone-1.4.0-SNAPSHOT/compose/ozone-mr/result/hadoop32/dn-audit-3ea5b8897d98.log'
renamed 'hadoop32/result/dn-audit-4421b682f815.log' -> '/home/runner/work/ozone/ozone/hadoop-ozone/dist/target/ozone-1.4.0-SNAPSHOT/compose/ozone-mr/result/hadoop32/dn-audit-4421b682f815.log'
renamed 'hadoop32/result/dn-audit-b5a8db0cfaea.log' -> '/home/runner/work/ozone/ozone/hadoop-ozone/dist/target/ozone-1.4.0-SNAPSHOT/compose/ozone-mr/result/hadoop32/dn-audit-b5a8db0cfaea.log'
renamed 'hadoop32/result/docker-hadoop32-hadoop32-createmrenv-scm.log' -> '/home/runner/work/ozone/ozone/hadoop-ozone/dist/target/ozone-1.4.0-SNAPSHOT/compose/ozone-mr/result/hadoop32/docker-hadoop32-hadoop32-createmrenv-scm.log'
renamed 'hadoop32/result/om-audit-om.log' -> '/home/runner/work/ozone/ozone/hadoop-ozone/dist/target/ozone-1.4.0-SNAPSHOT/compose/ozone-mr/result/hadoop32/om-audit-om.log'
renamed 'hadoop32/result/s3g-audit-s3g.log' -> '/home/runner/work/ozone/ozone/hadoop-ozone/dist/target/ozone-1.4.0-SNAPSHOT/compose/ozone-mr/result/hadoop32/s3g-audit-s3g.log'
renamed 'hadoop32/result/scm-audit-scm.log' -> '/home/runner/work/ozone/ozone/hadoop-ozone/dist/target/ozone-1.4.0-SNAPSHOT/compose/ozone-mr/result/hadoop32/scm-audit-scm.log'
Executing test in hadoop33
Removing network hadoop33_default
Network hadoop33_default not found.
Creating network "hadoop33_default" with the default driver
Pulling rm (flokkr/hadoop:3.3.1)...
3.3.1: Pulling from flokkr/hadoop
Digest: sha256:2dd21ee3789687f6c297b43d618a0ff2b7ffd9e8a97a77b08643603ab8c3556d
Status: Downloaded newer image for flokkr/hadoop:3.3.1
Creating hadoop33_nm_1 ... 
Creating hadoop33_om_1 ... 
Creating hadoop33_rm_1 ... 
Creating hadoop33_datanode_1 ... 
Creating hadoop33_datanode_2 ... 
Creating hadoop33_datanode_3 ... 
Creating hadoop33_scm_1      ... 
Creating hadoop33_s3g_1      ... 
Creating hadoop33_nm_1       ... done
Creating hadoop33_rm_1       ... done
Creating hadoop33_s3g_1      ... done
Creating hadoop33_datanode_1 ... done
Creating hadoop33_datanode_3 ... done
Creating hadoop33_datanode_2 ... done
Creating hadoop33_om_1       ... done
Creating hadoop33_scm_1      ... done
SECONDS: 62
com.google.protobuf.ServiceException: java.net.ConnectException: Call From scm/172.21.0.4 to scm:9860 failed on connection exception: java.net.ConnectException: Connection refused; For more details see: http://wiki.apache.org/hadoop/ConnectionRefused, while invoking $Proxy20.submitRequest over nodeId=scmNodeId,nodeAddress=scm/172.21.0.4:9860 after 1 failover attempts. Trying to failover after sleeping for 2000ms. com.google.protobuf.ServiceException: java.net.ConnectException: Call From scm/172.21.0.4 to scm:9860 failed on connection exception: java.net.ConnectException: Connection refused; For more details see: http://wiki.apache.org/hadoop/ConnectionRefused, while invoking $Proxy20.submitRequest over nodeId=scmNodeId,nodeAddress=scm/172.21.0.4:9860 after 2 failover attempts. Trying to failover after sleeping for 2000ms. com.google.protobuf.ServiceException: java.net.ConnectException: Call From scm/172.21.0.4 to scm:9860 failed on connection exception: java.net.ConnectException: Connection refused; For more details see: http://wiki.apache.org/hadoop/ConnectionRefused, while invoking $Proxy20.submitRequest over nodeId=scmNodeId,nodeAddress=scm/172.21.0.4:9860 after 3 failover attempts. Trying to failover after sleeping for 2000ms. com.google.protobuf.ServiceException: java.net.ConnectException: Call From scm/172.21.0.4 to scm:9860 failed on connection exception: java.net.ConnectException: Connection refused; For more details see: http://wiki.apache.org/hadoop/ConnectionRefused, while invoking $Proxy20.submitRequest over nodeId=scmNodeId,nodeAddress=scm/172.21.0.4:9860 after 4 failover attempts. Trying to failover after sleeping for 2000ms. com.google.protobuf.ServiceException: org.apache.hadoop.ipc.RemoteException(org.apache.hadoop.hdds.ratis.ServerNotLeaderException): Server:9c1a3ce9-077d-4bf1-a33c-cc5d45d3069b is not the leader. Could not determine the leader node. at org.apache.hadoop.hdds.ratis.ServerNotLeaderException.convertToNotLeaderException(ServerNotLeaderException.java:109) at org.apache.hadoop.hdds.scm.ha.RatisUtil.checkRatisException(RatisUtil.java:246) at org.apache.hadoop.hdds.scm.protocol.StorageContainerLocationProtocolServerSideTranslatorPB.submitRequest(StorageContainerLocationProtocolServerSideTranslatorPB.java:197) at org.apache.hadoop.hdds.protocol.proto.StorageContainerLocationProtocolProtos$StorageContainerLocationProtocolService$2.callBlockingMethod(StorageContainerLocationProtocolProtos.java:64993) at org.apache.hadoop.ipc.ProtobufRpcEngine$Server.processCall(ProtobufRpcEngine.java:465) at org.apache.hadoop.ipc.ProtobufRpcEngine2$Server$ProtoBufRpcInvoker.call(ProtobufRpcEngine2.java:578) at org.apache.hadoop.ipc.ProtobufRpcEngine2$Server$ProtoBufRpcInvoker.call(ProtobufRpcEngine2.java:556) at org.apache.hadoop.ipc.RPC$Server.call(RPC.java:1093) at org.apache.hadoop.ipc.Server$RpcCall.run(Server.java:1043) at org.apache.hadoop.ipc.Server$RpcCall.run(Server.java:971) at java.base/java.security.AccessController.doPrivileged(Native Method) at java.base/javax.security.auth.Subject.doAs(Subject.java:423) at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1878) at org.apache.hadoop.ipc.Server$Handler.run(Server.java:2976) , while invoking $Proxy20.submitRequest over nodeId=scmNodeId,nodeAddress=scm/172.21.0.4:9860 after 5 failover attempts. Trying to failover after sleeping for 2000ms. com.google.protobuf.ServiceException: org.apache.hadoop.ipc.RemoteException(org.apache.hadoop.hdds.ratis.ServerNotLeaderException): Server:9c1a3ce9-077d-4bf1-a33c-cc5d45d3069b is not the leader. Could not determine the leader node. at org.apache.hadoop.hdds.ratis.ServerNotLeaderException.convertToNotLeaderException(ServerNotLeaderException.java:109) at org.apache.hadoop.hdds.scm.ha.RatisUtil.checkRatisException(RatisUtil.java:246) at org.apache.hadoop.hdds.scm.protocol.StorageContainerLocationProtocolServerSideTranslatorPB.submitRequest(StorageContainerLocationProtocolServerSideTranslatorPB.java:197) at org.apache.hadoop.hdds.protocol.proto.StorageContainerLocationProtocolProtos$StorageContainerLocationProtocolService$2.callBlockingMethod(StorageContainerLocationProtocolProtos.java:64993) at org.apache.hadoop.ipc.ProtobufRpcEngine$Server.processCall(ProtobufRpcEngine.java:465) at org.apache.hadoop.ipc.ProtobufRpcEngine2$Server$ProtoBufRpcInvoker.call(ProtobufRpcEngine2.java:578) at org.apache.hadoop.ipc.ProtobufRpcEngine2$Server$ProtoBufRpcInvoker.call(ProtobufRpcEngine2.java:556) at org.apache.hadoop.ipc.RPC$Server.call(RPC.java:1093) at org.apache.hadoop.ipc.Server$RpcCall.run(Server.java:1043) at org.apache.hadoop.ipc.Server$RpcCall.run(Server.java:971) at java.base/java.security.AccessController.doPrivileged(Native Method) at java.base/javax.security.auth.Subject.doAs(Subject.java:423) at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1878) at org.apache.hadoop.ipc.Server$Handler.run(Server.java:2976) , while invoking $Proxy20.submitRequest over nodeId=scmNodeId,nodeAddress=scm/172.21.0.4:9860 after 6 failover attempts. Trying to failover after sleeping for 2000ms. SCM is in safe mode. validated:false, DataNodeSafeModeRule, registered datanodes (=1) >= required datanodes (=3) validated:false, HealthyPipelineSafeModeRule, healthy Ratis/THREE pipelines (=0) >= healthyPipelineThresholdCount (=1) validated:true, ContainerSafeModeRule, % of containers with at least one reported replica (=1.00) >= safeModeCutoff (=0.99) validated:true, AtleastOneDatanodeReportedRule, reported Ratis/THREE pipelines with at least one datanode (=0) >= threshold (=0)
SECONDS: 82
SCM is out of safe mode.
Safe mode is off
No OM HA service, no need to wait
==============================================================================
Createmrenv :: Create directories required for MR test                        
==============================================================================
Create test volume, bucket and key                                    | PASS |
------------------------------------------------------------------------------
Create user dir for hadoop                                            | PASS |
------------------------------------------------------------------------------
Createmrenv :: Create directories required for MR test                | PASS |
2 tests, 2 passed, 0 failed
==============================================================================
Output:  /tmp/smoketest/hadoop33/result/robot-hadoop33-hadoop33-createmrenv-scm.xml
==============================================================================
hadoopfs-o3fs :: Test ozone fs with hadoopfs                                  
==============================================================================
Test hadoop dfs                                                       | PASS |
------------------------------------------------------------------------------
hadoopfs-o3fs :: Test ozone fs with hadoopfs                          | PASS |
1 critical test, 1 passed, 0 failed
1 test total, 1 passed, 0 failed
==============================================================================
Output:  /tmp/smoketest/hadoop33/result/robot-hadoop33-hadoop33-createmrenv-scm-1.xml
==============================================================================
mapreduce-o3fs :: Execute MR jobs                                             
==============================================================================
Execute PI calculation                                                | PASS |
------------------------------------------------------------------------------
Execute WordCount                                                     | PASS |
------------------------------------------------------------------------------
mapreduce-o3fs :: Execute MR jobs                                     | PASS |
2 critical tests, 2 passed, 0 failed
2 tests total, 2 passed, 0 failed
==============================================================================
Output:  /tmp/smoketest/hadoop33/result/robot-hadoop33-hadoop33-createmrenv-scm-2.xml
==============================================================================
hadoopfs-ofs :: Test ozone fs with hadoopfs                                   
==============================================================================
Test hadoop dfs                                                       | PASS |
------------------------------------------------------------------------------
hadoopfs-ofs :: Test ozone fs with hadoopfs                           | PASS |
1 critical test, 1 passed, 0 failed
1 test total, 1 passed, 0 failed
==============================================================================
Output:  /tmp/smoketest/hadoop33/result/robot-hadoop33-hadoop33-createmrenv-scm-3.xml
==============================================================================
mapreduce-ofs :: Execute MR jobs                                              
==============================================================================
Execute PI calculation                                                | PASS |
------------------------------------------------------------------------------
Execute WordCount                                                     | PASS |
------------------------------------------------------------------------------
mapreduce-ofs :: Execute MR jobs                                      | PASS |
2 critical tests, 2 passed, 0 failed
2 tests total, 2 passed, 0 failed
==============================================================================
Output:  /tmp/smoketest/hadoop33/result/robot-hadoop33-hadoop33-createmrenv-scm-4.xml
Stopping hadoop33_datanode_3 ... 
Stopping hadoop33_s3g_1      ... 
Stopping hadoop33_datanode_2 ... 
Stopping hadoop33_om_1       ... 
Stopping hadoop33_datanode_1 ... 
Stopping hadoop33_rm_1       ... 
Stopping hadoop33_scm_1      ... 
Stopping hadoop33_nm_1       ... 
Stopping hadoop33_nm_1       ... done
Stopping hadoop33_rm_1       ... done
Stopping hadoop33_s3g_1      ... done
Stopping hadoop33_om_1       ... done
Stopping hadoop33_datanode_3 ... done
Stopping hadoop33_datanode_1 ... done
Stopping hadoop33_datanode_2 ... done
Stopping hadoop33_scm_1      ... done
Removing hadoop33_datanode_3 ... 
Removing hadoop33_s3g_1      ... 
Removing hadoop33_datanode_2 ... 
Removing hadoop33_om_1       ... 
Removing hadoop33_datanode_1 ... 
Removing hadoop33_rm_1       ... 
Removing hadoop33_scm_1      ... 
Removing hadoop33_nm_1       ... 
Removing hadoop33_datanode_1 ... done
Removing hadoop33_s3g_1      ... done
Removing hadoop33_rm_1       ... done
Removing hadoop33_datanode_3 ... done
Removing hadoop33_scm_1      ... done
Removing hadoop33_om_1       ... done
Removing hadoop33_datanode_2 ... done
Removing hadoop33_nm_1       ... done
Removing network hadoop33_default
Log:     /home/runner/work/ozone/ozone/hadoop-ozone/dist/target/ozone-1.4.0-SNAPSHOT/compose/ozone-mr/hadoop33/result/log.html
Report:  /home/runner/work/ozone/ozone/hadoop-ozone/dist/target/ozone-1.4.0-SNAPSHOT/compose/ozone-mr/hadoop33/result/report.html
Output:  /home/runner/work/ozone/ozone/hadoop-ozone/dist/target/ozone-1.4.0-SNAPSHOT/compose/ozone-mr/result/hadoop33.xml
removed 'hadoop33/result/robot-hadoop33-hadoop33-createmrenv-scm-1.xml'
removed 'hadoop33/result/robot-hadoop33-hadoop33-createmrenv-scm-2.xml'
removed 'hadoop33/result/robot-hadoop33-hadoop33-createmrenv-scm-3.xml'
removed 'hadoop33/result/robot-hadoop33-hadoop33-createmrenv-scm-4.xml'
removed 'hadoop33/result/robot-hadoop33-hadoop33-createmrenv-scm.xml'
removed 'hadoop33/result/log.html'
removed 'hadoop33/result/report.html'
renamed 'hadoop33/result/dn-audit-1dca66adf270.log' -> '/home/runner/work/ozone/ozone/hadoop-ozone/dist/target/ozone-1.4.0-SNAPSHOT/compose/ozone-mr/result/hadoop33/dn-audit-1dca66adf270.log'
renamed 'hadoop33/result/dn-audit-88f583e9cbe3.log' -> '/home/runner/work/ozone/ozone/hadoop-ozone/dist/target/ozone-1.4.0-SNAPSHOT/compose/ozone-mr/result/hadoop33/dn-audit-88f583e9cbe3.log'
renamed 'hadoop33/result/dn-audit-bfdf455357db.log' -> '/home/runner/work/ozone/ozone/hadoop-ozone/dist/target/ozone-1.4.0-SNAPSHOT/compose/ozone-mr/result/hadoop33/dn-audit-bfdf455357db.log'
renamed 'hadoop33/result/docker-hadoop33-hadoop33-createmrenv-scm.log' -> '/home/runner/work/ozone/ozone/hadoop-ozone/dist/target/ozone-1.4.0-SNAPSHOT/compose/ozone-mr/result/hadoop33/docker-hadoop33-hadoop33-createmrenv-scm.log'
renamed 'hadoop33/result/om-audit-om.log' -> '/home/runner/work/ozone/ozone/hadoop-ozone/dist/target/ozone-1.4.0-SNAPSHOT/compose/ozone-mr/result/hadoop33/om-audit-om.log'
renamed 'hadoop33/result/s3g-audit-s3g.log' -> '/home/runner/work/ozone/ozone/hadoop-ozone/dist/target/ozone-1.4.0-SNAPSHOT/compose/ozone-mr/result/hadoop33/s3g-audit-s3g.log'
renamed 'hadoop33/result/scm-audit-scm.log' -> '/home/runner/work/ozone/ozone/hadoop-ozone/dist/target/ozone-1.4.0-SNAPSHOT/compose/ozone-mr/result/hadoop33/scm-audit-scm.log'
Log:     /home/runner/work/ozone/ozone/hadoop-ozone/dist/target/ozone-1.4.0-SNAPSHOT/compose/ozone-mr/result/log.html
Report:  /home/runner/work/ozone/ozone/hadoop-ozone/dist/target/ozone-1.4.0-SNAPSHOT/compose/ozone-mr/result/report.html
Output:  /home/runner/work/ozone/ozone/hadoop-ozone/dist/target/ozone-1.4.0-SNAPSHOT/compose/result/ozone-mr.xml
removed 'ozone-mr/result/hadoop27.xml'
removed 'ozone-mr/result/hadoop31.xml'
removed 'ozone-mr/result/hadoop32.xml'
removed 'ozone-mr/result/hadoop33.xml'
removed 'ozone-mr/result/log.html'
removed 'ozone-mr/result/report.html'
renamed 'ozone-mr/result/hadoop27' -> '/home/runner/work/ozone/ozone/hadoop-ozone/dist/target/ozone-1.4.0-SNAPSHOT/compose/result/ozone-mr/hadoop27'
renamed 'ozone-mr/result/hadoop31' -> '/home/runner/work/ozone/ozone/hadoop-ozone/dist/target/ozone-1.4.0-SNAPSHOT/compose/result/ozone-mr/hadoop31'
renamed 'ozone-mr/result/hadoop32' -> '/home/runner/work/ozone/ozone/hadoop-ozone/dist/target/ozone-1.4.0-SNAPSHOT/compose/result/ozone-mr/hadoop32'
renamed 'ozone-mr/result/hadoop33' -> '/home/runner/work/ozone/ozone/hadoop-ozone/dist/target/ozone-1.4.0-SNAPSHOT/compose/result/ozone-mr/hadoop33'
Executing test in ozonesecure-mr
Removing network ozone
Network ozone not found.
Creating network "ozone" with the default driver
Pulling kdc (apache/ozone-testkrb5:20211102-1)...
20211102-1: Pulling from apache/ozone-testkrb5
Digest: sha256:ab09104242ad43fd09891d06c042ecf2daa0cfca385bfd492daf22083be51dde
Status: Downloaded newer image for apache/ozone-testkrb5:20211102-1
Creating ozonesecure-mr_kms_1 ... 
Creating ozonesecure-mr_datanode_1 ... 
Creating ozonesecure-mr_om_1       ... 
Creating ozonesecure-mr_datanode_2 ... 
Creating ozonesecure-mr_scm_1      ... 
Creating ozonesecure-mr_rm_1       ... 
Creating ozonesecure-mr_datanode_3 ... 
Creating ozonesecure-mr_kdc_1      ... 
Creating ozonesecure-mr_s3g_1      ... 
Creating jhs                       ... 
Creating ozonesecure-mr_nm_1       ... 
Creating ozonesecure-mr_kms_1      ... done
Creating ozonesecure-mr_rm_1       ... done
Creating jhs                       ... done
Creating ozonesecure-mr_kdc_1      ... done
Creating ozonesecure-mr_nm_1       ... done
Creating ozonesecure-mr_datanode_1 ... done
Creating ozonesecure-mr_datanode_3 ... done
Creating ozonesecure-mr_s3g_1      ... done
Creating ozonesecure-mr_scm_1      ... done
Creating ozonesecure-mr_datanode_2 ... done
Creating ozonesecure-mr_om_1       ... done
ozone.scm.client.address should be set in ozone-site.xml or with the --scm option
SECONDS: 11

SECONDS: 96
com.google.protobuf.ServiceException: java.net.ConnectException: Call From scm/172.22.0.6 to scm:9860 failed on connection exception: java.net.ConnectException: Connection refused; For more details see: http://wiki.apache.org/hadoop/ConnectionRefused, while invoking $Proxy20.submitRequest over nodeId=scmNodeId,nodeAddress=scm/172.22.0.6:9860 after 1 failover attempts. Trying to failover after sleeping for 2000ms. com.google.protobuf.ServiceException: java.net.ConnectException: Call From scm/172.22.0.6 to scm:9860 failed on connection exception: java.net.ConnectException: Connection refused; For more details see: http://wiki.apache.org/hadoop/ConnectionRefused, while invoking $Proxy20.submitRequest over nodeId=scmNodeId,nodeAddress=scm/172.22.0.6:9860 after 2 failover attempts. Trying to failover after sleeping for 2000ms. com.google.protobuf.ServiceException: java.net.ConnectException: Call From scm/172.22.0.6 to scm:9860 failed on connection exception: java.net.ConnectException: Connection refused; For more details see: http://wiki.apache.org/hadoop/ConnectionRefused, while invoking $Proxy20.submitRequest over nodeId=scmNodeId,nodeAddress=scm/172.22.0.6:9860 after 3 failover attempts. Trying to failover after sleeping for 2000ms. com.google.protobuf.ServiceException: java.net.ConnectException: Call From scm/172.22.0.6 to scm:9860 failed on connection exception: java.net.ConnectException: Connection refused; For more details see: http://wiki.apache.org/hadoop/ConnectionRefused, while invoking $Proxy20.submitRequest over nodeId=scmNodeId,nodeAddress=scm/172.22.0.6:9860 after 4 failover attempts. Trying to failover after sleeping for 2000ms. com.google.protobuf.ServiceException: java.net.ConnectException: Call From scm/172.22.0.6 to scm:9860 failed on connection exception: java.net.ConnectException: Connection refused; For more details see: http://wiki.apache.org/hadoop/ConnectionRefused, while invoking $Proxy20.submitRequest over nodeId=scmNodeId,nodeAddress=scm/172.22.0.6:9860 after 5 failover attempts. Trying to failover after sleeping for 2000ms. com.google.protobuf.ServiceException: java.net.ConnectException: Call From scm/172.22.0.6 to scm:9860 failed on connection exception: java.net.ConnectException: Connection refused; For more details see: http://wiki.apache.org/hadoop/ConnectionRefused, while invoking $Proxy20.submitRequest over nodeId=scmNodeId,nodeAddress=scm/172.22.0.6:9860 after 6 failover attempts. Trying to failover after sleeping for 2000ms. com.google.protobuf.ServiceException: java.net.ConnectException: Call From scm/172.22.0.6 to scm:9860 failed on connection exception: java.net.ConnectException: Connection refused; For more details see: http://wiki.apache.org/hadoop/ConnectionRefused, while invoking $Proxy20.submitRequest over nodeId=scmNodeId,nodeAddress=scm/172.22.0.6:9860 after 7 failover attempts. Trying to failover after sleeping for 2000ms. com.google.protobuf.ServiceException: java.net.ConnectException: Call From scm/172.22.0.6 to scm:9860 failed on connection exception: java.net.ConnectException: Connection refused; For more details see: http://wiki.apache.org/hadoop/ConnectionRefused, while invoking $Proxy20.submitRequest over nodeId=scmNodeId,nodeAddress=scm/172.22.0.6:9860 after 8 failover attempts. Trying to failover after sleeping for 2000ms. com.google.protobuf.ServiceException: java.net.ConnectException: Call From scm/172.22.0.6 to scm:9860 failed on connection exception: java.net.ConnectException: Connection refused; For more details see: http://wiki.apache.org/hadoop/ConnectionRefused, while invoking $Proxy20.submitRequest over nodeId=scmNodeId,nodeAddress=scm/172.22.0.6:9860 after 9 failover attempts. Trying to failover after sleeping for 2000ms. com.google.protobuf.ServiceException: java.net.ConnectException: Call From scm/172.22.0.6 to scm:9860 failed on connection exception: java.net.ConnectException: Connection refused; For more details see: http://wiki.apache.org/hadoop/ConnectionRefused, while invoking $Proxy20.submitRequest over nodeId=scmNodeId,nodeAddress=scm/172.22.0.6:9860 after 10 failover attempts. Trying to failover after sleeping for 2000ms. com.google.protobuf.ServiceException: org.apache.hadoop.ipc.RemoteException(org.apache.hadoop.hdds.ratis.ServerNotLeaderException): Server:492684a7-0c5f-46cf-aad5-32841f7c3a78 is not the leader. Could not determine the leader node. at org.apache.hadoop.hdds.ratis.ServerNotLeaderException.convertToNotLeaderException(ServerNotLeaderException.java:109) at org.apache.hadoop.hdds.scm.ha.RatisUtil.checkRatisException(RatisUtil.java:246) at org.apache.hadoop.hdds.scm.protocol.StorageContainerLocationProtocolServerSideTranslatorPB.submitRequest(StorageContainerLocationProtocolServerSideTranslatorPB.java:197) at org.apache.hadoop.hdds.protocol.proto.StorageContainerLocationProtocolProtos$StorageContainerLocationProtocolService$2.callBlockingMethod(StorageContainerLocationProtocolProtos.java:64993) at org.apache.hadoop.ipc.ProtobufRpcEngine$Server.processCall(ProtobufRpcEngine.java:465) at org.apache.hadoop.ipc.ProtobufRpcEngine2$Server$ProtoBufRpcInvoker.call(ProtobufRpcEngine2.java:578) at org.apache.hadoop.ipc.ProtobufRpcEngine2$Server$ProtoBufRpcInvoker.call(ProtobufRpcEngine2.java:556) at org.apache.hadoop.ipc.RPC$Server.call(RPC.java:1093) at org.apache.hadoop.ipc.Server$RpcCall.run(Server.java:1043) at org.apache.hadoop.ipc.Server$RpcCall.run(Server.java:971) at java.base/java.security.AccessController.doPrivileged(Native Method) at java.base/javax.security.auth.Subject.doAs(Subject.java:423) at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1878) at org.apache.hadoop.ipc.Server$Handler.run(Server.java:2976) , while invoking $Proxy20.submitRequest over nodeId=scmNodeId,nodeAddress=scm/172.22.0.6:9860 after 11 failover attempts. Trying to failover after sleeping for 2000ms. SCM is in safe mode. validated:false, DataNodeSafeModeRule, registered datanodes (=0) >= required datanodes (=3) validated:false, HealthyPipelineSafeModeRule, healthy Ratis/THREE pipelines (=0) >= healthyPipelineThresholdCount (=1) validated:true, ContainerSafeModeRule, % of containers with at least one reported replica (=1.00) >= safeModeCutoff (=0.99) validated:true, AtleastOneDatanodeReportedRule, reported Ratis/THREE pipelines with at least one datanode (=0) >= threshold (=0)
SECONDS: 139
SCM is out of safe mode.
Safe mode is off
No OM HA service, no need to wait
==============================================================================
Kinit :: Kinit test user                                                      
==============================================================================
Kinit                                                                 | PASS |
------------------------------------------------------------------------------
Kinit :: Kinit test user                                              | PASS |
1 test, 1 passed, 0 failed
==============================================================================
Output:  /tmp/smoketest/ozonesecure-mr/result/robot-ozonesecure-mr-ozonesecure-mr-kinit-om.xml
==============================================================================
Createmrenv :: Create directories required for MR test                        
==============================================================================
Create test volume, bucket and key                                    | FAIL |
Test timeout 2 minutes exceeded.
------------------------------------------------------------------------------
Create user dir for hadoop                                            | PASS |
------------------------------------------------------------------------------
Createmrenv :: Create directories required for MR test                | FAIL |
2 tests, 1 passed, 1 failed
==============================================================================
Output:  /tmp/smoketest/ozonesecure-mr/result/robot-ozonesecure-mr-ozonesecure-mr-kinit-om-1.xml
jstack 7 > /home/runner/work/ozone/ozone/hadoop-ozone/dist/target/ozone-1.4.0-SNAPSHOT/compose/ozonesecure-mr/result/ozonesecure-mr_datanode_1_HddsDatanodeService.stack
jstack 6 > /home/runner/work/ozone/ozone/hadoop-ozone/dist/target/ozone-1.4.0-SNAPSHOT/compose/ozonesecure-mr/result/ozonesecure-mr_datanode_2_HddsDatanodeService.stack
jstack 6 > /home/runner/work/ozone/ozone/hadoop-ozone/dist/target/ozone-1.4.0-SNAPSHOT/compose/ozonesecure-mr/result/ozonesecure-mr_datanode_3_HddsDatanodeService.stack
jstack 7 > /home/runner/work/ozone/ozone/hadoop-ozone/dist/target/ozone-1.4.0-SNAPSHOT/compose/ozonesecure-mr/result/ozonesecure-mr_om_1_OzoneManagerStarter.stack
jstack 7 > /home/runner/work/ozone/ozone/hadoop-ozone/dist/target/ozone-1.4.0-SNAPSHOT/compose/ozonesecure-mr/result/ozonesecure-mr_s3g_1_Gateway.stack
jstack 7 > /home/runner/work/ozone/ozone/hadoop-ozone/dist/target/ozone-1.4.0-SNAPSHOT/compose/ozonesecure-mr/result/ozonesecure-mr_scm_1_StorageContainerManagerStarter.stack
Stopping ozonesecure-mr_datanode_1 ... 
Stopping ozonesecure-mr_nm_1       ... 
Stopping ozonesecure-mr_s3g_1      ... 
Stopping jhs                       ... 
Stopping ozonesecure-mr_datanode_3 ... 
Stopping ozonesecure-mr_scm_1      ... 
Stopping ozonesecure-mr_om_1       ... 
Stopping ozonesecure-mr_datanode_2 ... 
Stopping ozonesecure-mr_kdc_1      ... 
Stopping ozonesecure-mr_rm_1       ... 
Stopping ozonesecure-mr_kms_1      ... 
Stopping jhs                       ... done
Stopping ozonesecure-mr_kdc_1      ... done
Stopping ozonesecure-mr_kms_1      ... done
Stopping ozonesecure-mr_nm_1       ... done
Stopping ozonesecure-mr_rm_1       ... done
Stopping ozonesecure-mr_s3g_1      ... done
Stopping ozonesecure-mr_om_1       ... done
Stopping ozonesecure-mr_datanode_3 ... done
Stopping ozonesecure-mr_datanode_2 ... done
Stopping ozonesecure-mr_datanode_1 ... done
Stopping ozonesecure-mr_scm_1      ... done
Removing ozonesecure-mr_datanode_1 ... 
Removing ozonesecure-mr_nm_1       ... 
Removing ozonesecure-mr_s3g_1      ... 
Removing jhs                       ... 
Removing ozonesecure-mr_datanode_3 ... 
Removing ozonesecure-mr_scm_1      ... 
Removing ozonesecure-mr_om_1       ... 
Removing ozonesecure-mr_datanode_2 ... 
Removing ozonesecure-mr_kdc_1      ... 
Removing ozonesecure-mr_rm_1       ... 
Removing ozonesecure-mr_kms_1      ... 
Removing ozonesecure-mr_s3g_1      ... done
Removing ozonesecure-mr_datanode_3 ... done
Removing ozonesecure-mr_om_1       ... done
Removing ozonesecure-mr_datanode_1 ... done
Removing ozonesecure-mr_datanode_2 ... done
Removing ozonesecure-mr_rm_1       ... done
Removing ozonesecure-mr_kdc_1      ... done
Removing ozonesecure-mr_nm_1       ... done
Removing jhs                       ... done
Removing ozonesecure-mr_scm_1      ... done
Removing ozonesecure-mr_kms_1      ... done
Removing network ozone
ERROR: Test execution of ozonesecure-mr is FAILED!!!!
Output:  /home/runner/work/ozone/ozone/hadoop-ozone/dist/target/ozone-1.4.0-SNAPSHOT/compose/result/ozonesecure-mr.xml
removed 'ozonesecure-mr/result/robot-ozonesecure-mr-ozonesecure-mr-kinit-om-1.xml'
removed 'ozonesecure-mr/result/robot-ozonesecure-mr-ozonesecure-mr-kinit-om.xml'
renamed 'ozonesecure-mr/result/dn-audit-83be40b35d05.log' -> '/home/runner/work/ozone/ozone/hadoop-ozone/dist/target/ozone-1.4.0-SNAPSHOT/compose/result/ozonesecure-mr/dn-audit-83be40b35d05.log'
renamed 'ozonesecure-mr/result/dn-audit-d80c41abf231.log' -> '/home/runner/work/ozone/ozone/hadoop-ozone/dist/target/ozone-1.4.0-SNAPSHOT/compose/result/ozonesecure-mr/dn-audit-d80c41abf231.log'
renamed 'ozonesecure-mr/result/dn-audit-f9cc5a54da57.log' -> '/home/runner/work/ozone/ozone/hadoop-ozone/dist/target/ozone-1.4.0-SNAPSHOT/compose/result/ozonesecure-mr/dn-audit-f9cc5a54da57.log'
renamed 'ozonesecure-mr/result/docker-ozonesecure-mr-ozonesecure-mr-kinit-om.log' -> '/home/runner/work/ozone/ozone/hadoop-ozone/dist/target/ozone-1.4.0-SNAPSHOT/compose/result/ozonesecure-mr/docker-ozonesecure-mr-ozonesecure-mr-kinit-om.log'
renamed 'ozonesecure-mr/result/om-audit-om.log' -> '/home/runner/work/ozone/ozone/hadoop-ozone/dist/target/ozone-1.4.0-SNAPSHOT/compose/result/ozonesecure-mr/om-audit-om.log'
renamed 'ozonesecure-mr/result/ozonesecure-mr_datanode_1_HddsDatanodeService.stack' -> '/home/runner/work/ozone/ozone/hadoop-ozone/dist/target/ozone-1.4.0-SNAPSHOT/compose/result/ozonesecure-mr/ozonesecure-mr_datanode_1_HddsDatanodeService.stack'
renamed 'ozonesecure-mr/result/ozonesecure-mr_datanode_2_HddsDatanodeService.stack' -> '/home/runner/work/ozone/ozone/hadoop-ozone/dist/target/ozone-1.4.0-SNAPSHOT/compose/result/ozonesecure-mr/ozonesecure-mr_datanode_2_HddsDatanodeService.stack'
renamed 'ozonesecure-mr/result/ozonesecure-mr_datanode_3_HddsDatanodeService.stack' -> '/home/runner/work/ozone/ozone/hadoop-ozone/dist/target/ozone-1.4.0-SNAPSHOT/compose/result/ozonesecure-mr/ozonesecure-mr_datanode_3_HddsDatanodeService.stack'
renamed 'ozonesecure-mr/result/ozonesecure-mr_om_1_OzoneManagerStarter.stack' -> '/home/runner/work/ozone/ozone/hadoop-ozone/dist/target/ozone-1.4.0-SNAPSHOT/compose/result/ozonesecure-mr/ozonesecure-mr_om_1_OzoneManagerStarter.stack'
renamed 'ozonesecure-mr/result/ozonesecure-mr_s3g_1_Gateway.stack' -> '/home/runner/work/ozone/ozone/hadoop-ozone/dist/target/ozone-1.4.0-SNAPSHOT/compose/result/ozonesecure-mr/ozonesecure-mr_s3g_1_Gateway.stack'
renamed 'ozonesecure-mr/result/ozonesecure-mr_scm_1_StorageContainerManagerStarter.stack' -> '/home/runner/work/ozone/ozone/hadoop-ozone/dist/target/ozone-1.4.0-SNAPSHOT/compose/result/ozonesecure-mr/ozonesecure-mr_scm_1_StorageContainerManagerStarter.stack'
renamed 'ozonesecure-mr/result/s3g-audit-s3g.log' -> '/home/runner/work/ozone/ozone/hadoop-ozone/dist/target/ozone-1.4.0-SNAPSHOT/compose/result/ozonesecure-mr/s3g-audit-s3g.log'
renamed 'ozonesecure-mr/result/scm-audit-scm.log' -> '/home/runner/work/ozone/ozone/hadoop-ozone/dist/target/ozone-1.4.0-SNAPSHOT/compose/result/ozonesecure-mr/scm-audit-scm.log'
Exception in thread "main" java.net.SocketException: Socket closed
Log:     /home/runner/work/ozone/ozone/hadoop-ozone/dist/target/ozone-1.4.0-SNAPSHOT/compose/result/log.html
Report:  /home/runner/work/ozone/ozone/hadoop-ozone/dist/target/ozone-1.4.0-SNAPSHOT/compose/result/report.html
