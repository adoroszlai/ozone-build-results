rm: cannot remove '/home/runner/work/ozone/ozone/hadoop-ozone/dist/target/ozone-1.4.0-SNAPSHOT/compose/result/*': No such file or directory
Executing test ozone-csi/test.sh
Removing network ozone-csi_default
Network ozone-csi_default not found.
Creating network "ozone-csi_default" with the default driver
Pulling datanode (apache/ozone-runner:20230503-1)...
20230503-1: Pulling from apache/ozone-runner
Digest: sha256:9c224951bb5655c8b5a0c58a72478a17dc594a75a5e4acb89c93bf0885c3fe73
Status: Downloaded newer image for apache/ozone-runner:20230503-1
Creating ozone-csi_datanode_1 ... 
Creating ozone-csi_datanode_2 ... 
Creating ozone-csi_datanode_3 ... 
Creating ozone-csi_scm_1      ... 
Creating ozone-csi_csi_1      ... 
Creating ozone-csi_om_1       ... 
Creating ozone-csi_csi_1      ... done
Creating ozone-csi_datanode_1 ... done
Creating ozone-csi_datanode_2 ... done
Creating ozone-csi_scm_1      ... done
Creating ozone-csi_om_1       ... done
Creating ozone-csi_datanode_3 ... done
SECONDS: 49
com.google.protobuf.ServiceException: java.net.ConnectException: Call From 87fc2297f180/172.18.0.4 to scm:9860 failed on connection exception: java.net.ConnectException: Connection refused; For more details see: http://wiki.apache.org/hadoop/ConnectionRefused, while invoking $Proxy21.submitRequest over nodeId=scmNodeId,nodeAddress=scm/172.18.0.4:9860 after 1 failover attempts. Trying to failover after sleeping for 2000ms. Current retry count: 1. com.google.protobuf.ServiceException: java.net.ConnectException: Call From 87fc2297f180/172.18.0.4 to scm:9860 failed on connection exception: java.net.ConnectException: Connection refused; For more details see: http://wiki.apache.org/hadoop/ConnectionRefused, while invoking $Proxy21.submitRequest over nodeId=scmNodeId,nodeAddress=scm/172.18.0.4:9860 after 2 failover attempts. Trying to failover after sleeping for 2000ms. Current retry count: 2. com.google.protobuf.ServiceException: java.net.ConnectException: Call From 87fc2297f180/172.18.0.4 to scm:9860 failed on connection exception: java.net.ConnectException: Connection refused; For more details see: http://wiki.apache.org/hadoop/ConnectionRefused, while invoking $Proxy21.submitRequest over nodeId=scmNodeId,nodeAddress=scm/172.18.0.4:9860 after 3 failover attempts. Trying to failover after sleeping for 2000ms. Current retry count: 3. com.google.protobuf.ServiceException: java.net.ConnectException: Call From 87fc2297f180/172.18.0.4 to scm:9860 failed on connection exception: java.net.ConnectException: Connection refused; For more details see: http://wiki.apache.org/hadoop/ConnectionRefused, while invoking $Proxy21.submitRequest over nodeId=scmNodeId,nodeAddress=scm/172.18.0.4:9860 after 4 failover attempts. Trying to failover after sleeping for 2000ms. Current retry count: 4. com.google.protobuf.ServiceException: org.apache.hadoop.ipc.RemoteException(org.apache.hadoop.hdds.ratis.ServerNotLeaderException): Server:e4308e1e-85bb-46cf-8da1-07ce2eb89460 is not the leader. Could not determine the leader node. at org.apache.hadoop.hdds.ratis.ServerNotLeaderException.convertToNotLeaderException(ServerNotLeaderException.java:109) at org.apache.hadoop.hdds.scm.ha.RatisUtil.checkRatisException(RatisUtil.java:249) at org.apache.hadoop.hdds.scm.protocol.StorageContainerLocationProtocolServerSideTranslatorPB.submitRequest(StorageContainerLocationProtocolServerSideTranslatorPB.java:199) at org.apache.hadoop.hdds.protocol.proto.StorageContainerLocationProtocolProtos$StorageContainerLocationProtocolService$2.callBlockingMethod(StorageContainerLocationProtocolProtos.java) at org.apache.hadoop.ipc.ProtobufRpcEngine$Server.processCall(ProtobufRpcEngine.java:484) at org.apache.hadoop.ipc.ProtobufRpcEngine2$Server$ProtoBufRpcInvoker.call(ProtobufRpcEngine2.java:595) at org.apache.hadoop.ipc.ProtobufRpcEngine2$Server$ProtoBufRpcInvoker.call(ProtobufRpcEngine2.java:573) at org.apache.hadoop.ipc.RPC$Server.call(RPC.java:1227) at org.apache.hadoop.ipc.Server$RpcCall.run(Server.java:1094) at org.apache.hadoop.ipc.Server$RpcCall.run(Server.java:1017) at java.base/java.security.AccessController.doPrivileged(Native Method) at java.base/javax.security.auth.Subject.doAs(Subject.java:423) at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1899) at org.apache.hadoop.ipc.Server$Handler.run(Server.java:3048) , while invoking $Proxy21.submitRequest over nodeId=scmNodeId,nodeAddress=scm/172.18.0.4:9860 after 5 failover attempts. Trying to failover after sleeping for 2000ms. Current retry count: 5. com.google.protobuf.ServiceException: org.apache.hadoop.ipc.RemoteException(org.apache.hadoop.hdds.ratis.ServerNotLeaderException): Server:e4308e1e-85bb-46cf-8da1-07ce2eb89460 is not the leader. Could not determine the leader node. at org.apache.hadoop.hdds.ratis.ServerNotLeaderException.convertToNotLeaderException(ServerNotLeaderException.java:109) at org.apache.hadoop.hdds.scm.ha.RatisUtil.checkRatisException(RatisUtil.java:249) at org.apache.hadoop.hdds.scm.protocol.StorageContainerLocationProtocolServerSideTranslatorPB.submitRequest(StorageContainerLocationProtocolServerSideTranslatorPB.java:199) at org.apache.hadoop.hdds.protocol.proto.StorageContainerLocationProtocolProtos$StorageContainerLocationProtocolService$2.callBlockingMethod(StorageContainerLocationProtocolProtos.java) at org.apache.hadoop.ipc.ProtobufRpcEngine$Server.processCall(ProtobufRpcEngine.java:484) at org.apache.hadoop.ipc.ProtobufRpcEngine2$Server$ProtoBufRpcInvoker.call(ProtobufRpcEngine2.java:595) at org.apache.hadoop.ipc.ProtobufRpcEngine2$Server$ProtoBufRpcInvoker.call(ProtobufRpcEngine2.java:573) at org.apache.hadoop.ipc.RPC$Server.call(RPC.java:1227) at org.apache.hadoop.ipc.Server$RpcCall.run(Server.java:1094) at org.apache.hadoop.ipc.Server$RpcCall.run(Server.java:1017) at java.base/java.security.AccessController.doPrivileged(Native Method) at java.base/javax.security.auth.Subject.doAs(Subject.java:423) at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1899) at org.apache.hadoop.ipc.Server$Handler.run(Server.java:3048) , while invoking $Proxy21.submitRequest over nodeId=scmNodeId,nodeAddress=scm/172.18.0.4:9860 after 6 failover attempts. Trying to failover after sleeping for 2000ms. Current retry count: 6. SCM is in safe mode. validated:true, DataNodeSafeModeRule, registered datanodes (=1) >= required datanodes (=1) validated:true, HealthyPipelineSafeModeRule, healthy Ratis/THREE pipelines (=0) >= healthyPipelineThresholdCount (=0) validated:true, ContainerSafeModeRule, % of containers with at least one reported replica (=1.00) >= safeModeCutoff (=0.99) validated:true, AtleastOneDatanodeReportedRule, reported Ratis/THREE pipelines with at least one datanode (=0) >= threshold (=0)
SECONDS: 66
SCM is out of safe mode.
Safe mode is off
No OM HA service, no need to wait
==============================================================================
Csi :: Smoketest Ozone CSI service                                            
==============================================================================
Check if CSI server is started                                        | PASS |
------------------------------------------------------------------------------
Test CSI identity service                                             | PASS |
------------------------------------------------------------------------------
Csi :: Smoketest Ozone CSI service                                    | PASS |
2 tests, 2 passed, 0 failed
==============================================================================
Output:  /tmp/smoketest/ozone-csi/result/robot-ozone-csi-ozone-csi-csi-csi.xml
Stopping ozone-csi_om_1       ... 
Stopping ozone-csi_scm_1      ... 
Stopping ozone-csi_datanode_1 ... 
Stopping ozone-csi_datanode_2 ... 
Stopping ozone-csi_datanode_3 ... 
Stopping ozone-csi_csi_1      ... 
Stopping ozone-csi_csi_1      ... done
Stopping ozone-csi_datanode_1 ... done
Stopping ozone-csi_datanode_3 ... done
Stopping ozone-csi_datanode_2 ... done
Stopping ozone-csi_om_1       ... done
Stopping ozone-csi_scm_1      ... done
Removing ozone-csi_om_1       ... 
Removing ozone-csi_scm_1      ... 
Removing ozone-csi_datanode_1 ... 
Removing ozone-csi_datanode_2 ... 
Removing ozone-csi_datanode_3 ... 
Removing ozone-csi_csi_1      ... 
Removing ozone-csi_csi_1      ... done
Removing ozone-csi_datanode_3 ... done
Removing ozone-csi_datanode_1 ... done
Removing ozone-csi_datanode_2 ... done
Removing ozone-csi_scm_1      ... done
Removing ozone-csi_om_1       ... done
Removing network ozone-csi_default
Output:  /home/runner/work/ozone/ozone/hadoop-ozone/dist/target/ozone-1.4.0-SNAPSHOT/compose/result/ozone-csi.xml
removed 'ozone-csi/result/robot-ozone-csi-ozone-csi-csi-csi.xml'
renamed 'ozone-csi/result/dn-audit-1d29e98e71a2.log' -> '/home/runner/work/ozone/ozone/hadoop-ozone/dist/target/ozone-1.4.0-SNAPSHOT/compose/result/ozone-csi/dn-audit-1d29e98e71a2.log'
renamed 'ozone-csi/result/dn-audit-93b2ddb9963f.log' -> '/home/runner/work/ozone/ozone/hadoop-ozone/dist/target/ozone-1.4.0-SNAPSHOT/compose/result/ozone-csi/dn-audit-93b2ddb9963f.log'
renamed 'ozone-csi/result/dn-audit-ab8856085ea3.log' -> '/home/runner/work/ozone/ozone/hadoop-ozone/dist/target/ozone-1.4.0-SNAPSHOT/compose/result/ozone-csi/dn-audit-ab8856085ea3.log'
renamed 'ozone-csi/result/docker-ozone-csi-ozone-csi-csi-csi.log' -> '/home/runner/work/ozone/ozone/hadoop-ozone/dist/target/ozone-1.4.0-SNAPSHOT/compose/result/ozone-csi/docker-ozone-csi-ozone-csi-csi-csi.log'
renamed 'ozone-csi/result/om-audit-e2e0aa92d20e.log' -> '/home/runner/work/ozone/ozone/hadoop-ozone/dist/target/ozone-1.4.0-SNAPSHOT/compose/result/ozone-csi/om-audit-e2e0aa92d20e.log'
renamed 'ozone-csi/result/scm-audit-87fc2297f180.log' -> '/home/runner/work/ozone/ozone/hadoop-ozone/dist/target/ozone-1.4.0-SNAPSHOT/compose/result/ozone-csi/scm-audit-87fc2297f180.log'
Executing test ozone-om-prepare/test.sh
chown: changing ownership of '/home/runner/work/ozone/ozone/hadoop-ozone/dist/target/ozone-1.4.0-SNAPSHOT/compose/ozone-om-prepare/data/dn1': Operation not permitted
chown: changing ownership of '/home/runner/work/ozone/ozone/hadoop-ozone/dist/target/ozone-1.4.0-SNAPSHOT/compose/ozone-om-prepare/data/dn3': Operation not permitted
chown: changing ownership of '/home/runner/work/ozone/ozone/hadoop-ozone/dist/target/ozone-1.4.0-SNAPSHOT/compose/ozone-om-prepare/data/om2': Operation not permitted
chown: changing ownership of '/home/runner/work/ozone/ozone/hadoop-ozone/dist/target/ozone-1.4.0-SNAPSHOT/compose/ozone-om-prepare/data/om3': Operation not permitted
chown: changing ownership of '/home/runner/work/ozone/ozone/hadoop-ozone/dist/target/ozone-1.4.0-SNAPSHOT/compose/ozone-om-prepare/data/om1': Operation not permitted
chown: changing ownership of '/home/runner/work/ozone/ozone/hadoop-ozone/dist/target/ozone-1.4.0-SNAPSHOT/compose/ozone-om-prepare/data/dn2': Operation not permitted
chown: changing ownership of '/home/runner/work/ozone/ozone/hadoop-ozone/dist/target/ozone-1.4.0-SNAPSHOT/compose/ozone-om-prepare/data/scm': Operation not permitted
chown: changing ownership of '/home/runner/work/ozone/ozone/hadoop-ozone/dist/target/ozone-1.4.0-SNAPSHOT/compose/ozone-om-prepare/data': Operation not permitted
Removing network ozone-om-prepare_net
Network ozone-om-prepare_net not found.
Creating network "ozone-om-prepare_net" with driver "bridge"
Creating ozone-om-prepare_dn3_1 ... 
Creating ozone-om-prepare_dn2_1 ... 
Creating ozone-om-prepare_om1_1 ... 
Creating ozone-om-prepare_scm_1 ... 
Creating ozone-om-prepare_om3_1 ... 
Creating ozone-om-prepare_dn1_1 ... 
Creating ozone-om-prepare_om2_1 ... 
Creating ozone-om-prepare_scm_1 ... done
Creating ozone-om-prepare_dn2_1 ... done
Creating ozone-om-prepare_om3_1 ... done
Creating ozone-om-prepare_om1_1 ... done
Creating ozone-om-prepare_dn3_1 ... done
Creating ozone-om-prepare_om2_1 ... done
Creating ozone-om-prepare_dn1_1 ... done
SECONDS: 46
com.google.protobuf.ServiceException: java.net.ConnectException: Call From 1438767762f6/10.9.0.17 to scm:9860 failed on connection exception: java.net.ConnectException: Connection refused; For more details see: http://wiki.apache.org/hadoop/ConnectionRefused, while invoking $Proxy20.submitRequest over nodeId=scmNodeId,nodeAddress=scm/10.9.0.17:9860 after 1 failover attempts. Trying to failover after sleeping for 2000ms. Current retry count: 1. com.google.protobuf.ServiceException: java.net.ConnectException: Call From 1438767762f6/10.9.0.17 to scm:9860 failed on connection exception: java.net.ConnectException: Connection refused; For more details see: http://wiki.apache.org/hadoop/ConnectionRefused, while invoking $Proxy20.submitRequest over nodeId=scmNodeId,nodeAddress=scm/10.9.0.17:9860 after 2 failover attempts. Trying to failover after sleeping for 2000ms. Current retry count: 2. com.google.protobuf.ServiceException: java.net.ConnectException: Call From 1438767762f6/10.9.0.17 to scm:9860 failed on connection exception: java.net.ConnectException: Connection refused; For more details see: http://wiki.apache.org/hadoop/ConnectionRefused, while invoking $Proxy20.submitRequest over nodeId=scmNodeId,nodeAddress=scm/10.9.0.17:9860 after 3 failover attempts. Trying to failover after sleeping for 2000ms. Current retry count: 3. com.google.protobuf.ServiceException: java.net.ConnectException: Call From 1438767762f6/10.9.0.17 to scm:9860 failed on connection exception: java.net.ConnectException: Connection refused; For more details see: http://wiki.apache.org/hadoop/ConnectionRefused, while invoking $Proxy20.submitRequest over nodeId=scmNodeId,nodeAddress=scm/10.9.0.17:9860 after 4 failover attempts. Trying to failover after sleeping for 2000ms. Current retry count: 4. com.google.protobuf.ServiceException: org.apache.hadoop.ipc.RemoteException(org.apache.hadoop.hdds.ratis.ServerNotLeaderException): Server:935047e3-ec77-4ee7-9903-798ce62cd8ee is not the leader. Could not determine the leader node. at org.apache.hadoop.hdds.ratis.ServerNotLeaderException.convertToNotLeaderException(ServerNotLeaderException.java:109) at org.apache.hadoop.hdds.scm.ha.RatisUtil.checkRatisException(RatisUtil.java:249) at org.apache.hadoop.hdds.scm.protocol.StorageContainerLocationProtocolServerSideTranslatorPB.submitRequest(StorageContainerLocationProtocolServerSideTranslatorPB.java:199) at org.apache.hadoop.hdds.protocol.proto.StorageContainerLocationProtocolProtos$StorageContainerLocationProtocolService$2.callBlockingMethod(StorageContainerLocationProtocolProtos.java) at org.apache.hadoop.ipc.ProtobufRpcEngine$Server.processCall(ProtobufRpcEngine.java:484) at org.apache.hadoop.ipc.ProtobufRpcEngine2$Server$ProtoBufRpcInvoker.call(ProtobufRpcEngine2.java:595) at org.apache.hadoop.ipc.ProtobufRpcEngine2$Server$ProtoBufRpcInvoker.call(ProtobufRpcEngine2.java:573) at org.apache.hadoop.ipc.RPC$Server.call(RPC.java:1227) at org.apache.hadoop.ipc.Server$RpcCall.run(Server.java:1094) at org.apache.hadoop.ipc.Server$RpcCall.run(Server.java:1017) at java.base/java.security.AccessController.doPrivileged(Native Method) at java.base/javax.security.auth.Subject.doAs(Subject.java:423) at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1899) at org.apache.hadoop.ipc.Server$Handler.run(Server.java:3048) , while invoking $Proxy20.submitRequest over nodeId=scmNodeId,nodeAddress=scm/10.9.0.17:9860 after 5 failover attempts. Trying to failover after sleeping for 2000ms. Current retry count: 5. com.google.protobuf.ServiceException: org.apache.hadoop.ipc.RemoteException(org.apache.hadoop.hdds.ratis.ServerNotLeaderException): Server:935047e3-ec77-4ee7-9903-798ce62cd8ee is not the leader. Could not determine the leader node. at org.apache.hadoop.hdds.ratis.ServerNotLeaderException.convertToNotLeaderException(ServerNotLeaderException.java:109) at org.apache.hadoop.hdds.scm.ha.RatisUtil.checkRatisException(RatisUtil.java:249) at org.apache.hadoop.hdds.scm.protocol.StorageContainerLocationProtocolServerSideTranslatorPB.submitRequest(StorageContainerLocationProtocolServerSideTranslatorPB.java:199) at org.apache.hadoop.hdds.protocol.proto.StorageContainerLocationProtocolProtos$StorageContainerLocationProtocolService$2.callBlockingMethod(StorageContainerLocationProtocolProtos.java) at org.apache.hadoop.ipc.ProtobufRpcEngine$Server.processCall(ProtobufRpcEngine.java:484) at org.apache.hadoop.ipc.ProtobufRpcEngine2$Server$ProtoBufRpcInvoker.call(ProtobufRpcEngine2.java:595) at org.apache.hadoop.ipc.ProtobufRpcEngine2$Server$ProtoBufRpcInvoker.call(ProtobufRpcEngine2.java:573) at org.apache.hadoop.ipc.RPC$Server.call(RPC.java:1227) at org.apache.hadoop.ipc.Server$RpcCall.run(Server.java:1094) at org.apache.hadoop.ipc.Server$RpcCall.run(Server.java:1017) at java.base/java.security.AccessController.doPrivileged(Native Method) at java.base/javax.security.auth.Subject.doAs(Subject.java:423) at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1899) at org.apache.hadoop.ipc.Server$Handler.run(Server.java:3048) , while invoking $Proxy20.submitRequest over nodeId=scmNodeId,nodeAddress=scm/10.9.0.17:9860 after 6 failover attempts. Trying to failover after sleeping for 2000ms. Current retry count: 6. SCM is in safe mode. validated:false, DataNodeSafeModeRule, registered datanodes (=0) >= required datanodes (=3) validated:false, HealthyPipelineSafeModeRule, healthy Ratis/THREE pipelines (=0) >= healthyPipelineThresholdCount (=1) validated:true, ContainerSafeModeRule, % of containers with at least one reported replica (=1.00) >= safeModeCutoff (=0.99) validated:true, AtleastOneDatanodeReportedRule, reported Ratis/THREE pipelines with at least one datanode (=0) >= threshold (=0)
SECONDS: 70
SCM is out of safe mode.
Safe mode is off
Found OM leader for service omservice: om3 : LEADER (om3)
Replaced OM order with om3,om2,om1 in ozone-om-prepare_scm_1
==============================================================================
Om-Prepare :: Smoke test to test preparing OMs in an OM HA cluster.           
==============================================================================
Prepare Ozone Manager                                                 | PASS |
------------------------------------------------------------------------------
Checks if the expected data is present in OM                          | PASS |
------------------------------------------------------------------------------
Test write operation fails                                            | PASS |
------------------------------------------------------------------------------
Om-Prepare :: Smoke test to test preparing OMs in an OM HA cluster.   | PASS |
3 tests, 3 passed, 0 failed
==============================================================================
Output:  /tmp/smoketest/ozone-om-prepare/result/robot-ozone-om-prepare-ozone-om-prepare-om-prepare-scm.xml
==============================================================================
Om-Cancel-Prepare :: Smoke test for ozone manager cancel prepare              
==============================================================================
Cancel Ozone Manager Prepare                                          | PASS |
------------------------------------------------------------------------------
Test write operations                                                 | PASS |
------------------------------------------------------------------------------
Om-Cancel-Prepare :: Smoke test for ozone manager cancel prepare      | PASS |
2 tests, 2 passed, 0 failed
==============================================================================
Output:  /tmp/smoketest/ozone-om-prepare/result/robot-ozone-om-prepare-ozone-om-prepare-om-prepare-scm-1.xml
==============================================================================
Om-Prepare :: Smoke test to test preparing OMs in an OM HA cluster.           
==============================================================================
Prepare Ozone Manager                                                 | PASS |
------------------------------------------------------------------------------
Checks if the expected data is present in OM                          | PASS |
------------------------------------------------------------------------------
Test write operation fails                                            | PASS |
------------------------------------------------------------------------------
Om-Prepare :: Smoke test to test preparing OMs in an OM HA cluster.   | PASS |
3 tests, 3 passed, 0 failed
==============================================================================
Output:  /tmp/smoketest/ozone-om-prepare/result/robot-ozone-om-prepare-ozone-om-prepare-om-prepare-scm-2.xml
==============================================================================
Om-Prepared :: Smoke test to test that OMs are prepared in an OM HA cluster.  
==============================================================================
Test create volume fails                                              | PASS |
------------------------------------------------------------------------------
Test list volumes succeeds                                            | PASS |
------------------------------------------------------------------------------
Om-Prepared :: Smoke test to test that OMs are prepared in an OM H... | PASS |
2 tests, 2 passed, 0 failed
==============================================================================
Output:  /tmp/smoketest/ozone-om-prepare/result/robot-ozone-om-prepare-ozone-om-prepare-om-prepare-scm-3.xml
Stopping ozone-om-prepare_om2_1 ... 
Stopping ozone-om-prepare_dn1_1 ... 
Stopping ozone-om-prepare_scm_1 ... 
Stopping ozone-om-prepare_om3_1 ... 
Stopping ozone-om-prepare_dn3_1 ... 
Stopping ozone-om-prepare_om1_1 ... 
Stopping ozone-om-prepare_dn2_1 ... 
Stopping ozone-om-prepare_dn2_1 ... done
Stopping ozone-om-prepare_dn1_1 ... done
Stopping ozone-om-prepare_dn3_1 ... done
Stopping ozone-om-prepare_om3_1 ... done
Stopping ozone-om-prepare_om2_1 ... done
Stopping ozone-om-prepare_om1_1 ... done
Stopping ozone-om-prepare_scm_1 ... done
Removing ozone-om-prepare_om2_1 ... 
Removing ozone-om-prepare_dn1_1 ... 
Removing ozone-om-prepare_scm_1 ... 
Removing ozone-om-prepare_om3_1 ... 
Removing ozone-om-prepare_dn3_1 ... 
Removing ozone-om-prepare_om1_1 ... 
Removing ozone-om-prepare_dn2_1 ... 
Removing ozone-om-prepare_scm_1 ... done
Removing ozone-om-prepare_dn2_1 ... done
Removing ozone-om-prepare_om3_1 ... done
Removing ozone-om-prepare_dn1_1 ... done
Removing ozone-om-prepare_om2_1 ... done
Removing ozone-om-prepare_om1_1 ... done
Removing ozone-om-prepare_dn3_1 ... done
Removing network ozone-om-prepare_net
Removing network ozone-om-prepare_net
Network ozone-om-prepare_net not found.
Creating network "ozone-om-prepare_net" with driver "bridge"
Creating ozone-om-prepare_dn2_1 ... 
Creating ozone-om-prepare_dn1_1 ... 
Creating ozone-om-prepare_om2_1 ... 
Creating ozone-om-prepare_om3_1 ... 
Creating ozone-om-prepare_dn3_1 ... 
Creating ozone-om-prepare_scm_1 ... 
Creating ozone-om-prepare_om1_1 ... 
Creating ozone-om-prepare_om3_1 ... done
Creating ozone-om-prepare_dn3_1 ... done
Creating ozone-om-prepare_scm_1 ... done
Creating ozone-om-prepare_dn1_1 ... done
Creating ozone-om-prepare_om1_1 ... done
Creating ozone-om-prepare_dn2_1 ... done
Creating ozone-om-prepare_om2_1 ... done
SECONDS: 41
com.google.protobuf.ServiceException: org.apache.hadoop.ipc.RemoteException(org.apache.hadoop.hdds.ratis.ServerNotLeaderException): Server:935047e3-ec77-4ee7-9903-798ce62cd8ee is not the leader. Could not determine the leader node. at org.apache.hadoop.hdds.ratis.ServerNotLeaderException.convertToNotLeaderException(ServerNotLeaderException.java:109) at org.apache.hadoop.hdds.scm.ha.RatisUtil.checkRatisException(RatisUtil.java:249) at org.apache.hadoop.hdds.scm.protocol.StorageContainerLocationProtocolServerSideTranslatorPB.submitRequest(StorageContainerLocationProtocolServerSideTranslatorPB.java:199) at org.apache.hadoop.hdds.protocol.proto.StorageContainerLocationProtocolProtos$StorageContainerLocationProtocolService$2.callBlockingMethod(StorageContainerLocationProtocolProtos.java) at org.apache.hadoop.ipc.ProtobufRpcEngine$Server.processCall(ProtobufRpcEngine.java:484) at org.apache.hadoop.ipc.ProtobufRpcEngine2$Server$ProtoBufRpcInvoker.call(ProtobufRpcEngine2.java:595) at org.apache.hadoop.ipc.ProtobufRpcEngine2$Server$ProtoBufRpcInvoker.call(ProtobufRpcEngine2.java:573) at org.apache.hadoop.ipc.RPC$Server.call(RPC.java:1227) at org.apache.hadoop.ipc.Server$RpcCall.run(Server.java:1094) at org.apache.hadoop.ipc.Server$RpcCall.run(Server.java:1017) at java.base/java.security.AccessController.doPrivileged(Native Method) at java.base/javax.security.auth.Subject.doAs(Subject.java:423) at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1899) at org.apache.hadoop.ipc.Server$Handler.run(Server.java:3048) , while invoking $Proxy20.submitRequest over nodeId=scmNodeId,nodeAddress=scm/10.9.0.17:9860 after 1 failover attempts. Trying to failover after sleeping for 2000ms. Current retry count: 1. com.google.protobuf.ServiceException: org.apache.hadoop.ipc.RemoteException(org.apache.hadoop.hdds.ratis.ServerNotLeaderException): Server:935047e3-ec77-4ee7-9903-798ce62cd8ee is not the leader. Could not determine the leader node. at org.apache.hadoop.hdds.ratis.ServerNotLeaderException.convertToNotLeaderException(ServerNotLeaderException.java:109) at org.apache.hadoop.hdds.scm.ha.RatisUtil.checkRatisException(RatisUtil.java:249) at org.apache.hadoop.hdds.scm.protocol.StorageContainerLocationProtocolServerSideTranslatorPB.submitRequest(StorageContainerLocationProtocolServerSideTranslatorPB.java:199) at org.apache.hadoop.hdds.protocol.proto.StorageContainerLocationProtocolProtos$StorageContainerLocationProtocolService$2.callBlockingMethod(StorageContainerLocationProtocolProtos.java) at org.apache.hadoop.ipc.ProtobufRpcEngine$Server.processCall(ProtobufRpcEngine.java:484) at org.apache.hadoop.ipc.ProtobufRpcEngine2$Server$ProtoBufRpcInvoker.call(ProtobufRpcEngine2.java:595) at org.apache.hadoop.ipc.ProtobufRpcEngine2$Server$ProtoBufRpcInvoker.call(ProtobufRpcEngine2.java:573) at org.apache.hadoop.ipc.RPC$Server.call(RPC.java:1227) at org.apache.hadoop.ipc.Server$RpcCall.run(Server.java:1094) at org.apache.hadoop.ipc.Server$RpcCall.run(Server.java:1017) at java.base/java.security.AccessController.doPrivileged(Native Method) at java.base/javax.security.auth.Subject.doAs(Subject.java:423) at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1899) at org.apache.hadoop.ipc.Server$Handler.run(Server.java:3048) , while invoking $Proxy20.submitRequest over nodeId=scmNodeId,nodeAddress=scm/10.9.0.17:9860 after 2 failover attempts. Trying to failover after sleeping for 2000ms. Current retry count: 2. SCM is in safe mode. validated:false, DataNodeSafeModeRule, registered datanodes (=0) >= required datanodes (=3) validated:false, HealthyPipelineSafeModeRule, healthy Ratis/THREE pipelines (=0) >= healthyPipelineThresholdCount (=1) validated:true, ContainerSafeModeRule, % of containers with at least one reported replica (=1.00) >= safeModeCutoff (=0.99) validated:false, AtleastOneDatanodeReportedRule, reported Ratis/THREE pipelines with at least one datanode (=0) >= threshold (=2)
SECONDS: 63
SCM is out of safe mode.
Safe mode is off
Found OM leader for service omservice: om2 : LEADER (om2)
Replaced OM order with om2,om3,om1 in ozone-om-prepare_scm_1
==============================================================================
Om-Prepared :: Smoke test to test that OMs are prepared in an OM HA cluster.  
==============================================================================
Test create volume fails                                              | PASS |
------------------------------------------------------------------------------
Test list volumes succeeds                                            | PASS |
------------------------------------------------------------------------------
Om-Prepared :: Smoke test to test that OMs are prepared in an OM H... | PASS |
2 tests, 2 passed, 0 failed
==============================================================================
Output:  /tmp/smoketest/ozone-om-prepare/result/robot-ozone-om-prepare-ozone-om-prepare-om-prepare-scm-4.xml
Stopping ozone-om-prepare_om1_1 ... 
Stopping ozone-om-prepare_om2_1 ... 
Stopping ozone-om-prepare_scm_1 ... 
Stopping ozone-om-prepare_om3_1 ... 
Stopping ozone-om-prepare_dn1_1 ... 
Stopping ozone-om-prepare_dn3_1 ... 
Stopping ozone-om-prepare_dn2_1 ... 
Stopping ozone-om-prepare_dn2_1 ... done
Stopping ozone-om-prepare_dn3_1 ... done
Stopping ozone-om-prepare_dn1_1 ... done
Stopping ozone-om-prepare_om1_1 ... done
Stopping ozone-om-prepare_om2_1 ... done
Stopping ozone-om-prepare_om3_1 ... done
Stopping ozone-om-prepare_scm_1 ... done
Removing ozone-om-prepare_om1_1 ... 
Removing ozone-om-prepare_om2_1 ... 
Removing ozone-om-prepare_scm_1 ... 
Removing ozone-om-prepare_om3_1 ... 
Removing ozone-om-prepare_dn1_1 ... 
Removing ozone-om-prepare_dn3_1 ... 
Removing ozone-om-prepare_dn2_1 ... 
Removing ozone-om-prepare_dn2_1 ... done
Removing ozone-om-prepare_dn3_1 ... done
Removing ozone-om-prepare_om3_1 ... done
Removing ozone-om-prepare_om2_1 ... done
Removing ozone-om-prepare_dn1_1 ... done
Removing ozone-om-prepare_om1_1 ... done
Removing ozone-om-prepare_scm_1 ... done
Removing network ozone-om-prepare_net
Removing network ozone-om-prepare_net
Network ozone-om-prepare_net not found.
Creating network "ozone-om-prepare_net" with driver "bridge"
Creating ozone-om-prepare_om1_1 ... 
Creating ozone-om-prepare_dn3_1 ... 
Creating ozone-om-prepare_om2_1 ... 
Creating ozone-om-prepare_dn2_1 ... 
Creating ozone-om-prepare_om3_1 ... 
Creating ozone-om-prepare_scm_1 ... 
Creating ozone-om-prepare_dn1_1 ... 
Creating ozone-om-prepare_dn3_1 ... done
Creating ozone-om-prepare_om2_1 ... done
Creating ozone-om-prepare_om3_1 ... done
Creating ozone-om-prepare_scm_1 ... done
Creating ozone-om-prepare_om1_1 ... done
Creating ozone-om-prepare_dn2_1 ... done
Creating ozone-om-prepare_dn1_1 ... done
SECONDS: 41
com.google.protobuf.ServiceException: org.apache.hadoop.ipc.RemoteException(org.apache.hadoop.hdds.ratis.ServerNotLeaderException): Server:935047e3-ec77-4ee7-9903-798ce62cd8ee is not the leader. Could not determine the leader node. at org.apache.hadoop.hdds.ratis.ServerNotLeaderException.convertToNotLeaderException(ServerNotLeaderException.java:109) at org.apache.hadoop.hdds.scm.ha.RatisUtil.checkRatisException(RatisUtil.java:249) at org.apache.hadoop.hdds.scm.protocol.StorageContainerLocationProtocolServerSideTranslatorPB.submitRequest(StorageContainerLocationProtocolServerSideTranslatorPB.java:199) at org.apache.hadoop.hdds.protocol.proto.StorageContainerLocationProtocolProtos$StorageContainerLocationProtocolService$2.callBlockingMethod(StorageContainerLocationProtocolProtos.java) at org.apache.hadoop.ipc.ProtobufRpcEngine$Server.processCall(ProtobufRpcEngine.java:484) at org.apache.hadoop.ipc.ProtobufRpcEngine2$Server$ProtoBufRpcInvoker.call(ProtobufRpcEngine2.java:595) at org.apache.hadoop.ipc.ProtobufRpcEngine2$Server$ProtoBufRpcInvoker.call(ProtobufRpcEngine2.java:573) at org.apache.hadoop.ipc.RPC$Server.call(RPC.java:1227) at org.apache.hadoop.ipc.Server$RpcCall.run(Server.java:1094) at org.apache.hadoop.ipc.Server$RpcCall.run(Server.java:1017) at java.base/java.security.AccessController.doPrivileged(Native Method) at java.base/javax.security.auth.Subject.doAs(Subject.java:423) at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1899) at org.apache.hadoop.ipc.Server$Handler.run(Server.java:3048) , while invoking $Proxy20.submitRequest over nodeId=scmNodeId,nodeAddress=scm/10.9.0.17:9860 after 1 failover attempts. Trying to failover after sleeping for 2000ms. Current retry count: 1. com.google.protobuf.ServiceException: org.apache.hadoop.ipc.RemoteException(org.apache.hadoop.hdds.ratis.ServerNotLeaderException): Server:935047e3-ec77-4ee7-9903-798ce62cd8ee is not the leader. Could not determine the leader node. at org.apache.hadoop.hdds.ratis.ServerNotLeaderException.convertToNotLeaderException(ServerNotLeaderException.java:109) at org.apache.hadoop.hdds.scm.ha.RatisUtil.checkRatisException(RatisUtil.java:249) at org.apache.hadoop.hdds.scm.protocol.StorageContainerLocationProtocolServerSideTranslatorPB.submitRequest(StorageContainerLocationProtocolServerSideTranslatorPB.java:199) at org.apache.hadoop.hdds.protocol.proto.StorageContainerLocationProtocolProtos$StorageContainerLocationProtocolService$2.callBlockingMethod(StorageContainerLocationProtocolProtos.java) at org.apache.hadoop.ipc.ProtobufRpcEngine$Server.processCall(ProtobufRpcEngine.java:484) at org.apache.hadoop.ipc.ProtobufRpcEngine2$Server$ProtoBufRpcInvoker.call(ProtobufRpcEngine2.java:595) at org.apache.hadoop.ipc.ProtobufRpcEngine2$Server$ProtoBufRpcInvoker.call(ProtobufRpcEngine2.java:573) at org.apache.hadoop.ipc.RPC$Server.call(RPC.java:1227) at org.apache.hadoop.ipc.Server$RpcCall.run(Server.java:1094) at org.apache.hadoop.ipc.Server$RpcCall.run(Server.java:1017) at java.base/java.security.AccessController.doPrivileged(Native Method) at java.base/javax.security.auth.Subject.doAs(Subject.java:423) at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1899) at org.apache.hadoop.ipc.Server$Handler.run(Server.java:3048) , while invoking $Proxy20.submitRequest over nodeId=scmNodeId,nodeAddress=scm/10.9.0.17:9860 after 2 failover attempts. Trying to failover after sleeping for 2000ms. Current retry count: 2. SCM is in safe mode. validated:false, DataNodeSafeModeRule, registered datanodes (=0) >= required datanodes (=3) validated:false, HealthyPipelineSafeModeRule, healthy Ratis/THREE pipelines (=0) >= healthyPipelineThresholdCount (=1) validated:true, ContainerSafeModeRule, % of containers with at least one reported replica (=1.00) >= safeModeCutoff (=0.99) validated:false, AtleastOneDatanodeReportedRule, reported Ratis/THREE pipelines with at least one datanode (=0) >= threshold (=2)
SECONDS: 65
SCM is out of safe mode.
Safe mode is off
Found OM leader for service omservice: om3 : LEADER (om3)
Replaced OM order with om3,om2,om1 in ozone-om-prepare_scm_1
==============================================================================
Loaddata :: Smoketest ozone cluster startup                                   
==============================================================================
Create a volume, bucket and key                                       | PASS |
------------------------------------------------------------------------------
Loaddata :: Smoketest ozone cluster startup                           | PASS |
1 test, 1 passed, 0 failed
==============================================================================
Output:  /tmp/smoketest/ozone-om-prepare/result/robot-ozone-om-prepare-ozone-om-prepare-om-prepare-scm-5.xml
==============================================================================
Readdata :: Smoketest ozone cluster startup                                   
==============================================================================
Read data from previously created key                                 | PASS |
------------------------------------------------------------------------------
Readdata :: Smoketest ozone cluster startup                           | PASS |
1 test, 1 passed, 0 failed
==============================================================================
Output:  /tmp/smoketest/ozone-om-prepare/result/robot-ozone-om-prepare-ozone-om-prepare-om-prepare-scm-6.xml
Stopping ozone-om-prepare_om3_1 ... 
Stopping ozone-om-prepare_scm_1 ... 
Stopping ozone-om-prepare_dn1_1 ... 
Stopping ozone-om-prepare_dn2_1 ... 
Stopping ozone-om-prepare_om2_1 ... 
Stopping ozone-om-prepare_om1_1 ... 
Stopping ozone-om-prepare_dn3_1 ... 
Stopping ozone-om-prepare_om2_1 ... done
Stopping ozone-om-prepare_om3_1 ... done
Stopping ozone-om-prepare_om1_1 ... done
Stopping ozone-om-prepare_dn2_1 ... done
Stopping ozone-om-prepare_dn1_1 ... done
Stopping ozone-om-prepare_dn3_1 ... done
Stopping ozone-om-prepare_scm_1 ... done
Removing ozone-om-prepare_om3_1 ... 
Removing ozone-om-prepare_scm_1 ... 
Removing ozone-om-prepare_dn1_1 ... 
Removing ozone-om-prepare_dn2_1 ... 
Removing ozone-om-prepare_om2_1 ... 
Removing ozone-om-prepare_om1_1 ... 
Removing ozone-om-prepare_dn3_1 ... 
Removing ozone-om-prepare_om2_1 ... done
Removing ozone-om-prepare_om1_1 ... done
Removing ozone-om-prepare_dn1_1 ... done
Removing ozone-om-prepare_om3_1 ... done
Removing ozone-om-prepare_dn3_1 ... done
Removing ozone-om-prepare_dn2_1 ... done
Removing ozone-om-prepare_scm_1 ... done
Removing network ozone-om-prepare_net
Output:  /home/runner/work/ozone/ozone/hadoop-ozone/dist/target/ozone-1.4.0-SNAPSHOT/compose/result/ozone-om-prepare.xml
removed 'ozone-om-prepare/result/robot-ozone-om-prepare-ozone-om-prepare-om-prepare-scm-1.xml'
removed 'ozone-om-prepare/result/robot-ozone-om-prepare-ozone-om-prepare-om-prepare-scm-2.xml'
removed 'ozone-om-prepare/result/robot-ozone-om-prepare-ozone-om-prepare-om-prepare-scm-3.xml'
removed 'ozone-om-prepare/result/robot-ozone-om-prepare-ozone-om-prepare-om-prepare-scm-4.xml'
removed 'ozone-om-prepare/result/robot-ozone-om-prepare-ozone-om-prepare-om-prepare-scm-5.xml'
removed 'ozone-om-prepare/result/robot-ozone-om-prepare-ozone-om-prepare-om-prepare-scm-6.xml'
removed 'ozone-om-prepare/result/robot-ozone-om-prepare-ozone-om-prepare-om-prepare-scm.xml'
renamed 'ozone-om-prepare/result/dn-audit-091b43733307.log' -> '/home/runner/work/ozone/ozone/hadoop-ozone/dist/target/ozone-1.4.0-SNAPSHOT/compose/result/ozone-om-prepare/dn-audit-091b43733307.log'
renamed 'ozone-om-prepare/result/dn-audit-1a669f69d7a6.log' -> '/home/runner/work/ozone/ozone/hadoop-ozone/dist/target/ozone-1.4.0-SNAPSHOT/compose/result/ozone-om-prepare/dn-audit-1a669f69d7a6.log'
renamed 'ozone-om-prepare/result/dn-audit-44557cd5422e.log' -> '/home/runner/work/ozone/ozone/hadoop-ozone/dist/target/ozone-1.4.0-SNAPSHOT/compose/result/ozone-om-prepare/dn-audit-44557cd5422e.log'
renamed 'ozone-om-prepare/result/dn-audit-457ff4e36e37.log' -> '/home/runner/work/ozone/ozone/hadoop-ozone/dist/target/ozone-1.4.0-SNAPSHOT/compose/result/ozone-om-prepare/dn-audit-457ff4e36e37.log'
renamed 'ozone-om-prepare/result/dn-audit-66be2ad5bb39.log' -> '/home/runner/work/ozone/ozone/hadoop-ozone/dist/target/ozone-1.4.0-SNAPSHOT/compose/result/ozone-om-prepare/dn-audit-66be2ad5bb39.log'
renamed 'ozone-om-prepare/result/dn-audit-73522d5ec818.log' -> '/home/runner/work/ozone/ozone/hadoop-ozone/dist/target/ozone-1.4.0-SNAPSHOT/compose/result/ozone-om-prepare/dn-audit-73522d5ec818.log'
renamed 'ozone-om-prepare/result/dn-audit-7bcc64f36fd7.log' -> '/home/runner/work/ozone/ozone/hadoop-ozone/dist/target/ozone-1.4.0-SNAPSHOT/compose/result/ozone-om-prepare/dn-audit-7bcc64f36fd7.log'
renamed 'ozone-om-prepare/result/dn-audit-c631394e6c46.log' -> '/home/runner/work/ozone/ozone/hadoop-ozone/dist/target/ozone-1.4.0-SNAPSHOT/compose/result/ozone-om-prepare/dn-audit-c631394e6c46.log'
renamed 'ozone-om-prepare/result/dn-audit-e83171d367a5.log' -> '/home/runner/work/ozone/ozone/hadoop-ozone/dist/target/ozone-1.4.0-SNAPSHOT/compose/result/ozone-om-prepare/dn-audit-e83171d367a5.log'
renamed 'ozone-om-prepare/result/docker-ozone-om-prepare-ozone-om-prepare-om-prepare-scm.log' -> '/home/runner/work/ozone/ozone/hadoop-ozone/dist/target/ozone-1.4.0-SNAPSHOT/compose/result/ozone-om-prepare/docker-ozone-om-prepare-ozone-om-prepare-om-prepare-scm.log'
renamed 'ozone-om-prepare/result/om-audit-0de629a5e9c4.log' -> '/home/runner/work/ozone/ozone/hadoop-ozone/dist/target/ozone-1.4.0-SNAPSHOT/compose/result/ozone-om-prepare/om-audit-0de629a5e9c4.log'
renamed 'ozone-om-prepare/result/om-audit-7117c7b2e725.log' -> '/home/runner/work/ozone/ozone/hadoop-ozone/dist/target/ozone-1.4.0-SNAPSHOT/compose/result/ozone-om-prepare/om-audit-7117c7b2e725.log'
renamed 'ozone-om-prepare/result/om-audit-7bc44902b09b.log' -> '/home/runner/work/ozone/ozone/hadoop-ozone/dist/target/ozone-1.4.0-SNAPSHOT/compose/result/ozone-om-prepare/om-audit-7bc44902b09b.log'
renamed 'ozone-om-prepare/result/om-audit-bfbcce326d8d.log' -> '/home/runner/work/ozone/ozone/hadoop-ozone/dist/target/ozone-1.4.0-SNAPSHOT/compose/result/ozone-om-prepare/om-audit-bfbcce326d8d.log'
renamed 'ozone-om-prepare/result/om-audit-ce43127823b7.log' -> '/home/runner/work/ozone/ozone/hadoop-ozone/dist/target/ozone-1.4.0-SNAPSHOT/compose/result/ozone-om-prepare/om-audit-ce43127823b7.log'
renamed 'ozone-om-prepare/result/om-audit-d0cc72d32570.log' -> '/home/runner/work/ozone/ozone/hadoop-ozone/dist/target/ozone-1.4.0-SNAPSHOT/compose/result/ozone-om-prepare/om-audit-d0cc72d32570.log'
renamed 'ozone-om-prepare/result/om-audit-d96be253e779.log' -> '/home/runner/work/ozone/ozone/hadoop-ozone/dist/target/ozone-1.4.0-SNAPSHOT/compose/result/ozone-om-prepare/om-audit-d96be253e779.log'
renamed 'ozone-om-prepare/result/om-audit-e5c66e58d613.log' -> '/home/runner/work/ozone/ozone/hadoop-ozone/dist/target/ozone-1.4.0-SNAPSHOT/compose/result/ozone-om-prepare/om-audit-e5c66e58d613.log'
renamed 'ozone-om-prepare/result/om-audit-e94a380a0647.log' -> '/home/runner/work/ozone/ozone/hadoop-ozone/dist/target/ozone-1.4.0-SNAPSHOT/compose/result/ozone-om-prepare/om-audit-e94a380a0647.log'
renamed 'ozone-om-prepare/result/scm-audit-1438767762f6.log' -> '/home/runner/work/ozone/ozone/hadoop-ozone/dist/target/ozone-1.4.0-SNAPSHOT/compose/result/ozone-om-prepare/scm-audit-1438767762f6.log'
renamed 'ozone-om-prepare/result/scm-audit-98243d2afdbd.log' -> '/home/runner/work/ozone/ozone/hadoop-ozone/dist/target/ozone-1.4.0-SNAPSHOT/compose/result/ozone-om-prepare/scm-audit-98243d2afdbd.log'
renamed 'ozone-om-prepare/result/scm-audit-9e89731a65c5.log' -> '/home/runner/work/ozone/ozone/hadoop-ozone/dist/target/ozone-1.4.0-SNAPSHOT/compose/result/ozone-om-prepare/scm-audit-9e89731a65c5.log'
Executing test ozone-topology/test.sh
Removing network ozone-topology_net
Network ozone-topology_net not found.
Creating network "ozone-topology_net" with driver "bridge"
Creating ozone-topology_datanode_6_1 ... 
Creating ozone-topology_om_1         ... 
Creating ozone-topology_datanode_2_1 ... 
Creating ozone-topology_datanode_4_1 ... 
Creating ozone-topology_recon_1      ... 
Creating ozone-topology_scm_1        ... 
Creating ozone-topology_datanode_5_1 ... 
Creating ozone-topology_datanode_1_1 ... 
Creating ozone-topology_datanode_3_1 ... 
Creating ozone-topology_datanode_4_1 ... done
Creating ozone-topology_om_1         ... done
Creating ozone-topology_datanode_2_1 ... done
Creating ozone-topology_recon_1      ... done
Creating ozone-topology_datanode_1_1 ... done
Creating ozone-topology_datanode_6_1 ... done
Creating ozone-topology_scm_1        ... done
Creating ozone-topology_datanode_3_1 ... done
Creating ozone-topology_datanode_5_1 ... done
SECONDS: 76
com.google.protobuf.ServiceException: java.net.ConnectException: Call From 15357ccf2e51/10.5.0.71 to scm:9860 failed on connection exception: java.net.ConnectException: Connection refused; For more details see: http://wiki.apache.org/hadoop/ConnectionRefused, while invoking $Proxy21.submitRequest over nodeId=scmNodeId,nodeAddress=scm/10.5.0.71:9860 after 1 failover attempts. Trying to failover after sleeping for 2000ms. Current retry count: 1. com.google.protobuf.ServiceException: java.net.ConnectException: Call From 15357ccf2e51/10.5.0.71 to scm:9860 failed on connection exception: java.net.ConnectException: Connection refused; For more details see: http://wiki.apache.org/hadoop/ConnectionRefused, while invoking $Proxy21.submitRequest over nodeId=scmNodeId,nodeAddress=scm/10.5.0.71:9860 after 2 failover attempts. Trying to failover after sleeping for 2000ms. Current retry count: 2. com.google.protobuf.ServiceException: java.net.ConnectException: Call From 15357ccf2e51/10.5.0.71 to scm:9860 failed on connection exception: java.net.ConnectException: Connection refused; For more details see: http://wiki.apache.org/hadoop/ConnectionRefused, while invoking $Proxy21.submitRequest over nodeId=scmNodeId,nodeAddress=scm/10.5.0.71:9860 after 3 failover attempts. Trying to failover after sleeping for 2000ms. Current retry count: 3. com.google.protobuf.ServiceException: java.net.ConnectException: Call From 15357ccf2e51/10.5.0.71 to scm:9860 failed on connection exception: java.net.ConnectException: Connection refused; For more details see: http://wiki.apache.org/hadoop/ConnectionRefused, while invoking $Proxy21.submitRequest over nodeId=scmNodeId,nodeAddress=scm/10.5.0.71:9860 after 4 failover attempts. Trying to failover after sleeping for 2000ms. Current retry count: 4. com.google.protobuf.ServiceException: org.apache.hadoop.ipc.RemoteException(org.apache.hadoop.hdds.ratis.ServerNotLeaderException): Server:ec38c3cc-c134-41c8-8af1-3826f38cee2e is not the leader. Could not determine the leader node. at org.apache.hadoop.hdds.ratis.ServerNotLeaderException.convertToNotLeaderException(ServerNotLeaderException.java:109) at org.apache.hadoop.hdds.scm.ha.RatisUtil.checkRatisException(RatisUtil.java:249) at org.apache.hadoop.hdds.scm.protocol.StorageContainerLocationProtocolServerSideTranslatorPB.submitRequest(StorageContainerLocationProtocolServerSideTranslatorPB.java:199) at org.apache.hadoop.hdds.protocol.proto.StorageContainerLocationProtocolProtos$StorageContainerLocationProtocolService$2.callBlockingMethod(StorageContainerLocationProtocolProtos.java) at org.apache.hadoop.ipc.ProtobufRpcEngine$Server.processCall(ProtobufRpcEngine.java:484) at org.apache.hadoop.ipc.ProtobufRpcEngine2$Server$ProtoBufRpcInvoker.call(ProtobufRpcEngine2.java:595) at org.apache.hadoop.ipc.ProtobufRpcEngine2$Server$ProtoBufRpcInvoker.call(ProtobufRpcEngine2.java:573) at org.apache.hadoop.ipc.RPC$Server.call(RPC.java:1227) at org.apache.hadoop.ipc.Server$RpcCall.run(Server.java:1094) at org.apache.hadoop.ipc.Server$RpcCall.run(Server.java:1017) at java.base/java.security.AccessController.doPrivileged(Native Method) at java.base/javax.security.auth.Subject.doAs(Subject.java:423) at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1899) at org.apache.hadoop.ipc.Server$Handler.run(Server.java:3048) , while invoking $Proxy21.submitRequest over nodeId=scmNodeId,nodeAddress=scm/10.5.0.71:9860 after 5 failover attempts. Trying to failover after sleeping for 2000ms. Current retry count: 5. com.google.protobuf.ServiceException: org.apache.hadoop.ipc.RemoteException(org.apache.hadoop.hdds.ratis.ServerNotLeaderException): Server:ec38c3cc-c134-41c8-8af1-3826f38cee2e is not the leader. Could not determine the leader node. at org.apache.hadoop.hdds.ratis.ServerNotLeaderException.convertToNotLeaderException(ServerNotLeaderException.java:109) at org.apache.hadoop.hdds.scm.ha.RatisUtil.checkRatisException(RatisUtil.java:249) at org.apache.hadoop.hdds.scm.protocol.StorageContainerLocationProtocolServerSideTranslatorPB.submitRequest(StorageContainerLocationProtocolServerSideTranslatorPB.java:199) at org.apache.hadoop.hdds.protocol.proto.StorageContainerLocationProtocolProtos$StorageContainerLocationProtocolService$2.callBlockingMethod(StorageContainerLocationProtocolProtos.java) at org.apache.hadoop.ipc.ProtobufRpcEngine$Server.processCall(ProtobufRpcEngine.java:484) at org.apache.hadoop.ipc.ProtobufRpcEngine2$Server$ProtoBufRpcInvoker.call(ProtobufRpcEngine2.java:595) at org.apache.hadoop.ipc.ProtobufRpcEngine2$Server$ProtoBufRpcInvoker.call(ProtobufRpcEngine2.java:573) at org.apache.hadoop.ipc.RPC$Server.call(RPC.java:1227) at org.apache.hadoop.ipc.Server$RpcCall.run(Server.java:1094) at org.apache.hadoop.ipc.Server$RpcCall.run(Server.java:1017) at java.base/java.security.AccessController.doPrivileged(Native Method) at java.base/javax.security.auth.Subject.doAs(Subject.java:423) at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1899) at org.apache.hadoop.ipc.Server$Handler.run(Server.java:3048) , while invoking $Proxy21.submitRequest over nodeId=scmNodeId,nodeAddress=scm/10.5.0.71:9860 after 6 failover attempts. Trying to failover after sleeping for 2000ms. Current retry count: 6. SCM is in safe mode. validated:false, DataNodeSafeModeRule, registered datanodes (=3) >= required datanodes (=4) validated:false, HealthyPipelineSafeModeRule, healthy Ratis/THREE pipelines (=0) >= healthyPipelineThresholdCount (=1) validated:true, ContainerSafeModeRule, % of containers with at least one reported replica (=1.00) >= safeModeCutoff (=0.99) validated:true, AtleastOneDatanodeReportedRule, reported Ratis/THREE pipelines with at least one datanode (=0) >= threshold (=0)
SECONDS: 99
SCM is out of safe mode.
Safe mode is off
No OM HA service, no need to wait
==============================================================================
Basic :: Smoketest ozone cluster startup                                      
==============================================================================
Check webui static resources                                          | PASS |
------------------------------------------------------------------------------
Basic Freon smoketest                                                 | PASS |
------------------------------------------------------------------------------
Basic :: Smoketest ozone cluster startup                              | PASS |
2 tests, 2 passed, 0 failed
==============================================================================
Output:  /tmp/smoketest/ozone-topology/result/robot-ozone-topology-ozone-topology-basic-scm.xml
==============================================================================
Cli :: Smoketest ozone cluster startup                                        
==============================================================================
Run printTopology                                                     | PASS |
------------------------------------------------------------------------------
Run printTopology -o                                                  | PASS |
------------------------------------------------------------------------------
Run printTopology --operational-state IN_SERVICE                      | PASS |
------------------------------------------------------------------------------
Run printTopology --node-state HEALTHY                                | PASS |
------------------------------------------------------------------------------
Cli :: Smoketest ozone cluster startup                                | PASS |
4 tests, 4 passed, 0 failed
==============================================================================
Output:  /tmp/smoketest/ozone-topology/result/robot-ozone-topology-ozone-topology-basic-scm-1.xml
==============================================================================
Recon                                                                         
==============================================================================
Recon.Recon-Api :: Smoke test to start cluster with docker-compose environm...
==============================================================================
Check if Recon picks up OM data                                       | PASS |
------------------------------------------------------------------------------
Check if Recon picks up DN heartbeats                                 | PASS |
------------------------------------------------------------------------------
Check if Recon Web UI is up                                           | PASS |
------------------------------------------------------------------------------
Check web UI access                                                   | PASS |
------------------------------------------------------------------------------
Check admin only api access                                           | PASS |
------------------------------------------------------------------------------
Check unhealthy, (admin) api access                                   | PASS |
------------------------------------------------------------------------------
Check normal api access                                               | PASS |
------------------------------------------------------------------------------
Recon.Recon-Api :: Smoke test to start cluster with docker-compose... | PASS |
7 tests, 7 passed, 0 failed
==============================================================================
Recon.Recon-Nssummary :: Smoke test for Recon Namespace Summary Endpoint fo...
==============================================================================
Check volume creation                                                 | PASS |
------------------------------------------------------------------------------
Check bucket creation                                                 | PASS |
------------------------------------------------------------------------------
Check keys creation                                                   | PASS |
------------------------------------------------------------------------------
Check Summary api access                                              | PASS |
------------------------------------------------------------------------------
Check Disk Usage api access                                           | PASS |
------------------------------------------------------------------------------
Check Quota Usage api access                                          | PASS |
------------------------------------------------------------------------------
Check File Size Distribution api access                               | PASS |
------------------------------------------------------------------------------
Check Recon Namespace Summary Root                                    | PASS |
------------------------------------------------------------------------------
Check Recon Namespace Summary Volume                                  | PASS |
------------------------------------------------------------------------------
Check Recon Namespace Summary Bucket                                  | PASS |
------------------------------------------------------------------------------
Check Recon Namespace Summary Key                                     | PASS |
------------------------------------------------------------------------------
Check Recon Namespace Summary Directory                               | PASS |
------------------------------------------------------------------------------
Check Recon Namespace Disk Usage                                      | PASS |
------------------------------------------------------------------------------
Check Recon Namespace Volume Quota Usage                              | PASS |
------------------------------------------------------------------------------
Check Recon Namespace Bucket Quota Usage                              | PASS |
------------------------------------------------------------------------------
Check Recon Namespace File Size Distribution Root                     | PASS |
------------------------------------------------------------------------------
Recon.Recon-Nssummary :: Smoke test for Recon Namespace Summary En... | PASS |
16 tests, 16 passed, 0 failed
==============================================================================
Recon                                                                 | PASS |
23 tests, 23 passed, 0 failed
==============================================================================
Output:  /tmp/smoketest/ozone-topology/result/robot-ozone-topology-ozone-topology-basic-scm-2.xml
==============================================================================
Loaddata :: Smoketest ozone cluster startup                                   
==============================================================================
Create a volume, bucket and key                                       | PASS |
------------------------------------------------------------------------------
Loaddata :: Smoketest ozone cluster startup                           | PASS |
1 test, 1 passed, 0 failed
==============================================================================
Output:  /tmp/smoketest/ozone-topology/result/robot-ozone-topology-ozone-topology-basic-scm-3.xml
Stopping ozone-topology_datanode_3_1 ... 
Stopping ozone-topology_datanode_1_1 ... 
Stopping ozone-topology_datanode_2_1 ... 
Stopping ozone-topology_datanode_2_1 ... done
Stopping ozone-topology_datanode_3_1 ... done
Stopping ozone-topology_datanode_1_1 ... done
==============================================================================
readdata-first-half :: Smoketest ozone cluster startup                        
==============================================================================
Read data from previously created key                                 | PASS |
------------------------------------------------------------------------------
readdata-first-half :: Smoketest ozone cluster startup                | PASS |
1 test, 1 passed, 0 failed
==============================================================================
Output:  /tmp/smoketest/ozone-topology/result/robot-ozone-topology-ozone-topology-basic-scm-4.xml
Starting datanode_1 ... 
Starting datanode_2 ... 
Starting datanode_3 ... 
Starting datanode_1 ... done
Starting datanode_2 ... done
Starting datanode_3 ... done
Port 9858 is not available on datanode_1 yet
Port 9858 is not available on datanode_1 yet
Port 9858 is not available on datanode_1 yet
Port 9858 is not available on datanode_1 yet
Port 9858 is not available on datanode_1 yet
Port 9858 is not available on datanode_1 yet
Port 9858 is not available on datanode_1 yet
Port 9858 is not available on datanode_1 yet
Port 9858 is not available on datanode_1 yet
Port 9858 is not available on datanode_1 yet
Port 9858 is not available on datanode_1 yet
Port 9858 is not available on datanode_1 yet
Port 9858 is not available on datanode_1 yet
Port 9858 is not available on datanode_1 yet
Port 9858 is not available on datanode_1 yet
Port 9858 is not available on datanode_1 yet
Port 9858 is not available on datanode_1 yet
Port 9858 is not available on datanode_1 yet
Port 9858 is available on datanode_1
Port 9858 is available on datanode_2
Port 9858 is available on datanode_3
Stopping ozone-topology_datanode_5_1 ... 
Stopping ozone-topology_datanode_4_1 ... 
Stopping ozone-topology_datanode_6_1 ... 
Stopping ozone-topology_datanode_5_1 ... done
Stopping ozone-topology_datanode_6_1 ... done
Stopping ozone-topology_datanode_4_1 ... done
==============================================================================
readdata-second-half :: Smoketest ozone cluster startup                       
==============================================================================
Read data from previously created key                                 | PASS |
------------------------------------------------------------------------------
readdata-second-half :: Smoketest ozone cluster startup               | PASS |
1 test, 1 passed, 0 failed
==============================================================================
Output:  /tmp/smoketest/ozone-topology/result/robot-ozone-topology-ozone-topology-basic-scm-5.xml
Stopping ozone-topology_datanode_3_1 ... 
Stopping ozone-topology_scm_1        ... 
Stopping ozone-topology_recon_1      ... 
Stopping ozone-topology_datanode_1_1 ... 
Stopping ozone-topology_om_1         ... 
Stopping ozone-topology_datanode_2_1 ... 
Stopping ozone-topology_datanode_2_1 ... done
Stopping ozone-topology_recon_1      ... done
Stopping ozone-topology_om_1         ... done
Stopping ozone-topology_datanode_3_1 ... done
Stopping ozone-topology_datanode_1_1 ... done
Stopping ozone-topology_scm_1        ... done
Removing ozone-topology_datanode_3_1 ... 
Removing ozone-topology_scm_1        ... 
Removing ozone-topology_datanode_5_1 ... 
Removing ozone-topology_recon_1      ... 
Removing ozone-topology_datanode_1_1 ... 
Removing ozone-topology_datanode_4_1 ... 
Removing ozone-topology_om_1         ... 
Removing ozone-topology_datanode_2_1 ... 
Removing ozone-topology_datanode_6_1 ... 
Removing ozone-topology_scm_1        ... done
Removing ozone-topology_datanode_5_1 ... done
Removing ozone-topology_om_1         ... done
Removing ozone-topology_datanode_2_1 ... done
Removing ozone-topology_datanode_3_1 ... done
Removing ozone-topology_datanode_4_1 ... done
Removing ozone-topology_datanode_6_1 ... done
Removing ozone-topology_datanode_1_1 ... done
Removing ozone-topology_recon_1      ... done
Removing network ozone-topology_net
Output:  /home/runner/work/ozone/ozone/hadoop-ozone/dist/target/ozone-1.4.0-SNAPSHOT/compose/result/ozone-topology.xml
removed 'ozone-topology/result/robot-ozone-topology-ozone-topology-basic-scm-1.xml'
removed 'ozone-topology/result/robot-ozone-topology-ozone-topology-basic-scm-2.xml'
removed 'ozone-topology/result/robot-ozone-topology-ozone-topology-basic-scm-3.xml'
removed 'ozone-topology/result/robot-ozone-topology-ozone-topology-basic-scm-4.xml'
removed 'ozone-topology/result/robot-ozone-topology-ozone-topology-basic-scm-5.xml'
removed 'ozone-topology/result/robot-ozone-topology-ozone-topology-basic-scm.xml'
renamed 'ozone-topology/result/dn-audit-5a8598c2fe38.log' -> '/home/runner/work/ozone/ozone/hadoop-ozone/dist/target/ozone-1.4.0-SNAPSHOT/compose/result/ozone-topology/dn-audit-5a8598c2fe38.log'
renamed 'ozone-topology/result/dn-audit-827c83e56d18.log' -> '/home/runner/work/ozone/ozone/hadoop-ozone/dist/target/ozone-1.4.0-SNAPSHOT/compose/result/ozone-topology/dn-audit-827c83e56d18.log'
renamed 'ozone-topology/result/dn-audit-cf9e3e6ba3c1.log' -> '/home/runner/work/ozone/ozone/hadoop-ozone/dist/target/ozone-1.4.0-SNAPSHOT/compose/result/ozone-topology/dn-audit-cf9e3e6ba3c1.log'
renamed 'ozone-topology/result/docker-ozone-topology-ozone-topology-basic-scm.log' -> '/home/runner/work/ozone/ozone/hadoop-ozone/dist/target/ozone-1.4.0-SNAPSHOT/compose/result/ozone-topology/docker-ozone-topology-ozone-topology-basic-scm.log'
renamed 'ozone-topology/result/om-audit-f3146e1c87e4.log' -> '/home/runner/work/ozone/ozone/hadoop-ozone/dist/target/ozone-1.4.0-SNAPSHOT/compose/result/ozone-topology/om-audit-f3146e1c87e4.log'
renamed 'ozone-topology/result/scm-audit-15357ccf2e51.log' -> '/home/runner/work/ozone/ozone/hadoop-ozone/dist/target/ozone-1.4.0-SNAPSHOT/compose/result/ozone-topology/scm-audit-15357ccf2e51.log'
Executing test ozone/test-s3-haproxy.sh
Removing network ozone_default
Network ozone_default not found.
Creating network "ozone_default" with the default driver
Pulling s3g (haproxy:lts-alpine)...
lts-alpine: Pulling from library/haproxy
Digest: sha256:f2a5ed55791e7a47c40e6faa9ff36c0e1dc743a232f132eadc01c6aaec0387de
Status: Downloaded newer image for haproxy:lts-alpine
Creating ozone_om_1 ... 
Creating ozone_recon_1 ... 
Creating ozone_s3g1_1  ... 
Creating ozone_scm_1   ... 
Creating ozone_s3g2_1  ... 
Creating ozone_s3g3_1  ... 
Creating ozone_datanode_1 ... 
Creating ozone_httpfs_1   ... 
Creating ozone_datanode_2 ... 
Creating ozone_datanode_3 ... 
Creating ozone_s3g_1      ... 
Creating ozone_recon_1    ... done
Creating ozone_om_1       ... done
Creating ozone_httpfs_1   ... done
Creating ozone_s3g1_1     ... done
Creating ozone_s3g3_1     ... done
Creating ozone_s3g2_1     ... done
Creating ozone_scm_1      ... done
Creating ozone_datanode_1 ... done
Creating ozone_s3g_1      ... done
Creating ozone_datanode_3 ... done
Creating ozone_datanode_2 ... done
SECONDS: 75
com.google.protobuf.ServiceException: java.net.ConnectException: Call From 0e48f7ec0a7a/172.19.0.6 to scm:9860 failed on connection exception: java.net.ConnectException: Connection refused; For more details see: http://wiki.apache.org/hadoop/ConnectionRefused, while invoking $Proxy21.submitRequest over nodeId=scmNodeId,nodeAddress=scm/172.19.0.6:9860 after 1 failover attempts. Trying to failover after sleeping for 2000ms. Current retry count: 1. com.google.protobuf.ServiceException: java.net.ConnectException: Call From 0e48f7ec0a7a/172.19.0.6 to scm:9860 failed on connection exception: java.net.ConnectException: Connection refused; For more details see: http://wiki.apache.org/hadoop/ConnectionRefused, while invoking $Proxy21.submitRequest over nodeId=scmNodeId,nodeAddress=scm/172.19.0.6:9860 after 2 failover attempts. Trying to failover after sleeping for 2000ms. Current retry count: 2. com.google.protobuf.ServiceException: java.net.ConnectException: Call From 0e48f7ec0a7a/172.19.0.6 to scm:9860 failed on connection exception: java.net.ConnectException: Connection refused; For more details see: http://wiki.apache.org/hadoop/ConnectionRefused, while invoking $Proxy21.submitRequest over nodeId=scmNodeId,nodeAddress=scm/172.19.0.6:9860 after 3 failover attempts. Trying to failover after sleeping for 2000ms. Current retry count: 3. com.google.protobuf.ServiceException: java.net.ConnectException: Call From 0e48f7ec0a7a/172.19.0.6 to scm:9860 failed on connection exception: java.net.ConnectException: Connection refused; For more details see: http://wiki.apache.org/hadoop/ConnectionRefused, while invoking $Proxy21.submitRequest over nodeId=scmNodeId,nodeAddress=scm/172.19.0.6:9860 after 4 failover attempts. Trying to failover after sleeping for 2000ms. Current retry count: 4. com.google.protobuf.ServiceException: java.net.ConnectException: Call From 0e48f7ec0a7a/172.19.0.6 to scm:9860 failed on connection exception: java.net.ConnectException: Connection refused; For more details see: http://wiki.apache.org/hadoop/ConnectionRefused, while invoking $Proxy21.submitRequest over nodeId=scmNodeId,nodeAddress=scm/172.19.0.6:9860 after 5 failover attempts. Trying to failover after sleeping for 2000ms. Current retry count: 5. com.google.protobuf.ServiceException: org.apache.hadoop.ipc.RemoteException(org.apache.hadoop.hdds.ratis.ServerNotLeaderException): Server:ca364294-7907-4fe9-9164-5b6e6efaddb1 is not the leader. Could not determine the leader node. at org.apache.hadoop.hdds.ratis.ServerNotLeaderException.convertToNotLeaderException(ServerNotLeaderException.java:109) at org.apache.hadoop.hdds.scm.ha.RatisUtil.checkRatisException(RatisUtil.java:249) at org.apache.hadoop.hdds.scm.protocol.StorageContainerLocationProtocolServerSideTranslatorPB.submitRequest(StorageContainerLocationProtocolServerSideTranslatorPB.java:199) at org.apache.hadoop.hdds.protocol.proto.StorageContainerLocationProtocolProtos$StorageContainerLocationProtocolService$2.callBlockingMethod(StorageContainerLocationProtocolProtos.java) at org.apache.hadoop.ipc.ProtobufRpcEngine$Server.processCall(ProtobufRpcEngine.java:484) at org.apache.hadoop.ipc.ProtobufRpcEngine2$Server$ProtoBufRpcInvoker.call(ProtobufRpcEngine2.java:595) at org.apache.hadoop.ipc.ProtobufRpcEngine2$Server$ProtoBufRpcInvoker.call(ProtobufRpcEngine2.java:573) at org.apache.hadoop.ipc.RPC$Server.call(RPC.java:1227) at org.apache.hadoop.ipc.Server$RpcCall.run(Server.java:1094) at org.apache.hadoop.ipc.Server$RpcCall.run(Server.java:1017) at java.base/java.security.AccessController.doPrivileged(Native Method) at java.base/javax.security.auth.Subject.doAs(Subject.java:423) at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1899) at org.apache.hadoop.ipc.Server$Handler.run(Server.java:3048) , while invoking $Proxy21.submitRequest over nodeId=scmNodeId,nodeAddress=scm/172.19.0.6:9860 after 6 failover attempts. Trying to failover after sleeping for 2000ms. Current retry count: 6. com.google.protobuf.ServiceException: org.apache.hadoop.ipc.RemoteException(org.apache.hadoop.hdds.ratis.ServerNotLeaderException): Server:ca364294-7907-4fe9-9164-5b6e6efaddb1 is not the leader. Could not determine the leader node. at org.apache.hadoop.hdds.ratis.ServerNotLeaderException.convertToNotLeaderException(ServerNotLeaderException.java:109) at org.apache.hadoop.hdds.scm.ha.RatisUtil.checkRatisException(RatisUtil.java:249) at org.apache.hadoop.hdds.scm.protocol.StorageContainerLocationProtocolServerSideTranslatorPB.submitRequest(StorageContainerLocationProtocolServerSideTranslatorPB.java:199) at org.apache.hadoop.hdds.protocol.proto.StorageContainerLocationProtocolProtos$StorageContainerLocationProtocolService$2.callBlockingMethod(StorageContainerLocationProtocolProtos.java) at org.apache.hadoop.ipc.ProtobufRpcEngine$Server.processCall(ProtobufRpcEngine.java:484) at org.apache.hadoop.ipc.ProtobufRpcEngine2$Server$ProtoBufRpcInvoker.call(ProtobufRpcEngine2.java:595) at org.apache.hadoop.ipc.ProtobufRpcEngine2$Server$ProtoBufRpcInvoker.call(ProtobufRpcEngine2.java:573) at org.apache.hadoop.ipc.RPC$Server.call(RPC.java:1227) at org.apache.hadoop.ipc.Server$RpcCall.run(Server.java:1094) at org.apache.hadoop.ipc.Server$RpcCall.run(Server.java:1017) at java.base/java.security.AccessController.doPrivileged(Native Method) at java.base/javax.security.auth.Subject.doAs(Subject.java:423) at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1899) at org.apache.hadoop.ipc.Server$Handler.run(Server.java:3048) , while invoking $Proxy21.submitRequest over nodeId=scmNodeId,nodeAddress=scm/172.19.0.6:9860 after 7 failover attempts. Trying to failover after sleeping for 2000ms. Current retry count: 7. SCM is in safe mode. validated:true, DataNodeSafeModeRule, registered datanodes (=3) >= required datanodes (=3) validated:false, HealthyPipelineSafeModeRule, healthy Ratis/THREE pipelines (=0) >= healthyPipelineThresholdCount (=1) validated:true, ContainerSafeModeRule, % of containers with at least one reported replica (=1.00) >= safeModeCutoff (=0.99) validated:true, AtleastOneDatanodeReportedRule, reported Ratis/THREE pipelines with at least one datanode (=0) >= threshold (=0)
SECONDS: 94
SCM is out of safe mode.
Safe mode is off
No OM HA service, no need to wait
==============================================================================
S3                                                                            
==============================================================================
S3.Awss3 :: S3 gateway test with aws cli                                      
==============================================================================
File upload and directory list                                        | PASS |
------------------------------------------------------------------------------
File upload with special chars                                        | PASS |
------------------------------------------------------------------------------
S3.Awss3 :: S3 gateway test with aws cli                              | PASS |
2 tests, 2 passed, 0 failed
==============================================================================
S3.Boto3 :: S3 gateway test with Boto3 Client                                 
==============================================================================
Boto3 Client Test                                                     | PASS |
------------------------------------------------------------------------------
S3.Boto3 :: S3 gateway test with Boto3 Client                         | PASS |
1 test, 1 passed, 0 failed
==============================================================================
S3.Bucketcreate :: S3 gateway test with aws cli                               
==============================================================================
Create new bucket                                                     | PASS |
------------------------------------------------------------------------------
Create bucket which already exists                                    | PASS |
------------------------------------------------------------------------------
Create bucket with invalid bucket name                                | PASS |
------------------------------------------------------------------------------
Create new bucket and check no group ACL                              | PASS |
------------------------------------------------------------------------------
S3.Bucketcreate :: S3 gateway test with aws cli                       | PASS |
4 tests, 4 passed, 0 failed
==============================================================================
S3.Bucketdelete :: S3 gateway test with aws cli                               
==============================================================================
Delete existing bucket                                                | PASS |
------------------------------------------------------------------------------
Delete non-existent bucket                                            | PASS |
------------------------------------------------------------------------------
S3.Bucketdelete :: S3 gateway test with aws cli                       | PASS |
2 tests, 2 passed, 0 failed
==============================================================================
S3.Buckethead :: S3 gateway test with aws cli                                 
==============================================================================
Head Bucket                                                           | PASS |
------------------------------------------------------------------------------
Head Bucket not existent                                              | PASS |
------------------------------------------------------------------------------
S3.Buckethead :: S3 gateway test with aws cli                         | PASS |
2 tests, 2 passed, 0 failed
==============================================================================
S3.Bucketlist :: S3 gateway test with aws cli                                 
==============================================================================
List buckets                                                          | PASS |
------------------------------------------------------------------------------
Get bucket info with Ozone Shell to check the owner field             | PASS |
Skipping this check as security is not enabled
------------------------------------------------------------------------------
List buckets with empty access id                                     | PASS |
------------------------------------------------------------------------------
S3.Bucketlist :: S3 gateway test with aws cli                         | PASS |
3 tests, 3 passed, 0 failed
==============================================================================
S3.Freon :: S3 gateway test with aws cli                                      
==============================================================================
Run Freon S3BG                                                        | PASS |
------------------------------------------------------------------------------
S3.Freon :: S3 gateway test with aws cli                              | PASS |
1 test, 1 passed, 0 failed
==============================================================================
S3.MultipartUpload :: S3 gateway test with aws cli                            
==============================================================================
Test Multipart Upload With Adjusted Length                            | PASS |
------------------------------------------------------------------------------
Test Multipart Upload                                                 | PASS |
------------------------------------------------------------------------------
Test Multipart Upload Complete                                        | PASS |
------------------------------------------------------------------------------
Test Multipart Upload Complete Entity too small                       | PASS |
------------------------------------------------------------------------------
Test Multipart Upload Complete Invalid part errors and complete mp... | PASS |
------------------------------------------------------------------------------
Test abort Multipart upload                                           | PASS |
------------------------------------------------------------------------------
Test abort Multipart upload with invalid uploadId                     | PASS |
------------------------------------------------------------------------------
Upload part with Incorrect uploadID                                   | SKIP |
TODO: HDDS-7811
------------------------------------------------------------------------------
Test list parts                                                       | PASS |
------------------------------------------------------------------------------
Test Multipart Upload with the simplified aws s3 cp API               | PASS |
------------------------------------------------------------------------------
Test Multipart Upload Put With Copy                                   | PASS |
------------------------------------------------------------------------------
Test Multipart Upload Put With Copy and range                         | PASS |
------------------------------------------------------------------------------
Test Multipart Upload Put With Copy and range with IfModifiedSince    | PASS |
------------------------------------------------------------------------------
Test Multipart Upload list                                            | PASS |
------------------------------------------------------------------------------
S3.MultipartUpload :: S3 gateway test with aws cli                    | PASS |
14 tests, 13 passed, 0 failed, 1 skipped
==============================================================================
S3.Objectcopy :: S3 gateway test with aws cli                                 
==============================================================================
Copy Object Happy Scenario                                            | PASS |
------------------------------------------------------------------------------
Copy Object Where Bucket is not available                             | PASS |
------------------------------------------------------------------------------
Copy Object Where both source and dest are same with change to sto... | PASS |
------------------------------------------------------------------------------
Copy Object Where Key not available                                   | PASS |
------------------------------------------------------------------------------
S3.Objectcopy :: S3 gateway test with aws cli                         | PASS |
4 tests, 4 passed, 0 failed
==============================================================================
S3.Objectdelete :: S3 gateway test with aws cli                               
==============================================================================
Delete file with s3api                                                | PASS |
------------------------------------------------------------------------------
Delete file with s3api, file doesn't exist                            | PASS |
------------------------------------------------------------------------------
Delete dir with s3api                                                 | PASS |
------------------------------------------------------------------------------
Delete file with s3api, file doesn't exist, prefix of a real file     | PASS |
------------------------------------------------------------------------------
Delete file with s3api, bucket doesn't exist                          | PASS |
------------------------------------------------------------------------------
S3.Objectdelete :: S3 gateway test with aws cli                       | PASS |
5 tests, 5 passed, 0 failed
==============================================================================
S3.Objecthead :: S3 gateway test with aws cli                                 
==============================================================================
Head existing object                                                  | PASS |
------------------------------------------------------------------------------
Head object in non existing bucket                                    | PASS |
------------------------------------------------------------------------------
Head object where path is a directory                                 | PASS |
------------------------------------------------------------------------------
Head directory objects                                                | PASS |
------------------------------------------------------------------------------
Head non existing key                                                 | PASS |
------------------------------------------------------------------------------
S3.Objecthead :: S3 gateway test with aws cli                         | PASS |
5 tests, 5 passed, 0 failed
==============================================================================
S3.Objectmultidelete :: S3 gateway test with aws cli                          
==============================================================================
Delete file with multi delete                                         | PASS |
------------------------------------------------------------------------------
S3.Objectmultidelete :: S3 gateway test with aws cli                  | PASS |
1 test, 1 passed, 0 failed
==============================================================================
S3.Objectputget :: S3 gateway test with aws cli                               
==============================================================================
Put object to s3                                                      | PASS |
------------------------------------------------------------------------------
Get object from s3                                                    | PASS |
------------------------------------------------------------------------------
Get object with wrong signature                                       | PASS |
Skip in unsecure cluster
------------------------------------------------------------------------------
Get Partial object from s3 with both start and endoffset              | PASS |
------------------------------------------------------------------------------
Get Partial object from s3 with both start and endoffset(start off... | PASS |
------------------------------------------------------------------------------
Get Partial object from s3 with both start and endoffset(end offse... | PASS |
------------------------------------------------------------------------------
Get Partial object from s3 with only start offset                     | PASS |
------------------------------------------------------------------------------
Get Partial object from s3 with both start and endoffset which are... | PASS |
------------------------------------------------------------------------------
Get Partial object from s3 to get last n bytes                        | PASS |
------------------------------------------------------------------------------
Incorrect values for end and start offset                             | PASS |
------------------------------------------------------------------------------
Zero byte file                                                        | PASS |
------------------------------------------------------------------------------
Create file with user defined metadata                                | PASS |
------------------------------------------------------------------------------
Create file with user defined metadata with gdpr enabled value in ... | PASS |
------------------------------------------------------------------------------
Create file with user defined metadata size larger than 2 KB          | PASS |
------------------------------------------------------------------------------
S3.Objectputget :: S3 gateway test with aws cli                       | PASS |
14 tests, 14 passed, 0 failed
==============================================================================
S3.S3 Getsecret :: Test ozone s3 getsecret command                            
==============================================================================
Without OM service ID                                                 | PASS |
N/A
------------------------------------------------------------------------------
With OM service ID                                                    | PASS |
duplicate test in non-HA env.
------------------------------------------------------------------------------
S3.S3 Getsecret :: Test ozone s3 getsecret command                    | PASS |
2 tests, 2 passed, 0 failed
==============================================================================
S3.Webui :: S3 gateway web ui test                                            
==============================================================================
S3 Gateway Web UI                                                     | PASS |
------------------------------------------------------------------------------
S3.Webui :: S3 gateway web ui test                                    | PASS |
1 test, 1 passed, 0 failed
==============================================================================
S3                                                                    | PASS |
61 tests, 60 passed, 0 failed, 1 skipped
==============================================================================
Output:  /tmp/smoketest/ozone/result/robot-ozone-ozone-s3-scm.xml
Stopping ozone_datanode_3 ... 
Stopping ozone_datanode_2 ... 
Stopping ozone_s3g_1      ... 
Stopping ozone_datanode_1 ... 
Stopping ozone_httpfs_1   ... 
Stopping ozone_s3g3_1     ... 
Stopping ozone_s3g2_1     ... 
Stopping ozone_s3g1_1     ... 
Stopping ozone_scm_1      ... 
Stopping ozone_recon_1    ... 
Stopping ozone_om_1       ... 
Stopping ozone_s3g_1      ... done
Stopping ozone_httpfs_1   ... done
Stopping ozone_s3g2_1     ... done
Stopping ozone_s3g3_1     ... done
Stopping ozone_s3g1_1     ... done
Stopping ozone_recon_1    ... done
Stopping ozone_datanode_2 ... done
Stopping ozone_datanode_1 ... done
Stopping ozone_datanode_3 ... done
Stopping ozone_om_1       ... done
Stopping ozone_scm_1      ... done
Removing ozone_datanode_3 ... 
Removing ozone_datanode_2 ... 
Removing ozone_s3g_1      ... 
Removing ozone_datanode_1 ... 
Removing ozone_httpfs_1   ... 
Removing ozone_s3g3_1     ... 
Removing ozone_s3g2_1     ... 
Removing ozone_s3g1_1     ... 
Removing ozone_scm_1      ... 
Removing ozone_recon_1    ... 
Removing ozone_om_1       ... 
Removing ozone_s3g2_1     ... done
Removing ozone_s3g3_1     ... done
Removing ozone_om_1       ... done
Removing ozone_httpfs_1   ... done
Removing ozone_datanode_1 ... done
Removing ozone_s3g1_1     ... done
Removing ozone_recon_1    ... done
Removing ozone_s3g_1      ... done
Removing ozone_scm_1      ... done
Removing ozone_datanode_2 ... done
Removing ozone_datanode_3 ... done
Removing network ozone_default
Output:  /home/runner/work/ozone/ozone/hadoop-ozone/dist/target/ozone-1.4.0-SNAPSHOT/compose/result/ozone-s3-haproxy.xml
removed 'ozone/result/robot-ozone-ozone-s3-scm.xml'
renamed 'ozone/result/dn-audit-178c759457ce.log' -> '/home/runner/work/ozone/ozone/hadoop-ozone/dist/target/ozone-1.4.0-SNAPSHOT/compose/result/ozone/s3-haproxy/dn-audit-178c759457ce.log'
renamed 'ozone/result/dn-audit-9a1211350a19.log' -> '/home/runner/work/ozone/ozone/hadoop-ozone/dist/target/ozone-1.4.0-SNAPSHOT/compose/result/ozone/s3-haproxy/dn-audit-9a1211350a19.log'
renamed 'ozone/result/dn-audit-f38f3551e5c9.log' -> '/home/runner/work/ozone/ozone/hadoop-ozone/dist/target/ozone-1.4.0-SNAPSHOT/compose/result/ozone/s3-haproxy/dn-audit-f38f3551e5c9.log'
renamed 'ozone/result/docker-ozone-ozone-s3-scm.log' -> '/home/runner/work/ozone/ozone/hadoop-ozone/dist/target/ozone-1.4.0-SNAPSHOT/compose/result/ozone/s3-haproxy/docker-ozone-ozone-s3-scm.log'
renamed 'ozone/result/om-audit-3c45cf840e2b.log' -> '/home/runner/work/ozone/ozone/hadoop-ozone/dist/target/ozone-1.4.0-SNAPSHOT/compose/result/ozone/s3-haproxy/om-audit-3c45cf840e2b.log'
renamed 'ozone/result/s3g-audit-44f9db9a8a12.log' -> '/home/runner/work/ozone/ozone/hadoop-ozone/dist/target/ozone-1.4.0-SNAPSHOT/compose/result/ozone/s3-haproxy/s3g-audit-44f9db9a8a12.log'
renamed 'ozone/result/s3g-audit-974852005ae9.log' -> '/home/runner/work/ozone/ozone/hadoop-ozone/dist/target/ozone-1.4.0-SNAPSHOT/compose/result/ozone/s3-haproxy/s3g-audit-974852005ae9.log'
renamed 'ozone/result/s3g-audit-dc1feab7e91e.log' -> '/home/runner/work/ozone/ozone/hadoop-ozone/dist/target/ozone-1.4.0-SNAPSHOT/compose/result/ozone/s3-haproxy/s3g-audit-dc1feab7e91e.log'
renamed 'ozone/result/scm-audit-0e48f7ec0a7a.log' -> '/home/runner/work/ozone/ozone/hadoop-ozone/dist/target/ozone-1.4.0-SNAPSHOT/compose/result/ozone/s3-haproxy/scm-audit-0e48f7ec0a7a.log'
Executing test ozonescripts/test.sh
Removing network ozonescripts_default
Network ozonescripts_default not found.
Creating network "ozonescripts_default" with the default driver
Building datanode
Sending build context to Docker daemon  30.21kB
Step 1/17 : ARG OZONE_RUNNER_IMAGE
Step 2/17 : ARG OZONE_RUNNER_VERSION
Step 3/17 : FROM ${OZONE_RUNNER_IMAGE}:${OZONE_RUNNER_VERSION}
 ---> 3865b705061c
Step 4/17 : RUN sudo yum install -y openssh-clients openssh-server
 ---> Running in 5af7a750633a
Loaded plugins: fastestmirror, ovl
Determining fastest mirrors
[91m

 One of the configured repositories failed (Unknown),
 and yum doesn't have enough cached data to continue. At this point the only
 safe thing yum can do is fail. There are a few ways to work "fix" this:

     1. Contact the upstream for the repository and get them to fix the problem.

     2. Reconfigure the baseurl/etc. for the repository, to point to a working
        upstream. This is most often useful if you are using a newer
        distribution release than is supported by the repository (and the
        packages for the previous distribution release still work).

     3. Run the command with the repository temporarily disabled
            yum --disablerepo=<repoid> ...

     4. Disable the repository permanently, so yum won't use it by default. Yum
        will then just ignore the repository until you permanently enable it
        again or use --enablerepo for temporary usage:

            yum-config-manager --disable <repoid>
        or
            subscription-manager repos --disable=<repoid>

     5. Configure the failing repository to be skipped, if it is unavailable.
        Note that yum will try to contact the repo. when it runs most commands,
        so will have to try and fail each time (and thus. yum will be be much
        slower). If it is a very temporary problem though, this is often a nice
        compromise:

            yum-config-manager --save --setopt=<repoid>.skip_if_unavailable=true

Cannot retrieve metalink for repository: epel/x86_64. Please verify its path and try again
[0mThe command '/bin/sh -c sudo yum install -y openssh-clients openssh-server' returned a non-zero code: 1
Service 'datanode' failed to build : Build failed
Removing network ozonescripts_default
ERROR: Test execution of ozonescripts/test.sh is FAILED!!!!
renamed 'ozonescripts/result/docker-ozonescripts.log' -> '/home/runner/work/ozone/ozone/hadoop-ozone/dist/target/ozone-1.4.0-SNAPSHOT/compose/result/ozonescripts/docker-ozonescripts.log'
Executing test restart/test.sh
chown: changing ownership of '/home/runner/work/ozone/ozone/hadoop-ozone/dist/target/ozone-1.4.0-SNAPSHOT/compose/restart/data/dn1': Operation not permitted
chown: changing ownership of '/home/runner/work/ozone/ozone/hadoop-ozone/dist/target/ozone-1.4.0-SNAPSHOT/compose/restart/data/dn3': Operation not permitted
chown: changing ownership of '/home/runner/work/ozone/ozone/hadoop-ozone/dist/target/ozone-1.4.0-SNAPSHOT/compose/restart/data/recon': Operation not permitted
chown: changing ownership of '/home/runner/work/ozone/ozone/hadoop-ozone/dist/target/ozone-1.4.0-SNAPSHOT/compose/restart/data/dn2': Operation not permitted
chown: changing ownership of '/home/runner/work/ozone/ozone/hadoop-ozone/dist/target/ozone-1.4.0-SNAPSHOT/compose/restart/data/s3g': Operation not permitted
chown: changing ownership of '/home/runner/work/ozone/ozone/hadoop-ozone/dist/target/ozone-1.4.0-SNAPSHOT/compose/restart/data/om': Operation not permitted
chown: changing ownership of '/home/runner/work/ozone/ozone/hadoop-ozone/dist/target/ozone-1.4.0-SNAPSHOT/compose/restart/data/scm': Operation not permitted
chown: changing ownership of '/home/runner/work/ozone/ozone/hadoop-ozone/dist/target/ozone-1.4.0-SNAPSHOT/compose/restart/data': Operation not permitted
Removing network restart_net
Network restart_net not found.
Creating network "restart_net" with driver "bridge"
Creating restart_scm_1 ... 
Creating restart_dn3_1 ... 
Creating restart_om_1  ... 
Creating restart_dn2_1 ... 
Creating restart_s3g_1 ... 
Creating restart_recon_1 ... 
Creating restart_dn1_1   ... 
Creating restart_om_1    ... done
Creating restart_dn3_1   ... done
Creating restart_scm_1   ... done
Creating restart_recon_1 ... done
Creating restart_s3g_1   ... done
Creating restart_dn1_1   ... done
Creating restart_dn2_1   ... done
SECONDS: 52
com.google.protobuf.ServiceException: java.net.ConnectException: Call From 27de9db37231/10.9.0.17 to scm:9860 failed on connection exception: java.net.ConnectException: Connection refused; For more details see: http://wiki.apache.org/hadoop/ConnectionRefused, while invoking $Proxy20.submitRequest over nodeId=scmNodeId,nodeAddress=scm/10.9.0.17:9860 after 1 failover attempts. Trying to failover after sleeping for 2000ms. Current retry count: 1. com.google.protobuf.ServiceException: java.net.ConnectException: Call From 27de9db37231/10.9.0.17 to scm:9860 failed on connection exception: java.net.ConnectException: Connection refused; For more details see: http://wiki.apache.org/hadoop/ConnectionRefused, while invoking $Proxy20.submitRequest over nodeId=scmNodeId,nodeAddress=scm/10.9.0.17:9860 after 2 failover attempts. Trying to failover after sleeping for 2000ms. Current retry count: 2. com.google.protobuf.ServiceException: java.net.ConnectException: Call From 27de9db37231/10.9.0.17 to scm:9860 failed on connection exception: java.net.ConnectException: Connection refused; For more details see: http://wiki.apache.org/hadoop/ConnectionRefused, while invoking $Proxy20.submitRequest over nodeId=scmNodeId,nodeAddress=scm/10.9.0.17:9860 after 3 failover attempts. Trying to failover after sleeping for 2000ms. Current retry count: 3. com.google.protobuf.ServiceException: java.net.ConnectException: Call From 27de9db37231/10.9.0.17 to scm:9860 failed on connection exception: java.net.ConnectException: Connection refused; For more details see: http://wiki.apache.org/hadoop/ConnectionRefused, while invoking $Proxy20.submitRequest over nodeId=scmNodeId,nodeAddress=scm/10.9.0.17:9860 after 4 failover attempts. Trying to failover after sleeping for 2000ms. Current retry count: 4. com.google.protobuf.ServiceException: org.apache.hadoop.ipc.RemoteException(org.apache.hadoop.hdds.ratis.ServerNotLeaderException): Server:72ffd4dc-7ee9-43b8-adf1-05ffe9b89bb5 is not the leader. Could not determine the leader node. at org.apache.hadoop.hdds.ratis.ServerNotLeaderException.convertToNotLeaderException(ServerNotLeaderException.java:109) at org.apache.hadoop.hdds.scm.ha.RatisUtil.checkRatisException(RatisUtil.java:249) at org.apache.hadoop.hdds.scm.protocol.StorageContainerLocationProtocolServerSideTranslatorPB.submitRequest(StorageContainerLocationProtocolServerSideTranslatorPB.java:199) at org.apache.hadoop.hdds.protocol.proto.StorageContainerLocationProtocolProtos$StorageContainerLocationProtocolService$2.callBlockingMethod(StorageContainerLocationProtocolProtos.java) at org.apache.hadoop.ipc.ProtobufRpcEngine$Server.processCall(ProtobufRpcEngine.java:484) at org.apache.hadoop.ipc.ProtobufRpcEngine2$Server$ProtoBufRpcInvoker.call(ProtobufRpcEngine2.java:595) at org.apache.hadoop.ipc.ProtobufRpcEngine2$Server$ProtoBufRpcInvoker.call(ProtobufRpcEngine2.java:573) at org.apache.hadoop.ipc.RPC$Server.call(RPC.java:1227) at org.apache.hadoop.ipc.Server$RpcCall.run(Server.java:1094) at org.apache.hadoop.ipc.Server$RpcCall.run(Server.java:1017) at java.base/java.security.AccessController.doPrivileged(Native Method) at java.base/javax.security.auth.Subject.doAs(Subject.java:423) at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1899) at org.apache.hadoop.ipc.Server$Handler.run(Server.java:3048) , while invoking $Proxy20.submitRequest over nodeId=scmNodeId,nodeAddress=scm/10.9.0.17:9860 after 5 failover attempts. Trying to failover after sleeping for 2000ms. Current retry count: 5. com.google.protobuf.ServiceException: org.apache.hadoop.ipc.RemoteException(org.apache.hadoop.hdds.ratis.ServerNotLeaderException): Server:72ffd4dc-7ee9-43b8-adf1-05ffe9b89bb5 is not the leader. Could not determine the leader node. at org.apache.hadoop.hdds.ratis.ServerNotLeaderException.convertToNotLeaderException(ServerNotLeaderException.java:109) at org.apache.hadoop.hdds.scm.ha.RatisUtil.checkRatisException(RatisUtil.java:249) at org.apache.hadoop.hdds.scm.protocol.StorageContainerLocationProtocolServerSideTranslatorPB.submitRequest(StorageContainerLocationProtocolServerSideTranslatorPB.java:199) at org.apache.hadoop.hdds.protocol.proto.StorageContainerLocationProtocolProtos$StorageContainerLocationProtocolService$2.callBlockingMethod(StorageContainerLocationProtocolProtos.java) at org.apache.hadoop.ipc.ProtobufRpcEngine$Server.processCall(ProtobufRpcEngine.java:484) at org.apache.hadoop.ipc.ProtobufRpcEngine2$Server$ProtoBufRpcInvoker.call(ProtobufRpcEngine2.java:595) at org.apache.hadoop.ipc.ProtobufRpcEngine2$Server$ProtoBufRpcInvoker.call(ProtobufRpcEngine2.java:573) at org.apache.hadoop.ipc.RPC$Server.call(RPC.java:1227) at org.apache.hadoop.ipc.Server$RpcCall.run(Server.java:1094) at org.apache.hadoop.ipc.Server$RpcCall.run(Server.java:1017) at java.base/java.security.AccessController.doPrivileged(Native Method) at java.base/javax.security.auth.Subject.doAs(Subject.java:423) at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1899) at org.apache.hadoop.ipc.Server$Handler.run(Server.java:3048) , while invoking $Proxy20.submitRequest over nodeId=scmNodeId,nodeAddress=scm/10.9.0.17:9860 after 6 failover attempts. Trying to failover after sleeping for 2000ms. Current retry count: 6. com.google.protobuf.ServiceException: org.apache.hadoop.ipc.RemoteException(org.apache.hadoop.hdds.ratis.ServerNotLeaderException): Server:72ffd4dc-7ee9-43b8-adf1-05ffe9b89bb5 is not the leader. Could not determine the leader node. at org.apache.hadoop.hdds.ratis.ServerNotLeaderException.convertToNotLeaderException(ServerNotLeaderException.java:109) at org.apache.hadoop.hdds.scm.ha.RatisUtil.checkRatisException(RatisUtil.java:249) at org.apache.hadoop.hdds.scm.protocol.StorageContainerLocationProtocolServerSideTranslatorPB.submitRequest(StorageContainerLocationProtocolServerSideTranslatorPB.java:199) at org.apache.hadoop.hdds.protocol.proto.StorageContainerLocationProtocolProtos$StorageContainerLocationProtocolService$2.callBlockingMethod(StorageContainerLocationProtocolProtos.java) at org.apache.hadoop.ipc.ProtobufRpcEngine$Server.processCall(ProtobufRpcEngine.java:484) at org.apache.hadoop.ipc.ProtobufRpcEngine2$Server$ProtoBufRpcInvoker.call(ProtobufRpcEngine2.java:595) at org.apache.hadoop.ipc.ProtobufRpcEngine2$Server$ProtoBufRpcInvoker.call(ProtobufRpcEngine2.java:573) at org.apache.hadoop.ipc.RPC$Server.call(RPC.java:1227) at org.apache.hadoop.ipc.Server$RpcCall.run(Server.java:1094) at org.apache.hadoop.ipc.Server$RpcCall.run(Server.java:1017) at java.base/java.security.AccessController.doPrivileged(Native Method) at java.base/javax.security.auth.Subject.doAs(Subject.java:423) at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1899) at org.apache.hadoop.ipc.Server$Handler.run(Server.java:3048) , while invoking $Proxy20.submitRequest over nodeId=scmNodeId,nodeAddress=scm/10.9.0.17:9860 after 7 failover attempts. Trying to failover after sleeping for 2000ms. Current retry count: 7. SCM is in safe mode. validated:false, DataNodeSafeModeRule, registered datanodes (=0) >= required datanodes (=3) validated:false, HealthyPipelineSafeModeRule, healthy Ratis/THREE pipelines (=0) >= healthyPipelineThresholdCount (=1) validated:true, ContainerSafeModeRule, % of containers with at least one reported replica (=1.00) >= safeModeCutoff (=0.99) validated:true, AtleastOneDatanodeReportedRule, reported Ratis/THREE pipelines with at least one datanode (=0) >= threshold (=0)
SECONDS: 67
SCM is out of safe mode.
Safe mode is off
No OM HA service, no need to wait
==============================================================================
Generate :: Test freon data generation commands                               
==============================================================================
Ozone Client Key Generator                                            | PASS |
------------------------------------------------------------------------------
OM Key Generator                                                      | PASS |
------------------------------------------------------------------------------
OM Bucket Generator                                                   | PASS |
------------------------------------------------------------------------------
Generate :: Test freon data generation commands                       | PASS |
3 tests, 3 passed, 0 failed
==============================================================================
Output:  /tmp/smoketest/restart/result/robot-restart-restart-generate-scm.xml
==============================================================================
Validate :: Test freon data validation commands                               
==============================================================================
Ozone Client Key Validator                                            | PASS |
------------------------------------------------------------------------------
Validate :: Test freon data validation commands                       | PASS |
1 test, 1 passed, 0 failed
==============================================================================
Output:  /tmp/smoketest/restart/result/robot-restart-restart-generate-scm-1.xml
==============================================================================
Generate-Chunk :: Test freon chunk generation commands                        
==============================================================================
DN Chunk Generator                                                    | PASS |
------------------------------------------------------------------------------
Generate-Chunk :: Test freon chunk generation commands                | PASS |
1 test, 1 passed, 0 failed
==============================================================================
Output:  /tmp/smoketest/restart/result/robot-restart-restart-generate-scm-2.xml
==============================================================================
Validate-Chunk :: Test freon chunk validation commands                        
==============================================================================
DN Chunk Validator                                                    | PASS |
------------------------------------------------------------------------------
Validate-Chunk :: Test freon chunk validation commands                | PASS |
1 test, 1 passed, 0 failed
==============================================================================
Output:  /tmp/smoketest/restart/result/robot-restart-restart-generate-scm-3.xml
Stopping restart_dn1_1   ... 
Stopping restart_s3g_1   ... 
Stopping restart_recon_1 ... 
Stopping restart_dn2_1   ... 
Stopping restart_om_1    ... 
Stopping restart_dn3_1   ... 
Stopping restart_scm_1   ... 
Stopping restart_s3g_1   ... done
Stopping restart_recon_1 ... done
Stopping restart_dn2_1   ... done
Stopping restart_dn3_1   ... done
Stopping restart_dn1_1   ... done
Stopping restart_scm_1   ... done
Stopping restart_om_1    ... done
Removing restart_dn1_1   ... 
Removing restart_s3g_1   ... 
Removing restart_recon_1 ... 
Removing restart_dn2_1   ... 
Removing restart_om_1    ... 
Removing restart_dn3_1   ... 
Removing restart_scm_1   ... 
Removing restart_dn1_1   ... done
Removing restart_recon_1 ... done
Removing restart_dn2_1   ... done
Removing restart_scm_1   ... done
Removing restart_dn3_1   ... done
Removing restart_s3g_1   ... done
Removing restart_om_1    ... done
Removing network restart_net
Removing network restart_net
Network restart_net not found.
Creating network "restart_net" with driver "bridge"
Creating restart_dn1_1 ... 
Creating restart_recon_1 ... 
Creating restart_dn3_1   ... 
Creating restart_dn2_1   ... 
Creating restart_s3g_1   ... 
Creating restart_scm_1   ... 
Creating restart_om_1    ... 
Creating restart_dn1_1   ... done
Creating restart_recon_1 ... done
Creating restart_dn3_1   ... done
Creating restart_scm_1   ... done
Creating restart_dn2_1   ... done
Creating restart_om_1    ... done
Creating restart_s3g_1   ... done
SECONDS: 48
com.google.protobuf.ServiceException: java.net.ConnectException: Call From 05fcf274c3ca/10.9.0.17 to scm:9860 failed on connection exception: java.net.ConnectException: Connection refused; For more details see: http://wiki.apache.org/hadoop/ConnectionRefused, while invoking $Proxy20.submitRequest over nodeId=scmNodeId,nodeAddress=scm/10.9.0.17:9860 after 1 failover attempts. Trying to failover after sleeping for 2000ms. Current retry count: 1. com.google.protobuf.ServiceException: org.apache.hadoop.ipc.RemoteException(org.apache.hadoop.hdds.ratis.ServerNotLeaderException): Server:72ffd4dc-7ee9-43b8-adf1-05ffe9b89bb5 is not the leader. Could not determine the leader node. at org.apache.hadoop.hdds.ratis.ServerNotLeaderException.convertToNotLeaderException(ServerNotLeaderException.java:109) at org.apache.hadoop.hdds.scm.ha.RatisUtil.checkRatisException(RatisUtil.java:249) at org.apache.hadoop.hdds.scm.protocol.StorageContainerLocationProtocolServerSideTranslatorPB.submitRequest(StorageContainerLocationProtocolServerSideTranslatorPB.java:199) at org.apache.hadoop.hdds.protocol.proto.StorageContainerLocationProtocolProtos$StorageContainerLocationProtocolService$2.callBlockingMethod(StorageContainerLocationProtocolProtos.java) at org.apache.hadoop.ipc.ProtobufRpcEngine$Server.processCall(ProtobufRpcEngine.java:484) at org.apache.hadoop.ipc.ProtobufRpcEngine2$Server$ProtoBufRpcInvoker.call(ProtobufRpcEngine2.java:595) at org.apache.hadoop.ipc.ProtobufRpcEngine2$Server$ProtoBufRpcInvoker.call(ProtobufRpcEngine2.java:573) at org.apache.hadoop.ipc.RPC$Server.call(RPC.java:1227) at org.apache.hadoop.ipc.Server$RpcCall.run(Server.java:1094) at org.apache.hadoop.ipc.Server$RpcCall.run(Server.java:1017) at java.base/java.security.AccessController.doPrivileged(Native Method) at java.base/javax.security.auth.Subject.doAs(Subject.java:423) at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1899) at org.apache.hadoop.ipc.Server$Handler.run(Server.java:3048) , while invoking $Proxy20.submitRequest over nodeId=scmNodeId,nodeAddress=scm/10.9.0.17:9860 after 2 failover attempts. Trying to failover after sleeping for 2000ms. Current retry count: 2. com.google.protobuf.ServiceException: org.apache.hadoop.ipc.RemoteException(org.apache.hadoop.hdds.ratis.ServerNotLeaderException): Server:72ffd4dc-7ee9-43b8-adf1-05ffe9b89bb5 is not the leader. Could not determine the leader node. at org.apache.hadoop.hdds.ratis.ServerNotLeaderException.convertToNotLeaderException(ServerNotLeaderException.java:109) at org.apache.hadoop.hdds.scm.ha.RatisUtil.checkRatisException(RatisUtil.java:249) at org.apache.hadoop.hdds.scm.protocol.StorageContainerLocationProtocolServerSideTranslatorPB.submitRequest(StorageContainerLocationProtocolServerSideTranslatorPB.java:199) at org.apache.hadoop.hdds.protocol.proto.StorageContainerLocationProtocolProtos$StorageContainerLocationProtocolService$2.callBlockingMethod(StorageContainerLocationProtocolProtos.java) at org.apache.hadoop.ipc.ProtobufRpcEngine$Server.processCall(ProtobufRpcEngine.java:484) at org.apache.hadoop.ipc.ProtobufRpcEngine2$Server$ProtoBufRpcInvoker.call(ProtobufRpcEngine2.java:595) at org.apache.hadoop.ipc.ProtobufRpcEngine2$Server$ProtoBufRpcInvoker.call(ProtobufRpcEngine2.java:573) at org.apache.hadoop.ipc.RPC$Server.call(RPC.java:1227) at org.apache.hadoop.ipc.Server$RpcCall.run(Server.java:1094) at org.apache.hadoop.ipc.Server$RpcCall.run(Server.java:1017) at java.base/java.security.AccessController.doPrivileged(Native Method) at java.base/javax.security.auth.Subject.doAs(Subject.java:423) at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1899) at org.apache.hadoop.ipc.Server$Handler.run(Server.java:3048) , while invoking $Proxy20.submitRequest over nodeId=scmNodeId,nodeAddress=scm/10.9.0.17:9860 after 3 failover attempts. Trying to failover after sleeping for 2000ms. Current retry count: 3. SCM is in safe mode. validated:false, DataNodeSafeModeRule, registered datanodes (=0) >= required datanodes (=3) validated:false, HealthyPipelineSafeModeRule, healthy Ratis/THREE pipelines (=0) >= healthyPipelineThresholdCount (=1) validated:true, ContainerSafeModeRule, % of containers with at least one reported replica (=1.00) >= safeModeCutoff (=0.99) validated:false, AtleastOneDatanodeReportedRule, reported Ratis/THREE pipelines with at least one datanode (=0) >= threshold (=2)
SECONDS: 60
SCM is out of safe mode.
Safe mode is off
No OM HA service, no need to wait
==============================================================================
Validate :: Test freon data validation commands                               
==============================================================================
Ozone Client Key Validator                                            | PASS |
------------------------------------------------------------------------------
Validate :: Test freon data validation commands                       | PASS |
1 test, 1 passed, 0 failed
==============================================================================
Output:  /tmp/smoketest/restart/result/robot-restart-restart-generate-scm-4.xml
==============================================================================
Validate-Chunk :: Test freon chunk validation commands                        
==============================================================================
DN Chunk Validator                                                    | PASS |
------------------------------------------------------------------------------
Validate-Chunk :: Test freon chunk validation commands                | PASS |
1 test, 1 passed, 0 failed
==============================================================================
Output:  /tmp/smoketest/restart/result/robot-restart-restart-generate-scm-5.xml
==============================================================================
Generate :: Test freon data generation commands                               
==============================================================================
Ozone Client Key Generator                                            | PASS |
------------------------------------------------------------------------------
OM Key Generator                                                      | PASS |
------------------------------------------------------------------------------
OM Bucket Generator                                                   | PASS |
------------------------------------------------------------------------------
Generate :: Test freon data generation commands                       | PASS |
3 tests, 3 passed, 0 failed
==============================================================================
Output:  /tmp/smoketest/restart/result/robot-restart-restart-generate-scm-6.xml
==============================================================================
Validate :: Test freon data validation commands                               
==============================================================================
Ozone Client Key Validator                                            | PASS |
------------------------------------------------------------------------------
Validate :: Test freon data validation commands                       | PASS |
1 test, 1 passed, 0 failed
==============================================================================
Output:  /tmp/smoketest/restart/result/robot-restart-restart-generate-scm-7.xml
==============================================================================
Generate-Chunk :: Test freon chunk generation commands                        
==============================================================================
DN Chunk Generator                                                    | PASS |
------------------------------------------------------------------------------
Generate-Chunk :: Test freon chunk generation commands                | PASS |
1 test, 1 passed, 0 failed
==============================================================================
Output:  /tmp/smoketest/restart/result/robot-restart-restart-generate-scm-8.xml
==============================================================================
Validate-Chunk :: Test freon chunk validation commands                        
==============================================================================
DN Chunk Validator                                                    | PASS |
------------------------------------------------------------------------------
Validate-Chunk :: Test freon chunk validation commands                | PASS |
1 test, 1 passed, 0 failed
==============================================================================
Output:  /tmp/smoketest/restart/result/robot-restart-restart-generate-scm-9.xml
Stopping restart_om_1    ... 
Stopping restart_s3g_1   ... 
Stopping restart_scm_1   ... 
Stopping restart_dn2_1   ... 
Stopping restart_recon_1 ... 
Stopping restart_dn3_1   ... 
Stopping restart_dn1_1   ... 
Stopping restart_s3g_1   ... done
Stopping restart_dn3_1   ... done
Stopping restart_dn1_1   ... done
Stopping restart_recon_1 ... done
Stopping restart_dn2_1   ... done
Stopping restart_om_1    ... done
Stopping restart_scm_1   ... done
Removing restart_om_1    ... 
Removing restart_s3g_1   ... 
Removing restart_scm_1   ... 
Removing restart_dn2_1   ... 
Removing restart_recon_1 ... 
Removing restart_dn3_1   ... 
Removing restart_dn1_1   ... 
Removing restart_recon_1 ... done
Removing restart_om_1    ... done
Removing restart_dn2_1   ... done
Removing restart_dn3_1   ... done
Removing restart_dn1_1   ... done
Removing restart_scm_1   ... done
Removing restart_s3g_1   ... done
Removing network restart_net
Output:  /home/runner/work/ozone/ozone/hadoop-ozone/dist/target/ozone-1.4.0-SNAPSHOT/compose/result/restart.xml
removed 'restart/result/robot-restart-restart-generate-scm-1.xml'
removed 'restart/result/robot-restart-restart-generate-scm-2.xml'
removed 'restart/result/robot-restart-restart-generate-scm-3.xml'
removed 'restart/result/robot-restart-restart-generate-scm-4.xml'
removed 'restart/result/robot-restart-restart-generate-scm-5.xml'
removed 'restart/result/robot-restart-restart-generate-scm-6.xml'
removed 'restart/result/robot-restart-restart-generate-scm-7.xml'
removed 'restart/result/robot-restart-restart-generate-scm-8.xml'
removed 'restart/result/robot-restart-restart-generate-scm-9.xml'
removed 'restart/result/robot-restart-restart-generate-scm.xml'
renamed 'restart/result/dn-audit-1ffe21382799.log' -> '/home/runner/work/ozone/ozone/hadoop-ozone/dist/target/ozone-1.4.0-SNAPSHOT/compose/result/restart/dn-audit-1ffe21382799.log'
renamed 'restart/result/dn-audit-5022da3b84cd.log' -> '/home/runner/work/ozone/ozone/hadoop-ozone/dist/target/ozone-1.4.0-SNAPSHOT/compose/result/restart/dn-audit-5022da3b84cd.log'
renamed 'restart/result/dn-audit-5805399cd9bd.log' -> '/home/runner/work/ozone/ozone/hadoop-ozone/dist/target/ozone-1.4.0-SNAPSHOT/compose/result/restart/dn-audit-5805399cd9bd.log'
renamed 'restart/result/dn-audit-e99cd87b06ef.log' -> '/home/runner/work/ozone/ozone/hadoop-ozone/dist/target/ozone-1.4.0-SNAPSHOT/compose/result/restart/dn-audit-e99cd87b06ef.log'
renamed 'restart/result/dn-audit-f487a00cfd86.log' -> '/home/runner/work/ozone/ozone/hadoop-ozone/dist/target/ozone-1.4.0-SNAPSHOT/compose/result/restart/dn-audit-f487a00cfd86.log'
renamed 'restart/result/dn-audit-fb1b01524648.log' -> '/home/runner/work/ozone/ozone/hadoop-ozone/dist/target/ozone-1.4.0-SNAPSHOT/compose/result/restart/dn-audit-fb1b01524648.log'
renamed 'restart/result/docker-restart-restart-generate-scm.log' -> '/home/runner/work/ozone/ozone/hadoop-ozone/dist/target/ozone-1.4.0-SNAPSHOT/compose/result/restart/docker-restart-restart-generate-scm.log'
renamed 'restart/result/om-audit-130e1cdd9ed4.log' -> '/home/runner/work/ozone/ozone/hadoop-ozone/dist/target/ozone-1.4.0-SNAPSHOT/compose/result/restart/om-audit-130e1cdd9ed4.log'
renamed 'restart/result/om-audit-4257e50d2700.log' -> '/home/runner/work/ozone/ozone/hadoop-ozone/dist/target/ozone-1.4.0-SNAPSHOT/compose/result/restart/om-audit-4257e50d2700.log'
renamed 'restart/result/s3g-audit-1e1dbbc8f57a.log' -> '/home/runner/work/ozone/ozone/hadoop-ozone/dist/target/ozone-1.4.0-SNAPSHOT/compose/result/restart/s3g-audit-1e1dbbc8f57a.log'
renamed 'restart/result/s3g-audit-2d55879135e7.log' -> '/home/runner/work/ozone/ozone/hadoop-ozone/dist/target/ozone-1.4.0-SNAPSHOT/compose/result/restart/s3g-audit-2d55879135e7.log'
renamed 'restart/result/scm-audit-05fcf274c3ca.log' -> '/home/runner/work/ozone/ozone/hadoop-ozone/dist/target/ozone-1.4.0-SNAPSHOT/compose/result/restart/scm-audit-05fcf274c3ca.log'
renamed 'restart/result/scm-audit-27de9db37231.log' -> '/home/runner/work/ozone/ozone/hadoop-ozone/dist/target/ozone-1.4.0-SNAPSHOT/compose/result/restart/scm-audit-27de9db37231.log'
Executing test upgrade/testlib.sh
find: upgrade/result: No such file or directory
mv: cannot stat 'upgrade/result/*': No such file or directory
Exception in thread "main" Log:     /home/runner/work/ozone/ozone/hadoop-ozone/dist/target/ozone-1.4.0-SNAPSHOT/compose/result/log.html
Report:  /home/runner/work/ozone/ozone/hadoop-ozone/dist/target/ozone-1.4.0-SNAPSHOT/compose/result/report.html
