2022-02-21 12:57:04,034 [main] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchemaFromFile(129)) - Loading schema from [file:/home/runner/work/ozone/ozone/hadoop-hdds/common/target/classes/network-topology-default.xml]
2022-02-21 12:57:04,038 [main] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchema(176)) - Loading network topology layer schema file
2022-02-21 12:57:04,112 [main] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchemaFromFile(129)) - Loading schema from [file:/home/runner/work/ozone/ozone/hadoop-hdds/common/target/classes/network-topology-default.xml]
2022-02-21 12:57:04,112 [main] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchema(176)) - Loading network topology layer schema file
2022-02-21 12:57:04,178 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/e0760cd4-4359-44a4-8a14-e89be87e564a
2022-02-21 12:57:04,179 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/ddd75cf0-4795-4c42-b378-521c59546bd1
2022-02-21 12:57:04,179 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/0254bdc6-8f7f-418b-914d-53b0155a50a1
2022-02-21 12:57:04,180 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/9e7dffd7-400d-4632-9036-941b043cbbc4
2022-02-21 12:57:04,180 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/3ef4b8c8-2d22-4212-a063-7dac3bc25ca3
2022-02-21 12:57:04,180 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/f1212ed4-4598-4993-8a7d-cf2be6ee130b
2022-02-21 12:57:04,180 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/5ec75606-45ff-4b53-9983-4d6d8ca72e80
2022-02-21 12:57:04,181 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/d862e2e6-d687-4733-808e-7535e4721507
2022-02-21 12:57:04,181 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/48ef145b-fad2-477b-98c1-f67363542800
2022-02-21 12:57:04,181 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/d5538f2a-91b7-48a5-a267-52bc16c98d76
2022-02-21 12:57:04,257 [main] WARN  utils.HAUtils (HAUtils.java:getMetaDir(342)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2022-02-21 12:57:04,436 [main] WARN  db.DBStoreBuilder (DBStoreBuilder.java:applyDBDefinition(145)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2022-02-21 12:57:04,584 [main] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:<init>(218)) - Init the HA SequenceIdGenerator.
2022-02-21 12:57:04,598 [main] INFO  pipeline.PipelineStateManagerImpl (PipelineStateManagerImpl.java:initialize(78)) - No pipeline exists in current db
2022-02-21 12:57:04,641 [main] INFO  algorithms.LeaderChoosePolicyFactory (LeaderChoosePolicyFactory.java:getPolicy(57)) - Create leader choose policy of type org.apache.hadoop.hdds.scm.pipeline.leader.choose.algorithms.MinLeaderCountChoosePolicy
2022-02-21 12:57:04,728 [main] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service BackgroundPipelineCreator.
2022-02-21 12:57:04,729 [main] INFO  pipeline.BackgroundPipelineCreator (BackgroundPipelineCreator.java:start(130)) - Starting RatisPipelineUtilsThread.
2022-02-21 12:57:04,734 [main] INFO  algorithms.LeaderChoosePolicyFactory (LeaderChoosePolicyFactory.java:getPolicy(57)) - Create leader choose policy of type org.apache.hadoop.hdds.scm.pipeline.leader.choose.algorithms.MinLeaderCountChoosePolicy
2022-02-21 12:57:04,902 [main] INFO  safemode.ContainerSafeModeRule (ContainerSafeModeRule.java:<init>(89)) - containers with one replica threshold count 0
2022-02-21 12:57:04,906 [main] INFO  safemode.HealthyPipelineSafeModeRule (HealthyPipelineSafeModeRule.java:initializeRule(156)) - Total pipeline count is 0, healthy pipeline threshold count is 0
2022-02-21 12:57:04,910 [main] INFO  safemode.OneReplicaPipelineSafeModeRule (OneReplicaPipelineSafeModeRule.java:initializeRule(180)) - Total pipeline count is 0, pipeline's with at least one datanode reported threshold count is 0
2022-02-21 12:57:04,918 [main] WARN  server.ServerUtils (ServerUtils.java:getScmDbDir(148)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2022-02-21 12:57:04,948 [main] INFO  ha.SCMHANodeDetails (SCMHANodeDetails.java:loadSCMHAConfig(157)) - ServiceID for StorageContainerManager is null
2022-02-21 12:57:04,948 [main] INFO  ha.SCMHANodeDetails (SCMHANodeDetails.java:loadSCMHAConfig(162)) - ozone.scm.default.service.id is not defined, falling back to ozone.scm.service.ids to find serviceID for StorageContainerManager if it is HA enabled cluster
2022-02-21 12:57:05,025 [main] WARN  server.ServerUtils (ServerUtils.java:getScmDbDir(148)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2022-02-21 12:57:05,028 [main] INFO  upgrade.AbstractLayoutVersionManager (AbstractLayoutVersionManager.java:init(79)) - Initializing Layout version manager with metadata layout = SCM_HA (version = 2), software layout = SCM_HA (version = 2)
2022-02-21 12:57:05,227 [main] INFO  reflections.Reflections (Reflections.java:scan(232)) - Reflections took 170 ms to scan 6 urls, producing 119 keys and 272 values 
2022-02-21 12:57:05,862 [main] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchemaFromFile(129)) - Loading schema from [file:/home/runner/work/ozone/ozone/hadoop-hdds/common/target/classes/network-topology-default.xml]
2022-02-21 12:57:05,863 [main] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchema(176)) - Loading network topology layer schema file
2022-02-21 12:57:05,883 [main] INFO  metrics.MetricRegistries (MetricRegistriesLoader.java:load(64)) - Loaded MetricRegistries class org.apache.ratis.metrics.impl.MetricRegistriesImpl
2022-02-21 12:57:05,895 [main] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:upgradeToSequenceId(347)) - upgrade localId to 109611004723200000
2022-02-21 12:57:05,895 [main] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:upgradeToSequenceId(357)) - upgrade delTxnId to 0
2022-02-21 12:57:05,896 [main] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:upgradeToSequenceId(371)) - upgrade containerId to 0
2022-02-21 12:57:05,896 [main] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:<init>(218)) - Init the HA SequenceIdGenerator.
2022-02-21 12:57:05,905 [main] INFO  algorithms.ContainerPlacementPolicyFactory (ContainerPlacementPolicyFactory.java:getPolicy(60)) - Create container placement policy of type org.apache.hadoop.hdds.scm.container.placement.algorithms.SCMContainerPlacementRandom
2022-02-21 12:57:05,910 [main] INFO  algorithms.PipelineChoosePolicyFactory (PipelineChoosePolicyFactory.java:createPipelineChoosePolicyFromClass(73)) - Create pipeline choose policy of type org.apache.hadoop.hdds.scm.pipeline.choose.algorithms.RandomPipelineChoosePolicy
2022-02-21 12:57:05,934 [main] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service SCMBlockDeletingService.
2022-02-21 12:57:05,962 [main] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service ReplicationManager.
2022-02-21 12:57:05,975 [main] INFO  container.ReplicationManager (ReplicationManager.java:start(326)) - Starting Replication Monitor Thread.
2022-02-21 12:57:05,983 [ReplicationMonitor] INFO  container.ReplicationManager (ReplicationManager.java:processAll(374)) - Replication Manager is not ready to run until 300000ms after safemode exit
2022-02-21 12:57:05,996 [main] WARN  util.NativeCodeLoader (NativeCodeLoader.java:<clinit>(60)) - Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
2022-02-21 12:57:06,344 [main] INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(90)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 10000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false.
2022-02-21 12:57:06,391 [Socket Reader #1 for port 0] INFO  ipc.Server (Server.java:run(1265)) - Starting Socket Reader #1 for port 0
2022-02-21 12:57:06,439 [Listener at 0.0.0.0/43631] INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(90)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 10000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false.
2022-02-21 12:57:06,440 [Socket Reader #1 for port 0] INFO  ipc.Server (Server.java:run(1265)) - Starting Socket Reader #1 for port 0
2022-02-21 12:57:06,459 [Listener at 0.0.0.0/44735] INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(90)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 10000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false.
2022-02-21 12:57:06,462 [Socket Reader #1 for port 0] INFO  ipc.Server (Server.java:run(1265)) - Starting Socket Reader #1 for port 0
2022-02-21 12:57:06,504 [Listener at 0.0.0.0/44095] INFO  algorithms.ContainerPlacementPolicyFactory (ContainerPlacementPolicyFactory.java:getPolicy(60)) - Create container placement policy of type org.apache.hadoop.hdds.scm.container.placement.algorithms.SCMContainerPlacementRandom
2022-02-21 12:57:06,511 [Listener at 0.0.0.0/44095] INFO  server.StorageContainerManager (StorageContainerManager.java:<init>(388)) - 
Container Balancer status:
Key                            Value
Running                        false
Container Balancer Configuration values:
Key                                                Value
Threshold                                          10
Max Datanodes to Involve per Iteration(percent)    20
Max Size to Move per Iteration                     500GB
Max Size Entering Target per Iteration             26GB
Max Size Leaving Source per Iteration              26GB

2022-02-21 12:57:06,514 [Listener at 0.0.0.0/44095] INFO  ha.SCMContext (SCMContext.java:updateSafeModeStatus(211)) - Update SafeModeStatus from SafeModeStatus{safeModeStatus=false, preCheckPassed=true} to SafeModeStatus{safeModeStatus=false, preCheckPassed=true}.
2022-02-21 12:57:06,549 [Time-limited test] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(183)) - Sending CreatePipelineCommand for pipeline:PipelineID=feaffa86-af90-46ce-9892-1605d1386cad to datanode:5ec75606-45ff-4b53-9983-4d6d8ca72e80
2022-02-21 12:57:06,551 [Time-limited test] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(183)) - Sending CreatePipelineCommand for pipeline:PipelineID=feaffa86-af90-46ce-9892-1605d1386cad to datanode:e0760cd4-4359-44a4-8a14-e89be87e564a
2022-02-21 12:57:06,551 [Time-limited test] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(183)) - Sending CreatePipelineCommand for pipeline:PipelineID=feaffa86-af90-46ce-9892-1605d1386cad to datanode:d862e2e6-d687-4733-808e-7535e4721507
2022-02-21 12:57:06,602 [Time-limited test] INFO  pipeline.PipelineStateManagerImpl (PipelineStateManagerImpl.java:addPipeline(101)) - Created pipeline Pipeline[ Id: feaffa86-af90-46ce-9892-1605d1386cad, Nodes: 5ec75606-45ff-4b53-9983-4d6d8ca72e80{ip: 229.15.2.93, host: localhost-229.15.2.93, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}e0760cd4-4359-44a4-8a14-e89be87e564a{ip: 114.69.97.88, host: localhost-114.69.97.88, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}d862e2e6-d687-4733-808e-7535e4721507{ip: 110.147.24.107, host: localhost-110.147.24.107, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}, ReplicationConfig: RATIS/THREE, State:ALLOCATED, leaderId:, CreationTimestamp2022-02-21T12:57:06.545Z[Etc/UTC]].
2022-02-21 12:57:06,609 [EventQueue-DatanodeCommandForDatanodeCommandHandler] INFO  pipeline.PipelineManagerImpl (PipelineManagerImpl.java:openPipeline(291)) - Pipeline Pipeline[ Id: feaffa86-af90-46ce-9892-1605d1386cad, Nodes: 5ec75606-45ff-4b53-9983-4d6d8ca72e80{ip: 229.15.2.93, host: localhost-229.15.2.93, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}e0760cd4-4359-44a4-8a14-e89be87e564a{ip: 114.69.97.88, host: localhost-114.69.97.88, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}d862e2e6-d687-4733-808e-7535e4721507{ip: 110.147.24.107, host: localhost-110.147.24.107, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}, ReplicationConfig: RATIS/THREE, State:ALLOCATED, leaderId:, CreationTimestamp2022-02-21T12:57:06.545Z[Etc/UTC]] moved to OPEN state
2022-02-21 12:57:06,617 [Time-limited test] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(183)) - Sending CreatePipelineCommand for pipeline:PipelineID=4d48583c-41b2-44da-9025-8f36f8c818cd to datanode:3ef4b8c8-2d22-4212-a063-7dac3bc25ca3
2022-02-21 12:57:06,617 [Time-limited test] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(183)) - Sending CreatePipelineCommand for pipeline:PipelineID=4d48583c-41b2-44da-9025-8f36f8c818cd to datanode:f1212ed4-4598-4993-8a7d-cf2be6ee130b
2022-02-21 12:57:06,617 [Time-limited test] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(183)) - Sending CreatePipelineCommand for pipeline:PipelineID=4d48583c-41b2-44da-9025-8f36f8c818cd to datanode:9e7dffd7-400d-4632-9036-941b043cbbc4
2022-02-21 12:57:06,621 [Time-limited test] INFO  pipeline.PipelineStateManagerImpl (PipelineStateManagerImpl.java:addPipeline(101)) - Created pipeline Pipeline[ Id: 4d48583c-41b2-44da-9025-8f36f8c818cd, Nodes: 3ef4b8c8-2d22-4212-a063-7dac3bc25ca3{ip: 44.224.155.110, host: localhost-44.224.155.110, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}f1212ed4-4598-4993-8a7d-cf2be6ee130b{ip: 118.253.114.79, host: localhost-118.253.114.79, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}9e7dffd7-400d-4632-9036-941b043cbbc4{ip: 165.169.145.234, host: localhost-165.169.145.234, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}, ReplicationConfig: RATIS/THREE, State:ALLOCATED, leaderId:, CreationTimestamp2022-02-21T12:57:06.617Z[Etc/UTC]].
2022-02-21 12:57:06,622 [EventQueue-DatanodeCommandForDatanodeCommandHandler] INFO  pipeline.PipelineManagerImpl (PipelineManagerImpl.java:openPipeline(291)) - Pipeline Pipeline[ Id: 4d48583c-41b2-44da-9025-8f36f8c818cd, Nodes: 3ef4b8c8-2d22-4212-a063-7dac3bc25ca3{ip: 44.224.155.110, host: localhost-44.224.155.110, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}f1212ed4-4598-4993-8a7d-cf2be6ee130b{ip: 118.253.114.79, host: localhost-118.253.114.79, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}9e7dffd7-400d-4632-9036-941b043cbbc4{ip: 165.169.145.234, host: localhost-165.169.145.234, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}, ReplicationConfig: RATIS/THREE, State:ALLOCATED, leaderId:, CreationTimestamp2022-02-21T12:57:06.617Z[Etc/UTC]] moved to OPEN state
2022-02-21 12:57:06,644 [Time-limited test] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:getNextId(127)) - Allocate a batch for containerId, change lastId from 0 to 1000.
2022-02-21 12:57:06,657 [Time-limited test] WARN  ha.SequenceIdGenerator (SequenceIdGenerator.java:allocateBatch(235)) - Failed to allocate a batch for localId, expected lastId is 0, actual lastId is 109611004723200000.
2022-02-21 12:57:06,658 [Time-limited test] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:getNextId(127)) - Allocate a batch for localId, change lastId from 109611004723200000 to 109611004723201000.
2022-02-21 12:57:06,719 [EventQueue-CloseContainerForCloseContainerEventHandler] INFO  container.CloseContainerEventHandler (CloseContainerEventHandler.java:onMessage(69)) - Close container Event triggered for container : #1
2022-02-21 12:57:06,724 [EventQueue-CloseContainerForCloseContainerEventHandler] INFO  container.CloseContainerEventHandler (CloseContainerEventHandler.java:onMessage(69)) - Close container Event triggered for container : #2
2022-02-21 12:57:06,725 [EventQueue-CloseContainerForCloseContainerEventHandler] INFO  container.CloseContainerEventHandler (CloseContainerEventHandler.java:onMessage(69)) - Close container Event triggered for container : #5
2022-02-21 12:57:06,725 [EventQueue-CloseContainerForCloseContainerEventHandler] INFO  container.CloseContainerEventHandler (CloseContainerEventHandler.java:onMessage(69)) - Close container Event triggered for container : #3
2022-02-21 12:57:06,726 [EventQueue-CloseContainerForCloseContainerEventHandler] INFO  container.CloseContainerEventHandler (CloseContainerEventHandler.java:onMessage(69)) - Close container Event triggered for container : #4
2022-02-21 12:57:06,727 [EventQueue-CloseContainerForCloseContainerEventHandler] INFO  container.CloseContainerEventHandler (CloseContainerEventHandler.java:onMessage(69)) - Close container Event triggered for container : #6
2022-02-21 12:57:06,805 [Listener at 0.0.0.0/44095] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1390)) - Stopping Container Balancer service.
2022-02-21 12:57:06,806 [Listener at 0.0.0.0/44095] INFO  balancer.ContainerBalancer (ContainerBalancer.java:stop(751)) - Container Balancer is not running.
2022-02-21 12:57:06,806 [Listener at 0.0.0.0/44095] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1397)) - Stopping Replication Manager Service.
2022-02-21 12:57:06,806 [Listener at 0.0.0.0/44095] INFO  container.ReplicationManager (ReplicationManager.java:stop(357)) - Stopping Replication Monitor Thread.
2022-02-21 12:57:06,806 [Listener at 0.0.0.0/44095] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1404)) - Stopping the Datanode Admin Monitor.
2022-02-21 12:57:06,807 [Listener at 0.0.0.0/44095] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1411)) - Stopping Lease Manager of the command watchers
2022-02-21 12:57:06,807 [Listener at 0.0.0.0/44095] ERROR server.StorageContainerManager (StorageContainerManager.java:stop(1414)) - Lease Manager of the command watchers stop failed
2022-02-21 12:57:06,807 [Listener at 0.0.0.0/44095] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1418)) - Stopping datanode service RPC server
2022-02-21 12:57:06,807 [Listener at 0.0.0.0/44095] INFO  server.SCMDatanodeProtocolServer (SCMDatanodeProtocolServer.java:stop(390)) - Stopping the RPC server for DataNodes
2022-02-21 12:57:06,807 [Listener at 0.0.0.0/44095] INFO  ipc.Server (Server.java:stop(3414)) - Stopping server on 43631
2022-02-21 12:57:06,808 [Listener at 0.0.0.0/44095] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1426)) - Stopping block service RPC server
2022-02-21 12:57:06,808 [Listener at 0.0.0.0/44095] INFO  server.SCMBlockProtocolServer (SCMBlockProtocolServer.java:stop(160)) - Stopping the RPC server for Block Protocol
2022-02-21 12:57:06,808 [Listener at 0.0.0.0/44095] INFO  ipc.Server (Server.java:stop(3414)) - Stopping server on 44735
2022-02-21 12:57:06,809 [Listener at 0.0.0.0/44095] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1433)) - Stopping the StorageContainerLocationProtocol RPC server
2022-02-21 12:57:06,809 [Listener at 0.0.0.0/44095] INFO  server.SCMClientProtocolServer (SCMClientProtocolServer.java:stop(174)) - Stopping the RPC server for Client Protocol
2022-02-21 12:57:06,809 [Listener at 0.0.0.0/44095] INFO  ipc.Server (Server.java:stop(3414)) - Stopping server on 44095
2022-02-21 12:57:06,809 [Listener at 0.0.0.0/44095] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1440)) - Stopping Storage Container Manager HTTP server.
2022-02-21 12:57:06,811 [Listener at 0.0.0.0/44095] ERROR server.StorageContainerManager (StorageContainerManager.java:stop(1443)) - Storage Container Manager HTTP server stop failed.
java.lang.NullPointerException
	at org.apache.hadoop.hdds.scm.server.StorageContainerManager.stop(StorageContainerManager.java:1441)
	at org.apache.hadoop.hdds.scm.block.TestBlockManager.cleanup(TestBlockManager.java:192)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.RunAfters.invokeMethod(RunAfters.java:46)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:33)
	at org.junit.rules.ExternalResource$1.evaluate(ExternalResource.java:54)
	at org.junit.rules.ExpectedException$ExpectedExceptionStatement.evaluate(ExpectedException.java:258)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115)
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Iterator.forEachRemaining(Iterator.java:116)
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485)
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82)
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:108)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:88)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.lambda$execute$0(EngineExecutionOrchestrator.java:54)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.withInterceptedStreams(EngineExecutionOrchestrator.java:67)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:52)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:96)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:75)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:142)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:113)
	at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:384)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:345)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:126)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:418)
2022-02-21 12:57:06,814 [Listener at 0.0.0.0/44095] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1451)) - Stopping Block Manager Service.
2022-02-21 12:57:06,814 [Listener at 0.0.0.0/44095] INFO  utils.BackgroundService (BackgroundService.java:shutdown(132)) - Shutting down service SCMBlockDeletingService
2022-02-21 12:57:06,815 [Listener at 0.0.0.0/44095] INFO  utils.BackgroundService (BackgroundService.java:shutdown(132)) - Shutting down service SCMBlockDeletingService
2022-02-21 12:57:06,815 [Listener at 0.0.0.0/44095] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1478)) - Stopping SCM Event Queue.
2022-02-21 12:57:06,817 [Listener at 0.0.0.0/44095] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1489)) - Stopping SCM HA services.
2022-02-21 12:57:06,817 [Listener at 0.0.0.0/44095] INFO  pipeline.BackgroundPipelineCreator (BackgroundPipelineCreator.java:stop(158)) - Stopping RatisPipelineUtilsThread.
2022-02-21 12:57:06,818 [Listener at 0.0.0.0/44095] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1499)) - Stopping SCM MetadataStore.
2022-02-21 12:57:06,851 [Listener at 0.0.0.0/44095] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchemaFromFile(129)) - Loading schema from [file:/home/runner/work/ozone/ozone/hadoop-hdds/common/target/classes/network-topology-default.xml]
2022-02-21 12:57:06,851 [Listener at 0.0.0.0/44095] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchema(176)) - Loading network topology layer schema file
2022-02-21 12:57:06,865 [Listener at 0.0.0.0/44095] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchemaFromFile(129)) - Loading schema from [file:/home/runner/work/ozone/ozone/hadoop-hdds/common/target/classes/network-topology-default.xml]
2022-02-21 12:57:06,865 [Listener at 0.0.0.0/44095] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchema(176)) - Loading network topology layer schema file
2022-02-21 12:57:06,867 [Listener at 0.0.0.0/44095] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/b8bc3b42-2711-430b-9ec6-7e0d85695da6
2022-02-21 12:57:06,868 [Listener at 0.0.0.0/44095] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/4dd7b30f-b7b7-46b0-89c0-2458f74f543e
2022-02-21 12:57:06,868 [Listener at 0.0.0.0/44095] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/1540569d-332a-44a5-8f16-8f73977ba299
2022-02-21 12:57:06,868 [Listener at 0.0.0.0/44095] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/289440e4-406e-4465-82b0-1c95cee51392
2022-02-21 12:57:06,868 [Listener at 0.0.0.0/44095] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/886bd166-900a-46f5-a25d-5bbf6dcfcc28
2022-02-21 12:57:06,869 [Listener at 0.0.0.0/44095] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/5f25bdd4-4a66-462f-ad09-5f7bbbbf6a9d
2022-02-21 12:57:06,869 [Listener at 0.0.0.0/44095] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/f3a0e21f-4276-441d-82ed-51544481a30b
2022-02-21 12:57:06,869 [Listener at 0.0.0.0/44095] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/206b69c8-157e-4b63-8b45-da781b2cac05
2022-02-21 12:57:06,869 [Listener at 0.0.0.0/44095] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/7bfff339-4654-4e4a-9e6e-9de71f1e3606
2022-02-21 12:57:06,870 [Listener at 0.0.0.0/44095] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/a4c4c754-2ac6-4b26-b70b-fc006dc41f41
2022-02-21 12:57:06,870 [Listener at 0.0.0.0/44095] WARN  utils.HAUtils (HAUtils.java:getMetaDir(342)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2022-02-21 12:57:06,872 [Listener at 0.0.0.0/44095] WARN  db.DBStoreBuilder (DBStoreBuilder.java:applyDBDefinition(145)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2022-02-21 12:57:06,977 [Listener at 0.0.0.0/44095] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:<init>(218)) - Init the HA SequenceIdGenerator.
2022-02-21 12:57:06,978 [Listener at 0.0.0.0/44095] INFO  pipeline.PipelineStateManagerImpl (PipelineStateManagerImpl.java:initialize(78)) - No pipeline exists in current db
2022-02-21 12:57:06,978 [Listener at 0.0.0.0/44095] INFO  algorithms.LeaderChoosePolicyFactory (LeaderChoosePolicyFactory.java:getPolicy(57)) - Create leader choose policy of type org.apache.hadoop.hdds.scm.pipeline.leader.choose.algorithms.MinLeaderCountChoosePolicy
2022-02-21 12:57:06,979 [Listener at 0.0.0.0/44095] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service BackgroundPipelineCreator.
2022-02-21 12:57:06,979 [Listener at 0.0.0.0/44095] INFO  pipeline.BackgroundPipelineCreator (BackgroundPipelineCreator.java:start(130)) - Starting RatisPipelineUtilsThread.
2022-02-21 12:57:06,980 [Listener at 0.0.0.0/44095] INFO  algorithms.LeaderChoosePolicyFactory (LeaderChoosePolicyFactory.java:getPolicy(57)) - Create leader choose policy of type org.apache.hadoop.hdds.scm.pipeline.leader.choose.algorithms.MinLeaderCountChoosePolicy
2022-02-21 12:57:06,981 [Listener at 0.0.0.0/44095] INFO  safemode.ContainerSafeModeRule (ContainerSafeModeRule.java:<init>(89)) - containers with one replica threshold count 0
2022-02-21 12:57:06,981 [Listener at 0.0.0.0/44095] INFO  safemode.HealthyPipelineSafeModeRule (HealthyPipelineSafeModeRule.java:initializeRule(156)) - Total pipeline count is 0, healthy pipeline threshold count is 0
2022-02-21 12:57:06,982 [Listener at 0.0.0.0/44095] INFO  safemode.OneReplicaPipelineSafeModeRule (OneReplicaPipelineSafeModeRule.java:initializeRule(180)) - Total pipeline count is 0, pipeline's with at least one datanode reported threshold count is 0
2022-02-21 12:57:06,982 [Listener at 0.0.0.0/44095] WARN  server.ServerUtils (ServerUtils.java:getScmDbDir(148)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2022-02-21 12:57:06,984 [Listener at 0.0.0.0/44095] INFO  ha.SCMHANodeDetails (SCMHANodeDetails.java:loadSCMHAConfig(157)) - ServiceID for StorageContainerManager is null
2022-02-21 12:57:06,984 [Listener at 0.0.0.0/44095] INFO  ha.SCMHANodeDetails (SCMHANodeDetails.java:loadSCMHAConfig(162)) - ozone.scm.default.service.id is not defined, falling back to ozone.scm.service.ids to find serviceID for StorageContainerManager if it is HA enabled cluster
2022-02-21 12:57:06,985 [Listener at 0.0.0.0/44095] WARN  server.ServerUtils (ServerUtils.java:getScmDbDir(148)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2022-02-21 12:57:06,986 [Listener at 0.0.0.0/44095] INFO  upgrade.AbstractLayoutVersionManager (AbstractLayoutVersionManager.java:init(79)) - Initializing Layout version manager with metadata layout = SCM_HA (version = 2), software layout = SCM_HA (version = 2)
2022-02-21 12:57:06,987 [Listener at 0.0.0.0/44095] WARN  util.MBeans (MBeans.java:getMBeanName(167)) - Error creating MBean object name: Hadoop:service=LayoutVersionManager,name=HDDSLayoutVersionManager
org.apache.hadoop.metrics2.MetricsException: org.apache.hadoop.metrics2.MetricsException: Hadoop:service=LayoutVersionManager,name=HDDSLayoutVersionManager already exists!
	at org.apache.hadoop.metrics2.lib.DefaultMetricsSystem.newObjectName(DefaultMetricsSystem.java:135)
	at org.apache.hadoop.metrics2.lib.DefaultMetricsSystem.newMBeanName(DefaultMetricsSystem.java:110)
	at org.apache.hadoop.metrics2.util.MBeans.getMBeanName(MBeans.java:165)
	at org.apache.hadoop.metrics2.util.MBeans.register(MBeans.java:97)
	at org.apache.hadoop.metrics2.util.MBeans.register(MBeans.java:73)
	at org.apache.hadoop.ozone.upgrade.AbstractLayoutVersionManager.init(AbstractLayoutVersionManager.java:84)
	at org.apache.hadoop.hdds.upgrade.HDDSLayoutVersionManager.<init>(HDDSLayoutVersionManager.java:50)
	at org.apache.hadoop.hdds.scm.server.StorageContainerManager.<init>(StorageContainerManager.java:326)
	at org.apache.hadoop.hdds.scm.server.StorageContainerManager.createSCM(StorageContainerManager.java:491)
	at org.apache.hadoop.hdds.scm.HddsTestUtils.getScm(HddsTestUtils.java:624)
	at org.apache.hadoop.hdds.scm.block.TestBlockManager.setUp(TestBlockManager.java:175)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.RunBefores.invokeMethod(RunBefores.java:33)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:24)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.rules.ExternalResource$1.evaluate(ExternalResource.java:54)
	at org.junit.rules.ExpectedException$ExpectedExceptionStatement.evaluate(ExpectedException.java:258)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115)
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Iterator.forEachRemaining(Iterator.java:116)
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485)
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82)
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:108)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:88)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.lambda$execute$0(EngineExecutionOrchestrator.java:54)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.withInterceptedStreams(EngineExecutionOrchestrator.java:67)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:52)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:96)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:75)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:142)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:113)
	at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:384)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:345)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:126)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:418)
Caused by: org.apache.hadoop.metrics2.MetricsException: Hadoop:service=LayoutVersionManager,name=HDDSLayoutVersionManager already exists!
	at org.apache.hadoop.metrics2.lib.DefaultMetricsSystem.newObjectName(DefaultMetricsSystem.java:131)
	... 62 more
2022-02-21 12:57:07,032 [Listener at 0.0.0.0/44095] INFO  reflections.Reflections (Reflections.java:scan(232)) - Reflections took 43 ms to scan 6 urls, producing 119 keys and 272 values 
2022-02-21 12:57:07,035 [Listener at 0.0.0.0/44095] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchemaFromFile(129)) - Loading schema from [file:/home/runner/work/ozone/ozone/hadoop-hdds/common/target/classes/network-topology-default.xml]
2022-02-21 12:57:07,035 [Listener at 0.0.0.0/44095] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchema(176)) - Loading network topology layer schema file
2022-02-21 12:57:07,038 [Listener at 0.0.0.0/44095] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:upgradeToSequenceId(347)) - upgrade localId to 109611004723200000
2022-02-21 12:57:07,038 [Listener at 0.0.0.0/44095] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:upgradeToSequenceId(357)) - upgrade delTxnId to 0
2022-02-21 12:57:07,039 [Listener at 0.0.0.0/44095] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:upgradeToSequenceId(371)) - upgrade containerId to 0
2022-02-21 12:57:07,039 [Listener at 0.0.0.0/44095] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:<init>(218)) - Init the HA SequenceIdGenerator.
2022-02-21 12:57:07,039 [Listener at 0.0.0.0/44095] INFO  algorithms.ContainerPlacementPolicyFactory (ContainerPlacementPolicyFactory.java:getPolicy(60)) - Create container placement policy of type org.apache.hadoop.hdds.scm.container.placement.algorithms.SCMContainerPlacementRandom
2022-02-21 12:57:07,040 [Listener at 0.0.0.0/44095] INFO  algorithms.PipelineChoosePolicyFactory (PipelineChoosePolicyFactory.java:createPipelineChoosePolicyFromClass(73)) - Create pipeline choose policy of type org.apache.hadoop.hdds.scm.pipeline.choose.algorithms.RandomPipelineChoosePolicy
2022-02-21 12:57:07,041 [Listener at 0.0.0.0/44095] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service SCMBlockDeletingService.
2022-02-21 12:57:07,041 [Listener at 0.0.0.0/44095] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service ReplicationManager.
2022-02-21 12:57:07,041 [Listener at 0.0.0.0/44095] INFO  container.ReplicationManager (ReplicationManager.java:start(326)) - Starting Replication Monitor Thread.
2022-02-21 12:57:07,046 [Listener at 0.0.0.0/44095] INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(90)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 10000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false.
2022-02-21 12:57:07,050 [Socket Reader #1 for port 0] INFO  ipc.Server (Server.java:run(1265)) - Starting Socket Reader #1 for port 0
2022-02-21 12:57:07,051 [Listener at 0.0.0.0/41627] INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(90)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 10000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false.
2022-02-21 12:57:07,056 [ReplicationMonitor] INFO  container.ReplicationManager (ReplicationManager.java:processAll(374)) - Replication Manager is not ready to run until 300000ms after safemode exit
2022-02-21 12:57:07,058 [Socket Reader #1 for port 0] INFO  ipc.Server (Server.java:run(1265)) - Starting Socket Reader #1 for port 0
2022-02-21 12:57:07,060 [Listener at 0.0.0.0/41583] INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(90)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 10000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false.
2022-02-21 12:57:07,075 [Socket Reader #1 for port 0] INFO  ipc.Server (Server.java:run(1265)) - Starting Socket Reader #1 for port 0
2022-02-21 12:57:07,104 [Listener at 0.0.0.0/42431] INFO  algorithms.ContainerPlacementPolicyFactory (ContainerPlacementPolicyFactory.java:getPolicy(60)) - Create container placement policy of type org.apache.hadoop.hdds.scm.container.placement.algorithms.SCMContainerPlacementRandom
2022-02-21 12:57:07,106 [Listener at 0.0.0.0/42431] INFO  server.StorageContainerManager (StorageContainerManager.java:<init>(388)) - 
Container Balancer status:
Key                            Value
Running                        false
Container Balancer Configuration values:
Key                                                Value
Threshold                                          10
Max Datanodes to Involve per Iteration(percent)    20
Max Size to Move per Iteration                     500GB
Max Size Entering Target per Iteration             26GB
Max Size Leaving Source per Iteration              26GB

2022-02-21 12:57:07,108 [Listener at 0.0.0.0/42431] INFO  ha.SCMContext (SCMContext.java:updateSafeModeStatus(211)) - Update SafeModeStatus from SafeModeStatus{safeModeStatus=false, preCheckPassed=true} to SafeModeStatus{safeModeStatus=false, preCheckPassed=true}.
2022-02-21 12:57:07,110 [Time-limited test] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(183)) - Sending CreatePipelineCommand for pipeline:PipelineID=89f5cdf2-c05a-4422-ac57-303811297b3c to datanode:5f25bdd4-4a66-462f-ad09-5f7bbbbf6a9d
2022-02-21 12:57:07,112 [Time-limited test] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(183)) - Sending CreatePipelineCommand for pipeline:PipelineID=89f5cdf2-c05a-4422-ac57-303811297b3c to datanode:f3a0e21f-4276-441d-82ed-51544481a30b
2022-02-21 12:57:07,112 [Time-limited test] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(183)) - Sending CreatePipelineCommand for pipeline:PipelineID=89f5cdf2-c05a-4422-ac57-303811297b3c to datanode:289440e4-406e-4465-82b0-1c95cee51392
2022-02-21 12:57:07,113 [Time-limited test] INFO  pipeline.PipelineStateManagerImpl (PipelineStateManagerImpl.java:addPipeline(101)) - Created pipeline Pipeline[ Id: 89f5cdf2-c05a-4422-ac57-303811297b3c, Nodes: 5f25bdd4-4a66-462f-ad09-5f7bbbbf6a9d{ip: 80.21.111.247, host: localhost-80.21.111.247, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}f3a0e21f-4276-441d-82ed-51544481a30b{ip: 191.150.235.208, host: localhost-191.150.235.208, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}289440e4-406e-4465-82b0-1c95cee51392{ip: 167.17.188.149, host: localhost-167.17.188.149, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}, ReplicationConfig: RATIS/THREE, State:ALLOCATED, leaderId:, CreationTimestamp2022-02-21T12:57:07.110Z[Etc/UTC]].
2022-02-21 12:57:07,115 [Time-limited test] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(183)) - Sending CreatePipelineCommand for pipeline:PipelineID=9d3f0566-76c3-4654-993a-4b9ce4177929 to datanode:886bd166-900a-46f5-a25d-5bbf6dcfcc28
2022-02-21 12:57:07,115 [Time-limited test] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(183)) - Sending CreatePipelineCommand for pipeline:PipelineID=9d3f0566-76c3-4654-993a-4b9ce4177929 to datanode:f3a0e21f-4276-441d-82ed-51544481a30b
2022-02-21 12:57:07,115 [Time-limited test] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(183)) - Sending CreatePipelineCommand for pipeline:PipelineID=9d3f0566-76c3-4654-993a-4b9ce4177929 to datanode:b8bc3b42-2711-430b-9ec6-7e0d85695da6
2022-02-21 12:57:07,116 [Time-limited test] INFO  pipeline.PipelineStateManagerImpl (PipelineStateManagerImpl.java:addPipeline(101)) - Created pipeline Pipeline[ Id: 9d3f0566-76c3-4654-993a-4b9ce4177929, Nodes: 886bd166-900a-46f5-a25d-5bbf6dcfcc28{ip: 248.168.226.109, host: localhost-248.168.226.109, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}f3a0e21f-4276-441d-82ed-51544481a30b{ip: 191.150.235.208, host: localhost-191.150.235.208, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}b8bc3b42-2711-430b-9ec6-7e0d85695da6{ip: 226.5.190.75, host: localhost-226.5.190.75, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}, ReplicationConfig: RATIS/THREE, State:ALLOCATED, leaderId:, CreationTimestamp2022-02-21T12:57:07.114Z[Etc/UTC]].
2022-02-21 12:57:07,116 [Time-limited test] INFO  pipeline.PipelineManagerImpl (PipelineManagerImpl.java:openPipeline(291)) - Pipeline Pipeline[ Id: 89f5cdf2-c05a-4422-ac57-303811297b3c, Nodes: 5f25bdd4-4a66-462f-ad09-5f7bbbbf6a9d{ip: 80.21.111.247, host: localhost-80.21.111.247, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}f3a0e21f-4276-441d-82ed-51544481a30b{ip: 191.150.235.208, host: localhost-191.150.235.208, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}289440e4-406e-4465-82b0-1c95cee51392{ip: 167.17.188.149, host: localhost-167.17.188.149, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}, ReplicationConfig: RATIS/THREE, State:ALLOCATED, leaderId:, CreationTimestamp2022-02-21T12:57:07.110Z[Etc/UTC]] moved to OPEN state
2022-02-21 12:57:07,117 [Time-limited test] INFO  pipeline.PipelineManagerImpl (PipelineManagerImpl.java:openPipeline(291)) - Pipeline Pipeline[ Id: 9d3f0566-76c3-4654-993a-4b9ce4177929, Nodes: 886bd166-900a-46f5-a25d-5bbf6dcfcc28{ip: 248.168.226.109, host: localhost-248.168.226.109, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}f3a0e21f-4276-441d-82ed-51544481a30b{ip: 191.150.235.208, host: localhost-191.150.235.208, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}b8bc3b42-2711-430b-9ec6-7e0d85695da6{ip: 226.5.190.75, host: localhost-226.5.190.75, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}, ReplicationConfig: RATIS/THREE, State:ALLOCATED, leaderId:, CreationTimestamp2022-02-21T12:57:07.114Z[Etc/UTC]] moved to OPEN state
2022-02-21 12:57:07,121 [Time-limited test] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:getNextId(127)) - Allocate a batch for containerId, change lastId from 0 to 1000.
2022-02-21 12:57:07,122 [Time-limited test] WARN  ha.SequenceIdGenerator (SequenceIdGenerator.java:allocateBatch(235)) - Failed to allocate a batch for localId, expected lastId is 0, actual lastId is 109611004723200000.
2022-02-21 12:57:07,122 [Time-limited test] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:getNextId(127)) - Allocate a batch for localId, change lastId from 109611004723200000 to 109611004723201000.
2022-02-21 12:57:08,147 [Listener at 0.0.0.0/42431] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1390)) - Stopping Container Balancer service.
2022-02-21 12:57:08,148 [Listener at 0.0.0.0/42431] INFO  balancer.ContainerBalancer (ContainerBalancer.java:stop(751)) - Container Balancer is not running.
2022-02-21 12:57:08,148 [Listener at 0.0.0.0/42431] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1397)) - Stopping Replication Manager Service.
2022-02-21 12:57:08,148 [Listener at 0.0.0.0/42431] INFO  container.ReplicationManager (ReplicationManager.java:stop(357)) - Stopping Replication Monitor Thread.
2022-02-21 12:57:08,148 [Listener at 0.0.0.0/42431] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1404)) - Stopping the Datanode Admin Monitor.
2022-02-21 12:57:08,148 [Listener at 0.0.0.0/42431] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1411)) - Stopping Lease Manager of the command watchers
2022-02-21 12:57:08,148 [Listener at 0.0.0.0/42431] ERROR server.StorageContainerManager (StorageContainerManager.java:stop(1414)) - Lease Manager of the command watchers stop failed
2022-02-21 12:57:08,149 [Listener at 0.0.0.0/42431] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1418)) - Stopping datanode service RPC server
2022-02-21 12:57:08,149 [Listener at 0.0.0.0/42431] INFO  server.SCMDatanodeProtocolServer (SCMDatanodeProtocolServer.java:stop(390)) - Stopping the RPC server for DataNodes
2022-02-21 12:57:08,149 [Listener at 0.0.0.0/42431] INFO  ipc.Server (Server.java:stop(3414)) - Stopping server on 41627
2022-02-21 12:57:08,150 [Listener at 0.0.0.0/42431] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1426)) - Stopping block service RPC server
2022-02-21 12:57:08,150 [Listener at 0.0.0.0/42431] INFO  server.SCMBlockProtocolServer (SCMBlockProtocolServer.java:stop(160)) - Stopping the RPC server for Block Protocol
2022-02-21 12:57:08,150 [Listener at 0.0.0.0/42431] INFO  ipc.Server (Server.java:stop(3414)) - Stopping server on 41583
2022-02-21 12:57:08,152 [Listener at 0.0.0.0/42431] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1433)) - Stopping the StorageContainerLocationProtocol RPC server
2022-02-21 12:57:08,153 [Listener at 0.0.0.0/42431] INFO  server.SCMClientProtocolServer (SCMClientProtocolServer.java:stop(174)) - Stopping the RPC server for Client Protocol
2022-02-21 12:57:08,153 [Listener at 0.0.0.0/42431] INFO  ipc.Server (Server.java:stop(3414)) - Stopping server on 42431
2022-02-21 12:57:08,153 [Listener at 0.0.0.0/42431] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1440)) - Stopping Storage Container Manager HTTP server.
2022-02-21 12:57:08,153 [Listener at 0.0.0.0/42431] ERROR server.StorageContainerManager (StorageContainerManager.java:stop(1443)) - Storage Container Manager HTTP server stop failed.
java.lang.NullPointerException
	at org.apache.hadoop.hdds.scm.server.StorageContainerManager.stop(StorageContainerManager.java:1441)
	at org.apache.hadoop.hdds.scm.block.TestBlockManager.cleanup(TestBlockManager.java:192)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.RunAfters.invokeMethod(RunAfters.java:46)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:33)
	at org.junit.rules.ExternalResource$1.evaluate(ExternalResource.java:54)
	at org.junit.rules.ExpectedException$ExpectedExceptionStatement.evaluate(ExpectedException.java:258)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115)
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Iterator.forEachRemaining(Iterator.java:116)
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485)
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82)
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:108)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:88)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.lambda$execute$0(EngineExecutionOrchestrator.java:54)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.withInterceptedStreams(EngineExecutionOrchestrator.java:67)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:52)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:96)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:75)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:142)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:113)
	at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:384)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:345)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:126)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:418)
2022-02-21 12:57:08,154 [Listener at 0.0.0.0/42431] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1451)) - Stopping Block Manager Service.
2022-02-21 12:57:08,154 [Listener at 0.0.0.0/42431] INFO  utils.BackgroundService (BackgroundService.java:shutdown(132)) - Shutting down service SCMBlockDeletingService
2022-02-21 12:57:08,154 [Listener at 0.0.0.0/42431] INFO  utils.BackgroundService (BackgroundService.java:shutdown(132)) - Shutting down service SCMBlockDeletingService
2022-02-21 12:57:08,155 [Listener at 0.0.0.0/42431] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1478)) - Stopping SCM Event Queue.
2022-02-21 12:57:08,155 [Listener at 0.0.0.0/42431] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1489)) - Stopping SCM HA services.
2022-02-21 12:57:08,155 [Listener at 0.0.0.0/42431] INFO  pipeline.BackgroundPipelineCreator (BackgroundPipelineCreator.java:stop(158)) - Stopping RatisPipelineUtilsThread.
2022-02-21 12:57:08,156 [Listener at 0.0.0.0/42431] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1499)) - Stopping SCM MetadataStore.
2022-02-21 12:57:08,208 [Listener at 0.0.0.0/42431] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchemaFromFile(129)) - Loading schema from [file:/home/runner/work/ozone/ozone/hadoop-hdds/common/target/classes/network-topology-default.xml]
2022-02-21 12:57:08,208 [Listener at 0.0.0.0/42431] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchema(176)) - Loading network topology layer schema file
2022-02-21 12:57:08,236 [Listener at 0.0.0.0/42431] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchemaFromFile(129)) - Loading schema from [file:/home/runner/work/ozone/ozone/hadoop-hdds/common/target/classes/network-topology-default.xml]
2022-02-21 12:57:08,236 [Listener at 0.0.0.0/42431] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchema(176)) - Loading network topology layer schema file
2022-02-21 12:57:08,239 [Listener at 0.0.0.0/42431] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/5322a6a5-bc80-49ba-b563-b06c7cc771e8
2022-02-21 12:57:08,239 [Listener at 0.0.0.0/42431] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/79581dd1-2542-4aca-bbd2-e8a61b08b37c
2022-02-21 12:57:08,239 [Listener at 0.0.0.0/42431] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/e255192a-ec7e-45e8-8837-7ca96a81b4c7
2022-02-21 12:57:08,239 [Listener at 0.0.0.0/42431] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/7e8a2bf4-6d0b-422e-9979-3a4734fcd0cb
2022-02-21 12:57:08,240 [Listener at 0.0.0.0/42431] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/91a8bd9a-3f91-4aed-b6e4-356082e4bb40
2022-02-21 12:57:08,240 [Listener at 0.0.0.0/42431] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/19e59845-9531-41dc-ae14-c10761614c78
2022-02-21 12:57:08,240 [Listener at 0.0.0.0/42431] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/dad75e26-e89f-440c-bb0c-bbd517faed23
2022-02-21 12:57:08,241 [Listener at 0.0.0.0/42431] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/f15a1757-4ec1-4a35-91ec-bf465a7eeeb8
2022-02-21 12:57:08,241 [Listener at 0.0.0.0/42431] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/5abbaf15-8bb3-4457-a05f-6ae1f2094daf
2022-02-21 12:57:08,241 [Listener at 0.0.0.0/42431] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/526d7d5e-8cde-4264-8559-4f19ab2ad082
2022-02-21 12:57:08,241 [Listener at 0.0.0.0/42431] WARN  utils.HAUtils (HAUtils.java:getMetaDir(342)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2022-02-21 12:57:08,243 [Listener at 0.0.0.0/42431] WARN  db.DBStoreBuilder (DBStoreBuilder.java:applyDBDefinition(145)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2022-02-21 12:57:08,341 [Listener at 0.0.0.0/42431] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:<init>(218)) - Init the HA SequenceIdGenerator.
2022-02-21 12:57:08,342 [Listener at 0.0.0.0/42431] INFO  pipeline.PipelineStateManagerImpl (PipelineStateManagerImpl.java:initialize(78)) - No pipeline exists in current db
2022-02-21 12:57:08,342 [Listener at 0.0.0.0/42431] INFO  algorithms.LeaderChoosePolicyFactory (LeaderChoosePolicyFactory.java:getPolicy(57)) - Create leader choose policy of type org.apache.hadoop.hdds.scm.pipeline.leader.choose.algorithms.MinLeaderCountChoosePolicy
2022-02-21 12:57:08,343 [Listener at 0.0.0.0/42431] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service BackgroundPipelineCreator.
2022-02-21 12:57:08,343 [Listener at 0.0.0.0/42431] INFO  pipeline.BackgroundPipelineCreator (BackgroundPipelineCreator.java:start(130)) - Starting RatisPipelineUtilsThread.
2022-02-21 12:57:08,343 [Listener at 0.0.0.0/42431] INFO  algorithms.LeaderChoosePolicyFactory (LeaderChoosePolicyFactory.java:getPolicy(57)) - Create leader choose policy of type org.apache.hadoop.hdds.scm.pipeline.leader.choose.algorithms.MinLeaderCountChoosePolicy
2022-02-21 12:57:08,345 [Listener at 0.0.0.0/42431] INFO  safemode.ContainerSafeModeRule (ContainerSafeModeRule.java:<init>(89)) - containers with one replica threshold count 0
2022-02-21 12:57:08,345 [Listener at 0.0.0.0/42431] INFO  safemode.HealthyPipelineSafeModeRule (HealthyPipelineSafeModeRule.java:initializeRule(156)) - Total pipeline count is 0, healthy pipeline threshold count is 0
2022-02-21 12:57:08,345 [Listener at 0.0.0.0/42431] INFO  safemode.OneReplicaPipelineSafeModeRule (OneReplicaPipelineSafeModeRule.java:initializeRule(180)) - Total pipeline count is 0, pipeline's with at least one datanode reported threshold count is 0
2022-02-21 12:57:08,345 [Listener at 0.0.0.0/42431] WARN  server.ServerUtils (ServerUtils.java:getScmDbDir(148)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2022-02-21 12:57:08,347 [Listener at 0.0.0.0/42431] INFO  ha.SCMHANodeDetails (SCMHANodeDetails.java:loadSCMHAConfig(157)) - ServiceID for StorageContainerManager is null
2022-02-21 12:57:08,348 [Listener at 0.0.0.0/42431] INFO  ha.SCMHANodeDetails (SCMHANodeDetails.java:loadSCMHAConfig(162)) - ozone.scm.default.service.id is not defined, falling back to ozone.scm.service.ids to find serviceID for StorageContainerManager if it is HA enabled cluster
2022-02-21 12:57:08,349 [Listener at 0.0.0.0/42431] WARN  server.ServerUtils (ServerUtils.java:getScmDbDir(148)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2022-02-21 12:57:08,349 [Listener at 0.0.0.0/42431] INFO  upgrade.AbstractLayoutVersionManager (AbstractLayoutVersionManager.java:init(79)) - Initializing Layout version manager with metadata layout = SCM_HA (version = 2), software layout = SCM_HA (version = 2)
2022-02-21 12:57:08,349 [Listener at 0.0.0.0/42431] WARN  util.MBeans (MBeans.java:getMBeanName(167)) - Error creating MBean object name: Hadoop:service=LayoutVersionManager,name=HDDSLayoutVersionManager
org.apache.hadoop.metrics2.MetricsException: org.apache.hadoop.metrics2.MetricsException: Hadoop:service=LayoutVersionManager,name=HDDSLayoutVersionManager already exists!
	at org.apache.hadoop.metrics2.lib.DefaultMetricsSystem.newObjectName(DefaultMetricsSystem.java:135)
	at org.apache.hadoop.metrics2.lib.DefaultMetricsSystem.newMBeanName(DefaultMetricsSystem.java:110)
	at org.apache.hadoop.metrics2.util.MBeans.getMBeanName(MBeans.java:165)
	at org.apache.hadoop.metrics2.util.MBeans.register(MBeans.java:97)
	at org.apache.hadoop.metrics2.util.MBeans.register(MBeans.java:73)
	at org.apache.hadoop.ozone.upgrade.AbstractLayoutVersionManager.init(AbstractLayoutVersionManager.java:84)
	at org.apache.hadoop.hdds.upgrade.HDDSLayoutVersionManager.<init>(HDDSLayoutVersionManager.java:50)
	at org.apache.hadoop.hdds.scm.server.StorageContainerManager.<init>(StorageContainerManager.java:326)
	at org.apache.hadoop.hdds.scm.server.StorageContainerManager.createSCM(StorageContainerManager.java:491)
	at org.apache.hadoop.hdds.scm.HddsTestUtils.getScm(HddsTestUtils.java:624)
	at org.apache.hadoop.hdds.scm.block.TestBlockManager.setUp(TestBlockManager.java:175)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.RunBefores.invokeMethod(RunBefores.java:33)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:24)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.rules.ExternalResource$1.evaluate(ExternalResource.java:54)
	at org.junit.rules.ExpectedException$ExpectedExceptionStatement.evaluate(ExpectedException.java:258)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115)
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Iterator.forEachRemaining(Iterator.java:116)
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485)
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82)
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:108)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:88)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.lambda$execute$0(EngineExecutionOrchestrator.java:54)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.withInterceptedStreams(EngineExecutionOrchestrator.java:67)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:52)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:96)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:75)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:142)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:113)
	at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:384)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:345)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:126)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:418)
Caused by: org.apache.hadoop.metrics2.MetricsException: Hadoop:service=LayoutVersionManager,name=HDDSLayoutVersionManager already exists!
	at org.apache.hadoop.metrics2.lib.DefaultMetricsSystem.newObjectName(DefaultMetricsSystem.java:131)
	... 62 more
2022-02-21 12:57:08,398 [Listener at 0.0.0.0/42431] INFO  reflections.Reflections (Reflections.java:scan(232)) - Reflections took 46 ms to scan 6 urls, producing 119 keys and 272 values 
2022-02-21 12:57:08,400 [Listener at 0.0.0.0/42431] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchemaFromFile(129)) - Loading schema from [file:/home/runner/work/ozone/ozone/hadoop-hdds/common/target/classes/network-topology-default.xml]
2022-02-21 12:57:08,401 [Listener at 0.0.0.0/42431] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchema(176)) - Loading network topology layer schema file
2022-02-21 12:57:08,406 [Listener at 0.0.0.0/42431] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:upgradeToSequenceId(347)) - upgrade localId to 109611004723200000
2022-02-21 12:57:08,406 [Listener at 0.0.0.0/42431] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:upgradeToSequenceId(357)) - upgrade delTxnId to 0
2022-02-21 12:57:08,407 [Listener at 0.0.0.0/42431] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:upgradeToSequenceId(371)) - upgrade containerId to 0
2022-02-21 12:57:08,407 [Listener at 0.0.0.0/42431] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:<init>(218)) - Init the HA SequenceIdGenerator.
2022-02-21 12:57:08,407 [Listener at 0.0.0.0/42431] INFO  algorithms.ContainerPlacementPolicyFactory (ContainerPlacementPolicyFactory.java:getPolicy(60)) - Create container placement policy of type org.apache.hadoop.hdds.scm.container.placement.algorithms.SCMContainerPlacementRandom
2022-02-21 12:57:08,408 [Listener at 0.0.0.0/42431] INFO  algorithms.PipelineChoosePolicyFactory (PipelineChoosePolicyFactory.java:createPipelineChoosePolicyFromClass(73)) - Create pipeline choose policy of type org.apache.hadoop.hdds.scm.pipeline.choose.algorithms.RandomPipelineChoosePolicy
2022-02-21 12:57:08,408 [Listener at 0.0.0.0/42431] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service SCMBlockDeletingService.
2022-02-21 12:57:08,409 [Listener at 0.0.0.0/42431] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service ReplicationManager.
2022-02-21 12:57:08,409 [Listener at 0.0.0.0/42431] INFO  container.ReplicationManager (ReplicationManager.java:start(326)) - Starting Replication Monitor Thread.
2022-02-21 12:57:08,411 [ReplicationMonitor] INFO  container.ReplicationManager (ReplicationManager.java:processAll(374)) - Replication Manager is not ready to run until 300000ms after safemode exit
2022-02-21 12:57:08,412 [Listener at 0.0.0.0/42431] INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(90)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 10000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false.
2022-02-21 12:57:08,415 [Socket Reader #1 for port 0] INFO  ipc.Server (Server.java:run(1265)) - Starting Socket Reader #1 for port 0
2022-02-21 12:57:08,417 [Listener at 0.0.0.0/42245] INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(90)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 10000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false.
2022-02-21 12:57:08,418 [Socket Reader #1 for port 0] INFO  ipc.Server (Server.java:run(1265)) - Starting Socket Reader #1 for port 0
2022-02-21 12:57:08,419 [Listener at 0.0.0.0/40459] INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(90)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 10000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false.
2022-02-21 12:57:08,420 [Socket Reader #1 for port 0] INFO  ipc.Server (Server.java:run(1265)) - Starting Socket Reader #1 for port 0
2022-02-21 12:57:08,441 [Listener at 0.0.0.0/42801] INFO  algorithms.ContainerPlacementPolicyFactory (ContainerPlacementPolicyFactory.java:getPolicy(60)) - Create container placement policy of type org.apache.hadoop.hdds.scm.container.placement.algorithms.SCMContainerPlacementRandom
2022-02-21 12:57:08,442 [Listener at 0.0.0.0/42801] INFO  server.StorageContainerManager (StorageContainerManager.java:<init>(388)) - 
Container Balancer status:
Key                            Value
Running                        false
Container Balancer Configuration values:
Key                                                Value
Threshold                                          10
Max Datanodes to Involve per Iteration(percent)    20
Max Size to Move per Iteration                     500GB
Max Size Entering Target per Iteration             26GB
Max Size Leaving Source per Iteration              26GB

2022-02-21 12:57:08,444 [Listener at 0.0.0.0/42801] INFO  ha.SCMContext (SCMContext.java:updateSafeModeStatus(211)) - Update SafeModeStatus from SafeModeStatus{safeModeStatus=false, preCheckPassed=true} to SafeModeStatus{safeModeStatus=false, preCheckPassed=true}.
2022-02-21 12:57:08,448 [Listener at 0.0.0.0/42801] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(183)) - Sending CreatePipelineCommand for pipeline:PipelineID=a968aea6-5bcf-4c7d-8995-7946a0cda28c to datanode:5322a6a5-bc80-49ba-b563-b06c7cc771e8
2022-02-21 12:57:08,450 [Listener at 0.0.0.0/42801] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(183)) - Sending CreatePipelineCommand for pipeline:PipelineID=a968aea6-5bcf-4c7d-8995-7946a0cda28c to datanode:e255192a-ec7e-45e8-8837-7ca96a81b4c7
2022-02-21 12:57:08,451 [Listener at 0.0.0.0/42801] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(183)) - Sending CreatePipelineCommand for pipeline:PipelineID=a968aea6-5bcf-4c7d-8995-7946a0cda28c to datanode:91a8bd9a-3f91-4aed-b6e4-356082e4bb40
2022-02-21 12:57:08,453 [Listener at 0.0.0.0/42801] INFO  pipeline.PipelineStateManagerImpl (PipelineStateManagerImpl.java:addPipeline(101)) - Created pipeline Pipeline[ Id: a968aea6-5bcf-4c7d-8995-7946a0cda28c, Nodes: 5322a6a5-bc80-49ba-b563-b06c7cc771e8{ip: 27.240.33.169, host: localhost-27.240.33.169, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}e255192a-ec7e-45e8-8837-7ca96a81b4c7{ip: 255.146.163.202, host: localhost-255.146.163.202, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}91a8bd9a-3f91-4aed-b6e4-356082e4bb40{ip: 99.177.236.49, host: localhost-99.177.236.49, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}, ReplicationConfig: RATIS/THREE, State:ALLOCATED, leaderId:, CreationTimestamp2022-02-21T12:57:08.447Z[Etc/UTC]].
2022-02-21 12:57:08,455 [Listener at 0.0.0.0/42801] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(183)) - Sending CreatePipelineCommand for pipeline:PipelineID=50f8113a-751e-425e-9b2d-b7de01fcb745 to datanode:91a8bd9a-3f91-4aed-b6e4-356082e4bb40
2022-02-21 12:57:08,455 [Listener at 0.0.0.0/42801] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(183)) - Sending CreatePipelineCommand for pipeline:PipelineID=50f8113a-751e-425e-9b2d-b7de01fcb745 to datanode:5322a6a5-bc80-49ba-b563-b06c7cc771e8
2022-02-21 12:57:08,456 [Listener at 0.0.0.0/42801] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(183)) - Sending CreatePipelineCommand for pipeline:PipelineID=50f8113a-751e-425e-9b2d-b7de01fcb745 to datanode:dad75e26-e89f-440c-bb0c-bbd517faed23
2022-02-21 12:57:08,457 [Listener at 0.0.0.0/42801] INFO  pipeline.PipelineStateManagerImpl (PipelineStateManagerImpl.java:addPipeline(101)) - Created pipeline Pipeline[ Id: 50f8113a-751e-425e-9b2d-b7de01fcb745, Nodes: 91a8bd9a-3f91-4aed-b6e4-356082e4bb40{ip: 99.177.236.49, host: localhost-99.177.236.49, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}5322a6a5-bc80-49ba-b563-b06c7cc771e8{ip: 27.240.33.169, host: localhost-27.240.33.169, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}dad75e26-e89f-440c-bb0c-bbd517faed23{ip: 85.204.110.94, host: localhost-85.204.110.94, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}, ReplicationConfig: RATIS/THREE, State:ALLOCATED, leaderId:, CreationTimestamp2022-02-21T12:57:08.455Z[Etc/UTC]].
2022-02-21 12:57:08,459 [Listener at 0.0.0.0/42801] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(183)) - Sending CreatePipelineCommand for pipeline:PipelineID=554f051f-82a5-4de6-b743-48a00d4a17fa to datanode:19e59845-9531-41dc-ae14-c10761614c78
2022-02-21 12:57:08,459 [Listener at 0.0.0.0/42801] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(183)) - Sending CreatePipelineCommand for pipeline:PipelineID=554f051f-82a5-4de6-b743-48a00d4a17fa to datanode:dad75e26-e89f-440c-bb0c-bbd517faed23
2022-02-21 12:57:08,461 [Listener at 0.0.0.0/42801] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(183)) - Sending CreatePipelineCommand for pipeline:PipelineID=554f051f-82a5-4de6-b743-48a00d4a17fa to datanode:79581dd1-2542-4aca-bbd2-e8a61b08b37c
2022-02-21 12:57:08,462 [Listener at 0.0.0.0/42801] INFO  pipeline.PipelineStateManagerImpl (PipelineStateManagerImpl.java:addPipeline(101)) - Created pipeline Pipeline[ Id: 554f051f-82a5-4de6-b743-48a00d4a17fa, Nodes: 19e59845-9531-41dc-ae14-c10761614c78{ip: 86.14.91.167, host: localhost-86.14.91.167, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}dad75e26-e89f-440c-bb0c-bbd517faed23{ip: 85.204.110.94, host: localhost-85.204.110.94, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}79581dd1-2542-4aca-bbd2-e8a61b08b37c{ip: 236.14.180.234, host: localhost-236.14.180.234, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}, ReplicationConfig: RATIS/THREE, State:ALLOCATED, leaderId:, CreationTimestamp2022-02-21T12:57:08.459Z[Etc/UTC]].
2022-02-21 12:57:08,463 [EventQueue-DatanodeCommandForDatanodeCommandHandler] INFO  pipeline.PipelineManagerImpl (PipelineManagerImpl.java:openPipeline(291)) - Pipeline Pipeline[ Id: a968aea6-5bcf-4c7d-8995-7946a0cda28c, Nodes: 5322a6a5-bc80-49ba-b563-b06c7cc771e8{ip: 27.240.33.169, host: localhost-27.240.33.169, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}e255192a-ec7e-45e8-8837-7ca96a81b4c7{ip: 255.146.163.202, host: localhost-255.146.163.202, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}91a8bd9a-3f91-4aed-b6e4-356082e4bb40{ip: 99.177.236.49, host: localhost-99.177.236.49, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}, ReplicationConfig: RATIS/THREE, State:ALLOCATED, leaderId:, CreationTimestamp2022-02-21T12:57:08.447Z[Etc/UTC]] moved to OPEN state
2022-02-21 12:57:08,464 [EventQueue-DatanodeCommandForDatanodeCommandHandler] INFO  pipeline.PipelineManagerImpl (PipelineManagerImpl.java:openPipeline(291)) - Pipeline Pipeline[ Id: 50f8113a-751e-425e-9b2d-b7de01fcb745, Nodes: 91a8bd9a-3f91-4aed-b6e4-356082e4bb40{ip: 99.177.236.49, host: localhost-99.177.236.49, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}5322a6a5-bc80-49ba-b563-b06c7cc771e8{ip: 27.240.33.169, host: localhost-27.240.33.169, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}dad75e26-e89f-440c-bb0c-bbd517faed23{ip: 85.204.110.94, host: localhost-85.204.110.94, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}, ReplicationConfig: RATIS/THREE, State:ALLOCATED, leaderId:, CreationTimestamp2022-02-21T12:57:08.455Z[Etc/UTC]] moved to OPEN state
2022-02-21 12:57:08,465 [EventQueue-DatanodeCommandForDatanodeCommandHandler] INFO  pipeline.PipelineManagerImpl (PipelineManagerImpl.java:openPipeline(291)) - Pipeline Pipeline[ Id: 554f051f-82a5-4de6-b743-48a00d4a17fa, Nodes: 19e59845-9531-41dc-ae14-c10761614c78{ip: 86.14.91.167, host: localhost-86.14.91.167, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}dad75e26-e89f-440c-bb0c-bbd517faed23{ip: 85.204.110.94, host: localhost-85.204.110.94, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}79581dd1-2542-4aca-bbd2-e8a61b08b37c{ip: 236.14.180.234, host: localhost-236.14.180.234, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}, ReplicationConfig: RATIS/THREE, State:ALLOCATED, leaderId:, CreationTimestamp2022-02-21T12:57:08.459Z[Etc/UTC]] moved to OPEN state
2022-02-21 12:57:08,467 [Listener at 0.0.0.0/42801] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(183)) - Sending CreatePipelineCommand for pipeline:PipelineID=1fd91332-4855-4885-b208-162412e3d286 to datanode:7e8a2bf4-6d0b-422e-9979-3a4734fcd0cb
2022-02-21 12:57:08,467 [Listener at 0.0.0.0/42801] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(183)) - Sending CreatePipelineCommand for pipeline:PipelineID=1fd91332-4855-4885-b208-162412e3d286 to datanode:19e59845-9531-41dc-ae14-c10761614c78
2022-02-21 12:57:08,468 [Listener at 0.0.0.0/42801] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(183)) - Sending CreatePipelineCommand for pipeline:PipelineID=1fd91332-4855-4885-b208-162412e3d286 to datanode:79581dd1-2542-4aca-bbd2-e8a61b08b37c
2022-02-21 12:57:08,469 [Listener at 0.0.0.0/42801] INFO  pipeline.PipelineStateManagerImpl (PipelineStateManagerImpl.java:addPipeline(101)) - Created pipeline Pipeline[ Id: 1fd91332-4855-4885-b208-162412e3d286, Nodes: 7e8a2bf4-6d0b-422e-9979-3a4734fcd0cb{ip: 184.202.74.75, host: localhost-184.202.74.75, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}19e59845-9531-41dc-ae14-c10761614c78{ip: 86.14.91.167, host: localhost-86.14.91.167, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}79581dd1-2542-4aca-bbd2-e8a61b08b37c{ip: 236.14.180.234, host: localhost-236.14.180.234, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}, ReplicationConfig: RATIS/THREE, State:ALLOCATED, leaderId:, CreationTimestamp2022-02-21T12:57:08.467Z[Etc/UTC]].
2022-02-21 12:57:08,469 [EventQueue-DatanodeCommandForDatanodeCommandHandler] INFO  pipeline.PipelineManagerImpl (PipelineManagerImpl.java:openPipeline(291)) - Pipeline Pipeline[ Id: 1fd91332-4855-4885-b208-162412e3d286, Nodes: 7e8a2bf4-6d0b-422e-9979-3a4734fcd0cb{ip: 184.202.74.75, host: localhost-184.202.74.75, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}19e59845-9531-41dc-ae14-c10761614c78{ip: 86.14.91.167, host: localhost-86.14.91.167, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}79581dd1-2542-4aca-bbd2-e8a61b08b37c{ip: 236.14.180.234, host: localhost-236.14.180.234, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}, ReplicationConfig: RATIS/THREE, State:ALLOCATED, leaderId:, CreationTimestamp2022-02-21T12:57:08.467Z[Etc/UTC]] moved to OPEN state
2022-02-21 12:57:08,473 [Listener at 0.0.0.0/42801] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(183)) - Sending CreatePipelineCommand for pipeline:PipelineID=67a8a678-0508-4f75-9627-9bb6bac03a55 to datanode:f15a1757-4ec1-4a35-91ec-bf465a7eeeb8
2022-02-21 12:57:08,473 [Listener at 0.0.0.0/42801] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(183)) - Sending CreatePipelineCommand for pipeline:PipelineID=67a8a678-0508-4f75-9627-9bb6bac03a55 to datanode:e255192a-ec7e-45e8-8837-7ca96a81b4c7
2022-02-21 12:57:08,473 [Listener at 0.0.0.0/42801] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(183)) - Sending CreatePipelineCommand for pipeline:PipelineID=67a8a678-0508-4f75-9627-9bb6bac03a55 to datanode:7e8a2bf4-6d0b-422e-9979-3a4734fcd0cb
2022-02-21 12:57:08,475 [Listener at 0.0.0.0/42801] INFO  pipeline.PipelineStateManagerImpl (PipelineStateManagerImpl.java:addPipeline(101)) - Created pipeline Pipeline[ Id: 67a8a678-0508-4f75-9627-9bb6bac03a55, Nodes: f15a1757-4ec1-4a35-91ec-bf465a7eeeb8{ip: 166.139.73.168, host: localhost-166.139.73.168, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}e255192a-ec7e-45e8-8837-7ca96a81b4c7{ip: 255.146.163.202, host: localhost-255.146.163.202, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}7e8a2bf4-6d0b-422e-9979-3a4734fcd0cb{ip: 184.202.74.75, host: localhost-184.202.74.75, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}, ReplicationConfig: RATIS/THREE, State:ALLOCATED, leaderId:, CreationTimestamp2022-02-21T12:57:08.473Z[Etc/UTC]].
2022-02-21 12:57:08,479 [EventQueue-DatanodeCommandForDatanodeCommandHandler] INFO  pipeline.PipelineManagerImpl (PipelineManagerImpl.java:openPipeline(291)) - Pipeline Pipeline[ Id: 67a8a678-0508-4f75-9627-9bb6bac03a55, Nodes: f15a1757-4ec1-4a35-91ec-bf465a7eeeb8{ip: 166.139.73.168, host: localhost-166.139.73.168, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}e255192a-ec7e-45e8-8837-7ca96a81b4c7{ip: 255.146.163.202, host: localhost-255.146.163.202, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}7e8a2bf4-6d0b-422e-9979-3a4734fcd0cb{ip: 184.202.74.75, host: localhost-184.202.74.75, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}, ReplicationConfig: RATIS/THREE, State:ALLOCATED, leaderId:, CreationTimestamp2022-02-21T12:57:08.473Z[Etc/UTC]] moved to OPEN state
2022-02-21 12:57:08,491 [Listener at 0.0.0.0/42801] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:getNextId(127)) - Allocate a batch for containerId, change lastId from 0 to 1000.
2022-02-21 12:57:08,492 [Listener at 0.0.0.0/42801] WARN  ha.SequenceIdGenerator (SequenceIdGenerator.java:allocateBatch(235)) - Failed to allocate a batch for localId, expected lastId is 0, actual lastId is 109611004723200000.
2022-02-21 12:57:08,493 [Listener at 0.0.0.0/42801] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:getNextId(127)) - Allocate a batch for localId, change lastId from 109611004723200000 to 109611004723201000.
2022-02-21 12:57:08,494 [Listener at 0.0.0.0/42801] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1390)) - Stopping Container Balancer service.
2022-02-21 12:57:08,495 [Listener at 0.0.0.0/42801] INFO  balancer.ContainerBalancer (ContainerBalancer.java:stop(751)) - Container Balancer is not running.
2022-02-21 12:57:08,495 [Listener at 0.0.0.0/42801] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1397)) - Stopping Replication Manager Service.
2022-02-21 12:57:08,495 [Listener at 0.0.0.0/42801] INFO  container.ReplicationManager (ReplicationManager.java:stop(357)) - Stopping Replication Monitor Thread.
2022-02-21 12:57:08,496 [Listener at 0.0.0.0/42801] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1404)) - Stopping the Datanode Admin Monitor.
2022-02-21 12:57:08,496 [Listener at 0.0.0.0/42801] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1411)) - Stopping Lease Manager of the command watchers
2022-02-21 12:57:08,496 [Listener at 0.0.0.0/42801] ERROR server.StorageContainerManager (StorageContainerManager.java:stop(1414)) - Lease Manager of the command watchers stop failed
2022-02-21 12:57:08,497 [Listener at 0.0.0.0/42801] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1418)) - Stopping datanode service RPC server
2022-02-21 12:57:08,497 [Listener at 0.0.0.0/42801] INFO  server.SCMDatanodeProtocolServer (SCMDatanodeProtocolServer.java:stop(390)) - Stopping the RPC server for DataNodes
2022-02-21 12:57:08,497 [Listener at 0.0.0.0/42801] INFO  ipc.Server (Server.java:stop(3414)) - Stopping server on 42245
2022-02-21 12:57:08,497 [Listener at 0.0.0.0/42801] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1426)) - Stopping block service RPC server
2022-02-21 12:57:08,498 [Listener at 0.0.0.0/42801] INFO  server.SCMBlockProtocolServer (SCMBlockProtocolServer.java:stop(160)) - Stopping the RPC server for Block Protocol
2022-02-21 12:57:08,498 [Listener at 0.0.0.0/42801] INFO  ipc.Server (Server.java:stop(3414)) - Stopping server on 40459
2022-02-21 12:57:08,499 [Listener at 0.0.0.0/42801] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1433)) - Stopping the StorageContainerLocationProtocol RPC server
2022-02-21 12:57:08,499 [Listener at 0.0.0.0/42801] INFO  server.SCMClientProtocolServer (SCMClientProtocolServer.java:stop(174)) - Stopping the RPC server for Client Protocol
2022-02-21 12:57:08,499 [Listener at 0.0.0.0/42801] INFO  ipc.Server (Server.java:stop(3414)) - Stopping server on 42801
2022-02-21 12:57:08,499 [Listener at 0.0.0.0/42801] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1440)) - Stopping Storage Container Manager HTTP server.
2022-02-21 12:57:08,500 [Listener at 0.0.0.0/42801] ERROR server.StorageContainerManager (StorageContainerManager.java:stop(1443)) - Storage Container Manager HTTP server stop failed.
java.lang.NullPointerException
	at org.apache.hadoop.hdds.scm.server.StorageContainerManager.stop(StorageContainerManager.java:1441)
	at org.apache.hadoop.hdds.scm.block.TestBlockManager.cleanup(TestBlockManager.java:192)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.RunAfters.invokeMethod(RunAfters.java:46)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:33)
	at org.junit.rules.ExternalResource$1.evaluate(ExternalResource.java:54)
	at org.junit.rules.ExpectedException$ExpectedExceptionStatement.evaluate(ExpectedException.java:258)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115)
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Iterator.forEachRemaining(Iterator.java:116)
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485)
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82)
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:108)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:88)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.lambda$execute$0(EngineExecutionOrchestrator.java:54)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.withInterceptedStreams(EngineExecutionOrchestrator.java:67)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:52)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:96)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:75)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:142)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:113)
	at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:384)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:345)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:126)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:418)
2022-02-21 12:57:08,502 [Listener at 0.0.0.0/42801] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1451)) - Stopping Block Manager Service.
2022-02-21 12:57:08,502 [Listener at 0.0.0.0/42801] INFO  utils.BackgroundService (BackgroundService.java:shutdown(132)) - Shutting down service SCMBlockDeletingService
2022-02-21 12:57:08,502 [Listener at 0.0.0.0/42801] INFO  utils.BackgroundService (BackgroundService.java:shutdown(132)) - Shutting down service SCMBlockDeletingService
2022-02-21 12:57:08,503 [Listener at 0.0.0.0/42801] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1478)) - Stopping SCM Event Queue.
2022-02-21 12:57:08,503 [Listener at 0.0.0.0/42801] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1489)) - Stopping SCM HA services.
2022-02-21 12:57:08,503 [Listener at 0.0.0.0/42801] INFO  pipeline.BackgroundPipelineCreator (BackgroundPipelineCreator.java:stop(158)) - Stopping RatisPipelineUtilsThread.
2022-02-21 12:57:08,504 [Listener at 0.0.0.0/42801] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1499)) - Stopping SCM MetadataStore.
2022-02-21 12:57:08,533 [Listener at 0.0.0.0/42801] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchemaFromFile(129)) - Loading schema from [file:/home/runner/work/ozone/ozone/hadoop-hdds/common/target/classes/network-topology-default.xml]
2022-02-21 12:57:08,533 [Listener at 0.0.0.0/42801] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchema(176)) - Loading network topology layer schema file
2022-02-21 12:57:08,547 [Listener at 0.0.0.0/42801] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchemaFromFile(129)) - Loading schema from [file:/home/runner/work/ozone/ozone/hadoop-hdds/common/target/classes/network-topology-default.xml]
2022-02-21 12:57:08,547 [Listener at 0.0.0.0/42801] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchema(176)) - Loading network topology layer schema file
2022-02-21 12:57:08,549 [Listener at 0.0.0.0/42801] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/752c633f-d4a8-481d-90d0-36bd58f9a607
2022-02-21 12:57:08,549 [Listener at 0.0.0.0/42801] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/08e1e781-938f-4d5b-91c0-10f5d56294aa
2022-02-21 12:57:08,550 [Listener at 0.0.0.0/42801] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/b320c8ed-5e7e-4670-8888-d99ddbdef955
2022-02-21 12:57:08,550 [Listener at 0.0.0.0/42801] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/84c6d105-97c2-459c-b60c-2c7593ee62d6
2022-02-21 12:57:08,550 [Listener at 0.0.0.0/42801] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/254cb371-529c-41d6-8ea7-cb242b2eb533
2022-02-21 12:57:08,550 [Listener at 0.0.0.0/42801] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/47489174-adc5-4b78-af04-10aaffe00f04
2022-02-21 12:57:08,551 [Listener at 0.0.0.0/42801] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/a1240f9d-ec14-4ca6-8e29-2ea75c6538f1
2022-02-21 12:57:08,551 [Listener at 0.0.0.0/42801] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/eb61c561-c48b-403e-9cea-68e78ddc5fe0
2022-02-21 12:57:08,551 [Listener at 0.0.0.0/42801] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/98366b21-660a-4270-b098-06c9ca22c1c5
2022-02-21 12:57:08,551 [Listener at 0.0.0.0/42801] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/7b808338-049d-4b22-9059-71c64bf28940
2022-02-21 12:57:08,552 [Listener at 0.0.0.0/42801] WARN  utils.HAUtils (HAUtils.java:getMetaDir(342)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2022-02-21 12:57:08,553 [Listener at 0.0.0.0/42801] WARN  db.DBStoreBuilder (DBStoreBuilder.java:applyDBDefinition(145)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2022-02-21 12:57:08,655 [Listener at 0.0.0.0/42801] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:<init>(218)) - Init the HA SequenceIdGenerator.
2022-02-21 12:57:08,655 [Listener at 0.0.0.0/42801] INFO  pipeline.PipelineStateManagerImpl (PipelineStateManagerImpl.java:initialize(78)) - No pipeline exists in current db
2022-02-21 12:57:08,656 [Listener at 0.0.0.0/42801] INFO  algorithms.LeaderChoosePolicyFactory (LeaderChoosePolicyFactory.java:getPolicy(57)) - Create leader choose policy of type org.apache.hadoop.hdds.scm.pipeline.leader.choose.algorithms.MinLeaderCountChoosePolicy
2022-02-21 12:57:08,656 [Listener at 0.0.0.0/42801] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service BackgroundPipelineCreator.
2022-02-21 12:57:08,657 [Listener at 0.0.0.0/42801] INFO  pipeline.BackgroundPipelineCreator (BackgroundPipelineCreator.java:start(130)) - Starting RatisPipelineUtilsThread.
2022-02-21 12:57:08,657 [Listener at 0.0.0.0/42801] INFO  algorithms.LeaderChoosePolicyFactory (LeaderChoosePolicyFactory.java:getPolicy(57)) - Create leader choose policy of type org.apache.hadoop.hdds.scm.pipeline.leader.choose.algorithms.MinLeaderCountChoosePolicy
2022-02-21 12:57:08,658 [Listener at 0.0.0.0/42801] INFO  safemode.ContainerSafeModeRule (ContainerSafeModeRule.java:<init>(89)) - containers with one replica threshold count 0
2022-02-21 12:57:08,658 [Listener at 0.0.0.0/42801] INFO  safemode.HealthyPipelineSafeModeRule (HealthyPipelineSafeModeRule.java:initializeRule(156)) - Total pipeline count is 0, healthy pipeline threshold count is 0
2022-02-21 12:57:08,659 [Listener at 0.0.0.0/42801] INFO  safemode.OneReplicaPipelineSafeModeRule (OneReplicaPipelineSafeModeRule.java:initializeRule(180)) - Total pipeline count is 0, pipeline's with at least one datanode reported threshold count is 0
2022-02-21 12:57:08,659 [Listener at 0.0.0.0/42801] WARN  server.ServerUtils (ServerUtils.java:getScmDbDir(148)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2022-02-21 12:57:08,661 [Listener at 0.0.0.0/42801] INFO  ha.SCMHANodeDetails (SCMHANodeDetails.java:loadSCMHAConfig(157)) - ServiceID for StorageContainerManager is null
2022-02-21 12:57:08,661 [Listener at 0.0.0.0/42801] INFO  ha.SCMHANodeDetails (SCMHANodeDetails.java:loadSCMHAConfig(162)) - ozone.scm.default.service.id is not defined, falling back to ozone.scm.service.ids to find serviceID for StorageContainerManager if it is HA enabled cluster
2022-02-21 12:57:08,662 [Listener at 0.0.0.0/42801] WARN  server.ServerUtils (ServerUtils.java:getScmDbDir(148)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2022-02-21 12:57:08,662 [Listener at 0.0.0.0/42801] INFO  upgrade.AbstractLayoutVersionManager (AbstractLayoutVersionManager.java:init(79)) - Initializing Layout version manager with metadata layout = SCM_HA (version = 2), software layout = SCM_HA (version = 2)
2022-02-21 12:57:08,662 [Listener at 0.0.0.0/42801] WARN  util.MBeans (MBeans.java:getMBeanName(167)) - Error creating MBean object name: Hadoop:service=LayoutVersionManager,name=HDDSLayoutVersionManager
org.apache.hadoop.metrics2.MetricsException: org.apache.hadoop.metrics2.MetricsException: Hadoop:service=LayoutVersionManager,name=HDDSLayoutVersionManager already exists!
	at org.apache.hadoop.metrics2.lib.DefaultMetricsSystem.newObjectName(DefaultMetricsSystem.java:135)
	at org.apache.hadoop.metrics2.lib.DefaultMetricsSystem.newMBeanName(DefaultMetricsSystem.java:110)
	at org.apache.hadoop.metrics2.util.MBeans.getMBeanName(MBeans.java:165)
	at org.apache.hadoop.metrics2.util.MBeans.register(MBeans.java:97)
	at org.apache.hadoop.metrics2.util.MBeans.register(MBeans.java:73)
	at org.apache.hadoop.ozone.upgrade.AbstractLayoutVersionManager.init(AbstractLayoutVersionManager.java:84)
	at org.apache.hadoop.hdds.upgrade.HDDSLayoutVersionManager.<init>(HDDSLayoutVersionManager.java:50)
	at org.apache.hadoop.hdds.scm.server.StorageContainerManager.<init>(StorageContainerManager.java:326)
	at org.apache.hadoop.hdds.scm.server.StorageContainerManager.createSCM(StorageContainerManager.java:491)
	at org.apache.hadoop.hdds.scm.HddsTestUtils.getScm(HddsTestUtils.java:624)
	at org.apache.hadoop.hdds.scm.block.TestBlockManager.setUp(TestBlockManager.java:175)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.RunBefores.invokeMethod(RunBefores.java:33)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:24)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.rules.ExternalResource$1.evaluate(ExternalResource.java:54)
	at org.junit.rules.ExpectedException$ExpectedExceptionStatement.evaluate(ExpectedException.java:258)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115)
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Iterator.forEachRemaining(Iterator.java:116)
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485)
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82)
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:108)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:88)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.lambda$execute$0(EngineExecutionOrchestrator.java:54)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.withInterceptedStreams(EngineExecutionOrchestrator.java:67)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:52)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:96)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:75)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:142)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:113)
	at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:384)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:345)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:126)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:418)
Caused by: org.apache.hadoop.metrics2.MetricsException: Hadoop:service=LayoutVersionManager,name=HDDSLayoutVersionManager already exists!
	at org.apache.hadoop.metrics2.lib.DefaultMetricsSystem.newObjectName(DefaultMetricsSystem.java:131)
	... 62 more
2022-02-21 12:57:08,710 [Listener at 0.0.0.0/42801] INFO  reflections.Reflections (Reflections.java:scan(232)) - Reflections took 45 ms to scan 6 urls, producing 119 keys and 272 values 
2022-02-21 12:57:08,712 [Listener at 0.0.0.0/42801] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchemaFromFile(129)) - Loading schema from [file:/home/runner/work/ozone/ozone/hadoop-hdds/common/target/classes/network-topology-default.xml]
2022-02-21 12:57:08,712 [Listener at 0.0.0.0/42801] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchema(176)) - Loading network topology layer schema file
2022-02-21 12:57:08,715 [Listener at 0.0.0.0/42801] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:upgradeToSequenceId(347)) - upgrade localId to 109611004723200000
2022-02-21 12:57:08,715 [Listener at 0.0.0.0/42801] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:upgradeToSequenceId(357)) - upgrade delTxnId to 0
2022-02-21 12:57:08,715 [Listener at 0.0.0.0/42801] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:upgradeToSequenceId(371)) - upgrade containerId to 0
2022-02-21 12:57:08,716 [Listener at 0.0.0.0/42801] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:<init>(218)) - Init the HA SequenceIdGenerator.
2022-02-21 12:57:08,716 [Listener at 0.0.0.0/42801] INFO  algorithms.ContainerPlacementPolicyFactory (ContainerPlacementPolicyFactory.java:getPolicy(60)) - Create container placement policy of type org.apache.hadoop.hdds.scm.container.placement.algorithms.SCMContainerPlacementRandom
2022-02-21 12:57:08,716 [Listener at 0.0.0.0/42801] INFO  algorithms.PipelineChoosePolicyFactory (PipelineChoosePolicyFactory.java:createPipelineChoosePolicyFromClass(73)) - Create pipeline choose policy of type org.apache.hadoop.hdds.scm.pipeline.choose.algorithms.RandomPipelineChoosePolicy
2022-02-21 12:57:08,717 [Listener at 0.0.0.0/42801] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service SCMBlockDeletingService.
2022-02-21 12:57:08,717 [Listener at 0.0.0.0/42801] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service ReplicationManager.
2022-02-21 12:57:08,718 [Listener at 0.0.0.0/42801] INFO  container.ReplicationManager (ReplicationManager.java:start(326)) - Starting Replication Monitor Thread.
2022-02-21 12:57:08,722 [Listener at 0.0.0.0/42801] INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(90)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 10000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false.
2022-02-21 12:57:08,738 [ReplicationMonitor] INFO  container.ReplicationManager (ReplicationManager.java:processAll(374)) - Replication Manager is not ready to run until 300000ms after safemode exit
2022-02-21 12:57:08,742 [Listener at 0.0.0.0/44985] INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(90)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 10000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false.
2022-02-21 12:57:08,739 [Socket Reader #1 for port 0] INFO  ipc.Server (Server.java:run(1265)) - Starting Socket Reader #1 for port 0
2022-02-21 12:57:08,748 [Socket Reader #1 for port 0] INFO  ipc.Server (Server.java:run(1265)) - Starting Socket Reader #1 for port 0
2022-02-21 12:57:08,755 [Listener at 0.0.0.0/45955] INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(90)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 10000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false.
2022-02-21 12:57:08,755 [Socket Reader #1 for port 0] INFO  ipc.Server (Server.java:run(1265)) - Starting Socket Reader #1 for port 0
2022-02-21 12:57:08,782 [Listener at 0.0.0.0/34625] INFO  algorithms.ContainerPlacementPolicyFactory (ContainerPlacementPolicyFactory.java:getPolicy(60)) - Create container placement policy of type org.apache.hadoop.hdds.scm.container.placement.algorithms.SCMContainerPlacementRandom
2022-02-21 12:57:08,785 [Listener at 0.0.0.0/34625] INFO  server.StorageContainerManager (StorageContainerManager.java:<init>(388)) - 
Container Balancer status:
Key                            Value
Running                        false
Container Balancer Configuration values:
Key                                                Value
Threshold                                          10
Max Datanodes to Involve per Iteration(percent)    20
Max Size to Move per Iteration                     500GB
Max Size Entering Target per Iteration             26GB
Max Size Leaving Source per Iteration              26GB

2022-02-21 12:57:08,789 [Listener at 0.0.0.0/34625] INFO  ha.SCMContext (SCMContext.java:updateSafeModeStatus(211)) - Update SafeModeStatus from SafeModeStatus{safeModeStatus=false, preCheckPassed=true} to SafeModeStatus{safeModeStatus=false, preCheckPassed=true}.
2022-02-21 12:57:08,794 [Listener at 0.0.0.0/34625] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(183)) - Sending CreatePipelineCommand for pipeline:PipelineID=30c2120e-df42-4ea5-8dc4-2839d15f1aa0 to datanode:08e1e781-938f-4d5b-91c0-10f5d56294aa
2022-02-21 12:57:08,794 [Listener at 0.0.0.0/34625] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(183)) - Sending CreatePipelineCommand for pipeline:PipelineID=30c2120e-df42-4ea5-8dc4-2839d15f1aa0 to datanode:752c633f-d4a8-481d-90d0-36bd58f9a607
2022-02-21 12:57:08,795 [Listener at 0.0.0.0/34625] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(183)) - Sending CreatePipelineCommand for pipeline:PipelineID=30c2120e-df42-4ea5-8dc4-2839d15f1aa0 to datanode:eb61c561-c48b-403e-9cea-68e78ddc5fe0
2022-02-21 12:57:08,796 [Listener at 0.0.0.0/34625] INFO  pipeline.PipelineStateManagerImpl (PipelineStateManagerImpl.java:addPipeline(101)) - Created pipeline Pipeline[ Id: 30c2120e-df42-4ea5-8dc4-2839d15f1aa0, Nodes: 08e1e781-938f-4d5b-91c0-10f5d56294aa{ip: 49.133.102.204, host: localhost-49.133.102.204, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}752c633f-d4a8-481d-90d0-36bd58f9a607{ip: 2.204.8.198, host: localhost-2.204.8.198, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}eb61c561-c48b-403e-9cea-68e78ddc5fe0{ip: 174.203.72.86, host: localhost-174.203.72.86, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}, ReplicationConfig: RATIS/THREE, State:ALLOCATED, leaderId:, CreationTimestamp2022-02-21T12:57:08.794Z[Etc/UTC]].
2022-02-21 12:57:08,796 [Listener at 0.0.0.0/34625] INFO  pipeline.PipelineManagerImpl (PipelineManagerImpl.java:openPipeline(291)) - Pipeline Pipeline[ Id: 30c2120e-df42-4ea5-8dc4-2839d15f1aa0, Nodes: 08e1e781-938f-4d5b-91c0-10f5d56294aa{ip: 49.133.102.204, host: localhost-49.133.102.204, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}752c633f-d4a8-481d-90d0-36bd58f9a607{ip: 2.204.8.198, host: localhost-2.204.8.198, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}eb61c561-c48b-403e-9cea-68e78ddc5fe0{ip: 174.203.72.86, host: localhost-174.203.72.86, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}, ReplicationConfig: RATIS/THREE, State:ALLOCATED, leaderId:, CreationTimestamp2022-02-21T12:57:08.794Z[Etc/UTC]] moved to OPEN state
2022-02-21 12:57:08,802 [pool-58-thread-1] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:getNextId(127)) - Allocate a batch for containerId, change lastId from 0 to 1000.
2022-02-21 12:57:08,806 [pool-58-thread-1] WARN  ha.SequenceIdGenerator (SequenceIdGenerator.java:allocateBatch(235)) - Failed to allocate a batch for localId, expected lastId is 0, actual lastId is 109611004723200000.
2022-02-21 12:57:08,806 [pool-58-thread-1] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:getNextId(127)) - Allocate a batch for localId, change lastId from 109611004723200000 to 109611004723201000.
2022-02-21 12:57:08,809 [Listener at 0.0.0.0/34625] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1390)) - Stopping Container Balancer service.
2022-02-21 12:57:08,810 [Listener at 0.0.0.0/34625] INFO  balancer.ContainerBalancer (ContainerBalancer.java:stop(751)) - Container Balancer is not running.
2022-02-21 12:57:08,810 [Listener at 0.0.0.0/34625] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1397)) - Stopping Replication Manager Service.
2022-02-21 12:57:08,811 [Listener at 0.0.0.0/34625] INFO  container.ReplicationManager (ReplicationManager.java:stop(357)) - Stopping Replication Monitor Thread.
2022-02-21 12:57:08,811 [Listener at 0.0.0.0/34625] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1404)) - Stopping the Datanode Admin Monitor.
2022-02-21 12:57:08,811 [Listener at 0.0.0.0/34625] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1411)) - Stopping Lease Manager of the command watchers
2022-02-21 12:57:08,811 [Listener at 0.0.0.0/34625] ERROR server.StorageContainerManager (StorageContainerManager.java:stop(1414)) - Lease Manager of the command watchers stop failed
2022-02-21 12:57:08,811 [Listener at 0.0.0.0/34625] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1418)) - Stopping datanode service RPC server
2022-02-21 12:57:08,811 [Listener at 0.0.0.0/34625] INFO  server.SCMDatanodeProtocolServer (SCMDatanodeProtocolServer.java:stop(390)) - Stopping the RPC server for DataNodes
2022-02-21 12:57:08,811 [Listener at 0.0.0.0/34625] INFO  ipc.Server (Server.java:stop(3414)) - Stopping server on 44985
2022-02-21 12:57:08,812 [Listener at 0.0.0.0/34625] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1426)) - Stopping block service RPC server
2022-02-21 12:57:08,812 [Listener at 0.0.0.0/34625] INFO  server.SCMBlockProtocolServer (SCMBlockProtocolServer.java:stop(160)) - Stopping the RPC server for Block Protocol
2022-02-21 12:57:08,812 [Listener at 0.0.0.0/34625] INFO  ipc.Server (Server.java:stop(3414)) - Stopping server on 45955
2022-02-21 12:57:08,813 [Listener at 0.0.0.0/34625] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1433)) - Stopping the StorageContainerLocationProtocol RPC server
2022-02-21 12:57:08,813 [Listener at 0.0.0.0/34625] INFO  server.SCMClientProtocolServer (SCMClientProtocolServer.java:stop(174)) - Stopping the RPC server for Client Protocol
2022-02-21 12:57:08,813 [Listener at 0.0.0.0/34625] INFO  ipc.Server (Server.java:stop(3414)) - Stopping server on 34625
2022-02-21 12:57:08,814 [Listener at 0.0.0.0/34625] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1440)) - Stopping Storage Container Manager HTTP server.
2022-02-21 12:57:08,814 [Listener at 0.0.0.0/34625] ERROR server.StorageContainerManager (StorageContainerManager.java:stop(1443)) - Storage Container Manager HTTP server stop failed.
java.lang.NullPointerException
	at org.apache.hadoop.hdds.scm.server.StorageContainerManager.stop(StorageContainerManager.java:1441)
	at org.apache.hadoop.hdds.scm.block.TestBlockManager.cleanup(TestBlockManager.java:192)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.RunAfters.invokeMethod(RunAfters.java:46)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:33)
	at org.junit.rules.ExternalResource$1.evaluate(ExternalResource.java:54)
	at org.junit.rules.ExpectedException$ExpectedExceptionStatement.evaluate(ExpectedException.java:258)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115)
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Iterator.forEachRemaining(Iterator.java:116)
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485)
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82)
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:108)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:88)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.lambda$execute$0(EngineExecutionOrchestrator.java:54)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.withInterceptedStreams(EngineExecutionOrchestrator.java:67)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:52)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:96)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:75)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:142)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:113)
	at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:384)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:345)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:126)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:418)
2022-02-21 12:57:08,814 [Listener at 0.0.0.0/34625] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1451)) - Stopping Block Manager Service.
2022-02-21 12:57:08,815 [Listener at 0.0.0.0/34625] INFO  utils.BackgroundService (BackgroundService.java:shutdown(132)) - Shutting down service SCMBlockDeletingService
2022-02-21 12:57:08,815 [Listener at 0.0.0.0/34625] INFO  utils.BackgroundService (BackgroundService.java:shutdown(132)) - Shutting down service SCMBlockDeletingService
2022-02-21 12:57:08,815 [Listener at 0.0.0.0/34625] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1478)) - Stopping SCM Event Queue.
2022-02-21 12:57:08,816 [Listener at 0.0.0.0/34625] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1489)) - Stopping SCM HA services.
2022-02-21 12:57:08,816 [Listener at 0.0.0.0/34625] INFO  pipeline.BackgroundPipelineCreator (BackgroundPipelineCreator.java:stop(158)) - Stopping RatisPipelineUtilsThread.
2022-02-21 12:57:08,816 [Listener at 0.0.0.0/34625] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1499)) - Stopping SCM MetadataStore.
2022-02-21 12:57:08,843 [Listener at 0.0.0.0/34625] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchemaFromFile(129)) - Loading schema from [file:/home/runner/work/ozone/ozone/hadoop-hdds/common/target/classes/network-topology-default.xml]
2022-02-21 12:57:08,844 [Listener at 0.0.0.0/34625] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchema(176)) - Loading network topology layer schema file
2022-02-21 12:57:08,862 [Listener at 0.0.0.0/34625] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchemaFromFile(129)) - Loading schema from [file:/home/runner/work/ozone/ozone/hadoop-hdds/common/target/classes/network-topology-default.xml]
2022-02-21 12:57:08,873 [Listener at 0.0.0.0/34625] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchema(176)) - Loading network topology layer schema file
2022-02-21 12:57:08,875 [Listener at 0.0.0.0/34625] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/2ecc4222-52c1-4663-803a-1d21660e7073
2022-02-21 12:57:08,875 [Listener at 0.0.0.0/34625] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/b2e36fa8-01ef-4cb3-b93f-142a613277d6
2022-02-21 12:57:08,875 [Listener at 0.0.0.0/34625] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/da85d3b1-fdd6-4c79-b7c2-3a601dc1a8e6
2022-02-21 12:57:08,876 [Listener at 0.0.0.0/34625] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/1de66e33-d5ba-4fef-a22b-15ca3bfbfe3f
2022-02-21 12:57:08,876 [Listener at 0.0.0.0/34625] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/e5fb1bdb-734a-4e1a-a839-9d8a9bcbc8cd
2022-02-21 12:57:08,876 [Listener at 0.0.0.0/34625] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/d03402f6-d8b7-42df-ab36-2aafdd13cccc
2022-02-21 12:57:08,876 [Listener at 0.0.0.0/34625] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/489f24f1-95e5-48e6-aa19-ec47a921a5fb
2022-02-21 12:57:08,877 [Listener at 0.0.0.0/34625] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/da948be3-d58b-4f6b-8636-67b7a0653f44
2022-02-21 12:57:08,877 [Listener at 0.0.0.0/34625] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/c6b99d38-a4ed-4d75-b750-96c0baed090a
2022-02-21 12:57:08,877 [Listener at 0.0.0.0/34625] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/491a755b-218b-409f-ac1a-a4ab29a22996
2022-02-21 12:57:08,877 [Listener at 0.0.0.0/34625] WARN  utils.HAUtils (HAUtils.java:getMetaDir(342)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2022-02-21 12:57:08,878 [Listener at 0.0.0.0/34625] WARN  db.DBStoreBuilder (DBStoreBuilder.java:applyDBDefinition(145)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2022-02-21 12:57:08,982 [Listener at 0.0.0.0/34625] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:<init>(218)) - Init the HA SequenceIdGenerator.
2022-02-21 12:57:08,982 [Listener at 0.0.0.0/34625] INFO  pipeline.PipelineStateManagerImpl (PipelineStateManagerImpl.java:initialize(78)) - No pipeline exists in current db
2022-02-21 12:57:08,983 [Listener at 0.0.0.0/34625] INFO  algorithms.LeaderChoosePolicyFactory (LeaderChoosePolicyFactory.java:getPolicy(57)) - Create leader choose policy of type org.apache.hadoop.hdds.scm.pipeline.leader.choose.algorithms.MinLeaderCountChoosePolicy
2022-02-21 12:57:08,985 [Listener at 0.0.0.0/34625] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service BackgroundPipelineCreator.
2022-02-21 12:57:08,985 [Listener at 0.0.0.0/34625] INFO  pipeline.BackgroundPipelineCreator (BackgroundPipelineCreator.java:start(130)) - Starting RatisPipelineUtilsThread.
2022-02-21 12:57:08,986 [Listener at 0.0.0.0/34625] INFO  algorithms.LeaderChoosePolicyFactory (LeaderChoosePolicyFactory.java:getPolicy(57)) - Create leader choose policy of type org.apache.hadoop.hdds.scm.pipeline.leader.choose.algorithms.MinLeaderCountChoosePolicy
2022-02-21 12:57:08,987 [Listener at 0.0.0.0/34625] INFO  safemode.ContainerSafeModeRule (ContainerSafeModeRule.java:<init>(89)) - containers with one replica threshold count 0
2022-02-21 12:57:08,987 [Listener at 0.0.0.0/34625] INFO  safemode.HealthyPipelineSafeModeRule (HealthyPipelineSafeModeRule.java:initializeRule(156)) - Total pipeline count is 0, healthy pipeline threshold count is 0
2022-02-21 12:57:08,988 [Listener at 0.0.0.0/34625] INFO  safemode.OneReplicaPipelineSafeModeRule (OneReplicaPipelineSafeModeRule.java:initializeRule(180)) - Total pipeline count is 0, pipeline's with at least one datanode reported threshold count is 0
2022-02-21 12:57:08,988 [Listener at 0.0.0.0/34625] WARN  server.ServerUtils (ServerUtils.java:getScmDbDir(148)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2022-02-21 12:57:08,990 [Listener at 0.0.0.0/34625] INFO  ha.SCMHANodeDetails (SCMHANodeDetails.java:loadSCMHAConfig(157)) - ServiceID for StorageContainerManager is null
2022-02-21 12:57:08,990 [Listener at 0.0.0.0/34625] INFO  ha.SCMHANodeDetails (SCMHANodeDetails.java:loadSCMHAConfig(162)) - ozone.scm.default.service.id is not defined, falling back to ozone.scm.service.ids to find serviceID for StorageContainerManager if it is HA enabled cluster
2022-02-21 12:57:08,991 [Listener at 0.0.0.0/34625] WARN  server.ServerUtils (ServerUtils.java:getScmDbDir(148)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2022-02-21 12:57:08,991 [Listener at 0.0.0.0/34625] INFO  upgrade.AbstractLayoutVersionManager (AbstractLayoutVersionManager.java:init(79)) - Initializing Layout version manager with metadata layout = SCM_HA (version = 2), software layout = SCM_HA (version = 2)
2022-02-21 12:57:08,991 [Listener at 0.0.0.0/34625] WARN  util.MBeans (MBeans.java:getMBeanName(167)) - Error creating MBean object name: Hadoop:service=LayoutVersionManager,name=HDDSLayoutVersionManager
org.apache.hadoop.metrics2.MetricsException: org.apache.hadoop.metrics2.MetricsException: Hadoop:service=LayoutVersionManager,name=HDDSLayoutVersionManager already exists!
	at org.apache.hadoop.metrics2.lib.DefaultMetricsSystem.newObjectName(DefaultMetricsSystem.java:135)
	at org.apache.hadoop.metrics2.lib.DefaultMetricsSystem.newMBeanName(DefaultMetricsSystem.java:110)
	at org.apache.hadoop.metrics2.util.MBeans.getMBeanName(MBeans.java:165)
	at org.apache.hadoop.metrics2.util.MBeans.register(MBeans.java:97)
	at org.apache.hadoop.metrics2.util.MBeans.register(MBeans.java:73)
	at org.apache.hadoop.ozone.upgrade.AbstractLayoutVersionManager.init(AbstractLayoutVersionManager.java:84)
	at org.apache.hadoop.hdds.upgrade.HDDSLayoutVersionManager.<init>(HDDSLayoutVersionManager.java:50)
	at org.apache.hadoop.hdds.scm.server.StorageContainerManager.<init>(StorageContainerManager.java:326)
	at org.apache.hadoop.hdds.scm.server.StorageContainerManager.createSCM(StorageContainerManager.java:491)
	at org.apache.hadoop.hdds.scm.HddsTestUtils.getScm(HddsTestUtils.java:624)
	at org.apache.hadoop.hdds.scm.block.TestBlockManager.setUp(TestBlockManager.java:175)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.RunBefores.invokeMethod(RunBefores.java:33)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:24)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.rules.ExternalResource$1.evaluate(ExternalResource.java:54)
	at org.junit.rules.ExpectedException$ExpectedExceptionStatement.evaluate(ExpectedException.java:258)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115)
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Iterator.forEachRemaining(Iterator.java:116)
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485)
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82)
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:108)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:88)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.lambda$execute$0(EngineExecutionOrchestrator.java:54)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.withInterceptedStreams(EngineExecutionOrchestrator.java:67)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:52)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:96)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:75)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:142)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:113)
	at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:384)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:345)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:126)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:418)
Caused by: org.apache.hadoop.metrics2.MetricsException: Hadoop:service=LayoutVersionManager,name=HDDSLayoutVersionManager already exists!
	at org.apache.hadoop.metrics2.lib.DefaultMetricsSystem.newObjectName(DefaultMetricsSystem.java:131)
	... 62 more
2022-02-21 12:57:09,032 [Listener at 0.0.0.0/34625] INFO  reflections.Reflections (Reflections.java:scan(232)) - Reflections took 39 ms to scan 6 urls, producing 119 keys and 272 values 
2022-02-21 12:57:09,035 [Listener at 0.0.0.0/34625] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchemaFromFile(129)) - Loading schema from [file:/home/runner/work/ozone/ozone/hadoop-hdds/common/target/classes/network-topology-default.xml]
2022-02-21 12:57:09,035 [Listener at 0.0.0.0/34625] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchema(176)) - Loading network topology layer schema file
2022-02-21 12:57:09,037 [Listener at 0.0.0.0/34625] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:upgradeToSequenceId(347)) - upgrade localId to 109611004723200000
2022-02-21 12:57:09,037 [Listener at 0.0.0.0/34625] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:upgradeToSequenceId(357)) - upgrade delTxnId to 0
2022-02-21 12:57:09,037 [Listener at 0.0.0.0/34625] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:upgradeToSequenceId(371)) - upgrade containerId to 0
2022-02-21 12:57:09,038 [Listener at 0.0.0.0/34625] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:<init>(218)) - Init the HA SequenceIdGenerator.
2022-02-21 12:57:09,038 [Listener at 0.0.0.0/34625] INFO  algorithms.ContainerPlacementPolicyFactory (ContainerPlacementPolicyFactory.java:getPolicy(60)) - Create container placement policy of type org.apache.hadoop.hdds.scm.container.placement.algorithms.SCMContainerPlacementRandom
2022-02-21 12:57:09,038 [Listener at 0.0.0.0/34625] INFO  algorithms.PipelineChoosePolicyFactory (PipelineChoosePolicyFactory.java:createPipelineChoosePolicyFromClass(73)) - Create pipeline choose policy of type org.apache.hadoop.hdds.scm.pipeline.choose.algorithms.RandomPipelineChoosePolicy
2022-02-21 12:57:09,039 [Listener at 0.0.0.0/34625] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service SCMBlockDeletingService.
2022-02-21 12:57:09,039 [Listener at 0.0.0.0/34625] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service ReplicationManager.
2022-02-21 12:57:09,040 [Listener at 0.0.0.0/34625] INFO  container.ReplicationManager (ReplicationManager.java:start(326)) - Starting Replication Monitor Thread.
2022-02-21 12:57:09,041 [ReplicationMonitor] INFO  container.ReplicationManager (ReplicationManager.java:processAll(374)) - Replication Manager is not ready to run until 300000ms after safemode exit
2022-02-21 12:57:09,041 [Listener at 0.0.0.0/34625] INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(90)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 10000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false.
2022-02-21 12:57:09,042 [Socket Reader #1 for port 0] INFO  ipc.Server (Server.java:run(1265)) - Starting Socket Reader #1 for port 0
2022-02-21 12:57:09,047 [Listener at 0.0.0.0/45701] INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(90)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 10000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false.
2022-02-21 12:57:09,047 [Socket Reader #1 for port 0] INFO  ipc.Server (Server.java:run(1265)) - Starting Socket Reader #1 for port 0
2022-02-21 12:57:09,053 [Listener at 0.0.0.0/35337] INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(90)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 10000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false.
2022-02-21 12:57:09,053 [Socket Reader #1 for port 0] INFO  ipc.Server (Server.java:run(1265)) - Starting Socket Reader #1 for port 0
2022-02-21 12:57:09,073 [Listener at 0.0.0.0/45283] INFO  algorithms.ContainerPlacementPolicyFactory (ContainerPlacementPolicyFactory.java:getPolicy(60)) - Create container placement policy of type org.apache.hadoop.hdds.scm.container.placement.algorithms.SCMContainerPlacementRandom
2022-02-21 12:57:09,074 [Listener at 0.0.0.0/45283] INFO  server.StorageContainerManager (StorageContainerManager.java:<init>(388)) - 
Container Balancer status:
Key                            Value
Running                        false
Container Balancer Configuration values:
Key                                                Value
Threshold                                          10
Max Datanodes to Involve per Iteration(percent)    20
Max Size to Move per Iteration                     500GB
Max Size Entering Target per Iteration             26GB
Max Size Leaving Source per Iteration              26GB

2022-02-21 12:57:09,077 [Listener at 0.0.0.0/45283] INFO  ha.SCMContext (SCMContext.java:updateSafeModeStatus(211)) - Update SafeModeStatus from SafeModeStatus{safeModeStatus=false, preCheckPassed=true} to SafeModeStatus{safeModeStatus=false, preCheckPassed=true}.
2022-02-21 12:57:09,082 [pool-81-thread-1] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(183)) - Sending CreatePipelineCommand for pipeline:PipelineID=8d2a6b02-c9a9-4b40-8cde-6e0caa5c741c to datanode:da85d3b1-fdd6-4c79-b7c2-3a601dc1a8e6
2022-02-21 12:57:09,094 [pool-81-thread-1] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(183)) - Sending CreatePipelineCommand for pipeline:PipelineID=8d2a6b02-c9a9-4b40-8cde-6e0caa5c741c to datanode:d03402f6-d8b7-42df-ab36-2aafdd13cccc
2022-02-21 12:57:09,094 [pool-81-thread-1] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(183)) - Sending CreatePipelineCommand for pipeline:PipelineID=8d2a6b02-c9a9-4b40-8cde-6e0caa5c741c to datanode:da948be3-d58b-4f6b-8636-67b7a0653f44
2022-02-21 12:57:09,095 [pool-81-thread-1] INFO  pipeline.PipelineStateManagerImpl (PipelineStateManagerImpl.java:addPipeline(101)) - Created pipeline Pipeline[ Id: 8d2a6b02-c9a9-4b40-8cde-6e0caa5c741c, Nodes: da85d3b1-fdd6-4c79-b7c2-3a601dc1a8e6{ip: 30.46.225.93, host: localhost-30.46.225.93, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}d03402f6-d8b7-42df-ab36-2aafdd13cccc{ip: 146.124.179.78, host: localhost-146.124.179.78, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}da948be3-d58b-4f6b-8636-67b7a0653f44{ip: 166.135.250.108, host: localhost-166.135.250.108, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}, ReplicationConfig: RATIS/THREE, State:ALLOCATED, leaderId:, CreationTimestamp2022-02-21T12:57:09.082Z[Etc/UTC]].
2022-02-21 12:57:09,097 [pool-82-thread-1] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(183)) - Sending CreatePipelineCommand for pipeline:PipelineID=c1184f00-3ae5-4507-b34e-0e5e7d040343 to datanode:d03402f6-d8b7-42df-ab36-2aafdd13cccc
2022-02-21 12:57:09,097 [pool-82-thread-1] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(183)) - Sending CreatePipelineCommand for pipeline:PipelineID=c1184f00-3ae5-4507-b34e-0e5e7d040343 to datanode:da85d3b1-fdd6-4c79-b7c2-3a601dc1a8e6
2022-02-21 12:57:09,098 [pool-82-thread-1] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(183)) - Sending CreatePipelineCommand for pipeline:PipelineID=c1184f00-3ae5-4507-b34e-0e5e7d040343 to datanode:da948be3-d58b-4f6b-8636-67b7a0653f44
2022-02-21 12:57:09,098 [pool-82-thread-1] INFO  pipeline.PipelineStateManagerImpl (PipelineStateManagerImpl.java:addPipeline(101)) - Created pipeline Pipeline[ Id: c1184f00-3ae5-4507-b34e-0e5e7d040343, Nodes: d03402f6-d8b7-42df-ab36-2aafdd13cccc{ip: 146.124.179.78, host: localhost-146.124.179.78, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}da85d3b1-fdd6-4c79-b7c2-3a601dc1a8e6{ip: 30.46.225.93, host: localhost-30.46.225.93, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}da948be3-d58b-4f6b-8636-67b7a0653f44{ip: 166.135.250.108, host: localhost-166.135.250.108, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}, ReplicationConfig: RATIS/THREE, State:ALLOCATED, leaderId:, CreationTimestamp2022-02-21T12:57:09.097Z[Etc/UTC]].
2022-02-21 12:57:09,099 [pool-82-thread-1] INFO  pipeline.PipelineManagerImpl (PipelineManagerImpl.java:recordMetricsForPipeline(639)) - Pipeline: PipelineID=c1184f00-3ae5-4507-b34e-0e5e7d040343 contains same datanodes as previous pipelines: PipelineID=8d2a6b02-c9a9-4b40-8cde-6e0caa5c741c nodeIds: d03402f6-d8b7-42df-ab36-2aafdd13cccc, da85d3b1-fdd6-4c79-b7c2-3a601dc1a8e6, da948be3-d58b-4f6b-8636-67b7a0653f44
2022-02-21 12:57:09,100 [pool-83-thread-1] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(183)) - Sending CreatePipelineCommand for pipeline:PipelineID=6cec8553-729f-4130-b600-2d227dade5f1 to datanode:489f24f1-95e5-48e6-aa19-ec47a921a5fb
2022-02-21 12:57:09,100 [pool-83-thread-1] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(183)) - Sending CreatePipelineCommand for pipeline:PipelineID=6cec8553-729f-4130-b600-2d227dade5f1 to datanode:2ecc4222-52c1-4663-803a-1d21660e7073
2022-02-21 12:57:09,100 [pool-83-thread-1] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(183)) - Sending CreatePipelineCommand for pipeline:PipelineID=6cec8553-729f-4130-b600-2d227dade5f1 to datanode:1de66e33-d5ba-4fef-a22b-15ca3bfbfe3f
2022-02-21 12:57:09,101 [pool-83-thread-1] INFO  pipeline.PipelineStateManagerImpl (PipelineStateManagerImpl.java:addPipeline(101)) - Created pipeline Pipeline[ Id: 6cec8553-729f-4130-b600-2d227dade5f1, Nodes: 489f24f1-95e5-48e6-aa19-ec47a921a5fb{ip: 78.54.203.207, host: localhost-78.54.203.207, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}2ecc4222-52c1-4663-803a-1d21660e7073{ip: 11.226.124.236, host: localhost-11.226.124.236, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}1de66e33-d5ba-4fef-a22b-15ca3bfbfe3f{ip: 32.77.149.232, host: localhost-32.77.149.232, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}, ReplicationConfig: RATIS/THREE, State:ALLOCATED, leaderId:, CreationTimestamp2022-02-21T12:57:09.100Z[Etc/UTC]].
2022-02-21 12:57:09,102 [pool-84-thread-1] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(183)) - Sending CreatePipelineCommand for pipeline:PipelineID=690b872c-8156-4ae2-b832-2e23f6332db5 to datanode:489f24f1-95e5-48e6-aa19-ec47a921a5fb
2022-02-21 12:57:09,102 [pool-84-thread-1] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(183)) - Sending CreatePipelineCommand for pipeline:PipelineID=690b872c-8156-4ae2-b832-2e23f6332db5 to datanode:1de66e33-d5ba-4fef-a22b-15ca3bfbfe3f
2022-02-21 12:57:09,102 [pool-84-thread-1] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(183)) - Sending CreatePipelineCommand for pipeline:PipelineID=690b872c-8156-4ae2-b832-2e23f6332db5 to datanode:b2e36fa8-01ef-4cb3-b93f-142a613277d6
2022-02-21 12:57:09,103 [pool-84-thread-1] INFO  pipeline.PipelineStateManagerImpl (PipelineStateManagerImpl.java:addPipeline(101)) - Created pipeline Pipeline[ Id: 690b872c-8156-4ae2-b832-2e23f6332db5, Nodes: 489f24f1-95e5-48e6-aa19-ec47a921a5fb{ip: 78.54.203.207, host: localhost-78.54.203.207, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}1de66e33-d5ba-4fef-a22b-15ca3bfbfe3f{ip: 32.77.149.232, host: localhost-32.77.149.232, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}b2e36fa8-01ef-4cb3-b93f-142a613277d6{ip: 213.114.87.147, host: localhost-213.114.87.147, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}, ReplicationConfig: RATIS/THREE, State:ALLOCATED, leaderId:, CreationTimestamp2022-02-21T12:57:09.102Z[Etc/UTC]].
2022-02-21 12:57:09,104 [pool-85-thread-1] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(183)) - Sending CreatePipelineCommand for pipeline:PipelineID=53f8bbf1-aa38-480a-a371-fe75fd50e6f6 to datanode:b2e36fa8-01ef-4cb3-b93f-142a613277d6
2022-02-21 12:57:09,104 [pool-85-thread-1] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(183)) - Sending CreatePipelineCommand for pipeline:PipelineID=53f8bbf1-aa38-480a-a371-fe75fd50e6f6 to datanode:e5fb1bdb-734a-4e1a-a839-9d8a9bcbc8cd
2022-02-21 12:57:09,104 [pool-85-thread-1] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(183)) - Sending CreatePipelineCommand for pipeline:PipelineID=53f8bbf1-aa38-480a-a371-fe75fd50e6f6 to datanode:2ecc4222-52c1-4663-803a-1d21660e7073
2022-02-21 12:57:09,105 [pool-85-thread-1] INFO  pipeline.PipelineStateManagerImpl (PipelineStateManagerImpl.java:addPipeline(101)) - Created pipeline Pipeline[ Id: 53f8bbf1-aa38-480a-a371-fe75fd50e6f6, Nodes: b2e36fa8-01ef-4cb3-b93f-142a613277d6{ip: 213.114.87.147, host: localhost-213.114.87.147, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}e5fb1bdb-734a-4e1a-a839-9d8a9bcbc8cd{ip: 3.56.8.27, host: localhost-3.56.8.27, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}2ecc4222-52c1-4663-803a-1d21660e7073{ip: 11.226.124.236, host: localhost-11.226.124.236, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}, ReplicationConfig: RATIS/THREE, State:ALLOCATED, leaderId:, CreationTimestamp2022-02-21T12:57:09.104Z[Etc/UTC]].
2022-02-21 12:57:09,106 [pool-86-thread-1] WARN  pipeline.WritableRatisContainerProvider (WritableRatisContainerProvider.java:getContainer(125)) - Pipeline creation failed for repConfig RATIS/THREE Datanodes may be used up.
org.apache.hadoop.hdds.scm.exceptions.SCMException: Pipeline creation failed because nodes are engaged in other pipelines and every node can only be engaged in max 2 pipelines. Required 3. Found 1
	at org.apache.hadoop.hdds.scm.pipeline.PipelinePlacementPolicy.filterViableNodes(PipelinePlacementPolicy.java:184)
	at org.apache.hadoop.hdds.scm.pipeline.PipelinePlacementPolicy.chooseDatanodes(PipelinePlacementPolicy.java:237)
	at org.apache.hadoop.hdds.scm.pipeline.RatisPipelineProvider.create(RatisPipelineProvider.java:153)
	at org.apache.hadoop.hdds.scm.pipeline.MockRatisPipelineProvider.create(MockRatisPipelineProvider.java:72)
	at org.apache.hadoop.hdds.scm.pipeline.MockRatisPipelineProvider.create(MockRatisPipelineProvider.java:36)
	at org.apache.hadoop.hdds.scm.pipeline.PipelineFactory.create(PipelineFactory.java:72)
	at org.apache.hadoop.hdds.scm.pipeline.PipelineManagerImpl.createPipeline(PipelineManagerImpl.java:170)
	at org.apache.hadoop.hdds.scm.pipeline.WritableRatisContainerProvider.getContainer(WritableRatisContainerProvider.java:119)
	at org.apache.hadoop.hdds.scm.pipeline.WritableContainerFactory.getContainer(WritableContainerFactory.java:52)
	at org.apache.hadoop.hdds.scm.block.BlockManagerImpl.allocateBlock(BlockManagerImpl.java:176)
	at org.apache.hadoop.hdds.scm.block.TestBlockManager.lambda$testAllocateBlockInParallel$0(TestBlockManager.java:254)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2022-02-21 12:57:09,108 [pool-86-thread-1] ERROR pipeline.WritableRatisContainerProvider (WritableRatisContainerProvider.java:getContainer(164)) - Unable to allocate a block for the size: 134217728, repConfig: RATIS/THREE
2022-02-21 12:57:09,108 [pool-86-thread-1] ERROR block.BlockManagerImpl (BlockManagerImpl.java:allocateBlock(184)) - Unable to allocate a block for the size: 134217728, replicationConfig: RATIS/THREE
2022-02-21 12:57:09,108 [pool-88-thread-1] WARN  pipeline.WritableRatisContainerProvider (WritableRatisContainerProvider.java:getContainer(125)) - Pipeline creation failed for repConfig RATIS/THREE Datanodes may be used up.
org.apache.hadoop.hdds.scm.exceptions.SCMException: Pipeline creation failed because nodes are engaged in other pipelines and every node can only be engaged in max 2 pipelines. Required 3. Found 1
	at org.apache.hadoop.hdds.scm.pipeline.PipelinePlacementPolicy.filterViableNodes(PipelinePlacementPolicy.java:184)
	at org.apache.hadoop.hdds.scm.pipeline.PipelinePlacementPolicy.chooseDatanodes(PipelinePlacementPolicy.java:237)
	at org.apache.hadoop.hdds.scm.pipeline.RatisPipelineProvider.create(RatisPipelineProvider.java:153)
	at org.apache.hadoop.hdds.scm.pipeline.MockRatisPipelineProvider.create(MockRatisPipelineProvider.java:72)
	at org.apache.hadoop.hdds.scm.pipeline.MockRatisPipelineProvider.create(MockRatisPipelineProvider.java:36)
	at org.apache.hadoop.hdds.scm.pipeline.PipelineFactory.create(PipelineFactory.java:72)
	at org.apache.hadoop.hdds.scm.pipeline.PipelineManagerImpl.createPipeline(PipelineManagerImpl.java:170)
	at org.apache.hadoop.hdds.scm.pipeline.WritableRatisContainerProvider.getContainer(WritableRatisContainerProvider.java:119)
	at org.apache.hadoop.hdds.scm.pipeline.WritableContainerFactory.getContainer(WritableContainerFactory.java:52)
	at org.apache.hadoop.hdds.scm.block.BlockManagerImpl.allocateBlock(BlockManagerImpl.java:176)
	at org.apache.hadoop.hdds.scm.block.TestBlockManager.lambda$testAllocateBlockInParallel$0(TestBlockManager.java:254)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2022-02-21 12:57:09,117 [pool-88-thread-1] ERROR pipeline.WritableRatisContainerProvider (WritableRatisContainerProvider.java:getContainer(164)) - Unable to allocate a block for the size: 134217728, repConfig: RATIS/THREE
2022-02-21 12:57:09,117 [pool-88-thread-1] ERROR block.BlockManagerImpl (BlockManagerImpl.java:allocateBlock(184)) - Unable to allocate a block for the size: 134217728, replicationConfig: RATIS/THREE
2022-02-21 12:57:09,107 [pool-87-thread-1] WARN  pipeline.WritableRatisContainerProvider (WritableRatisContainerProvider.java:getContainer(125)) - Pipeline creation failed for repConfig RATIS/THREE Datanodes may be used up.
org.apache.hadoop.hdds.scm.exceptions.SCMException: Pipeline creation failed because nodes are engaged in other pipelines and every node can only be engaged in max 2 pipelines. Required 3. Found 1
	at org.apache.hadoop.hdds.scm.pipeline.PipelinePlacementPolicy.filterViableNodes(PipelinePlacementPolicy.java:184)
	at org.apache.hadoop.hdds.scm.pipeline.PipelinePlacementPolicy.chooseDatanodes(PipelinePlacementPolicy.java:237)
	at org.apache.hadoop.hdds.scm.pipeline.RatisPipelineProvider.create(RatisPipelineProvider.java:153)
	at org.apache.hadoop.hdds.scm.pipeline.MockRatisPipelineProvider.create(MockRatisPipelineProvider.java:72)
	at org.apache.hadoop.hdds.scm.pipeline.MockRatisPipelineProvider.create(MockRatisPipelineProvider.java:36)
	at org.apache.hadoop.hdds.scm.pipeline.PipelineFactory.create(PipelineFactory.java:72)
	at org.apache.hadoop.hdds.scm.pipeline.PipelineManagerImpl.createPipeline(PipelineManagerImpl.java:170)
	at org.apache.hadoop.hdds.scm.pipeline.WritableRatisContainerProvider.getContainer(WritableRatisContainerProvider.java:119)
	at org.apache.hadoop.hdds.scm.pipeline.WritableContainerFactory.getContainer(WritableContainerFactory.java:52)
	at org.apache.hadoop.hdds.scm.block.BlockManagerImpl.allocateBlock(BlockManagerImpl.java:176)
	at org.apache.hadoop.hdds.scm.block.TestBlockManager.lambda$testAllocateBlockInParallel$0(TestBlockManager.java:254)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2022-02-21 12:57:09,117 [pool-87-thread-1] ERROR pipeline.WritableRatisContainerProvider (WritableRatisContainerProvider.java:getContainer(164)) - Unable to allocate a block for the size: 134217728, repConfig: RATIS/THREE
2022-02-21 12:57:09,118 [pool-87-thread-1] ERROR block.BlockManagerImpl (BlockManagerImpl.java:allocateBlock(184)) - Unable to allocate a block for the size: 134217728, replicationConfig: RATIS/THREE
2022-02-21 12:57:09,117 [pool-98-thread-1] WARN  pipeline.WritableRatisContainerProvider (WritableRatisContainerProvider.java:getContainer(125)) - Pipeline creation failed for repConfig RATIS/THREE Datanodes may be used up.
org.apache.hadoop.hdds.scm.exceptions.SCMException: Pipeline creation failed because nodes are engaged in other pipelines and every node can only be engaged in max 2 pipelines. Required 3. Found 1
	at org.apache.hadoop.hdds.scm.pipeline.PipelinePlacementPolicy.filterViableNodes(PipelinePlacementPolicy.java:184)
	at org.apache.hadoop.hdds.scm.pipeline.PipelinePlacementPolicy.chooseDatanodes(PipelinePlacementPolicy.java:237)
	at org.apache.hadoop.hdds.scm.pipeline.RatisPipelineProvider.create(RatisPipelineProvider.java:153)
	at org.apache.hadoop.hdds.scm.pipeline.MockRatisPipelineProvider.create(MockRatisPipelineProvider.java:72)
	at org.apache.hadoop.hdds.scm.pipeline.MockRatisPipelineProvider.create(MockRatisPipelineProvider.java:36)
	at org.apache.hadoop.hdds.scm.pipeline.PipelineFactory.create(PipelineFactory.java:72)
	at org.apache.hadoop.hdds.scm.pipeline.PipelineManagerImpl.createPipeline(PipelineManagerImpl.java:170)
	at org.apache.hadoop.hdds.scm.pipeline.WritableRatisContainerProvider.getContainer(WritableRatisContainerProvider.java:119)
	at org.apache.hadoop.hdds.scm.pipeline.WritableContainerFactory.getContainer(WritableContainerFactory.java:52)
	at org.apache.hadoop.hdds.scm.block.BlockManagerImpl.allocateBlock(BlockManagerImpl.java:176)
	at org.apache.hadoop.hdds.scm.block.TestBlockManager.lambda$testAllocateBlockInParallel$0(TestBlockManager.java:254)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2022-02-21 12:57:09,118 [pool-98-thread-1] ERROR pipeline.WritableRatisContainerProvider (WritableRatisContainerProvider.java:getContainer(164)) - Unable to allocate a block for the size: 134217728, repConfig: RATIS/THREE
2022-02-21 12:57:09,118 [pool-98-thread-1] ERROR block.BlockManagerImpl (BlockManagerImpl.java:allocateBlock(184)) - Unable to allocate a block for the size: 134217728, replicationConfig: RATIS/THREE
2022-02-21 12:57:09,116 [pool-97-thread-1] WARN  pipeline.WritableRatisContainerProvider (WritableRatisContainerProvider.java:getContainer(125)) - Pipeline creation failed for repConfig RATIS/THREE Datanodes may be used up.
org.apache.hadoop.hdds.scm.exceptions.SCMException: Pipeline creation failed because nodes are engaged in other pipelines and every node can only be engaged in max 2 pipelines. Required 3. Found 1
	at org.apache.hadoop.hdds.scm.pipeline.PipelinePlacementPolicy.filterViableNodes(PipelinePlacementPolicy.java:184)
	at org.apache.hadoop.hdds.scm.pipeline.PipelinePlacementPolicy.chooseDatanodes(PipelinePlacementPolicy.java:237)
	at org.apache.hadoop.hdds.scm.pipeline.RatisPipelineProvider.create(RatisPipelineProvider.java:153)
	at org.apache.hadoop.hdds.scm.pipeline.MockRatisPipelineProvider.create(MockRatisPipelineProvider.java:72)
	at org.apache.hadoop.hdds.scm.pipeline.MockRatisPipelineProvider.create(MockRatisPipelineProvider.java:36)
	at org.apache.hadoop.hdds.scm.pipeline.PipelineFactory.create(PipelineFactory.java:72)
	at org.apache.hadoop.hdds.scm.pipeline.PipelineManagerImpl.createPipeline(PipelineManagerImpl.java:170)
	at org.apache.hadoop.hdds.scm.pipeline.WritableRatisContainerProvider.getContainer(WritableRatisContainerProvider.java:119)
	at org.apache.hadoop.hdds.scm.pipeline.WritableContainerFactory.getContainer(WritableContainerFactory.java:52)
	at org.apache.hadoop.hdds.scm.block.BlockManagerImpl.allocateBlock(BlockManagerImpl.java:176)
	at org.apache.hadoop.hdds.scm.block.TestBlockManager.lambda$testAllocateBlockInParallel$0(TestBlockManager.java:254)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2022-02-21 12:57:09,118 [pool-97-thread-1] ERROR pipeline.WritableRatisContainerProvider (WritableRatisContainerProvider.java:getContainer(164)) - Unable to allocate a block for the size: 134217728, repConfig: RATIS/THREE
2022-02-21 12:57:09,118 [pool-97-thread-1] ERROR block.BlockManagerImpl (BlockManagerImpl.java:allocateBlock(184)) - Unable to allocate a block for the size: 134217728, replicationConfig: RATIS/THREE
2022-02-21 12:57:09,115 [pool-96-thread-1] WARN  pipeline.WritableRatisContainerProvider (WritableRatisContainerProvider.java:getContainer(125)) - Pipeline creation failed for repConfig RATIS/THREE Datanodes may be used up.
org.apache.hadoop.hdds.scm.exceptions.SCMException: Pipeline creation failed because nodes are engaged in other pipelines and every node can only be engaged in max 2 pipelines. Required 3. Found 1
	at org.apache.hadoop.hdds.scm.pipeline.PipelinePlacementPolicy.filterViableNodes(PipelinePlacementPolicy.java:184)
	at org.apache.hadoop.hdds.scm.pipeline.PipelinePlacementPolicy.chooseDatanodes(PipelinePlacementPolicy.java:237)
	at org.apache.hadoop.hdds.scm.pipeline.RatisPipelineProvider.create(RatisPipelineProvider.java:153)
	at org.apache.hadoop.hdds.scm.pipeline.MockRatisPipelineProvider.create(MockRatisPipelineProvider.java:72)
	at org.apache.hadoop.hdds.scm.pipeline.MockRatisPipelineProvider.create(MockRatisPipelineProvider.java:36)
	at org.apache.hadoop.hdds.scm.pipeline.PipelineFactory.create(PipelineFactory.java:72)
	at org.apache.hadoop.hdds.scm.pipeline.PipelineManagerImpl.createPipeline(PipelineManagerImpl.java:170)
	at org.apache.hadoop.hdds.scm.pipeline.WritableRatisContainerProvider.getContainer(WritableRatisContainerProvider.java:119)
	at org.apache.hadoop.hdds.scm.pipeline.WritableContainerFactory.getContainer(WritableContainerFactory.java:52)
	at org.apache.hadoop.hdds.scm.block.BlockManagerImpl.allocateBlock(BlockManagerImpl.java:176)
	at org.apache.hadoop.hdds.scm.block.TestBlockManager.lambda$testAllocateBlockInParallel$0(TestBlockManager.java:254)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2022-02-21 12:57:09,119 [pool-96-thread-1] ERROR pipeline.WritableRatisContainerProvider (WritableRatisContainerProvider.java:getContainer(164)) - Unable to allocate a block for the size: 134217728, repConfig: RATIS/THREE
2022-02-21 12:57:09,119 [pool-96-thread-1] ERROR block.BlockManagerImpl (BlockManagerImpl.java:allocateBlock(184)) - Unable to allocate a block for the size: 134217728, replicationConfig: RATIS/THREE
2022-02-21 12:57:09,114 [pool-95-thread-1] WARN  pipeline.WritableRatisContainerProvider (WritableRatisContainerProvider.java:getContainer(125)) - Pipeline creation failed for repConfig RATIS/THREE Datanodes may be used up.
org.apache.hadoop.hdds.scm.exceptions.SCMException: Pipeline creation failed because nodes are engaged in other pipelines and every node can only be engaged in max 2 pipelines. Required 3. Found 1
	at org.apache.hadoop.hdds.scm.pipeline.PipelinePlacementPolicy.filterViableNodes(PipelinePlacementPolicy.java:184)
	at org.apache.hadoop.hdds.scm.pipeline.PipelinePlacementPolicy.chooseDatanodes(PipelinePlacementPolicy.java:237)
	at org.apache.hadoop.hdds.scm.pipeline.RatisPipelineProvider.create(RatisPipelineProvider.java:153)
	at org.apache.hadoop.hdds.scm.pipeline.MockRatisPipelineProvider.create(MockRatisPipelineProvider.java:72)
	at org.apache.hadoop.hdds.scm.pipeline.MockRatisPipelineProvider.create(MockRatisPipelineProvider.java:36)
	at org.apache.hadoop.hdds.scm.pipeline.PipelineFactory.create(PipelineFactory.java:72)
	at org.apache.hadoop.hdds.scm.pipeline.PipelineManagerImpl.createPipeline(PipelineManagerImpl.java:170)
	at org.apache.hadoop.hdds.scm.pipeline.WritableRatisContainerProvider.getContainer(WritableRatisContainerProvider.java:119)
	at org.apache.hadoop.hdds.scm.pipeline.WritableContainerFactory.getContainer(WritableContainerFactory.java:52)
	at org.apache.hadoop.hdds.scm.block.BlockManagerImpl.allocateBlock(BlockManagerImpl.java:176)
	at org.apache.hadoop.hdds.scm.block.TestBlockManager.lambda$testAllocateBlockInParallel$0(TestBlockManager.java:254)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2022-02-21 12:57:09,119 [pool-95-thread-1] ERROR pipeline.WritableRatisContainerProvider (WritableRatisContainerProvider.java:getContainer(164)) - Unable to allocate a block for the size: 134217728, repConfig: RATIS/THREE
2022-02-21 12:57:09,119 [pool-95-thread-1] ERROR block.BlockManagerImpl (BlockManagerImpl.java:allocateBlock(184)) - Unable to allocate a block for the size: 134217728, replicationConfig: RATIS/THREE
2022-02-21 12:57:09,113 [pool-94-thread-1] WARN  pipeline.WritableRatisContainerProvider (WritableRatisContainerProvider.java:getContainer(125)) - Pipeline creation failed for repConfig RATIS/THREE Datanodes may be used up.
org.apache.hadoop.hdds.scm.exceptions.SCMException: Pipeline creation failed because nodes are engaged in other pipelines and every node can only be engaged in max 2 pipelines. Required 3. Found 1
	at org.apache.hadoop.hdds.scm.pipeline.PipelinePlacementPolicy.filterViableNodes(PipelinePlacementPolicy.java:184)
	at org.apache.hadoop.hdds.scm.pipeline.PipelinePlacementPolicy.chooseDatanodes(PipelinePlacementPolicy.java:237)
	at org.apache.hadoop.hdds.scm.pipeline.RatisPipelineProvider.create(RatisPipelineProvider.java:153)
	at org.apache.hadoop.hdds.scm.pipeline.MockRatisPipelineProvider.create(MockRatisPipelineProvider.java:72)
	at org.apache.hadoop.hdds.scm.pipeline.MockRatisPipelineProvider.create(MockRatisPipelineProvider.java:36)
	at org.apache.hadoop.hdds.scm.pipeline.PipelineFactory.create(PipelineFactory.java:72)
	at org.apache.hadoop.hdds.scm.pipeline.PipelineManagerImpl.createPipeline(PipelineManagerImpl.java:170)
	at org.apache.hadoop.hdds.scm.pipeline.WritableRatisContainerProvider.getContainer(WritableRatisContainerProvider.java:119)
	at org.apache.hadoop.hdds.scm.pipeline.WritableContainerFactory.getContainer(WritableContainerFactory.java:52)
	at org.apache.hadoop.hdds.scm.block.BlockManagerImpl.allocateBlock(BlockManagerImpl.java:176)
	at org.apache.hadoop.hdds.scm.block.TestBlockManager.lambda$testAllocateBlockInParallel$0(TestBlockManager.java:254)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2022-02-21 12:57:09,119 [pool-94-thread-1] ERROR pipeline.WritableRatisContainerProvider (WritableRatisContainerProvider.java:getContainer(164)) - Unable to allocate a block for the size: 134217728, repConfig: RATIS/THREE
2022-02-21 12:57:09,119 [pool-94-thread-1] ERROR block.BlockManagerImpl (BlockManagerImpl.java:allocateBlock(184)) - Unable to allocate a block for the size: 134217728, replicationConfig: RATIS/THREE
2022-02-21 12:57:09,112 [pool-93-thread-1] WARN  pipeline.WritableRatisContainerProvider (WritableRatisContainerProvider.java:getContainer(125)) - Pipeline creation failed for repConfig RATIS/THREE Datanodes may be used up.
org.apache.hadoop.hdds.scm.exceptions.SCMException: Pipeline creation failed because nodes are engaged in other pipelines and every node can only be engaged in max 2 pipelines. Required 3. Found 1
	at org.apache.hadoop.hdds.scm.pipeline.PipelinePlacementPolicy.filterViableNodes(PipelinePlacementPolicy.java:184)
	at org.apache.hadoop.hdds.scm.pipeline.PipelinePlacementPolicy.chooseDatanodes(PipelinePlacementPolicy.java:237)
	at org.apache.hadoop.hdds.scm.pipeline.RatisPipelineProvider.create(RatisPipelineProvider.java:153)
	at org.apache.hadoop.hdds.scm.pipeline.MockRatisPipelineProvider.create(MockRatisPipelineProvider.java:72)
	at org.apache.hadoop.hdds.scm.pipeline.MockRatisPipelineProvider.create(MockRatisPipelineProvider.java:36)
	at org.apache.hadoop.hdds.scm.pipeline.PipelineFactory.create(PipelineFactory.java:72)
	at org.apache.hadoop.hdds.scm.pipeline.PipelineManagerImpl.createPipeline(PipelineManagerImpl.java:170)
	at org.apache.hadoop.hdds.scm.pipeline.WritableRatisContainerProvider.getContainer(WritableRatisContainerProvider.java:119)
	at org.apache.hadoop.hdds.scm.pipeline.WritableContainerFactory.getContainer(WritableContainerFactory.java:52)
	at org.apache.hadoop.hdds.scm.block.BlockManagerImpl.allocateBlock(BlockManagerImpl.java:176)
	at org.apache.hadoop.hdds.scm.block.TestBlockManager.lambda$testAllocateBlockInParallel$0(TestBlockManager.java:254)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2022-02-21 12:57:09,120 [pool-93-thread-1] ERROR pipeline.WritableRatisContainerProvider (WritableRatisContainerProvider.java:getContainer(164)) - Unable to allocate a block for the size: 134217728, repConfig: RATIS/THREE
2022-02-21 12:57:09,120 [pool-93-thread-1] ERROR block.BlockManagerImpl (BlockManagerImpl.java:allocateBlock(184)) - Unable to allocate a block for the size: 134217728, replicationConfig: RATIS/THREE
2022-02-21 12:57:09,112 [pool-92-thread-1] WARN  pipeline.WritableRatisContainerProvider (WritableRatisContainerProvider.java:getContainer(125)) - Pipeline creation failed for repConfig RATIS/THREE Datanodes may be used up.
org.apache.hadoop.hdds.scm.exceptions.SCMException: Pipeline creation failed because nodes are engaged in other pipelines and every node can only be engaged in max 2 pipelines. Required 3. Found 1
	at org.apache.hadoop.hdds.scm.pipeline.PipelinePlacementPolicy.filterViableNodes(PipelinePlacementPolicy.java:184)
	at org.apache.hadoop.hdds.scm.pipeline.PipelinePlacementPolicy.chooseDatanodes(PipelinePlacementPolicy.java:237)
	at org.apache.hadoop.hdds.scm.pipeline.RatisPipelineProvider.create(RatisPipelineProvider.java:153)
	at org.apache.hadoop.hdds.scm.pipeline.MockRatisPipelineProvider.create(MockRatisPipelineProvider.java:72)
	at org.apache.hadoop.hdds.scm.pipeline.MockRatisPipelineProvider.create(MockRatisPipelineProvider.java:36)
	at org.apache.hadoop.hdds.scm.pipeline.PipelineFactory.create(PipelineFactory.java:72)
	at org.apache.hadoop.hdds.scm.pipeline.PipelineManagerImpl.createPipeline(PipelineManagerImpl.java:170)
	at org.apache.hadoop.hdds.scm.pipeline.WritableRatisContainerProvider.getContainer(WritableRatisContainerProvider.java:119)
	at org.apache.hadoop.hdds.scm.pipeline.WritableContainerFactory.getContainer(WritableContainerFactory.java:52)
	at org.apache.hadoop.hdds.scm.block.BlockManagerImpl.allocateBlock(BlockManagerImpl.java:176)
	at org.apache.hadoop.hdds.scm.block.TestBlockManager.lambda$testAllocateBlockInParallel$0(TestBlockManager.java:254)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2022-02-21 12:57:09,120 [pool-92-thread-1] ERROR pipeline.WritableRatisContainerProvider (WritableRatisContainerProvider.java:getContainer(164)) - Unable to allocate a block for the size: 134217728, repConfig: RATIS/THREE
2022-02-21 12:57:09,120 [pool-92-thread-1] ERROR block.BlockManagerImpl (BlockManagerImpl.java:allocateBlock(184)) - Unable to allocate a block for the size: 134217728, replicationConfig: RATIS/THREE
2022-02-21 12:57:09,111 [pool-91-thread-1] WARN  pipeline.WritableRatisContainerProvider (WritableRatisContainerProvider.java:getContainer(125)) - Pipeline creation failed for repConfig RATIS/THREE Datanodes may be used up.
org.apache.hadoop.hdds.scm.exceptions.SCMException: Pipeline creation failed because nodes are engaged in other pipelines and every node can only be engaged in max 2 pipelines. Required 3. Found 1
	at org.apache.hadoop.hdds.scm.pipeline.PipelinePlacementPolicy.filterViableNodes(PipelinePlacementPolicy.java:184)
	at org.apache.hadoop.hdds.scm.pipeline.PipelinePlacementPolicy.chooseDatanodes(PipelinePlacementPolicy.java:237)
	at org.apache.hadoop.hdds.scm.pipeline.RatisPipelineProvider.create(RatisPipelineProvider.java:153)
	at org.apache.hadoop.hdds.scm.pipeline.MockRatisPipelineProvider.create(MockRatisPipelineProvider.java:72)
	at org.apache.hadoop.hdds.scm.pipeline.MockRatisPipelineProvider.create(MockRatisPipelineProvider.java:36)
	at org.apache.hadoop.hdds.scm.pipeline.PipelineFactory.create(PipelineFactory.java:72)
	at org.apache.hadoop.hdds.scm.pipeline.PipelineManagerImpl.createPipeline(PipelineManagerImpl.java:170)
	at org.apache.hadoop.hdds.scm.pipeline.WritableRatisContainerProvider.getContainer(WritableRatisContainerProvider.java:119)
	at org.apache.hadoop.hdds.scm.pipeline.WritableContainerFactory.getContainer(WritableContainerFactory.java:52)
	at org.apache.hadoop.hdds.scm.block.BlockManagerImpl.allocateBlock(BlockManagerImpl.java:176)
	at org.apache.hadoop.hdds.scm.block.TestBlockManager.lambda$testAllocateBlockInParallel$0(TestBlockManager.java:254)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2022-02-21 12:57:09,120 [pool-91-thread-1] ERROR pipeline.WritableRatisContainerProvider (WritableRatisContainerProvider.java:getContainer(164)) - Unable to allocate a block for the size: 134217728, repConfig: RATIS/THREE
2022-02-21 12:57:09,120 [pool-91-thread-1] ERROR block.BlockManagerImpl (BlockManagerImpl.java:allocateBlock(184)) - Unable to allocate a block for the size: 134217728, replicationConfig: RATIS/THREE
2022-02-21 12:57:09,110 [pool-90-thread-1] WARN  pipeline.WritableRatisContainerProvider (WritableRatisContainerProvider.java:getContainer(125)) - Pipeline creation failed for repConfig RATIS/THREE Datanodes may be used up.
org.apache.hadoop.hdds.scm.exceptions.SCMException: Pipeline creation failed because nodes are engaged in other pipelines and every node can only be engaged in max 2 pipelines. Required 3. Found 1
	at org.apache.hadoop.hdds.scm.pipeline.PipelinePlacementPolicy.filterViableNodes(PipelinePlacementPolicy.java:184)
	at org.apache.hadoop.hdds.scm.pipeline.PipelinePlacementPolicy.chooseDatanodes(PipelinePlacementPolicy.java:237)
	at org.apache.hadoop.hdds.scm.pipeline.RatisPipelineProvider.create(RatisPipelineProvider.java:153)
	at org.apache.hadoop.hdds.scm.pipeline.MockRatisPipelineProvider.create(MockRatisPipelineProvider.java:72)
	at org.apache.hadoop.hdds.scm.pipeline.MockRatisPipelineProvider.create(MockRatisPipelineProvider.java:36)
	at org.apache.hadoop.hdds.scm.pipeline.PipelineFactory.create(PipelineFactory.java:72)
	at org.apache.hadoop.hdds.scm.pipeline.PipelineManagerImpl.createPipeline(PipelineManagerImpl.java:170)
	at org.apache.hadoop.hdds.scm.pipeline.WritableRatisContainerProvider.getContainer(WritableRatisContainerProvider.java:119)
	at org.apache.hadoop.hdds.scm.pipeline.WritableContainerFactory.getContainer(WritableContainerFactory.java:52)
	at org.apache.hadoop.hdds.scm.block.BlockManagerImpl.allocateBlock(BlockManagerImpl.java:176)
	at org.apache.hadoop.hdds.scm.block.TestBlockManager.lambda$testAllocateBlockInParallel$0(TestBlockManager.java:254)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2022-02-21 12:57:09,121 [pool-90-thread-1] ERROR pipeline.WritableRatisContainerProvider (WritableRatisContainerProvider.java:getContainer(164)) - Unable to allocate a block for the size: 134217728, repConfig: RATIS/THREE
2022-02-21 12:57:09,121 [pool-90-thread-1] ERROR block.BlockManagerImpl (BlockManagerImpl.java:allocateBlock(184)) - Unable to allocate a block for the size: 134217728, replicationConfig: RATIS/THREE
2022-02-21 12:57:09,109 [pool-89-thread-1] WARN  pipeline.WritableRatisContainerProvider (WritableRatisContainerProvider.java:getContainer(125)) - Pipeline creation failed for repConfig RATIS/THREE Datanodes may be used up.
org.apache.hadoop.hdds.scm.exceptions.SCMException: Pipeline creation failed because nodes are engaged in other pipelines and every node can only be engaged in max 2 pipelines. Required 3. Found 1
	at org.apache.hadoop.hdds.scm.pipeline.PipelinePlacementPolicy.filterViableNodes(PipelinePlacementPolicy.java:184)
	at org.apache.hadoop.hdds.scm.pipeline.PipelinePlacementPolicy.chooseDatanodes(PipelinePlacementPolicy.java:237)
	at org.apache.hadoop.hdds.scm.pipeline.RatisPipelineProvider.create(RatisPipelineProvider.java:153)
	at org.apache.hadoop.hdds.scm.pipeline.MockRatisPipelineProvider.create(MockRatisPipelineProvider.java:72)
	at org.apache.hadoop.hdds.scm.pipeline.MockRatisPipelineProvider.create(MockRatisPipelineProvider.java:36)
	at org.apache.hadoop.hdds.scm.pipeline.PipelineFactory.create(PipelineFactory.java:72)
	at org.apache.hadoop.hdds.scm.pipeline.PipelineManagerImpl.createPipeline(PipelineManagerImpl.java:170)
	at org.apache.hadoop.hdds.scm.pipeline.WritableRatisContainerProvider.getContainer(WritableRatisContainerProvider.java:119)
	at org.apache.hadoop.hdds.scm.pipeline.WritableContainerFactory.getContainer(WritableContainerFactory.java:52)
	at org.apache.hadoop.hdds.scm.block.BlockManagerImpl.allocateBlock(BlockManagerImpl.java:176)
	at org.apache.hadoop.hdds.scm.block.TestBlockManager.lambda$testAllocateBlockInParallel$0(TestBlockManager.java:254)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2022-02-21 12:57:09,121 [pool-89-thread-1] ERROR pipeline.WritableRatisContainerProvider (WritableRatisContainerProvider.java:getContainer(164)) - Unable to allocate a block for the size: 134217728, repConfig: RATIS/THREE
2022-02-21 12:57:09,121 [pool-89-thread-1] ERROR block.BlockManagerImpl (BlockManagerImpl.java:allocateBlock(184)) - Unable to allocate a block for the size: 134217728, replicationConfig: RATIS/THREE
2022-02-21 12:57:09,121 [EventQueue-DatanodeCommandForDatanodeCommandHandler] INFO  pipeline.PipelineManagerImpl (PipelineManagerImpl.java:openPipeline(291)) - Pipeline Pipeline[ Id: 8d2a6b02-c9a9-4b40-8cde-6e0caa5c741c, Nodes: da85d3b1-fdd6-4c79-b7c2-3a601dc1a8e6{ip: 30.46.225.93, host: localhost-30.46.225.93, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}d03402f6-d8b7-42df-ab36-2aafdd13cccc{ip: 146.124.179.78, host: localhost-146.124.179.78, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}da948be3-d58b-4f6b-8636-67b7a0653f44{ip: 166.135.250.108, host: localhost-166.135.250.108, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}, ReplicationConfig: RATIS/THREE, State:ALLOCATED, leaderId:, CreationTimestamp2022-02-21T12:57:09.082Z[Etc/UTC]] moved to OPEN state
2022-02-21 12:57:09,122 [pool-99-thread-1] WARN  pipeline.WritableRatisContainerProvider (WritableRatisContainerProvider.java:getContainer(125)) - Pipeline creation failed for repConfig RATIS/THREE Datanodes may be used up.
org.apache.hadoop.hdds.scm.exceptions.SCMException: Pipeline creation failed because nodes are engaged in other pipelines and every node can only be engaged in max 2 pipelines. Required 3. Found 1
	at org.apache.hadoop.hdds.scm.pipeline.PipelinePlacementPolicy.filterViableNodes(PipelinePlacementPolicy.java:184)
	at org.apache.hadoop.hdds.scm.pipeline.PipelinePlacementPolicy.chooseDatanodes(PipelinePlacementPolicy.java:237)
	at org.apache.hadoop.hdds.scm.pipeline.RatisPipelineProvider.create(RatisPipelineProvider.java:153)
	at org.apache.hadoop.hdds.scm.pipeline.MockRatisPipelineProvider.create(MockRatisPipelineProvider.java:72)
	at org.apache.hadoop.hdds.scm.pipeline.MockRatisPipelineProvider.create(MockRatisPipelineProvider.java:36)
	at org.apache.hadoop.hdds.scm.pipeline.PipelineFactory.create(PipelineFactory.java:72)
	at org.apache.hadoop.hdds.scm.pipeline.PipelineManagerImpl.createPipeline(PipelineManagerImpl.java:170)
	at org.apache.hadoop.hdds.scm.pipeline.WritableRatisContainerProvider.getContainer(WritableRatisContainerProvider.java:119)
	at org.apache.hadoop.hdds.scm.pipeline.WritableContainerFactory.getContainer(WritableContainerFactory.java:52)
	at org.apache.hadoop.hdds.scm.block.BlockManagerImpl.allocateBlock(BlockManagerImpl.java:176)
	at org.apache.hadoop.hdds.scm.block.TestBlockManager.lambda$testAllocateBlockInParallel$0(TestBlockManager.java:254)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
2022-02-21 12:57:09,123 [pool-99-thread-1] ERROR pipeline.WritableRatisContainerProvider (WritableRatisContainerProvider.java:getContainer(164)) - Unable to allocate a block for the size: 134217728, repConfig: RATIS/THREE
2022-02-21 12:57:09,123 [pool-99-thread-1] ERROR block.BlockManagerImpl (BlockManagerImpl.java:allocateBlock(184)) - Unable to allocate a block for the size: 134217728, replicationConfig: RATIS/THREE
2022-02-21 12:57:09,123 [EventQueue-DatanodeCommandForDatanodeCommandHandler] INFO  pipeline.PipelineManagerImpl (PipelineManagerImpl.java:openPipeline(291)) - Pipeline Pipeline[ Id: c1184f00-3ae5-4507-b34e-0e5e7d040343, Nodes: d03402f6-d8b7-42df-ab36-2aafdd13cccc{ip: 146.124.179.78, host: localhost-146.124.179.78, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}da85d3b1-fdd6-4c79-b7c2-3a601dc1a8e6{ip: 30.46.225.93, host: localhost-30.46.225.93, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}da948be3-d58b-4f6b-8636-67b7a0653f44{ip: 166.135.250.108, host: localhost-166.135.250.108, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}, ReplicationConfig: RATIS/THREE, State:ALLOCATED, leaderId:, CreationTimestamp2022-02-21T12:57:09.097Z[Etc/UTC]] moved to OPEN state
2022-02-21 12:57:09,124 [EventQueue-DatanodeCommandForDatanodeCommandHandler] INFO  pipeline.PipelineManagerImpl (PipelineManagerImpl.java:openPipeline(291)) - Pipeline Pipeline[ Id: 6cec8553-729f-4130-b600-2d227dade5f1, Nodes: 489f24f1-95e5-48e6-aa19-ec47a921a5fb{ip: 78.54.203.207, host: localhost-78.54.203.207, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}2ecc4222-52c1-4663-803a-1d21660e7073{ip: 11.226.124.236, host: localhost-11.226.124.236, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}1de66e33-d5ba-4fef-a22b-15ca3bfbfe3f{ip: 32.77.149.232, host: localhost-32.77.149.232, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}, ReplicationConfig: RATIS/THREE, State:ALLOCATED, leaderId:, CreationTimestamp2022-02-21T12:57:09.100Z[Etc/UTC]] moved to OPEN state
2022-02-21 12:57:09,125 [EventQueue-DatanodeCommandForDatanodeCommandHandler] INFO  pipeline.PipelineManagerImpl (PipelineManagerImpl.java:openPipeline(291)) - Pipeline Pipeline[ Id: 690b872c-8156-4ae2-b832-2e23f6332db5, Nodes: 489f24f1-95e5-48e6-aa19-ec47a921a5fb{ip: 78.54.203.207, host: localhost-78.54.203.207, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}1de66e33-d5ba-4fef-a22b-15ca3bfbfe3f{ip: 32.77.149.232, host: localhost-32.77.149.232, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}b2e36fa8-01ef-4cb3-b93f-142a613277d6{ip: 213.114.87.147, host: localhost-213.114.87.147, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}, ReplicationConfig: RATIS/THREE, State:ALLOCATED, leaderId:, CreationTimestamp2022-02-21T12:57:09.102Z[Etc/UTC]] moved to OPEN state
2022-02-21 12:57:09,125 [EventQueue-DatanodeCommandForDatanodeCommandHandler] INFO  pipeline.PipelineManagerImpl (PipelineManagerImpl.java:openPipeline(291)) - Pipeline Pipeline[ Id: 53f8bbf1-aa38-480a-a371-fe75fd50e6f6, Nodes: b2e36fa8-01ef-4cb3-b93f-142a613277d6{ip: 213.114.87.147, host: localhost-213.114.87.147, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}e5fb1bdb-734a-4e1a-a839-9d8a9bcbc8cd{ip: 3.56.8.27, host: localhost-3.56.8.27, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}2ecc4222-52c1-4663-803a-1d21660e7073{ip: 11.226.124.236, host: localhost-11.226.124.236, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}, ReplicationConfig: RATIS/THREE, State:ALLOCATED, leaderId:, CreationTimestamp2022-02-21T12:57:09.104Z[Etc/UTC]] moved to OPEN state
2022-02-21 12:57:09,126 [pool-100-thread-1] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:getNextId(127)) - Allocate a batch for containerId, change lastId from 0 to 1000.
2022-02-21 12:57:09,127 [pool-100-thread-1] WARN  ha.SequenceIdGenerator (SequenceIdGenerator.java:allocateBatch(235)) - Failed to allocate a batch for localId, expected lastId is 0, actual lastId is 109611004723200000.
2022-02-21 12:57:09,127 [pool-100-thread-1] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:getNextId(127)) - Allocate a batch for localId, change lastId from 109611004723200000 to 109611004723201000.
2022-02-21 12:57:09,208 [Listener at 0.0.0.0/45283] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1390)) - Stopping Container Balancer service.
2022-02-21 12:57:09,208 [Listener at 0.0.0.0/45283] INFO  balancer.ContainerBalancer (ContainerBalancer.java:stop(751)) - Container Balancer is not running.
2022-02-21 12:57:09,208 [Listener at 0.0.0.0/45283] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1397)) - Stopping Replication Manager Service.
2022-02-21 12:57:09,208 [Listener at 0.0.0.0/45283] INFO  container.ReplicationManager (ReplicationManager.java:stop(357)) - Stopping Replication Monitor Thread.
2022-02-21 12:57:09,208 [Listener at 0.0.0.0/45283] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1404)) - Stopping the Datanode Admin Monitor.
2022-02-21 12:57:09,209 [Listener at 0.0.0.0/45283] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1411)) - Stopping Lease Manager of the command watchers
2022-02-21 12:57:09,209 [Listener at 0.0.0.0/45283] ERROR server.StorageContainerManager (StorageContainerManager.java:stop(1414)) - Lease Manager of the command watchers stop failed
2022-02-21 12:57:09,209 [Listener at 0.0.0.0/45283] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1418)) - Stopping datanode service RPC server
2022-02-21 12:57:09,209 [Listener at 0.0.0.0/45283] INFO  server.SCMDatanodeProtocolServer (SCMDatanodeProtocolServer.java:stop(390)) - Stopping the RPC server for DataNodes
2022-02-21 12:57:09,209 [Listener at 0.0.0.0/45283] INFO  ipc.Server (Server.java:stop(3414)) - Stopping server on 45701
2022-02-21 12:57:09,210 [Listener at 0.0.0.0/45283] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1426)) - Stopping block service RPC server
2022-02-21 12:57:09,210 [Listener at 0.0.0.0/45283] INFO  server.SCMBlockProtocolServer (SCMBlockProtocolServer.java:stop(160)) - Stopping the RPC server for Block Protocol
2022-02-21 12:57:09,210 [Listener at 0.0.0.0/45283] INFO  ipc.Server (Server.java:stop(3414)) - Stopping server on 35337
2022-02-21 12:57:09,211 [Listener at 0.0.0.0/45283] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1433)) - Stopping the StorageContainerLocationProtocol RPC server
2022-02-21 12:57:09,211 [Listener at 0.0.0.0/45283] INFO  server.SCMClientProtocolServer (SCMClientProtocolServer.java:stop(174)) - Stopping the RPC server for Client Protocol
2022-02-21 12:57:09,211 [Listener at 0.0.0.0/45283] INFO  ipc.Server (Server.java:stop(3414)) - Stopping server on 45283
2022-02-21 12:57:09,211 [Listener at 0.0.0.0/45283] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1440)) - Stopping Storage Container Manager HTTP server.
2022-02-21 12:57:09,212 [Listener at 0.0.0.0/45283] ERROR server.StorageContainerManager (StorageContainerManager.java:stop(1443)) - Storage Container Manager HTTP server stop failed.
java.lang.NullPointerException
	at org.apache.hadoop.hdds.scm.server.StorageContainerManager.stop(StorageContainerManager.java:1441)
	at org.apache.hadoop.hdds.scm.block.TestBlockManager.cleanup(TestBlockManager.java:192)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.RunAfters.invokeMethod(RunAfters.java:46)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:33)
	at org.junit.rules.ExternalResource$1.evaluate(ExternalResource.java:54)
	at org.junit.rules.ExpectedException$ExpectedExceptionStatement.evaluate(ExpectedException.java:258)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115)
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Iterator.forEachRemaining(Iterator.java:116)
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485)
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82)
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:108)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:88)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.lambda$execute$0(EngineExecutionOrchestrator.java:54)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.withInterceptedStreams(EngineExecutionOrchestrator.java:67)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:52)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:96)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:75)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:142)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:113)
	at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:384)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:345)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:126)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:418)
2022-02-21 12:57:09,213 [Listener at 0.0.0.0/45283] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1451)) - Stopping Block Manager Service.
2022-02-21 12:57:09,213 [Listener at 0.0.0.0/45283] INFO  utils.BackgroundService (BackgroundService.java:shutdown(132)) - Shutting down service SCMBlockDeletingService
2022-02-21 12:57:09,213 [Listener at 0.0.0.0/45283] INFO  utils.BackgroundService (BackgroundService.java:shutdown(132)) - Shutting down service SCMBlockDeletingService
2022-02-21 12:57:09,213 [Listener at 0.0.0.0/45283] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1478)) - Stopping SCM Event Queue.
2022-02-21 12:57:09,214 [Listener at 0.0.0.0/45283] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1489)) - Stopping SCM HA services.
2022-02-21 12:57:09,214 [Listener at 0.0.0.0/45283] INFO  pipeline.BackgroundPipelineCreator (BackgroundPipelineCreator.java:stop(158)) - Stopping RatisPipelineUtilsThread.
2022-02-21 12:57:09,215 [Listener at 0.0.0.0/45283] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1499)) - Stopping SCM MetadataStore.
2022-02-21 12:57:09,257 [Listener at 0.0.0.0/45283] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchemaFromFile(129)) - Loading schema from [file:/home/runner/work/ozone/ozone/hadoop-hdds/common/target/classes/network-topology-default.xml]
2022-02-21 12:57:09,258 [Listener at 0.0.0.0/45283] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchema(176)) - Loading network topology layer schema file
2022-02-21 12:57:09,270 [Listener at 0.0.0.0/45283] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchemaFromFile(129)) - Loading schema from [file:/home/runner/work/ozone/ozone/hadoop-hdds/common/target/classes/network-topology-default.xml]
2022-02-21 12:57:09,270 [Listener at 0.0.0.0/45283] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchema(176)) - Loading network topology layer schema file
2022-02-21 12:57:09,272 [Listener at 0.0.0.0/45283] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/9e147a84-025a-43e8-8ef7-851b7bf4b4fd
2022-02-21 12:57:09,272 [Listener at 0.0.0.0/45283] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/3cb938a1-519d-4e29-ac04-83ae572533b6
2022-02-21 12:57:09,272 [Listener at 0.0.0.0/45283] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/a0a584d0-6116-42b2-b566-bad403a54c01
2022-02-21 12:57:09,272 [Listener at 0.0.0.0/45283] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/fecf18eb-f015-427c-911c-6e09453b67cf
2022-02-21 12:57:09,272 [Listener at 0.0.0.0/45283] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/7da0f840-70f1-4f99-a372-d7825856b77c
2022-02-21 12:57:09,273 [Listener at 0.0.0.0/45283] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/c0f6745d-66cd-4730-9b23-2f028f7fc94c
2022-02-21 12:57:09,273 [Listener at 0.0.0.0/45283] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/50f1a71e-760c-42f1-8a81-949ba62e5de1
2022-02-21 12:57:09,273 [Listener at 0.0.0.0/45283] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/03187c75-e5ba-4cf4-972d-8ea2732e5cf2
2022-02-21 12:57:09,273 [Listener at 0.0.0.0/45283] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/d38474ea-37a1-47f9-a268-a30e0dd03340
2022-02-21 12:57:09,273 [Listener at 0.0.0.0/45283] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/eccbfd9b-bb16-4979-837f-f328229c005c
2022-02-21 12:57:09,274 [Listener at 0.0.0.0/45283] WARN  utils.HAUtils (HAUtils.java:getMetaDir(342)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2022-02-21 12:57:09,275 [Listener at 0.0.0.0/45283] WARN  db.DBStoreBuilder (DBStoreBuilder.java:applyDBDefinition(145)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2022-02-21 12:57:09,376 [Listener at 0.0.0.0/45283] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:<init>(218)) - Init the HA SequenceIdGenerator.
2022-02-21 12:57:09,376 [Listener at 0.0.0.0/45283] INFO  pipeline.PipelineStateManagerImpl (PipelineStateManagerImpl.java:initialize(78)) - No pipeline exists in current db
2022-02-21 12:57:09,377 [Listener at 0.0.0.0/45283] INFO  algorithms.LeaderChoosePolicyFactory (LeaderChoosePolicyFactory.java:getPolicy(57)) - Create leader choose policy of type org.apache.hadoop.hdds.scm.pipeline.leader.choose.algorithms.MinLeaderCountChoosePolicy
2022-02-21 12:57:09,378 [Listener at 0.0.0.0/45283] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service BackgroundPipelineCreator.
2022-02-21 12:57:09,378 [Listener at 0.0.0.0/45283] INFO  pipeline.BackgroundPipelineCreator (BackgroundPipelineCreator.java:start(130)) - Starting RatisPipelineUtilsThread.
2022-02-21 12:57:09,379 [Listener at 0.0.0.0/45283] INFO  algorithms.LeaderChoosePolicyFactory (LeaderChoosePolicyFactory.java:getPolicy(57)) - Create leader choose policy of type org.apache.hadoop.hdds.scm.pipeline.leader.choose.algorithms.MinLeaderCountChoosePolicy
2022-02-21 12:57:09,381 [Listener at 0.0.0.0/45283] INFO  safemode.ContainerSafeModeRule (ContainerSafeModeRule.java:<init>(89)) - containers with one replica threshold count 0
2022-02-21 12:57:09,381 [Listener at 0.0.0.0/45283] INFO  safemode.HealthyPipelineSafeModeRule (HealthyPipelineSafeModeRule.java:initializeRule(156)) - Total pipeline count is 0, healthy pipeline threshold count is 0
2022-02-21 12:57:09,381 [Listener at 0.0.0.0/45283] INFO  safemode.OneReplicaPipelineSafeModeRule (OneReplicaPipelineSafeModeRule.java:initializeRule(180)) - Total pipeline count is 0, pipeline's with at least one datanode reported threshold count is 0
2022-02-21 12:57:09,382 [Listener at 0.0.0.0/45283] WARN  server.ServerUtils (ServerUtils.java:getScmDbDir(148)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2022-02-21 12:57:09,386 [Listener at 0.0.0.0/45283] INFO  ha.SCMHANodeDetails (SCMHANodeDetails.java:loadSCMHAConfig(157)) - ServiceID for StorageContainerManager is null
2022-02-21 12:57:09,386 [Listener at 0.0.0.0/45283] INFO  ha.SCMHANodeDetails (SCMHANodeDetails.java:loadSCMHAConfig(162)) - ozone.scm.default.service.id is not defined, falling back to ozone.scm.service.ids to find serviceID for StorageContainerManager if it is HA enabled cluster
2022-02-21 12:57:09,387 [Listener at 0.0.0.0/45283] WARN  server.ServerUtils (ServerUtils.java:getScmDbDir(148)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2022-02-21 12:57:09,387 [Listener at 0.0.0.0/45283] INFO  upgrade.AbstractLayoutVersionManager (AbstractLayoutVersionManager.java:init(79)) - Initializing Layout version manager with metadata layout = SCM_HA (version = 2), software layout = SCM_HA (version = 2)
2022-02-21 12:57:09,388 [Listener at 0.0.0.0/45283] WARN  util.MBeans (MBeans.java:getMBeanName(167)) - Error creating MBean object name: Hadoop:service=LayoutVersionManager,name=HDDSLayoutVersionManager
org.apache.hadoop.metrics2.MetricsException: org.apache.hadoop.metrics2.MetricsException: Hadoop:service=LayoutVersionManager,name=HDDSLayoutVersionManager already exists!
	at org.apache.hadoop.metrics2.lib.DefaultMetricsSystem.newObjectName(DefaultMetricsSystem.java:135)
	at org.apache.hadoop.metrics2.lib.DefaultMetricsSystem.newMBeanName(DefaultMetricsSystem.java:110)
	at org.apache.hadoop.metrics2.util.MBeans.getMBeanName(MBeans.java:165)
	at org.apache.hadoop.metrics2.util.MBeans.register(MBeans.java:97)
	at org.apache.hadoop.metrics2.util.MBeans.register(MBeans.java:73)
	at org.apache.hadoop.ozone.upgrade.AbstractLayoutVersionManager.init(AbstractLayoutVersionManager.java:84)
	at org.apache.hadoop.hdds.upgrade.HDDSLayoutVersionManager.<init>(HDDSLayoutVersionManager.java:50)
	at org.apache.hadoop.hdds.scm.server.StorageContainerManager.<init>(StorageContainerManager.java:326)
	at org.apache.hadoop.hdds.scm.server.StorageContainerManager.createSCM(StorageContainerManager.java:491)
	at org.apache.hadoop.hdds.scm.HddsTestUtils.getScm(HddsTestUtils.java:624)
	at org.apache.hadoop.hdds.scm.block.TestBlockManager.setUp(TestBlockManager.java:175)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.RunBefores.invokeMethod(RunBefores.java:33)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:24)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.rules.ExternalResource$1.evaluate(ExternalResource.java:54)
	at org.junit.rules.ExpectedException$ExpectedExceptionStatement.evaluate(ExpectedException.java:258)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115)
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Iterator.forEachRemaining(Iterator.java:116)
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485)
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82)
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:108)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:88)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.lambda$execute$0(EngineExecutionOrchestrator.java:54)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.withInterceptedStreams(EngineExecutionOrchestrator.java:67)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:52)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:96)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:75)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:142)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:113)
	at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:384)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:345)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:126)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:418)
Caused by: org.apache.hadoop.metrics2.MetricsException: Hadoop:service=LayoutVersionManager,name=HDDSLayoutVersionManager already exists!
	at org.apache.hadoop.metrics2.lib.DefaultMetricsSystem.newObjectName(DefaultMetricsSystem.java:131)
	... 62 more
2022-02-21 12:57:09,436 [Listener at 0.0.0.0/45283] INFO  reflections.Reflections (Reflections.java:scan(232)) - Reflections took 46 ms to scan 6 urls, producing 119 keys and 272 values 
2022-02-21 12:57:09,440 [Listener at 0.0.0.0/45283] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchemaFromFile(129)) - Loading schema from [file:/home/runner/work/ozone/ozone/hadoop-hdds/common/target/classes/network-topology-default.xml]
2022-02-21 12:57:09,440 [Listener at 0.0.0.0/45283] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchema(176)) - Loading network topology layer schema file
2022-02-21 12:57:09,448 [Listener at 0.0.0.0/45283] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:upgradeToSequenceId(347)) - upgrade localId to 109611004723200000
2022-02-21 12:57:09,448 [Listener at 0.0.0.0/45283] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:upgradeToSequenceId(357)) - upgrade delTxnId to 0
2022-02-21 12:57:09,448 [Listener at 0.0.0.0/45283] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:upgradeToSequenceId(371)) - upgrade containerId to 0
2022-02-21 12:57:09,448 [Listener at 0.0.0.0/45283] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:<init>(218)) - Init the HA SequenceIdGenerator.
2022-02-21 12:57:09,449 [Listener at 0.0.0.0/45283] INFO  algorithms.ContainerPlacementPolicyFactory (ContainerPlacementPolicyFactory.java:getPolicy(60)) - Create container placement policy of type org.apache.hadoop.hdds.scm.container.placement.algorithms.SCMContainerPlacementRandom
2022-02-21 12:57:09,449 [Listener at 0.0.0.0/45283] INFO  algorithms.PipelineChoosePolicyFactory (PipelineChoosePolicyFactory.java:createPipelineChoosePolicyFromClass(73)) - Create pipeline choose policy of type org.apache.hadoop.hdds.scm.pipeline.choose.algorithms.RandomPipelineChoosePolicy
2022-02-21 12:57:09,454 [Listener at 0.0.0.0/45283] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service SCMBlockDeletingService.
2022-02-21 12:57:09,457 [Listener at 0.0.0.0/45283] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service ReplicationManager.
2022-02-21 12:57:09,459 [Listener at 0.0.0.0/45283] INFO  container.ReplicationManager (ReplicationManager.java:start(326)) - Starting Replication Monitor Thread.
2022-02-21 12:57:09,463 [ReplicationMonitor] INFO  container.ReplicationManager (ReplicationManager.java:processAll(374)) - Replication Manager is not ready to run until 300000ms after safemode exit
2022-02-21 12:57:09,463 [Listener at 0.0.0.0/45283] INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(90)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 10000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false.
2022-02-21 12:57:09,466 [Socket Reader #1 for port 0] INFO  ipc.Server (Server.java:run(1265)) - Starting Socket Reader #1 for port 0
2022-02-21 12:57:09,468 [Listener at 0.0.0.0/42795] INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(90)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 10000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false.
2022-02-21 12:57:09,471 [Socket Reader #1 for port 0] INFO  ipc.Server (Server.java:run(1265)) - Starting Socket Reader #1 for port 0
2022-02-21 12:57:09,472 [Listener at 0.0.0.0/42511] INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(90)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 10000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false.
2022-02-21 12:57:09,474 [Socket Reader #1 for port 0] INFO  ipc.Server (Server.java:run(1265)) - Starting Socket Reader #1 for port 0
2022-02-21 12:57:09,492 [Listener at 0.0.0.0/38159] INFO  algorithms.ContainerPlacementPolicyFactory (ContainerPlacementPolicyFactory.java:getPolicy(60)) - Create container placement policy of type org.apache.hadoop.hdds.scm.container.placement.algorithms.SCMContainerPlacementRandom
2022-02-21 12:57:09,493 [Listener at 0.0.0.0/38159] INFO  server.StorageContainerManager (StorageContainerManager.java:<init>(388)) - 
Container Balancer status:
Key                            Value
Running                        false
Container Balancer Configuration values:
Key                                                Value
Threshold                                          10
Max Datanodes to Involve per Iteration(percent)    20
Max Size to Move per Iteration                     500GB
Max Size Entering Target per Iteration             26GB
Max Size Leaving Source per Iteration              26GB

2022-02-21 12:57:09,494 [Listener at 0.0.0.0/38159] INFO  ha.SCMContext (SCMContext.java:updateSafeModeStatus(211)) - Update SafeModeStatus from SafeModeStatus{safeModeStatus=false, preCheckPassed=true} to SafeModeStatus{safeModeStatus=false, preCheckPassed=true}.
2022-02-21 12:57:09,495 [Time-limited test] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(183)) - Sending CreatePipelineCommand for pipeline:PipelineID=dd602678-a979-4250-b510-baf08187d0bd to datanode:03187c75-e5ba-4cf4-972d-8ea2732e5cf2
2022-02-21 12:57:09,496 [Time-limited test] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(183)) - Sending CreatePipelineCommand for pipeline:PipelineID=dd602678-a979-4250-b510-baf08187d0bd to datanode:50f1a71e-760c-42f1-8a81-949ba62e5de1
2022-02-21 12:57:09,496 [Time-limited test] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(183)) - Sending CreatePipelineCommand for pipeline:PipelineID=dd602678-a979-4250-b510-baf08187d0bd to datanode:3cb938a1-519d-4e29-ac04-83ae572533b6
2022-02-21 12:57:09,499 [Time-limited test] INFO  pipeline.PipelineStateManagerImpl (PipelineStateManagerImpl.java:addPipeline(101)) - Created pipeline Pipeline[ Id: dd602678-a979-4250-b510-baf08187d0bd, Nodes: 03187c75-e5ba-4cf4-972d-8ea2732e5cf2{ip: 163.40.130.180, host: localhost-163.40.130.180, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}50f1a71e-760c-42f1-8a81-949ba62e5de1{ip: 114.208.9.46, host: localhost-114.208.9.46, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}3cb938a1-519d-4e29-ac04-83ae572533b6{ip: 20.74.79.171, host: localhost-20.74.79.171, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}, ReplicationConfig: RATIS/THREE, State:ALLOCATED, leaderId:, CreationTimestamp2022-02-21T12:57:09.495Z[Etc/UTC]].
2022-02-21 12:57:09,502 [EventQueue-DatanodeCommandForDatanodeCommandHandler] INFO  pipeline.PipelineManagerImpl (PipelineManagerImpl.java:openPipeline(291)) - Pipeline Pipeline[ Id: dd602678-a979-4250-b510-baf08187d0bd, Nodes: 03187c75-e5ba-4cf4-972d-8ea2732e5cf2{ip: 163.40.130.180, host: localhost-163.40.130.180, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}50f1a71e-760c-42f1-8a81-949ba62e5de1{ip: 114.208.9.46, host: localhost-114.208.9.46, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}3cb938a1-519d-4e29-ac04-83ae572533b6{ip: 20.74.79.171, host: localhost-20.74.79.171, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}, ReplicationConfig: RATIS/THREE, State:ALLOCATED, leaderId:, CreationTimestamp2022-02-21T12:57:09.495Z[Etc/UTC]] moved to OPEN state
2022-02-21 12:57:09,600 [Time-limited test] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:getNextId(127)) - Allocate a batch for containerId, change lastId from 0 to 1000.
2022-02-21 12:57:09,601 [Time-limited test] WARN  ha.SequenceIdGenerator (SequenceIdGenerator.java:allocateBatch(235)) - Failed to allocate a batch for localId, expected lastId is 0, actual lastId is 109611004723200000.
2022-02-21 12:57:09,602 [Time-limited test] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:getNextId(127)) - Allocate a batch for localId, change lastId from 109611004723200000 to 109611004723201000.
2022-02-21 12:57:09,602 [Listener at 0.0.0.0/38159] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1390)) - Stopping Container Balancer service.
2022-02-21 12:57:09,602 [Listener at 0.0.0.0/38159] INFO  balancer.ContainerBalancer (ContainerBalancer.java:stop(751)) - Container Balancer is not running.
2022-02-21 12:57:09,602 [Listener at 0.0.0.0/38159] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1397)) - Stopping Replication Manager Service.
2022-02-21 12:57:09,602 [Listener at 0.0.0.0/38159] INFO  container.ReplicationManager (ReplicationManager.java:stop(357)) - Stopping Replication Monitor Thread.
2022-02-21 12:57:09,603 [Listener at 0.0.0.0/38159] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1404)) - Stopping the Datanode Admin Monitor.
2022-02-21 12:57:09,603 [Listener at 0.0.0.0/38159] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1411)) - Stopping Lease Manager of the command watchers
2022-02-21 12:57:09,603 [Listener at 0.0.0.0/38159] ERROR server.StorageContainerManager (StorageContainerManager.java:stop(1414)) - Lease Manager of the command watchers stop failed
2022-02-21 12:57:09,603 [Listener at 0.0.0.0/38159] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1418)) - Stopping datanode service RPC server
2022-02-21 12:57:09,603 [Listener at 0.0.0.0/38159] INFO  server.SCMDatanodeProtocolServer (SCMDatanodeProtocolServer.java:stop(390)) - Stopping the RPC server for DataNodes
2022-02-21 12:57:09,604 [Listener at 0.0.0.0/38159] INFO  ipc.Server (Server.java:stop(3414)) - Stopping server on 42795
2022-02-21 12:57:09,604 [Listener at 0.0.0.0/38159] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1426)) - Stopping block service RPC server
2022-02-21 12:57:09,604 [Listener at 0.0.0.0/38159] INFO  server.SCMBlockProtocolServer (SCMBlockProtocolServer.java:stop(160)) - Stopping the RPC server for Block Protocol
2022-02-21 12:57:09,604 [Listener at 0.0.0.0/38159] INFO  ipc.Server (Server.java:stop(3414)) - Stopping server on 42511
2022-02-21 12:57:09,605 [Listener at 0.0.0.0/38159] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1433)) - Stopping the StorageContainerLocationProtocol RPC server
2022-02-21 12:57:09,605 [Listener at 0.0.0.0/38159] INFO  server.SCMClientProtocolServer (SCMClientProtocolServer.java:stop(174)) - Stopping the RPC server for Client Protocol
2022-02-21 12:57:09,605 [Listener at 0.0.0.0/38159] INFO  ipc.Server (Server.java:stop(3414)) - Stopping server on 38159
2022-02-21 12:57:09,605 [Listener at 0.0.0.0/38159] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1440)) - Stopping Storage Container Manager HTTP server.
2022-02-21 12:57:09,605 [Listener at 0.0.0.0/38159] ERROR server.StorageContainerManager (StorageContainerManager.java:stop(1443)) - Storage Container Manager HTTP server stop failed.
java.lang.NullPointerException
	at org.apache.hadoop.hdds.scm.server.StorageContainerManager.stop(StorageContainerManager.java:1441)
	at org.apache.hadoop.hdds.scm.block.TestBlockManager.cleanup(TestBlockManager.java:192)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.RunAfters.invokeMethod(RunAfters.java:46)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:33)
	at org.junit.rules.ExternalResource$1.evaluate(ExternalResource.java:54)
	at org.junit.rules.ExpectedException$ExpectedExceptionStatement.evaluate(ExpectedException.java:258)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115)
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Iterator.forEachRemaining(Iterator.java:116)
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485)
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82)
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:108)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:88)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.lambda$execute$0(EngineExecutionOrchestrator.java:54)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.withInterceptedStreams(EngineExecutionOrchestrator.java:67)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:52)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:96)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:75)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:142)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:113)
	at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:384)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:345)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:126)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:418)
2022-02-21 12:57:09,606 [Listener at 0.0.0.0/38159] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1451)) - Stopping Block Manager Service.
2022-02-21 12:57:09,606 [Listener at 0.0.0.0/38159] INFO  utils.BackgroundService (BackgroundService.java:shutdown(132)) - Shutting down service SCMBlockDeletingService
2022-02-21 12:57:09,606 [Listener at 0.0.0.0/38159] INFO  utils.BackgroundService (BackgroundService.java:shutdown(132)) - Shutting down service SCMBlockDeletingService
2022-02-21 12:57:09,606 [Listener at 0.0.0.0/38159] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1478)) - Stopping SCM Event Queue.
2022-02-21 12:57:09,607 [Listener at 0.0.0.0/38159] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1489)) - Stopping SCM HA services.
2022-02-21 12:57:09,607 [Listener at 0.0.0.0/38159] INFO  pipeline.BackgroundPipelineCreator (BackgroundPipelineCreator.java:stop(158)) - Stopping RatisPipelineUtilsThread.
2022-02-21 12:57:09,607 [Listener at 0.0.0.0/38159] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1499)) - Stopping SCM MetadataStore.
2022-02-21 12:57:09,631 [Listener at 0.0.0.0/38159] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchemaFromFile(129)) - Loading schema from [file:/home/runner/work/ozone/ozone/hadoop-hdds/common/target/classes/network-topology-default.xml]
2022-02-21 12:57:09,632 [Listener at 0.0.0.0/38159] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchema(176)) - Loading network topology layer schema file
2022-02-21 12:57:09,644 [Listener at 0.0.0.0/38159] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchemaFromFile(129)) - Loading schema from [file:/home/runner/work/ozone/ozone/hadoop-hdds/common/target/classes/network-topology-default.xml]
2022-02-21 12:57:09,644 [Listener at 0.0.0.0/38159] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchema(176)) - Loading network topology layer schema file
2022-02-21 12:57:09,645 [Listener at 0.0.0.0/38159] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/bf9abf27-563c-4079-b8b4-0b6b60fa8a03
2022-02-21 12:57:09,646 [Listener at 0.0.0.0/38159] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/d6cf141b-3801-4899-bf58-9a8a2f27c920
2022-02-21 12:57:09,646 [Listener at 0.0.0.0/38159] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/14f3e14b-30da-4648-9a6b-2c5877b7c730
2022-02-21 12:57:09,646 [Listener at 0.0.0.0/38159] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/7dec4e87-3d7f-45fb-bb9f-6b84135dc9c8
2022-02-21 12:57:09,646 [Listener at 0.0.0.0/38159] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/fb9d69c4-06b3-46f5-9dd1-615bbd5d1ad8
2022-02-21 12:57:09,646 [Listener at 0.0.0.0/38159] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/e0cdc568-ee52-44cc-983e-249765a6459a
2022-02-21 12:57:09,647 [Listener at 0.0.0.0/38159] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/34f7a609-7a7e-4263-b461-5e28013ea568
2022-02-21 12:57:09,647 [Listener at 0.0.0.0/38159] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/a82b316c-f8ff-4fa4-953a-d9fb45087e5b
2022-02-21 12:57:09,647 [Listener at 0.0.0.0/38159] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/28a70ca4-c6f6-40cf-85e0-0aec2ed9fc14
2022-02-21 12:57:09,647 [Listener at 0.0.0.0/38159] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/3d651c30-8cd6-426d-88ff-852202b2c8ec
2022-02-21 12:57:09,647 [Listener at 0.0.0.0/38159] WARN  utils.HAUtils (HAUtils.java:getMetaDir(342)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2022-02-21 12:57:09,648 [Listener at 0.0.0.0/38159] WARN  db.DBStoreBuilder (DBStoreBuilder.java:applyDBDefinition(145)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2022-02-21 12:57:09,748 [Listener at 0.0.0.0/38159] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:<init>(218)) - Init the HA SequenceIdGenerator.
2022-02-21 12:57:09,749 [Listener at 0.0.0.0/38159] INFO  pipeline.PipelineStateManagerImpl (PipelineStateManagerImpl.java:initialize(78)) - No pipeline exists in current db
2022-02-21 12:57:09,749 [Listener at 0.0.0.0/38159] INFO  algorithms.LeaderChoosePolicyFactory (LeaderChoosePolicyFactory.java:getPolicy(57)) - Create leader choose policy of type org.apache.hadoop.hdds.scm.pipeline.leader.choose.algorithms.MinLeaderCountChoosePolicy
2022-02-21 12:57:09,750 [Listener at 0.0.0.0/38159] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service BackgroundPipelineCreator.
2022-02-21 12:57:09,750 [Listener at 0.0.0.0/38159] INFO  pipeline.BackgroundPipelineCreator (BackgroundPipelineCreator.java:start(130)) - Starting RatisPipelineUtilsThread.
2022-02-21 12:57:09,750 [Listener at 0.0.0.0/38159] INFO  algorithms.LeaderChoosePolicyFactory (LeaderChoosePolicyFactory.java:getPolicy(57)) - Create leader choose policy of type org.apache.hadoop.hdds.scm.pipeline.leader.choose.algorithms.MinLeaderCountChoosePolicy
2022-02-21 12:57:09,751 [Listener at 0.0.0.0/38159] INFO  safemode.ContainerSafeModeRule (ContainerSafeModeRule.java:<init>(89)) - containers with one replica threshold count 0
2022-02-21 12:57:09,752 [Listener at 0.0.0.0/38159] INFO  safemode.HealthyPipelineSafeModeRule (HealthyPipelineSafeModeRule.java:initializeRule(156)) - Total pipeline count is 0, healthy pipeline threshold count is 0
2022-02-21 12:57:09,752 [Listener at 0.0.0.0/38159] INFO  safemode.OneReplicaPipelineSafeModeRule (OneReplicaPipelineSafeModeRule.java:initializeRule(180)) - Total pipeline count is 0, pipeline's with at least one datanode reported threshold count is 0
2022-02-21 12:57:09,752 [Listener at 0.0.0.0/38159] WARN  server.ServerUtils (ServerUtils.java:getScmDbDir(148)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2022-02-21 12:57:09,754 [Listener at 0.0.0.0/38159] INFO  ha.SCMHANodeDetails (SCMHANodeDetails.java:loadSCMHAConfig(157)) - ServiceID for StorageContainerManager is null
2022-02-21 12:57:09,754 [Listener at 0.0.0.0/38159] INFO  ha.SCMHANodeDetails (SCMHANodeDetails.java:loadSCMHAConfig(162)) - ozone.scm.default.service.id is not defined, falling back to ozone.scm.service.ids to find serviceID for StorageContainerManager if it is HA enabled cluster
2022-02-21 12:57:09,754 [Listener at 0.0.0.0/38159] WARN  server.ServerUtils (ServerUtils.java:getScmDbDir(148)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2022-02-21 12:57:09,755 [Listener at 0.0.0.0/38159] INFO  upgrade.AbstractLayoutVersionManager (AbstractLayoutVersionManager.java:init(79)) - Initializing Layout version manager with metadata layout = SCM_HA (version = 2), software layout = SCM_HA (version = 2)
2022-02-21 12:57:09,755 [Listener at 0.0.0.0/38159] WARN  util.MBeans (MBeans.java:getMBeanName(167)) - Error creating MBean object name: Hadoop:service=LayoutVersionManager,name=HDDSLayoutVersionManager
org.apache.hadoop.metrics2.MetricsException: org.apache.hadoop.metrics2.MetricsException: Hadoop:service=LayoutVersionManager,name=HDDSLayoutVersionManager already exists!
	at org.apache.hadoop.metrics2.lib.DefaultMetricsSystem.newObjectName(DefaultMetricsSystem.java:135)
	at org.apache.hadoop.metrics2.lib.DefaultMetricsSystem.newMBeanName(DefaultMetricsSystem.java:110)
	at org.apache.hadoop.metrics2.util.MBeans.getMBeanName(MBeans.java:165)
	at org.apache.hadoop.metrics2.util.MBeans.register(MBeans.java:97)
	at org.apache.hadoop.metrics2.util.MBeans.register(MBeans.java:73)
	at org.apache.hadoop.ozone.upgrade.AbstractLayoutVersionManager.init(AbstractLayoutVersionManager.java:84)
	at org.apache.hadoop.hdds.upgrade.HDDSLayoutVersionManager.<init>(HDDSLayoutVersionManager.java:50)
	at org.apache.hadoop.hdds.scm.server.StorageContainerManager.<init>(StorageContainerManager.java:326)
	at org.apache.hadoop.hdds.scm.server.StorageContainerManager.createSCM(StorageContainerManager.java:491)
	at org.apache.hadoop.hdds.scm.HddsTestUtils.getScm(HddsTestUtils.java:624)
	at org.apache.hadoop.hdds.scm.block.TestBlockManager.setUp(TestBlockManager.java:175)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.RunBefores.invokeMethod(RunBefores.java:33)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:24)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.rules.ExternalResource$1.evaluate(ExternalResource.java:54)
	at org.junit.rules.ExpectedException$ExpectedExceptionStatement.evaluate(ExpectedException.java:258)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115)
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Iterator.forEachRemaining(Iterator.java:116)
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485)
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82)
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:108)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:88)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.lambda$execute$0(EngineExecutionOrchestrator.java:54)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.withInterceptedStreams(EngineExecutionOrchestrator.java:67)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:52)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:96)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:75)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:142)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:113)
	at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:384)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:345)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:126)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:418)
Caused by: org.apache.hadoop.metrics2.MetricsException: Hadoop:service=LayoutVersionManager,name=HDDSLayoutVersionManager already exists!
	at org.apache.hadoop.metrics2.lib.DefaultMetricsSystem.newObjectName(DefaultMetricsSystem.java:131)
	... 62 more
2022-02-21 12:57:09,795 [Listener at 0.0.0.0/38159] INFO  reflections.Reflections (Reflections.java:scan(232)) - Reflections took 38 ms to scan 6 urls, producing 119 keys and 272 values 
2022-02-21 12:57:09,797 [Listener at 0.0.0.0/38159] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchemaFromFile(129)) - Loading schema from [file:/home/runner/work/ozone/ozone/hadoop-hdds/common/target/classes/network-topology-default.xml]
2022-02-21 12:57:09,798 [Listener at 0.0.0.0/38159] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchema(176)) - Loading network topology layer schema file
2022-02-21 12:57:09,800 [Listener at 0.0.0.0/38159] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:upgradeToSequenceId(347)) - upgrade localId to 109611004723200000
2022-02-21 12:57:09,803 [Listener at 0.0.0.0/38159] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:upgradeToSequenceId(357)) - upgrade delTxnId to 0
2022-02-21 12:57:09,803 [Listener at 0.0.0.0/38159] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:upgradeToSequenceId(371)) - upgrade containerId to 0
2022-02-21 12:57:09,803 [Listener at 0.0.0.0/38159] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:<init>(218)) - Init the HA SequenceIdGenerator.
2022-02-21 12:57:09,804 [Listener at 0.0.0.0/38159] INFO  algorithms.ContainerPlacementPolicyFactory (ContainerPlacementPolicyFactory.java:getPolicy(60)) - Create container placement policy of type org.apache.hadoop.hdds.scm.container.placement.algorithms.SCMContainerPlacementRandom
2022-02-21 12:57:09,804 [Listener at 0.0.0.0/38159] INFO  algorithms.PipelineChoosePolicyFactory (PipelineChoosePolicyFactory.java:createPipelineChoosePolicyFromClass(73)) - Create pipeline choose policy of type org.apache.hadoop.hdds.scm.pipeline.choose.algorithms.RandomPipelineChoosePolicy
2022-02-21 12:57:09,805 [Listener at 0.0.0.0/38159] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service SCMBlockDeletingService.
2022-02-21 12:57:09,805 [Listener at 0.0.0.0/38159] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service ReplicationManager.
2022-02-21 12:57:09,805 [Listener at 0.0.0.0/38159] INFO  container.ReplicationManager (ReplicationManager.java:start(326)) - Starting Replication Monitor Thread.
2022-02-21 12:57:09,806 [ReplicationMonitor] INFO  container.ReplicationManager (ReplicationManager.java:processAll(374)) - Replication Manager is not ready to run until 300000ms after safemode exit
2022-02-21 12:57:09,807 [Listener at 0.0.0.0/38159] INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(90)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 10000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false.
2022-02-21 12:57:09,811 [Socket Reader #1 for port 0] INFO  ipc.Server (Server.java:run(1265)) - Starting Socket Reader #1 for port 0
2022-02-21 12:57:09,812 [Listener at 0.0.0.0/38667] INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(90)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 10000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false.
2022-02-21 12:57:09,813 [Socket Reader #1 for port 0] INFO  ipc.Server (Server.java:run(1265)) - Starting Socket Reader #1 for port 0
2022-02-21 12:57:09,814 [Listener at 0.0.0.0/38323] INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(90)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 10000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false.
2022-02-21 12:57:09,815 [Socket Reader #1 for port 0] INFO  ipc.Server (Server.java:run(1265)) - Starting Socket Reader #1 for port 0
2022-02-21 12:57:09,830 [Listener at 0.0.0.0/43873] INFO  algorithms.ContainerPlacementPolicyFactory (ContainerPlacementPolicyFactory.java:getPolicy(60)) - Create container placement policy of type org.apache.hadoop.hdds.scm.container.placement.algorithms.SCMContainerPlacementRandom
2022-02-21 12:57:09,836 [Listener at 0.0.0.0/43873] INFO  server.StorageContainerManager (StorageContainerManager.java:<init>(388)) - 
Container Balancer status:
Key                            Value
Running                        false
Container Balancer Configuration values:
Key                                                Value
Threshold                                          10
Max Datanodes to Involve per Iteration(percent)    20
Max Size to Move per Iteration                     500GB
Max Size Entering Target per Iteration             26GB
Max Size Leaving Source per Iteration              26GB

2022-02-21 12:57:09,837 [Listener at 0.0.0.0/43873] INFO  ha.SCMContext (SCMContext.java:updateSafeModeStatus(211)) - Update SafeModeStatus from SafeModeStatus{safeModeStatus=false, preCheckPassed=true} to SafeModeStatus{safeModeStatus=false, preCheckPassed=true}.
2022-02-21 12:57:09,842 [Listener at 0.0.0.0/43873] WARN  block.BlockManagerImpl (BlockManagerImpl.java:allocateBlock(171)) - Invalid block size requested : 6442450944
2022-02-21 12:57:09,842 [Listener at 0.0.0.0/43873] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1390)) - Stopping Container Balancer service.
2022-02-21 12:57:09,842 [Listener at 0.0.0.0/43873] INFO  balancer.ContainerBalancer (ContainerBalancer.java:stop(751)) - Container Balancer is not running.
2022-02-21 12:57:09,842 [Listener at 0.0.0.0/43873] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1397)) - Stopping Replication Manager Service.
2022-02-21 12:57:09,842 [Listener at 0.0.0.0/43873] INFO  container.ReplicationManager (ReplicationManager.java:stop(357)) - Stopping Replication Monitor Thread.
2022-02-21 12:57:09,843 [Listener at 0.0.0.0/43873] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1404)) - Stopping the Datanode Admin Monitor.
2022-02-21 12:57:09,843 [Listener at 0.0.0.0/43873] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1411)) - Stopping Lease Manager of the command watchers
2022-02-21 12:57:09,844 [Listener at 0.0.0.0/43873] ERROR server.StorageContainerManager (StorageContainerManager.java:stop(1414)) - Lease Manager of the command watchers stop failed
2022-02-21 12:57:09,844 [Listener at 0.0.0.0/43873] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1418)) - Stopping datanode service RPC server
2022-02-21 12:57:09,844 [Listener at 0.0.0.0/43873] INFO  server.SCMDatanodeProtocolServer (SCMDatanodeProtocolServer.java:stop(390)) - Stopping the RPC server for DataNodes
2022-02-21 12:57:09,844 [Listener at 0.0.0.0/43873] INFO  ipc.Server (Server.java:stop(3414)) - Stopping server on 38667
2022-02-21 12:57:09,844 [Listener at 0.0.0.0/43873] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1426)) - Stopping block service RPC server
2022-02-21 12:57:09,845 [Listener at 0.0.0.0/43873] INFO  server.SCMBlockProtocolServer (SCMBlockProtocolServer.java:stop(160)) - Stopping the RPC server for Block Protocol
2022-02-21 12:57:09,845 [Listener at 0.0.0.0/43873] INFO  ipc.Server (Server.java:stop(3414)) - Stopping server on 38323
2022-02-21 12:57:09,845 [Listener at 0.0.0.0/43873] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1433)) - Stopping the StorageContainerLocationProtocol RPC server
2022-02-21 12:57:09,845 [Listener at 0.0.0.0/43873] INFO  server.SCMClientProtocolServer (SCMClientProtocolServer.java:stop(174)) - Stopping the RPC server for Client Protocol
2022-02-21 12:57:09,845 [Listener at 0.0.0.0/43873] INFO  ipc.Server (Server.java:stop(3414)) - Stopping server on 43873
2022-02-21 12:57:09,846 [Listener at 0.0.0.0/43873] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1440)) - Stopping Storage Container Manager HTTP server.
2022-02-21 12:57:09,846 [Listener at 0.0.0.0/43873] ERROR server.StorageContainerManager (StorageContainerManager.java:stop(1443)) - Storage Container Manager HTTP server stop failed.
java.lang.NullPointerException
	at org.apache.hadoop.hdds.scm.server.StorageContainerManager.stop(StorageContainerManager.java:1441)
	at org.apache.hadoop.hdds.scm.block.TestBlockManager.cleanup(TestBlockManager.java:192)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.RunAfters.invokeMethod(RunAfters.java:46)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:33)
	at org.junit.rules.ExternalResource$1.evaluate(ExternalResource.java:54)
	at org.junit.rules.ExpectedException$ExpectedExceptionStatement.evaluate(ExpectedException.java:258)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115)
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Iterator.forEachRemaining(Iterator.java:116)
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485)
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82)
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:108)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:88)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.lambda$execute$0(EngineExecutionOrchestrator.java:54)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.withInterceptedStreams(EngineExecutionOrchestrator.java:67)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:52)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:96)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:75)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:142)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:113)
	at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:384)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:345)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:126)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:418)
2022-02-21 12:57:09,846 [Listener at 0.0.0.0/43873] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1451)) - Stopping Block Manager Service.
2022-02-21 12:57:09,846 [Listener at 0.0.0.0/43873] INFO  utils.BackgroundService (BackgroundService.java:shutdown(132)) - Shutting down service SCMBlockDeletingService
2022-02-21 12:57:09,847 [Listener at 0.0.0.0/43873] INFO  utils.BackgroundService (BackgroundService.java:shutdown(132)) - Shutting down service SCMBlockDeletingService
2022-02-21 12:57:09,847 [Listener at 0.0.0.0/43873] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1478)) - Stopping SCM Event Queue.
2022-02-21 12:57:09,848 [Listener at 0.0.0.0/43873] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1489)) - Stopping SCM HA services.
2022-02-21 12:57:09,848 [Listener at 0.0.0.0/43873] INFO  pipeline.BackgroundPipelineCreator (BackgroundPipelineCreator.java:stop(158)) - Stopping RatisPipelineUtilsThread.
2022-02-21 12:57:09,849 [Listener at 0.0.0.0/43873] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1499)) - Stopping SCM MetadataStore.
2022-02-21 12:57:09,890 [Listener at 0.0.0.0/43873] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchemaFromFile(129)) - Loading schema from [file:/home/runner/work/ozone/ozone/hadoop-hdds/common/target/classes/network-topology-default.xml]
2022-02-21 12:57:09,890 [Listener at 0.0.0.0/43873] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchema(176)) - Loading network topology layer schema file
2022-02-21 12:57:09,905 [Listener at 0.0.0.0/43873] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchemaFromFile(129)) - Loading schema from [file:/home/runner/work/ozone/ozone/hadoop-hdds/common/target/classes/network-topology-default.xml]
2022-02-21 12:57:09,906 [Listener at 0.0.0.0/43873] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchema(176)) - Loading network topology layer schema file
2022-02-21 12:57:09,908 [Listener at 0.0.0.0/43873] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/68aba8fe-7a76-4d85-96e6-1d4036d80ca2
2022-02-21 12:57:09,908 [Listener at 0.0.0.0/43873] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/6a233685-5d5a-4183-b4fb-addea62355a6
2022-02-21 12:57:09,909 [Listener at 0.0.0.0/43873] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/9509868c-db56-487f-90fe-a90bb92f5b9a
2022-02-21 12:57:09,909 [Listener at 0.0.0.0/43873] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/49660d6f-3260-4098-a390-9adf6e7129b4
2022-02-21 12:57:09,909 [Listener at 0.0.0.0/43873] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/8fc7544b-5a3d-4b68-812c-7d409122a5ef
2022-02-21 12:57:09,910 [Listener at 0.0.0.0/43873] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/0c48f997-07e8-4688-998e-92bee555eb90
2022-02-21 12:57:09,910 [Listener at 0.0.0.0/43873] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/58bf4fcb-8cfb-4408-9e12-d996971f67a0
2022-02-21 12:57:09,910 [Listener at 0.0.0.0/43873] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/c57b23ab-3952-492a-9e94-43b8478379a2
2022-02-21 12:57:09,910 [Listener at 0.0.0.0/43873] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/2d4635c8-7c78-4109-94b0-6dc82fd4d483
2022-02-21 12:57:09,910 [Listener at 0.0.0.0/43873] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/c7437ef0-1cd8-4838-b0b8-c14dfe5deae2
2022-02-21 12:57:09,911 [Listener at 0.0.0.0/43873] WARN  utils.HAUtils (HAUtils.java:getMetaDir(342)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2022-02-21 12:57:09,911 [Listener at 0.0.0.0/43873] WARN  db.DBStoreBuilder (DBStoreBuilder.java:applyDBDefinition(145)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2022-02-21 12:57:10,019 [Listener at 0.0.0.0/43873] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:<init>(218)) - Init the HA SequenceIdGenerator.
2022-02-21 12:57:10,020 [Listener at 0.0.0.0/43873] INFO  pipeline.PipelineStateManagerImpl (PipelineStateManagerImpl.java:initialize(78)) - No pipeline exists in current db
2022-02-21 12:57:10,020 [Listener at 0.0.0.0/43873] INFO  algorithms.LeaderChoosePolicyFactory (LeaderChoosePolicyFactory.java:getPolicy(57)) - Create leader choose policy of type org.apache.hadoop.hdds.scm.pipeline.leader.choose.algorithms.MinLeaderCountChoosePolicy
2022-02-21 12:57:10,021 [Listener at 0.0.0.0/43873] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service BackgroundPipelineCreator.
2022-02-21 12:57:10,021 [Listener at 0.0.0.0/43873] INFO  pipeline.BackgroundPipelineCreator (BackgroundPipelineCreator.java:start(130)) - Starting RatisPipelineUtilsThread.
2022-02-21 12:57:10,021 [Listener at 0.0.0.0/43873] INFO  algorithms.LeaderChoosePolicyFactory (LeaderChoosePolicyFactory.java:getPolicy(57)) - Create leader choose policy of type org.apache.hadoop.hdds.scm.pipeline.leader.choose.algorithms.MinLeaderCountChoosePolicy
2022-02-21 12:57:10,022 [Listener at 0.0.0.0/43873] INFO  safemode.ContainerSafeModeRule (ContainerSafeModeRule.java:<init>(89)) - containers with one replica threshold count 0
2022-02-21 12:57:10,023 [Listener at 0.0.0.0/43873] INFO  safemode.HealthyPipelineSafeModeRule (HealthyPipelineSafeModeRule.java:initializeRule(156)) - Total pipeline count is 0, healthy pipeline threshold count is 0
2022-02-21 12:57:10,023 [Listener at 0.0.0.0/43873] INFO  safemode.OneReplicaPipelineSafeModeRule (OneReplicaPipelineSafeModeRule.java:initializeRule(180)) - Total pipeline count is 0, pipeline's with at least one datanode reported threshold count is 0
2022-02-21 12:57:10,023 [Listener at 0.0.0.0/43873] WARN  server.ServerUtils (ServerUtils.java:getScmDbDir(148)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2022-02-21 12:57:10,027 [Listener at 0.0.0.0/43873] INFO  ha.SCMHANodeDetails (SCMHANodeDetails.java:loadSCMHAConfig(157)) - ServiceID for StorageContainerManager is null
2022-02-21 12:57:10,030 [Listener at 0.0.0.0/43873] INFO  ha.SCMHANodeDetails (SCMHANodeDetails.java:loadSCMHAConfig(162)) - ozone.scm.default.service.id is not defined, falling back to ozone.scm.service.ids to find serviceID for StorageContainerManager if it is HA enabled cluster
2022-02-21 12:57:10,031 [Listener at 0.0.0.0/43873] WARN  server.ServerUtils (ServerUtils.java:getScmDbDir(148)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2022-02-21 12:57:10,031 [Listener at 0.0.0.0/43873] INFO  upgrade.AbstractLayoutVersionManager (AbstractLayoutVersionManager.java:init(79)) - Initializing Layout version manager with metadata layout = SCM_HA (version = 2), software layout = SCM_HA (version = 2)
2022-02-21 12:57:10,032 [Listener at 0.0.0.0/43873] WARN  util.MBeans (MBeans.java:getMBeanName(167)) - Error creating MBean object name: Hadoop:service=LayoutVersionManager,name=HDDSLayoutVersionManager
org.apache.hadoop.metrics2.MetricsException: org.apache.hadoop.metrics2.MetricsException: Hadoop:service=LayoutVersionManager,name=HDDSLayoutVersionManager already exists!
	at org.apache.hadoop.metrics2.lib.DefaultMetricsSystem.newObjectName(DefaultMetricsSystem.java:135)
	at org.apache.hadoop.metrics2.lib.DefaultMetricsSystem.newMBeanName(DefaultMetricsSystem.java:110)
	at org.apache.hadoop.metrics2.util.MBeans.getMBeanName(MBeans.java:165)
	at org.apache.hadoop.metrics2.util.MBeans.register(MBeans.java:97)
	at org.apache.hadoop.metrics2.util.MBeans.register(MBeans.java:73)
	at org.apache.hadoop.ozone.upgrade.AbstractLayoutVersionManager.init(AbstractLayoutVersionManager.java:84)
	at org.apache.hadoop.hdds.upgrade.HDDSLayoutVersionManager.<init>(HDDSLayoutVersionManager.java:50)
	at org.apache.hadoop.hdds.scm.server.StorageContainerManager.<init>(StorageContainerManager.java:326)
	at org.apache.hadoop.hdds.scm.server.StorageContainerManager.createSCM(StorageContainerManager.java:491)
	at org.apache.hadoop.hdds.scm.HddsTestUtils.getScm(HddsTestUtils.java:624)
	at org.apache.hadoop.hdds.scm.block.TestBlockManager.setUp(TestBlockManager.java:175)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.RunBefores.invokeMethod(RunBefores.java:33)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:24)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.rules.ExternalResource$1.evaluate(ExternalResource.java:54)
	at org.junit.rules.ExpectedException$ExpectedExceptionStatement.evaluate(ExpectedException.java:258)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115)
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Iterator.forEachRemaining(Iterator.java:116)
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485)
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82)
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:108)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:88)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.lambda$execute$0(EngineExecutionOrchestrator.java:54)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.withInterceptedStreams(EngineExecutionOrchestrator.java:67)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:52)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:96)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:75)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:142)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:113)
	at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:384)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:345)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:126)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:418)
Caused by: org.apache.hadoop.metrics2.MetricsException: Hadoop:service=LayoutVersionManager,name=HDDSLayoutVersionManager already exists!
	at org.apache.hadoop.metrics2.lib.DefaultMetricsSystem.newObjectName(DefaultMetricsSystem.java:131)
	... 62 more
2022-02-21 12:57:10,067 [Listener at 0.0.0.0/43873] INFO  reflections.Reflections (Reflections.java:scan(232)) - Reflections took 34 ms to scan 6 urls, producing 119 keys and 272 values 
2022-02-21 12:57:10,069 [Listener at 0.0.0.0/43873] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchemaFromFile(129)) - Loading schema from [file:/home/runner/work/ozone/ozone/hadoop-hdds/common/target/classes/network-topology-default.xml]
2022-02-21 12:57:10,070 [Listener at 0.0.0.0/43873] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchema(176)) - Loading network topology layer schema file
2022-02-21 12:57:10,072 [Listener at 0.0.0.0/43873] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:upgradeToSequenceId(347)) - upgrade localId to 109611004723200000
2022-02-21 12:57:10,072 [Listener at 0.0.0.0/43873] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:upgradeToSequenceId(357)) - upgrade delTxnId to 0
2022-02-21 12:57:10,072 [Listener at 0.0.0.0/43873] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:upgradeToSequenceId(371)) - upgrade containerId to 0
2022-02-21 12:57:10,072 [Listener at 0.0.0.0/43873] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:<init>(218)) - Init the HA SequenceIdGenerator.
2022-02-21 12:57:10,073 [Listener at 0.0.0.0/43873] INFO  algorithms.ContainerPlacementPolicyFactory (ContainerPlacementPolicyFactory.java:getPolicy(60)) - Create container placement policy of type org.apache.hadoop.hdds.scm.container.placement.algorithms.SCMContainerPlacementRandom
2022-02-21 12:57:10,073 [Listener at 0.0.0.0/43873] INFO  algorithms.PipelineChoosePolicyFactory (PipelineChoosePolicyFactory.java:createPipelineChoosePolicyFromClass(73)) - Create pipeline choose policy of type org.apache.hadoop.hdds.scm.pipeline.choose.algorithms.RandomPipelineChoosePolicy
2022-02-21 12:57:10,074 [Listener at 0.0.0.0/43873] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service SCMBlockDeletingService.
2022-02-21 12:57:10,074 [Listener at 0.0.0.0/43873] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service ReplicationManager.
2022-02-21 12:57:10,075 [Listener at 0.0.0.0/43873] INFO  container.ReplicationManager (ReplicationManager.java:start(326)) - Starting Replication Monitor Thread.
2022-02-21 12:57:10,078 [Listener at 0.0.0.0/43873] INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(90)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 10000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false.
2022-02-21 12:57:10,079 [Socket Reader #1 for port 0] INFO  ipc.Server (Server.java:run(1265)) - Starting Socket Reader #1 for port 0
2022-02-21 12:57:10,084 [ReplicationMonitor] INFO  container.ReplicationManager (ReplicationManager.java:processAll(374)) - Replication Manager is not ready to run until 300000ms after safemode exit
2022-02-21 12:57:10,079 [Listener at 0.0.0.0/46777] INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(90)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 10000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false.
2022-02-21 12:57:10,085 [Socket Reader #1 for port 0] INFO  ipc.Server (Server.java:run(1265)) - Starting Socket Reader #1 for port 0
2022-02-21 12:57:10,085 [Listener at 0.0.0.0/43563] INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(90)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 10000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false.
2022-02-21 12:57:10,086 [Socket Reader #1 for port 0] INFO  ipc.Server (Server.java:run(1265)) - Starting Socket Reader #1 for port 0
2022-02-21 12:57:10,098 [Listener at 0.0.0.0/34373] INFO  algorithms.ContainerPlacementPolicyFactory (ContainerPlacementPolicyFactory.java:getPolicy(60)) - Create container placement policy of type org.apache.hadoop.hdds.scm.container.placement.algorithms.SCMContainerPlacementRandom
2022-02-21 12:57:10,100 [Listener at 0.0.0.0/34373] INFO  server.StorageContainerManager (StorageContainerManager.java:<init>(388)) - 
Container Balancer status:
Key                            Value
Running                        false
Container Balancer Configuration values:
Key                                                Value
Threshold                                          10
Max Datanodes to Involve per Iteration(percent)    20
Max Size to Move per Iteration                     500GB
Max Size Entering Target per Iteration             26GB
Max Size Leaving Source per Iteration              26GB

2022-02-21 12:57:10,101 [Listener at 0.0.0.0/34373] INFO  ha.SCMContext (SCMContext.java:updateSafeModeStatus(211)) - Update SafeModeStatus from SafeModeStatus{safeModeStatus=false, preCheckPassed=true} to SafeModeStatus{safeModeStatus=false, preCheckPassed=true}.
2022-02-21 12:57:10,101 [Listener at 0.0.0.0/34373] INFO  ha.SCMContext (SCMContext.java:updateSafeModeStatus(211)) - Update SafeModeStatus from SafeModeStatus{safeModeStatus=false, preCheckPassed=true} to SafeModeStatus{safeModeStatus=true, preCheckPassed=true}.
2022-02-21 12:57:10,101 [Listener at 0.0.0.0/34373] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1390)) - Stopping Container Balancer service.
2022-02-21 12:57:10,102 [Listener at 0.0.0.0/34373] INFO  balancer.ContainerBalancer (ContainerBalancer.java:stop(751)) - Container Balancer is not running.
2022-02-21 12:57:10,102 [Listener at 0.0.0.0/34373] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1397)) - Stopping Replication Manager Service.
2022-02-21 12:57:10,102 [Listener at 0.0.0.0/34373] INFO  container.ReplicationManager (ReplicationManager.java:stop(357)) - Stopping Replication Monitor Thread.
2022-02-21 12:57:10,102 [Listener at 0.0.0.0/34373] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1404)) - Stopping the Datanode Admin Monitor.
2022-02-21 12:57:10,103 [Listener at 0.0.0.0/34373] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1411)) - Stopping Lease Manager of the command watchers
2022-02-21 12:57:10,103 [Listener at 0.0.0.0/34373] ERROR server.StorageContainerManager (StorageContainerManager.java:stop(1414)) - Lease Manager of the command watchers stop failed
2022-02-21 12:57:10,104 [Listener at 0.0.0.0/34373] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1418)) - Stopping datanode service RPC server
2022-02-21 12:57:10,104 [Listener at 0.0.0.0/34373] INFO  server.SCMDatanodeProtocolServer (SCMDatanodeProtocolServer.java:stop(390)) - Stopping the RPC server for DataNodes
2022-02-21 12:57:10,104 [Listener at 0.0.0.0/34373] INFO  ipc.Server (Server.java:stop(3414)) - Stopping server on 46777
2022-02-21 12:57:10,104 [Listener at 0.0.0.0/34373] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1426)) - Stopping block service RPC server
2022-02-21 12:57:10,105 [Listener at 0.0.0.0/34373] INFO  server.SCMBlockProtocolServer (SCMBlockProtocolServer.java:stop(160)) - Stopping the RPC server for Block Protocol
2022-02-21 12:57:10,105 [Listener at 0.0.0.0/34373] INFO  ipc.Server (Server.java:stop(3414)) - Stopping server on 43563
2022-02-21 12:57:10,105 [Listener at 0.0.0.0/34373] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1433)) - Stopping the StorageContainerLocationProtocol RPC server
2022-02-21 12:57:10,105 [Listener at 0.0.0.0/34373] INFO  server.SCMClientProtocolServer (SCMClientProtocolServer.java:stop(174)) - Stopping the RPC server for Client Protocol
2022-02-21 12:57:10,106 [Listener at 0.0.0.0/34373] INFO  ipc.Server (Server.java:stop(3414)) - Stopping server on 34373
2022-02-21 12:57:10,106 [Listener at 0.0.0.0/34373] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1440)) - Stopping Storage Container Manager HTTP server.
2022-02-21 12:57:10,106 [Listener at 0.0.0.0/34373] ERROR server.StorageContainerManager (StorageContainerManager.java:stop(1443)) - Storage Container Manager HTTP server stop failed.
java.lang.NullPointerException
	at org.apache.hadoop.hdds.scm.server.StorageContainerManager.stop(StorageContainerManager.java:1441)
	at org.apache.hadoop.hdds.scm.block.TestBlockManager.cleanup(TestBlockManager.java:192)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.RunAfters.invokeMethod(RunAfters.java:46)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:33)
	at org.junit.rules.ExternalResource$1.evaluate(ExternalResource.java:54)
	at org.junit.rules.ExpectedException$ExpectedExceptionStatement.evaluate(ExpectedException.java:258)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115)
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Iterator.forEachRemaining(Iterator.java:116)
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485)
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82)
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:108)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:88)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.lambda$execute$0(EngineExecutionOrchestrator.java:54)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.withInterceptedStreams(EngineExecutionOrchestrator.java:67)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:52)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:96)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:75)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:142)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:113)
	at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:384)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:345)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:126)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:418)
2022-02-21 12:57:10,107 [Listener at 0.0.0.0/34373] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1451)) - Stopping Block Manager Service.
2022-02-21 12:57:10,107 [Listener at 0.0.0.0/34373] INFO  utils.BackgroundService (BackgroundService.java:shutdown(132)) - Shutting down service SCMBlockDeletingService
2022-02-21 12:57:10,107 [Listener at 0.0.0.0/34373] INFO  utils.BackgroundService (BackgroundService.java:shutdown(132)) - Shutting down service SCMBlockDeletingService
2022-02-21 12:57:10,107 [Listener at 0.0.0.0/34373] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1478)) - Stopping SCM Event Queue.
2022-02-21 12:57:10,107 [Listener at 0.0.0.0/34373] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1489)) - Stopping SCM HA services.
2022-02-21 12:57:10,108 [Listener at 0.0.0.0/34373] INFO  pipeline.BackgroundPipelineCreator (BackgroundPipelineCreator.java:stop(158)) - Stopping RatisPipelineUtilsThread.
2022-02-21 12:57:10,108 [Listener at 0.0.0.0/34373] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1499)) - Stopping SCM MetadataStore.
2022-02-21 12:57:10,132 [Listener at 0.0.0.0/34373] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchemaFromFile(129)) - Loading schema from [file:/home/runner/work/ozone/ozone/hadoop-hdds/common/target/classes/network-topology-default.xml]
2022-02-21 12:57:10,132 [Listener at 0.0.0.0/34373] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchema(176)) - Loading network topology layer schema file
2022-02-21 12:57:10,144 [Listener at 0.0.0.0/34373] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchemaFromFile(129)) - Loading schema from [file:/home/runner/work/ozone/ozone/hadoop-hdds/common/target/classes/network-topology-default.xml]
2022-02-21 12:57:10,144 [Listener at 0.0.0.0/34373] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchema(176)) - Loading network topology layer schema file
2022-02-21 12:57:10,146 [Listener at 0.0.0.0/34373] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/c02ec61b-4ec7-4049-94f3-06cb8f2567f2
2022-02-21 12:57:10,147 [Listener at 0.0.0.0/34373] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/524b76a9-2f69-4fe3-990a-aeace8166e15
2022-02-21 12:57:10,148 [Listener at 0.0.0.0/34373] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/1c452f9d-1fd6-4289-bd7b-1996d34dac18
2022-02-21 12:57:10,148 [Listener at 0.0.0.0/34373] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/949e3d4f-7f5a-4d62-8223-63014707e806
2022-02-21 12:57:10,148 [Listener at 0.0.0.0/34373] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/3519c8ca-0c3c-44ee-a0ec-d73cef181b7c
2022-02-21 12:57:10,148 [Listener at 0.0.0.0/34373] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/32030866-3417-47ca-81be-d34f116e7660
2022-02-21 12:57:10,148 [Listener at 0.0.0.0/34373] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/6c181edf-8058-4296-90fc-960263927ab2
2022-02-21 12:57:10,148 [Listener at 0.0.0.0/34373] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/aac9ee58-7022-4b6b-a0de-3bf14089c1f3
2022-02-21 12:57:10,149 [Listener at 0.0.0.0/34373] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/f99fda06-d358-4a3d-8a59-d3c8ae92c2eb
2022-02-21 12:57:10,149 [Listener at 0.0.0.0/34373] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/ca059c20-cf5b-4b4e-b5f6-13cbc610681f
2022-02-21 12:57:10,149 [Listener at 0.0.0.0/34373] WARN  utils.HAUtils (HAUtils.java:getMetaDir(342)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2022-02-21 12:57:10,150 [Listener at 0.0.0.0/34373] WARN  db.DBStoreBuilder (DBStoreBuilder.java:applyDBDefinition(145)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2022-02-21 12:57:10,243 [Listener at 0.0.0.0/34373] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:<init>(218)) - Init the HA SequenceIdGenerator.
2022-02-21 12:57:10,243 [Listener at 0.0.0.0/34373] INFO  pipeline.PipelineStateManagerImpl (PipelineStateManagerImpl.java:initialize(78)) - No pipeline exists in current db
2022-02-21 12:57:10,244 [Listener at 0.0.0.0/34373] INFO  algorithms.LeaderChoosePolicyFactory (LeaderChoosePolicyFactory.java:getPolicy(57)) - Create leader choose policy of type org.apache.hadoop.hdds.scm.pipeline.leader.choose.algorithms.MinLeaderCountChoosePolicy
2022-02-21 12:57:10,244 [Listener at 0.0.0.0/34373] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service BackgroundPipelineCreator.
2022-02-21 12:57:10,244 [Listener at 0.0.0.0/34373] INFO  pipeline.BackgroundPipelineCreator (BackgroundPipelineCreator.java:start(130)) - Starting RatisPipelineUtilsThread.
2022-02-21 12:57:10,254 [Listener at 0.0.0.0/34373] INFO  algorithms.LeaderChoosePolicyFactory (LeaderChoosePolicyFactory.java:getPolicy(57)) - Create leader choose policy of type org.apache.hadoop.hdds.scm.pipeline.leader.choose.algorithms.MinLeaderCountChoosePolicy
2022-02-21 12:57:10,255 [Listener at 0.0.0.0/34373] INFO  safemode.ContainerSafeModeRule (ContainerSafeModeRule.java:<init>(89)) - containers with one replica threshold count 0
2022-02-21 12:57:10,256 [Listener at 0.0.0.0/34373] INFO  safemode.HealthyPipelineSafeModeRule (HealthyPipelineSafeModeRule.java:initializeRule(156)) - Total pipeline count is 0, healthy pipeline threshold count is 0
2022-02-21 12:57:10,256 [Listener at 0.0.0.0/34373] INFO  safemode.OneReplicaPipelineSafeModeRule (OneReplicaPipelineSafeModeRule.java:initializeRule(180)) - Total pipeline count is 0, pipeline's with at least one datanode reported threshold count is 0
2022-02-21 12:57:10,256 [Listener at 0.0.0.0/34373] WARN  server.ServerUtils (ServerUtils.java:getScmDbDir(148)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2022-02-21 12:57:10,258 [Listener at 0.0.0.0/34373] INFO  ha.SCMHANodeDetails (SCMHANodeDetails.java:loadSCMHAConfig(157)) - ServiceID for StorageContainerManager is null
2022-02-21 12:57:10,258 [Listener at 0.0.0.0/34373] INFO  ha.SCMHANodeDetails (SCMHANodeDetails.java:loadSCMHAConfig(162)) - ozone.scm.default.service.id is not defined, falling back to ozone.scm.service.ids to find serviceID for StorageContainerManager if it is HA enabled cluster
2022-02-21 12:57:10,258 [Listener at 0.0.0.0/34373] WARN  server.ServerUtils (ServerUtils.java:getScmDbDir(148)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2022-02-21 12:57:10,259 [Listener at 0.0.0.0/34373] INFO  upgrade.AbstractLayoutVersionManager (AbstractLayoutVersionManager.java:init(79)) - Initializing Layout version manager with metadata layout = SCM_HA (version = 2), software layout = SCM_HA (version = 2)
2022-02-21 12:57:10,259 [Listener at 0.0.0.0/34373] WARN  util.MBeans (MBeans.java:getMBeanName(167)) - Error creating MBean object name: Hadoop:service=LayoutVersionManager,name=HDDSLayoutVersionManager
org.apache.hadoop.metrics2.MetricsException: org.apache.hadoop.metrics2.MetricsException: Hadoop:service=LayoutVersionManager,name=HDDSLayoutVersionManager already exists!
	at org.apache.hadoop.metrics2.lib.DefaultMetricsSystem.newObjectName(DefaultMetricsSystem.java:135)
	at org.apache.hadoop.metrics2.lib.DefaultMetricsSystem.newMBeanName(DefaultMetricsSystem.java:110)
	at org.apache.hadoop.metrics2.util.MBeans.getMBeanName(MBeans.java:165)
	at org.apache.hadoop.metrics2.util.MBeans.register(MBeans.java:97)
	at org.apache.hadoop.metrics2.util.MBeans.register(MBeans.java:73)
	at org.apache.hadoop.ozone.upgrade.AbstractLayoutVersionManager.init(AbstractLayoutVersionManager.java:84)
	at org.apache.hadoop.hdds.upgrade.HDDSLayoutVersionManager.<init>(HDDSLayoutVersionManager.java:50)
	at org.apache.hadoop.hdds.scm.server.StorageContainerManager.<init>(StorageContainerManager.java:326)
	at org.apache.hadoop.hdds.scm.server.StorageContainerManager.createSCM(StorageContainerManager.java:491)
	at org.apache.hadoop.hdds.scm.HddsTestUtils.getScm(HddsTestUtils.java:624)
	at org.apache.hadoop.hdds.scm.block.TestBlockManager.setUp(TestBlockManager.java:175)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.RunBefores.invokeMethod(RunBefores.java:33)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:24)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.rules.ExternalResource$1.evaluate(ExternalResource.java:54)
	at org.junit.rules.ExpectedException$ExpectedExceptionStatement.evaluate(ExpectedException.java:258)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115)
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Iterator.forEachRemaining(Iterator.java:116)
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485)
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82)
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:108)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:88)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.lambda$execute$0(EngineExecutionOrchestrator.java:54)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.withInterceptedStreams(EngineExecutionOrchestrator.java:67)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:52)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:96)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:75)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:142)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:113)
	at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:384)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:345)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:126)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:418)
Caused by: org.apache.hadoop.metrics2.MetricsException: Hadoop:service=LayoutVersionManager,name=HDDSLayoutVersionManager already exists!
	at org.apache.hadoop.metrics2.lib.DefaultMetricsSystem.newObjectName(DefaultMetricsSystem.java:131)
	... 62 more
2022-02-21 12:57:10,305 [Listener at 0.0.0.0/34373] INFO  reflections.Reflections (Reflections.java:scan(232)) - Reflections took 45 ms to scan 6 urls, producing 119 keys and 272 values 
2022-02-21 12:57:10,308 [Listener at 0.0.0.0/34373] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchemaFromFile(129)) - Loading schema from [file:/home/runner/work/ozone/ozone/hadoop-hdds/common/target/classes/network-topology-default.xml]
2022-02-21 12:57:10,308 [Listener at 0.0.0.0/34373] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchema(176)) - Loading network topology layer schema file
2022-02-21 12:57:10,311 [Listener at 0.0.0.0/34373] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:upgradeToSequenceId(347)) - upgrade localId to 109611004723200000
2022-02-21 12:57:10,311 [Listener at 0.0.0.0/34373] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:upgradeToSequenceId(357)) - upgrade delTxnId to 0
2022-02-21 12:57:10,311 [Listener at 0.0.0.0/34373] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:upgradeToSequenceId(371)) - upgrade containerId to 0
2022-02-21 12:57:10,311 [Listener at 0.0.0.0/34373] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:<init>(218)) - Init the HA SequenceIdGenerator.
2022-02-21 12:57:10,311 [Listener at 0.0.0.0/34373] INFO  algorithms.ContainerPlacementPolicyFactory (ContainerPlacementPolicyFactory.java:getPolicy(60)) - Create container placement policy of type org.apache.hadoop.hdds.scm.container.placement.algorithms.SCMContainerPlacementRandom
2022-02-21 12:57:10,312 [Listener at 0.0.0.0/34373] INFO  algorithms.PipelineChoosePolicyFactory (PipelineChoosePolicyFactory.java:createPipelineChoosePolicyFromClass(73)) - Create pipeline choose policy of type org.apache.hadoop.hdds.scm.pipeline.choose.algorithms.RandomPipelineChoosePolicy
2022-02-21 12:57:10,313 [Listener at 0.0.0.0/34373] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service SCMBlockDeletingService.
2022-02-21 12:57:10,313 [Listener at 0.0.0.0/34373] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service ReplicationManager.
2022-02-21 12:57:10,313 [Listener at 0.0.0.0/34373] INFO  container.ReplicationManager (ReplicationManager.java:start(326)) - Starting Replication Monitor Thread.
2022-02-21 12:57:10,323 [ReplicationMonitor] INFO  container.ReplicationManager (ReplicationManager.java:processAll(374)) - Replication Manager is not ready to run until 300000ms after safemode exit
2022-02-21 12:57:10,327 [Listener at 0.0.0.0/34373] INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(90)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 10000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false.
2022-02-21 12:57:10,329 [Socket Reader #1 for port 0] INFO  ipc.Server (Server.java:run(1265)) - Starting Socket Reader #1 for port 0
2022-02-21 12:57:10,329 [Listener at 0.0.0.0/41947] INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(90)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 10000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false.
2022-02-21 12:57:10,331 [Socket Reader #1 for port 0] INFO  ipc.Server (Server.java:run(1265)) - Starting Socket Reader #1 for port 0
2022-02-21 12:57:10,335 [Listener at 0.0.0.0/43549] INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(90)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 10000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false.
2022-02-21 12:57:10,338 [Socket Reader #1 for port 0] INFO  ipc.Server (Server.java:run(1265)) - Starting Socket Reader #1 for port 0
2022-02-21 12:57:10,351 [Listener at 0.0.0.0/39929] INFO  algorithms.ContainerPlacementPolicyFactory (ContainerPlacementPolicyFactory.java:getPolicy(60)) - Create container placement policy of type org.apache.hadoop.hdds.scm.container.placement.algorithms.SCMContainerPlacementRandom
2022-02-21 12:57:10,352 [Listener at 0.0.0.0/39929] INFO  server.StorageContainerManager (StorageContainerManager.java:<init>(388)) - 
Container Balancer status:
Key                            Value
Running                        false
Container Balancer Configuration values:
Key                                                Value
Threshold                                          10
Max Datanodes to Involve per Iteration(percent)    20
Max Size to Move per Iteration                     500GB
Max Size Entering Target per Iteration             26GB
Max Size Leaving Source per Iteration              26GB

2022-02-21 12:57:10,352 [Listener at 0.0.0.0/39929] INFO  ha.SCMContext (SCMContext.java:updateSafeModeStatus(211)) - Update SafeModeStatus from SafeModeStatus{safeModeStatus=false, preCheckPassed=true} to SafeModeStatus{safeModeStatus=false, preCheckPassed=true}.
2022-02-21 12:57:10,353 [Listener at 0.0.0.0/39929] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(183)) - Sending CreatePipelineCommand for pipeline:PipelineID=ef926c5c-7000-4bea-a302-2814d54dede7 to datanode:1c452f9d-1fd6-4289-bd7b-1996d34dac18
2022-02-21 12:57:10,354 [Listener at 0.0.0.0/39929] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(183)) - Sending CreatePipelineCommand for pipeline:PipelineID=ef926c5c-7000-4bea-a302-2814d54dede7 to datanode:3519c8ca-0c3c-44ee-a0ec-d73cef181b7c
2022-02-21 12:57:10,354 [Listener at 0.0.0.0/39929] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(183)) - Sending CreatePipelineCommand for pipeline:PipelineID=ef926c5c-7000-4bea-a302-2814d54dede7 to datanode:c02ec61b-4ec7-4049-94f3-06cb8f2567f2
2022-02-21 12:57:10,355 [Listener at 0.0.0.0/39929] INFO  pipeline.PipelineStateManagerImpl (PipelineStateManagerImpl.java:addPipeline(101)) - Created pipeline Pipeline[ Id: ef926c5c-7000-4bea-a302-2814d54dede7, Nodes: 1c452f9d-1fd6-4289-bd7b-1996d34dac18{ip: 203.242.179.249, host: localhost-203.242.179.249, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}3519c8ca-0c3c-44ee-a0ec-d73cef181b7c{ip: 167.177.160.231, host: localhost-167.177.160.231, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}c02ec61b-4ec7-4049-94f3-06cb8f2567f2{ip: 22.28.87.192, host: localhost-22.28.87.192, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}, ReplicationConfig: RATIS/THREE, State:ALLOCATED, leaderId:, CreationTimestamp2022-02-21T12:57:10.353Z[Etc/UTC]].
2022-02-21 12:57:10,355 [Listener at 0.0.0.0/39929] INFO  pipeline.PipelineManagerImpl (PipelineManagerImpl.java:openPipeline(291)) - Pipeline Pipeline[ Id: ef926c5c-7000-4bea-a302-2814d54dede7, Nodes: 1c452f9d-1fd6-4289-bd7b-1996d34dac18{ip: 203.242.179.249, host: localhost-203.242.179.249, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}3519c8ca-0c3c-44ee-a0ec-d73cef181b7c{ip: 167.177.160.231, host: localhost-167.177.160.231, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}c02ec61b-4ec7-4049-94f3-06cb8f2567f2{ip: 22.28.87.192, host: localhost-22.28.87.192, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}, ReplicationConfig: RATIS/THREE, State:ALLOCATED, leaderId:, CreationTimestamp2022-02-21T12:57:10.353Z[Etc/UTC]] moved to OPEN state
2022-02-21 12:57:10,356 [Listener at 0.0.0.0/39929] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:getNextId(127)) - Allocate a batch for containerId, change lastId from 0 to 1000.
2022-02-21 12:57:10,357 [Listener at 0.0.0.0/39929] WARN  ha.SequenceIdGenerator (SequenceIdGenerator.java:allocateBatch(235)) - Failed to allocate a batch for localId, expected lastId is 0, actual lastId is 109611004723200000.
2022-02-21 12:57:10,357 [Listener at 0.0.0.0/39929] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:getNextId(127)) - Allocate a batch for localId, change lastId from 109611004723200000 to 109611004723201000.
2022-02-21 12:57:10,357 [Listener at 0.0.0.0/39929] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1390)) - Stopping Container Balancer service.
2022-02-21 12:57:10,357 [Listener at 0.0.0.0/39929] INFO  balancer.ContainerBalancer (ContainerBalancer.java:stop(751)) - Container Balancer is not running.
2022-02-21 12:57:10,357 [Listener at 0.0.0.0/39929] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1397)) - Stopping Replication Manager Service.
2022-02-21 12:57:10,357 [Listener at 0.0.0.0/39929] INFO  container.ReplicationManager (ReplicationManager.java:stop(357)) - Stopping Replication Monitor Thread.
2022-02-21 12:57:10,358 [Listener at 0.0.0.0/39929] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1404)) - Stopping the Datanode Admin Monitor.
2022-02-21 12:57:10,359 [Listener at 0.0.0.0/39929] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1411)) - Stopping Lease Manager of the command watchers
2022-02-21 12:57:10,359 [Listener at 0.0.0.0/39929] ERROR server.StorageContainerManager (StorageContainerManager.java:stop(1414)) - Lease Manager of the command watchers stop failed
2022-02-21 12:57:10,359 [Listener at 0.0.0.0/39929] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1418)) - Stopping datanode service RPC server
2022-02-21 12:57:10,359 [Listener at 0.0.0.0/39929] INFO  server.SCMDatanodeProtocolServer (SCMDatanodeProtocolServer.java:stop(390)) - Stopping the RPC server for DataNodes
2022-02-21 12:57:10,359 [Listener at 0.0.0.0/39929] INFO  ipc.Server (Server.java:stop(3414)) - Stopping server on 41947
2022-02-21 12:57:10,360 [Listener at 0.0.0.0/39929] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1426)) - Stopping block service RPC server
2022-02-21 12:57:10,360 [Listener at 0.0.0.0/39929] INFO  server.SCMBlockProtocolServer (SCMBlockProtocolServer.java:stop(160)) - Stopping the RPC server for Block Protocol
2022-02-21 12:57:10,360 [Listener at 0.0.0.0/39929] INFO  ipc.Server (Server.java:stop(3414)) - Stopping server on 43549
2022-02-21 12:57:10,360 [Listener at 0.0.0.0/39929] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1433)) - Stopping the StorageContainerLocationProtocol RPC server
2022-02-21 12:57:10,360 [Listener at 0.0.0.0/39929] INFO  server.SCMClientProtocolServer (SCMClientProtocolServer.java:stop(174)) - Stopping the RPC server for Client Protocol
2022-02-21 12:57:10,361 [Listener at 0.0.0.0/39929] INFO  ipc.Server (Server.java:stop(3414)) - Stopping server on 39929
2022-02-21 12:57:10,361 [Listener at 0.0.0.0/39929] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1440)) - Stopping Storage Container Manager HTTP server.
2022-02-21 12:57:10,361 [Listener at 0.0.0.0/39929] ERROR server.StorageContainerManager (StorageContainerManager.java:stop(1443)) - Storage Container Manager HTTP server stop failed.
java.lang.NullPointerException
	at org.apache.hadoop.hdds.scm.server.StorageContainerManager.stop(StorageContainerManager.java:1441)
	at org.apache.hadoop.hdds.scm.block.TestBlockManager.cleanup(TestBlockManager.java:192)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.RunAfters.invokeMethod(RunAfters.java:46)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:33)
	at org.junit.rules.ExternalResource$1.evaluate(ExternalResource.java:54)
	at org.junit.rules.ExpectedException$ExpectedExceptionStatement.evaluate(ExpectedException.java:258)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115)
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Iterator.forEachRemaining(Iterator.java:116)
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485)
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82)
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:108)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:88)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.lambda$execute$0(EngineExecutionOrchestrator.java:54)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.withInterceptedStreams(EngineExecutionOrchestrator.java:67)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:52)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:96)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:75)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:142)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:113)
	at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:384)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:345)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:126)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:418)
2022-02-21 12:57:10,362 [Listener at 0.0.0.0/39929] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1451)) - Stopping Block Manager Service.
2022-02-21 12:57:10,362 [Listener at 0.0.0.0/39929] INFO  utils.BackgroundService (BackgroundService.java:shutdown(132)) - Shutting down service SCMBlockDeletingService
2022-02-21 12:57:10,362 [Listener at 0.0.0.0/39929] INFO  utils.BackgroundService (BackgroundService.java:shutdown(132)) - Shutting down service SCMBlockDeletingService
2022-02-21 12:57:10,362 [Listener at 0.0.0.0/39929] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1478)) - Stopping SCM Event Queue.
2022-02-21 12:57:10,363 [Listener at 0.0.0.0/39929] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1489)) - Stopping SCM HA services.
2022-02-21 12:57:10,363 [Listener at 0.0.0.0/39929] INFO  pipeline.BackgroundPipelineCreator (BackgroundPipelineCreator.java:stop(158)) - Stopping RatisPipelineUtilsThread.
2022-02-21 12:57:10,363 [Listener at 0.0.0.0/39929] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1499)) - Stopping SCM MetadataStore.
2022-02-21 12:57:10,388 [Listener at 0.0.0.0/39929] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchemaFromFile(129)) - Loading schema from [file:/home/runner/work/ozone/ozone/hadoop-hdds/common/target/classes/network-topology-default.xml]
2022-02-21 12:57:10,388 [Listener at 0.0.0.0/39929] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchema(176)) - Loading network topology layer schema file
2022-02-21 12:57:10,400 [Listener at 0.0.0.0/39929] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchemaFromFile(129)) - Loading schema from [file:/home/runner/work/ozone/ozone/hadoop-hdds/common/target/classes/network-topology-default.xml]
2022-02-21 12:57:10,400 [Listener at 0.0.0.0/39929] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchema(176)) - Loading network topology layer schema file
2022-02-21 12:57:10,401 [Listener at 0.0.0.0/39929] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/7fd259b0-e5ec-4307-abc8-ba5bb7a5e18e
2022-02-21 12:57:10,401 [Listener at 0.0.0.0/39929] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/b353c879-2db9-418f-8259-6b28e6357e53
2022-02-21 12:57:10,402 [Listener at 0.0.0.0/39929] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/3a295d58-9962-4c42-af8e-4bea4dbb50d9
2022-02-21 12:57:10,402 [Listener at 0.0.0.0/39929] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/fdd1d5cc-21f2-46f2-ae92-ab9b98108625
2022-02-21 12:57:10,402 [Listener at 0.0.0.0/39929] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/5068b6a1-3722-4b14-bda8-9cfb54612cd0
2022-02-21 12:57:10,402 [Listener at 0.0.0.0/39929] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/195c839e-b15b-4e69-a804-34e6d3655c63
2022-02-21 12:57:10,402 [Listener at 0.0.0.0/39929] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/67031aea-0894-4930-bec3-d29698132699
2022-02-21 12:57:10,403 [Listener at 0.0.0.0/39929] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/5277bce7-b4be-412c-aee8-ec6dc11fa706
2022-02-21 12:57:10,403 [Listener at 0.0.0.0/39929] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/ce96c25d-eec2-4c6e-949b-4bdad3325dd2
2022-02-21 12:57:10,403 [Listener at 0.0.0.0/39929] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/e1346df3-6d50-4b70-9707-418f20fba0b5
2022-02-21 12:57:10,403 [Listener at 0.0.0.0/39929] WARN  utils.HAUtils (HAUtils.java:getMetaDir(342)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2022-02-21 12:57:10,404 [Listener at 0.0.0.0/39929] WARN  db.DBStoreBuilder (DBStoreBuilder.java:applyDBDefinition(145)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2022-02-21 12:57:10,494 [Listener at 0.0.0.0/39929] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:<init>(218)) - Init the HA SequenceIdGenerator.
2022-02-21 12:57:10,494 [Listener at 0.0.0.0/39929] INFO  pipeline.PipelineStateManagerImpl (PipelineStateManagerImpl.java:initialize(78)) - No pipeline exists in current db
2022-02-21 12:57:10,495 [Listener at 0.0.0.0/39929] INFO  algorithms.LeaderChoosePolicyFactory (LeaderChoosePolicyFactory.java:getPolicy(57)) - Create leader choose policy of type org.apache.hadoop.hdds.scm.pipeline.leader.choose.algorithms.MinLeaderCountChoosePolicy
2022-02-21 12:57:10,495 [Listener at 0.0.0.0/39929] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service BackgroundPipelineCreator.
2022-02-21 12:57:10,495 [Listener at 0.0.0.0/39929] INFO  pipeline.BackgroundPipelineCreator (BackgroundPipelineCreator.java:start(130)) - Starting RatisPipelineUtilsThread.
2022-02-21 12:57:10,496 [Listener at 0.0.0.0/39929] INFO  algorithms.LeaderChoosePolicyFactory (LeaderChoosePolicyFactory.java:getPolicy(57)) - Create leader choose policy of type org.apache.hadoop.hdds.scm.pipeline.leader.choose.algorithms.MinLeaderCountChoosePolicy
2022-02-21 12:57:10,497 [Listener at 0.0.0.0/39929] INFO  safemode.ContainerSafeModeRule (ContainerSafeModeRule.java:<init>(89)) - containers with one replica threshold count 0
2022-02-21 12:57:10,497 [Listener at 0.0.0.0/39929] INFO  safemode.HealthyPipelineSafeModeRule (HealthyPipelineSafeModeRule.java:initializeRule(156)) - Total pipeline count is 0, healthy pipeline threshold count is 0
2022-02-21 12:57:10,497 [Listener at 0.0.0.0/39929] INFO  safemode.OneReplicaPipelineSafeModeRule (OneReplicaPipelineSafeModeRule.java:initializeRule(180)) - Total pipeline count is 0, pipeline's with at least one datanode reported threshold count is 0
2022-02-21 12:57:10,498 [Listener at 0.0.0.0/39929] WARN  server.ServerUtils (ServerUtils.java:getScmDbDir(148)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2022-02-21 12:57:10,499 [Listener at 0.0.0.0/39929] INFO  ha.SCMHANodeDetails (SCMHANodeDetails.java:loadSCMHAConfig(157)) - ServiceID for StorageContainerManager is null
2022-02-21 12:57:10,499 [Listener at 0.0.0.0/39929] INFO  ha.SCMHANodeDetails (SCMHANodeDetails.java:loadSCMHAConfig(162)) - ozone.scm.default.service.id is not defined, falling back to ozone.scm.service.ids to find serviceID for StorageContainerManager if it is HA enabled cluster
2022-02-21 12:57:10,500 [Listener at 0.0.0.0/39929] WARN  server.ServerUtils (ServerUtils.java:getScmDbDir(148)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2022-02-21 12:57:10,500 [Listener at 0.0.0.0/39929] INFO  upgrade.AbstractLayoutVersionManager (AbstractLayoutVersionManager.java:init(79)) - Initializing Layout version manager with metadata layout = SCM_HA (version = 2), software layout = SCM_HA (version = 2)
2022-02-21 12:57:10,501 [Listener at 0.0.0.0/39929] WARN  util.MBeans (MBeans.java:getMBeanName(167)) - Error creating MBean object name: Hadoop:service=LayoutVersionManager,name=HDDSLayoutVersionManager
org.apache.hadoop.metrics2.MetricsException: org.apache.hadoop.metrics2.MetricsException: Hadoop:service=LayoutVersionManager,name=HDDSLayoutVersionManager already exists!
	at org.apache.hadoop.metrics2.lib.DefaultMetricsSystem.newObjectName(DefaultMetricsSystem.java:135)
	at org.apache.hadoop.metrics2.lib.DefaultMetricsSystem.newMBeanName(DefaultMetricsSystem.java:110)
	at org.apache.hadoop.metrics2.util.MBeans.getMBeanName(MBeans.java:165)
	at org.apache.hadoop.metrics2.util.MBeans.register(MBeans.java:97)
	at org.apache.hadoop.metrics2.util.MBeans.register(MBeans.java:73)
	at org.apache.hadoop.ozone.upgrade.AbstractLayoutVersionManager.init(AbstractLayoutVersionManager.java:84)
	at org.apache.hadoop.hdds.upgrade.HDDSLayoutVersionManager.<init>(HDDSLayoutVersionManager.java:50)
	at org.apache.hadoop.hdds.scm.server.StorageContainerManager.<init>(StorageContainerManager.java:326)
	at org.apache.hadoop.hdds.scm.server.StorageContainerManager.createSCM(StorageContainerManager.java:491)
	at org.apache.hadoop.hdds.scm.HddsTestUtils.getScm(HddsTestUtils.java:624)
	at org.apache.hadoop.hdds.scm.block.TestBlockManager.setUp(TestBlockManager.java:175)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.RunBefores.invokeMethod(RunBefores.java:33)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:24)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.rules.ExternalResource$1.evaluate(ExternalResource.java:54)
	at org.junit.rules.ExpectedException$ExpectedExceptionStatement.evaluate(ExpectedException.java:258)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115)
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Iterator.forEachRemaining(Iterator.java:116)
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485)
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82)
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:108)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:88)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.lambda$execute$0(EngineExecutionOrchestrator.java:54)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.withInterceptedStreams(EngineExecutionOrchestrator.java:67)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:52)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:96)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:75)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:142)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:113)
	at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:384)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:345)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:126)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:418)
Caused by: org.apache.hadoop.metrics2.MetricsException: Hadoop:service=LayoutVersionManager,name=HDDSLayoutVersionManager already exists!
	at org.apache.hadoop.metrics2.lib.DefaultMetricsSystem.newObjectName(DefaultMetricsSystem.java:131)
	... 62 more
2022-02-21 12:57:10,535 [Listener at 0.0.0.0/39929] INFO  reflections.Reflections (Reflections.java:scan(232)) - Reflections took 32 ms to scan 6 urls, producing 119 keys and 272 values 
2022-02-21 12:57:10,536 [Listener at 0.0.0.0/39929] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchemaFromFile(129)) - Loading schema from [file:/home/runner/work/ozone/ozone/hadoop-hdds/common/target/classes/network-topology-default.xml]
2022-02-21 12:57:10,536 [Listener at 0.0.0.0/39929] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchema(176)) - Loading network topology layer schema file
2022-02-21 12:57:10,538 [Listener at 0.0.0.0/39929] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:upgradeToSequenceId(347)) - upgrade localId to 109611004723200000
2022-02-21 12:57:10,539 [Listener at 0.0.0.0/39929] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:upgradeToSequenceId(357)) - upgrade delTxnId to 0
2022-02-21 12:57:10,539 [Listener at 0.0.0.0/39929] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:upgradeToSequenceId(371)) - upgrade containerId to 0
2022-02-21 12:57:10,539 [Listener at 0.0.0.0/39929] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:<init>(218)) - Init the HA SequenceIdGenerator.
2022-02-21 12:57:10,539 [Listener at 0.0.0.0/39929] INFO  algorithms.ContainerPlacementPolicyFactory (ContainerPlacementPolicyFactory.java:getPolicy(60)) - Create container placement policy of type org.apache.hadoop.hdds.scm.container.placement.algorithms.SCMContainerPlacementRandom
2022-02-21 12:57:10,540 [Listener at 0.0.0.0/39929] INFO  algorithms.PipelineChoosePolicyFactory (PipelineChoosePolicyFactory.java:createPipelineChoosePolicyFromClass(73)) - Create pipeline choose policy of type org.apache.hadoop.hdds.scm.pipeline.choose.algorithms.RandomPipelineChoosePolicy
2022-02-21 12:57:10,540 [Listener at 0.0.0.0/39929] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service SCMBlockDeletingService.
2022-02-21 12:57:10,541 [Listener at 0.0.0.0/39929] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service ReplicationManager.
2022-02-21 12:57:10,541 [Listener at 0.0.0.0/39929] INFO  container.ReplicationManager (ReplicationManager.java:start(326)) - Starting Replication Monitor Thread.
2022-02-21 12:57:10,551 [Listener at 0.0.0.0/39929] INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(90)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 10000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false.
2022-02-21 12:57:10,553 [ReplicationMonitor] INFO  container.ReplicationManager (ReplicationManager.java:processAll(374)) - Replication Manager is not ready to run until 300000ms after safemode exit
2022-02-21 12:57:10,553 [Socket Reader #1 for port 0] INFO  ipc.Server (Server.java:run(1265)) - Starting Socket Reader #1 for port 0
2022-02-21 12:57:10,559 [Listener at 0.0.0.0/43767] INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(90)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 10000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false.
2022-02-21 12:57:10,559 [Socket Reader #1 for port 0] INFO  ipc.Server (Server.java:run(1265)) - Starting Socket Reader #1 for port 0
2022-02-21 12:57:10,560 [Listener at 0.0.0.0/33579] INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(90)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 10000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false.
2022-02-21 12:57:10,561 [Socket Reader #1 for port 0] INFO  ipc.Server (Server.java:run(1265)) - Starting Socket Reader #1 for port 0
2022-02-21 12:57:10,573 [Listener at 0.0.0.0/35203] INFO  algorithms.ContainerPlacementPolicyFactory (ContainerPlacementPolicyFactory.java:getPolicy(60)) - Create container placement policy of type org.apache.hadoop.hdds.scm.container.placement.algorithms.SCMContainerPlacementRandom
2022-02-21 12:57:10,573 [Listener at 0.0.0.0/35203] INFO  server.StorageContainerManager (StorageContainerManager.java:<init>(388)) - 
Container Balancer status:
Key                            Value
Running                        false
Container Balancer Configuration values:
Key                                                Value
Threshold                                          10
Max Datanodes to Involve per Iteration(percent)    20
Max Size to Move per Iteration                     500GB
Max Size Entering Target per Iteration             26GB
Max Size Leaving Source per Iteration              26GB

2022-02-21 12:57:10,574 [Listener at 0.0.0.0/35203] INFO  ha.SCMContext (SCMContext.java:updateSafeModeStatus(211)) - Update SafeModeStatus from SafeModeStatus{safeModeStatus=false, preCheckPassed=true} to SafeModeStatus{safeModeStatus=false, preCheckPassed=true}.
2022-02-21 12:57:10,575 [Listener at 0.0.0.0/35203] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(183)) - Sending CreatePipelineCommand for pipeline:PipelineID=b66541ca-7daa-480d-a77f-30d03d38a88a to datanode:5068b6a1-3722-4b14-bda8-9cfb54612cd0
2022-02-21 12:57:10,575 [Listener at 0.0.0.0/35203] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(183)) - Sending CreatePipelineCommand for pipeline:PipelineID=b66541ca-7daa-480d-a77f-30d03d38a88a to datanode:195c839e-b15b-4e69-a804-34e6d3655c63
2022-02-21 12:57:10,575 [Listener at 0.0.0.0/35203] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(183)) - Sending CreatePipelineCommand for pipeline:PipelineID=b66541ca-7daa-480d-a77f-30d03d38a88a to datanode:5277bce7-b4be-412c-aee8-ec6dc11fa706
2022-02-21 12:57:10,576 [Listener at 0.0.0.0/35203] INFO  pipeline.PipelineStateManagerImpl (PipelineStateManagerImpl.java:addPipeline(101)) - Created pipeline Pipeline[ Id: b66541ca-7daa-480d-a77f-30d03d38a88a, Nodes: 5068b6a1-3722-4b14-bda8-9cfb54612cd0{ip: 125.53.11.58, host: localhost-125.53.11.58, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}195c839e-b15b-4e69-a804-34e6d3655c63{ip: 143.117.40.44, host: localhost-143.117.40.44, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}5277bce7-b4be-412c-aee8-ec6dc11fa706{ip: 108.155.8.59, host: localhost-108.155.8.59, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}, ReplicationConfig: RATIS/THREE, State:ALLOCATED, leaderId:, CreationTimestamp2022-02-21T12:57:10.575Z[Etc/UTC]].
2022-02-21 12:57:10,576 [Listener at 0.0.0.0/35203] INFO  pipeline.PipelineManagerImpl (PipelineManagerImpl.java:openPipeline(291)) - Pipeline Pipeline[ Id: b66541ca-7daa-480d-a77f-30d03d38a88a, Nodes: 5068b6a1-3722-4b14-bda8-9cfb54612cd0{ip: 125.53.11.58, host: localhost-125.53.11.58, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}195c839e-b15b-4e69-a804-34e6d3655c63{ip: 143.117.40.44, host: localhost-143.117.40.44, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}5277bce7-b4be-412c-aee8-ec6dc11fa706{ip: 108.155.8.59, host: localhost-108.155.8.59, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}, ReplicationConfig: RATIS/THREE, State:ALLOCATED, leaderId:, CreationTimestamp2022-02-21T12:57:10.575Z[Etc/UTC]] moved to OPEN state
2022-02-21 12:57:10,578 [pool-171-thread-1] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:getNextId(127)) - Allocate a batch for containerId, change lastId from 0 to 1000.
2022-02-21 12:57:10,579 [pool-171-thread-1] WARN  ha.SequenceIdGenerator (SequenceIdGenerator.java:allocateBatch(235)) - Failed to allocate a batch for localId, expected lastId is 0, actual lastId is 109611004723200000.
2022-02-21 12:57:10,579 [pool-171-thread-1] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:getNextId(127)) - Allocate a batch for localId, change lastId from 109611004723200000 to 109611004723201000.
2022-02-21 12:57:10,590 [Listener at 0.0.0.0/35203] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1390)) - Stopping Container Balancer service.
2022-02-21 12:57:10,591 [Listener at 0.0.0.0/35203] INFO  balancer.ContainerBalancer (ContainerBalancer.java:stop(751)) - Container Balancer is not running.
2022-02-21 12:57:10,591 [Listener at 0.0.0.0/35203] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1397)) - Stopping Replication Manager Service.
2022-02-21 12:57:10,591 [Listener at 0.0.0.0/35203] INFO  container.ReplicationManager (ReplicationManager.java:stop(357)) - Stopping Replication Monitor Thread.
2022-02-21 12:57:10,591 [Listener at 0.0.0.0/35203] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1404)) - Stopping the Datanode Admin Monitor.
2022-02-21 12:57:10,591 [Listener at 0.0.0.0/35203] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1411)) - Stopping Lease Manager of the command watchers
2022-02-21 12:57:10,591 [Listener at 0.0.0.0/35203] ERROR server.StorageContainerManager (StorageContainerManager.java:stop(1414)) - Lease Manager of the command watchers stop failed
2022-02-21 12:57:10,591 [Listener at 0.0.0.0/35203] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1418)) - Stopping datanode service RPC server
2022-02-21 12:57:10,592 [Listener at 0.0.0.0/35203] INFO  server.SCMDatanodeProtocolServer (SCMDatanodeProtocolServer.java:stop(390)) - Stopping the RPC server for DataNodes
2022-02-21 12:57:10,592 [Listener at 0.0.0.0/35203] INFO  ipc.Server (Server.java:stop(3414)) - Stopping server on 43767
2022-02-21 12:57:10,592 [Listener at 0.0.0.0/35203] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1426)) - Stopping block service RPC server
2022-02-21 12:57:10,592 [Listener at 0.0.0.0/35203] INFO  server.SCMBlockProtocolServer (SCMBlockProtocolServer.java:stop(160)) - Stopping the RPC server for Block Protocol
2022-02-21 12:57:10,592 [Listener at 0.0.0.0/35203] INFO  ipc.Server (Server.java:stop(3414)) - Stopping server on 33579
2022-02-21 12:57:10,593 [Listener at 0.0.0.0/35203] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1433)) - Stopping the StorageContainerLocationProtocol RPC server
2022-02-21 12:57:10,593 [Listener at 0.0.0.0/35203] INFO  server.SCMClientProtocolServer (SCMClientProtocolServer.java:stop(174)) - Stopping the RPC server for Client Protocol
2022-02-21 12:57:10,593 [Listener at 0.0.0.0/35203] INFO  ipc.Server (Server.java:stop(3414)) - Stopping server on 35203
2022-02-21 12:57:10,593 [Listener at 0.0.0.0/35203] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1440)) - Stopping Storage Container Manager HTTP server.
2022-02-21 12:57:10,593 [Listener at 0.0.0.0/35203] ERROR server.StorageContainerManager (StorageContainerManager.java:stop(1443)) - Storage Container Manager HTTP server stop failed.
java.lang.NullPointerException
	at org.apache.hadoop.hdds.scm.server.StorageContainerManager.stop(StorageContainerManager.java:1441)
	at org.apache.hadoop.hdds.scm.block.TestBlockManager.cleanup(TestBlockManager.java:192)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.RunAfters.invokeMethod(RunAfters.java:46)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:33)
	at org.junit.rules.ExternalResource$1.evaluate(ExternalResource.java:54)
	at org.junit.rules.ExpectedException$ExpectedExceptionStatement.evaluate(ExpectedException.java:258)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115)
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Iterator.forEachRemaining(Iterator.java:116)
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485)
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82)
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:108)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:88)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.lambda$execute$0(EngineExecutionOrchestrator.java:54)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.withInterceptedStreams(EngineExecutionOrchestrator.java:67)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:52)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:96)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:75)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:142)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:113)
	at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:384)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:345)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:126)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:418)
2022-02-21 12:57:10,594 [Listener at 0.0.0.0/35203] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1451)) - Stopping Block Manager Service.
2022-02-21 12:57:10,594 [Listener at 0.0.0.0/35203] INFO  utils.BackgroundService (BackgroundService.java:shutdown(132)) - Shutting down service SCMBlockDeletingService
2022-02-21 12:57:10,594 [Listener at 0.0.0.0/35203] INFO  utils.BackgroundService (BackgroundService.java:shutdown(132)) - Shutting down service SCMBlockDeletingService
2022-02-21 12:57:10,594 [Listener at 0.0.0.0/35203] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1478)) - Stopping SCM Event Queue.
2022-02-21 12:57:10,594 [Listener at 0.0.0.0/35203] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1489)) - Stopping SCM HA services.
2022-02-21 12:57:10,594 [Listener at 0.0.0.0/35203] INFO  pipeline.BackgroundPipelineCreator (BackgroundPipelineCreator.java:stop(158)) - Stopping RatisPipelineUtilsThread.
2022-02-21 12:57:10,598 [Listener at 0.0.0.0/35203] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1499)) - Stopping SCM MetadataStore.
2022-02-21 12:57:10,620 [Listener at 0.0.0.0/35203] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchemaFromFile(129)) - Loading schema from [file:/home/runner/work/ozone/ozone/hadoop-hdds/common/target/classes/network-topology-default.xml]
2022-02-21 12:57:10,620 [Listener at 0.0.0.0/35203] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchema(176)) - Loading network topology layer schema file
2022-02-21 12:57:10,631 [Listener at 0.0.0.0/35203] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchemaFromFile(129)) - Loading schema from [file:/home/runner/work/ozone/ozone/hadoop-hdds/common/target/classes/network-topology-default.xml]
2022-02-21 12:57:10,631 [Listener at 0.0.0.0/35203] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchema(176)) - Loading network topology layer schema file
2022-02-21 12:57:10,632 [Listener at 0.0.0.0/35203] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/48641fdf-a682-4431-8156-255d4cf00b8a
2022-02-21 12:57:10,632 [Listener at 0.0.0.0/35203] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/641fb300-590f-4718-ac21-f7853ace39b5
2022-02-21 12:57:10,633 [Listener at 0.0.0.0/35203] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/297bcc55-1a0a-4643-9dad-dd9921ad0fab
2022-02-21 12:57:10,633 [Listener at 0.0.0.0/35203] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/13a19efe-9290-4f5f-b5c5-606f91b4b2f8
2022-02-21 12:57:10,633 [Listener at 0.0.0.0/35203] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/f491cb08-3fb9-468a-9401-6aff8b626e47
2022-02-21 12:57:10,633 [Listener at 0.0.0.0/35203] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/f7585a67-bbd1-4bbe-a406-fb66443dd889
2022-02-21 12:57:10,633 [Listener at 0.0.0.0/35203] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/20dc2440-45be-45e5-9eaf-9351b631d37d
2022-02-21 12:57:10,634 [Listener at 0.0.0.0/35203] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/6808f13f-2219-4530-89c5-9dd144b7faa6
2022-02-21 12:57:10,634 [Listener at 0.0.0.0/35203] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/34da87b1-356e-4c0f-8b38-ffd3e4410b35
2022-02-21 12:57:10,634 [Listener at 0.0.0.0/35203] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/c3a22fc4-5b18-4bd7-922e-b22de5a7201f
2022-02-21 12:57:10,634 [Listener at 0.0.0.0/35203] WARN  utils.HAUtils (HAUtils.java:getMetaDir(342)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2022-02-21 12:57:10,635 [Listener at 0.0.0.0/35203] WARN  db.DBStoreBuilder (DBStoreBuilder.java:applyDBDefinition(145)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2022-02-21 12:57:10,730 [Listener at 0.0.0.0/35203] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:<init>(218)) - Init the HA SequenceIdGenerator.
2022-02-21 12:57:10,731 [Listener at 0.0.0.0/35203] INFO  pipeline.PipelineStateManagerImpl (PipelineStateManagerImpl.java:initialize(78)) - No pipeline exists in current db
2022-02-21 12:57:10,731 [Listener at 0.0.0.0/35203] INFO  algorithms.LeaderChoosePolicyFactory (LeaderChoosePolicyFactory.java:getPolicy(57)) - Create leader choose policy of type org.apache.hadoop.hdds.scm.pipeline.leader.choose.algorithms.MinLeaderCountChoosePolicy
2022-02-21 12:57:10,732 [Listener at 0.0.0.0/35203] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service BackgroundPipelineCreator.
2022-02-21 12:57:10,732 [Listener at 0.0.0.0/35203] INFO  pipeline.BackgroundPipelineCreator (BackgroundPipelineCreator.java:start(130)) - Starting RatisPipelineUtilsThread.
2022-02-21 12:57:10,733 [Listener at 0.0.0.0/35203] INFO  algorithms.LeaderChoosePolicyFactory (LeaderChoosePolicyFactory.java:getPolicy(57)) - Create leader choose policy of type org.apache.hadoop.hdds.scm.pipeline.leader.choose.algorithms.MinLeaderCountChoosePolicy
2022-02-21 12:57:10,734 [Listener at 0.0.0.0/35203] INFO  safemode.ContainerSafeModeRule (ContainerSafeModeRule.java:<init>(89)) - containers with one replica threshold count 0
2022-02-21 12:57:10,734 [Listener at 0.0.0.0/35203] INFO  safemode.HealthyPipelineSafeModeRule (HealthyPipelineSafeModeRule.java:initializeRule(156)) - Total pipeline count is 0, healthy pipeline threshold count is 0
2022-02-21 12:57:10,734 [Listener at 0.0.0.0/35203] INFO  safemode.OneReplicaPipelineSafeModeRule (OneReplicaPipelineSafeModeRule.java:initializeRule(180)) - Total pipeline count is 0, pipeline's with at least one datanode reported threshold count is 0
2022-02-21 12:57:10,734 [Listener at 0.0.0.0/35203] WARN  server.ServerUtils (ServerUtils.java:getScmDbDir(148)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2022-02-21 12:57:10,736 [Listener at 0.0.0.0/35203] INFO  ha.SCMHANodeDetails (SCMHANodeDetails.java:loadSCMHAConfig(157)) - ServiceID for StorageContainerManager is null
2022-02-21 12:57:10,736 [Listener at 0.0.0.0/35203] INFO  ha.SCMHANodeDetails (SCMHANodeDetails.java:loadSCMHAConfig(162)) - ozone.scm.default.service.id is not defined, falling back to ozone.scm.service.ids to find serviceID for StorageContainerManager if it is HA enabled cluster
2022-02-21 12:57:10,736 [Listener at 0.0.0.0/35203] WARN  server.ServerUtils (ServerUtils.java:getScmDbDir(148)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2022-02-21 12:57:10,737 [Listener at 0.0.0.0/35203] INFO  upgrade.AbstractLayoutVersionManager (AbstractLayoutVersionManager.java:init(79)) - Initializing Layout version manager with metadata layout = SCM_HA (version = 2), software layout = SCM_HA (version = 2)
2022-02-21 12:57:10,737 [Listener at 0.0.0.0/35203] WARN  util.MBeans (MBeans.java:getMBeanName(167)) - Error creating MBean object name: Hadoop:service=LayoutVersionManager,name=HDDSLayoutVersionManager
org.apache.hadoop.metrics2.MetricsException: org.apache.hadoop.metrics2.MetricsException: Hadoop:service=LayoutVersionManager,name=HDDSLayoutVersionManager already exists!
	at org.apache.hadoop.metrics2.lib.DefaultMetricsSystem.newObjectName(DefaultMetricsSystem.java:135)
	at org.apache.hadoop.metrics2.lib.DefaultMetricsSystem.newMBeanName(DefaultMetricsSystem.java:110)
	at org.apache.hadoop.metrics2.util.MBeans.getMBeanName(MBeans.java:165)
	at org.apache.hadoop.metrics2.util.MBeans.register(MBeans.java:97)
	at org.apache.hadoop.metrics2.util.MBeans.register(MBeans.java:73)
	at org.apache.hadoop.ozone.upgrade.AbstractLayoutVersionManager.init(AbstractLayoutVersionManager.java:84)
	at org.apache.hadoop.hdds.upgrade.HDDSLayoutVersionManager.<init>(HDDSLayoutVersionManager.java:50)
	at org.apache.hadoop.hdds.scm.server.StorageContainerManager.<init>(StorageContainerManager.java:326)
	at org.apache.hadoop.hdds.scm.server.StorageContainerManager.createSCM(StorageContainerManager.java:491)
	at org.apache.hadoop.hdds.scm.HddsTestUtils.getScm(HddsTestUtils.java:624)
	at org.apache.hadoop.hdds.scm.block.TestBlockManager.setUp(TestBlockManager.java:175)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.RunBefores.invokeMethod(RunBefores.java:33)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:24)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.rules.ExternalResource$1.evaluate(ExternalResource.java:54)
	at org.junit.rules.ExpectedException$ExpectedExceptionStatement.evaluate(ExpectedException.java:258)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115)
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Iterator.forEachRemaining(Iterator.java:116)
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485)
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82)
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:108)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:88)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.lambda$execute$0(EngineExecutionOrchestrator.java:54)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.withInterceptedStreams(EngineExecutionOrchestrator.java:67)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:52)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:96)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:75)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:142)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:113)
	at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:384)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:345)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:126)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:418)
Caused by: org.apache.hadoop.metrics2.MetricsException: Hadoop:service=LayoutVersionManager,name=HDDSLayoutVersionManager already exists!
	at org.apache.hadoop.metrics2.lib.DefaultMetricsSystem.newObjectName(DefaultMetricsSystem.java:131)
	... 62 more
2022-02-21 12:57:10,777 [Listener at 0.0.0.0/35203] INFO  reflections.Reflections (Reflections.java:scan(232)) - Reflections took 37 ms to scan 6 urls, producing 119 keys and 272 values 
2022-02-21 12:57:10,779 [Listener at 0.0.0.0/35203] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchemaFromFile(129)) - Loading schema from [file:/home/runner/work/ozone/ozone/hadoop-hdds/common/target/classes/network-topology-default.xml]
2022-02-21 12:57:10,779 [Listener at 0.0.0.0/35203] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchema(176)) - Loading network topology layer schema file
2022-02-21 12:57:10,781 [Listener at 0.0.0.0/35203] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:upgradeToSequenceId(347)) - upgrade localId to 109611004723200000
2022-02-21 12:57:10,781 [Listener at 0.0.0.0/35203] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:upgradeToSequenceId(357)) - upgrade delTxnId to 0
2022-02-21 12:57:10,781 [Listener at 0.0.0.0/35203] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:upgradeToSequenceId(371)) - upgrade containerId to 0
2022-02-21 12:57:10,781 [Listener at 0.0.0.0/35203] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:<init>(218)) - Init the HA SequenceIdGenerator.
2022-02-21 12:57:10,782 [Listener at 0.0.0.0/35203] INFO  algorithms.ContainerPlacementPolicyFactory (ContainerPlacementPolicyFactory.java:getPolicy(60)) - Create container placement policy of type org.apache.hadoop.hdds.scm.container.placement.algorithms.SCMContainerPlacementRandom
2022-02-21 12:57:10,782 [Listener at 0.0.0.0/35203] INFO  algorithms.PipelineChoosePolicyFactory (PipelineChoosePolicyFactory.java:createPipelineChoosePolicyFromClass(73)) - Create pipeline choose policy of type org.apache.hadoop.hdds.scm.pipeline.choose.algorithms.RandomPipelineChoosePolicy
2022-02-21 12:57:10,782 [Listener at 0.0.0.0/35203] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service SCMBlockDeletingService.
2022-02-21 12:57:10,783 [Listener at 0.0.0.0/35203] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service ReplicationManager.
2022-02-21 12:57:10,783 [Listener at 0.0.0.0/35203] INFO  container.ReplicationManager (ReplicationManager.java:start(326)) - Starting Replication Monitor Thread.
2022-02-21 12:57:10,786 [Listener at 0.0.0.0/35203] INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(90)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 10000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false.
2022-02-21 12:57:10,787 [ReplicationMonitor] INFO  container.ReplicationManager (ReplicationManager.java:processAll(374)) - Replication Manager is not ready to run until 300000ms after safemode exit
2022-02-21 12:57:10,787 [Socket Reader #1 for port 0] INFO  ipc.Server (Server.java:run(1265)) - Starting Socket Reader #1 for port 0
2022-02-21 12:57:10,788 [Listener at 0.0.0.0/36507] INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(90)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 10000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false.
2022-02-21 12:57:10,790 [Socket Reader #1 for port 0] INFO  ipc.Server (Server.java:run(1265)) - Starting Socket Reader #1 for port 0
2022-02-21 12:57:10,791 [Listener at 0.0.0.0/42909] INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(90)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 10000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false.
2022-02-21 12:57:10,795 [Socket Reader #1 for port 0] INFO  ipc.Server (Server.java:run(1265)) - Starting Socket Reader #1 for port 0
2022-02-21 12:57:10,813 [Listener at 0.0.0.0/38571] INFO  algorithms.ContainerPlacementPolicyFactory (ContainerPlacementPolicyFactory.java:getPolicy(60)) - Create container placement policy of type org.apache.hadoop.hdds.scm.container.placement.algorithms.SCMContainerPlacementRandom
2022-02-21 12:57:10,814 [Listener at 0.0.0.0/38571] INFO  server.StorageContainerManager (StorageContainerManager.java:<init>(388)) - 
Container Balancer status:
Key                            Value
Running                        false
Container Balancer Configuration values:
Key                                                Value
Threshold                                          10
Max Datanodes to Involve per Iteration(percent)    20
Max Size to Move per Iteration                     500GB
Max Size Entering Target per Iteration             26GB
Max Size Leaving Source per Iteration              26GB

2022-02-21 12:57:10,815 [Listener at 0.0.0.0/38571] INFO  ha.SCMContext (SCMContext.java:updateSafeModeStatus(211)) - Update SafeModeStatus from SafeModeStatus{safeModeStatus=false, preCheckPassed=true} to SafeModeStatus{safeModeStatus=false, preCheckPassed=true}.
2022-02-21 12:57:10,816 [Listener at 0.0.0.0/38571] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(183)) - Sending CreatePipelineCommand for pipeline:PipelineID=9cf0fb14-0d22-4896-bf2b-a897be237b8d to datanode:297bcc55-1a0a-4643-9dad-dd9921ad0fab
2022-02-21 12:57:10,817 [Listener at 0.0.0.0/38571] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(183)) - Sending CreatePipelineCommand for pipeline:PipelineID=9cf0fb14-0d22-4896-bf2b-a897be237b8d to datanode:641fb300-590f-4718-ac21-f7853ace39b5
2022-02-21 12:57:10,817 [Listener at 0.0.0.0/38571] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(183)) - Sending CreatePipelineCommand for pipeline:PipelineID=9cf0fb14-0d22-4896-bf2b-a897be237b8d to datanode:13a19efe-9290-4f5f-b5c5-606f91b4b2f8
2022-02-21 12:57:10,818 [Listener at 0.0.0.0/38571] INFO  pipeline.PipelineStateManagerImpl (PipelineStateManagerImpl.java:addPipeline(101)) - Created pipeline Pipeline[ Id: 9cf0fb14-0d22-4896-bf2b-a897be237b8d, Nodes: 297bcc55-1a0a-4643-9dad-dd9921ad0fab{ip: 163.86.220.17, host: localhost-163.86.220.17, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}641fb300-590f-4718-ac21-f7853ace39b5{ip: 114.79.73.105, host: localhost-114.79.73.105, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}13a19efe-9290-4f5f-b5c5-606f91b4b2f8{ip: 201.62.54.114, host: localhost-201.62.54.114, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}, ReplicationConfig: RATIS/THREE, State:ALLOCATED, leaderId:, CreationTimestamp2022-02-21T12:57:10.816Z[Etc/UTC]].
2022-02-21 12:57:10,818 [Listener at 0.0.0.0/38571] INFO  pipeline.PipelineManagerImpl (PipelineManagerImpl.java:openPipeline(291)) - Pipeline Pipeline[ Id: 9cf0fb14-0d22-4896-bf2b-a897be237b8d, Nodes: 297bcc55-1a0a-4643-9dad-dd9921ad0fab{ip: 163.86.220.17, host: localhost-163.86.220.17, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}641fb300-590f-4718-ac21-f7853ace39b5{ip: 114.79.73.105, host: localhost-114.79.73.105, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}13a19efe-9290-4f5f-b5c5-606f91b4b2f8{ip: 201.62.54.114, host: localhost-201.62.54.114, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}, ReplicationConfig: RATIS/THREE, State:ALLOCATED, leaderId:, CreationTimestamp2022-02-21T12:57:10.816Z[Etc/UTC]] moved to OPEN state
2022-02-21 12:57:10,821 [pool-194-thread-1] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:getNextId(127)) - Allocate a batch for containerId, change lastId from 0 to 1000.
2022-02-21 12:57:10,823 [pool-194-thread-1] WARN  ha.SequenceIdGenerator (SequenceIdGenerator.java:allocateBatch(235)) - Failed to allocate a batch for localId, expected lastId is 0, actual lastId is 109611004723200000.
2022-02-21 12:57:10,825 [pool-194-thread-1] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:getNextId(127)) - Allocate a batch for localId, change lastId from 109611004723200000 to 109611004723201000.
2022-02-21 12:57:10,836 [Listener at 0.0.0.0/38571] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1390)) - Stopping Container Balancer service.
2022-02-21 12:57:10,836 [Listener at 0.0.0.0/38571] INFO  balancer.ContainerBalancer (ContainerBalancer.java:stop(751)) - Container Balancer is not running.
2022-02-21 12:57:10,836 [Listener at 0.0.0.0/38571] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1397)) - Stopping Replication Manager Service.
2022-02-21 12:57:10,836 [Listener at 0.0.0.0/38571] INFO  container.ReplicationManager (ReplicationManager.java:stop(357)) - Stopping Replication Monitor Thread.
2022-02-21 12:57:10,836 [Listener at 0.0.0.0/38571] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1404)) - Stopping the Datanode Admin Monitor.
2022-02-21 12:57:10,837 [Listener at 0.0.0.0/38571] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1411)) - Stopping Lease Manager of the command watchers
2022-02-21 12:57:10,837 [Listener at 0.0.0.0/38571] ERROR server.StorageContainerManager (StorageContainerManager.java:stop(1414)) - Lease Manager of the command watchers stop failed
2022-02-21 12:57:10,837 [Listener at 0.0.0.0/38571] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1418)) - Stopping datanode service RPC server
2022-02-21 12:57:10,838 [Listener at 0.0.0.0/38571] INFO  server.SCMDatanodeProtocolServer (SCMDatanodeProtocolServer.java:stop(390)) - Stopping the RPC server for DataNodes
2022-02-21 12:57:10,838 [Listener at 0.0.0.0/38571] INFO  ipc.Server (Server.java:stop(3414)) - Stopping server on 36507
2022-02-21 12:57:10,838 [Listener at 0.0.0.0/38571] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1426)) - Stopping block service RPC server
2022-02-21 12:57:10,839 [Listener at 0.0.0.0/38571] INFO  server.SCMBlockProtocolServer (SCMBlockProtocolServer.java:stop(160)) - Stopping the RPC server for Block Protocol
2022-02-21 12:57:10,839 [Listener at 0.0.0.0/38571] INFO  ipc.Server (Server.java:stop(3414)) - Stopping server on 42909
2022-02-21 12:57:10,839 [Listener at 0.0.0.0/38571] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1433)) - Stopping the StorageContainerLocationProtocol RPC server
2022-02-21 12:57:10,839 [Listener at 0.0.0.0/38571] INFO  server.SCMClientProtocolServer (SCMClientProtocolServer.java:stop(174)) - Stopping the RPC server for Client Protocol
2022-02-21 12:57:10,840 [Listener at 0.0.0.0/38571] INFO  ipc.Server (Server.java:stop(3414)) - Stopping server on 38571
2022-02-21 12:57:10,840 [Listener at 0.0.0.0/38571] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1440)) - Stopping Storage Container Manager HTTP server.
2022-02-21 12:57:10,840 [Listener at 0.0.0.0/38571] ERROR server.StorageContainerManager (StorageContainerManager.java:stop(1443)) - Storage Container Manager HTTP server stop failed.
java.lang.NullPointerException
	at org.apache.hadoop.hdds.scm.server.StorageContainerManager.stop(StorageContainerManager.java:1441)
	at org.apache.hadoop.hdds.scm.block.TestBlockManager.cleanup(TestBlockManager.java:192)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.RunAfters.invokeMethod(RunAfters.java:46)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:33)
	at org.junit.rules.ExternalResource$1.evaluate(ExternalResource.java:54)
	at org.junit.rules.ExpectedException$ExpectedExceptionStatement.evaluate(ExpectedException.java:258)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115)
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Iterator.forEachRemaining(Iterator.java:116)
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485)
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82)
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:108)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:88)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.lambda$execute$0(EngineExecutionOrchestrator.java:54)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.withInterceptedStreams(EngineExecutionOrchestrator.java:67)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:52)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:96)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:75)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:142)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:113)
	at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:384)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:345)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:126)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:418)
2022-02-21 12:57:10,840 [Listener at 0.0.0.0/38571] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1451)) - Stopping Block Manager Service.
2022-02-21 12:57:10,840 [Listener at 0.0.0.0/38571] INFO  utils.BackgroundService (BackgroundService.java:shutdown(132)) - Shutting down service SCMBlockDeletingService
2022-02-21 12:57:10,841 [Listener at 0.0.0.0/38571] INFO  utils.BackgroundService (BackgroundService.java:shutdown(132)) - Shutting down service SCMBlockDeletingService
2022-02-21 12:57:10,841 [Listener at 0.0.0.0/38571] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1478)) - Stopping SCM Event Queue.
2022-02-21 12:57:10,843 [Listener at 0.0.0.0/38571] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1489)) - Stopping SCM HA services.
2022-02-21 12:57:10,843 [Listener at 0.0.0.0/38571] INFO  pipeline.BackgroundPipelineCreator (BackgroundPipelineCreator.java:stop(158)) - Stopping RatisPipelineUtilsThread.
2022-02-21 12:57:10,843 [Listener at 0.0.0.0/38571] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1499)) - Stopping SCM MetadataStore.
2022-02-21 12:57:10,869 [Listener at 0.0.0.0/38571] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchemaFromFile(129)) - Loading schema from [file:/home/runner/work/ozone/ozone/hadoop-hdds/common/target/classes/network-topology-default.xml]
2022-02-21 12:57:10,869 [Listener at 0.0.0.0/38571] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchema(176)) - Loading network topology layer schema file
2022-02-21 12:57:10,881 [Listener at 0.0.0.0/38571] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchemaFromFile(129)) - Loading schema from [file:/home/runner/work/ozone/ozone/hadoop-hdds/common/target/classes/network-topology-default.xml]
2022-02-21 12:57:10,881 [Listener at 0.0.0.0/38571] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchema(176)) - Loading network topology layer schema file
2022-02-21 12:57:10,885 [Listener at 0.0.0.0/38571] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/daf9bed3-f969-495a-90c5-e1ea0aa76bdf
2022-02-21 12:57:10,885 [Listener at 0.0.0.0/38571] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/edd773b5-a7ab-4cb7-9410-6dfcb9aaa68f
2022-02-21 12:57:10,885 [Listener at 0.0.0.0/38571] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/0b16cd6f-c2a9-4ed6-b037-4356e09fe4eb
2022-02-21 12:57:10,885 [Listener at 0.0.0.0/38571] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/679f8a5a-df42-4da4-8254-fd62df2ed149
2022-02-21 12:57:10,886 [Listener at 0.0.0.0/38571] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/97c8049a-83b2-4e08-a1f6-c20673147720
2022-02-21 12:57:10,886 [Listener at 0.0.0.0/38571] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/1de0318a-643b-40f3-8735-036ed00b7836
2022-02-21 12:57:10,886 [Listener at 0.0.0.0/38571] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/bc39e4b9-0add-4f20-af94-0f49a5a86670
2022-02-21 12:57:10,886 [Listener at 0.0.0.0/38571] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/a6202fa9-fb04-488e-805e-598cf1a22a75
2022-02-21 12:57:10,886 [Listener at 0.0.0.0/38571] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/23149d1e-a9f4-407f-a413-07e2175051dd
2022-02-21 12:57:10,886 [Listener at 0.0.0.0/38571] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/b70d278d-aedd-4bb6-9d86-67ecc5dced4c
2022-02-21 12:57:10,887 [Listener at 0.0.0.0/38571] WARN  utils.HAUtils (HAUtils.java:getMetaDir(342)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2022-02-21 12:57:10,889 [Listener at 0.0.0.0/38571] WARN  db.DBStoreBuilder (DBStoreBuilder.java:applyDBDefinition(145)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2022-02-21 12:57:10,984 [Listener at 0.0.0.0/38571] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:<init>(218)) - Init the HA SequenceIdGenerator.
2022-02-21 12:57:10,984 [Listener at 0.0.0.0/38571] INFO  pipeline.PipelineStateManagerImpl (PipelineStateManagerImpl.java:initialize(78)) - No pipeline exists in current db
2022-02-21 12:57:10,985 [Listener at 0.0.0.0/38571] INFO  algorithms.LeaderChoosePolicyFactory (LeaderChoosePolicyFactory.java:getPolicy(57)) - Create leader choose policy of type org.apache.hadoop.hdds.scm.pipeline.leader.choose.algorithms.MinLeaderCountChoosePolicy
2022-02-21 12:57:10,985 [Listener at 0.0.0.0/38571] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service BackgroundPipelineCreator.
2022-02-21 12:57:10,985 [Listener at 0.0.0.0/38571] INFO  pipeline.BackgroundPipelineCreator (BackgroundPipelineCreator.java:start(130)) - Starting RatisPipelineUtilsThread.
2022-02-21 12:57:10,986 [Listener at 0.0.0.0/38571] INFO  algorithms.LeaderChoosePolicyFactory (LeaderChoosePolicyFactory.java:getPolicy(57)) - Create leader choose policy of type org.apache.hadoop.hdds.scm.pipeline.leader.choose.algorithms.MinLeaderCountChoosePolicy
2022-02-21 12:57:10,987 [Listener at 0.0.0.0/38571] INFO  safemode.ContainerSafeModeRule (ContainerSafeModeRule.java:<init>(89)) - containers with one replica threshold count 0
2022-02-21 12:57:10,987 [Listener at 0.0.0.0/38571] INFO  safemode.HealthyPipelineSafeModeRule (HealthyPipelineSafeModeRule.java:initializeRule(156)) - Total pipeline count is 0, healthy pipeline threshold count is 0
2022-02-21 12:57:10,987 [Listener at 0.0.0.0/38571] INFO  safemode.OneReplicaPipelineSafeModeRule (OneReplicaPipelineSafeModeRule.java:initializeRule(180)) - Total pipeline count is 0, pipeline's with at least one datanode reported threshold count is 0
2022-02-21 12:57:10,987 [Listener at 0.0.0.0/38571] WARN  server.ServerUtils (ServerUtils.java:getScmDbDir(148)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2022-02-21 12:57:10,989 [Listener at 0.0.0.0/38571] INFO  ha.SCMHANodeDetails (SCMHANodeDetails.java:loadSCMHAConfig(157)) - ServiceID for StorageContainerManager is null
2022-02-21 12:57:10,990 [Listener at 0.0.0.0/38571] INFO  ha.SCMHANodeDetails (SCMHANodeDetails.java:loadSCMHAConfig(162)) - ozone.scm.default.service.id is not defined, falling back to ozone.scm.service.ids to find serviceID for StorageContainerManager if it is HA enabled cluster
2022-02-21 12:57:10,990 [Listener at 0.0.0.0/38571] WARN  server.ServerUtils (ServerUtils.java:getScmDbDir(148)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2022-02-21 12:57:10,990 [Listener at 0.0.0.0/38571] INFO  upgrade.AbstractLayoutVersionManager (AbstractLayoutVersionManager.java:init(79)) - Initializing Layout version manager with metadata layout = SCM_HA (version = 2), software layout = SCM_HA (version = 2)
2022-02-21 12:57:10,991 [Listener at 0.0.0.0/38571] WARN  util.MBeans (MBeans.java:getMBeanName(167)) - Error creating MBean object name: Hadoop:service=LayoutVersionManager,name=HDDSLayoutVersionManager
org.apache.hadoop.metrics2.MetricsException: org.apache.hadoop.metrics2.MetricsException: Hadoop:service=LayoutVersionManager,name=HDDSLayoutVersionManager already exists!
	at org.apache.hadoop.metrics2.lib.DefaultMetricsSystem.newObjectName(DefaultMetricsSystem.java:135)
	at org.apache.hadoop.metrics2.lib.DefaultMetricsSystem.newMBeanName(DefaultMetricsSystem.java:110)
	at org.apache.hadoop.metrics2.util.MBeans.getMBeanName(MBeans.java:165)
	at org.apache.hadoop.metrics2.util.MBeans.register(MBeans.java:97)
	at org.apache.hadoop.metrics2.util.MBeans.register(MBeans.java:73)
	at org.apache.hadoop.ozone.upgrade.AbstractLayoutVersionManager.init(AbstractLayoutVersionManager.java:84)
	at org.apache.hadoop.hdds.upgrade.HDDSLayoutVersionManager.<init>(HDDSLayoutVersionManager.java:50)
	at org.apache.hadoop.hdds.scm.server.StorageContainerManager.<init>(StorageContainerManager.java:326)
	at org.apache.hadoop.hdds.scm.server.StorageContainerManager.createSCM(StorageContainerManager.java:491)
	at org.apache.hadoop.hdds.scm.HddsTestUtils.getScm(HddsTestUtils.java:624)
	at org.apache.hadoop.hdds.scm.block.TestBlockManager.setUp(TestBlockManager.java:175)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.RunBefores.invokeMethod(RunBefores.java:33)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:24)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.rules.ExternalResource$1.evaluate(ExternalResource.java:54)
	at org.junit.rules.ExpectedException$ExpectedExceptionStatement.evaluate(ExpectedException.java:258)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115)
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Iterator.forEachRemaining(Iterator.java:116)
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485)
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82)
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:108)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:88)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.lambda$execute$0(EngineExecutionOrchestrator.java:54)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.withInterceptedStreams(EngineExecutionOrchestrator.java:67)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:52)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:96)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:75)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:142)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:113)
	at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:384)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:345)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:126)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:418)
Caused by: org.apache.hadoop.metrics2.MetricsException: Hadoop:service=LayoutVersionManager,name=HDDSLayoutVersionManager already exists!
	at org.apache.hadoop.metrics2.lib.DefaultMetricsSystem.newObjectName(DefaultMetricsSystem.java:131)
	... 62 more
2022-02-21 12:57:11,031 [Listener at 0.0.0.0/38571] INFO  reflections.Reflections (Reflections.java:scan(232)) - Reflections took 36 ms to scan 6 urls, producing 119 keys and 272 values 
2022-02-21 12:57:11,034 [Listener at 0.0.0.0/38571] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchemaFromFile(129)) - Loading schema from [file:/home/runner/work/ozone/ozone/hadoop-hdds/common/target/classes/network-topology-default.xml]
2022-02-21 12:57:11,034 [Listener at 0.0.0.0/38571] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchema(176)) - Loading network topology layer schema file
2022-02-21 12:57:11,037 [Listener at 0.0.0.0/38571] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:upgradeToSequenceId(347)) - upgrade localId to 109611004723200000
2022-02-21 12:57:11,037 [Listener at 0.0.0.0/38571] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:upgradeToSequenceId(357)) - upgrade delTxnId to 0
2022-02-21 12:57:11,037 [Listener at 0.0.0.0/38571] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:upgradeToSequenceId(371)) - upgrade containerId to 0
2022-02-21 12:57:11,037 [Listener at 0.0.0.0/38571] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:<init>(218)) - Init the HA SequenceIdGenerator.
2022-02-21 12:57:11,038 [Listener at 0.0.0.0/38571] INFO  algorithms.ContainerPlacementPolicyFactory (ContainerPlacementPolicyFactory.java:getPolicy(60)) - Create container placement policy of type org.apache.hadoop.hdds.scm.container.placement.algorithms.SCMContainerPlacementRandom
2022-02-21 12:57:11,039 [Listener at 0.0.0.0/38571] INFO  algorithms.PipelineChoosePolicyFactory (PipelineChoosePolicyFactory.java:createPipelineChoosePolicyFromClass(73)) - Create pipeline choose policy of type org.apache.hadoop.hdds.scm.pipeline.choose.algorithms.RandomPipelineChoosePolicy
2022-02-21 12:57:11,039 [Listener at 0.0.0.0/38571] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service SCMBlockDeletingService.
2022-02-21 12:57:11,040 [Listener at 0.0.0.0/38571] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service ReplicationManager.
2022-02-21 12:57:11,040 [Listener at 0.0.0.0/38571] INFO  container.ReplicationManager (ReplicationManager.java:start(326)) - Starting Replication Monitor Thread.
2022-02-21 12:57:11,046 [Listener at 0.0.0.0/38571] INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(90)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 10000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false.
2022-02-21 12:57:11,047 [ReplicationMonitor] INFO  container.ReplicationManager (ReplicationManager.java:processAll(374)) - Replication Manager is not ready to run until 300000ms after safemode exit
2022-02-21 12:57:11,047 [Socket Reader #1 for port 0] INFO  ipc.Server (Server.java:run(1265)) - Starting Socket Reader #1 for port 0
2022-02-21 12:57:11,048 [Listener at 0.0.0.0/39197] INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(90)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 10000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false.
2022-02-21 12:57:11,050 [Socket Reader #1 for port 0] INFO  ipc.Server (Server.java:run(1265)) - Starting Socket Reader #1 for port 0
2022-02-21 12:57:11,051 [Listener at 0.0.0.0/46319] INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(90)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 10000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false.
2022-02-21 12:57:11,074 [Socket Reader #1 for port 0] INFO  ipc.Server (Server.java:run(1265)) - Starting Socket Reader #1 for port 0
2022-02-21 12:57:11,078 [Listener at 0.0.0.0/44813] INFO  algorithms.ContainerPlacementPolicyFactory (ContainerPlacementPolicyFactory.java:getPolicy(60)) - Create container placement policy of type org.apache.hadoop.hdds.scm.container.placement.algorithms.SCMContainerPlacementRandom
2022-02-21 12:57:11,083 [Listener at 0.0.0.0/44813] INFO  server.StorageContainerManager (StorageContainerManager.java:<init>(388)) - 
Container Balancer status:
Key                            Value
Running                        false
Container Balancer Configuration values:
Key                                                Value
Threshold                                          10
Max Datanodes to Involve per Iteration(percent)    20
Max Size to Move per Iteration                     500GB
Max Size Entering Target per Iteration             26GB
Max Size Leaving Source per Iteration              26GB

2022-02-21 12:57:11,084 [Listener at 0.0.0.0/44813] INFO  ha.SCMContext (SCMContext.java:updateSafeModeStatus(211)) - Update SafeModeStatus from SafeModeStatus{safeModeStatus=false, preCheckPassed=true} to SafeModeStatus{safeModeStatus=false, preCheckPassed=true}.
2022-02-21 12:57:11,085 [Listener at 0.0.0.0/44813] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(183)) - Sending CreatePipelineCommand for pipeline:PipelineID=e2b6fa81-274f-4ea8-adbf-2134081db844 to datanode:1de0318a-643b-40f3-8735-036ed00b7836
2022-02-21 12:57:11,086 [Listener at 0.0.0.0/44813] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(183)) - Sending CreatePipelineCommand for pipeline:PipelineID=e2b6fa81-274f-4ea8-adbf-2134081db844 to datanode:a6202fa9-fb04-488e-805e-598cf1a22a75
2022-02-21 12:57:11,087 [Listener at 0.0.0.0/44813] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(183)) - Sending CreatePipelineCommand for pipeline:PipelineID=e2b6fa81-274f-4ea8-adbf-2134081db844 to datanode:bc39e4b9-0add-4f20-af94-0f49a5a86670
2022-02-21 12:57:11,095 [Listener at 0.0.0.0/44813] INFO  pipeline.PipelineStateManagerImpl (PipelineStateManagerImpl.java:addPipeline(101)) - Created pipeline Pipeline[ Id: e2b6fa81-274f-4ea8-adbf-2134081db844, Nodes: 1de0318a-643b-40f3-8735-036ed00b7836{ip: 154.15.245.107, host: localhost-154.15.245.107, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}a6202fa9-fb04-488e-805e-598cf1a22a75{ip: 39.21.235.198, host: localhost-39.21.235.198, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}bc39e4b9-0add-4f20-af94-0f49a5a86670{ip: 54.151.193.181, host: localhost-54.151.193.181, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}, ReplicationConfig: RATIS/THREE, State:ALLOCATED, leaderId:, CreationTimestamp2022-02-21T12:57:11.085Z[Etc/UTC]].
2022-02-21 12:57:11,096 [EventQueue-DatanodeCommandForDatanodeCommandHandler] INFO  pipeline.PipelineManagerImpl (PipelineManagerImpl.java:openPipeline(291)) - Pipeline Pipeline[ Id: e2b6fa81-274f-4ea8-adbf-2134081db844, Nodes: 1de0318a-643b-40f3-8735-036ed00b7836{ip: 154.15.245.107, host: localhost-154.15.245.107, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}a6202fa9-fb04-488e-805e-598cf1a22a75{ip: 39.21.235.198, host: localhost-39.21.235.198, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}bc39e4b9-0add-4f20-af94-0f49a5a86670{ip: 54.151.193.181, host: localhost-54.151.193.181, ports: [STANDALONE=0, RATIS=0, REST=0, REPLICATION=0, RATIS_ADMIN=0, RATIS_SERVER=0], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}, ReplicationConfig: RATIS/THREE, State:ALLOCATED, leaderId:, CreationTimestamp2022-02-21T12:57:11.085Z[Etc/UTC]] moved to OPEN state
2022-02-21 12:57:11,196 [Listener at 0.0.0.0/44813] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:getNextId(127)) - Allocate a batch for containerId, change lastId from 0 to 1000.
2022-02-21 12:57:11,197 [Listener at 0.0.0.0/44813] WARN  ha.SequenceIdGenerator (SequenceIdGenerator.java:allocateBatch(235)) - Failed to allocate a batch for localId, expected lastId is 0, actual lastId is 109611004723200000.
2022-02-21 12:57:11,197 [Listener at 0.0.0.0/44813] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:getNextId(127)) - Allocate a batch for localId, change lastId from 109611004723200000 to 109611004723201000.
2022-02-21 12:57:11,198 [Listener at 0.0.0.0/44813] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1390)) - Stopping Container Balancer service.
2022-02-21 12:57:11,198 [Listener at 0.0.0.0/44813] INFO  balancer.ContainerBalancer (ContainerBalancer.java:stop(751)) - Container Balancer is not running.
2022-02-21 12:57:11,199 [Listener at 0.0.0.0/44813] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1397)) - Stopping Replication Manager Service.
2022-02-21 12:57:11,199 [Listener at 0.0.0.0/44813] INFO  container.ReplicationManager (ReplicationManager.java:stop(357)) - Stopping Replication Monitor Thread.
2022-02-21 12:57:11,199 [Listener at 0.0.0.0/44813] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1404)) - Stopping the Datanode Admin Monitor.
2022-02-21 12:57:11,199 [Listener at 0.0.0.0/44813] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1411)) - Stopping Lease Manager of the command watchers
2022-02-21 12:57:11,199 [Listener at 0.0.0.0/44813] ERROR server.StorageContainerManager (StorageContainerManager.java:stop(1414)) - Lease Manager of the command watchers stop failed
2022-02-21 12:57:11,199 [Listener at 0.0.0.0/44813] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1418)) - Stopping datanode service RPC server
2022-02-21 12:57:11,200 [Listener at 0.0.0.0/44813] INFO  server.SCMDatanodeProtocolServer (SCMDatanodeProtocolServer.java:stop(390)) - Stopping the RPC server for DataNodes
2022-02-21 12:57:11,200 [Listener at 0.0.0.0/44813] INFO  ipc.Server (Server.java:stop(3414)) - Stopping server on 39197
2022-02-21 12:57:11,200 [Listener at 0.0.0.0/44813] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1426)) - Stopping block service RPC server
2022-02-21 12:57:11,200 [Listener at 0.0.0.0/44813] INFO  server.SCMBlockProtocolServer (SCMBlockProtocolServer.java:stop(160)) - Stopping the RPC server for Block Protocol
2022-02-21 12:57:11,200 [Listener at 0.0.0.0/44813] INFO  ipc.Server (Server.java:stop(3414)) - Stopping server on 46319
2022-02-21 12:57:11,201 [Listener at 0.0.0.0/44813] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1433)) - Stopping the StorageContainerLocationProtocol RPC server
2022-02-21 12:57:11,201 [Listener at 0.0.0.0/44813] INFO  server.SCMClientProtocolServer (SCMClientProtocolServer.java:stop(174)) - Stopping the RPC server for Client Protocol
2022-02-21 12:57:11,201 [Listener at 0.0.0.0/44813] INFO  ipc.Server (Server.java:stop(3414)) - Stopping server on 44813
2022-02-21 12:57:11,201 [Listener at 0.0.0.0/44813] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1440)) - Stopping Storage Container Manager HTTP server.
2022-02-21 12:57:11,202 [Listener at 0.0.0.0/44813] ERROR server.StorageContainerManager (StorageContainerManager.java:stop(1443)) - Storage Container Manager HTTP server stop failed.
java.lang.NullPointerException
	at org.apache.hadoop.hdds.scm.server.StorageContainerManager.stop(StorageContainerManager.java:1441)
	at org.apache.hadoop.hdds.scm.block.TestBlockManager.cleanup(TestBlockManager.java:192)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.RunAfters.invokeMethod(RunAfters.java:46)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:33)
	at org.junit.rules.ExternalResource$1.evaluate(ExternalResource.java:54)
	at org.junit.rules.ExpectedException$ExpectedExceptionStatement.evaluate(ExpectedException.java:258)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115)
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Iterator.forEachRemaining(Iterator.java:116)
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485)
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82)
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:108)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:88)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.lambda$execute$0(EngineExecutionOrchestrator.java:54)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.withInterceptedStreams(EngineExecutionOrchestrator.java:67)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:52)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:96)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:75)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:142)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:113)
	at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:384)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:345)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:126)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:418)
2022-02-21 12:57:11,202 [Listener at 0.0.0.0/44813] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1451)) - Stopping Block Manager Service.
2022-02-21 12:57:11,202 [Listener at 0.0.0.0/44813] INFO  utils.BackgroundService (BackgroundService.java:shutdown(132)) - Shutting down service SCMBlockDeletingService
2022-02-21 12:57:11,203 [Listener at 0.0.0.0/44813] INFO  utils.BackgroundService (BackgroundService.java:shutdown(132)) - Shutting down service SCMBlockDeletingService
2022-02-21 12:57:11,203 [Listener at 0.0.0.0/44813] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1478)) - Stopping SCM Event Queue.
2022-02-21 12:57:11,203 [Listener at 0.0.0.0/44813] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1489)) - Stopping SCM HA services.
2022-02-21 12:57:11,203 [Listener at 0.0.0.0/44813] INFO  pipeline.BackgroundPipelineCreator (BackgroundPipelineCreator.java:stop(158)) - Stopping RatisPipelineUtilsThread.
2022-02-21 12:57:11,204 [Listener at 0.0.0.0/44813] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1499)) - Stopping SCM MetadataStore.
