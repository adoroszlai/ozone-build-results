2022-04-03 12:49:55,723 [main] INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(90)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 1000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false.
2022-04-03 12:49:55,847 [Socket Reader #1 for port 42631] INFO  ipc.Server (Server.java:run(1265)) - Starting Socket Reader #1 for port 42631
2022-04-03 12:49:55,898 [Listener at 127.0.0.1/42631] WARN  util.NativeCodeLoader (NativeCodeLoader.java:<clinit>(60)) - Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
2022-04-03 12:49:55,990 [IPC Server Responder] INFO  ipc.Server (Server.java:run(1507)) - IPC Server Responder: starting
2022-04-03 12:49:55,995 [IPC Server listener on 42631] INFO  ipc.Server (Server.java:run(1344)) - IPC Server listener on 42631: starting
2022-04-03 12:49:56,119 [Listener at 127.0.0.1/42631] INFO  upgrade.AbstractLayoutVersionManager (AbstractLayoutVersionManager.java:init(79)) - Initializing Layout version manager with metadata layout = SCM_HA (version = 2), software layout = SCM_HA (version = 2)
2022-04-03 12:49:56,351 [Listener at 127.0.0.1/42631] INFO  reflections.Reflections (Reflections.java:scan(232)) - Reflections took 124 ms to scan 4 urls, producing 101 keys and 225 values 
2022-04-03 12:49:56,454 [Listener at 127.0.0.1/42631] INFO  statemachine.DatanodeStateMachine (DatanodeStateMachine.java:getEndPointTaskThreadPoolSize(222)) - Datanode State Machine Task Thread Pool size 2
2022-04-03 12:49:56,586 [Listener at 127.0.0.1/42631] INFO  volume.HddsVolume (HddsVolume.java:<init>(120)) - Creating HddsVolume: /home/runner/work/ozone/ozone/hadoop-hdds/container-service/target/test-dir/TestDatanodeStateMachine/data/hdds of storage type : DISK capacity : 9223372036854775807
2022-04-03 12:49:56,588 [Listener at 127.0.0.1/42631] INFO  volume.MutableVolumeSet (MutableVolumeSet.java:initializeVolumeSet(168)) - Added Volume : /home/runner/work/ozone/ozone/hadoop-hdds/container-service/target/test-dir/TestDatanodeStateMachine/data/hdds to VolumeSet
2022-04-03 12:49:56,589 [Listener at 127.0.0.1/42631] INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(141)) - Scheduling a check for /home/runner/work/ozone/ozone/hadoop-hdds/container-service/target/test-dir/TestDatanodeStateMachine/data/hdds
2022-04-03 12:49:56,631 [Listener at 127.0.0.1/42631] INFO  volume.StorageVolumeChecker (StorageVolumeChecker.java:checkAllVolumes(202)) - Scheduled health check for volume /home/runner/work/ozone/ozone/hadoop-hdds/container-service/target/test-dir/TestDatanodeStateMachine/data/hdds
2022-04-03 12:49:56,648 [Listener at 127.0.0.1/42631] WARN  server.ServerUtils (ServerUtils.java:getDefaultRatisDirectory(237)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2022-04-03 12:49:56,650 [Listener at 127.0.0.1/42631] INFO  volume.MutableVolumeSet (MutableVolumeSet.java:initializeVolumeSet(168)) - Added Volume : /home/runner/work/ozone/ozone/hadoop-hdds/container-service/target/test-dir/TestDatanodeStateMachine/scm/ratis to VolumeSet
2022-04-03 12:49:56,650 [Listener at 127.0.0.1/42631] INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(141)) - Scheduling a check for /home/runner/work/ozone/ozone/hadoop-hdds/container-service/target/test-dir/TestDatanodeStateMachine/scm/ratis
2022-04-03 12:49:56,650 [Listener at 127.0.0.1/42631] INFO  volume.StorageVolumeChecker (StorageVolumeChecker.java:checkAllVolumes(202)) - Scheduled health check for volume /home/runner/work/ozone/ozone/hadoop-hdds/container-service/target/test-dir/TestDatanodeStateMachine/scm/ratis
2022-04-03 12:49:56,677 [Thread-18] INFO  ozoneimpl.ContainerReader (ContainerReader.java:readVolume(172)) - Finish verifying containers on volume /home/runner/work/ozone/ozone/hadoop-hdds/container-service/target/test-dir/TestDatanodeStateMachine/data/hdds
2022-04-03 12:49:56,677 [Listener at 127.0.0.1/42631] INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:buildContainerSet(257)) - Build ContainerSet costs 0s
2022-04-03 12:49:57,367 [Listener at 127.0.0.1/42631] WARN  server.ServerUtils (ServerUtils.java:getDefaultRatisDirectory(237)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2022-04-03 12:49:57,406 [Listener at 127.0.0.1/42631] INFO  server.RaftServer (ConfUtils.java:logGet(44)) - raft.rpc.type = GRPC (default)
2022-04-03 12:49:57,461 [Listener at 127.0.0.1/42631] INFO  grpc.GrpcFactory (GrpcFactory.java:checkPooledByteBufAllocatorUseCacheForAllThreads(48)) - PERFORMANCE WARNING: useCacheForAllThreads is true that may cause Netty to create a lot garbage objects and, as a result, trigger GC.
	It is recommended to disable useCacheForAllThreads by setting -Dorg.apache.ratis.thirdparty.io.netty.allocator.useCacheForAllThreads=false in command line.
2022-04-03 12:49:57,465 [Listener at 127.0.0.1/42631] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(44)) - raft.grpc.admin.port = 0 (custom)
2022-04-03 12:49:57,465 [Listener at 127.0.0.1/42631] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(44)) - raft.grpc.client.port = 0 (custom)
2022-04-03 12:49:57,466 [Listener at 127.0.0.1/42631] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(44)) - raft.grpc.server.port = 0 (default)
2022-04-03 12:49:57,467 [Listener at 127.0.0.1/42631] INFO  server.GrpcService (ConfUtils.java:logGet(44)) - raft.grpc.message.size.max = 32MB (=33554432) (custom)
2022-04-03 12:49:57,467 [Listener at 127.0.0.1/42631] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2022-04-03 12:49:57,469 [Listener at 127.0.0.1/42631] INFO  server.GrpcService (ConfUtils.java:logGet(44)) - raft.grpc.flow.control.window = 5MB (=5242880) (custom)
2022-04-03 12:49:57,469 [Listener at 127.0.0.1/42631] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.request.timeout = 60s (custom)
2022-04-03 12:49:57,732 [Listener at 127.0.0.1/42631] INFO  impl.DataStreamServerImpl (ConfUtils.java:logGet(44)) - raft.datastream.type = DISABLED (default)
2022-04-03 12:49:57,734 [Listener at 127.0.0.1/42631] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.slowness.timeout = 300s (custom)
2022-04-03 12:49:57,734 [Listener at 127.0.0.1/42631] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.leaderelection.leader.step-down.wait-time = 10s (default)
2022-04-03 12:49:57,745 [Listener at 127.0.0.1/42631] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.storage.dir = [/home/runner/work/ozone/ozone/hadoop-hdds/container-service/target/test-dir/TestDatanodeStateMachine/scm/ratis] (custom)
2022-04-03 12:49:57,766 [Listener at 127.0.0.1/42631] INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(132)) - GrpcServer channel type EpollServerSocketChannel
2022-04-03 12:49:57,899 [Test Data Node State Machine Thread - 0] ERROR datanode.InitDatanodeState (InitDatanodeState.java:persistContainerDatanodeDetails(134)) - Writing to /home/runner/work/ozone/ozone/hadoop-hdds/container-service/target/test-dir/TestDatanodeStateMachine/datanodeID/datanode.id failed /home/runner/work/ozone/ozone/hadoop-hdds/container-service/target/test-dir/TestDatanodeStateMachine/datanodeID/datanode.id (Permission denied)
2022-04-03 12:49:57,902 [Listener at 127.0.0.1/42631] INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(356)) - Attempting to stop container services.
2022-04-03 12:49:57,903 [Listener at 127.0.0.1/42631] INFO  utils.BackgroundService (BackgroundService.java:shutdown(132)) - Shutting down service BlockDeletingService
2022-04-03 12:50:00,911 [Listener at 127.0.0.1/42631] INFO  ipc.Server (Server.java:stop(3414)) - Stopping server on 42631
2022-04-03 12:50:00,912 [IPC Server Responder] INFO  ipc.Server (Server.java:run(1512)) - Stopping IPC Server Responder
2022-04-03 12:50:00,914 [IPC Server listener on 42631] INFO  ipc.Server (Server.java:run(1376)) - Stopping IPC Server listener on 42631
2022-04-03 12:50:00,961 [Listener at 127.0.0.1/42631] INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(90)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 1000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false.
2022-04-03 12:50:00,978 [Socket Reader #1 for port 42147] INFO  ipc.Server (Server.java:run(1265)) - Starting Socket Reader #1 for port 42147
2022-04-03 12:50:00,994 [IPC Server Responder] INFO  ipc.Server (Server.java:run(1507)) - IPC Server Responder: starting
2022-04-03 12:50:00,998 [IPC Server listener on 42147] INFO  ipc.Server (Server.java:run(1344)) - IPC Server listener on 42147: starting
2022-04-03 12:50:01,003 [Listener at 127.0.0.1/42147] INFO  upgrade.AbstractLayoutVersionManager (AbstractLayoutVersionManager.java:init(79)) - Initializing Layout version manager with metadata layout = SCM_HA (version = 2), software layout = SCM_HA (version = 2)
2022-04-03 12:50:01,004 [Listener at 127.0.0.1/42147] WARN  util.MBeans (MBeans.java:getMBeanName(167)) - Error creating MBean object name: Hadoop:service=LayoutVersionManager,name=HDDSLayoutVersionManager
org.apache.hadoop.metrics2.MetricsException: org.apache.hadoop.metrics2.MetricsException: Hadoop:service=LayoutVersionManager,name=HDDSLayoutVersionManager already exists!
	at org.apache.hadoop.metrics2.lib.DefaultMetricsSystem.newObjectName(DefaultMetricsSystem.java:135)
	at org.apache.hadoop.metrics2.lib.DefaultMetricsSystem.newMBeanName(DefaultMetricsSystem.java:110)
	at org.apache.hadoop.metrics2.util.MBeans.getMBeanName(MBeans.java:165)
	at org.apache.hadoop.metrics2.util.MBeans.register(MBeans.java:97)
	at org.apache.hadoop.metrics2.util.MBeans.register(MBeans.java:73)
	at org.apache.hadoop.ozone.upgrade.AbstractLayoutVersionManager.init(AbstractLayoutVersionManager.java:84)
	at org.apache.hadoop.hdds.upgrade.HDDSLayoutVersionManager.<init>(HDDSLayoutVersionManager.java:50)
	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.<init>(DatanodeStateMachine.java:138)
	at org.apache.hadoop.ozone.container.common.TestDatanodeStateMachine.testStartStopDatanodeStateMachine(TestDatanodeStateMachine.java:156)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115)
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Iterator.forEachRemaining(Iterator.java:116)
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485)
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82)
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:108)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:88)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.lambda$execute$0(EngineExecutionOrchestrator.java:54)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.withInterceptedStreams(EngineExecutionOrchestrator.java:67)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:52)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:96)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:75)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.execute(JUnitPlatformProvider.java:188)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:124)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:428)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:162)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:562)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:548)
Caused by: org.apache.hadoop.metrics2.MetricsException: Hadoop:service=LayoutVersionManager,name=HDDSLayoutVersionManager already exists!
	at org.apache.hadoop.metrics2.lib.DefaultMetricsSystem.newObjectName(DefaultMetricsSystem.java:131)
	... 59 more
2022-04-03 12:50:01,063 [Listener at 127.0.0.1/42147] INFO  reflections.Reflections (Reflections.java:scan(232)) - Reflections took 48 ms to scan 4 urls, producing 101 keys and 225 values 
2022-04-03 12:50:01,064 [Listener at 127.0.0.1/42147] INFO  statemachine.DatanodeStateMachine (DatanodeStateMachine.java:getEndPointTaskThreadPoolSize(222)) - Datanode State Machine Task Thread Pool size 2
2022-04-03 12:50:01,071 [Listener at 127.0.0.1/42147] INFO  volume.HddsVolume (HddsVolume.java:<init>(120)) - Creating HddsVolume: /home/runner/work/ozone/ozone/hadoop-hdds/container-service/target/test-dir/TestDatanodeStateMachine/data/hdds of storage type : DISK capacity : 9223372036854775807
2022-04-03 12:50:01,071 [Listener at 127.0.0.1/42147] INFO  volume.MutableVolumeSet (MutableVolumeSet.java:initializeVolumeSet(168)) - Added Volume : /home/runner/work/ozone/ozone/hadoop-hdds/container-service/target/test-dir/TestDatanodeStateMachine/data/hdds to VolumeSet
2022-04-03 12:50:01,071 [Listener at 127.0.0.1/42147] INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(141)) - Scheduling a check for /home/runner/work/ozone/ozone/hadoop-hdds/container-service/target/test-dir/TestDatanodeStateMachine/data/hdds
2022-04-03 12:50:01,092 [Listener at 127.0.0.1/42147] INFO  volume.StorageVolumeChecker (StorageVolumeChecker.java:checkAllVolumes(202)) - Scheduled health check for volume /home/runner/work/ozone/ozone/hadoop-hdds/container-service/target/test-dir/TestDatanodeStateMachine/data/hdds
2022-04-03 12:50:01,100 [Listener at 127.0.0.1/42147] WARN  server.ServerUtils (ServerUtils.java:getDefaultRatisDirectory(237)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2022-04-03 12:50:01,101 [Listener at 127.0.0.1/42147] INFO  volume.MutableVolumeSet (MutableVolumeSet.java:initializeVolumeSet(168)) - Added Volume : /home/runner/work/ozone/ozone/hadoop-hdds/container-service/target/test-dir/TestDatanodeStateMachine/scm/ratis to VolumeSet
2022-04-03 12:50:01,101 [Listener at 127.0.0.1/42147] INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(141)) - Scheduling a check for /home/runner/work/ozone/ozone/hadoop-hdds/container-service/target/test-dir/TestDatanodeStateMachine/scm/ratis
2022-04-03 12:50:01,102 [Listener at 127.0.0.1/42147] INFO  volume.StorageVolumeChecker (StorageVolumeChecker.java:checkAllVolumes(202)) - Scheduled health check for volume /home/runner/work/ozone/ozone/hadoop-hdds/container-service/target/test-dir/TestDatanodeStateMachine/scm/ratis
2022-04-03 12:50:01,120 [Thread-33] INFO  ozoneimpl.ContainerReader (ContainerReader.java:readVolume(172)) - Finish verifying containers on volume /home/runner/work/ozone/ozone/hadoop-hdds/container-service/target/test-dir/TestDatanodeStateMachine/data/hdds
2022-04-03 12:50:01,120 [Listener at 127.0.0.1/42147] INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:buildContainerSet(257)) - Build ContainerSet costs 0s
2022-04-03 12:50:01,122 [Listener at 127.0.0.1/42147] WARN  server.ServerUtils (ServerUtils.java:getDefaultRatisDirectory(237)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2022-04-03 12:50:01,124 [Listener at 127.0.0.1/42147] INFO  server.RaftServer (ConfUtils.java:logGet(44)) - raft.rpc.type = GRPC (default)
2022-04-03 12:50:01,124 [Listener at 127.0.0.1/42147] INFO  grpc.GrpcFactory (GrpcFactory.java:checkPooledByteBufAllocatorUseCacheForAllThreads(48)) - PERFORMANCE WARNING: useCacheForAllThreads is true that may cause Netty to create a lot garbage objects and, as a result, trigger GC.
	It is recommended to disable useCacheForAllThreads by setting -Dorg.apache.ratis.thirdparty.io.netty.allocator.useCacheForAllThreads=false in command line.
2022-04-03 12:50:01,125 [Listener at 127.0.0.1/42147] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(44)) - raft.grpc.admin.port = 0 (custom)
2022-04-03 12:50:01,125 [Listener at 127.0.0.1/42147] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(44)) - raft.grpc.client.port = 0 (custom)
2022-04-03 12:50:01,125 [Listener at 127.0.0.1/42147] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(44)) - raft.grpc.server.port = 0 (default)
2022-04-03 12:50:01,125 [Listener at 127.0.0.1/42147] INFO  server.GrpcService (ConfUtils.java:logGet(44)) - raft.grpc.message.size.max = 32MB (=33554432) (custom)
2022-04-03 12:50:01,125 [Listener at 127.0.0.1/42147] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2022-04-03 12:50:01,125 [Listener at 127.0.0.1/42147] INFO  server.GrpcService (ConfUtils.java:logGet(44)) - raft.grpc.flow.control.window = 5MB (=5242880) (custom)
2022-04-03 12:50:01,126 [Listener at 127.0.0.1/42147] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.request.timeout = 60s (custom)
2022-04-03 12:50:01,127 [Listener at 127.0.0.1/42147] INFO  impl.DataStreamServerImpl (ConfUtils.java:logGet(44)) - raft.datastream.type = DISABLED (default)
2022-04-03 12:50:01,127 [Listener at 127.0.0.1/42147] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.slowness.timeout = 300s (custom)
2022-04-03 12:50:01,127 [Listener at 127.0.0.1/42147] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.leaderelection.leader.step-down.wait-time = 10s (default)
2022-04-03 12:50:01,127 [Listener at 127.0.0.1/42147] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.storage.dir = [/home/runner/work/ozone/ozone/hadoop-hdds/container-service/target/test-dir/TestDatanodeStateMachine/scm/ratis] (custom)
2022-04-03 12:50:01,138 [Listener at 127.0.0.1/42147] INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(132)) - GrpcServer channel type EpollServerSocketChannel
2022-04-03 12:50:01,142 [Datanode State Machine Daemon Thread] INFO  statemachine.DatanodeStateMachine (DatanodeStateMachine.java:lambda$startDaemon$0(470)) - Ozone container server started.
2022-04-03 12:50:01,143 [Listener at 127.0.0.1/42147] INFO  common.TestDatanodeStateMachine (TestDatanodeStateMachine.java:lambda$testStartStopDatanodeStateMachine$0(164)) - connectionManager.getValues().size() is 0
2022-04-03 12:50:01,171 [org.apache.hadoop.util.JvmPauseMonitor$Monitor@4eeb0405] INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(188)) - Starting JVM pause monitor
2022-04-03 12:50:01,208 [Datanode State Machine Task Thread - 0] INFO  datanode.InitDatanodeState (InitDatanodeState.java:persistContainerDatanodeDetails(138)) - DatanodeDetails is persisted to /home/runner/work/ozone/ozone/hadoop-hdds/container-service/target/test-dir/TestDatanodeStateMachine/datanodeID/datanode.id
2022-04-03 12:50:02,143 [Listener at 127.0.0.1/42147] INFO  common.TestDatanodeStateMachine (TestDatanodeStateMachine.java:lambda$testStartStopDatanodeStateMachine$0(164)) - connectionManager.getValues().size() is 1
2022-04-03 12:50:07,145 [Listener at 127.0.0.1/42147] INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(356)) - Attempting to stop container services.
2022-04-03 12:50:07,145 [Listener at 127.0.0.1/42147] INFO  utils.BackgroundService (BackgroundService.java:shutdown(132)) - Shutting down service BlockDeletingService
2022-04-03 12:50:10,148 [Listener at 127.0.0.1/42147] INFO  statemachine.DatanodeStateMachine (DatanodeStateMachine.java:stopDaemon(529)) - Ozone container server stopped.
2022-04-03 12:50:10,148 [Listener at 127.0.0.1/42147] INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(356)) - Attempting to stop container services.
2022-04-03 12:50:10,148 [Listener at 127.0.0.1/42147] INFO  utils.BackgroundService (BackgroundService.java:shutdown(132)) - Shutting down service BlockDeletingService
2022-04-03 12:50:13,149 [Listener at 127.0.0.1/42147] INFO  ipc.Server (Server.java:stop(3414)) - Stopping server on 42147
2022-04-03 12:50:13,158 [IPC Server listener on 42147] INFO  ipc.Server (Server.java:run(1376)) - Stopping IPC Server listener on 42147
2022-04-03 12:50:13,160 [IPC Server Responder] INFO  ipc.Server (Server.java:run(1512)) - Stopping IPC Server Responder
2022-04-03 12:50:13,175 [Listener at 127.0.0.1/42147] INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(90)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 1000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false.
2022-04-03 12:50:13,180 [Socket Reader #1 for port 46637] INFO  ipc.Server (Server.java:run(1265)) - Starting Socket Reader #1 for port 46637
2022-04-03 12:50:13,190 [IPC Server Responder] INFO  ipc.Server (Server.java:run(1507)) - IPC Server Responder: starting
2022-04-03 12:50:13,190 [IPC Server listener on 46637] INFO  ipc.Server (Server.java:run(1344)) - IPC Server listener on 46637: starting
2022-04-03 12:50:13,196 [Listener at 127.0.0.1/46637] INFO  common.TestDatanodeStateMachine (TestDatanodeStateMachine.java:lambda$testDatanodeStateMachineWithInvalidConfiguration$2(400)) - Test with ozone.scm.names = 
2022-04-03 12:50:13,196 [Listener at 127.0.0.1/46637] INFO  upgrade.AbstractLayoutVersionManager (AbstractLayoutVersionManager.java:init(79)) - Initializing Layout version manager with metadata layout = SCM_HA (version = 2), software layout = SCM_HA (version = 2)
2022-04-03 12:50:13,197 [Listener at 127.0.0.1/46637] WARN  util.MBeans (MBeans.java:getMBeanName(167)) - Error creating MBean object name: Hadoop:service=LayoutVersionManager,name=HDDSLayoutVersionManager
org.apache.hadoop.metrics2.MetricsException: org.apache.hadoop.metrics2.MetricsException: Hadoop:service=LayoutVersionManager,name=HDDSLayoutVersionManager already exists!
	at org.apache.hadoop.metrics2.lib.DefaultMetricsSystem.newObjectName(DefaultMetricsSystem.java:135)
	at org.apache.hadoop.metrics2.lib.DefaultMetricsSystem.newMBeanName(DefaultMetricsSystem.java:110)
	at org.apache.hadoop.metrics2.util.MBeans.getMBeanName(MBeans.java:165)
	at org.apache.hadoop.metrics2.util.MBeans.register(MBeans.java:97)
	at org.apache.hadoop.metrics2.util.MBeans.register(MBeans.java:73)
	at org.apache.hadoop.ozone.upgrade.AbstractLayoutVersionManager.init(AbstractLayoutVersionManager.java:84)
	at org.apache.hadoop.hdds.upgrade.HDDSLayoutVersionManager.<init>(HDDSLayoutVersionManager.java:50)
	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.<init>(DatanodeStateMachine.java:138)
	at org.apache.hadoop.ozone.container.common.TestDatanodeStateMachine.lambda$testDatanodeStateMachineWithInvalidConfiguration$2(TestDatanodeStateMachine.java:402)
	at java.util.ArrayList.forEach(ArrayList.java:1259)
	at org.apache.hadoop.ozone.container.common.TestDatanodeStateMachine.testDatanodeStateMachineWithInvalidConfiguration(TestDatanodeStateMachine.java:397)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115)
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Iterator.forEachRemaining(Iterator.java:116)
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485)
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82)
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:108)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:88)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.lambda$execute$0(EngineExecutionOrchestrator.java:54)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.withInterceptedStreams(EngineExecutionOrchestrator.java:67)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:52)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:96)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:75)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.execute(JUnitPlatformProvider.java:188)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:124)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:428)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:162)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:562)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:548)
Caused by: org.apache.hadoop.metrics2.MetricsException: Hadoop:service=LayoutVersionManager,name=HDDSLayoutVersionManager already exists!
	at org.apache.hadoop.metrics2.lib.DefaultMetricsSystem.newObjectName(DefaultMetricsSystem.java:131)
	... 61 more
2022-04-03 12:50:13,251 [Listener at 127.0.0.1/46637] INFO  reflections.Reflections (Reflections.java:scan(232)) - Reflections took 48 ms to scan 4 urls, producing 101 keys and 225 values 
2022-04-03 12:50:13,253 [Listener at 127.0.0.1/46637] ERROR statemachine.DatanodeStateMachine (DatanodeStateMachine.java:getEndPointTaskThreadPoolSize(219)) - Fail to get scm addresses
java.lang.IllegalArgumentException: ozone.scm.names need to be a set of valid DNS names or IP addresses. Empty address list found.
	at org.apache.hadoop.hdds.HddsUtils.getSCMAddressForDatanodes(HddsUtils.java:279)
	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.getEndPointTaskThreadPoolSize(DatanodeStateMachine.java:217)
	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.<init>(DatanodeStateMachine.java:144)
	at org.apache.hadoop.ozone.container.common.TestDatanodeStateMachine.lambda$testDatanodeStateMachineWithInvalidConfiguration$2(TestDatanodeStateMachine.java:402)
	at java.util.ArrayList.forEach(ArrayList.java:1259)
	at org.apache.hadoop.ozone.container.common.TestDatanodeStateMachine.testDatanodeStateMachineWithInvalidConfiguration(TestDatanodeStateMachine.java:397)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115)
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Iterator.forEachRemaining(Iterator.java:116)
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485)
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82)
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:108)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:88)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.lambda$execute$0(EngineExecutionOrchestrator.java:54)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.withInterceptedStreams(EngineExecutionOrchestrator.java:67)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:52)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:96)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:75)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.execute(JUnitPlatformProvider.java:188)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:124)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:428)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:162)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:562)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:548)
2022-04-03 12:50:13,253 [Listener at 127.0.0.1/46637] INFO  statemachine.DatanodeStateMachine (DatanodeStateMachine.java:getEndPointTaskThreadPoolSize(222)) - Datanode State Machine Task Thread Pool size 1
2022-04-03 12:50:13,263 [Listener at 127.0.0.1/46637] INFO  volume.HddsVolume (HddsVolume.java:<init>(120)) - Creating HddsVolume: /home/runner/work/ozone/ozone/hadoop-hdds/container-service/target/test-dir/TestDatanodeStateMachine/data/hdds of storage type : DISK capacity : 9223372036854775807
2022-04-03 12:50:13,263 [Listener at 127.0.0.1/46637] INFO  volume.MutableVolumeSet (MutableVolumeSet.java:initializeVolumeSet(168)) - Added Volume : /home/runner/work/ozone/ozone/hadoop-hdds/container-service/target/test-dir/TestDatanodeStateMachine/data/hdds to VolumeSet
2022-04-03 12:50:13,263 [Listener at 127.0.0.1/46637] INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(141)) - Scheduling a check for /home/runner/work/ozone/ozone/hadoop-hdds/container-service/target/test-dir/TestDatanodeStateMachine/data/hdds
2022-04-03 12:50:13,282 [Listener at 127.0.0.1/46637] INFO  volume.StorageVolumeChecker (StorageVolumeChecker.java:checkAllVolumes(202)) - Scheduled health check for volume /home/runner/work/ozone/ozone/hadoop-hdds/container-service/target/test-dir/TestDatanodeStateMachine/data/hdds
2022-04-03 12:50:13,288 [Listener at 127.0.0.1/46637] WARN  server.ServerUtils (ServerUtils.java:getDefaultRatisDirectory(237)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2022-04-03 12:50:13,289 [Listener at 127.0.0.1/46637] INFO  volume.MutableVolumeSet (MutableVolumeSet.java:initializeVolumeSet(168)) - Added Volume : /home/runner/work/ozone/ozone/hadoop-hdds/container-service/target/test-dir/TestDatanodeStateMachine/scm/ratis to VolumeSet
2022-04-03 12:50:13,289 [Listener at 127.0.0.1/46637] INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(141)) - Scheduling a check for /home/runner/work/ozone/ozone/hadoop-hdds/container-service/target/test-dir/TestDatanodeStateMachine/scm/ratis
2022-04-03 12:50:13,289 [Listener at 127.0.0.1/46637] INFO  volume.StorageVolumeChecker (StorageVolumeChecker.java:checkAllVolumes(202)) - Scheduled health check for volume /home/runner/work/ozone/ozone/hadoop-hdds/container-service/target/test-dir/TestDatanodeStateMachine/scm/ratis
2022-04-03 12:50:13,318 [Thread-50] INFO  ozoneimpl.ContainerReader (ContainerReader.java:readVolume(172)) - Finish verifying containers on volume /home/runner/work/ozone/ozone/hadoop-hdds/container-service/target/test-dir/TestDatanodeStateMachine/data/hdds
2022-04-03 12:50:13,318 [Listener at 127.0.0.1/46637] INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:buildContainerSet(257)) - Build ContainerSet costs 0s
2022-04-03 12:50:13,320 [Listener at 127.0.0.1/46637] WARN  server.ServerUtils (ServerUtils.java:getDefaultRatisDirectory(237)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2022-04-03 12:50:13,322 [Listener at 127.0.0.1/46637] INFO  server.RaftServer (ConfUtils.java:logGet(44)) - raft.rpc.type = GRPC (default)
2022-04-03 12:50:13,322 [Listener at 127.0.0.1/46637] INFO  grpc.GrpcFactory (GrpcFactory.java:checkPooledByteBufAllocatorUseCacheForAllThreads(48)) - PERFORMANCE WARNING: useCacheForAllThreads is true that may cause Netty to create a lot garbage objects and, as a result, trigger GC.
	It is recommended to disable useCacheForAllThreads by setting -Dorg.apache.ratis.thirdparty.io.netty.allocator.useCacheForAllThreads=false in command line.
2022-04-03 12:50:13,322 [Listener at 127.0.0.1/46637] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(44)) - raft.grpc.admin.port = 0 (custom)
2022-04-03 12:50:13,322 [Listener at 127.0.0.1/46637] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(44)) - raft.grpc.client.port = 0 (custom)
2022-04-03 12:50:13,323 [Listener at 127.0.0.1/46637] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(44)) - raft.grpc.server.port = 0 (default)
2022-04-03 12:50:13,323 [Listener at 127.0.0.1/46637] INFO  server.GrpcService (ConfUtils.java:logGet(44)) - raft.grpc.message.size.max = 32MB (=33554432) (custom)
2022-04-03 12:50:13,323 [Listener at 127.0.0.1/46637] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2022-04-03 12:50:13,323 [Listener at 127.0.0.1/46637] INFO  server.GrpcService (ConfUtils.java:logGet(44)) - raft.grpc.flow.control.window = 5MB (=5242880) (custom)
2022-04-03 12:50:13,323 [Listener at 127.0.0.1/46637] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.request.timeout = 60s (custom)
2022-04-03 12:50:13,324 [Listener at 127.0.0.1/46637] INFO  impl.DataStreamServerImpl (ConfUtils.java:logGet(44)) - raft.datastream.type = DISABLED (default)
2022-04-03 12:50:13,324 [Listener at 127.0.0.1/46637] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.slowness.timeout = 300s (custom)
2022-04-03 12:50:13,325 [Listener at 127.0.0.1/46637] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.leaderelection.leader.step-down.wait-time = 10s (default)
2022-04-03 12:50:13,325 [Listener at 127.0.0.1/46637] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.storage.dir = [/home/runner/work/ozone/ozone/hadoop-hdds/container-service/target/test-dir/TestDatanodeStateMachine/scm/ratis] (custom)
2022-04-03 12:50:13,330 [Listener at 127.0.0.1/46637] INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(132)) - GrpcServer channel type EpollServerSocketChannel
2022-04-03 12:50:13,344 [Test Data Node State Machine Thread - 0] ERROR datanode.InitDatanodeState (InitDatanodeState.java:call(84)) - Failed to get SCM addresses: ozone.scm.names need to be a set of valid DNS names or IP addresses. Empty address list found.
2022-04-03 12:50:13,344 [Listener at 127.0.0.1/46637] INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(356)) - Attempting to stop container services.
2022-04-03 12:50:13,346 [Listener at 127.0.0.1/46637] INFO  utils.BackgroundService (BackgroundService.java:shutdown(132)) - Shutting down service BlockDeletingService
2022-04-03 12:50:16,348 [Listener at 127.0.0.1/46637] INFO  common.TestDatanodeStateMachine (TestDatanodeStateMachine.java:lambda$testDatanodeStateMachineWithInvalidConfiguration$2(400)) - Test with ozone.scm.names = x..y
2022-04-03 12:50:16,349 [Listener at 127.0.0.1/46637] INFO  upgrade.AbstractLayoutVersionManager (AbstractLayoutVersionManager.java:init(79)) - Initializing Layout version manager with metadata layout = SCM_HA (version = 2), software layout = SCM_HA (version = 2)
2022-04-03 12:50:16,350 [Listener at 127.0.0.1/46637] WARN  util.MBeans (MBeans.java:getMBeanName(167)) - Error creating MBean object name: Hadoop:service=LayoutVersionManager,name=HDDSLayoutVersionManager
org.apache.hadoop.metrics2.MetricsException: org.apache.hadoop.metrics2.MetricsException: Hadoop:service=LayoutVersionManager,name=HDDSLayoutVersionManager already exists!
	at org.apache.hadoop.metrics2.lib.DefaultMetricsSystem.newObjectName(DefaultMetricsSystem.java:135)
	at org.apache.hadoop.metrics2.lib.DefaultMetricsSystem.newMBeanName(DefaultMetricsSystem.java:110)
	at org.apache.hadoop.metrics2.util.MBeans.getMBeanName(MBeans.java:165)
	at org.apache.hadoop.metrics2.util.MBeans.register(MBeans.java:97)
	at org.apache.hadoop.metrics2.util.MBeans.register(MBeans.java:73)
	at org.apache.hadoop.ozone.upgrade.AbstractLayoutVersionManager.init(AbstractLayoutVersionManager.java:84)
	at org.apache.hadoop.hdds.upgrade.HDDSLayoutVersionManager.<init>(HDDSLayoutVersionManager.java:50)
	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.<init>(DatanodeStateMachine.java:138)
	at org.apache.hadoop.ozone.container.common.TestDatanodeStateMachine.lambda$testDatanodeStateMachineWithInvalidConfiguration$2(TestDatanodeStateMachine.java:402)
	at java.util.ArrayList.forEach(ArrayList.java:1259)
	at org.apache.hadoop.ozone.container.common.TestDatanodeStateMachine.testDatanodeStateMachineWithInvalidConfiguration(TestDatanodeStateMachine.java:397)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115)
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Iterator.forEachRemaining(Iterator.java:116)
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485)
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82)
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:108)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:88)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.lambda$execute$0(EngineExecutionOrchestrator.java:54)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.withInterceptedStreams(EngineExecutionOrchestrator.java:67)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:52)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:96)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:75)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.execute(JUnitPlatformProvider.java:188)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:124)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:428)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:162)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:562)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:548)
Caused by: org.apache.hadoop.metrics2.MetricsException: Hadoop:service=LayoutVersionManager,name=HDDSLayoutVersionManager already exists!
	at org.apache.hadoop.metrics2.lib.DefaultMetricsSystem.newObjectName(DefaultMetricsSystem.java:131)
	... 61 more
2022-04-03 12:50:16,431 [Listener at 127.0.0.1/46637] INFO  reflections.Reflections (Reflections.java:scan(232)) - Reflections took 52 ms to scan 4 urls, producing 101 keys and 225 values 
2022-04-03 12:50:16,433 [Listener at 127.0.0.1/46637] ERROR statemachine.DatanodeStateMachine (DatanodeStateMachine.java:getEndPointTaskThreadPoolSize(219)) - Fail to get scm addresses
java.lang.IllegalArgumentException: Does not contain a valid host:port authority: x..y
	at org.apache.hadoop.net.NetUtils.createSocketAddr(NetUtils.java:232)
	at org.apache.hadoop.net.NetUtils.createSocketAddr(NetUtils.java:189)
	at org.apache.hadoop.net.NetUtils.createSocketAddr(NetUtils.java:169)
	at org.apache.hadoop.hdds.HddsUtils.getSCMAddressForDatanodes(HddsUtils.java:294)
	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.getEndPointTaskThreadPoolSize(DatanodeStateMachine.java:217)
	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.<init>(DatanodeStateMachine.java:144)
	at org.apache.hadoop.ozone.container.common.TestDatanodeStateMachine.lambda$testDatanodeStateMachineWithInvalidConfiguration$2(TestDatanodeStateMachine.java:402)
	at java.util.ArrayList.forEach(ArrayList.java:1259)
	at org.apache.hadoop.ozone.container.common.TestDatanodeStateMachine.testDatanodeStateMachineWithInvalidConfiguration(TestDatanodeStateMachine.java:397)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115)
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Iterator.forEachRemaining(Iterator.java:116)
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485)
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82)
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:108)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:88)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.lambda$execute$0(EngineExecutionOrchestrator.java:54)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.withInterceptedStreams(EngineExecutionOrchestrator.java:67)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:52)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:96)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:75)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.execute(JUnitPlatformProvider.java:188)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:124)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:428)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:162)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:562)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:548)
2022-04-03 12:50:16,433 [Listener at 127.0.0.1/46637] INFO  statemachine.DatanodeStateMachine (DatanodeStateMachine.java:getEndPointTaskThreadPoolSize(222)) - Datanode State Machine Task Thread Pool size 1
2022-04-03 12:50:16,451 [Listener at 127.0.0.1/46637] INFO  volume.HddsVolume (HddsVolume.java:<init>(120)) - Creating HddsVolume: /home/runner/work/ozone/ozone/hadoop-hdds/container-service/target/test-dir/TestDatanodeStateMachine/data/hdds of storage type : DISK capacity : 9223372036854775807
2022-04-03 12:50:16,451 [Listener at 127.0.0.1/46637] INFO  volume.MutableVolumeSet (MutableVolumeSet.java:initializeVolumeSet(168)) - Added Volume : /home/runner/work/ozone/ozone/hadoop-hdds/container-service/target/test-dir/TestDatanodeStateMachine/data/hdds to VolumeSet
2022-04-03 12:50:16,452 [Listener at 127.0.0.1/46637] INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(141)) - Scheduling a check for /home/runner/work/ozone/ozone/hadoop-hdds/container-service/target/test-dir/TestDatanodeStateMachine/data/hdds
2022-04-03 12:50:16,455 [Listener at 127.0.0.1/46637] INFO  volume.StorageVolumeChecker (StorageVolumeChecker.java:checkAllVolumes(202)) - Scheduled health check for volume /home/runner/work/ozone/ozone/hadoop-hdds/container-service/target/test-dir/TestDatanodeStateMachine/data/hdds
2022-04-03 12:50:16,465 [Listener at 127.0.0.1/46637] WARN  server.ServerUtils (ServerUtils.java:getDefaultRatisDirectory(237)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2022-04-03 12:50:16,469 [Listener at 127.0.0.1/46637] INFO  volume.MutableVolumeSet (MutableVolumeSet.java:initializeVolumeSet(168)) - Added Volume : /home/runner/work/ozone/ozone/hadoop-hdds/container-service/target/test-dir/TestDatanodeStateMachine/scm/ratis to VolumeSet
2022-04-03 12:50:16,474 [Listener at 127.0.0.1/46637] INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(141)) - Scheduling a check for /home/runner/work/ozone/ozone/hadoop-hdds/container-service/target/test-dir/TestDatanodeStateMachine/scm/ratis
2022-04-03 12:50:16,476 [Listener at 127.0.0.1/46637] INFO  volume.StorageVolumeChecker (StorageVolumeChecker.java:checkAllVolumes(202)) - Scheduled health check for volume /home/runner/work/ozone/ozone/hadoop-hdds/container-service/target/test-dir/TestDatanodeStateMachine/scm/ratis
2022-04-03 12:50:16,494 [Thread-52] INFO  ozoneimpl.ContainerReader (ContainerReader.java:readVolume(172)) - Finish verifying containers on volume /home/runner/work/ozone/ozone/hadoop-hdds/container-service/target/test-dir/TestDatanodeStateMachine/data/hdds
2022-04-03 12:50:16,494 [Listener at 127.0.0.1/46637] INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:buildContainerSet(257)) - Build ContainerSet costs 0s
2022-04-03 12:50:16,496 [Listener at 127.0.0.1/46637] WARN  server.ServerUtils (ServerUtils.java:getDefaultRatisDirectory(237)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2022-04-03 12:50:16,502 [Listener at 127.0.0.1/46637] INFO  server.RaftServer (ConfUtils.java:logGet(44)) - raft.rpc.type = GRPC (default)
2022-04-03 12:50:16,502 [Listener at 127.0.0.1/46637] INFO  grpc.GrpcFactory (GrpcFactory.java:checkPooledByteBufAllocatorUseCacheForAllThreads(48)) - PERFORMANCE WARNING: useCacheForAllThreads is true that may cause Netty to create a lot garbage objects and, as a result, trigger GC.
	It is recommended to disable useCacheForAllThreads by setting -Dorg.apache.ratis.thirdparty.io.netty.allocator.useCacheForAllThreads=false in command line.
2022-04-03 12:50:16,503 [Listener at 127.0.0.1/46637] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(44)) - raft.grpc.admin.port = 0 (custom)
2022-04-03 12:50:16,503 [Listener at 127.0.0.1/46637] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(44)) - raft.grpc.client.port = 0 (custom)
2022-04-03 12:50:16,503 [Listener at 127.0.0.1/46637] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(44)) - raft.grpc.server.port = 0 (default)
2022-04-03 12:50:16,503 [Listener at 127.0.0.1/46637] INFO  server.GrpcService (ConfUtils.java:logGet(44)) - raft.grpc.message.size.max = 32MB (=33554432) (custom)
2022-04-03 12:50:16,503 [Listener at 127.0.0.1/46637] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2022-04-03 12:50:16,503 [Listener at 127.0.0.1/46637] INFO  server.GrpcService (ConfUtils.java:logGet(44)) - raft.grpc.flow.control.window = 5MB (=5242880) (custom)
2022-04-03 12:50:16,503 [Listener at 127.0.0.1/46637] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.request.timeout = 60s (custom)
2022-04-03 12:50:16,504 [Listener at 127.0.0.1/46637] INFO  impl.DataStreamServerImpl (ConfUtils.java:logGet(44)) - raft.datastream.type = DISABLED (default)
2022-04-03 12:50:16,505 [Listener at 127.0.0.1/46637] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.slowness.timeout = 300s (custom)
2022-04-03 12:50:16,505 [Listener at 127.0.0.1/46637] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.leaderelection.leader.step-down.wait-time = 10s (default)
2022-04-03 12:50:16,505 [Listener at 127.0.0.1/46637] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.storage.dir = [/home/runner/work/ozone/ozone/hadoop-hdds/container-service/target/test-dir/TestDatanodeStateMachine/scm/ratis] (custom)
2022-04-03 12:50:16,511 [Listener at 127.0.0.1/46637] INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(132)) - GrpcServer channel type EpollServerSocketChannel
2022-04-03 12:50:16,542 [Test Data Node State Machine Thread - 0] ERROR datanode.InitDatanodeState (InitDatanodeState.java:call(84)) - Failed to get SCM addresses: Does not contain a valid host:port authority: x..y
2022-04-03 12:50:16,546 [Listener at 127.0.0.1/46637] INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(356)) - Attempting to stop container services.
2022-04-03 12:50:16,550 [Listener at 127.0.0.1/46637] INFO  utils.BackgroundService (BackgroundService.java:shutdown(132)) - Shutting down service BlockDeletingService
2022-04-03 12:50:19,551 [Listener at 127.0.0.1/46637] INFO  common.TestDatanodeStateMachine (TestDatanodeStateMachine.java:lambda$testDatanodeStateMachineWithInvalidConfiguration$2(400)) - Test with ozone.scm.names = scm:xyz
2022-04-03 12:50:19,552 [Listener at 127.0.0.1/46637] INFO  upgrade.AbstractLayoutVersionManager (AbstractLayoutVersionManager.java:init(79)) - Initializing Layout version manager with metadata layout = SCM_HA (version = 2), software layout = SCM_HA (version = 2)
2022-04-03 12:50:19,552 [Listener at 127.0.0.1/46637] WARN  util.MBeans (MBeans.java:getMBeanName(167)) - Error creating MBean object name: Hadoop:service=LayoutVersionManager,name=HDDSLayoutVersionManager
org.apache.hadoop.metrics2.MetricsException: org.apache.hadoop.metrics2.MetricsException: Hadoop:service=LayoutVersionManager,name=HDDSLayoutVersionManager already exists!
	at org.apache.hadoop.metrics2.lib.DefaultMetricsSystem.newObjectName(DefaultMetricsSystem.java:135)
	at org.apache.hadoop.metrics2.lib.DefaultMetricsSystem.newMBeanName(DefaultMetricsSystem.java:110)
	at org.apache.hadoop.metrics2.util.MBeans.getMBeanName(MBeans.java:165)
	at org.apache.hadoop.metrics2.util.MBeans.register(MBeans.java:97)
	at org.apache.hadoop.metrics2.util.MBeans.register(MBeans.java:73)
	at org.apache.hadoop.ozone.upgrade.AbstractLayoutVersionManager.init(AbstractLayoutVersionManager.java:84)
	at org.apache.hadoop.hdds.upgrade.HDDSLayoutVersionManager.<init>(HDDSLayoutVersionManager.java:50)
	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.<init>(DatanodeStateMachine.java:138)
	at org.apache.hadoop.ozone.container.common.TestDatanodeStateMachine.lambda$testDatanodeStateMachineWithInvalidConfiguration$2(TestDatanodeStateMachine.java:402)
	at java.util.ArrayList.forEach(ArrayList.java:1259)
	at org.apache.hadoop.ozone.container.common.TestDatanodeStateMachine.testDatanodeStateMachineWithInvalidConfiguration(TestDatanodeStateMachine.java:397)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115)
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Iterator.forEachRemaining(Iterator.java:116)
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485)
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82)
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:108)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:88)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.lambda$execute$0(EngineExecutionOrchestrator.java:54)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.withInterceptedStreams(EngineExecutionOrchestrator.java:67)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:52)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:96)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:75)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.execute(JUnitPlatformProvider.java:188)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:124)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:428)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:162)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:562)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:548)
Caused by: org.apache.hadoop.metrics2.MetricsException: Hadoop:service=LayoutVersionManager,name=HDDSLayoutVersionManager already exists!
	at org.apache.hadoop.metrics2.lib.DefaultMetricsSystem.newObjectName(DefaultMetricsSystem.java:131)
	... 61 more
2022-04-03 12:50:19,574 [Listener at 127.0.0.1/46637] INFO  reflections.Reflections (Reflections.java:scan(232)) - Reflections took 20 ms to scan 4 urls, producing 101 keys and 225 values 
2022-04-03 12:50:19,577 [Listener at 127.0.0.1/46637] ERROR statemachine.DatanodeStateMachine (DatanodeStateMachine.java:getEndPointTaskThreadPoolSize(219)) - Fail to get scm addresses
java.lang.IllegalArgumentException: Unparseable port number: scm:xyz
	at com.google.common.net.HostAndPort.fromString(HostAndPort.java:196)
	at org.apache.hadoop.hdds.HddsUtils.getHostPort(HddsUtils.java:222)
	at org.apache.hadoop.hdds.HddsUtils.getSCMAddressForDatanodes(HddsUtils.java:291)
	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.getEndPointTaskThreadPoolSize(DatanodeStateMachine.java:217)
	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.<init>(DatanodeStateMachine.java:144)
	at org.apache.hadoop.ozone.container.common.TestDatanodeStateMachine.lambda$testDatanodeStateMachineWithInvalidConfiguration$2(TestDatanodeStateMachine.java:402)
	at java.util.ArrayList.forEach(ArrayList.java:1259)
	at org.apache.hadoop.ozone.container.common.TestDatanodeStateMachine.testDatanodeStateMachineWithInvalidConfiguration(TestDatanodeStateMachine.java:397)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115)
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Iterator.forEachRemaining(Iterator.java:116)
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485)
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82)
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:108)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:88)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.lambda$execute$0(EngineExecutionOrchestrator.java:54)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.withInterceptedStreams(EngineExecutionOrchestrator.java:67)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:52)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:96)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:75)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.execute(JUnitPlatformProvider.java:188)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:124)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:428)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:162)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:562)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:548)
2022-04-03 12:50:19,579 [Listener at 127.0.0.1/46637] INFO  statemachine.DatanodeStateMachine (DatanodeStateMachine.java:getEndPointTaskThreadPoolSize(222)) - Datanode State Machine Task Thread Pool size 1
2022-04-03 12:50:19,580 [Listener at 127.0.0.1/46637] INFO  volume.HddsVolume (HddsVolume.java:<init>(120)) - Creating HddsVolume: /home/runner/work/ozone/ozone/hadoop-hdds/container-service/target/test-dir/TestDatanodeStateMachine/data/hdds of storage type : DISK capacity : 9223372036854775807
2022-04-03 12:50:19,581 [Listener at 127.0.0.1/46637] INFO  volume.MutableVolumeSet (MutableVolumeSet.java:initializeVolumeSet(168)) - Added Volume : /home/runner/work/ozone/ozone/hadoop-hdds/container-service/target/test-dir/TestDatanodeStateMachine/data/hdds to VolumeSet
2022-04-03 12:50:19,581 [Listener at 127.0.0.1/46637] INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(141)) - Scheduling a check for /home/runner/work/ozone/ozone/hadoop-hdds/container-service/target/test-dir/TestDatanodeStateMachine/data/hdds
2022-04-03 12:50:19,581 [Listener at 127.0.0.1/46637] INFO  volume.StorageVolumeChecker (StorageVolumeChecker.java:checkAllVolumes(202)) - Scheduled health check for volume /home/runner/work/ozone/ozone/hadoop-hdds/container-service/target/test-dir/TestDatanodeStateMachine/data/hdds
2022-04-03 12:50:19,587 [Listener at 127.0.0.1/46637] WARN  server.ServerUtils (ServerUtils.java:getDefaultRatisDirectory(237)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2022-04-03 12:50:19,588 [Listener at 127.0.0.1/46637] INFO  volume.MutableVolumeSet (MutableVolumeSet.java:initializeVolumeSet(168)) - Added Volume : /home/runner/work/ozone/ozone/hadoop-hdds/container-service/target/test-dir/TestDatanodeStateMachine/scm/ratis to VolumeSet
2022-04-03 12:50:19,588 [Listener at 127.0.0.1/46637] INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(141)) - Scheduling a check for /home/runner/work/ozone/ozone/hadoop-hdds/container-service/target/test-dir/TestDatanodeStateMachine/scm/ratis
2022-04-03 12:50:19,588 [Listener at 127.0.0.1/46637] INFO  volume.StorageVolumeChecker (StorageVolumeChecker.java:checkAllVolumes(202)) - Scheduled health check for volume /home/runner/work/ozone/ozone/hadoop-hdds/container-service/target/test-dir/TestDatanodeStateMachine/scm/ratis
2022-04-03 12:50:19,642 [Thread-54] INFO  ozoneimpl.ContainerReader (ContainerReader.java:readVolume(172)) - Finish verifying containers on volume /home/runner/work/ozone/ozone/hadoop-hdds/container-service/target/test-dir/TestDatanodeStateMachine/data/hdds
2022-04-03 12:50:19,643 [Listener at 127.0.0.1/46637] INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:buildContainerSet(257)) - Build ContainerSet costs 0s
2022-04-03 12:50:19,647 [Listener at 127.0.0.1/46637] WARN  server.ServerUtils (ServerUtils.java:getDefaultRatisDirectory(237)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2022-04-03 12:50:19,651 [Listener at 127.0.0.1/46637] INFO  server.RaftServer (ConfUtils.java:logGet(44)) - raft.rpc.type = GRPC (default)
2022-04-03 12:50:19,651 [Listener at 127.0.0.1/46637] INFO  grpc.GrpcFactory (GrpcFactory.java:checkPooledByteBufAllocatorUseCacheForAllThreads(48)) - PERFORMANCE WARNING: useCacheForAllThreads is true that may cause Netty to create a lot garbage objects and, as a result, trigger GC.
	It is recommended to disable useCacheForAllThreads by setting -Dorg.apache.ratis.thirdparty.io.netty.allocator.useCacheForAllThreads=false in command line.
2022-04-03 12:50:19,652 [Listener at 127.0.0.1/46637] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(44)) - raft.grpc.admin.port = 0 (custom)
2022-04-03 12:50:19,652 [Listener at 127.0.0.1/46637] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(44)) - raft.grpc.client.port = 0 (custom)
2022-04-03 12:50:19,652 [Listener at 127.0.0.1/46637] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(44)) - raft.grpc.server.port = 0 (default)
2022-04-03 12:50:19,653 [Listener at 127.0.0.1/46637] INFO  server.GrpcService (ConfUtils.java:logGet(44)) - raft.grpc.message.size.max = 32MB (=33554432) (custom)
2022-04-03 12:50:19,653 [Listener at 127.0.0.1/46637] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2022-04-03 12:50:19,662 [Listener at 127.0.0.1/46637] INFO  server.GrpcService (ConfUtils.java:logGet(44)) - raft.grpc.flow.control.window = 5MB (=5242880) (custom)
2022-04-03 12:50:19,663 [Listener at 127.0.0.1/46637] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.request.timeout = 60s (custom)
2022-04-03 12:50:19,678 [Listener at 127.0.0.1/46637] INFO  impl.DataStreamServerImpl (ConfUtils.java:logGet(44)) - raft.datastream.type = DISABLED (default)
2022-04-03 12:50:19,678 [Listener at 127.0.0.1/46637] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.slowness.timeout = 300s (custom)
2022-04-03 12:50:19,679 [Listener at 127.0.0.1/46637] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.leaderelection.leader.step-down.wait-time = 10s (default)
2022-04-03 12:50:19,680 [Listener at 127.0.0.1/46637] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.storage.dir = [/home/runner/work/ozone/ozone/hadoop-hdds/container-service/target/test-dir/TestDatanodeStateMachine/scm/ratis] (custom)
2022-04-03 12:50:19,683 [Listener at 127.0.0.1/46637] INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(132)) - GrpcServer channel type EpollServerSocketChannel
2022-04-03 12:50:19,703 [Test Data Node State Machine Thread - 0] ERROR datanode.InitDatanodeState (InitDatanodeState.java:call(84)) - Failed to get SCM addresses: Unparseable port number: scm:xyz
2022-04-03 12:50:19,718 [Listener at 127.0.0.1/46637] INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(356)) - Attempting to stop container services.
2022-04-03 12:50:19,719 [Listener at 127.0.0.1/46637] INFO  utils.BackgroundService (BackgroundService.java:shutdown(132)) - Shutting down service BlockDeletingService
2022-04-03 12:50:22,721 [Listener at 127.0.0.1/46637] INFO  common.TestDatanodeStateMachine (TestDatanodeStateMachine.java:lambda$testDatanodeStateMachineWithInvalidConfiguration$2(400)) - Test with ozone.scm.names = scm:123456
2022-04-03 12:50:22,723 [Listener at 127.0.0.1/46637] INFO  upgrade.AbstractLayoutVersionManager (AbstractLayoutVersionManager.java:init(79)) - Initializing Layout version manager with metadata layout = SCM_HA (version = 2), software layout = SCM_HA (version = 2)
2022-04-03 12:50:22,723 [Listener at 127.0.0.1/46637] WARN  util.MBeans (MBeans.java:getMBeanName(167)) - Error creating MBean object name: Hadoop:service=LayoutVersionManager,name=HDDSLayoutVersionManager
org.apache.hadoop.metrics2.MetricsException: org.apache.hadoop.metrics2.MetricsException: Hadoop:service=LayoutVersionManager,name=HDDSLayoutVersionManager already exists!
	at org.apache.hadoop.metrics2.lib.DefaultMetricsSystem.newObjectName(DefaultMetricsSystem.java:135)
	at org.apache.hadoop.metrics2.lib.DefaultMetricsSystem.newMBeanName(DefaultMetricsSystem.java:110)
	at org.apache.hadoop.metrics2.util.MBeans.getMBeanName(MBeans.java:165)
	at org.apache.hadoop.metrics2.util.MBeans.register(MBeans.java:97)
	at org.apache.hadoop.metrics2.util.MBeans.register(MBeans.java:73)
	at org.apache.hadoop.ozone.upgrade.AbstractLayoutVersionManager.init(AbstractLayoutVersionManager.java:84)
	at org.apache.hadoop.hdds.upgrade.HDDSLayoutVersionManager.<init>(HDDSLayoutVersionManager.java:50)
	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.<init>(DatanodeStateMachine.java:138)
	at org.apache.hadoop.ozone.container.common.TestDatanodeStateMachine.lambda$testDatanodeStateMachineWithInvalidConfiguration$2(TestDatanodeStateMachine.java:402)
	at java.util.ArrayList.forEach(ArrayList.java:1259)
	at org.apache.hadoop.ozone.container.common.TestDatanodeStateMachine.testDatanodeStateMachineWithInvalidConfiguration(TestDatanodeStateMachine.java:397)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115)
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Iterator.forEachRemaining(Iterator.java:116)
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485)
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82)
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:108)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:88)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.lambda$execute$0(EngineExecutionOrchestrator.java:54)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.withInterceptedStreams(EngineExecutionOrchestrator.java:67)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:52)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:96)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:75)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.execute(JUnitPlatformProvider.java:188)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:124)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:428)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:162)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:562)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:548)
Caused by: org.apache.hadoop.metrics2.MetricsException: Hadoop:service=LayoutVersionManager,name=HDDSLayoutVersionManager already exists!
	at org.apache.hadoop.metrics2.lib.DefaultMetricsSystem.newObjectName(DefaultMetricsSystem.java:131)
	... 61 more
2022-04-03 12:50:22,947 [Listener at 127.0.0.1/46637] INFO  reflections.Reflections (Reflections.java:scan(232)) - Reflections took 211 ms to scan 4 urls, producing 101 keys and 225 values 
2022-04-03 12:50:22,967 [Listener at 127.0.0.1/46637] ERROR statemachine.DatanodeStateMachine (DatanodeStateMachine.java:getEndPointTaskThreadPoolSize(219)) - Fail to get scm addresses
java.lang.IllegalArgumentException: Port number out of range: scm:123456
	at com.google.common.base.Preconditions.checkArgument(Preconditions.java:219)
	at com.google.common.net.HostAndPort.fromString(HostAndPort.java:198)
	at org.apache.hadoop.hdds.HddsUtils.getHostPort(HddsUtils.java:222)
	at org.apache.hadoop.hdds.HddsUtils.getSCMAddressForDatanodes(HddsUtils.java:291)
	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.getEndPointTaskThreadPoolSize(DatanodeStateMachine.java:217)
	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.<init>(DatanodeStateMachine.java:144)
	at org.apache.hadoop.ozone.container.common.TestDatanodeStateMachine.lambda$testDatanodeStateMachineWithInvalidConfiguration$2(TestDatanodeStateMachine.java:402)
	at java.util.ArrayList.forEach(ArrayList.java:1259)
	at org.apache.hadoop.ozone.container.common.TestDatanodeStateMachine.testDatanodeStateMachineWithInvalidConfiguration(TestDatanodeStateMachine.java:397)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115)
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Iterator.forEachRemaining(Iterator.java:116)
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485)
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82)
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:108)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:88)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.lambda$execute$0(EngineExecutionOrchestrator.java:54)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.withInterceptedStreams(EngineExecutionOrchestrator.java:67)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:52)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:96)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:75)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.execute(JUnitPlatformProvider.java:188)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:124)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:428)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:162)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:562)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:548)
2022-04-03 12:50:22,969 [Listener at 127.0.0.1/46637] INFO  statemachine.DatanodeStateMachine (DatanodeStateMachine.java:getEndPointTaskThreadPoolSize(222)) - Datanode State Machine Task Thread Pool size 1
2022-04-03 12:50:22,980 [Listener at 127.0.0.1/46637] INFO  volume.HddsVolume (HddsVolume.java:<init>(120)) - Creating HddsVolume: /home/runner/work/ozone/ozone/hadoop-hdds/container-service/target/test-dir/TestDatanodeStateMachine/data/hdds of storage type : DISK capacity : 9223372036854775807
2022-04-03 12:50:22,980 [Listener at 127.0.0.1/46637] INFO  volume.MutableVolumeSet (MutableVolumeSet.java:initializeVolumeSet(168)) - Added Volume : /home/runner/work/ozone/ozone/hadoop-hdds/container-service/target/test-dir/TestDatanodeStateMachine/data/hdds to VolumeSet
2022-04-03 12:50:22,981 [Listener at 127.0.0.1/46637] INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(141)) - Scheduling a check for /home/runner/work/ozone/ozone/hadoop-hdds/container-service/target/test-dir/TestDatanodeStateMachine/data/hdds
2022-04-03 12:50:22,990 [Listener at 127.0.0.1/46637] INFO  volume.StorageVolumeChecker (StorageVolumeChecker.java:checkAllVolumes(202)) - Scheduled health check for volume /home/runner/work/ozone/ozone/hadoop-hdds/container-service/target/test-dir/TestDatanodeStateMachine/data/hdds
2022-04-03 12:50:23,016 [Listener at 127.0.0.1/46637] WARN  server.ServerUtils (ServerUtils.java:getDefaultRatisDirectory(237)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2022-04-03 12:50:23,017 [Listener at 127.0.0.1/46637] INFO  volume.MutableVolumeSet (MutableVolumeSet.java:initializeVolumeSet(168)) - Added Volume : /home/runner/work/ozone/ozone/hadoop-hdds/container-service/target/test-dir/TestDatanodeStateMachine/scm/ratis to VolumeSet
2022-04-03 12:50:23,017 [Listener at 127.0.0.1/46637] INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(141)) - Scheduling a check for /home/runner/work/ozone/ozone/hadoop-hdds/container-service/target/test-dir/TestDatanodeStateMachine/scm/ratis
2022-04-03 12:50:23,018 [Listener at 127.0.0.1/46637] INFO  volume.StorageVolumeChecker (StorageVolumeChecker.java:checkAllVolumes(202)) - Scheduled health check for volume /home/runner/work/ozone/ozone/hadoop-hdds/container-service/target/test-dir/TestDatanodeStateMachine/scm/ratis
2022-04-03 12:50:23,035 [Thread-56] INFO  ozoneimpl.ContainerReader (ContainerReader.java:readVolume(172)) - Finish verifying containers on volume /home/runner/work/ozone/ozone/hadoop-hdds/container-service/target/test-dir/TestDatanodeStateMachine/data/hdds
2022-04-03 12:50:23,035 [Listener at 127.0.0.1/46637] INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:buildContainerSet(257)) - Build ContainerSet costs 0s
2022-04-03 12:50:23,039 [Listener at 127.0.0.1/46637] WARN  server.ServerUtils (ServerUtils.java:getDefaultRatisDirectory(237)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2022-04-03 12:50:23,043 [Listener at 127.0.0.1/46637] INFO  server.RaftServer (ConfUtils.java:logGet(44)) - raft.rpc.type = GRPC (default)
2022-04-03 12:50:23,043 [Listener at 127.0.0.1/46637] INFO  grpc.GrpcFactory (GrpcFactory.java:checkPooledByteBufAllocatorUseCacheForAllThreads(48)) - PERFORMANCE WARNING: useCacheForAllThreads is true that may cause Netty to create a lot garbage objects and, as a result, trigger GC.
	It is recommended to disable useCacheForAllThreads by setting -Dorg.apache.ratis.thirdparty.io.netty.allocator.useCacheForAllThreads=false in command line.
2022-04-03 12:50:23,044 [Listener at 127.0.0.1/46637] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(44)) - raft.grpc.admin.port = 0 (custom)
2022-04-03 12:50:23,044 [Listener at 127.0.0.1/46637] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(44)) - raft.grpc.client.port = 0 (custom)
2022-04-03 12:50:23,044 [Listener at 127.0.0.1/46637] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(44)) - raft.grpc.server.port = 0 (default)
2022-04-03 12:50:23,045 [Listener at 127.0.0.1/46637] INFO  server.GrpcService (ConfUtils.java:logGet(44)) - raft.grpc.message.size.max = 32MB (=33554432) (custom)
2022-04-03 12:50:23,045 [Listener at 127.0.0.1/46637] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2022-04-03 12:50:23,046 [Listener at 127.0.0.1/46637] INFO  server.GrpcService (ConfUtils.java:logGet(44)) - raft.grpc.flow.control.window = 5MB (=5242880) (custom)
2022-04-03 12:50:23,046 [Listener at 127.0.0.1/46637] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.request.timeout = 60s (custom)
2022-04-03 12:50:23,048 [Listener at 127.0.0.1/46637] INFO  impl.DataStreamServerImpl (ConfUtils.java:logGet(44)) - raft.datastream.type = DISABLED (default)
2022-04-03 12:50:23,049 [Listener at 127.0.0.1/46637] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.slowness.timeout = 300s (custom)
2022-04-03 12:50:23,050 [Listener at 127.0.0.1/46637] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.leaderelection.leader.step-down.wait-time = 10s (default)
2022-04-03 12:50:23,062 [Listener at 127.0.0.1/46637] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.storage.dir = [/home/runner/work/ozone/ozone/hadoop-hdds/container-service/target/test-dir/TestDatanodeStateMachine/scm/ratis] (custom)
2022-04-03 12:50:23,065 [Listener at 127.0.0.1/46637] INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(132)) - GrpcServer channel type EpollServerSocketChannel
2022-04-03 12:50:23,091 [Test Data Node State Machine Thread - 0] ERROR datanode.InitDatanodeState (InitDatanodeState.java:call(84)) - Failed to get SCM addresses: Port number out of range: scm:123456
2022-04-03 12:50:23,091 [Listener at 127.0.0.1/46637] INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(356)) - Attempting to stop container services.
2022-04-03 12:50:23,092 [Listener at 127.0.0.1/46637] INFO  utils.BackgroundService (BackgroundService.java:shutdown(132)) - Shutting down service BlockDeletingService
2022-04-03 12:50:26,093 [Listener at 127.0.0.1/46637] INFO  ipc.Server (Server.java:stop(3414)) - Stopping server on 46637
2022-04-03 12:50:26,098 [IPC Server listener on 46637] INFO  ipc.Server (Server.java:run(1376)) - Stopping IPC Server listener on 46637
2022-04-03 12:50:26,100 [IPC Server Responder] INFO  ipc.Server (Server.java:run(1512)) - Stopping IPC Server Responder
2022-04-03 12:50:26,162 [Listener at 127.0.0.1/46637] INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(90)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 1000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false.
2022-04-03 12:50:26,170 [Socket Reader #1 for port 36117] INFO  ipc.Server (Server.java:run(1265)) - Starting Socket Reader #1 for port 36117
2022-04-03 12:50:26,182 [IPC Server Responder] INFO  ipc.Server (Server.java:run(1507)) - IPC Server Responder: starting
2022-04-03 12:50:26,183 [IPC Server listener on 36117] INFO  ipc.Server (Server.java:run(1344)) - IPC Server listener on 36117: starting
2022-04-03 12:50:26,284 [Listener at 127.0.0.1/36117] INFO  upgrade.AbstractLayoutVersionManager (AbstractLayoutVersionManager.java:init(79)) - Initializing Layout version manager with metadata layout = INITIAL_VERSION (version = 0), software layout = SCM_HA (version = 2)
2022-04-03 12:50:26,284 [Listener at 127.0.0.1/36117] WARN  util.MBeans (MBeans.java:getMBeanName(167)) - Error creating MBean object name: Hadoop:service=LayoutVersionManager,name=HDDSLayoutVersionManager
org.apache.hadoop.metrics2.MetricsException: org.apache.hadoop.metrics2.MetricsException: Hadoop:service=LayoutVersionManager,name=HDDSLayoutVersionManager already exists!
	at org.apache.hadoop.metrics2.lib.DefaultMetricsSystem.newObjectName(DefaultMetricsSystem.java:135)
	at org.apache.hadoop.metrics2.lib.DefaultMetricsSystem.newMBeanName(DefaultMetricsSystem.java:110)
	at org.apache.hadoop.metrics2.util.MBeans.getMBeanName(MBeans.java:165)
	at org.apache.hadoop.metrics2.util.MBeans.register(MBeans.java:97)
	at org.apache.hadoop.metrics2.util.MBeans.register(MBeans.java:73)
	at org.apache.hadoop.ozone.upgrade.AbstractLayoutVersionManager.init(AbstractLayoutVersionManager.java:84)
	at org.apache.hadoop.hdds.upgrade.HDDSLayoutVersionManager.<init>(HDDSLayoutVersionManager.java:50)
	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.<init>(DatanodeStateMachine.java:138)
	at org.apache.hadoop.ozone.container.common.TestDatanodeStateMachine.testDatanodeStateContext(TestDatanodeStateMachine.java:219)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115)
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Iterator.forEachRemaining(Iterator.java:116)
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485)
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82)
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:108)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:88)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.lambda$execute$0(EngineExecutionOrchestrator.java:54)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.withInterceptedStreams(EngineExecutionOrchestrator.java:67)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:52)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:96)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:75)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.execute(JUnitPlatformProvider.java:188)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:124)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:428)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:162)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:562)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:548)
Caused by: org.apache.hadoop.metrics2.MetricsException: Hadoop:service=LayoutVersionManager,name=HDDSLayoutVersionManager already exists!
	at org.apache.hadoop.metrics2.lib.DefaultMetricsSystem.newObjectName(DefaultMetricsSystem.java:131)
	... 59 more
2022-04-03 12:50:26,392 [Listener at 127.0.0.1/36117] INFO  reflections.Reflections (Reflections.java:scan(232)) - Reflections took 73 ms to scan 4 urls, producing 101 keys and 225 values 
2022-04-03 12:50:26,402 [Listener at 127.0.0.1/36117] INFO  upgrade.HDDSLayoutVersionManager (HDDSLayoutVersionManager.java:lambda$registerUpgradeActions$0(76)) - Registering Upgrade Action : DatanodeSchemaV2FinalizeAction
2022-04-03 12:50:26,402 [Listener at 127.0.0.1/36117] INFO  upgrade.HDDSLayoutVersionManager (HDDSLayoutVersionManager.java:lambda$registerUpgradeActions$0(76)) - Registering Upgrade Action : ScmHAFinalizeUpgradeActionDatanode
2022-04-03 12:50:26,404 [Listener at 127.0.0.1/36117] INFO  statemachine.DatanodeStateMachine (DatanodeStateMachine.java:getEndPointTaskThreadPoolSize(222)) - Datanode State Machine Task Thread Pool size 2
2022-04-03 12:50:26,420 [Listener at 127.0.0.1/36117] INFO  volume.HddsVolume (HddsVolume.java:<init>(120)) - Creating HddsVolume: /home/runner/work/ozone/ozone/hadoop-hdds/container-service/target/test-dir/TestDatanodeStateMachine/data/hdds of storage type : DISK capacity : 9223372036854775807
2022-04-03 12:50:26,420 [Listener at 127.0.0.1/36117] INFO  volume.MutableVolumeSet (MutableVolumeSet.java:initializeVolumeSet(168)) - Added Volume : /home/runner/work/ozone/ozone/hadoop-hdds/container-service/target/test-dir/TestDatanodeStateMachine/data/hdds to VolumeSet
2022-04-03 12:50:26,420 [Listener at 127.0.0.1/36117] INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(141)) - Scheduling a check for /home/runner/work/ozone/ozone/hadoop-hdds/container-service/target/test-dir/TestDatanodeStateMachine/data/hdds
2022-04-03 12:50:26,442 [Listener at 127.0.0.1/36117] INFO  volume.StorageVolumeChecker (StorageVolumeChecker.java:checkAllVolumes(202)) - Scheduled health check for volume /home/runner/work/ozone/ozone/hadoop-hdds/container-service/target/test-dir/TestDatanodeStateMachine/data/hdds
2022-04-03 12:50:26,450 [Listener at 127.0.0.1/36117] WARN  server.ServerUtils (ServerUtils.java:getDefaultRatisDirectory(237)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2022-04-03 12:50:26,451 [Listener at 127.0.0.1/36117] INFO  volume.MutableVolumeSet (MutableVolumeSet.java:initializeVolumeSet(168)) - Added Volume : /home/runner/work/ozone/ozone/hadoop-hdds/container-service/target/test-dir/TestDatanodeStateMachine/scm/ratis to VolumeSet
2022-04-03 12:50:26,451 [Listener at 127.0.0.1/36117] INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(141)) - Scheduling a check for /home/runner/work/ozone/ozone/hadoop-hdds/container-service/target/test-dir/TestDatanodeStateMachine/scm/ratis
2022-04-03 12:50:26,454 [Listener at 127.0.0.1/36117] INFO  volume.StorageVolumeChecker (StorageVolumeChecker.java:checkAllVolumes(202)) - Scheduled health check for volume /home/runner/work/ozone/ozone/hadoop-hdds/container-service/target/test-dir/TestDatanodeStateMachine/scm/ratis
2022-04-03 12:50:26,466 [Thread-71] INFO  ozoneimpl.ContainerReader (ContainerReader.java:readVolume(172)) - Finish verifying containers on volume /home/runner/work/ozone/ozone/hadoop-hdds/container-service/target/test-dir/TestDatanodeStateMachine/data/hdds
2022-04-03 12:50:26,478 [Listener at 127.0.0.1/36117] INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:buildContainerSet(257)) - Build ContainerSet costs 0s
2022-04-03 12:50:26,479 [Listener at 127.0.0.1/36117] WARN  server.ServerUtils (ServerUtils.java:getDefaultRatisDirectory(237)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2022-04-03 12:50:26,480 [Listener at 127.0.0.1/36117] INFO  server.RaftServer (ConfUtils.java:logGet(44)) - raft.rpc.type = GRPC (default)
2022-04-03 12:50:26,481 [Listener at 127.0.0.1/36117] INFO  grpc.GrpcFactory (GrpcFactory.java:checkPooledByteBufAllocatorUseCacheForAllThreads(48)) - PERFORMANCE WARNING: useCacheForAllThreads is true that may cause Netty to create a lot garbage objects and, as a result, trigger GC.
	It is recommended to disable useCacheForAllThreads by setting -Dorg.apache.ratis.thirdparty.io.netty.allocator.useCacheForAllThreads=false in command line.
2022-04-03 12:50:26,481 [Listener at 127.0.0.1/36117] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(44)) - raft.grpc.admin.port = 0 (custom)
2022-04-03 12:50:26,483 [Listener at 127.0.0.1/36117] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(44)) - raft.grpc.client.port = 0 (custom)
2022-04-03 12:50:26,484 [Listener at 127.0.0.1/36117] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(44)) - raft.grpc.server.port = 0 (default)
2022-04-03 12:50:26,484 [Listener at 127.0.0.1/36117] INFO  server.GrpcService (ConfUtils.java:logGet(44)) - raft.grpc.message.size.max = 32MB (=33554432) (custom)
2022-04-03 12:50:26,485 [Listener at 127.0.0.1/36117] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2022-04-03 12:50:26,486 [Listener at 127.0.0.1/36117] INFO  server.GrpcService (ConfUtils.java:logGet(44)) - raft.grpc.flow.control.window = 5MB (=5242880) (custom)
2022-04-03 12:50:26,486 [Listener at 127.0.0.1/36117] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.request.timeout = 60s (custom)
2022-04-03 12:50:26,487 [Listener at 127.0.0.1/36117] INFO  impl.DataStreamServerImpl (ConfUtils.java:logGet(44)) - raft.datastream.type = DISABLED (default)
2022-04-03 12:50:26,487 [Listener at 127.0.0.1/36117] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.slowness.timeout = 300s (custom)
2022-04-03 12:50:26,487 [Listener at 127.0.0.1/36117] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.leaderelection.leader.step-down.wait-time = 10s (default)
2022-04-03 12:50:26,487 [Listener at 127.0.0.1/36117] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.storage.dir = [/home/runner/work/ozone/ozone/hadoop-hdds/container-service/target/test-dir/TestDatanodeStateMachine/scm/ratis] (custom)
2022-04-03 12:50:26,488 [Listener at 127.0.0.1/36117] INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(132)) - GrpcServer channel type EpollServerSocketChannel
2022-04-03 12:50:27,384 [EndpointStateMachine task thread for /127.0.0.1:36117 - 0 ] WARN  statemachine.EndpointStateMachine (EndpointStateMachine.java:logIfNeeded(236)) - Unable to communicate to SCM server at localhost:36117 for past 0 seconds.
java.net.SocketTimeoutException: Call From fv-az270-280/10.1.0.18 to localhost:36117 failed on socket timeout exception: java.net.SocketTimeoutException: 500 millis timeout while waiting for channel to be ready for read. ch : java.nio.channels.SocketChannel[connected local=/127.0.0.1:54512 remote=/127.0.0.1:36117]; For more details see:  http://wiki.apache.org/hadoop/SocketTimeout
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.hadoop.net.NetUtils.wrapWithMessage(NetUtils.java:913)
	at org.apache.hadoop.net.NetUtils.wrapException(NetUtils.java:848)
	at org.apache.hadoop.ipc.Client.getRpcResponse(Client.java:1577)
	at org.apache.hadoop.ipc.Client.call(Client.java:1519)
	at org.apache.hadoop.ipc.Client.call(Client.java:1416)
	at org.apache.hadoop.ipc.ProtobufRpcEngine$Invoker.invoke(ProtobufRpcEngine.java:236)
	at org.apache.hadoop.ipc.ProtobufRpcEngine$Invoker.invoke(ProtobufRpcEngine.java:123)
	at com.sun.proxy.$Proxy45.submitRequest(Unknown Source)
	at org.apache.hadoop.ozone.protocolPB.StorageContainerDatanodeProtocolClientSideTranslatorPB.submitRequest(StorageContainerDatanodeProtocolClientSideTranslatorPB.java:117)
	at org.apache.hadoop.ozone.protocolPB.StorageContainerDatanodeProtocolClientSideTranslatorPB.getVersion(StorageContainerDatanodeProtocolClientSideTranslatorPB.java:133)
	at org.apache.hadoop.ozone.container.common.states.endpoint.VersionEndpointTask.call(VersionEndpointTask.java:71)
	at org.apache.hadoop.ozone.container.common.states.endpoint.VersionEndpointTask.call(VersionEndpointTask.java:42)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.net.SocketTimeoutException: 500 millis timeout while waiting for channel to be ready for read. ch : java.nio.channels.SocketChannel[connected local=/127.0.0.1:54512 remote=/127.0.0.1:36117]
	at org.apache.hadoop.net.SocketIOWithTimeout.doIO(SocketIOWithTimeout.java:164)
	at org.apache.hadoop.net.SocketInputStream.read(SocketInputStream.java:161)
	at org.apache.hadoop.net.SocketInputStream.read(SocketInputStream.java:131)
	at java.io.FilterInputStream.read(FilterInputStream.java:133)
	at java.io.BufferedInputStream.fill(BufferedInputStream.java:246)
	at java.io.BufferedInputStream.read(BufferedInputStream.java:265)
	at java.io.FilterInputStream.read(FilterInputStream.java:83)
	at java.io.FilterInputStream.read(FilterInputStream.java:83)
	at org.apache.hadoop.ipc.Client$Connection$PingInputStream.read(Client.java:563)
	at java.io.DataInputStream.readInt(DataInputStream.java:387)
	at org.apache.hadoop.ipc.Client$IpcStreams.readResponse(Client.java:1892)
	at org.apache.hadoop.ipc.Client$Connection.receiveRpcResponse(Client.java:1202)
	at org.apache.hadoop.ipc.Client$Connection.run(Client.java:1098)
2022-04-03 12:50:27,569 [IPC Server handler 0 on default port 36117] WARN  ipc.Server (Server.java:processResponse(1717)) - IPC Server handler 0 on default port 36117, call Call#0 Retry#0 org.apache.hadoop.ozone.protocol.StorageContainerDatanodeProtocol.submitRequest from 127.0.0.1:54512: output error
2022-04-03 12:50:27,569 [IPC Server handler 0 on default port 36117] INFO  ipc.Server (Server.java:run(2979)) - IPC Server handler 0 on default port 36117 caught an exception
java.nio.channels.ClosedChannelException
	at sun.nio.ch.SocketChannelImpl.ensureWriteOpen(SocketChannelImpl.java:269)
	at sun.nio.ch.SocketChannelImpl.write(SocketChannelImpl.java:460)
	at org.apache.hadoop.ipc.Server.channelWrite(Server.java:3605)
	at org.apache.hadoop.ipc.Server.access$1700(Server.java:141)
	at org.apache.hadoop.ipc.Server$Responder.processResponse(Server.java:1667)
	at org.apache.hadoop.ipc.Server$Responder.doRespond(Server.java:1737)
	at org.apache.hadoop.ipc.Server$Connection.sendResponse(Server.java:2837)
	at org.apache.hadoop.ipc.Server$Connection.access$300(Server.java:1809)
	at org.apache.hadoop.ipc.Server$RpcCall.doResponse(Server.java:1117)
	at org.apache.hadoop.ipc.Server$Call.doResponse(Server.java:909)
	at org.apache.hadoop.ipc.Server$Call.sendResponse(Server.java:895)
	at org.apache.hadoop.ipc.Server$RpcCall.run(Server.java:1052)
	at org.apache.hadoop.ipc.Server$RpcCall.run(Server.java:963)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1878)
	at org.apache.hadoop.ipc.Server$Handler.run(Server.java:2966)
2022-04-03 12:51:17,438 [Listener at 127.0.0.1/36117] INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(356)) - Attempting to stop container services.
2022-04-03 12:51:17,439 [Listener at 127.0.0.1/36117] INFO  utils.BackgroundService (BackgroundService.java:shutdown(132)) - Shutting down service BlockDeletingService
2022-04-03 12:51:20,440 [Listener at 127.0.0.1/36117] INFO  ipc.Server (Server.java:stop(3414)) - Stopping server on 36117
2022-04-03 12:51:20,442 [IPC Server listener on 36117] INFO  ipc.Server (Server.java:run(1376)) - Stopping IPC Server listener on 36117
2022-04-03 12:51:20,442 [IPC Server Responder] INFO  ipc.Server (Server.java:run(1512)) - Stopping IPC Server Responder
