Attaching to ozone-topology_datanode_5_1, ozone-topology_datanode_1_1, ozone-topology_datanode_6_1, ozone-topology_datanode_2_1, ozone-topology_datanode_4_1, ozone-topology_datanode_3_1, ozone-topology_om_1, ozone-topology_scm_1
datanode_2_1  | Enabled profiling in kernel
datanode_2_1  | No '-XX:...' jvm parameters are used. Adding safer GC settings to the HADOOP_OPTS
datanode_2_1  | OpenJDK 64-Bit Server VM warning: Option UseConcMarkSweepGC was deprecated in version 9.0 and will likely be removed in a future release.
datanode_2_1  | 2020-04-17 18:50:15,541 [main] INFO ozone.HddsDatanodeService: STARTUP_MSG: 
datanode_2_1  | /************************************************************
datanode_2_1  | STARTUP_MSG: Starting HddsDatanodeService
datanode_2_1  | STARTUP_MSG:   host = 3511460463af/10.5.0.5
datanode_2_1  | STARTUP_MSG:   args = []
datanode_2_1  | STARTUP_MSG:   version = 3.2.0
datanode_2_1  | STARTUP_MSG:   classpath = /etc/hadoop:/opt/hadoop/share/hadoop/common/*:/opt/hadoop/share/ozone/lib/kerb-simplekdc-1.0.1.jar:/opt/hadoop/share/ozone/lib/jackson-databind-2.10.3.jar:/opt/hadoop/share/ozone/lib/protobuf-java-2.5.0.jar:/opt/hadoop/share/ozone/lib/bcpkix-jdk15on-1.60.jar:/opt/hadoop/share/ozone/lib/netty-3.10.5.Final.jar:/opt/hadoop/share/ozone/lib/ratis-proto-0.6.0-7c5b30d-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/commons-validator-1.6.jar:/opt/hadoop/share/ozone/lib/hadoop-hdds-client-0.6.0-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/jaxb-impl-2.3.0.1.jar:/opt/hadoop/share/ozone/lib/netty-all-4.1.47.Final.jar:/opt/hadoop/share/ozone/lib/kerb-core-1.0.1.jar:/opt/hadoop/share/ozone/lib/jsr305-3.0.0.jar:/opt/hadoop/share/ozone/lib/j2objc-annotations-1.3.jar:/opt/hadoop/share/ozone/lib/leveldbjni-all-1.8.jar:/opt/hadoop/share/ozone/lib/jetty-io-9.4.26.v20200117.jar:/opt/hadoop/share/ozone/lib/htrace-core4-4.1.0-incubating.jar:/opt/hadoop/share/ozone/lib/jaxb-api-2.3.0.jar:/opt/hadoop/share/ozone/lib/hadoop-annotations-3.2.0.jar:/opt/hadoop/share/ozone/lib/kerb-util-1.0.1.jar:/opt/hadoop/share/ozone/lib/jetty-http-9.4.26.v20200117.jar:/opt/hadoop/share/ozone/lib/jetty-xml-9.4.26.v20200117.jar:/opt/hadoop/share/ozone/lib/jackson-jaxrs-1.9.13.jar:/opt/hadoop/share/ozone/lib/ratis-thirdparty-misc-0.3.0.jar:/opt/hadoop/share/ozone/lib/kerby-xdr-1.0.1.jar:/opt/hadoop/share/ozone/lib/jackson-core-asl-1.9.13.jar:/opt/hadoop/share/ozone/lib/jetty-server-9.4.26.v20200117.jar:/opt/hadoop/share/ozone/lib/commons-net-3.6.jar:/opt/hadoop/share/ozone/lib/log4j-api-2.11.0.jar:/opt/hadoop/share/ozone/lib/hadoop-hdfs-3.2.0.jar:/opt/hadoop/share/ozone/lib/opentracing-api-0.31.0.jar:/opt/hadoop/share/ozone/lib/slf4j-log4j12-1.7.25.jar:/opt/hadoop/share/ozone/lib/hadoop-hdfs-client-3.2.0.jar:/opt/hadoop/share/ozone/lib/kerby-config-1.0.1.jar:/opt/hadoop/share/ozone/lib/libthrift-0.12.0.jar:/opt/hadoop/share/ozone/lib/jetty-util-ajax-9.4.26.v20200117.jar:/opt/hadoop/share/ozone/lib/metrics-core-3.2.4.jar:/opt/hadoop/share/ozone/lib/kerby-pkix-1.0.1.jar:/opt/hadoop/share/ozone/lib/guava-28.2-jre.jar:/opt/hadoop/share/ozone/lib/jetty-servlet-9.4.26.v20200117.jar:/opt/hadoop/share/ozone/lib/xz-1.0.jar:/opt/hadoop/share/ozone/lib/activation-1.1.1.jar:/opt/hadoop/share/ozone/lib/jsr311-api-1.1.1.jar:/opt/hadoop/share/ozone/lib/commons-beanutils-1.9.4.jar:/opt/hadoop/share/ozone/lib/rocksdbjni-6.6.4.jar:/opt/hadoop/share/ozone/lib/jetty-security-9.4.26.v20200117.jar:/opt/hadoop/share/ozone/lib/hadoop-hdds-container-service-0.6.0-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/kerb-server-1.0.1.jar:/opt/hadoop/share/ozone/lib/javax.servlet-api-3.1.0.jar:/opt/hadoop/share/ozone/lib/avro-1.7.7.jar:/opt/hadoop/share/ozone/lib/kerb-client-1.0.1.jar:/opt/hadoop/share/ozone/lib/jackson-xc-1.9.13.jar:/opt/hadoop/share/ozone/lib/disruptor-3.4.2.jar:/opt/hadoop/share/ozone/lib/simpleclient_common-0.7.0.jar:/opt/hadoop/share/ozone/lib/dnsjava-2.1.7.jar:/opt/hadoop/share/ozone/lib/jackson-annotations-2.10.3.jar:/opt/hadoop/share/ozone/lib/commons-configuration2-2.1.1.jar:/opt/hadoop/share/ozone/lib/json-smart-2.3.jar:/opt/hadoop/share/ozone/lib/token-provider-1.0.1.jar:/opt/hadoop/share/ozone/lib/log4j-1.2.17.jar:/opt/hadoop/share/ozone/lib/commons-daemon-1.0.13.jar:/opt/hadoop/share/ozone/lib/listenablefuture-9999.0-empty-to-avoid-conflict-with-guava.jar:/opt/hadoop/share/ozone/lib/bcprov-jdk15on-1.60.jar:/opt/hadoop/share/ozone/lib/ratis-grpc-0.6.0-7c5b30d-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/jetty-webapp-9.4.26.v20200117.jar:/opt/hadoop/share/ozone/lib/commons-lang3-3.7.jar:/opt/hadoop/share/ozone/lib/jaeger-client-0.34.0.jar:/opt/hadoop/share/ozone/lib/commons-compress-1.4.1.jar:/opt/hadoop/share/ozone/lib/accessors-smart-1.2.jar:/opt/hadoop/share/ozone/lib/re2j-1.1.jar:/opt/hadoop/share/ozone/lib/ratis-client-0.6.0-7c5b30d-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/commons-math3-3.1.1.jar:/opt/hadoop/share/ozone/lib/simpleclient_dropwizard-0.7.0.jar:/opt/hadoop/share/ozone/lib/opentracing-noop-0.31.0.jar:/opt/hadoop/share/ozone/lib/simpleclient-0.7.0.jar:/opt/hadoop/share/ozone/lib/httpclient-4.5.2.jar:/opt/hadoop/share/ozone/lib/jaeger-core-0.34.0.jar:/opt/hadoop/share/ozone/lib/asm-5.0.4.jar:/opt/hadoop/share/ozone/lib/kerby-util-1.0.1.jar:/opt/hadoop/share/ozone/lib/failureaccess-1.0.1.jar:/opt/hadoop/share/ozone/lib/jackson-mapper-asl-1.9.13.jar:/opt/hadoop/share/ozone/lib/jsp-api-2.1.jar:/opt/hadoop/share/ozone/lib/jsch-0.1.54.jar:/opt/hadoop/share/ozone/lib/ratis-metrics-0.6.0-7c5b30d-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/opentracing-tracerresolver-0.1.5.jar:/opt/hadoop/share/ozone/lib/ratis-common-0.6.0-7c5b30d-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/paranamer-2.3.jar:/opt/hadoop/share/ozone/lib/log4j-core-2.11.0.jar:/opt/hadoop/share/ozone/lib/nimbus-jose-jwt-7.9.jar:/opt/hadoop/share/ozone/lib/commons-codec-1.11.jar:/opt/hadoop/share/ozone/lib/commons-pool2-2.6.0.jar:/opt/hadoop/share/ozone/lib/jackson-datatype-jsr310-2.10.3.jar:/opt/hadoop/share/ozone/lib/gson-2.2.4.jar:/opt/hadoop/share/ozone/lib/jcip-annotations-1.0-1.jar:/opt/hadoop/share/ozone/lib/kerb-admin-1.0.1.jar:/opt/hadoop/share/ozone/lib/commons-io-2.5.jar:/opt/hadoop/share/ozone/lib/okio-1.13.0.jar:/opt/hadoop/share/ozone/lib/snakeyaml-1.16.jar:/opt/hadoop/share/ozone/lib/jetty-util-9.4.26.v20200117.jar:/opt/hadoop/share/ozone/lib/jersey-core-1.19.jar:/opt/hadoop/share/ozone/lib/hadoop-hdds-hadoop-dependency-client-0.6.0-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/checker-qual-2.10.0.jar:/opt/hadoop/share/ozone/lib/ratis-server-0.6.0-7c5b30d-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/hadoop-hdds-server-framework-0.6.0-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/error_prone_annotations-2.3.4.jar:/opt/hadoop/share/ozone/lib/picocli-3.9.6.jar:/opt/hadoop/share/ozone/lib/jaeger-thrift-0.34.0.jar:/opt/hadoop/share/ozone/lib/hadoop-hdds-common-0.6.0-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/commons-cli-1.2.jar:/opt/hadoop/share/ozone/lib/woodstox-core-5.0.3.jar:/opt/hadoop/share/ozone/lib/snappy-java-1.0.5.jar:/opt/hadoop/share/ozone/lib/javax.annotation-api-1.2.jar:/opt/hadoop/share/ozone/lib/jaeger-tracerresolver-0.34.0.jar:/opt/hadoop/share/ozone/lib/kerby-asn1-1.0.1.jar:/opt/hadoop/share/ozone/lib/okhttp-3.9.0.jar:/opt/hadoop/share/ozone/lib/hadoop-hdds-config-0.6.0-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/stax2-api-3.1.4.jar:/opt/hadoop/share/ozone/lib/commons-collections-3.2.2.jar:/opt/hadoop/share/ozone/lib/commons-digester-1.8.1.jar:/opt/hadoop/share/ozone/lib/jettison-1.1.jar:/opt/hadoop/share/ozone/lib/commons-text-1.4.jar:/opt/hadoop/share/ozone/lib/jackson-core-2.10.3.jar:/opt/hadoop/share/ozone/lib/jersey-servlet-1.19.jar:/opt/hadoop/share/ozone/lib/jersey-json-1.19.jar:/opt/hadoop/share/ozone/lib/slf4j-api-1.7.25.jar:/opt/hadoop/share/ozone/lib/commons-logging-1.1.3.jar:/opt/hadoop/share/ozone/lib/kerb-identity-1.0.1.jar:/opt/hadoop/share/ozone/lib/opentracing-util-0.31.0.jar:/opt/hadoop/share/ozone/lib/hadoop-hdds-hadoop-dependency-server-0.6.0-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/hadoop-common-3.2.0.jar:/opt/hadoop/share/ozone/lib/hadoop-auth-3.2.0.jar:/opt/hadoop/share/ozone/lib/kerb-common-1.0.1.jar:/opt/hadoop/share/ozone/lib/jaxb-core-2.3.0.1.jar:/opt/hadoop/share/ozone/lib/jersey-server-1.19.jar:/opt/hadoop/share/ozone/lib/hadoop-hdds-common-0.6.0-SNAPSHOT-tests.jar:/opt/hadoop/share/ozone/lib/kerb-crypto-1.0.1.jar:/opt/hadoop/share/ozone/lib/httpcore-4.4.4.jar:/opt/hadoop/share/ozone/lib/ratis-netty-0.6.0-7c5b30d-SNAPSHOT.jar:/opt/hadoop/share/ozone/web:/opt/hadoop/share/ozone/lib/hadoop-ozone-datanode-0.6.0-SNAPSHOT.jar
datanode_2_1  | STARTUP_MSG:   build = https://github.com/apache/hadoop.git -r e97acb3bd8f3befd27418996fa5d4b50bf2e17bf; compiled by 'sunilg' on 2019-01-15T17:34Z
datanode_2_1  | STARTUP_MSG:   java = 11.0.6
datanode_2_1  | ************************************************************/
datanode_2_1  | 2020-04-17 18:50:15,629 [main] INFO ozone.HddsDatanodeService: registered UNIX signal handlers for [TERM, HUP, INT]
datanode_2_1  | 2020-04-17 18:50:17,502 [main] INFO metrics.MetricRegistries: Loaded MetricRegistries class org.apache.ratis.metrics.impl.MetricRegistriesImpl
datanode_2_1  | 2020-04-17 18:50:18,090 [main] INFO impl.MetricsConfig: Loaded properties from hadoop-metrics2.properties
datanode_2_1  | 2020-04-17 18:50:19,164 [main] INFO impl.MetricsSystemImpl: Scheduled Metric snapshot period at 10 second(s).
datanode_2_1  | 2020-04-17 18:50:19,164 [main] INFO impl.MetricsSystemImpl: HddsDatanode metrics system started
datanode_2_1  | 2020-04-17 18:50:20,287 [main] INFO ozone.HddsDatanodeService: HddsDatanodeService host:3511460463af ip:10.5.0.5
datanode_2_1  | 2020-04-17 18:50:20,932 [main] INFO fs.SaveSpaceUsageToFile: Cached usage info file /data/hdds/scmUsed not found
datanode_2_1  | 2020-04-17 18:50:20,948 [main] INFO volume.HddsVolume: Creating Volume: /data/hdds/hdds of storage type : DISK and capacity : 89311358976
datanode_2_1  | 2020-04-17 18:50:20,952 [main] INFO volume.MutableVolumeSet: Added Volume : /data/hdds/hdds to VolumeSet
datanode_2_1  | 2020-04-17 18:50:21,028 [main] INFO volume.ThrottledAsyncChecker: Scheduling a check for /data/hdds/hdds
datanode_2_1  | 2020-04-17 18:50:21,152 [main] INFO volume.HddsVolumeChecker: Scheduled health check for volume /data/hdds/hdds
datanode_2_1  | 2020-04-17 18:50:26,803 [main] WARN server.ServerUtils: Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
datanode_2_1  | 2020-04-17 18:50:27,206 [main] INFO impl.RaftServerProxy: raft.rpc.type = GRPC (default)
datanode_2_1  | 2020-04-17 18:50:27,821 [main] INFO grpc.GrpcConfigKeys: raft.grpc.server.port = 9858 (custom)
datanode_2_1  | 2020-04-17 18:50:27,828 [main] INFO server.GrpcService: raft.grpc.message.size.max = 32MB (=33554432) (custom)
datanode_2_1  | 2020-04-17 18:50:27,830 [main] INFO server.RaftServerConfigKeys: raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
datanode_2_1  | 2020-04-17 18:50:27,831 [main] INFO server.GrpcService: raft.grpc.flow.control.window = 5MB (=5242880) (custom)
datanode_2_1  | 2020-04-17 18:50:27,875 [main] INFO server.RaftServerConfigKeys: raft.server.rpc.request.timeout = 60s (custom)
datanode_2_1  | 2020-04-17 18:50:29,697 [main] INFO server.RaftServerConfigKeys: raft.server.storage.dir = [/data/metadata/ratis] (custom)
datanode_2_1  | 2020-04-17 18:50:30,951 [main] INFO http.BaseHttpServer: Starting Web-server for hddsDatanode at: http://0.0.0.0:9882
datanode_2_1  | 2020-04-17 18:50:31,155 [main] INFO util.log: Logging initialized @21523ms to org.eclipse.jetty.util.log.Slf4jLog
datanode_2_1  | 2020-04-17 18:50:31,624 [main] INFO server.AuthenticationFilter: Unable to initialize FileSignerSecretProvider, falling back to use random secrets.
datanode_2_1  | 2020-04-17 18:50:31,634 [main] INFO http.HttpRequestLog: Http request log for http.requests.hddsDatanode is not defined
datanode_2_1  | 2020-04-17 18:50:31,644 [main] INFO http.HttpServer2: Added global filter 'safety' (class=org.apache.hadoop.hdds.server.http.HttpServer2$QuotingInputFilter)
datanode_2_1  | 2020-04-17 18:50:31,666 [main] INFO http.HttpServer2: Added filter static_user_filter (class=org.apache.hadoop.hdds.server.http.StaticUserWebFilter$StaticUserFilter) to context hddsDatanode
datanode_2_1  | 2020-04-17 18:50:31,675 [main] INFO http.HttpServer2: Added filter static_user_filter (class=org.apache.hadoop.hdds.server.http.StaticUserWebFilter$StaticUserFilter) to context logs
datanode_2_1  | 2020-04-17 18:50:31,675 [main] INFO http.HttpServer2: Added filter static_user_filter (class=org.apache.hadoop.hdds.server.http.StaticUserWebFilter$StaticUserFilter) to context static
datanode_2_1  | 2020-04-17 18:50:31,758 [main] WARN http.BaseHttpServer: /prof java profiling servlet is activated. Not safe for production!
datanode_2_1  | 2020-04-17 18:50:31,778 [main] INFO http.HttpServer2: Jetty bound to port 9882
datanode_2_1  | 2020-04-17 18:50:31,787 [main] INFO server.Server: jetty-9.4.26.v20200117; built: 2020-01-17T12:35:33.676Z; git: 7b38981d25d14afb4a12ff1f2596756144edf695; jvm 11.0.6+10-LTS
datanode_2_1  | 2020-04-17 18:50:32,112 [main] INFO server.session: DefaultSessionIdManager workerName=node0
datanode_2_1  | 2020-04-17 18:50:32,131 [main] INFO server.session: No SessionScavenger set, using defaults
datanode_2_1  | 2020-04-17 18:50:32,132 [main] INFO server.session: node0 Scavenging every 660000ms
datanode_2_1  | 2020-04-17 18:50:32,240 [main] INFO handler.ContextHandler: Started o.e.j.s.ServletContextHandler@7d7cac8{logs,/logs,file:///var/log/hadoop/,AVAILABLE}
datanode_2_1  | 2020-04-17 18:50:32,246 [main] INFO handler.ContextHandler: Started o.e.j.s.ServletContextHandler@5349b246{static,/static,jar:file:/opt/hadoop/share/ozone/lib/hadoop-hdds-container-service-0.6.0-SNAPSHOT.jar!/webapps/static,AVAILABLE}
datanode_2_1  | 2020-04-17 18:50:32,715 [main] INFO handler.ContextHandler: Started o.e.j.w.WebAppContext@480b57e2{hddsDatanode,/,file:///tmp/jetty-0_0_0_0-9882-hadoop-hdds-container-service-0_6_0-SNAPSHOT_jar-_-any-16186706484886464262.dir/webapp/,AVAILABLE}{jar:file:/opt/hadoop/share/ozone/lib/hadoop-hdds-container-service-0.6.0-SNAPSHOT.jar!/webapps/hddsDatanode}
datanode_2_1  | 2020-04-17 18:50:32,785 [main] INFO server.AbstractConnector: Started ServerConnector@1386313f{HTTP/1.1,[http/1.1]}{0.0.0.0:9882}
datanode_2_1  | 2020-04-17 18:50:32,785 [main] INFO server.Server: Started @23153ms
datanode_2_1  | 2020-04-17 18:50:32,809 [main] INFO impl.MetricsSinkAdapter: Sink prometheus started
datanode_2_1  | 2020-04-17 18:50:32,809 [main] INFO impl.MetricsSystemImpl: Registered sink prometheus
datanode_2_1  | 2020-04-17 18:50:32,823 [main] INFO http.BaseHttpServer: HTTP server of hddsDatanode listening at http://0.0.0.0:9882
datanode_2_1  | 2020-04-17 18:50:32,912 [org.apache.hadoop.util.JvmPauseMonitor$Monitor@19c4417a] INFO util.JvmPauseMonitor: Starting JVM pause monitor
datanode_2_1  | 2020-04-17 18:50:33,788 [Datanode State Machine Thread - 0] INFO datanode.InitDatanodeState: DatanodeDetails is persisted to /data/datanode.id
datanode_2_1  | 2020-04-17 18:50:36,048 [Datanode State Machine Thread - 0] INFO ipc.Client: Retrying connect to server: scm/10.5.0.71:9861. Already tried 0 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=2147483647, sleepTime=1000 MILLISECONDS)
datanode_2_1  | 2020-04-17 18:50:36,765 [Datanode State Machine Thread - 0] INFO ozoneimpl.OzoneContainer: Attempting to start container services.
datanode_2_1  | 2020-04-17 18:50:36,768 [Datanode State Machine Thread - 0] INFO ozoneimpl.OzoneContainer: Background container scanner has been disabled.
datanode_2_1  | 2020-04-17 18:50:36,773 [Datanode State Machine Thread - 0] INFO ratis.XceiverServerRatis: Starting XceiverServerRatis 0e99e1b0-220f-42bd-a39f-d4658f80d0e4 at port 9858
datanode_2_1  | 2020-04-17 18:50:36,879 [Datanode State Machine Thread - 0] INFO impl.RaftServerProxy: 0e99e1b0-220f-42bd-a39f-d4658f80d0e4: start RPC server
datanode_2_1  | 2020-04-17 18:50:37,273 [Datanode State Machine Thread - 0] INFO server.GrpcService: 0e99e1b0-220f-42bd-a39f-d4658f80d0e4: GrpcService started, listening on 0.0.0.0/0.0.0.0:9858
datanode_2_1  | 2020-04-17 18:50:42,003 [Command processor thread] INFO impl.RaftServerProxy: 0e99e1b0-220f-42bd-a39f-d4658f80d0e4: addNew group-48E39F71149F:[0e99e1b0-220f-42bd-a39f-d4658f80d0e4:10.5.0.5:9858] returns group-48E39F71149F:java.util.concurrent.CompletableFuture@52f71047[Not completed]
datanode_2_1  | 2020-04-17 18:50:42,076 [pool-69-thread-1] INFO impl.RaftServerImpl: 0e99e1b0-220f-42bd-a39f-d4658f80d0e4: new RaftServerImpl for group-48E39F71149F:[0e99e1b0-220f-42bd-a39f-d4658f80d0e4:10.5.0.5:9858] with ContainerStateMachine:uninitialized
datanode_2_1  | 2020-04-17 18:50:42,098 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.rpc.timeout.min = 5s (custom)
datanode_2_1  | 2020-04-17 18:50:42,111 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.rpc.timeout.max = 5200ms (custom)
datanode_2_1  | 2020-04-17 18:50:42,111 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.rpcslowness.timeout = 300s (custom)
datanode_2_1  | 2020-04-17 18:50:42,112 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.sleep.deviation.threshold = 300 (default)
datanode_2_1  | 2020-04-17 18:50:42,113 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.appender.install.snapshot.enabled = false (custom)
datanode_2_1  | 2020-04-17 18:50:42,160 [pool-69-thread-1] INFO impl.RaftServerImpl: 0e99e1b0-220f-42bd-a39f-d4658f80d0e4@group-48E39F71149F: ConfigurationManager, init=-1: [0e99e1b0-220f-42bd-a39f-d4658f80d0e4:10.5.0.5:9858], old=null, confs=<EMPTY_MAP>
datanode_2_1  | 2020-04-17 18:50:42,169 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.storage.dir = [/data/metadata/ratis] (custom)
datanode_2_1  | 2020-04-17 18:50:42,189 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.corruption.policy = EXCEPTION (default)
datanode_2_1  | 2020-04-17 18:50:42,204 [pool-69-thread-1] INFO storage.RaftStorageDirectory: The storage directory /data/metadata/ratis/046e56bb-291e-44e3-859a-48e39f71149f does not exist. Creating ...
datanode_2_1  | 2020-04-17 18:50:42,245 [pool-69-thread-1] INFO storage.RaftStorageDirectory: Lock on /data/metadata/ratis/046e56bb-291e-44e3-859a-48e39f71149f/in_use.lock acquired by nodename 6@3511460463af
datanode_2_1  | 2020-04-17 18:50:42,266 [pool-69-thread-1] INFO storage.RaftStorage: Storage directory /data/metadata/ratis/046e56bb-291e-44e3-859a-48e39f71149f has been successfully formatted.
datanode_2_1  | 2020-04-17 18:50:42,290 [pool-69-thread-1] INFO ratis.ContainerStateMachine: group-48E39F71149F: The snapshot info is null. Setting the last applied indexto:(t:0, i:~)
datanode_2_1  | 2020-04-17 18:50:42,291 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.notification.no-leader.timeout = 60s (default)
datanode_2_1  | 2020-04-17 18:50:42,308 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.use.memory = false (default)
datanode_2_1  | 2020-04-17 18:50:42,332 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.purge.gap = 1000000 (custom)
datanode_2_1  | 2020-04-17 18:50:42,347 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
datanode_2_1  | 2020-04-17 18:50:42,372 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.segment.size.max = 1048576 (custom)
datanode_2_1  | 2020-04-17 18:50:42,422 [pool-69-thread-1] INFO metrics.RatisMetrics: Creating Metrics Registry : ratis.log_worker.0e99e1b0-220f-42bd-a39f-d4658f80d0e4
datanode_2_1  | 2020-04-17 18:50:42,538 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.segment.cache.num.max = 2 (custom)
datanode_1_1  | Enabled profiling in kernel
datanode_1_1  | No '-XX:...' jvm parameters are used. Adding safer GC settings to the HADOOP_OPTS
datanode_1_1  | OpenJDK 64-Bit Server VM warning: Option UseConcMarkSweepGC was deprecated in version 9.0 and will likely be removed in a future release.
datanode_1_1  | 2020-04-17 18:50:15,274 [main] INFO ozone.HddsDatanodeService: STARTUP_MSG: 
datanode_1_1  | /************************************************************
datanode_1_1  | STARTUP_MSG: Starting HddsDatanodeService
datanode_1_1  | STARTUP_MSG:   host = 95d5c4783177/10.5.0.4
datanode_1_1  | STARTUP_MSG:   args = []
datanode_1_1  | STARTUP_MSG:   version = 3.2.0
datanode_2_1  | 2020-04-17 18:50:42,584 [pool-69-thread-1] INFO segmented.SegmentedRaftLogWorker: new 0e99e1b0-220f-42bd-a39f-d4658f80d0e4@group-48E39F71149F-SegmentedRaftLogWorker for RaftStorage:Storage Directory /data/metadata/ratis/046e56bb-291e-44e3-859a-48e39f71149f
datanode_2_1  | 2020-04-17 18:50:42,602 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.queue.byte-limit = 2147483647 (custom)
datanode_2_1  | 2020-04-17 18:50:42,603 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.queue.element-limit = 1024 (custom)
datanode_2_1  | 2020-04-17 18:50:42,610 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.segment.size.max = 1048576 (custom)
datanode_2_1  | 2020-04-17 18:50:42,616 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.preallocated.size = 16384 (custom)
datanode_2_1  | 2020-04-17 18:50:42,619 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.write.buffer.size = 1048576 (custom)
datanode_2_1  | 2020-04-17 18:50:42,625 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.force.sync.num = 128 (default)
datanode_2_1  | 2020-04-17 18:50:42,626 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.statemachine.data.sync = true (default)
datanode_2_1  | 2020-04-17 18:50:42,633 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.statemachine.data.sync.timeout = 10s (default)
datanode_2_1  | 2020-04-17 18:50:42,635 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
datanode_2_1  | 2020-04-17 18:50:42,726 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.statemachine.data.caching.enabled = true (custom)
datanode_2_1  | 2020-04-17 18:50:42,813 [pool-69-thread-1] INFO segmented.SegmentedRaftLogWorker: 0e99e1b0-220f-42bd-a39f-d4658f80d0e4@group-48E39F71149F-SegmentedRaftLogWorker: flushIndex: setUnconditionally 0 -> -1
datanode_2_1  | 2020-04-17 18:50:42,875 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.snapshot.auto.trigger.enabled = true (custom)
datanode_2_1  | 2020-04-17 18:50:42,877 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
datanode_2_1  | 2020-04-17 18:50:42,891 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.snapshot.retention.file.num = 5 (custom)
datanode_2_1  | 2020-04-17 18:50:42,903 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.retrycache.expirytime = 600000ms (custom)
datanode_2_1  | 2020-04-17 18:50:43,083 [pool-69-thread-1] INFO metrics.RatisMetrics: Creating Metrics Registry : ratis.leader_election.0e99e1b0-220f-42bd-a39f-d4658f80d0e4@group-48E39F71149F
datanode_2_1  | 2020-04-17 18:50:43,090 [pool-69-thread-1] INFO metrics.RatisMetrics: Creating Metrics Registry : ratis.server.0e99e1b0-220f-42bd-a39f-d4658f80d0e4@group-48E39F71149F
datanode_2_1  | 2020-04-17 18:50:43,116 [pool-69-thread-1] INFO impl.RaftServerImpl: 0e99e1b0-220f-42bd-a39f-d4658f80d0e4@group-48E39F71149F: start as a follower, conf=-1: [0e99e1b0-220f-42bd-a39f-d4658f80d0e4:10.5.0.5:9858], old=null
datanode_2_1  | 2020-04-17 18:50:43,124 [pool-69-thread-1] INFO impl.RaftServerImpl: 0e99e1b0-220f-42bd-a39f-d4658f80d0e4@group-48E39F71149F: changes role from      null to FOLLOWER at term 0 for startAsFollower
datanode_2_1  | 2020-04-17 18:50:43,131 [pool-69-thread-1] INFO impl.RoleInfo: 0e99e1b0-220f-42bd-a39f-d4658f80d0e4: start FollowerState
datanode_2_1  | 2020-04-17 18:50:43,168 [pool-69-thread-1] INFO util.JmxRegister: Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-48E39F71149F,id=0e99e1b0-220f-42bd-a39f-d4658f80d0e4
datanode_2_1  | 2020-04-17 18:50:43,169 [pool-69-thread-1] INFO metrics.RatisMetrics: Creating Metrics Registry : ratis.state_machine.0e99e1b0-220f-42bd-a39f-d4658f80d0e4@group-48E39F71149F
datanode_2_1  | 2020-04-17 18:50:43,259 [Command processor thread] INFO commandhandler.CreatePipelineCommandHandler: Created Pipeline RATIS ONE #id: "046e56bb-291e-44e3-859a-48e39f71149f"
datanode_2_1  | .
datanode_2_1  | 2020-04-17 18:50:43,266 [Command processor thread] INFO impl.RaftServerProxy: 0e99e1b0-220f-42bd-a39f-d4658f80d0e4: addNew group-385EF22ED913:[978c057e-5c38-4e20-8a8b-f271c823af7e:10.5.0.8:9858, a0acbcec-d753-414c-b077-647d02aaa7fb:10.5.0.7:9858, 0e99e1b0-220f-42bd-a39f-d4658f80d0e4:10.5.0.5:9858] returns group-385EF22ED913:java.util.concurrent.CompletableFuture@6206623a[Not completed]
datanode_2_1  | 2020-04-17 18:50:43,269 [pool-69-thread-1] INFO impl.RaftServerImpl: 0e99e1b0-220f-42bd-a39f-d4658f80d0e4: new RaftServerImpl for group-385EF22ED913:[978c057e-5c38-4e20-8a8b-f271c823af7e:10.5.0.8:9858, a0acbcec-d753-414c-b077-647d02aaa7fb:10.5.0.7:9858, 0e99e1b0-220f-42bd-a39f-d4658f80d0e4:10.5.0.5:9858] with ContainerStateMachine:uninitialized
datanode_2_1  | 2020-04-17 18:50:43,278 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.rpc.timeout.min = 5s (custom)
datanode_1_1  | STARTUP_MSG:   classpath = /etc/hadoop:/opt/hadoop/share/hadoop/common/*:/opt/hadoop/share/ozone/lib/kerb-simplekdc-1.0.1.jar:/opt/hadoop/share/ozone/lib/jackson-databind-2.10.3.jar:/opt/hadoop/share/ozone/lib/protobuf-java-2.5.0.jar:/opt/hadoop/share/ozone/lib/bcpkix-jdk15on-1.60.jar:/opt/hadoop/share/ozone/lib/netty-3.10.5.Final.jar:/opt/hadoop/share/ozone/lib/ratis-proto-0.6.0-7c5b30d-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/commons-validator-1.6.jar:/opt/hadoop/share/ozone/lib/hadoop-hdds-client-0.6.0-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/jaxb-impl-2.3.0.1.jar:/opt/hadoop/share/ozone/lib/netty-all-4.1.47.Final.jar:/opt/hadoop/share/ozone/lib/kerb-core-1.0.1.jar:/opt/hadoop/share/ozone/lib/jsr305-3.0.0.jar:/opt/hadoop/share/ozone/lib/j2objc-annotations-1.3.jar:/opt/hadoop/share/ozone/lib/leveldbjni-all-1.8.jar:/opt/hadoop/share/ozone/lib/jetty-io-9.4.26.v20200117.jar:/opt/hadoop/share/ozone/lib/htrace-core4-4.1.0-incubating.jar:/opt/hadoop/share/ozone/lib/jaxb-api-2.3.0.jar:/opt/hadoop/share/ozone/lib/hadoop-annotations-3.2.0.jar:/opt/hadoop/share/ozone/lib/kerb-util-1.0.1.jar:/opt/hadoop/share/ozone/lib/jetty-http-9.4.26.v20200117.jar:/opt/hadoop/share/ozone/lib/jetty-xml-9.4.26.v20200117.jar:/opt/hadoop/share/ozone/lib/jackson-jaxrs-1.9.13.jar:/opt/hadoop/share/ozone/lib/ratis-thirdparty-misc-0.3.0.jar:/opt/hadoop/share/ozone/lib/kerby-xdr-1.0.1.jar:/opt/hadoop/share/ozone/lib/jackson-core-asl-1.9.13.jar:/opt/hadoop/share/ozone/lib/jetty-server-9.4.26.v20200117.jar:/opt/hadoop/share/ozone/lib/commons-net-3.6.jar:/opt/hadoop/share/ozone/lib/log4j-api-2.11.0.jar:/opt/hadoop/share/ozone/lib/hadoop-hdfs-3.2.0.jar:/opt/hadoop/share/ozone/lib/opentracing-api-0.31.0.jar:/opt/hadoop/share/ozone/lib/slf4j-log4j12-1.7.25.jar:/opt/hadoop/share/ozone/lib/hadoop-hdfs-client-3.2.0.jar:/opt/hadoop/share/ozone/lib/kerby-config-1.0.1.jar:/opt/hadoop/share/ozone/lib/libthrift-0.12.0.jar:/opt/hadoop/share/ozone/lib/jetty-util-ajax-9.4.26.v20200117.jar:/opt/hadoop/share/ozone/lib/metrics-core-3.2.4.jar:/opt/hadoop/share/ozone/lib/kerby-pkix-1.0.1.jar:/opt/hadoop/share/ozone/lib/guava-28.2-jre.jar:/opt/hadoop/share/ozone/lib/jetty-servlet-9.4.26.v20200117.jar:/opt/hadoop/share/ozone/lib/xz-1.0.jar:/opt/hadoop/share/ozone/lib/activation-1.1.1.jar:/opt/hadoop/share/ozone/lib/jsr311-api-1.1.1.jar:/opt/hadoop/share/ozone/lib/commons-beanutils-1.9.4.jar:/opt/hadoop/share/ozone/lib/rocksdbjni-6.6.4.jar:/opt/hadoop/share/ozone/lib/jetty-security-9.4.26.v20200117.jar:/opt/hadoop/share/ozone/lib/hadoop-hdds-container-service-0.6.0-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/kerb-server-1.0.1.jar:/opt/hadoop/share/ozone/lib/javax.servlet-api-3.1.0.jar:/opt/hadoop/share/ozone/lib/avro-1.7.7.jar:/opt/hadoop/share/ozone/lib/kerb-client-1.0.1.jar:/opt/hadoop/share/ozone/lib/jackson-xc-1.9.13.jar:/opt/hadoop/share/ozone/lib/disruptor-3.4.2.jar:/opt/hadoop/share/ozone/lib/simpleclient_common-0.7.0.jar:/opt/hadoop/share/ozone/lib/dnsjava-2.1.7.jar:/opt/hadoop/share/ozone/lib/jackson-annotations-2.10.3.jar:/opt/hadoop/share/ozone/lib/commons-configuration2-2.1.1.jar:/opt/hadoop/share/ozone/lib/json-smart-2.3.jar:/opt/hadoop/share/ozone/lib/token-provider-1.0.1.jar:/opt/hadoop/share/ozone/lib/log4j-1.2.17.jar:/opt/hadoop/share/ozone/lib/commons-daemon-1.0.13.jar:/opt/hadoop/share/ozone/lib/listenablefuture-9999.0-empty-to-avoid-conflict-with-guava.jar:/opt/hadoop/share/ozone/lib/bcprov-jdk15on-1.60.jar:/opt/hadoop/share/ozone/lib/ratis-grpc-0.6.0-7c5b30d-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/jetty-webapp-9.4.26.v20200117.jar:/opt/hadoop/share/ozone/lib/commons-lang3-3.7.jar:/opt/hadoop/share/ozone/lib/jaeger-client-0.34.0.jar:/opt/hadoop/share/ozone/lib/commons-compress-1.4.1.jar:/opt/hadoop/share/ozone/lib/accessors-smart-1.2.jar:/opt/hadoop/share/ozone/lib/re2j-1.1.jar:/opt/hadoop/share/ozone/lib/ratis-client-0.6.0-7c5b30d-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/commons-math3-3.1.1.jar:/opt/hadoop/share/ozone/lib/simpleclient_dropwizard-0.7.0.jar:/opt/hadoop/share/ozone/lib/opentracing-noop-0.31.0.jar:/opt/hadoop/share/ozone/lib/simpleclient-0.7.0.jar:/opt/hadoop/share/ozone/lib/httpclient-4.5.2.jar:/opt/hadoop/share/ozone/lib/jaeger-core-0.34.0.jar:/opt/hadoop/share/ozone/lib/asm-5.0.4.jar:/opt/hadoop/share/ozone/lib/kerby-util-1.0.1.jar:/opt/hadoop/share/ozone/lib/failureaccess-1.0.1.jar:/opt/hadoop/share/ozone/lib/jackson-mapper-asl-1.9.13.jar:/opt/hadoop/share/ozone/lib/jsp-api-2.1.jar:/opt/hadoop/share/ozone/lib/jsch-0.1.54.jar:/opt/hadoop/share/ozone/lib/ratis-metrics-0.6.0-7c5b30d-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/opentracing-tracerresolver-0.1.5.jar:/opt/hadoop/share/ozone/lib/ratis-common-0.6.0-7c5b30d-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/paranamer-2.3.jar:/opt/hadoop/share/ozone/lib/log4j-core-2.11.0.jar:/opt/hadoop/share/ozone/lib/nimbus-jose-jwt-7.9.jar:/opt/hadoop/share/ozone/lib/commons-codec-1.11.jar:/opt/hadoop/share/ozone/lib/commons-pool2-2.6.0.jar:/opt/hadoop/share/ozone/lib/jackson-datatype-jsr310-2.10.3.jar:/opt/hadoop/share/ozone/lib/gson-2.2.4.jar:/opt/hadoop/share/ozone/lib/jcip-annotations-1.0-1.jar:/opt/hadoop/share/ozone/lib/kerb-admin-1.0.1.jar:/opt/hadoop/share/ozone/lib/commons-io-2.5.jar:/opt/hadoop/share/ozone/lib/okio-1.13.0.jar:/opt/hadoop/share/ozone/lib/snakeyaml-1.16.jar:/opt/hadoop/share/ozone/lib/jetty-util-9.4.26.v20200117.jar:/opt/hadoop/share/ozone/lib/jersey-core-1.19.jar:/opt/hadoop/share/ozone/lib/hadoop-hdds-hadoop-dependency-client-0.6.0-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/checker-qual-2.10.0.jar:/opt/hadoop/share/ozone/lib/ratis-server-0.6.0-7c5b30d-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/hadoop-hdds-server-framework-0.6.0-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/error_prone_annotations-2.3.4.jar:/opt/hadoop/share/ozone/lib/picocli-3.9.6.jar:/opt/hadoop/share/ozone/lib/jaeger-thrift-0.34.0.jar:/opt/hadoop/share/ozone/lib/hadoop-hdds-common-0.6.0-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/commons-cli-1.2.jar:/opt/hadoop/share/ozone/lib/woodstox-core-5.0.3.jar:/opt/hadoop/share/ozone/lib/snappy-java-1.0.5.jar:/opt/hadoop/share/ozone/lib/javax.annotation-api-1.2.jar:/opt/hadoop/share/ozone/lib/jaeger-tracerresolver-0.34.0.jar:/opt/hadoop/share/ozone/lib/kerby-asn1-1.0.1.jar:/opt/hadoop/share/ozone/lib/okhttp-3.9.0.jar:/opt/hadoop/share/ozone/lib/hadoop-hdds-config-0.6.0-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/stax2-api-3.1.4.jar:/opt/hadoop/share/ozone/lib/commons-collections-3.2.2.jar:/opt/hadoop/share/ozone/lib/commons-digester-1.8.1.jar:/opt/hadoop/share/ozone/lib/jettison-1.1.jar:/opt/hadoop/share/ozone/lib/commons-text-1.4.jar:/opt/hadoop/share/ozone/lib/jackson-core-2.10.3.jar:/opt/hadoop/share/ozone/lib/jersey-servlet-1.19.jar:/opt/hadoop/share/ozone/lib/jersey-json-1.19.jar:/opt/hadoop/share/ozone/lib/slf4j-api-1.7.25.jar:/opt/hadoop/share/ozone/lib/commons-logging-1.1.3.jar:/opt/hadoop/share/ozone/lib/kerb-identity-1.0.1.jar:/opt/hadoop/share/ozone/lib/opentracing-util-0.31.0.jar:/opt/hadoop/share/ozone/lib/hadoop-hdds-hadoop-dependency-server-0.6.0-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/hadoop-common-3.2.0.jar:/opt/hadoop/share/ozone/lib/hadoop-auth-3.2.0.jar:/opt/hadoop/share/ozone/lib/kerb-common-1.0.1.jar:/opt/hadoop/share/ozone/lib/jaxb-core-2.3.0.1.jar:/opt/hadoop/share/ozone/lib/jersey-server-1.19.jar:/opt/hadoop/share/ozone/lib/hadoop-hdds-common-0.6.0-SNAPSHOT-tests.jar:/opt/hadoop/share/ozone/lib/kerb-crypto-1.0.1.jar:/opt/hadoop/share/ozone/lib/httpcore-4.4.4.jar:/opt/hadoop/share/ozone/lib/ratis-netty-0.6.0-7c5b30d-SNAPSHOT.jar:/opt/hadoop/share/ozone/web:/opt/hadoop/share/ozone/lib/hadoop-ozone-datanode-0.6.0-SNAPSHOT.jar
datanode_1_1  | STARTUP_MSG:   build = https://github.com/apache/hadoop.git -r e97acb3bd8f3befd27418996fa5d4b50bf2e17bf; compiled by 'sunilg' on 2019-01-15T17:34Z
datanode_1_1  | STARTUP_MSG:   java = 11.0.6
datanode_1_1  | ************************************************************/
datanode_1_1  | 2020-04-17 18:50:15,348 [main] INFO ozone.HddsDatanodeService: registered UNIX signal handlers for [TERM, HUP, INT]
datanode_1_1  | 2020-04-17 18:50:17,535 [main] INFO metrics.MetricRegistries: Loaded MetricRegistries class org.apache.ratis.metrics.impl.MetricRegistriesImpl
datanode_1_1  | 2020-04-17 18:50:18,154 [main] INFO impl.MetricsConfig: Loaded properties from hadoop-metrics2.properties
datanode_1_1  | 2020-04-17 18:50:19,587 [main] INFO impl.MetricsSystemImpl: Scheduled Metric snapshot period at 10 second(s).
datanode_1_1  | 2020-04-17 18:50:19,587 [main] INFO impl.MetricsSystemImpl: HddsDatanode metrics system started
datanode_1_1  | 2020-04-17 18:50:20,783 [main] INFO ozone.HddsDatanodeService: HddsDatanodeService host:95d5c4783177 ip:10.5.0.4
datanode_1_1  | 2020-04-17 18:50:21,282 [main] INFO fs.SaveSpaceUsageToFile: Cached usage info file /data/hdds/scmUsed not found
datanode_1_1  | 2020-04-17 18:50:21,297 [main] INFO volume.HddsVolume: Creating Volume: /data/hdds/hdds of storage type : DISK and capacity : 89311358976
datanode_1_1  | 2020-04-17 18:50:21,299 [main] INFO volume.MutableVolumeSet: Added Volume : /data/hdds/hdds to VolumeSet
datanode_1_1  | 2020-04-17 18:50:21,408 [main] INFO volume.ThrottledAsyncChecker: Scheduling a check for /data/hdds/hdds
datanode_1_1  | 2020-04-17 18:50:21,541 [main] INFO volume.HddsVolumeChecker: Scheduled health check for volume /data/hdds/hdds
datanode_1_1  | 2020-04-17 18:50:27,287 [main] WARN server.ServerUtils: Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
datanode_1_1  | 2020-04-17 18:50:27,626 [main] INFO impl.RaftServerProxy: raft.rpc.type = GRPC (default)
datanode_1_1  | 2020-04-17 18:50:28,093 [main] INFO grpc.GrpcConfigKeys: raft.grpc.server.port = 9858 (custom)
datanode_1_1  | 2020-04-17 18:50:28,107 [main] INFO server.GrpcService: raft.grpc.message.size.max = 32MB (=33554432) (custom)
datanode_1_1  | 2020-04-17 18:50:28,113 [main] INFO server.RaftServerConfigKeys: raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
datanode_1_1  | 2020-04-17 18:50:28,123 [main] INFO server.GrpcService: raft.grpc.flow.control.window = 5MB (=5242880) (custom)
datanode_1_1  | 2020-04-17 18:50:28,131 [main] INFO server.RaftServerConfigKeys: raft.server.rpc.request.timeout = 60s (custom)
datanode_1_1  | 2020-04-17 18:50:29,746 [main] INFO server.RaftServerConfigKeys: raft.server.storage.dir = [/data/metadata/ratis] (custom)
datanode_1_1  | 2020-04-17 18:50:30,691 [main] INFO http.BaseHttpServer: Starting Web-server for hddsDatanode at: http://0.0.0.0:9882
datanode_1_1  | 2020-04-17 18:50:30,826 [main] INFO util.log: Logging initialized @21452ms to org.eclipse.jetty.util.log.Slf4jLog
datanode_1_1  | 2020-04-17 18:50:31,408 [main] INFO server.AuthenticationFilter: Unable to initialize FileSignerSecretProvider, falling back to use random secrets.
datanode_1_1  | 2020-04-17 18:50:31,434 [main] INFO http.HttpRequestLog: Http request log for http.requests.hddsDatanode is not defined
datanode_1_1  | 2020-04-17 18:50:31,491 [main] INFO http.HttpServer2: Added global filter 'safety' (class=org.apache.hadoop.hdds.server.http.HttpServer2$QuotingInputFilter)
datanode_1_1  | 2020-04-17 18:50:31,511 [main] INFO http.HttpServer2: Added filter static_user_filter (class=org.apache.hadoop.hdds.server.http.StaticUserWebFilter$StaticUserFilter) to context hddsDatanode
datanode_1_1  | 2020-04-17 18:50:31,520 [main] INFO http.HttpServer2: Added filter static_user_filter (class=org.apache.hadoop.hdds.server.http.StaticUserWebFilter$StaticUserFilter) to context static
datanode_1_1  | 2020-04-17 18:50:31,523 [main] INFO http.HttpServer2: Added filter static_user_filter (class=org.apache.hadoop.hdds.server.http.StaticUserWebFilter$StaticUserFilter) to context logs
datanode_1_1  | 2020-04-17 18:50:31,699 [main] WARN http.BaseHttpServer: /prof java profiling servlet is activated. Not safe for production!
datanode_1_1  | 2020-04-17 18:50:31,728 [main] INFO http.HttpServer2: Jetty bound to port 9882
datanode_1_1  | 2020-04-17 18:50:31,732 [main] INFO server.Server: jetty-9.4.26.v20200117; built: 2020-01-17T12:35:33.676Z; git: 7b38981d25d14afb4a12ff1f2596756144edf695; jvm 11.0.6+10-LTS
datanode_1_1  | 2020-04-17 18:50:32,147 [main] INFO server.session: DefaultSessionIdManager workerName=node0
datanode_1_1  | 2020-04-17 18:50:32,158 [main] INFO server.session: No SessionScavenger set, using defaults
datanode_1_1  | 2020-04-17 18:50:32,163 [main] INFO server.session: node0 Scavenging every 600000ms
datanode_1_1  | 2020-04-17 18:50:32,224 [main] INFO handler.ContextHandler: Started o.e.j.s.ServletContextHandler@6f76c2cc{logs,/logs,file:///var/log/hadoop/,AVAILABLE}
datanode_1_1  | 2020-04-17 18:50:32,234 [main] INFO handler.ContextHandler: Started o.e.j.s.ServletContextHandler@441b8382{static,/static,jar:file:/opt/hadoop/share/ozone/lib/hadoop-hdds-container-service-0.6.0-SNAPSHOT.jar!/webapps/static,AVAILABLE}
datanode_1_1  | 2020-04-17 18:50:32,697 [main] INFO handler.ContextHandler: Started o.e.j.w.WebAppContext@7c011174{hddsDatanode,/,file:///tmp/jetty-0_0_0_0-9882-hadoop-hdds-container-service-0_6_0-SNAPSHOT_jar-_-any-48575035372886119.dir/webapp/,AVAILABLE}{jar:file:/opt/hadoop/share/ozone/lib/hadoop-hdds-container-service-0.6.0-SNAPSHOT.jar!/webapps/hddsDatanode}
datanode_1_1  | 2020-04-17 18:50:32,774 [main] INFO server.AbstractConnector: Started ServerConnector@1491344a{HTTP/1.1,[http/1.1]}{0.0.0.0:9882}
datanode_1_1  | 2020-04-17 18:50:32,775 [main] INFO server.Server: Started @23401ms
datanode_1_1  | 2020-04-17 18:50:32,807 [main] INFO impl.MetricsSinkAdapter: Sink prometheus started
datanode_1_1  | 2020-04-17 18:50:32,807 [main] INFO impl.MetricsSystemImpl: Registered sink prometheus
datanode_1_1  | 2020-04-17 18:50:32,823 [main] INFO http.BaseHttpServer: HTTP server of hddsDatanode listening at http://0.0.0.0:9882
datanode_1_1  | 2020-04-17 18:50:32,912 [org.apache.hadoop.util.JvmPauseMonitor$Monitor@5f7e303e] INFO util.JvmPauseMonitor: Starting JVM pause monitor
datanode_1_1  | 2020-04-17 18:50:33,550 [Datanode State Machine Thread - 0] INFO datanode.InitDatanodeState: DatanodeDetails is persisted to /data/datanode.id
datanode_1_1  | 2020-04-17 18:50:36,028 [Datanode State Machine Thread - 0] INFO ipc.Client: Retrying connect to server: scm/10.5.0.71:9861. Already tried 0 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=2147483647, sleepTime=1000 MILLISECONDS)
datanode_1_1  | 2020-04-17 18:50:36,717 [Datanode State Machine Thread - 0] INFO ozoneimpl.OzoneContainer: Attempting to start container services.
datanode_1_1  | 2020-04-17 18:50:36,718 [Datanode State Machine Thread - 0] INFO ozoneimpl.OzoneContainer: Background container scanner has been disabled.
datanode_1_1  | 2020-04-17 18:50:36,722 [Datanode State Machine Thread - 0] INFO ratis.XceiverServerRatis: Starting XceiverServerRatis b23d8fb0-3698-40b4-ac98-17b8605a770b at port 9858
datanode_1_1  | 2020-04-17 18:50:36,872 [Datanode State Machine Thread - 0] INFO impl.RaftServerProxy: b23d8fb0-3698-40b4-ac98-17b8605a770b: start RPC server
datanode_1_1  | 2020-04-17 18:50:37,313 [Datanode State Machine Thread - 0] INFO server.GrpcService: b23d8fb0-3698-40b4-ac98-17b8605a770b: GrpcService started, listening on 0.0.0.0/0.0.0.0:9858
datanode_1_1  | 2020-04-17 18:50:42,015 [Command processor thread] INFO impl.RaftServerProxy: b23d8fb0-3698-40b4-ac98-17b8605a770b: addNew group-39398B1C5C01:[b23d8fb0-3698-40b4-ac98-17b8605a770b:10.5.0.4:9858] returns group-39398B1C5C01:java.util.concurrent.CompletableFuture@1d43cb43[Not completed]
datanode_2_1  | 2020-04-17 18:50:43,280 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.rpc.timeout.max = 5200ms (custom)
datanode_2_1  | 2020-04-17 18:50:43,280 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.rpcslowness.timeout = 300s (custom)
datanode_2_1  | 2020-04-17 18:50:43,280 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.sleep.deviation.threshold = 300 (default)
datanode_2_1  | 2020-04-17 18:50:43,283 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.appender.install.snapshot.enabled = false (custom)
datanode_2_1  | 2020-04-17 18:50:43,283 [pool-69-thread-1] INFO impl.RaftServerImpl: 0e99e1b0-220f-42bd-a39f-d4658f80d0e4@group-385EF22ED913: ConfigurationManager, init=-1: [978c057e-5c38-4e20-8a8b-f271c823af7e:10.5.0.8:9858, a0acbcec-d753-414c-b077-647d02aaa7fb:10.5.0.7:9858, 0e99e1b0-220f-42bd-a39f-d4658f80d0e4:10.5.0.5:9858], old=null, confs=<EMPTY_MAP>
datanode_2_1  | 2020-04-17 18:50:43,283 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.storage.dir = [/data/metadata/ratis] (custom)
datanode_2_1  | 2020-04-17 18:50:43,285 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.corruption.policy = EXCEPTION (default)
datanode_2_1  | 2020-04-17 18:50:43,287 [pool-69-thread-1] INFO storage.RaftStorageDirectory: The storage directory /data/metadata/ratis/be26d0dd-802f-4608-9a1c-385ef22ed913 does not exist. Creating ...
datanode_2_1  | 2020-04-17 18:50:43,289 [pool-69-thread-1] INFO storage.RaftStorageDirectory: Lock on /data/metadata/ratis/be26d0dd-802f-4608-9a1c-385ef22ed913/in_use.lock acquired by nodename 6@3511460463af
datanode_2_1  | 2020-04-17 18:50:43,303 [pool-69-thread-1] INFO storage.RaftStorage: Storage directory /data/metadata/ratis/be26d0dd-802f-4608-9a1c-385ef22ed913 has been successfully formatted.
datanode_2_1  | 2020-04-17 18:50:43,303 [pool-69-thread-1] INFO ratis.ContainerStateMachine: group-385EF22ED913: The snapshot info is null. Setting the last applied indexto:(t:0, i:~)
datanode_2_1  | 2020-04-17 18:50:43,303 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.notification.no-leader.timeout = 60s (default)
datanode_2_1  | 2020-04-17 18:50:43,303 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.use.memory = false (default)
datanode_2_1  | 2020-04-17 18:50:43,309 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.purge.gap = 1000000 (custom)
datanode_2_1  | 2020-04-17 18:50:43,309 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
datanode_2_1  | 2020-04-17 18:50:43,315 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.segment.size.max = 1048576 (custom)
datanode_2_1  | 2020-04-17 18:50:43,315 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.segment.cache.num.max = 2 (custom)
datanode_2_1  | 2020-04-17 18:50:43,315 [pool-69-thread-1] INFO segmented.SegmentedRaftLogWorker: new 0e99e1b0-220f-42bd-a39f-d4658f80d0e4@group-385EF22ED913-SegmentedRaftLogWorker for RaftStorage:Storage Directory /data/metadata/ratis/be26d0dd-802f-4608-9a1c-385ef22ed913
datanode_2_1  | 2020-04-17 18:50:43,315 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.queue.byte-limit = 2147483647 (custom)
datanode_2_1  | 2020-04-17 18:50:43,315 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.queue.element-limit = 1024 (custom)
datanode_2_1  | 2020-04-17 18:50:43,315 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.segment.size.max = 1048576 (custom)
datanode_2_1  | 2020-04-17 18:50:43,315 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.preallocated.size = 16384 (custom)
datanode_2_1  | 2020-04-17 18:50:43,316 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.write.buffer.size = 1048576 (custom)
datanode_2_1  | 2020-04-17 18:50:43,316 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.force.sync.num = 128 (default)
datanode_2_1  | 2020-04-17 18:50:43,316 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.statemachine.data.sync = true (default)
datanode_2_1  | 2020-04-17 18:50:43,316 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.statemachine.data.sync.timeout = 10s (default)
datanode_2_1  | 2020-04-17 18:50:43,316 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
datanode_2_1  | 2020-04-17 18:50:43,319 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.statemachine.data.caching.enabled = true (custom)
datanode_2_1  | 2020-04-17 18:50:43,323 [pool-69-thread-1] INFO segmented.SegmentedRaftLogWorker: 0e99e1b0-220f-42bd-a39f-d4658f80d0e4@group-385EF22ED913-SegmentedRaftLogWorker: flushIndex: setUnconditionally 0 -> -1
datanode_2_1  | 2020-04-17 18:50:43,324 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.snapshot.auto.trigger.enabled = true (custom)
datanode_2_1  | 2020-04-17 18:50:43,325 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
datanode_2_1  | 2020-04-17 18:50:43,325 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.snapshot.retention.file.num = 5 (custom)
datanode_2_1  | 2020-04-17 18:50:43,327 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.retrycache.expirytime = 600000ms (custom)
datanode_2_1  | 2020-04-17 18:50:43,338 [pool-69-thread-1] INFO metrics.RatisMetrics: Creating Metrics Registry : ratis.leader_election.0e99e1b0-220f-42bd-a39f-d4658f80d0e4@group-385EF22ED913
datanode_2_1  | 2020-04-17 18:50:43,343 [pool-69-thread-1] INFO metrics.RatisMetrics: Creating Metrics Registry : ratis.server.0e99e1b0-220f-42bd-a39f-d4658f80d0e4@group-385EF22ED913
datanode_2_1  | 2020-04-17 18:50:43,344 [pool-69-thread-1] INFO impl.RaftServerImpl: 0e99e1b0-220f-42bd-a39f-d4658f80d0e4@group-385EF22ED913: start as a follower, conf=-1: [978c057e-5c38-4e20-8a8b-f271c823af7e:10.5.0.8:9858, a0acbcec-d753-414c-b077-647d02aaa7fb:10.5.0.7:9858, 0e99e1b0-220f-42bd-a39f-d4658f80d0e4:10.5.0.5:9858], old=null
datanode_2_1  | 2020-04-17 18:50:43,347 [pool-69-thread-1] INFO impl.RaftServerImpl: 0e99e1b0-220f-42bd-a39f-d4658f80d0e4@group-385EF22ED913: changes role from      null to FOLLOWER at term 0 for startAsFollower
datanode_2_1  | 2020-04-17 18:50:43,347 [pool-69-thread-1] INFO impl.RoleInfo: 0e99e1b0-220f-42bd-a39f-d4658f80d0e4: start FollowerState
datanode_2_1  | 2020-04-17 18:50:43,353 [pool-69-thread-1] INFO util.JmxRegister: Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-385EF22ED913,id=0e99e1b0-220f-42bd-a39f-d4658f80d0e4
datanode_2_1  | 2020-04-17 18:50:43,353 [pool-69-thread-1] INFO metrics.RatisMetrics: Creating Metrics Registry : ratis.state_machine.0e99e1b0-220f-42bd-a39f-d4658f80d0e4@group-385EF22ED913
datanode_2_1  | 2020-04-17 18:50:45,154 [grpc-default-executor-0] WARN impl.RaftServerProxy: 0e99e1b0-220f-42bd-a39f-d4658f80d0e4: Failed groupAdd* GroupManagementRequest:client-E465FB1992A7->0e99e1b0-220f-42bd-a39f-d4658f80d0e4@group-385EF22ED913, cid=0, seq=0, RW, null, Add:group-385EF22ED913:[978c057e-5c38-4e20-8a8b-f271c823af7e:10.5.0.8:9858, a0acbcec-d753-414c-b077-647d02aaa7fb:10.5.0.7:9858, 0e99e1b0-220f-42bd-a39f-d4658f80d0e4:10.5.0.5:9858]
datanode_2_1  | java.util.concurrent.CompletionException: org.apache.ratis.protocol.AlreadyExistsException: 0e99e1b0-220f-42bd-a39f-d4658f80d0e4: Failed to add group-385EF22ED913:[978c057e-5c38-4e20-8a8b-f271c823af7e:10.5.0.8:9858, a0acbcec-d753-414c-b077-647d02aaa7fb:10.5.0.7:9858, 0e99e1b0-220f-42bd-a39f-d4658f80d0e4:10.5.0.5:9858] since the group already exists in the map.
datanode_2_1  | 	at java.base/java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:331)
datanode_2_1  | 	at java.base/java.util.concurrent.CompletableFuture.uniApplyNow(CompletableFuture.java:670)
datanode_2_1  | 	at java.base/java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:658)
datanode_2_1  | 	at java.base/java.util.concurrent.CompletableFuture.thenApplyAsync(CompletableFuture.java:2104)
datanode_2_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupAddAsync(RaftServerProxy.java:379)
datanode_2_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupManagementAsync(RaftServerProxy.java:363)
datanode_2_1  | 	at org.apache.ratis.grpc.server.GrpcAdminProtocolService.lambda$groupManagement$0(GrpcAdminProtocolService.java:42)
datanode_2_1  | 	at org.apache.ratis.grpc.GrpcUtil.asyncCall(GrpcUtil.java:160)
datanode_2_1  | 	at org.apache.ratis.grpc.server.GrpcAdminProtocolService.groupManagement(GrpcAdminProtocolService.java:42)
datanode_2_1  | 	at org.apache.ratis.proto.grpc.AdminProtocolServiceGrpc$MethodHandlers.invoke(AdminProtocolServiceGrpc.java:358)
datanode_2_1  | 	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$UnaryServerCallHandler$UnaryServerCallListener.onHalfClose(ServerCalls.java:172)
datanode_2_1  | 	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.halfClosed(ServerCallImpl.java:331)
datanode_2_1  | 	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1HalfClosed.runInContext(ServerImpl.java:814)
datanode_2_1  | 	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
datanode_2_1  | 	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:123)
datanode_2_1  | 	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
datanode_2_1  | 	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
datanode_2_1  | 	at java.base/java.lang.Thread.run(Thread.java:834)
datanode_2_1  | Caused by: org.apache.ratis.protocol.AlreadyExistsException: 0e99e1b0-220f-42bd-a39f-d4658f80d0e4: Failed to add group-385EF22ED913:[978c057e-5c38-4e20-8a8b-f271c823af7e:10.5.0.8:9858, a0acbcec-d753-414c-b077-647d02aaa7fb:10.5.0.7:9858, 0e99e1b0-220f-42bd-a39f-d4658f80d0e4:10.5.0.5:9858] since the group already exists in the map.
datanode_2_1  | 	at org.apache.ratis.server.impl.RaftServerProxy$ImplMap.addNew(RaftServerProxy.java:83)
datanode_2_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupAddAsync(RaftServerProxy.java:378)
datanode_2_1  | 	... 13 more
datanode_2_1  | 2020-04-17 18:50:46,194 [grpc-default-executor-0] WARN impl.RaftServerProxy: 0e99e1b0-220f-42bd-a39f-d4658f80d0e4: Failed groupAdd* GroupManagementRequest:client-BE6AC2D1977B->0e99e1b0-220f-42bd-a39f-d4658f80d0e4@group-385EF22ED913, cid=0, seq=0, RW, null, Add:group-385EF22ED913:[978c057e-5c38-4e20-8a8b-f271c823af7e:10.5.0.8:9858, a0acbcec-d753-414c-b077-647d02aaa7fb:10.5.0.7:9858, 0e99e1b0-220f-42bd-a39f-d4658f80d0e4:10.5.0.5:9858]
datanode_2_1  | java.util.concurrent.CompletionException: org.apache.ratis.protocol.AlreadyExistsException: 0e99e1b0-220f-42bd-a39f-d4658f80d0e4: Failed to add group-385EF22ED913:[978c057e-5c38-4e20-8a8b-f271c823af7e:10.5.0.8:9858, a0acbcec-d753-414c-b077-647d02aaa7fb:10.5.0.7:9858, 0e99e1b0-220f-42bd-a39f-d4658f80d0e4:10.5.0.5:9858] since the group already exists in the map.
datanode_2_1  | 	at java.base/java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:331)
datanode_2_1  | 	at java.base/java.util.concurrent.CompletableFuture.uniApplyNow(CompletableFuture.java:670)
datanode_2_1  | 	at java.base/java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:658)
datanode_2_1  | 	at java.base/java.util.concurrent.CompletableFuture.thenApplyAsync(CompletableFuture.java:2104)
datanode_2_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupAddAsync(RaftServerProxy.java:379)
datanode_2_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupManagementAsync(RaftServerProxy.java:363)
datanode_2_1  | 	at org.apache.ratis.grpc.server.GrpcAdminProtocolService.lambda$groupManagement$0(GrpcAdminProtocolService.java:42)
datanode_2_1  | 	at org.apache.ratis.grpc.GrpcUtil.asyncCall(GrpcUtil.java:160)
datanode_2_1  | 	at org.apache.ratis.grpc.server.GrpcAdminProtocolService.groupManagement(GrpcAdminProtocolService.java:42)
datanode_2_1  | 	at org.apache.ratis.proto.grpc.AdminProtocolServiceGrpc$MethodHandlers.invoke(AdminProtocolServiceGrpc.java:358)
datanode_2_1  | 	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$UnaryServerCallHandler$UnaryServerCallListener.onHalfClose(ServerCalls.java:172)
datanode_2_1  | 	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.halfClosed(ServerCallImpl.java:331)
datanode_2_1  | 	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1HalfClosed.runInContext(ServerImpl.java:814)
datanode_2_1  | 	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
datanode_2_1  | 	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:123)
datanode_2_1  | 	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
datanode_2_1  | 	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
datanode_2_1  | 	at java.base/java.lang.Thread.run(Thread.java:834)
datanode_2_1  | Caused by: org.apache.ratis.protocol.AlreadyExistsException: 0e99e1b0-220f-42bd-a39f-d4658f80d0e4: Failed to add group-385EF22ED913:[978c057e-5c38-4e20-8a8b-f271c823af7e:10.5.0.8:9858, a0acbcec-d753-414c-b077-647d02aaa7fb:10.5.0.7:9858, 0e99e1b0-220f-42bd-a39f-d4658f80d0e4:10.5.0.5:9858] since the group already exists in the map.
datanode_2_1  | 	at org.apache.ratis.server.impl.RaftServerProxy$ImplMap.addNew(RaftServerProxy.java:83)
datanode_2_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupAddAsync(RaftServerProxy.java:378)
datanode_2_1  | 	... 13 more
datanode_2_1  | 2020-04-17 18:50:46,712 [Command processor thread] INFO commandhandler.CreatePipelineCommandHandler: Created Pipeline RATIS THREE #id: "be26d0dd-802f-4608-9a1c-385ef22ed913"
datanode_2_1  | .
datanode_2_1  | 2020-04-17 18:50:47,880 [grpc-default-executor-0] INFO impl.RaftServerImpl: 0e99e1b0-220f-42bd-a39f-d4658f80d0e4@group-385EF22ED913: changes role from  FOLLOWER to FOLLOWER at term 1 for recognizeCandidate:a0acbcec-d753-414c-b077-647d02aaa7fb
datanode_2_1  | 2020-04-17 18:50:47,891 [grpc-default-executor-0] INFO impl.RoleInfo: 0e99e1b0-220f-42bd-a39f-d4658f80d0e4: shutdown FollowerState
datanode_2_1  | 2020-04-17 18:50:47,892 [grpc-default-executor-0] INFO impl.RoleInfo: 0e99e1b0-220f-42bd-a39f-d4658f80d0e4: start FollowerState
datanode_2_1  | 2020-04-17 18:50:47,892 [Thread-25] INFO impl.FollowerState: 0e99e1b0-220f-42bd-a39f-d4658f80d0e4@group-385EF22ED913-FollowerState was interrupted: java.lang.InterruptedException: sleep interrupted
datanode_2_1  | 2020-04-17 18:50:48,153 [grpc-default-executor-0] INFO ratis.XceiverServerRatis: Leader change notification received for group: group-385EF22ED913 with new leaderId: a0acbcec-d753-414c-b077-647d02aaa7fb
datanode_2_1  | 2020-04-17 18:50:48,165 [grpc-default-executor-0] INFO impl.RaftServerImpl: 0e99e1b0-220f-42bd-a39f-d4658f80d0e4@group-385EF22ED913: change Leader from null to a0acbcec-d753-414c-b077-647d02aaa7fb at term 1 for appendEntries, leader elected after 4849ms
datanode_2_1  | 2020-04-17 18:50:48,205 [Thread-23] INFO impl.FollowerState: 0e99e1b0-220f-42bd-a39f-d4658f80d0e4@group-48E39F71149F-FollowerState: change to CANDIDATE, lastRpcTime:5073ms, electionTimeout:5054ms
datanode_2_1  | 2020-04-17 18:50:48,231 [Thread-23] INFO impl.RoleInfo: 0e99e1b0-220f-42bd-a39f-d4658f80d0e4: shutdown FollowerState
datanode_2_1  | 2020-04-17 18:50:48,233 [Thread-23] INFO impl.RaftServerImpl: 0e99e1b0-220f-42bd-a39f-d4658f80d0e4@group-48E39F71149F: changes role from  FOLLOWER to CANDIDATE at term 0 for changeToCandidate
datanode_2_1  | 2020-04-17 18:50:48,235 [Thread-23] INFO impl.RoleInfo: 0e99e1b0-220f-42bd-a39f-d4658f80d0e4: start LeaderElection
datanode_2_1  | 2020-04-17 18:50:48,238 [grpc-default-executor-0] INFO impl.RaftServerImpl: 0e99e1b0-220f-42bd-a39f-d4658f80d0e4@group-385EF22ED913: set configuration 0: [978c057e-5c38-4e20-8a8b-f271c823af7e:10.5.0.8:9858, a0acbcec-d753-414c-b077-647d02aaa7fb:10.5.0.7:9858, 0e99e1b0-220f-42bd-a39f-d4658f80d0e4:10.5.0.5:9858], old=null at 0
datanode_1_1  | 2020-04-17 18:50:42,164 [pool-69-thread-1] INFO impl.RaftServerImpl: b23d8fb0-3698-40b4-ac98-17b8605a770b: new RaftServerImpl for group-39398B1C5C01:[b23d8fb0-3698-40b4-ac98-17b8605a770b:10.5.0.4:9858] with ContainerStateMachine:uninitialized
datanode_1_1  | 2020-04-17 18:50:42,165 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.rpc.timeout.min = 5s (custom)
datanode_1_1  | 2020-04-17 18:50:42,179 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.rpc.timeout.max = 5200ms (custom)
datanode_1_1  | 2020-04-17 18:50:42,180 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.rpcslowness.timeout = 300s (custom)
datanode_1_1  | 2020-04-17 18:50:42,180 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.sleep.deviation.threshold = 300 (default)
datanode_1_1  | 2020-04-17 18:50:42,195 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.appender.install.snapshot.enabled = false (custom)
datanode_1_1  | 2020-04-17 18:50:42,242 [pool-69-thread-1] INFO impl.RaftServerImpl: b23d8fb0-3698-40b4-ac98-17b8605a770b@group-39398B1C5C01: ConfigurationManager, init=-1: [b23d8fb0-3698-40b4-ac98-17b8605a770b:10.5.0.4:9858], old=null, confs=<EMPTY_MAP>
datanode_1_1  | 2020-04-17 18:50:42,265 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.storage.dir = [/data/metadata/ratis] (custom)
datanode_1_1  | 2020-04-17 18:50:42,295 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.corruption.policy = EXCEPTION (default)
datanode_1_1  | 2020-04-17 18:50:42,296 [pool-69-thread-1] INFO storage.RaftStorageDirectory: The storage directory /data/metadata/ratis/584150c2-fc44-4ccf-a30e-39398b1c5c01 does not exist. Creating ...
datanode_1_1  | 2020-04-17 18:50:42,330 [pool-69-thread-1] INFO storage.RaftStorageDirectory: Lock on /data/metadata/ratis/584150c2-fc44-4ccf-a30e-39398b1c5c01/in_use.lock acquired by nodename 6@95d5c4783177
datanode_1_1  | 2020-04-17 18:50:42,337 [pool-69-thread-1] INFO storage.RaftStorage: Storage directory /data/metadata/ratis/584150c2-fc44-4ccf-a30e-39398b1c5c01 has been successfully formatted.
datanode_1_1  | 2020-04-17 18:50:42,356 [pool-69-thread-1] INFO ratis.ContainerStateMachine: group-39398B1C5C01: The snapshot info is null. Setting the last applied indexto:(t:0, i:~)
datanode_1_1  | 2020-04-17 18:50:42,357 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.notification.no-leader.timeout = 60s (default)
datanode_1_1  | 2020-04-17 18:50:42,362 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.use.memory = false (default)
datanode_1_1  | 2020-04-17 18:50:42,366 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.purge.gap = 1000000 (custom)
datanode_1_1  | 2020-04-17 18:50:42,366 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
datanode_1_1  | 2020-04-17 18:50:42,387 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.segment.size.max = 1048576 (custom)
datanode_1_1  | 2020-04-17 18:50:42,390 [pool-69-thread-1] INFO metrics.RatisMetrics: Creating Metrics Registry : ratis.log_worker.b23d8fb0-3698-40b4-ac98-17b8605a770b
datanode_1_1  | 2020-04-17 18:50:42,462 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.segment.cache.num.max = 2 (custom)
datanode_1_1  | 2020-04-17 18:50:42,513 [pool-69-thread-1] INFO segmented.SegmentedRaftLogWorker: new b23d8fb0-3698-40b4-ac98-17b8605a770b@group-39398B1C5C01-SegmentedRaftLogWorker for RaftStorage:Storage Directory /data/metadata/ratis/584150c2-fc44-4ccf-a30e-39398b1c5c01
datanode_1_1  | 2020-04-17 18:50:42,530 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.queue.byte-limit = 2147483647 (custom)
datanode_1_1  | 2020-04-17 18:50:42,531 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.queue.element-limit = 1024 (custom)
datanode_1_1  | 2020-04-17 18:50:42,531 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.segment.size.max = 1048576 (custom)
datanode_1_1  | 2020-04-17 18:50:42,532 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.preallocated.size = 16384 (custom)
datanode_1_1  | 2020-04-17 18:50:42,532 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.write.buffer.size = 1048576 (custom)
datanode_1_1  | 2020-04-17 18:50:42,567 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.force.sync.num = 128 (default)
datanode_1_1  | 2020-04-17 18:50:42,568 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.statemachine.data.sync = true (default)
datanode_1_1  | 2020-04-17 18:50:42,568 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.statemachine.data.sync.timeout = 10s (default)
datanode_1_1  | 2020-04-17 18:50:42,569 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
datanode_1_1  | 2020-04-17 18:50:42,713 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.statemachine.data.caching.enabled = true (custom)
datanode_1_1  | 2020-04-17 18:50:42,775 [pool-69-thread-1] INFO segmented.SegmentedRaftLogWorker: b23d8fb0-3698-40b4-ac98-17b8605a770b@group-39398B1C5C01-SegmentedRaftLogWorker: flushIndex: setUnconditionally 0 -> -1
datanode_1_1  | 2020-04-17 18:50:42,806 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.snapshot.auto.trigger.enabled = true (custom)
datanode_1_1  | 2020-04-17 18:50:42,830 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
datanode_1_1  | 2020-04-17 18:50:42,837 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.snapshot.retention.file.num = 5 (custom)
datanode_1_1  | 2020-04-17 18:50:42,840 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.retrycache.expirytime = 600000ms (custom)
datanode_1_1  | 2020-04-17 18:50:42,996 [pool-69-thread-1] INFO metrics.RatisMetrics: Creating Metrics Registry : ratis.leader_election.b23d8fb0-3698-40b4-ac98-17b8605a770b@group-39398B1C5C01
datanode_1_1  | 2020-04-17 18:50:43,016 [pool-69-thread-1] INFO metrics.RatisMetrics: Creating Metrics Registry : ratis.server.b23d8fb0-3698-40b4-ac98-17b8605a770b@group-39398B1C5C01
datanode_1_1  | 2020-04-17 18:50:43,020 [pool-69-thread-1] INFO impl.RaftServerImpl: b23d8fb0-3698-40b4-ac98-17b8605a770b@group-39398B1C5C01: start as a follower, conf=-1: [b23d8fb0-3698-40b4-ac98-17b8605a770b:10.5.0.4:9858], old=null
datanode_1_1  | 2020-04-17 18:50:43,028 [pool-69-thread-1] INFO impl.RaftServerImpl: b23d8fb0-3698-40b4-ac98-17b8605a770b@group-39398B1C5C01: changes role from      null to FOLLOWER at term 0 for startAsFollower
datanode_1_1  | 2020-04-17 18:50:43,040 [pool-69-thread-1] INFO impl.RoleInfo: b23d8fb0-3698-40b4-ac98-17b8605a770b: start FollowerState
datanode_1_1  | 2020-04-17 18:50:43,132 [pool-69-thread-1] INFO util.JmxRegister: Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-39398B1C5C01,id=b23d8fb0-3698-40b4-ac98-17b8605a770b
datanode_1_1  | 2020-04-17 18:50:43,133 [pool-69-thread-1] INFO metrics.RatisMetrics: Creating Metrics Registry : ratis.state_machine.b23d8fb0-3698-40b4-ac98-17b8605a770b@group-39398B1C5C01
datanode_1_1  | 2020-04-17 18:50:43,218 [Command processor thread] INFO commandhandler.CreatePipelineCommandHandler: Created Pipeline RATIS ONE #id: "584150c2-fc44-4ccf-a30e-39398b1c5c01"
datanode_1_1  | .
datanode_1_1  | 2020-04-17 18:50:43,227 [Command processor thread] INFO impl.RaftServerProxy: b23d8fb0-3698-40b4-ac98-17b8605a770b: addNew group-F5BD6C5F0281:[b23d8fb0-3698-40b4-ac98-17b8605a770b:10.5.0.4:9858, 32863f73-3555-4b23-932a-0d28eb668aea:10.5.0.6:9858, 79669a1f-2445-496e-a337-3115205f3ae5:10.5.0.9:9858] returns group-F5BD6C5F0281:java.util.concurrent.CompletableFuture@3b529e81[Not completed]
datanode_1_1  | 2020-04-17 18:50:43,230 [pool-69-thread-1] INFO impl.RaftServerImpl: b23d8fb0-3698-40b4-ac98-17b8605a770b: new RaftServerImpl for group-F5BD6C5F0281:[b23d8fb0-3698-40b4-ac98-17b8605a770b:10.5.0.4:9858, 32863f73-3555-4b23-932a-0d28eb668aea:10.5.0.6:9858, 79669a1f-2445-496e-a337-3115205f3ae5:10.5.0.9:9858] with ContainerStateMachine:uninitialized
datanode_1_1  | 2020-04-17 18:50:43,245 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.rpc.timeout.min = 5s (custom)
datanode_1_1  | 2020-04-17 18:50:43,251 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.rpc.timeout.max = 5200ms (custom)
datanode_1_1  | 2020-04-17 18:50:43,251 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.rpcslowness.timeout = 300s (custom)
datanode_1_1  | 2020-04-17 18:50:43,251 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.sleep.deviation.threshold = 300 (default)
datanode_1_1  | 2020-04-17 18:50:43,251 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.appender.install.snapshot.enabled = false (custom)
datanode_1_1  | 2020-04-17 18:50:43,251 [pool-69-thread-1] INFO impl.RaftServerImpl: b23d8fb0-3698-40b4-ac98-17b8605a770b@group-F5BD6C5F0281: ConfigurationManager, init=-1: [b23d8fb0-3698-40b4-ac98-17b8605a770b:10.5.0.4:9858, 32863f73-3555-4b23-932a-0d28eb668aea:10.5.0.6:9858, 79669a1f-2445-496e-a337-3115205f3ae5:10.5.0.9:9858], old=null, confs=<EMPTY_MAP>
datanode_1_1  | 2020-04-17 18:50:43,252 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.storage.dir = [/data/metadata/ratis] (custom)
datanode_1_1  | 2020-04-17 18:50:43,252 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.corruption.policy = EXCEPTION (default)
datanode_1_1  | 2020-04-17 18:50:43,252 [pool-69-thread-1] INFO storage.RaftStorageDirectory: The storage directory /data/metadata/ratis/315eee3a-6983-45b7-a699-f5bd6c5f0281 does not exist. Creating ...
datanode_1_1  | 2020-04-17 18:50:43,255 [pool-69-thread-1] INFO storage.RaftStorageDirectory: Lock on /data/metadata/ratis/315eee3a-6983-45b7-a699-f5bd6c5f0281/in_use.lock acquired by nodename 6@95d5c4783177
datanode_1_1  | 2020-04-17 18:50:43,260 [pool-69-thread-1] INFO storage.RaftStorage: Storage directory /data/metadata/ratis/315eee3a-6983-45b7-a699-f5bd6c5f0281 has been successfully formatted.
datanode_1_1  | 2020-04-17 18:50:43,261 [pool-69-thread-1] INFO ratis.ContainerStateMachine: group-F5BD6C5F0281: The snapshot info is null. Setting the last applied indexto:(t:0, i:~)
datanode_1_1  | 2020-04-17 18:50:43,265 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.notification.no-leader.timeout = 60s (default)
datanode_1_1  | 2020-04-17 18:50:43,266 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.use.memory = false (default)
datanode_1_1  | 2020-04-17 18:50:43,266 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.purge.gap = 1000000 (custom)
datanode_1_1  | 2020-04-17 18:50:43,266 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
datanode_1_1  | 2020-04-17 18:50:43,267 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.segment.size.max = 1048576 (custom)
datanode_1_1  | 2020-04-17 18:50:43,267 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.segment.cache.num.max = 2 (custom)
datanode_1_1  | 2020-04-17 18:50:43,274 [pool-69-thread-1] INFO segmented.SegmentedRaftLogWorker: new b23d8fb0-3698-40b4-ac98-17b8605a770b@group-F5BD6C5F0281-SegmentedRaftLogWorker for RaftStorage:Storage Directory /data/metadata/ratis/315eee3a-6983-45b7-a699-f5bd6c5f0281
datanode_1_1  | 2020-04-17 18:50:43,274 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.queue.byte-limit = 2147483647 (custom)
datanode_1_1  | 2020-04-17 18:50:43,274 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.queue.element-limit = 1024 (custom)
datanode_1_1  | 2020-04-17 18:50:43,278 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.segment.size.max = 1048576 (custom)
datanode_1_1  | 2020-04-17 18:50:43,278 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.preallocated.size = 16384 (custom)
datanode_1_1  | 2020-04-17 18:50:43,278 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.write.buffer.size = 1048576 (custom)
datanode_1_1  | 2020-04-17 18:50:43,280 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.force.sync.num = 128 (default)
datanode_1_1  | 2020-04-17 18:50:43,283 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.statemachine.data.sync = true (default)
datanode_1_1  | 2020-04-17 18:50:43,283 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.statemachine.data.sync.timeout = 10s (default)
datanode_1_1  | 2020-04-17 18:50:43,285 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
datanode_1_1  | 2020-04-17 18:50:43,288 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.statemachine.data.caching.enabled = true (custom)
datanode_1_1  | 2020-04-17 18:50:43,292 [pool-69-thread-1] INFO segmented.SegmentedRaftLogWorker: b23d8fb0-3698-40b4-ac98-17b8605a770b@group-F5BD6C5F0281-SegmentedRaftLogWorker: flushIndex: setUnconditionally 0 -> -1
datanode_5_1  | Enabled profiling in kernel
datanode_5_1  | No '-XX:...' jvm parameters are used. Adding safer GC settings to the HADOOP_OPTS
datanode_5_1  | OpenJDK 64-Bit Server VM warning: Option UseConcMarkSweepGC was deprecated in version 9.0 and will likely be removed in a future release.
datanode_5_1  | 2020-04-17 18:50:16,655 [main] INFO ozone.HddsDatanodeService: STARTUP_MSG: 
datanode_5_1  | /************************************************************
datanode_5_1  | STARTUP_MSG: Starting HddsDatanodeService
datanode_5_1  | STARTUP_MSG:   host = 650579c681b3/10.5.0.8
datanode_5_1  | STARTUP_MSG:   args = []
datanode_5_1  | STARTUP_MSG:   version = 3.2.0
datanode_2_1  | 2020-04-17 18:50:48,287 [0e99e1b0-220f-42bd-a39f-d4658f80d0e4@group-48E39F71149F-LeaderElection1] INFO impl.LeaderElection: 0e99e1b0-220f-42bd-a39f-d4658f80d0e4@group-48E39F71149F-LeaderElection1: begin an election at term 1 for -1: [0e99e1b0-220f-42bd-a39f-d4658f80d0e4:10.5.0.5:9858], old=null
datanode_2_1  | 2020-04-17 18:50:48,288 [0e99e1b0-220f-42bd-a39f-d4658f80d0e4@group-48E39F71149F-LeaderElection1] INFO impl.RoleInfo: 0e99e1b0-220f-42bd-a39f-d4658f80d0e4: shutdown LeaderElection
datanode_2_1  | 2020-04-17 18:50:48,293 [0e99e1b0-220f-42bd-a39f-d4658f80d0e4@group-48E39F71149F-LeaderElection1] INFO impl.RaftServerImpl: 0e99e1b0-220f-42bd-a39f-d4658f80d0e4@group-48E39F71149F: changes role from CANDIDATE to LEADER at term 1 for changeToLeader
datanode_2_1  | 2020-04-17 18:50:48,298 [0e99e1b0-220f-42bd-a39f-d4658f80d0e4@group-48E39F71149F-LeaderElection1] INFO ratis.XceiverServerRatis: Leader change notification received for group: group-48E39F71149F with new leaderId: 0e99e1b0-220f-42bd-a39f-d4658f80d0e4
datanode_2_1  | 2020-04-17 18:50:48,299 [0e99e1b0-220f-42bd-a39f-d4658f80d0e4@group-48E39F71149F-LeaderElection1] INFO impl.RaftServerImpl: 0e99e1b0-220f-42bd-a39f-d4658f80d0e4@group-48E39F71149F: change Leader from null to 0e99e1b0-220f-42bd-a39f-d4658f80d0e4 at term 1 for becomeLeader, leader elected after 6008ms
datanode_2_1  | 2020-04-17 18:50:48,326 [grpc-default-executor-0] INFO segmented.SegmentedRaftLogWorker: 0e99e1b0-220f-42bd-a39f-d4658f80d0e4@group-385EF22ED913-SegmentedRaftLogWorker: Starting segment from index:0
datanode_2_1  | 2020-04-17 18:50:48,368 [0e99e1b0-220f-42bd-a39f-d4658f80d0e4@group-48E39F71149F-LeaderElection1] INFO server.RaftServerConfigKeys: raft.server.staging.catchup.gap = 1000 (default)
datanode_2_1  | 2020-04-17 18:50:48,374 [0e99e1b0-220f-42bd-a39f-d4658f80d0e4@group-48E39F71149F-LeaderElection1] INFO server.RaftServerConfigKeys: raft.server.rpc.sleep.time = 25ms (default)
datanode_2_1  | 2020-04-17 18:50:48,380 [0e99e1b0-220f-42bd-a39f-d4658f80d0e4@group-48E39F71149F-LeaderElection1] INFO metrics.RatisMetrics: Creating Metrics Registry : ratis.log_appender.0e99e1b0-220f-42bd-a39f-d4658f80d0e4@group-48E39F71149F
datanode_2_1  | 2020-04-17 18:50:48,410 [0e99e1b0-220f-42bd-a39f-d4658f80d0e4@group-48E39F71149F-LeaderElection1] INFO server.RaftServerConfigKeys: raft.server.write.element-limit = 1024 (custom)
datanode_2_1  | 2020-04-17 18:50:48,429 [0e99e1b0-220f-42bd-a39f-d4658f80d0e4@group-48E39F71149F-LeaderElection1] INFO server.RaftServerConfigKeys: raft.server.write.byte-limit = 1073741824 (custom)
datanode_2_1  | 2020-04-17 18:50:48,479 [0e99e1b0-220f-42bd-a39f-d4658f80d0e4@group-48E39F71149F-LeaderElection1] INFO server.RaftServerConfigKeys: raft.server.watch.timeout = 180s (custom)
datanode_2_1  | 2020-04-17 18:50:48,480 [0e99e1b0-220f-42bd-a39f-d4658f80d0e4@group-48E39F71149F-LeaderElection1] INFO server.RaftServerConfigKeys: raft.server.watch.timeout.denomination = 1s (default)
datanode_2_1  | 2020-04-17 18:50:48,483 [0e99e1b0-220f-42bd-a39f-d4658f80d0e4@group-48E39F71149F-LeaderElection1] INFO server.RaftServerConfigKeys: raft.server.watch.element-limit = 65536 (default)
datanode_2_1  | 2020-04-17 18:50:48,540 [0e99e1b0-220f-42bd-a39f-d4658f80d0e4@group-48E39F71149F-LeaderElection1] INFO impl.RoleInfo: 0e99e1b0-220f-42bd-a39f-d4658f80d0e4: start LeaderState
datanode_2_1  | 2020-04-17 18:50:48,570 [0e99e1b0-220f-42bd-a39f-d4658f80d0e4@group-48E39F71149F-LeaderElection1] INFO segmented.SegmentedRaftLogWorker: 0e99e1b0-220f-42bd-a39f-d4658f80d0e4@group-48E39F71149F-SegmentedRaftLogWorker: Starting segment from index:0
datanode_2_1  | 2020-04-17 18:50:48,599 [0e99e1b0-220f-42bd-a39f-d4658f80d0e4@group-48E39F71149F-LeaderElection1] INFO impl.RaftServerImpl: 0e99e1b0-220f-42bd-a39f-d4658f80d0e4@group-48E39F71149F: set configuration 0: [0e99e1b0-220f-42bd-a39f-d4658f80d0e4:10.5.0.5:9858], old=null at 0
datanode_2_1  | 2020-04-17 18:50:48,778 [0e99e1b0-220f-42bd-a39f-d4658f80d0e4@group-48E39F71149F-SegmentedRaftLogWorker] INFO segmented.SegmentedRaftLogWorker: 0e99e1b0-220f-42bd-a39f-d4658f80d0e4@group-48E39F71149F-SegmentedRaftLogWorker: created new log segment /data/metadata/ratis/046e56bb-291e-44e3-859a-48e39f71149f/current/log_inprogress_0
datanode_2_1  | 2020-04-17 18:50:48,782 [0e99e1b0-220f-42bd-a39f-d4658f80d0e4@group-385EF22ED913-SegmentedRaftLogWorker] INFO segmented.SegmentedRaftLogWorker: 0e99e1b0-220f-42bd-a39f-d4658f80d0e4@group-385EF22ED913-SegmentedRaftLogWorker: created new log segment /data/metadata/ratis/be26d0dd-802f-4608-9a1c-385ef22ed913/current/log_inprogress_0
datanode_2_1  | 2020-04-17 18:50:58,906 [ChunkWriter-33-0] INFO keyvalue.KeyValueHandler: Operation: CreateContainer , Trace ID: e215c60bfe250702:7a34a8519fdccc42:e215c60bfe250702:0 , Message: Container creation failed, due to disk out of space , Result: DISK_OUT_OF_SPACE , StorageContainerException Occurred.
datanode_2_1  | org.apache.hadoop.hdds.scm.container.common.helpers.StorageContainerException: Container creation failed, due to disk out of space
datanode_2_1  | 	at org.apache.hadoop.ozone.container.keyvalue.KeyValueContainer.create(KeyValueContainer.java:165)
datanode_2_1  | 	at org.apache.hadoop.ozone.container.keyvalue.KeyValueHandler.handleCreateContainer(KeyValueHandler.java:247)
datanode_2_1  | 	at org.apache.hadoop.ozone.container.keyvalue.KeyValueHandler.dispatchRequest(KeyValueHandler.java:164)
datanode_2_1  | 	at org.apache.hadoop.ozone.container.keyvalue.KeyValueHandler.handle(KeyValueHandler.java:152)
datanode_2_1  | 	at org.apache.hadoop.ozone.container.common.impl.HddsDispatcher.createContainer(HddsDispatcher.java:414)
datanode_2_1  | 	at org.apache.hadoop.ozone.container.common.impl.HddsDispatcher.dispatchRequest(HddsDispatcher.java:250)
datanode_2_1  | 	at org.apache.hadoop.ozone.container.common.impl.HddsDispatcher.dispatch(HddsDispatcher.java:162)
datanode_2_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.ContainerStateMachine.dispatchCommand(ContainerStateMachine.java:402)
datanode_2_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.ContainerStateMachine.runCommand(ContainerStateMachine.java:412)
datanode_2_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.ContainerStateMachine.lambda$handleWriteChunk$2(ContainerStateMachine.java:447)
datanode_2_1  | 	at java.base/java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1700)
datanode_2_1  | 	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
datanode_2_1  | 	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
datanode_2_1  | 	at java.base/java.lang.Thread.run(Thread.java:834)
datanode_2_1  | Caused by: org.apache.hadoop.util.DiskChecker$DiskOutOfSpaceException: Out of space: The volume with the most available space (=966017024 B) is less than the container size (=1073741824 B).
datanode_2_1  | 	at org.apache.hadoop.ozone.container.common.volume.RoundRobinVolumeChoosingPolicy.chooseVolume(RoundRobinVolumeChoosingPolicy.java:77)
datanode_2_1  | 	at org.apache.hadoop.ozone.container.keyvalue.KeyValueContainer.create(KeyValueContainer.java:124)
datanode_2_1  | 	... 13 more
datanode_2_1  | 2020-04-17 18:50:58,967 [ChunkWriter-33-0] INFO impl.HddsDispatcher: Operation: WriteChunk , Trace ID: e215c60bfe250702:7a34a8519fdccc42:e215c60bfe250702:0 , Message: ContainerID 2 creation failed , Result: DISK_OUT_OF_SPACE , StorageContainerException Occurred.
datanode_2_1  | org.apache.hadoop.hdds.scm.container.common.helpers.StorageContainerException: ContainerID 2 creation failed
datanode_2_1  | 	at org.apache.hadoop.ozone.container.common.impl.HddsDispatcher.dispatchRequest(HddsDispatcher.java:254)
datanode_2_1  | 	at org.apache.hadoop.ozone.container.common.impl.HddsDispatcher.dispatch(HddsDispatcher.java:162)
datanode_2_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.ContainerStateMachine.dispatchCommand(ContainerStateMachine.java:402)
datanode_2_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.ContainerStateMachine.runCommand(ContainerStateMachine.java:412)
datanode_2_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.ContainerStateMachine.lambda$handleWriteChunk$2(ContainerStateMachine.java:447)
datanode_2_1  | 	at java.base/java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1700)
datanode_2_1  | 	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
datanode_2_1  | 	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
datanode_2_1  | 	at java.base/java.lang.Thread.run(Thread.java:834)
datanode_2_1  | 2020-04-17 18:50:58,976 [ChunkWriter-33-0] ERROR ratis.ContainerStateMachine: group-385EF22ED913: writeChunk writeStateMachineData failed: blockIdcontainerID: 2
datanode_2_1  | localID: 104015426885648386
datanode_2_1  | blockCommitSequenceId: 0
datanode_2_1  |  logIndex 1 chunkName 104015426885648386_chunk_1 Error message: ContainerID 2 creation failed Container Result: DISK_OUT_OF_SPACE
datanode_2_1  | 2020-04-17 18:50:58,988 [0e99e1b0-220f-42bd-a39f-d4658f80d0e4@group-385EF22ED913-SegmentedRaftLogWorker] ERROR ratis.XceiverServerRatis: pipeline Action CLOSE on pipeline PipelineID=be26d0dd-802f-4608-9a1c-385ef22ed913.Reason : ContainerID 2 creation failed
datanode_2_1  | 2020-04-17 18:50:59,119 [0e99e1b0-220f-42bd-a39f-d4658f80d0e4@group-385EF22ED913-SegmentedRaftLogWorker] ERROR ratis.XceiverServerRatis: pipeline Action CLOSE on pipeline PipelineID=be26d0dd-802f-4608-9a1c-385ef22ed913.Reason : Log already failed at index 1 for task WriteLog:1: (t:1, i:1), STATEMACHINELOGENTRY, client-884610206644, cid=8
datanode_2_1  | 	 State Machine: cmdType: WriteChunk traceID: "e215c60bfe250702:7a34a8519fdccc42:e215c60bfe250702:0" containerID: 2 datanodeUuid: "0e99e1b0-220f-42bd-a39f-d4658f80d0e4" pipelineID: "be26d0dd-802f-4608-9a1c-385ef22ed913" writeChunk { blockID { containerID: 2 localID: 104015426885648386 blockCommitSequenceId: 0 } chunkData { chunkName: "104015426885648386_chunk_1" offset: 0 len: 10240 checksumData { type: CRC32 bytesPerChecksum: 1048576 checksums: ">\344\315\231" } } }, container path=nonexistent
datanode_2_1  | 2020-04-17 18:51:14,305 [Command processor thread] ERROR commandhandler.CloseContainerCommandHandler: Container #2 does not exist in datanode. Container close failed.
datanode_2_1  | 2020-04-17 18:52:29,952 [grpc-default-executor-0] INFO server.GrpcServerProtocolService: 0e99e1b0-220f-42bd-a39f-d4658f80d0e4: Completed APPEND_ENTRIES, lastRequest: a0acbcec-d753-414c-b077-647d02aaa7fb->0e99e1b0-220f-42bd-a39f-d4658f80d0e4#6-t1, previous=(t:1, i:1), leaderCommit=0, initializing? false, entries: size=1, first=(t:1, i:2), STATEMACHINELOGENTRY, client-884610206644, cid=9
datanode_2_1  | 2020-04-17 18:52:30,064 [grpc-default-executor-0] INFO impl.RaftServerProxy: 0e99e1b0-220f-42bd-a39f-d4658f80d0e4: addNew group-79E0035D853A:[978c057e-5c38-4e20-8a8b-f271c823af7e:10.5.0.8:9858, a0acbcec-d753-414c-b077-647d02aaa7fb:10.5.0.7:9858, 0e99e1b0-220f-42bd-a39f-d4658f80d0e4:10.5.0.5:9858] returns group-79E0035D853A:java.util.concurrent.CompletableFuture@2730019[Not completed]
datanode_2_1  | 2020-04-17 18:52:30,066 [pool-69-thread-1] INFO impl.RaftServerImpl: 0e99e1b0-220f-42bd-a39f-d4658f80d0e4: new RaftServerImpl for group-79E0035D853A:[978c057e-5c38-4e20-8a8b-f271c823af7e:10.5.0.8:9858, a0acbcec-d753-414c-b077-647d02aaa7fb:10.5.0.7:9858, 0e99e1b0-220f-42bd-a39f-d4658f80d0e4:10.5.0.5:9858] with ContainerStateMachine:uninitialized
datanode_2_1  | 2020-04-17 18:52:30,066 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.rpc.timeout.min = 5s (custom)
datanode_2_1  | 2020-04-17 18:52:30,066 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.rpc.timeout.max = 5200ms (custom)
datanode_2_1  | 2020-04-17 18:52:30,066 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.rpcslowness.timeout = 300s (custom)
datanode_2_1  | 2020-04-17 18:52:30,066 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.sleep.deviation.threshold = 300 (default)
datanode_2_1  | 2020-04-17 18:52:30,066 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.appender.install.snapshot.enabled = false (custom)
datanode_2_1  | 2020-04-17 18:52:30,067 [pool-69-thread-1] INFO impl.RaftServerImpl: 0e99e1b0-220f-42bd-a39f-d4658f80d0e4@group-79E0035D853A: ConfigurationManager, init=-1: [978c057e-5c38-4e20-8a8b-f271c823af7e:10.5.0.8:9858, a0acbcec-d753-414c-b077-647d02aaa7fb:10.5.0.7:9858, 0e99e1b0-220f-42bd-a39f-d4658f80d0e4:10.5.0.5:9858], old=null, confs=<EMPTY_MAP>
datanode_2_1  | 2020-04-17 18:52:30,067 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.storage.dir = [/data/metadata/ratis] (custom)
datanode_2_1  | 2020-04-17 18:52:30,067 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.corruption.policy = EXCEPTION (default)
datanode_2_1  | 2020-04-17 18:52:30,067 [pool-69-thread-1] INFO storage.RaftStorageDirectory: The storage directory /data/metadata/ratis/cad403d1-ea2f-4530-84e5-79e0035d853a does not exist. Creating ...
datanode_2_1  | 2020-04-17 18:52:30,069 [pool-69-thread-1] INFO storage.RaftStorageDirectory: Lock on /data/metadata/ratis/cad403d1-ea2f-4530-84e5-79e0035d853a/in_use.lock acquired by nodename 6@3511460463af
datanode_2_1  | 2020-04-17 18:52:30,070 [pool-69-thread-1] INFO storage.RaftStorage: Storage directory /data/metadata/ratis/cad403d1-ea2f-4530-84e5-79e0035d853a has been successfully formatted.
datanode_2_1  | 2020-04-17 18:52:30,071 [pool-69-thread-1] INFO ratis.ContainerStateMachine: group-79E0035D853A: The snapshot info is null. Setting the last applied indexto:(t:0, i:~)
datanode_2_1  | 2020-04-17 18:52:30,071 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.notification.no-leader.timeout = 60s (default)
datanode_2_1  | 2020-04-17 18:52:30,071 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.use.memory = false (default)
datanode_2_1  | 2020-04-17 18:52:30,071 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.purge.gap = 1000000 (custom)
datanode_2_1  | 2020-04-17 18:52:30,071 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
datanode_2_1  | 2020-04-17 18:52:30,071 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.segment.size.max = 1048576 (custom)
datanode_1_1  | 2020-04-17 18:50:43,320 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.snapshot.auto.trigger.enabled = true (custom)
datanode_1_1  | 2020-04-17 18:50:43,323 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
datanode_1_1  | 2020-04-17 18:50:43,323 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.snapshot.retention.file.num = 5 (custom)
datanode_1_1  | 2020-04-17 18:50:43,323 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.retrycache.expirytime = 600000ms (custom)
datanode_1_1  | 2020-04-17 18:50:43,324 [pool-69-thread-1] INFO metrics.RatisMetrics: Creating Metrics Registry : ratis.leader_election.b23d8fb0-3698-40b4-ac98-17b8605a770b@group-F5BD6C5F0281
datanode_1_1  | 2020-04-17 18:50:43,325 [pool-69-thread-1] INFO metrics.RatisMetrics: Creating Metrics Registry : ratis.server.b23d8fb0-3698-40b4-ac98-17b8605a770b@group-F5BD6C5F0281
datanode_1_1  | 2020-04-17 18:50:43,347 [pool-69-thread-1] INFO impl.RaftServerImpl: b23d8fb0-3698-40b4-ac98-17b8605a770b@group-F5BD6C5F0281: start as a follower, conf=-1: [b23d8fb0-3698-40b4-ac98-17b8605a770b:10.5.0.4:9858, 32863f73-3555-4b23-932a-0d28eb668aea:10.5.0.6:9858, 79669a1f-2445-496e-a337-3115205f3ae5:10.5.0.9:9858], old=null
datanode_1_1  | 2020-04-17 18:50:43,354 [pool-69-thread-1] INFO impl.RaftServerImpl: b23d8fb0-3698-40b4-ac98-17b8605a770b@group-F5BD6C5F0281: changes role from      null to FOLLOWER at term 0 for startAsFollower
datanode_1_1  | 2020-04-17 18:50:43,355 [pool-69-thread-1] INFO impl.RoleInfo: b23d8fb0-3698-40b4-ac98-17b8605a770b: start FollowerState
datanode_1_1  | 2020-04-17 18:50:43,399 [pool-69-thread-1] INFO util.JmxRegister: Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-F5BD6C5F0281,id=b23d8fb0-3698-40b4-ac98-17b8605a770b
datanode_1_1  | 2020-04-17 18:50:43,400 [pool-69-thread-1] INFO metrics.RatisMetrics: Creating Metrics Registry : ratis.state_machine.b23d8fb0-3698-40b4-ac98-17b8605a770b@group-F5BD6C5F0281
datanode_1_1  | 2020-04-17 18:50:45,812 [grpc-default-executor-0] WARN impl.RaftServerProxy: b23d8fb0-3698-40b4-ac98-17b8605a770b: Failed groupAdd* GroupManagementRequest:client-6AA8852791F3->b23d8fb0-3698-40b4-ac98-17b8605a770b@group-F5BD6C5F0281, cid=0, seq=0, RW, null, Add:group-F5BD6C5F0281:[b23d8fb0-3698-40b4-ac98-17b8605a770b:10.5.0.4:9858, 32863f73-3555-4b23-932a-0d28eb668aea:10.5.0.6:9858, 79669a1f-2445-496e-a337-3115205f3ae5:10.5.0.9:9858]
datanode_1_1  | java.util.concurrent.CompletionException: org.apache.ratis.protocol.AlreadyExistsException: b23d8fb0-3698-40b4-ac98-17b8605a770b: Failed to add group-F5BD6C5F0281:[b23d8fb0-3698-40b4-ac98-17b8605a770b:10.5.0.4:9858, 32863f73-3555-4b23-932a-0d28eb668aea:10.5.0.6:9858, 79669a1f-2445-496e-a337-3115205f3ae5:10.5.0.9:9858] since the group already exists in the map.
datanode_1_1  | 	at java.base/java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:331)
datanode_1_1  | 	at java.base/java.util.concurrent.CompletableFuture.uniApplyNow(CompletableFuture.java:670)
datanode_1_1  | 	at java.base/java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:658)
datanode_5_1  | STARTUP_MSG:   classpath = /etc/hadoop:/opt/hadoop/share/hadoop/common/*:/opt/hadoop/share/ozone/lib/kerb-simplekdc-1.0.1.jar:/opt/hadoop/share/ozone/lib/jackson-databind-2.10.3.jar:/opt/hadoop/share/ozone/lib/protobuf-java-2.5.0.jar:/opt/hadoop/share/ozone/lib/bcpkix-jdk15on-1.60.jar:/opt/hadoop/share/ozone/lib/netty-3.10.5.Final.jar:/opt/hadoop/share/ozone/lib/ratis-proto-0.6.0-7c5b30d-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/commons-validator-1.6.jar:/opt/hadoop/share/ozone/lib/hadoop-hdds-client-0.6.0-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/jaxb-impl-2.3.0.1.jar:/opt/hadoop/share/ozone/lib/netty-all-4.1.47.Final.jar:/opt/hadoop/share/ozone/lib/kerb-core-1.0.1.jar:/opt/hadoop/share/ozone/lib/jsr305-3.0.0.jar:/opt/hadoop/share/ozone/lib/j2objc-annotations-1.3.jar:/opt/hadoop/share/ozone/lib/leveldbjni-all-1.8.jar:/opt/hadoop/share/ozone/lib/jetty-io-9.4.26.v20200117.jar:/opt/hadoop/share/ozone/lib/htrace-core4-4.1.0-incubating.jar:/opt/hadoop/share/ozone/lib/jaxb-api-2.3.0.jar:/opt/hadoop/share/ozone/lib/hadoop-annotations-3.2.0.jar:/opt/hadoop/share/ozone/lib/kerb-util-1.0.1.jar:/opt/hadoop/share/ozone/lib/jetty-http-9.4.26.v20200117.jar:/opt/hadoop/share/ozone/lib/jetty-xml-9.4.26.v20200117.jar:/opt/hadoop/share/ozone/lib/jackson-jaxrs-1.9.13.jar:/opt/hadoop/share/ozone/lib/ratis-thirdparty-misc-0.3.0.jar:/opt/hadoop/share/ozone/lib/kerby-xdr-1.0.1.jar:/opt/hadoop/share/ozone/lib/jackson-core-asl-1.9.13.jar:/opt/hadoop/share/ozone/lib/jetty-server-9.4.26.v20200117.jar:/opt/hadoop/share/ozone/lib/commons-net-3.6.jar:/opt/hadoop/share/ozone/lib/log4j-api-2.11.0.jar:/opt/hadoop/share/ozone/lib/hadoop-hdfs-3.2.0.jar:/opt/hadoop/share/ozone/lib/opentracing-api-0.31.0.jar:/opt/hadoop/share/ozone/lib/slf4j-log4j12-1.7.25.jar:/opt/hadoop/share/ozone/lib/hadoop-hdfs-client-3.2.0.jar:/opt/hadoop/share/ozone/lib/kerby-config-1.0.1.jar:/opt/hadoop/share/ozone/lib/libthrift-0.12.0.jar:/opt/hadoop/share/ozone/lib/jetty-util-ajax-9.4.26.v20200117.jar:/opt/hadoop/share/ozone/lib/metrics-core-3.2.4.jar:/opt/hadoop/share/ozone/lib/kerby-pkix-1.0.1.jar:/opt/hadoop/share/ozone/lib/guava-28.2-jre.jar:/opt/hadoop/share/ozone/lib/jetty-servlet-9.4.26.v20200117.jar:/opt/hadoop/share/ozone/lib/xz-1.0.jar:/opt/hadoop/share/ozone/lib/activation-1.1.1.jar:/opt/hadoop/share/ozone/lib/jsr311-api-1.1.1.jar:/opt/hadoop/share/ozone/lib/commons-beanutils-1.9.4.jar:/opt/hadoop/share/ozone/lib/rocksdbjni-6.6.4.jar:/opt/hadoop/share/ozone/lib/jetty-security-9.4.26.v20200117.jar:/opt/hadoop/share/ozone/lib/hadoop-hdds-container-service-0.6.0-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/kerb-server-1.0.1.jar:/opt/hadoop/share/ozone/lib/javax.servlet-api-3.1.0.jar:/opt/hadoop/share/ozone/lib/avro-1.7.7.jar:/opt/hadoop/share/ozone/lib/kerb-client-1.0.1.jar:/opt/hadoop/share/ozone/lib/jackson-xc-1.9.13.jar:/opt/hadoop/share/ozone/lib/disruptor-3.4.2.jar:/opt/hadoop/share/ozone/lib/simpleclient_common-0.7.0.jar:/opt/hadoop/share/ozone/lib/dnsjava-2.1.7.jar:/opt/hadoop/share/ozone/lib/jackson-annotations-2.10.3.jar:/opt/hadoop/share/ozone/lib/commons-configuration2-2.1.1.jar:/opt/hadoop/share/ozone/lib/json-smart-2.3.jar:/opt/hadoop/share/ozone/lib/token-provider-1.0.1.jar:/opt/hadoop/share/ozone/lib/log4j-1.2.17.jar:/opt/hadoop/share/ozone/lib/commons-daemon-1.0.13.jar:/opt/hadoop/share/ozone/lib/listenablefuture-9999.0-empty-to-avoid-conflict-with-guava.jar:/opt/hadoop/share/ozone/lib/bcprov-jdk15on-1.60.jar:/opt/hadoop/share/ozone/lib/ratis-grpc-0.6.0-7c5b30d-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/jetty-webapp-9.4.26.v20200117.jar:/opt/hadoop/share/ozone/lib/commons-lang3-3.7.jar:/opt/hadoop/share/ozone/lib/jaeger-client-0.34.0.jar:/opt/hadoop/share/ozone/lib/commons-compress-1.4.1.jar:/opt/hadoop/share/ozone/lib/accessors-smart-1.2.jar:/opt/hadoop/share/ozone/lib/re2j-1.1.jar:/opt/hadoop/share/ozone/lib/ratis-client-0.6.0-7c5b30d-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/commons-math3-3.1.1.jar:/opt/hadoop/share/ozone/lib/simpleclient_dropwizard-0.7.0.jar:/opt/hadoop/share/ozone/lib/opentracing-noop-0.31.0.jar:/opt/hadoop/share/ozone/lib/simpleclient-0.7.0.jar:/opt/hadoop/share/ozone/lib/httpclient-4.5.2.jar:/opt/hadoop/share/ozone/lib/jaeger-core-0.34.0.jar:/opt/hadoop/share/ozone/lib/asm-5.0.4.jar:/opt/hadoop/share/ozone/lib/kerby-util-1.0.1.jar:/opt/hadoop/share/ozone/lib/failureaccess-1.0.1.jar:/opt/hadoop/share/ozone/lib/jackson-mapper-asl-1.9.13.jar:/opt/hadoop/share/ozone/lib/jsp-api-2.1.jar:/opt/hadoop/share/ozone/lib/jsch-0.1.54.jar:/opt/hadoop/share/ozone/lib/ratis-metrics-0.6.0-7c5b30d-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/opentracing-tracerresolver-0.1.5.jar:/opt/hadoop/share/ozone/lib/ratis-common-0.6.0-7c5b30d-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/paranamer-2.3.jar:/opt/hadoop/share/ozone/lib/log4j-core-2.11.0.jar:/opt/hadoop/share/ozone/lib/nimbus-jose-jwt-7.9.jar:/opt/hadoop/share/ozone/lib/commons-codec-1.11.jar:/opt/hadoop/share/ozone/lib/commons-pool2-2.6.0.jar:/opt/hadoop/share/ozone/lib/jackson-datatype-jsr310-2.10.3.jar:/opt/hadoop/share/ozone/lib/gson-2.2.4.jar:/opt/hadoop/share/ozone/lib/jcip-annotations-1.0-1.jar:/opt/hadoop/share/ozone/lib/kerb-admin-1.0.1.jar:/opt/hadoop/share/ozone/lib/commons-io-2.5.jar:/opt/hadoop/share/ozone/lib/okio-1.13.0.jar:/opt/hadoop/share/ozone/lib/snakeyaml-1.16.jar:/opt/hadoop/share/ozone/lib/jetty-util-9.4.26.v20200117.jar:/opt/hadoop/share/ozone/lib/jersey-core-1.19.jar:/opt/hadoop/share/ozone/lib/hadoop-hdds-hadoop-dependency-client-0.6.0-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/checker-qual-2.10.0.jar:/opt/hadoop/share/ozone/lib/ratis-server-0.6.0-7c5b30d-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/hadoop-hdds-server-framework-0.6.0-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/error_prone_annotations-2.3.4.jar:/opt/hadoop/share/ozone/lib/picocli-3.9.6.jar:/opt/hadoop/share/ozone/lib/jaeger-thrift-0.34.0.jar:/opt/hadoop/share/ozone/lib/hadoop-hdds-common-0.6.0-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/commons-cli-1.2.jar:/opt/hadoop/share/ozone/lib/woodstox-core-5.0.3.jar:/opt/hadoop/share/ozone/lib/snappy-java-1.0.5.jar:/opt/hadoop/share/ozone/lib/javax.annotation-api-1.2.jar:/opt/hadoop/share/ozone/lib/jaeger-tracerresolver-0.34.0.jar:/opt/hadoop/share/ozone/lib/kerby-asn1-1.0.1.jar:/opt/hadoop/share/ozone/lib/okhttp-3.9.0.jar:/opt/hadoop/share/ozone/lib/hadoop-hdds-config-0.6.0-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/stax2-api-3.1.4.jar:/opt/hadoop/share/ozone/lib/commons-collections-3.2.2.jar:/opt/hadoop/share/ozone/lib/commons-digester-1.8.1.jar:/opt/hadoop/share/ozone/lib/jettison-1.1.jar:/opt/hadoop/share/ozone/lib/commons-text-1.4.jar:/opt/hadoop/share/ozone/lib/jackson-core-2.10.3.jar:/opt/hadoop/share/ozone/lib/jersey-servlet-1.19.jar:/opt/hadoop/share/ozone/lib/jersey-json-1.19.jar:/opt/hadoop/share/ozone/lib/slf4j-api-1.7.25.jar:/opt/hadoop/share/ozone/lib/commons-logging-1.1.3.jar:/opt/hadoop/share/ozone/lib/kerb-identity-1.0.1.jar:/opt/hadoop/share/ozone/lib/opentracing-util-0.31.0.jar:/opt/hadoop/share/ozone/lib/hadoop-hdds-hadoop-dependency-server-0.6.0-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/hadoop-common-3.2.0.jar:/opt/hadoop/share/ozone/lib/hadoop-auth-3.2.0.jar:/opt/hadoop/share/ozone/lib/kerb-common-1.0.1.jar:/opt/hadoop/share/ozone/lib/jaxb-core-2.3.0.1.jar:/opt/hadoop/share/ozone/lib/jersey-server-1.19.jar:/opt/hadoop/share/ozone/lib/hadoop-hdds-common-0.6.0-SNAPSHOT-tests.jar:/opt/hadoop/share/ozone/lib/kerb-crypto-1.0.1.jar:/opt/hadoop/share/ozone/lib/httpcore-4.4.4.jar:/opt/hadoop/share/ozone/lib/ratis-netty-0.6.0-7c5b30d-SNAPSHOT.jar:/opt/hadoop/share/ozone/web:/opt/hadoop/share/ozone/lib/hadoop-ozone-datanode-0.6.0-SNAPSHOT.jar
datanode_5_1  | STARTUP_MSG:   build = https://github.com/apache/hadoop.git -r e97acb3bd8f3befd27418996fa5d4b50bf2e17bf; compiled by 'sunilg' on 2019-01-15T17:34Z
datanode_5_1  | STARTUP_MSG:   java = 11.0.6
datanode_5_1  | ************************************************************/
datanode_5_1  | 2020-04-17 18:50:16,718 [main] INFO ozone.HddsDatanodeService: registered UNIX signal handlers for [TERM, HUP, INT]
datanode_5_1  | 2020-04-17 18:50:18,743 [main] INFO metrics.MetricRegistries: Loaded MetricRegistries class org.apache.ratis.metrics.impl.MetricRegistriesImpl
datanode_5_1  | 2020-04-17 18:50:19,321 [main] INFO impl.MetricsConfig: Loaded properties from hadoop-metrics2.properties
datanode_5_1  | 2020-04-17 18:50:20,569 [main] INFO impl.MetricsSystemImpl: Scheduled Metric snapshot period at 10 second(s).
datanode_5_1  | 2020-04-17 18:50:20,569 [main] INFO impl.MetricsSystemImpl: HddsDatanode metrics system started
datanode_5_1  | 2020-04-17 18:50:21,676 [main] INFO ozone.HddsDatanodeService: HddsDatanodeService host:650579c681b3 ip:10.5.0.8
datanode_5_1  | 2020-04-17 18:50:22,652 [main] INFO fs.SaveSpaceUsageToFile: Cached usage info file /data/hdds/scmUsed not found
datanode_5_1  | 2020-04-17 18:50:22,684 [main] INFO volume.HddsVolume: Creating Volume: /data/hdds/hdds of storage type : DISK and capacity : 89311358976
datanode_5_1  | 2020-04-17 18:50:22,694 [main] INFO volume.MutableVolumeSet: Added Volume : /data/hdds/hdds to VolumeSet
datanode_5_1  | 2020-04-17 18:50:22,776 [main] INFO volume.ThrottledAsyncChecker: Scheduling a check for /data/hdds/hdds
datanode_5_1  | 2020-04-17 18:50:22,948 [main] INFO volume.HddsVolumeChecker: Scheduled health check for volume /data/hdds/hdds
datanode_5_1  | 2020-04-17 18:50:28,566 [main] WARN server.ServerUtils: Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
datanode_5_1  | 2020-04-17 18:50:28,953 [main] INFO impl.RaftServerProxy: raft.rpc.type = GRPC (default)
datanode_5_1  | 2020-04-17 18:50:29,328 [main] INFO grpc.GrpcConfigKeys: raft.grpc.server.port = 9858 (custom)
datanode_5_1  | 2020-04-17 18:50:29,336 [main] INFO server.GrpcService: raft.grpc.message.size.max = 32MB (=33554432) (custom)
datanode_5_1  | 2020-04-17 18:50:29,344 [main] INFO server.RaftServerConfigKeys: raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
datanode_5_1  | 2020-04-17 18:50:29,346 [main] INFO server.GrpcService: raft.grpc.flow.control.window = 5MB (=5242880) (custom)
datanode_5_1  | 2020-04-17 18:50:29,356 [main] INFO server.RaftServerConfigKeys: raft.server.rpc.request.timeout = 60s (custom)
datanode_5_1  | 2020-04-17 18:50:30,789 [main] INFO server.RaftServerConfigKeys: raft.server.storage.dir = [/data/metadata/ratis] (custom)
datanode_5_1  | 2020-04-17 18:50:31,477 [main] INFO http.BaseHttpServer: Starting Web-server for hddsDatanode at: http://0.0.0.0:9882
datanode_5_1  | 2020-04-17 18:50:31,593 [main] INFO util.log: Logging initialized @20630ms to org.eclipse.jetty.util.log.Slf4jLog
datanode_5_1  | 2020-04-17 18:50:32,173 [main] INFO server.AuthenticationFilter: Unable to initialize FileSignerSecretProvider, falling back to use random secrets.
datanode_5_1  | 2020-04-17 18:50:32,233 [main] INFO http.HttpRequestLog: Http request log for http.requests.hddsDatanode is not defined
datanode_5_1  | 2020-04-17 18:50:32,284 [main] INFO http.HttpServer2: Added global filter 'safety' (class=org.apache.hadoop.hdds.server.http.HttpServer2$QuotingInputFilter)
datanode_5_1  | 2020-04-17 18:50:32,328 [main] INFO http.HttpServer2: Added filter static_user_filter (class=org.apache.hadoop.hdds.server.http.StaticUserWebFilter$StaticUserFilter) to context hddsDatanode
datanode_5_1  | 2020-04-17 18:50:32,328 [main] INFO http.HttpServer2: Added filter static_user_filter (class=org.apache.hadoop.hdds.server.http.StaticUserWebFilter$StaticUserFilter) to context static
datanode_5_1  | 2020-04-17 18:50:32,328 [main] INFO http.HttpServer2: Added filter static_user_filter (class=org.apache.hadoop.hdds.server.http.StaticUserWebFilter$StaticUserFilter) to context logs
datanode_5_1  | 2020-04-17 18:50:32,492 [main] WARN http.BaseHttpServer: /prof java profiling servlet is activated. Not safe for production!
datanode_5_1  | 2020-04-17 18:50:32,523 [main] INFO http.HttpServer2: Jetty bound to port 9882
datanode_5_1  | 2020-04-17 18:50:32,537 [main] INFO server.Server: jetty-9.4.26.v20200117; built: 2020-01-17T12:35:33.676Z; git: 7b38981d25d14afb4a12ff1f2596756144edf695; jvm 11.0.6+10-LTS
datanode_5_1  | 2020-04-17 18:50:32,704 [main] INFO server.session: DefaultSessionIdManager workerName=node0
datanode_5_1  | 2020-04-17 18:50:32,709 [main] INFO server.session: No SessionScavenger set, using defaults
datanode_5_1  | 2020-04-17 18:50:32,714 [main] INFO server.session: node0 Scavenging every 600000ms
datanode_5_1  | 2020-04-17 18:50:32,807 [main] INFO handler.ContextHandler: Started o.e.j.s.ServletContextHandler@306f6f1d{logs,/logs,file:///var/log/hadoop/,AVAILABLE}
datanode_5_1  | 2020-04-17 18:50:32,809 [main] INFO handler.ContextHandler: Started o.e.j.s.ServletContextHandler@1df1ced0{static,/static,jar:file:/opt/hadoop/share/ozone/lib/hadoop-hdds-container-service-0.6.0-SNAPSHOT.jar!/webapps/static,AVAILABLE}
datanode_5_1  | 2020-04-17 18:50:33,286 [main] INFO handler.ContextHandler: Started o.e.j.w.WebAppContext@794366a5{hddsDatanode,/,file:///tmp/jetty-0_0_0_0-9882-hadoop-hdds-container-service-0_6_0-SNAPSHOT_jar-_-any-10690255787596499166.dir/webapp/,AVAILABLE}{jar:file:/opt/hadoop/share/ozone/lib/hadoop-hdds-container-service-0.6.0-SNAPSHOT.jar!/webapps/hddsDatanode}
datanode_5_1  | 2020-04-17 18:50:33,331 [main] INFO server.AbstractConnector: Started ServerConnector@59b65dce{HTTP/1.1,[http/1.1]}{0.0.0.0:9882}
datanode_5_1  | 2020-04-17 18:50:33,331 [main] INFO server.Server: Started @22369ms
datanode_5_1  | 2020-04-17 18:50:33,347 [main] INFO impl.MetricsSinkAdapter: Sink prometheus started
datanode_5_1  | 2020-04-17 18:50:33,347 [main] INFO impl.MetricsSystemImpl: Registered sink prometheus
datanode_5_1  | 2020-04-17 18:50:33,351 [main] INFO http.BaseHttpServer: HTTP server of hddsDatanode listening at http://0.0.0.0:9882
datanode_5_1  | 2020-04-17 18:50:33,489 [org.apache.hadoop.util.JvmPauseMonitor$Monitor@55acd85a] INFO util.JvmPauseMonitor: Starting JVM pause monitor
datanode_5_1  | 2020-04-17 18:50:34,096 [Datanode State Machine Thread - 0] INFO datanode.InitDatanodeState: DatanodeDetails is persisted to /data/datanode.id
datanode_5_1  | 2020-04-17 18:50:36,574 [Datanode State Machine Thread - 0] WARN statemachine.EndpointStateMachine: Unable to communicate to SCM server at scm:9861 for past 0 seconds.
datanode_5_1  | java.net.SocketTimeoutException: Call From 650579c681b3/10.5.0.8 to scm:9861 failed on socket timeout exception: java.net.SocketTimeoutException: 1000 millis timeout while waiting for channel to be ready for read. ch : java.nio.channels.SocketChannel[connected local=/10.5.0.8:37696 remote=scm/10.5.0.71:9861]; For more details see:  http://wiki.apache.org/hadoop/SocketTimeout
datanode_5_1  | 	at java.base/jdk.internal.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
datanode_5_1  | 	at java.base/jdk.internal.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
datanode_5_1  | 	at java.base/jdk.internal.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
datanode_5_1  | 	at java.base/java.lang.reflect.Constructor.newInstance(Constructor.java:490)
datanode_5_1  | 	at org.apache.hadoop.net.NetUtils.wrapWithMessage(NetUtils.java:831)
datanode_5_1  | 	at org.apache.hadoop.net.NetUtils.wrapException(NetUtils.java:775)
datanode_5_1  | 	at org.apache.hadoop.ipc.Client.getRpcResponse(Client.java:1515)
datanode_5_1  | 	at org.apache.hadoop.ipc.Client.call(Client.java:1457)
datanode_5_1  | 	at org.apache.hadoop.ipc.Client.call(Client.java:1367)
datanode_5_1  | 	at org.apache.hadoop.ipc.ProtobufRpcEngine$Invoker.invoke(ProtobufRpcEngine.java:228)
datanode_5_1  | 	at org.apache.hadoop.ipc.ProtobufRpcEngine$Invoker.invoke(ProtobufRpcEngine.java:116)
datanode_5_1  | 	at com.sun.proxy.$Proxy39.submitRequest(Unknown Source)
datanode_5_1  | 	at org.apache.hadoop.ozone.protocolPB.StorageContainerDatanodeProtocolClientSideTranslatorPB.submitRequest(StorageContainerDatanodeProtocolClientSideTranslatorPB.java:116)
datanode_5_1  | 	at org.apache.hadoop.ozone.protocolPB.StorageContainerDatanodeProtocolClientSideTranslatorPB.getVersion(StorageContainerDatanodeProtocolClientSideTranslatorPB.java:132)
datanode_5_1  | 	at org.apache.hadoop.ozone.container.common.states.endpoint.VersionEndpointTask.call(VersionEndpointTask.java:71)
datanode_5_1  | 	at org.apache.hadoop.ozone.container.common.states.endpoint.VersionEndpointTask.call(VersionEndpointTask.java:42)
datanode_5_1  | 	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
datanode_5_1  | 	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
datanode_5_1  | 	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
datanode_5_1  | 	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
datanode_5_1  | 	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
datanode_5_1  | 	at java.base/java.lang.Thread.run(Thread.java:834)
datanode_5_1  | Caused by: java.net.SocketTimeoutException: 1000 millis timeout while waiting for channel to be ready for read. ch : java.nio.channels.SocketChannel[connected local=/10.5.0.8:37696 remote=scm/10.5.0.71:9861]
datanode_5_1  | 	at org.apache.hadoop.net.SocketIOWithTimeout.doIO(SocketIOWithTimeout.java:164)
datanode_5_1  | 	at org.apache.hadoop.net.SocketInputStream.read(SocketInputStream.java:161)
datanode_5_1  | 	at org.apache.hadoop.net.SocketInputStream.read(SocketInputStream.java:131)
datanode_5_1  | 	at java.base/java.io.FilterInputStream.read(FilterInputStream.java:133)
datanode_5_1  | 	at java.base/java.io.BufferedInputStream.fill(BufferedInputStream.java:252)
datanode_5_1  | 	at java.base/java.io.BufferedInputStream.read(BufferedInputStream.java:271)
datanode_5_1  | 	at java.base/java.io.FilterInputStream.read(FilterInputStream.java:83)
datanode_5_1  | 	at java.base/java.io.FilterInputStream.read(FilterInputStream.java:83)
datanode_5_1  | 	at org.apache.hadoop.ipc.Client$Connection$PingInputStream.read(Client.java:557)
datanode_5_1  | 	at java.base/java.io.DataInputStream.readInt(DataInputStream.java:392)
datanode_5_1  | 	at org.apache.hadoop.ipc.Client$IpcStreams.readResponse(Client.java:1816)
datanode_5_1  | 	at org.apache.hadoop.ipc.Client$Connection.receiveRpcResponse(Client.java:1173)
datanode_5_1  | 	at org.apache.hadoop.ipc.Client$Connection.run(Client.java:1069)
datanode_5_1  | 2020-04-17 18:50:37,539 [Datanode State Machine Thread - 0] INFO ozoneimpl.OzoneContainer: Attempting to start container services.
datanode_5_1  | 2020-04-17 18:50:37,544 [Datanode State Machine Thread - 0] INFO ozoneimpl.OzoneContainer: Background container scanner has been disabled.
datanode_5_1  | 2020-04-17 18:50:37,544 [Datanode State Machine Thread - 0] INFO ratis.XceiverServerRatis: Starting XceiverServerRatis 978c057e-5c38-4e20-8a8b-f271c823af7e at port 9858
datanode_5_1  | 2020-04-17 18:50:37,597 [Datanode State Machine Thread - 0] INFO impl.RaftServerProxy: 978c057e-5c38-4e20-8a8b-f271c823af7e: start RPC server
datanode_5_1  | 2020-04-17 18:50:37,714 [Datanode State Machine Thread - 0] INFO server.GrpcService: 978c057e-5c38-4e20-8a8b-f271c823af7e: GrpcService started, listening on 0.0.0.0/0.0.0.0:9858
datanode_5_1  | 2020-04-17 18:50:42,698 [Command processor thread] INFO impl.RaftServerProxy: 978c057e-5c38-4e20-8a8b-f271c823af7e: addNew group-D621A9FFD9B9:[978c057e-5c38-4e20-8a8b-f271c823af7e:10.5.0.8:9858] returns group-D621A9FFD9B9:java.util.concurrent.CompletableFuture@4802cda9[Not completed]
datanode_5_1  | 2020-04-17 18:50:42,817 [pool-69-thread-1] INFO impl.RaftServerImpl: 978c057e-5c38-4e20-8a8b-f271c823af7e: new RaftServerImpl for group-D621A9FFD9B9:[978c057e-5c38-4e20-8a8b-f271c823af7e:10.5.0.8:9858] with ContainerStateMachine:uninitialized
datanode_5_1  | 2020-04-17 18:50:42,832 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.rpc.timeout.min = 5s (custom)
datanode_5_1  | 2020-04-17 18:50:42,847 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.rpc.timeout.max = 5200ms (custom)
datanode_5_1  | 2020-04-17 18:50:42,854 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.rpcslowness.timeout = 300s (custom)
datanode_5_1  | 2020-04-17 18:50:42,855 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.sleep.deviation.threshold = 300 (default)
datanode_5_1  | 2020-04-17 18:50:42,860 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.appender.install.snapshot.enabled = false (custom)
datanode_5_1  | 2020-04-17 18:50:42,909 [pool-69-thread-1] INFO impl.RaftServerImpl: 978c057e-5c38-4e20-8a8b-f271c823af7e@group-D621A9FFD9B9: ConfigurationManager, init=-1: [978c057e-5c38-4e20-8a8b-f271c823af7e:10.5.0.8:9858], old=null, confs=<EMPTY_MAP>
datanode_5_1  | 2020-04-17 18:50:42,931 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.storage.dir = [/data/metadata/ratis] (custom)
datanode_5_1  | 2020-04-17 18:50:42,959 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.corruption.policy = EXCEPTION (default)
datanode_5_1  | 2020-04-17 18:50:42,972 [pool-69-thread-1] INFO storage.RaftStorageDirectory: The storage directory /data/metadata/ratis/aed8cd39-62be-40dc-818c-d621a9ffd9b9 does not exist. Creating ...
datanode_5_1  | 2020-04-17 18:50:43,027 [pool-69-thread-1] INFO storage.RaftStorageDirectory: Lock on /data/metadata/ratis/aed8cd39-62be-40dc-818c-d621a9ffd9b9/in_use.lock acquired by nodename 6@650579c681b3
datanode_5_1  | 2020-04-17 18:50:43,044 [pool-69-thread-1] INFO storage.RaftStorage: Storage directory /data/metadata/ratis/aed8cd39-62be-40dc-818c-d621a9ffd9b9 has been successfully formatted.
datanode_5_1  | 2020-04-17 18:50:43,075 [pool-69-thread-1] INFO ratis.ContainerStateMachine: group-D621A9FFD9B9: The snapshot info is null. Setting the last applied indexto:(t:0, i:~)
datanode_5_1  | 2020-04-17 18:50:43,087 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.notification.no-leader.timeout = 60s (default)
datanode_5_1  | 2020-04-17 18:50:43,105 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.use.memory = false (default)
datanode_5_1  | 2020-04-17 18:50:43,175 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.purge.gap = 1000000 (custom)
datanode_5_1  | 2020-04-17 18:50:43,179 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
datanode_5_1  | 2020-04-17 18:50:43,198 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.segment.size.max = 1048576 (custom)
datanode_5_1  | 2020-04-17 18:50:43,235 [pool-69-thread-1] INFO metrics.RatisMetrics: Creating Metrics Registry : ratis.log_worker.978c057e-5c38-4e20-8a8b-f271c823af7e
datanode_5_1  | 2020-04-17 18:50:43,366 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.segment.cache.num.max = 2 (custom)
datanode_5_1  | 2020-04-17 18:50:43,431 [pool-69-thread-1] INFO segmented.SegmentedRaftLogWorker: new 978c057e-5c38-4e20-8a8b-f271c823af7e@group-D621A9FFD9B9-SegmentedRaftLogWorker for RaftStorage:Storage Directory /data/metadata/ratis/aed8cd39-62be-40dc-818c-d621a9ffd9b9
datanode_5_1  | 2020-04-17 18:50:43,443 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.queue.byte-limit = 2147483647 (custom)
datanode_5_1  | 2020-04-17 18:50:43,446 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.queue.element-limit = 1024 (custom)
datanode_5_1  | 2020-04-17 18:50:43,464 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.segment.size.max = 1048576 (custom)
datanode_5_1  | 2020-04-17 18:50:43,470 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.preallocated.size = 16384 (custom)
datanode_5_1  | 2020-04-17 18:50:43,474 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.write.buffer.size = 1048576 (custom)
datanode_5_1  | 2020-04-17 18:50:43,495 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.force.sync.num = 128 (default)
datanode_5_1  | 2020-04-17 18:50:43,519 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.statemachine.data.sync = true (default)
datanode_5_1  | 2020-04-17 18:50:43,521 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.statemachine.data.sync.timeout = 10s (default)
datanode_5_1  | 2020-04-17 18:50:43,522 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
datanode_5_1  | 2020-04-17 18:50:43,645 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.statemachine.data.caching.enabled = true (custom)
datanode_5_1  | 2020-04-17 18:50:43,686 [pool-69-thread-1] INFO segmented.SegmentedRaftLogWorker: 978c057e-5c38-4e20-8a8b-f271c823af7e@group-D621A9FFD9B9-SegmentedRaftLogWorker: flushIndex: setUnconditionally 0 -> -1
datanode_5_1  | 2020-04-17 18:50:43,808 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.snapshot.auto.trigger.enabled = true (custom)
datanode_5_1  | 2020-04-17 18:50:43,814 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
datanode_5_1  | 2020-04-17 18:50:43,827 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.snapshot.retention.file.num = 5 (custom)
datanode_5_1  | 2020-04-17 18:50:43,831 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.retrycache.expirytime = 600000ms (custom)
datanode_5_1  | 2020-04-17 18:50:43,960 [pool-69-thread-1] INFO metrics.RatisMetrics: Creating Metrics Registry : ratis.leader_election.978c057e-5c38-4e20-8a8b-f271c823af7e@group-D621A9FFD9B9
datanode_5_1  | 2020-04-17 18:50:43,965 [pool-69-thread-1] INFO metrics.RatisMetrics: Creating Metrics Registry : ratis.server.978c057e-5c38-4e20-8a8b-f271c823af7e@group-D621A9FFD9B9
datanode_5_1  | 2020-04-17 18:50:43,987 [pool-69-thread-1] INFO impl.RaftServerImpl: 978c057e-5c38-4e20-8a8b-f271c823af7e@group-D621A9FFD9B9: start as a follower, conf=-1: [978c057e-5c38-4e20-8a8b-f271c823af7e:10.5.0.8:9858], old=null
datanode_5_1  | 2020-04-17 18:50:43,988 [pool-69-thread-1] INFO impl.RaftServerImpl: 978c057e-5c38-4e20-8a8b-f271c823af7e@group-D621A9FFD9B9: changes role from      null to FOLLOWER at term 0 for startAsFollower
datanode_5_1  | 2020-04-17 18:50:44,018 [pool-69-thread-1] INFO impl.RoleInfo: 978c057e-5c38-4e20-8a8b-f271c823af7e: start FollowerState
datanode_5_1  | 2020-04-17 18:50:44,039 [pool-69-thread-1] INFO util.JmxRegister: Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-D621A9FFD9B9,id=978c057e-5c38-4e20-8a8b-f271c823af7e
datanode_5_1  | 2020-04-17 18:50:44,056 [pool-69-thread-1] INFO metrics.RatisMetrics: Creating Metrics Registry : ratis.state_machine.978c057e-5c38-4e20-8a8b-f271c823af7e@group-D621A9FFD9B9
datanode_5_1  | 2020-04-17 18:50:44,103 [Command processor thread] INFO commandhandler.CreatePipelineCommandHandler: Created Pipeline RATIS ONE #id: "aed8cd39-62be-40dc-818c-d621a9ffd9b9"
datanode_5_1  | .
datanode_5_1  | 2020-04-17 18:50:44,117 [Command processor thread] INFO impl.RaftServerProxy: 978c057e-5c38-4e20-8a8b-f271c823af7e: addNew group-385EF22ED913:[978c057e-5c38-4e20-8a8b-f271c823af7e:10.5.0.8:9858, a0acbcec-d753-414c-b077-647d02aaa7fb:10.5.0.7:9858, 0e99e1b0-220f-42bd-a39f-d4658f80d0e4:10.5.0.5:9858] returns group-385EF22ED913:java.util.concurrent.CompletableFuture@4e3729ed[Not completed]
datanode_5_1  | 2020-04-17 18:50:44,123 [pool-69-thread-1] INFO impl.RaftServerImpl: 978c057e-5c38-4e20-8a8b-f271c823af7e: new RaftServerImpl for group-385EF22ED913:[978c057e-5c38-4e20-8a8b-f271c823af7e:10.5.0.8:9858, a0acbcec-d753-414c-b077-647d02aaa7fb:10.5.0.7:9858, 0e99e1b0-220f-42bd-a39f-d4658f80d0e4:10.5.0.5:9858] with ContainerStateMachine:uninitialized
datanode_3_1  | Enabled profiling in kernel
datanode_3_1  | No '-XX:...' jvm parameters are used. Adding safer GC settings to the HADOOP_OPTS
datanode_3_1  | OpenJDK 64-Bit Server VM warning: Option UseConcMarkSweepGC was deprecated in version 9.0 and will likely be removed in a future release.
datanode_3_1  | 2020-04-17 18:50:11,730 [main] INFO ozone.HddsDatanodeService: STARTUP_MSG: 
datanode_3_1  | /************************************************************
datanode_3_1  | STARTUP_MSG: Starting HddsDatanodeService
datanode_3_1  | STARTUP_MSG:   host = 758abb5d524f/10.5.0.6
datanode_3_1  | STARTUP_MSG:   args = []
datanode_3_1  | STARTUP_MSG:   version = 3.2.0
datanode_1_1  | 	at java.base/java.util.concurrent.CompletableFuture.thenApplyAsync(CompletableFuture.java:2104)
datanode_1_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupAddAsync(RaftServerProxy.java:379)
datanode_1_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupManagementAsync(RaftServerProxy.java:363)
datanode_1_1  | 	at org.apache.ratis.grpc.server.GrpcAdminProtocolService.lambda$groupManagement$0(GrpcAdminProtocolService.java:42)
datanode_1_1  | 	at org.apache.ratis.grpc.GrpcUtil.asyncCall(GrpcUtil.java:160)
datanode_1_1  | 	at org.apache.ratis.grpc.server.GrpcAdminProtocolService.groupManagement(GrpcAdminProtocolService.java:42)
datanode_1_1  | 	at org.apache.ratis.proto.grpc.AdminProtocolServiceGrpc$MethodHandlers.invoke(AdminProtocolServiceGrpc.java:358)
datanode_1_1  | 	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$UnaryServerCallHandler$UnaryServerCallListener.onHalfClose(ServerCalls.java:172)
datanode_1_1  | 	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.halfClosed(ServerCallImpl.java:331)
datanode_1_1  | 	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1HalfClosed.runInContext(ServerImpl.java:814)
datanode_1_1  | 	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
datanode_1_1  | 	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:123)
datanode_1_1  | 	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
datanode_1_1  | 	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
datanode_1_1  | 	at java.base/java.lang.Thread.run(Thread.java:834)
datanode_1_1  | Caused by: org.apache.ratis.protocol.AlreadyExistsException: b23d8fb0-3698-40b4-ac98-17b8605a770b: Failed to add group-F5BD6C5F0281:[b23d8fb0-3698-40b4-ac98-17b8605a770b:10.5.0.4:9858, 32863f73-3555-4b23-932a-0d28eb668aea:10.5.0.6:9858, 79669a1f-2445-496e-a337-3115205f3ae5:10.5.0.9:9858] since the group already exists in the map.
datanode_1_1  | 	at org.apache.ratis.server.impl.RaftServerProxy$ImplMap.addNew(RaftServerProxy.java:83)
datanode_1_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupAddAsync(RaftServerProxy.java:378)
datanode_1_1  | 	... 13 more
datanode_1_1  | 2020-04-17 18:50:45,959 [grpc-default-executor-0] WARN impl.RaftServerProxy: b23d8fb0-3698-40b4-ac98-17b8605a770b: Failed groupAdd* GroupManagementRequest:client-21D6CB334566->b23d8fb0-3698-40b4-ac98-17b8605a770b@group-F5BD6C5F0281, cid=1, seq=0, RW, null, Add:group-F5BD6C5F0281:[b23d8fb0-3698-40b4-ac98-17b8605a770b:10.5.0.4:9858, 32863f73-3555-4b23-932a-0d28eb668aea:10.5.0.6:9858, 79669a1f-2445-496e-a337-3115205f3ae5:10.5.0.9:9858]
datanode_1_1  | java.util.concurrent.CompletionException: org.apache.ratis.protocol.AlreadyExistsException: b23d8fb0-3698-40b4-ac98-17b8605a770b: Failed to add group-F5BD6C5F0281:[b23d8fb0-3698-40b4-ac98-17b8605a770b:10.5.0.4:9858, 32863f73-3555-4b23-932a-0d28eb668aea:10.5.0.6:9858, 79669a1f-2445-496e-a337-3115205f3ae5:10.5.0.9:9858] since the group already exists in the map.
datanode_1_1  | 	at java.base/java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:331)
datanode_1_1  | 	at java.base/java.util.concurrent.CompletableFuture.uniApplyNow(CompletableFuture.java:670)
datanode_1_1  | 	at java.base/java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:658)
datanode_1_1  | 	at java.base/java.util.concurrent.CompletableFuture.thenApplyAsync(CompletableFuture.java:2104)
datanode_1_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupAddAsync(RaftServerProxy.java:379)
datanode_1_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupManagementAsync(RaftServerProxy.java:363)
datanode_1_1  | 	at org.apache.ratis.grpc.server.GrpcAdminProtocolService.lambda$groupManagement$0(GrpcAdminProtocolService.java:42)
datanode_1_1  | 	at org.apache.ratis.grpc.GrpcUtil.asyncCall(GrpcUtil.java:160)
datanode_1_1  | 	at org.apache.ratis.grpc.server.GrpcAdminProtocolService.groupManagement(GrpcAdminProtocolService.java:42)
datanode_1_1  | 	at org.apache.ratis.proto.grpc.AdminProtocolServiceGrpc$MethodHandlers.invoke(AdminProtocolServiceGrpc.java:358)
datanode_1_1  | 	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$UnaryServerCallHandler$UnaryServerCallListener.onHalfClose(ServerCalls.java:172)
datanode_1_1  | 	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.halfClosed(ServerCallImpl.java:331)
datanode_1_1  | 	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1HalfClosed.runInContext(ServerImpl.java:814)
datanode_1_1  | 	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
datanode_1_1  | 	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:123)
datanode_1_1  | 	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
datanode_1_1  | 	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
datanode_1_1  | 	at java.base/java.lang.Thread.run(Thread.java:834)
datanode_1_1  | Caused by: org.apache.ratis.protocol.AlreadyExistsException: b23d8fb0-3698-40b4-ac98-17b8605a770b: Failed to add group-F5BD6C5F0281:[b23d8fb0-3698-40b4-ac98-17b8605a770b:10.5.0.4:9858, 32863f73-3555-4b23-932a-0d28eb668aea:10.5.0.6:9858, 79669a1f-2445-496e-a337-3115205f3ae5:10.5.0.9:9858] since the group already exists in the map.
datanode_1_1  | 	at org.apache.ratis.server.impl.RaftServerProxy$ImplMap.addNew(RaftServerProxy.java:83)
datanode_1_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupAddAsync(RaftServerProxy.java:378)
datanode_1_1  | 	... 13 more
datanode_1_1  | 2020-04-17 18:50:46,694 [Command processor thread] INFO commandhandler.CreatePipelineCommandHandler: Created Pipeline RATIS THREE #id: "315eee3a-6983-45b7-a699-f5bd6c5f0281"
datanode_1_1  | .
datanode_1_1  | 2020-04-17 18:50:47,018 [grpc-default-executor-0] INFO impl.RaftServerImpl: b23d8fb0-3698-40b4-ac98-17b8605a770b@group-F5BD6C5F0281: changes role from  FOLLOWER to FOLLOWER at term 1 for recognizeCandidate:79669a1f-2445-496e-a337-3115205f3ae5
datanode_1_1  | 2020-04-17 18:50:47,023 [grpc-default-executor-0] INFO impl.RoleInfo: b23d8fb0-3698-40b4-ac98-17b8605a770b: shutdown FollowerState
datanode_1_1  | 2020-04-17 18:50:47,025 [Thread-25] INFO impl.FollowerState: b23d8fb0-3698-40b4-ac98-17b8605a770b@group-F5BD6C5F0281-FollowerState was interrupted: java.lang.InterruptedException: sleep interrupted
datanode_1_1  | 2020-04-17 18:50:47,026 [grpc-default-executor-0] INFO impl.RoleInfo: b23d8fb0-3698-40b4-ac98-17b8605a770b: start FollowerState
datanode_1_1  | 2020-04-17 18:50:47,385 [grpc-default-executor-0] INFO ratis.XceiverServerRatis: Leader change notification received for group: group-F5BD6C5F0281 with new leaderId: 79669a1f-2445-496e-a337-3115205f3ae5
datanode_1_1  | 2020-04-17 18:50:47,391 [grpc-default-executor-0] INFO impl.RaftServerImpl: b23d8fb0-3698-40b4-ac98-17b8605a770b@group-F5BD6C5F0281: change Leader from null to 79669a1f-2445-496e-a337-3115205f3ae5 at term 1 for appendEntries, leader elected after 4124ms
datanode_1_1  | 2020-04-17 18:50:47,522 [grpc-default-executor-0] INFO impl.RaftServerImpl: b23d8fb0-3698-40b4-ac98-17b8605a770b@group-F5BD6C5F0281: set configuration 0: [b23d8fb0-3698-40b4-ac98-17b8605a770b:10.5.0.4:9858, 32863f73-3555-4b23-932a-0d28eb668aea:10.5.0.6:9858, 79669a1f-2445-496e-a337-3115205f3ae5:10.5.0.9:9858], old=null at 0
datanode_1_1  | 2020-04-17 18:50:47,602 [grpc-default-executor-0] INFO segmented.SegmentedRaftLogWorker: b23d8fb0-3698-40b4-ac98-17b8605a770b@group-F5BD6C5F0281-SegmentedRaftLogWorker: Starting segment from index:0
datanode_1_1  | 2020-04-17 18:50:47,867 [b23d8fb0-3698-40b4-ac98-17b8605a770b@group-F5BD6C5F0281-SegmentedRaftLogWorker] INFO segmented.SegmentedRaftLogWorker: b23d8fb0-3698-40b4-ac98-17b8605a770b@group-F5BD6C5F0281-SegmentedRaftLogWorker: created new log segment /data/metadata/ratis/315eee3a-6983-45b7-a699-f5bd6c5f0281/current/log_inprogress_0
datanode_2_1  | 2020-04-17 18:52:30,071 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.segment.cache.num.max = 2 (custom)
datanode_2_1  | 2020-04-17 18:52:30,072 [pool-69-thread-1] INFO segmented.SegmentedRaftLogWorker: new 0e99e1b0-220f-42bd-a39f-d4658f80d0e4@group-79E0035D853A-SegmentedRaftLogWorker for RaftStorage:Storage Directory /data/metadata/ratis/cad403d1-ea2f-4530-84e5-79e0035d853a
datanode_2_1  | 2020-04-17 18:52:30,072 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.queue.byte-limit = 2147483647 (custom)
datanode_2_1  | 2020-04-17 18:52:30,072 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.queue.element-limit = 1024 (custom)
datanode_2_1  | 2020-04-17 18:52:30,072 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.segment.size.max = 1048576 (custom)
datanode_2_1  | 2020-04-17 18:52:30,077 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.preallocated.size = 16384 (custom)
datanode_2_1  | 2020-04-17 18:52:30,078 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.write.buffer.size = 1048576 (custom)
datanode_2_1  | 2020-04-17 18:52:30,078 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.force.sync.num = 128 (default)
datanode_2_1  | 2020-04-17 18:52:30,078 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.statemachine.data.sync = true (default)
datanode_2_1  | 2020-04-17 18:52:30,078 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.statemachine.data.sync.timeout = 10s (default)
datanode_2_1  | 2020-04-17 18:52:30,078 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
datanode_2_1  | 2020-04-17 18:52:30,079 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.statemachine.data.caching.enabled = true (custom)
datanode_2_1  | 2020-04-17 18:52:30,079 [pool-69-thread-1] INFO segmented.SegmentedRaftLogWorker: 0e99e1b0-220f-42bd-a39f-d4658f80d0e4@group-79E0035D853A-SegmentedRaftLogWorker: flushIndex: setUnconditionally 0 -> -1
datanode_2_1  | 2020-04-17 18:52:30,088 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.snapshot.auto.trigger.enabled = true (custom)
datanode_2_1  | 2020-04-17 18:52:30,088 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
datanode_2_1  | 2020-04-17 18:52:30,088 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.snapshot.retention.file.num = 5 (custom)
datanode_2_1  | 2020-04-17 18:52:30,089 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.retrycache.expirytime = 600000ms (custom)
datanode_2_1  | 2020-04-17 18:52:30,089 [pool-69-thread-1] INFO metrics.RatisMetrics: Creating Metrics Registry : ratis.leader_election.0e99e1b0-220f-42bd-a39f-d4658f80d0e4@group-79E0035D853A
datanode_2_1  | 2020-04-17 18:52:30,089 [pool-69-thread-1] INFO metrics.RatisMetrics: Creating Metrics Registry : ratis.server.0e99e1b0-220f-42bd-a39f-d4658f80d0e4@group-79E0035D853A
datanode_2_1  | 2020-04-17 18:52:30,090 [pool-69-thread-1] INFO impl.RaftServerImpl: 0e99e1b0-220f-42bd-a39f-d4658f80d0e4@group-79E0035D853A: start as a follower, conf=-1: [978c057e-5c38-4e20-8a8b-f271c823af7e:10.5.0.8:9858, a0acbcec-d753-414c-b077-647d02aaa7fb:10.5.0.7:9858, 0e99e1b0-220f-42bd-a39f-d4658f80d0e4:10.5.0.5:9858], old=null
datanode_2_1  | 2020-04-17 18:52:30,090 [pool-69-thread-1] INFO impl.RaftServerImpl: 0e99e1b0-220f-42bd-a39f-d4658f80d0e4@group-79E0035D853A: changes role from      null to FOLLOWER at term 0 for startAsFollower
datanode_2_1  | 2020-04-17 18:52:30,090 [pool-69-thread-1] INFO impl.RoleInfo: 0e99e1b0-220f-42bd-a39f-d4658f80d0e4: start FollowerState
datanode_2_1  | 2020-04-17 18:52:30,091 [pool-69-thread-1] INFO util.JmxRegister: Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-79E0035D853A,id=0e99e1b0-220f-42bd-a39f-d4658f80d0e4
datanode_2_1  | 2020-04-17 18:52:30,091 [pool-69-thread-1] INFO metrics.RatisMetrics: Creating Metrics Registry : ratis.state_machine.0e99e1b0-220f-42bd-a39f-d4658f80d0e4@group-79E0035D853A
datanode_2_1  | 2020-04-17 18:52:30,123 [Command processor thread] INFO impl.RaftServerProxy: 0e99e1b0-220f-42bd-a39f-d4658f80d0e4: remove  FOLLOWER 0e99e1b0-220f-42bd-a39f-d4658f80d0e4@group-385EF22ED913:t1, leader=a0acbcec-d753-414c-b077-647d02aaa7fb, voted=a0acbcec-d753-414c-b077-647d02aaa7fb, raftlog=0e99e1b0-220f-42bd-a39f-d4658f80d0e4@group-385EF22ED913-SegmentedRaftLog:OPENED:c0,f0,i2, conf=0: [978c057e-5c38-4e20-8a8b-f271c823af7e:10.5.0.8:9858, a0acbcec-d753-414c-b077-647d02aaa7fb:10.5.0.7:9858, 0e99e1b0-220f-42bd-a39f-d4658f80d0e4:10.5.0.5:9858], old=null RUNNING
datanode_2_1  | 2020-04-17 18:52:30,124 [Command processor thread] INFO impl.RaftServerImpl: 0e99e1b0-220f-42bd-a39f-d4658f80d0e4@group-385EF22ED913: shutdown
datanode_2_1  | 2020-04-17 18:52:30,124 [Command processor thread] INFO util.JmxRegister: Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-385EF22ED913,id=0e99e1b0-220f-42bd-a39f-d4658f80d0e4
datanode_2_1  | 2020-04-17 18:52:30,125 [Command processor thread] INFO impl.RoleInfo: 0e99e1b0-220f-42bd-a39f-d4658f80d0e4: shutdown FollowerState
datanode_2_1  | 2020-04-17 18:52:30,125 [Thread-28] INFO impl.FollowerState: 0e99e1b0-220f-42bd-a39f-d4658f80d0e4@group-385EF22ED913-FollowerState was interrupted: java.lang.InterruptedException: sleep interrupted
datanode_2_1  | 2020-04-17 18:52:30,125 [Command processor thread] INFO impl.StateMachineUpdater: 0e99e1b0-220f-42bd-a39f-d4658f80d0e4@group-385EF22ED913-StateMachineUpdater: set stopIndex = 0
datanode_2_1  | 2020-04-17 18:52:30,127 [0e99e1b0-220f-42bd-a39f-d4658f80d0e4@group-385EF22ED913-StateMachineUpdater] ERROR ratis.ContainerStateMachine: Failed to take snapshot  for group-385EF22ED913 as the stateMachine is unhealthy. The last applied index is at (t:1, i:0)
datanode_2_1  | 2020-04-17 18:52:30,127 [0e99e1b0-220f-42bd-a39f-d4658f80d0e4@group-385EF22ED913-StateMachineUpdater] ERROR impl.StateMachineUpdater: 0e99e1b0-220f-42bd-a39f-d4658f80d0e4@group-385EF22ED913-StateMachineUpdater: Failed to take snapshot
datanode_2_1  | org.apache.ratis.protocol.StateMachineException: Failed to take snapshot  for group-385EF22ED913 as the stateMachine is unhealthy. The last applied index is at (t:1, i:0)
datanode_2_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.ContainerStateMachine.takeSnapshot(ContainerStateMachine.java:288)
datanode_2_1  | 	at org.apache.ratis.server.impl.StateMachineUpdater.takeSnapshot(StateMachineUpdater.java:258)
datanode_2_1  | 	at org.apache.ratis.server.impl.StateMachineUpdater.checkAndTakeSnapshot(StateMachineUpdater.java:250)
datanode_2_1  | 	at org.apache.ratis.server.impl.StateMachineUpdater.run(StateMachineUpdater.java:169)
datanode_2_1  | 	at java.base/java.lang.Thread.run(Thread.java:834)
datanode_2_1  | 2020-04-17 18:52:30,128 [0e99e1b0-220f-42bd-a39f-d4658f80d0e4@group-385EF22ED913-StateMachineUpdater] ERROR ratis.ContainerStateMachine: Failed to take snapshot  for group-385EF22ED913 as the stateMachine is unhealthy. The last applied index is at (t:1, i:0)
datanode_2_1  | 2020-04-17 18:52:30,128 [0e99e1b0-220f-42bd-a39f-d4658f80d0e4@group-385EF22ED913-StateMachineUpdater] ERROR impl.StateMachineUpdater: 0e99e1b0-220f-42bd-a39f-d4658f80d0e4@group-385EF22ED913-StateMachineUpdater: Failed to take snapshot
datanode_2_1  | org.apache.ratis.protocol.StateMachineException: Failed to take snapshot  for group-385EF22ED913 as the stateMachine is unhealthy. The last applied index is at (t:1, i:0)
datanode_2_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.ContainerStateMachine.takeSnapshot(ContainerStateMachine.java:288)
datanode_2_1  | 	at org.apache.ratis.server.impl.StateMachineUpdater.takeSnapshot(StateMachineUpdater.java:258)
datanode_2_1  | 	at org.apache.ratis.server.impl.StateMachineUpdater.checkAndTakeSnapshot(StateMachineUpdater.java:250)
datanode_2_1  | 	at org.apache.ratis.server.impl.StateMachineUpdater.run(StateMachineUpdater.java:172)
datanode_2_1  | 	at java.base/java.lang.Thread.run(Thread.java:834)
datanode_2_1  | 2020-04-17 18:52:30,128 [0e99e1b0-220f-42bd-a39f-d4658f80d0e4@group-385EF22ED913-StateMachineUpdater] INFO metrics.RatisMetrics: Unregistering Metrics Registry : ratis.state_machine.0e99e1b0-220f-42bd-a39f-d4658f80d0e4@group-385EF22ED913
datanode_2_1  | 2020-04-17 18:52:30,129 [Command processor thread] INFO impl.RaftServerImpl: 0e99e1b0-220f-42bd-a39f-d4658f80d0e4@group-385EF22ED913: closes. applyIndex: 0
datanode_2_1  | 2020-04-17 18:52:30,130 [0e99e1b0-220f-42bd-a39f-d4658f80d0e4@group-385EF22ED913-SegmentedRaftLogWorker] INFO segmented.SegmentedRaftLogWorker: 0e99e1b0-220f-42bd-a39f-d4658f80d0e4@group-385EF22ED913-SegmentedRaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
datanode_2_1  | 2020-04-17 18:52:30,131 [Command processor thread] INFO segmented.SegmentedRaftLogWorker: 0e99e1b0-220f-42bd-a39f-d4658f80d0e4@group-385EF22ED913-SegmentedRaftLogWorker close()
datanode_2_1  | 2020-04-17 18:52:30,132 [Command processor thread] INFO metrics.RatisMetrics: Unregistering Metrics Registry : ratis.log_worker.0e99e1b0-220f-42bd-a39f-d4658f80d0e4
datanode_2_1  | 2020-04-17 18:52:30,132 [Command processor thread] INFO metrics.RatisMetrics: Unregistering Metrics Registry : ratis.leader_election.0e99e1b0-220f-42bd-a39f-d4658f80d0e4@group-385EF22ED913
datanode_2_1  | 2020-04-17 18:52:30,132 [Command processor thread] INFO metrics.RatisMetrics: Unregistering Metrics Registry : ratis.server.0e99e1b0-220f-42bd-a39f-d4658f80d0e4@group-385EF22ED913
datanode_2_1  | 2020-04-17 18:52:30,134 [Command processor thread] INFO commandhandler.ClosePipelineCommandHandler: Close Pipeline #id: "be26d0dd-802f-4608-9a1c-385ef22ed913"
datanode_2_1  |  command on datanode #0e99e1b0-220f-42bd-a39f-d4658f80d0e4.
datanode_2_1  | 2020-04-17 18:52:30,139 [Command processor thread] INFO impl.RaftServerProxy: 0e99e1b0-220f-42bd-a39f-d4658f80d0e4: remove group-385EF22ED913:null
datanode_2_1  | 2020-04-17 18:52:30,139 [Command processor thread] ERROR commandhandler.ClosePipelineCommandHandler: Can't close pipeline #id: "be26d0dd-802f-4608-9a1c-385ef22ed913"
datanode_2_1  | 
datanode_1_1  | 2020-04-17 18:50:48,177 [Thread-23] INFO impl.FollowerState: b23d8fb0-3698-40b4-ac98-17b8605a770b@group-39398B1C5C01-FollowerState: change to CANDIDATE, lastRpcTime:5137ms, electionTimeout:5081ms
datanode_1_1  | 2020-04-17 18:50:48,178 [Thread-23] INFO impl.RoleInfo: b23d8fb0-3698-40b4-ac98-17b8605a770b: shutdown FollowerState
datanode_1_1  | 2020-04-17 18:50:48,178 [Thread-23] INFO impl.RaftServerImpl: b23d8fb0-3698-40b4-ac98-17b8605a770b@group-39398B1C5C01: changes role from  FOLLOWER to CANDIDATE at term 0 for changeToCandidate
datanode_1_1  | 2020-04-17 18:50:48,180 [Thread-23] INFO impl.RoleInfo: b23d8fb0-3698-40b4-ac98-17b8605a770b: start LeaderElection
datanode_1_1  | 2020-04-17 18:50:48,199 [b23d8fb0-3698-40b4-ac98-17b8605a770b@group-39398B1C5C01-LeaderElection1] INFO impl.LeaderElection: b23d8fb0-3698-40b4-ac98-17b8605a770b@group-39398B1C5C01-LeaderElection1: begin an election at term 1 for -1: [b23d8fb0-3698-40b4-ac98-17b8605a770b:10.5.0.4:9858], old=null
datanode_1_1  | 2020-04-17 18:50:48,201 [b23d8fb0-3698-40b4-ac98-17b8605a770b@group-39398B1C5C01-LeaderElection1] INFO impl.RoleInfo: b23d8fb0-3698-40b4-ac98-17b8605a770b: shutdown LeaderElection
datanode_1_1  | 2020-04-17 18:50:48,209 [b23d8fb0-3698-40b4-ac98-17b8605a770b@group-39398B1C5C01-LeaderElection1] INFO impl.RaftServerImpl: b23d8fb0-3698-40b4-ac98-17b8605a770b@group-39398B1C5C01: changes role from CANDIDATE to LEADER at term 1 for changeToLeader
datanode_1_1  | 2020-04-17 18:50:48,210 [b23d8fb0-3698-40b4-ac98-17b8605a770b@group-39398B1C5C01-LeaderElection1] INFO ratis.XceiverServerRatis: Leader change notification received for group: group-39398B1C5C01 with new leaderId: b23d8fb0-3698-40b4-ac98-17b8605a770b
datanode_1_1  | 2020-04-17 18:50:48,210 [b23d8fb0-3698-40b4-ac98-17b8605a770b@group-39398B1C5C01-LeaderElection1] INFO impl.RaftServerImpl: b23d8fb0-3698-40b4-ac98-17b8605a770b@group-39398B1C5C01: change Leader from null to b23d8fb0-3698-40b4-ac98-17b8605a770b at term 1 for becomeLeader, leader elected after 5853ms
datanode_1_1  | 2020-04-17 18:50:48,213 [b23d8fb0-3698-40b4-ac98-17b8605a770b@group-39398B1C5C01-LeaderElection1] INFO server.RaftServerConfigKeys: raft.server.staging.catchup.gap = 1000 (default)
datanode_1_1  | 2020-04-17 18:50:48,227 [b23d8fb0-3698-40b4-ac98-17b8605a770b@group-39398B1C5C01-LeaderElection1] INFO server.RaftServerConfigKeys: raft.server.rpc.sleep.time = 25ms (default)
datanode_1_1  | 2020-04-17 18:50:48,236 [b23d8fb0-3698-40b4-ac98-17b8605a770b@group-39398B1C5C01-LeaderElection1] INFO metrics.RatisMetrics: Creating Metrics Registry : ratis.log_appender.b23d8fb0-3698-40b4-ac98-17b8605a770b@group-39398B1C5C01
datanode_1_1  | 2020-04-17 18:50:48,257 [b23d8fb0-3698-40b4-ac98-17b8605a770b@group-39398B1C5C01-LeaderElection1] INFO server.RaftServerConfigKeys: raft.server.write.element-limit = 1024 (custom)
datanode_1_1  | 2020-04-17 18:50:48,268 [b23d8fb0-3698-40b4-ac98-17b8605a770b@group-39398B1C5C01-LeaderElection1] INFO server.RaftServerConfigKeys: raft.server.write.byte-limit = 1073741824 (custom)
datanode_1_1  | 2020-04-17 18:50:48,298 [b23d8fb0-3698-40b4-ac98-17b8605a770b@group-39398B1C5C01-LeaderElection1] INFO server.RaftServerConfigKeys: raft.server.watch.timeout = 180s (custom)
datanode_1_1  | 2020-04-17 18:50:48,303 [b23d8fb0-3698-40b4-ac98-17b8605a770b@group-39398B1C5C01-LeaderElection1] INFO server.RaftServerConfigKeys: raft.server.watch.timeout.denomination = 1s (default)
datanode_1_1  | 2020-04-17 18:50:48,306 [b23d8fb0-3698-40b4-ac98-17b8605a770b@group-39398B1C5C01-LeaderElection1] INFO server.RaftServerConfigKeys: raft.server.watch.element-limit = 65536 (default)
datanode_1_1  | 2020-04-17 18:50:48,368 [b23d8fb0-3698-40b4-ac98-17b8605a770b@group-39398B1C5C01-LeaderElection1] INFO impl.RoleInfo: b23d8fb0-3698-40b4-ac98-17b8605a770b: start LeaderState
datanode_1_1  | 2020-04-17 18:50:48,397 [b23d8fb0-3698-40b4-ac98-17b8605a770b@group-39398B1C5C01-LeaderElection1] INFO segmented.SegmentedRaftLogWorker: b23d8fb0-3698-40b4-ac98-17b8605a770b@group-39398B1C5C01-SegmentedRaftLogWorker: Starting segment from index:0
datanode_1_1  | 2020-04-17 18:50:48,404 [b23d8fb0-3698-40b4-ac98-17b8605a770b@group-39398B1C5C01-SegmentedRaftLogWorker] INFO segmented.SegmentedRaftLogWorker: b23d8fb0-3698-40b4-ac98-17b8605a770b@group-39398B1C5C01-SegmentedRaftLogWorker: created new log segment /data/metadata/ratis/584150c2-fc44-4ccf-a30e-39398b1c5c01/current/log_inprogress_0
datanode_1_1  | 2020-04-17 18:50:48,441 [b23d8fb0-3698-40b4-ac98-17b8605a770b@group-39398B1C5C01-LeaderElection1] INFO impl.RaftServerImpl: b23d8fb0-3698-40b4-ac98-17b8605a770b@group-39398B1C5C01: set configuration 0: [b23d8fb0-3698-40b4-ac98-17b8605a770b:10.5.0.4:9858], old=null at 0
datanode_1_1  | 2020-04-17 18:54:38,754 [grpc-default-executor-1] INFO impl.RaftServerProxy: b23d8fb0-3698-40b4-ac98-17b8605a770b: addNew group-95C80522151F:[b23d8fb0-3698-40b4-ac98-17b8605a770b:10.5.0.4:9858, a0acbcec-d753-414c-b077-647d02aaa7fb:10.5.0.7:9858, 0e99e1b0-220f-42bd-a39f-d4658f80d0e4:10.5.0.5:9858] returns group-95C80522151F:java.util.concurrent.CompletableFuture@5933b0ec[Not completed]
datanode_1_1  | 2020-04-17 18:54:38,756 [pool-69-thread-1] INFO impl.RaftServerImpl: b23d8fb0-3698-40b4-ac98-17b8605a770b: new RaftServerImpl for group-95C80522151F:[b23d8fb0-3698-40b4-ac98-17b8605a770b:10.5.0.4:9858, a0acbcec-d753-414c-b077-647d02aaa7fb:10.5.0.7:9858, 0e99e1b0-220f-42bd-a39f-d4658f80d0e4:10.5.0.5:9858] with ContainerStateMachine:uninitialized
datanode_1_1  | 2020-04-17 18:54:38,759 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.rpc.timeout.min = 5s (custom)
datanode_1_1  | 2020-04-17 18:54:38,759 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.rpc.timeout.max = 5200ms (custom)
datanode_1_1  | 2020-04-17 18:54:38,760 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.rpcslowness.timeout = 300s (custom)
datanode_1_1  | 2020-04-17 18:54:38,760 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.sleep.deviation.threshold = 300 (default)
datanode_1_1  | 2020-04-17 18:54:38,760 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.appender.install.snapshot.enabled = false (custom)
datanode_1_1  | 2020-04-17 18:54:38,760 [pool-69-thread-1] INFO impl.RaftServerImpl: b23d8fb0-3698-40b4-ac98-17b8605a770b@group-95C80522151F: ConfigurationManager, init=-1: [b23d8fb0-3698-40b4-ac98-17b8605a770b:10.5.0.4:9858, a0acbcec-d753-414c-b077-647d02aaa7fb:10.5.0.7:9858, 0e99e1b0-220f-42bd-a39f-d4658f80d0e4:10.5.0.5:9858], old=null, confs=<EMPTY_MAP>
datanode_1_1  | 2020-04-17 18:54:38,761 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.storage.dir = [/data/metadata/ratis] (custom)
datanode_1_1  | 2020-04-17 18:54:38,761 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.corruption.policy = EXCEPTION (default)
datanode_1_1  | 2020-04-17 18:54:38,761 [pool-69-thread-1] INFO storage.RaftStorageDirectory: The storage directory /data/metadata/ratis/b5a22a8d-2392-4c7a-923f-95c80522151f does not exist. Creating ...
datanode_1_1  | 2020-04-17 18:54:38,763 [pool-69-thread-1] INFO storage.RaftStorageDirectory: Lock on /data/metadata/ratis/b5a22a8d-2392-4c7a-923f-95c80522151f/in_use.lock acquired by nodename 6@95d5c4783177
datanode_1_1  | 2020-04-17 18:54:38,764 [pool-69-thread-1] INFO storage.RaftStorage: Storage directory /data/metadata/ratis/b5a22a8d-2392-4c7a-923f-95c80522151f has been successfully formatted.
datanode_1_1  | 2020-04-17 18:54:38,765 [pool-69-thread-1] INFO ratis.ContainerStateMachine: group-95C80522151F: The snapshot info is null. Setting the last applied indexto:(t:0, i:~)
datanode_1_1  | 2020-04-17 18:54:38,765 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.notification.no-leader.timeout = 60s (default)
datanode_1_1  | 2020-04-17 18:54:38,765 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.use.memory = false (default)
datanode_1_1  | 2020-04-17 18:54:38,765 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.purge.gap = 1000000 (custom)
datanode_1_1  | 2020-04-17 18:54:38,765 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
datanode_3_1  | STARTUP_MSG:   classpath = /etc/hadoop:/opt/hadoop/share/hadoop/common/*:/opt/hadoop/share/ozone/lib/kerb-simplekdc-1.0.1.jar:/opt/hadoop/share/ozone/lib/jackson-databind-2.10.3.jar:/opt/hadoop/share/ozone/lib/protobuf-java-2.5.0.jar:/opt/hadoop/share/ozone/lib/bcpkix-jdk15on-1.60.jar:/opt/hadoop/share/ozone/lib/netty-3.10.5.Final.jar:/opt/hadoop/share/ozone/lib/ratis-proto-0.6.0-7c5b30d-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/commons-validator-1.6.jar:/opt/hadoop/share/ozone/lib/hadoop-hdds-client-0.6.0-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/jaxb-impl-2.3.0.1.jar:/opt/hadoop/share/ozone/lib/netty-all-4.1.47.Final.jar:/opt/hadoop/share/ozone/lib/kerb-core-1.0.1.jar:/opt/hadoop/share/ozone/lib/jsr305-3.0.0.jar:/opt/hadoop/share/ozone/lib/j2objc-annotations-1.3.jar:/opt/hadoop/share/ozone/lib/leveldbjni-all-1.8.jar:/opt/hadoop/share/ozone/lib/jetty-io-9.4.26.v20200117.jar:/opt/hadoop/share/ozone/lib/htrace-core4-4.1.0-incubating.jar:/opt/hadoop/share/ozone/lib/jaxb-api-2.3.0.jar:/opt/hadoop/share/ozone/lib/hadoop-annotations-3.2.0.jar:/opt/hadoop/share/ozone/lib/kerb-util-1.0.1.jar:/opt/hadoop/share/ozone/lib/jetty-http-9.4.26.v20200117.jar:/opt/hadoop/share/ozone/lib/jetty-xml-9.4.26.v20200117.jar:/opt/hadoop/share/ozone/lib/jackson-jaxrs-1.9.13.jar:/opt/hadoop/share/ozone/lib/ratis-thirdparty-misc-0.3.0.jar:/opt/hadoop/share/ozone/lib/kerby-xdr-1.0.1.jar:/opt/hadoop/share/ozone/lib/jackson-core-asl-1.9.13.jar:/opt/hadoop/share/ozone/lib/jetty-server-9.4.26.v20200117.jar:/opt/hadoop/share/ozone/lib/commons-net-3.6.jar:/opt/hadoop/share/ozone/lib/log4j-api-2.11.0.jar:/opt/hadoop/share/ozone/lib/hadoop-hdfs-3.2.0.jar:/opt/hadoop/share/ozone/lib/opentracing-api-0.31.0.jar:/opt/hadoop/share/ozone/lib/slf4j-log4j12-1.7.25.jar:/opt/hadoop/share/ozone/lib/hadoop-hdfs-client-3.2.0.jar:/opt/hadoop/share/ozone/lib/kerby-config-1.0.1.jar:/opt/hadoop/share/ozone/lib/libthrift-0.12.0.jar:/opt/hadoop/share/ozone/lib/jetty-util-ajax-9.4.26.v20200117.jar:/opt/hadoop/share/ozone/lib/metrics-core-3.2.4.jar:/opt/hadoop/share/ozone/lib/kerby-pkix-1.0.1.jar:/opt/hadoop/share/ozone/lib/guava-28.2-jre.jar:/opt/hadoop/share/ozone/lib/jetty-servlet-9.4.26.v20200117.jar:/opt/hadoop/share/ozone/lib/xz-1.0.jar:/opt/hadoop/share/ozone/lib/activation-1.1.1.jar:/opt/hadoop/share/ozone/lib/jsr311-api-1.1.1.jar:/opt/hadoop/share/ozone/lib/commons-beanutils-1.9.4.jar:/opt/hadoop/share/ozone/lib/rocksdbjni-6.6.4.jar:/opt/hadoop/share/ozone/lib/jetty-security-9.4.26.v20200117.jar:/opt/hadoop/share/ozone/lib/hadoop-hdds-container-service-0.6.0-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/kerb-server-1.0.1.jar:/opt/hadoop/share/ozone/lib/javax.servlet-api-3.1.0.jar:/opt/hadoop/share/ozone/lib/avro-1.7.7.jar:/opt/hadoop/share/ozone/lib/kerb-client-1.0.1.jar:/opt/hadoop/share/ozone/lib/jackson-xc-1.9.13.jar:/opt/hadoop/share/ozone/lib/disruptor-3.4.2.jar:/opt/hadoop/share/ozone/lib/simpleclient_common-0.7.0.jar:/opt/hadoop/share/ozone/lib/dnsjava-2.1.7.jar:/opt/hadoop/share/ozone/lib/jackson-annotations-2.10.3.jar:/opt/hadoop/share/ozone/lib/commons-configuration2-2.1.1.jar:/opt/hadoop/share/ozone/lib/json-smart-2.3.jar:/opt/hadoop/share/ozone/lib/token-provider-1.0.1.jar:/opt/hadoop/share/ozone/lib/log4j-1.2.17.jar:/opt/hadoop/share/ozone/lib/commons-daemon-1.0.13.jar:/opt/hadoop/share/ozone/lib/listenablefuture-9999.0-empty-to-avoid-conflict-with-guava.jar:/opt/hadoop/share/ozone/lib/bcprov-jdk15on-1.60.jar:/opt/hadoop/share/ozone/lib/ratis-grpc-0.6.0-7c5b30d-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/jetty-webapp-9.4.26.v20200117.jar:/opt/hadoop/share/ozone/lib/commons-lang3-3.7.jar:/opt/hadoop/share/ozone/lib/jaeger-client-0.34.0.jar:/opt/hadoop/share/ozone/lib/commons-compress-1.4.1.jar:/opt/hadoop/share/ozone/lib/accessors-smart-1.2.jar:/opt/hadoop/share/ozone/lib/re2j-1.1.jar:/opt/hadoop/share/ozone/lib/ratis-client-0.6.0-7c5b30d-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/commons-math3-3.1.1.jar:/opt/hadoop/share/ozone/lib/simpleclient_dropwizard-0.7.0.jar:/opt/hadoop/share/ozone/lib/opentracing-noop-0.31.0.jar:/opt/hadoop/share/ozone/lib/simpleclient-0.7.0.jar:/opt/hadoop/share/ozone/lib/httpclient-4.5.2.jar:/opt/hadoop/share/ozone/lib/jaeger-core-0.34.0.jar:/opt/hadoop/share/ozone/lib/asm-5.0.4.jar:/opt/hadoop/share/ozone/lib/kerby-util-1.0.1.jar:/opt/hadoop/share/ozone/lib/failureaccess-1.0.1.jar:/opt/hadoop/share/ozone/lib/jackson-mapper-asl-1.9.13.jar:/opt/hadoop/share/ozone/lib/jsp-api-2.1.jar:/opt/hadoop/share/ozone/lib/jsch-0.1.54.jar:/opt/hadoop/share/ozone/lib/ratis-metrics-0.6.0-7c5b30d-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/opentracing-tracerresolver-0.1.5.jar:/opt/hadoop/share/ozone/lib/ratis-common-0.6.0-7c5b30d-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/paranamer-2.3.jar:/opt/hadoop/share/ozone/lib/log4j-core-2.11.0.jar:/opt/hadoop/share/ozone/lib/nimbus-jose-jwt-7.9.jar:/opt/hadoop/share/ozone/lib/commons-codec-1.11.jar:/opt/hadoop/share/ozone/lib/commons-pool2-2.6.0.jar:/opt/hadoop/share/ozone/lib/jackson-datatype-jsr310-2.10.3.jar:/opt/hadoop/share/ozone/lib/gson-2.2.4.jar:/opt/hadoop/share/ozone/lib/jcip-annotations-1.0-1.jar:/opt/hadoop/share/ozone/lib/kerb-admin-1.0.1.jar:/opt/hadoop/share/ozone/lib/commons-io-2.5.jar:/opt/hadoop/share/ozone/lib/okio-1.13.0.jar:/opt/hadoop/share/ozone/lib/snakeyaml-1.16.jar:/opt/hadoop/share/ozone/lib/jetty-util-9.4.26.v20200117.jar:/opt/hadoop/share/ozone/lib/jersey-core-1.19.jar:/opt/hadoop/share/ozone/lib/hadoop-hdds-hadoop-dependency-client-0.6.0-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/checker-qual-2.10.0.jar:/opt/hadoop/share/ozone/lib/ratis-server-0.6.0-7c5b30d-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/hadoop-hdds-server-framework-0.6.0-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/error_prone_annotations-2.3.4.jar:/opt/hadoop/share/ozone/lib/picocli-3.9.6.jar:/opt/hadoop/share/ozone/lib/jaeger-thrift-0.34.0.jar:/opt/hadoop/share/ozone/lib/hadoop-hdds-common-0.6.0-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/commons-cli-1.2.jar:/opt/hadoop/share/ozone/lib/woodstox-core-5.0.3.jar:/opt/hadoop/share/ozone/lib/snappy-java-1.0.5.jar:/opt/hadoop/share/ozone/lib/javax.annotation-api-1.2.jar:/opt/hadoop/share/ozone/lib/jaeger-tracerresolver-0.34.0.jar:/opt/hadoop/share/ozone/lib/kerby-asn1-1.0.1.jar:/opt/hadoop/share/ozone/lib/okhttp-3.9.0.jar:/opt/hadoop/share/ozone/lib/hadoop-hdds-config-0.6.0-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/stax2-api-3.1.4.jar:/opt/hadoop/share/ozone/lib/commons-collections-3.2.2.jar:/opt/hadoop/share/ozone/lib/commons-digester-1.8.1.jar:/opt/hadoop/share/ozone/lib/jettison-1.1.jar:/opt/hadoop/share/ozone/lib/commons-text-1.4.jar:/opt/hadoop/share/ozone/lib/jackson-core-2.10.3.jar:/opt/hadoop/share/ozone/lib/jersey-servlet-1.19.jar:/opt/hadoop/share/ozone/lib/jersey-json-1.19.jar:/opt/hadoop/share/ozone/lib/slf4j-api-1.7.25.jar:/opt/hadoop/share/ozone/lib/commons-logging-1.1.3.jar:/opt/hadoop/share/ozone/lib/kerb-identity-1.0.1.jar:/opt/hadoop/share/ozone/lib/opentracing-util-0.31.0.jar:/opt/hadoop/share/ozone/lib/hadoop-hdds-hadoop-dependency-server-0.6.0-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/hadoop-common-3.2.0.jar:/opt/hadoop/share/ozone/lib/hadoop-auth-3.2.0.jar:/opt/hadoop/share/ozone/lib/kerb-common-1.0.1.jar:/opt/hadoop/share/ozone/lib/jaxb-core-2.3.0.1.jar:/opt/hadoop/share/ozone/lib/jersey-server-1.19.jar:/opt/hadoop/share/ozone/lib/hadoop-hdds-common-0.6.0-SNAPSHOT-tests.jar:/opt/hadoop/share/ozone/lib/kerb-crypto-1.0.1.jar:/opt/hadoop/share/ozone/lib/httpcore-4.4.4.jar:/opt/hadoop/share/ozone/lib/ratis-netty-0.6.0-7c5b30d-SNAPSHOT.jar:/opt/hadoop/share/ozone/web:/opt/hadoop/share/ozone/lib/hadoop-ozone-datanode-0.6.0-SNAPSHOT.jar
datanode_3_1  | STARTUP_MSG:   build = https://github.com/apache/hadoop.git -r e97acb3bd8f3befd27418996fa5d4b50bf2e17bf; compiled by 'sunilg' on 2019-01-15T17:34Z
datanode_3_1  | STARTUP_MSG:   java = 11.0.6
datanode_3_1  | ************************************************************/
datanode_3_1  | 2020-04-17 18:50:11,832 [main] INFO ozone.HddsDatanodeService: registered UNIX signal handlers for [TERM, HUP, INT]
datanode_3_1  | 2020-04-17 18:50:13,582 [main] INFO metrics.MetricRegistries: Loaded MetricRegistries class org.apache.ratis.metrics.impl.MetricRegistriesImpl
datanode_3_1  | 2020-04-17 18:50:14,150 [main] INFO impl.MetricsConfig: Loaded properties from hadoop-metrics2.properties
datanode_3_1  | 2020-04-17 18:50:15,652 [main] INFO impl.MetricsSystemImpl: Scheduled Metric snapshot period at 10 second(s).
datanode_3_1  | 2020-04-17 18:50:15,656 [main] INFO impl.MetricsSystemImpl: HddsDatanode metrics system started
datanode_3_1  | 2020-04-17 18:50:16,826 [main] INFO ozone.HddsDatanodeService: HddsDatanodeService host:758abb5d524f ip:10.5.0.6
datanode_3_1  | 2020-04-17 18:50:17,282 [main] INFO fs.SaveSpaceUsageToFile: Cached usage info file /data/hdds/scmUsed not found
datanode_3_1  | 2020-04-17 18:50:17,291 [main] INFO volume.HddsVolume: Creating Volume: /data/hdds/hdds of storage type : DISK and capacity : 89311358976
datanode_3_1  | 2020-04-17 18:50:17,315 [main] INFO volume.MutableVolumeSet: Added Volume : /data/hdds/hdds to VolumeSet
datanode_3_1  | 2020-04-17 18:50:17,405 [main] INFO volume.ThrottledAsyncChecker: Scheduling a check for /data/hdds/hdds
datanode_3_1  | 2020-04-17 18:50:17,675 [main] INFO volume.HddsVolumeChecker: Scheduled health check for volume /data/hdds/hdds
datanode_3_1  | 2020-04-17 18:50:23,704 [main] WARN server.ServerUtils: Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
datanode_3_1  | 2020-04-17 18:50:24,025 [main] INFO impl.RaftServerProxy: raft.rpc.type = GRPC (default)
datanode_3_1  | 2020-04-17 18:50:24,674 [main] INFO grpc.GrpcConfigKeys: raft.grpc.server.port = 9858 (custom)
datanode_3_1  | 2020-04-17 18:50:24,688 [main] INFO server.GrpcService: raft.grpc.message.size.max = 32MB (=33554432) (custom)
datanode_3_1  | 2020-04-17 18:50:24,695 [main] INFO server.RaftServerConfigKeys: raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
datanode_3_1  | 2020-04-17 18:50:24,707 [main] INFO server.GrpcService: raft.grpc.flow.control.window = 5MB (=5242880) (custom)
datanode_3_1  | 2020-04-17 18:50:24,717 [main] INFO server.RaftServerConfigKeys: raft.server.rpc.request.timeout = 60s (custom)
datanode_3_1  | 2020-04-17 18:50:26,476 [main] INFO server.RaftServerConfigKeys: raft.server.storage.dir = [/data/metadata/ratis] (custom)
datanode_3_1  | 2020-04-17 18:50:27,422 [main] INFO http.BaseHttpServer: Starting Web-server for hddsDatanode at: http://0.0.0.0:9882
datanode_3_1  | 2020-04-17 18:50:27,606 [main] INFO util.log: Logging initialized @20309ms to org.eclipse.jetty.util.log.Slf4jLog
datanode_3_1  | 2020-04-17 18:50:28,292 [main] INFO server.AuthenticationFilter: Unable to initialize FileSignerSecretProvider, falling back to use random secrets.
datanode_3_1  | 2020-04-17 18:50:28,301 [main] INFO http.HttpRequestLog: Http request log for http.requests.hddsDatanode is not defined
datanode_3_1  | 2020-04-17 18:50:28,345 [main] INFO http.HttpServer2: Added global filter 'safety' (class=org.apache.hadoop.hdds.server.http.HttpServer2$QuotingInputFilter)
datanode_3_1  | 2020-04-17 18:50:28,415 [main] INFO http.HttpServer2: Added filter static_user_filter (class=org.apache.hadoop.hdds.server.http.StaticUserWebFilter$StaticUserFilter) to context hddsDatanode
datanode_3_1  | 2020-04-17 18:50:28,415 [main] INFO http.HttpServer2: Added filter static_user_filter (class=org.apache.hadoop.hdds.server.http.StaticUserWebFilter$StaticUserFilter) to context logs
datanode_3_1  | 2020-04-17 18:50:28,415 [main] INFO http.HttpServer2: Added filter static_user_filter (class=org.apache.hadoop.hdds.server.http.StaticUserWebFilter$StaticUserFilter) to context static
datanode_3_1  | 2020-04-17 18:50:28,507 [main] WARN http.BaseHttpServer: /prof java profiling servlet is activated. Not safe for production!
datanode_3_1  | 2020-04-17 18:50:28,532 [main] INFO http.HttpServer2: Jetty bound to port 9882
datanode_3_1  | 2020-04-17 18:50:28,568 [main] INFO server.Server: jetty-9.4.26.v20200117; built: 2020-01-17T12:35:33.676Z; git: 7b38981d25d14afb4a12ff1f2596756144edf695; jvm 11.0.6+10-LTS
datanode_3_1  | 2020-04-17 18:50:28,940 [main] INFO server.session: DefaultSessionIdManager workerName=node0
datanode_3_1  | 2020-04-17 18:50:28,940 [main] INFO server.session: No SessionScavenger set, using defaults
datanode_3_1  | 2020-04-17 18:50:28,942 [main] INFO server.session: node0 Scavenging every 600000ms
datanode_3_1  | 2020-04-17 18:50:29,012 [main] INFO handler.ContextHandler: Started o.e.j.s.ServletContextHandler@77f68df{logs,/logs,file:///var/log/hadoop/,AVAILABLE}
datanode_3_1  | 2020-04-17 18:50:29,037 [main] INFO handler.ContextHandler: Started o.e.j.s.ServletContextHandler@65ddee5a{static,/static,jar:file:/opt/hadoop/share/ozone/lib/hadoop-hdds-container-service-0.6.0-SNAPSHOT.jar!/webapps/static,AVAILABLE}
datanode_3_1  | 2020-04-17 18:50:29,675 [main] INFO handler.ContextHandler: Started o.e.j.w.WebAppContext@2e766822{hddsDatanode,/,file:///tmp/jetty-0_0_0_0-9882-hadoop-hdds-container-service-0_6_0-SNAPSHOT_jar-_-any-5622628974216502993.dir/webapp/,AVAILABLE}{jar:file:/opt/hadoop/share/ozone/lib/hadoop-hdds-container-service-0.6.0-SNAPSHOT.jar!/webapps/hddsDatanode}
datanode_3_1  | 2020-04-17 18:50:29,739 [main] INFO server.AbstractConnector: Started ServerConnector@44784e2f{HTTP/1.1,[http/1.1]}{0.0.0.0:9882}
datanode_3_1  | 2020-04-17 18:50:29,739 [main] INFO server.Server: Started @22443ms
datanode_3_1  | 2020-04-17 18:50:29,771 [main] INFO impl.MetricsSinkAdapter: Sink prometheus started
datanode_3_1  | 2020-04-17 18:50:29,771 [main] INFO impl.MetricsSystemImpl: Registered sink prometheus
datanode_3_1  | 2020-04-17 18:50:29,784 [main] INFO http.BaseHttpServer: HTTP server of hddsDatanode listening at http://0.0.0.0:9882
datanode_3_1  | 2020-04-17 18:50:29,988 [org.apache.hadoop.util.JvmPauseMonitor$Monitor@1712396c] INFO util.JvmPauseMonitor: Starting JVM pause monitor
datanode_3_1  | 2020-04-17 18:50:30,972 [Datanode State Machine Thread - 0] INFO datanode.InitDatanodeState: DatanodeDetails is persisted to /data/datanode.id
datanode_3_1  | 2020-04-17 18:50:33,258 [Datanode State Machine Thread - 0] INFO ipc.Client: Retrying connect to server: scm/10.5.0.71:9861. Already tried 0 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=2147483647, sleepTime=1000 MILLISECONDS)
datanode_3_1  | 2020-04-17 18:50:34,259 [Datanode State Machine Thread - 0] INFO ipc.Client: Retrying connect to server: scm/10.5.0.71:9861. Already tried 1 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=2147483647, sleepTime=1000 MILLISECONDS)
datanode_3_1  | 2020-04-17 18:50:35,260 [Datanode State Machine Thread - 0] INFO ipc.Client: Retrying connect to server: scm/10.5.0.71:9861. Already tried 2 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=2147483647, sleepTime=1000 MILLISECONDS)
datanode_3_1  | 2020-04-17 18:50:36,261 [Datanode State Machine Thread - 0] INFO ipc.Client: Retrying connect to server: scm/10.5.0.71:9861. Already tried 3 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=2147483647, sleepTime=1000 MILLISECONDS)
datanode_3_1  | 2020-04-17 18:50:36,802 [Datanode State Machine Thread - 0] INFO ozoneimpl.OzoneContainer: Attempting to start container services.
datanode_3_1  | 2020-04-17 18:50:36,806 [Datanode State Machine Thread - 0] INFO ozoneimpl.OzoneContainer: Background container scanner has been disabled.
datanode_5_1  | 2020-04-17 18:50:44,124 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.rpc.timeout.min = 5s (custom)
datanode_5_1  | 2020-04-17 18:50:44,124 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.rpc.timeout.max = 5200ms (custom)
datanode_5_1  | 2020-04-17 18:50:44,124 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.rpcslowness.timeout = 300s (custom)
datanode_5_1  | 2020-04-17 18:50:44,125 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.sleep.deviation.threshold = 300 (default)
datanode_5_1  | 2020-04-17 18:50:44,125 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.appender.install.snapshot.enabled = false (custom)
datanode_5_1  | 2020-04-17 18:50:44,129 [pool-69-thread-1] INFO impl.RaftServerImpl: 978c057e-5c38-4e20-8a8b-f271c823af7e@group-385EF22ED913: ConfigurationManager, init=-1: [978c057e-5c38-4e20-8a8b-f271c823af7e:10.5.0.8:9858, a0acbcec-d753-414c-b077-647d02aaa7fb:10.5.0.7:9858, 0e99e1b0-220f-42bd-a39f-d4658f80d0e4:10.5.0.5:9858], old=null, confs=<EMPTY_MAP>
datanode_5_1  | 2020-04-17 18:50:44,134 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.storage.dir = [/data/metadata/ratis] (custom)
datanode_5_1  | 2020-04-17 18:50:44,134 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.corruption.policy = EXCEPTION (default)
datanode_5_1  | 2020-04-17 18:50:44,134 [pool-69-thread-1] INFO storage.RaftStorageDirectory: The storage directory /data/metadata/ratis/be26d0dd-802f-4608-9a1c-385ef22ed913 does not exist. Creating ...
datanode_5_1  | 2020-04-17 18:50:44,143 [pool-69-thread-1] INFO storage.RaftStorageDirectory: Lock on /data/metadata/ratis/be26d0dd-802f-4608-9a1c-385ef22ed913/in_use.lock acquired by nodename 6@650579c681b3
datanode_5_1  | 2020-04-17 18:50:44,147 [pool-69-thread-1] INFO storage.RaftStorage: Storage directory /data/metadata/ratis/be26d0dd-802f-4608-9a1c-385ef22ed913 has been successfully formatted.
datanode_5_1  | 2020-04-17 18:50:44,148 [pool-69-thread-1] INFO ratis.ContainerStateMachine: group-385EF22ED913: The snapshot info is null. Setting the last applied indexto:(t:0, i:~)
datanode_5_1  | 2020-04-17 18:50:44,148 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.notification.no-leader.timeout = 60s (default)
datanode_5_1  | 2020-04-17 18:50:44,148 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.use.memory = false (default)
datanode_5_1  | 2020-04-17 18:50:44,148 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.purge.gap = 1000000 (custom)
datanode_5_1  | 2020-04-17 18:50:44,148 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
datanode_5_1  | 2020-04-17 18:50:44,151 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.segment.size.max = 1048576 (custom)
datanode_5_1  | 2020-04-17 18:50:44,190 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.segment.cache.num.max = 2 (custom)
datanode_5_1  | 2020-04-17 18:50:44,191 [pool-69-thread-1] INFO segmented.SegmentedRaftLogWorker: new 978c057e-5c38-4e20-8a8b-f271c823af7e@group-385EF22ED913-SegmentedRaftLogWorker for RaftStorage:Storage Directory /data/metadata/ratis/be26d0dd-802f-4608-9a1c-385ef22ed913
datanode_5_1  | 2020-04-17 18:50:44,191 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.queue.byte-limit = 2147483647 (custom)
datanode_5_1  | 2020-04-17 18:50:44,191 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.queue.element-limit = 1024 (custom)
datanode_5_1  | 2020-04-17 18:50:44,191 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.segment.size.max = 1048576 (custom)
datanode_5_1  | 2020-04-17 18:50:44,191 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.preallocated.size = 16384 (custom)
datanode_5_1  | 2020-04-17 18:50:44,191 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.write.buffer.size = 1048576 (custom)
datanode_5_1  | 2020-04-17 18:50:44,192 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.force.sync.num = 128 (default)
datanode_1_1  | 2020-04-17 18:54:38,765 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.segment.size.max = 1048576 (custom)
datanode_1_1  | 2020-04-17 18:54:38,765 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.segment.cache.num.max = 2 (custom)
datanode_1_1  | 2020-04-17 18:54:38,765 [pool-69-thread-1] INFO segmented.SegmentedRaftLogWorker: new b23d8fb0-3698-40b4-ac98-17b8605a770b@group-95C80522151F-SegmentedRaftLogWorker for RaftStorage:Storage Directory /data/metadata/ratis/b5a22a8d-2392-4c7a-923f-95c80522151f
datanode_1_1  | 2020-04-17 18:54:38,765 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.queue.byte-limit = 2147483647 (custom)
datanode_1_1  | 2020-04-17 18:54:38,765 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.queue.element-limit = 1024 (custom)
datanode_1_1  | 2020-04-17 18:54:38,765 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.segment.size.max = 1048576 (custom)
datanode_1_1  | 2020-04-17 18:54:38,765 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.preallocated.size = 16384 (custom)
datanode_1_1  | 2020-04-17 18:54:38,765 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.write.buffer.size = 1048576 (custom)
datanode_1_1  | 2020-04-17 18:54:38,765 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.force.sync.num = 128 (default)
datanode_1_1  | 2020-04-17 18:54:38,765 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.statemachine.data.sync = true (default)
datanode_1_1  | 2020-04-17 18:54:38,765 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.statemachine.data.sync.timeout = 10s (default)
datanode_1_1  | 2020-04-17 18:54:38,765 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
datanode_1_1  | 2020-04-17 18:54:38,766 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.statemachine.data.caching.enabled = true (custom)
datanode_1_1  | 2020-04-17 18:54:38,767 [pool-69-thread-1] INFO segmented.SegmentedRaftLogWorker: b23d8fb0-3698-40b4-ac98-17b8605a770b@group-95C80522151F-SegmentedRaftLogWorker: flushIndex: setUnconditionally 0 -> -1
datanode_1_1  | 2020-04-17 18:54:38,768 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.snapshot.auto.trigger.enabled = true (custom)
datanode_1_1  | 2020-04-17 18:54:38,768 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
datanode_1_1  | 2020-04-17 18:54:38,768 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.snapshot.retention.file.num = 5 (custom)
datanode_1_1  | 2020-04-17 18:54:38,768 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.retrycache.expirytime = 600000ms (custom)
datanode_1_1  | 2020-04-17 18:54:38,768 [pool-69-thread-1] INFO metrics.RatisMetrics: Creating Metrics Registry : ratis.leader_election.b23d8fb0-3698-40b4-ac98-17b8605a770b@group-95C80522151F
datanode_1_1  | 2020-04-17 18:54:38,769 [pool-69-thread-1] INFO metrics.RatisMetrics: Creating Metrics Registry : ratis.server.b23d8fb0-3698-40b4-ac98-17b8605a770b@group-95C80522151F
datanode_1_1  | 2020-04-17 18:54:38,769 [pool-69-thread-1] INFO impl.RaftServerImpl: b23d8fb0-3698-40b4-ac98-17b8605a770b@group-95C80522151F: start as a follower, conf=-1: [b23d8fb0-3698-40b4-ac98-17b8605a770b:10.5.0.4:9858, a0acbcec-d753-414c-b077-647d02aaa7fb:10.5.0.7:9858, 0e99e1b0-220f-42bd-a39f-d4658f80d0e4:10.5.0.5:9858], old=null
datanode_1_1  | 2020-04-17 18:54:38,769 [pool-69-thread-1] INFO impl.RaftServerImpl: b23d8fb0-3698-40b4-ac98-17b8605a770b@group-95C80522151F: changes role from      null to FOLLOWER at term 0 for startAsFollower
datanode_1_1  | 2020-04-17 18:54:38,769 [pool-69-thread-1] INFO impl.RoleInfo: b23d8fb0-3698-40b4-ac98-17b8605a770b: start FollowerState
datanode_1_1  | 2020-04-17 18:54:38,769 [pool-69-thread-1] INFO util.JmxRegister: Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-95C80522151F,id=b23d8fb0-3698-40b4-ac98-17b8605a770b
datanode_1_1  | 2020-04-17 18:54:38,770 [pool-69-thread-1] INFO metrics.RatisMetrics: Creating Metrics Registry : ratis.state_machine.b23d8fb0-3698-40b4-ac98-17b8605a770b@group-95C80522151F
datanode_1_1  | 2020-04-17 18:54:43,779 [grpc-default-executor-1] INFO impl.RaftServerImpl: b23d8fb0-3698-40b4-ac98-17b8605a770b@group-95C80522151F: changes role from  FOLLOWER to FOLLOWER at term 1 for recognizeCandidate:a0acbcec-d753-414c-b077-647d02aaa7fb
datanode_1_1  | 2020-04-17 18:54:43,779 [grpc-default-executor-1] INFO impl.RoleInfo: b23d8fb0-3698-40b4-ac98-17b8605a770b: shutdown FollowerState
datanode_1_1  | 2020-04-17 18:54:43,779 [grpc-default-executor-1] INFO impl.RoleInfo: b23d8fb0-3698-40b4-ac98-17b8605a770b: start FollowerState
datanode_1_1  | 2020-04-17 18:54:43,779 [Thread-212] INFO impl.FollowerState: b23d8fb0-3698-40b4-ac98-17b8605a770b@group-95C80522151F-FollowerState was interrupted: java.lang.InterruptedException: sleep interrupted
datanode_1_1  | 2020-04-17 18:54:43,799 [grpc-default-executor-1] INFO ratis.XceiverServerRatis: Leader change notification received for group: group-95C80522151F with new leaderId: a0acbcec-d753-414c-b077-647d02aaa7fb
datanode_1_1  | 2020-04-17 18:54:43,799 [grpc-default-executor-1] INFO impl.RaftServerImpl: b23d8fb0-3698-40b4-ac98-17b8605a770b@group-95C80522151F: change Leader from null to a0acbcec-d753-414c-b077-647d02aaa7fb at term 1 for appendEntries, leader elected after 5034ms
datanode_1_1  | 2020-04-17 18:54:43,815 [grpc-default-executor-1] INFO impl.RaftServerImpl: b23d8fb0-3698-40b4-ac98-17b8605a770b@group-95C80522151F: set configuration 0: [b23d8fb0-3698-40b4-ac98-17b8605a770b:10.5.0.4:9858, a0acbcec-d753-414c-b077-647d02aaa7fb:10.5.0.7:9858, 0e99e1b0-220f-42bd-a39f-d4658f80d0e4:10.5.0.5:9858], old=null at 0
datanode_1_1  | 2020-04-17 18:54:43,819 [grpc-default-executor-1] INFO segmented.SegmentedRaftLogWorker: b23d8fb0-3698-40b4-ac98-17b8605a770b@group-95C80522151F-SegmentedRaftLogWorker: Starting segment from index:0
datanode_1_1  | 2020-04-17 18:54:43,821 [b23d8fb0-3698-40b4-ac98-17b8605a770b@group-95C80522151F-SegmentedRaftLogWorker] INFO segmented.SegmentedRaftLogWorker: b23d8fb0-3698-40b4-ac98-17b8605a770b@group-95C80522151F-SegmentedRaftLogWorker: created new log segment /data/metadata/ratis/b5a22a8d-2392-4c7a-923f-95c80522151f/current/log_inprogress_0
datanode_1_1  | 2020-04-17 18:55:40,937 [ChunkWriter-25-0] INFO keyvalue.KeyValueHandler: Operation: CreateContainer , Trace ID: 9f59c7868aa8c134:53a78add67987187:9f59c7868aa8c134:0 , Message: Container creation failed, due to disk out of space , Result: DISK_OUT_OF_SPACE , StorageContainerException Occurred.
datanode_1_1  | org.apache.hadoop.hdds.scm.container.common.helpers.StorageContainerException: Container creation failed, due to disk out of space
datanode_1_1  | 	at org.apache.hadoop.ozone.container.keyvalue.KeyValueContainer.create(KeyValueContainer.java:165)
datanode_1_1  | 	at org.apache.hadoop.ozone.container.keyvalue.KeyValueHandler.handleCreateContainer(KeyValueHandler.java:247)
datanode_1_1  | 	at org.apache.hadoop.ozone.container.keyvalue.KeyValueHandler.dispatchRequest(KeyValueHandler.java:164)
datanode_1_1  | 	at org.apache.hadoop.ozone.container.keyvalue.KeyValueHandler.handle(KeyValueHandler.java:152)
datanode_1_1  | 	at org.apache.hadoop.ozone.container.common.impl.HddsDispatcher.createContainer(HddsDispatcher.java:414)
datanode_1_1  | 	at org.apache.hadoop.ozone.container.common.impl.HddsDispatcher.dispatchRequest(HddsDispatcher.java:250)
datanode_1_1  | 	at org.apache.hadoop.ozone.container.common.impl.HddsDispatcher.dispatch(HddsDispatcher.java:162)
datanode_1_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.ContainerStateMachine.dispatchCommand(ContainerStateMachine.java:402)
datanode_1_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.ContainerStateMachine.runCommand(ContainerStateMachine.java:412)
datanode_1_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.ContainerStateMachine.lambda$handleWriteChunk$2(ContainerStateMachine.java:447)
datanode_3_1  | 2020-04-17 18:50:36,806 [Datanode State Machine Thread - 0] INFO ratis.XceiverServerRatis: Starting XceiverServerRatis 32863f73-3555-4b23-932a-0d28eb668aea at port 9858
datanode_3_1  | 2020-04-17 18:50:36,972 [Datanode State Machine Thread - 0] INFO impl.RaftServerProxy: 32863f73-3555-4b23-932a-0d28eb668aea: start RPC server
datanode_3_1  | 2020-04-17 18:50:37,434 [Datanode State Machine Thread - 0] INFO server.GrpcService: 32863f73-3555-4b23-932a-0d28eb668aea: GrpcService started, listening on 0.0.0.0/0.0.0.0:9858
datanode_3_1  | 2020-04-17 18:50:41,063 [Command processor thread] INFO impl.RaftServerProxy: 32863f73-3555-4b23-932a-0d28eb668aea: addNew group-CC09C422F088:[32863f73-3555-4b23-932a-0d28eb668aea:10.5.0.6:9858] returns group-CC09C422F088:java.util.concurrent.CompletableFuture@24351f99[Not completed]
datanode_3_1  | 2020-04-17 18:50:41,184 [pool-69-thread-1] INFO impl.RaftServerImpl: 32863f73-3555-4b23-932a-0d28eb668aea: new RaftServerImpl for group-CC09C422F088:[32863f73-3555-4b23-932a-0d28eb668aea:10.5.0.6:9858] with ContainerStateMachine:uninitialized
datanode_3_1  | 2020-04-17 18:50:41,199 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.rpc.timeout.min = 5s (custom)
datanode_3_1  | 2020-04-17 18:50:41,199 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.rpc.timeout.max = 5200ms (custom)
datanode_3_1  | 2020-04-17 18:50:41,199 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.rpcslowness.timeout = 300s (custom)
datanode_3_1  | 2020-04-17 18:50:41,200 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.sleep.deviation.threshold = 300 (default)
datanode_3_1  | 2020-04-17 18:50:41,200 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.appender.install.snapshot.enabled = false (custom)
datanode_3_1  | 2020-04-17 18:50:41,221 [pool-69-thread-1] INFO impl.RaftServerImpl: 32863f73-3555-4b23-932a-0d28eb668aea@group-CC09C422F088: ConfigurationManager, init=-1: [32863f73-3555-4b23-932a-0d28eb668aea:10.5.0.6:9858], old=null, confs=<EMPTY_MAP>
datanode_3_1  | 2020-04-17 18:50:41,221 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.storage.dir = [/data/metadata/ratis] (custom)
datanode_3_1  | 2020-04-17 18:50:41,240 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.corruption.policy = EXCEPTION (default)
datanode_3_1  | 2020-04-17 18:50:41,241 [pool-69-thread-1] INFO storage.RaftStorageDirectory: The storage directory /data/metadata/ratis/78615a2e-50d8-4031-9b8b-cc09c422f088 does not exist. Creating ...
datanode_3_1  | 2020-04-17 18:50:41,279 [pool-69-thread-1] INFO storage.RaftStorageDirectory: Lock on /data/metadata/ratis/78615a2e-50d8-4031-9b8b-cc09c422f088/in_use.lock acquired by nodename 7@758abb5d524f
datanode_3_1  | 2020-04-17 18:50:41,284 [pool-69-thread-1] INFO storage.RaftStorage: Storage directory /data/metadata/ratis/78615a2e-50d8-4031-9b8b-cc09c422f088 has been successfully formatted.
datanode_3_1  | 2020-04-17 18:50:41,302 [pool-69-thread-1] INFO ratis.ContainerStateMachine: group-CC09C422F088: The snapshot info is null. Setting the last applied indexto:(t:0, i:~)
datanode_3_1  | 2020-04-17 18:50:41,305 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.notification.no-leader.timeout = 60s (default)
datanode_3_1  | 2020-04-17 18:50:41,324 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.use.memory = false (default)
datanode_3_1  | 2020-04-17 18:50:41,348 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.purge.gap = 1000000 (custom)
datanode_3_1  | 2020-04-17 18:50:41,348 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
datanode_3_1  | 2020-04-17 18:50:41,350 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.segment.size.max = 1048576 (custom)
datanode_3_1  | 2020-04-17 18:50:41,377 [pool-69-thread-1] INFO metrics.RatisMetrics: Creating Metrics Registry : ratis.log_worker.32863f73-3555-4b23-932a-0d28eb668aea
datanode_3_1  | 2020-04-17 18:50:41,469 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.segment.cache.num.max = 2 (custom)
datanode_3_1  | 2020-04-17 18:50:41,524 [pool-69-thread-1] INFO segmented.SegmentedRaftLogWorker: new 32863f73-3555-4b23-932a-0d28eb668aea@group-CC09C422F088-SegmentedRaftLogWorker for RaftStorage:Storage Directory /data/metadata/ratis/78615a2e-50d8-4031-9b8b-cc09c422f088
datanode_3_1  | 2020-04-17 18:50:41,525 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.queue.byte-limit = 2147483647 (custom)
datanode_3_1  | 2020-04-17 18:50:41,525 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.queue.element-limit = 1024 (custom)
datanode_3_1  | 2020-04-17 18:50:41,526 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.segment.size.max = 1048576 (custom)
datanode_3_1  | 2020-04-17 18:50:41,526 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.preallocated.size = 16384 (custom)
datanode_3_1  | 2020-04-17 18:50:41,563 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.write.buffer.size = 1048576 (custom)
datanode_3_1  | 2020-04-17 18:50:41,563 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.force.sync.num = 128 (default)
datanode_3_1  | 2020-04-17 18:50:41,582 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.statemachine.data.sync = true (default)
datanode_3_1  | 2020-04-17 18:50:41,582 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.statemachine.data.sync.timeout = 10s (default)
datanode_3_1  | 2020-04-17 18:50:41,582 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
datanode_3_1  | 2020-04-17 18:50:41,662 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.statemachine.data.caching.enabled = true (custom)
datanode_3_1  | 2020-04-17 18:50:41,698 [pool-69-thread-1] INFO segmented.SegmentedRaftLogWorker: 32863f73-3555-4b23-932a-0d28eb668aea@group-CC09C422F088-SegmentedRaftLogWorker: flushIndex: setUnconditionally 0 -> -1
datanode_3_1  | 2020-04-17 18:50:41,709 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.snapshot.auto.trigger.enabled = true (custom)
datanode_3_1  | 2020-04-17 18:50:41,736 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
datanode_3_1  | 2020-04-17 18:50:41,739 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.snapshot.retention.file.num = 5 (custom)
datanode_3_1  | 2020-04-17 18:50:41,740 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.retrycache.expirytime = 600000ms (custom)
datanode_3_1  | 2020-04-17 18:50:41,839 [pool-69-thread-1] INFO metrics.RatisMetrics: Creating Metrics Registry : ratis.leader_election.32863f73-3555-4b23-932a-0d28eb668aea@group-CC09C422F088
datanode_3_1  | 2020-04-17 18:50:41,842 [pool-69-thread-1] INFO metrics.RatisMetrics: Creating Metrics Registry : ratis.server.32863f73-3555-4b23-932a-0d28eb668aea@group-CC09C422F088
datanode_3_1  | 2020-04-17 18:50:41,854 [pool-69-thread-1] INFO impl.RaftServerImpl: 32863f73-3555-4b23-932a-0d28eb668aea@group-CC09C422F088: start as a follower, conf=-1: [32863f73-3555-4b23-932a-0d28eb668aea:10.5.0.6:9858], old=null
datanode_3_1  | 2020-04-17 18:50:41,855 [pool-69-thread-1] INFO impl.RaftServerImpl: 32863f73-3555-4b23-932a-0d28eb668aea@group-CC09C422F088: changes role from      null to FOLLOWER at term 0 for startAsFollower
datanode_3_1  | 2020-04-17 18:50:41,863 [pool-69-thread-1] INFO impl.RoleInfo: 32863f73-3555-4b23-932a-0d28eb668aea: start FollowerState
datanode_3_1  | 2020-04-17 18:50:41,876 [pool-69-thread-1] INFO util.JmxRegister: Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-CC09C422F088,id=32863f73-3555-4b23-932a-0d28eb668aea
datanode_3_1  | 2020-04-17 18:50:41,879 [pool-69-thread-1] INFO metrics.RatisMetrics: Creating Metrics Registry : ratis.state_machine.32863f73-3555-4b23-932a-0d28eb668aea@group-CC09C422F088
datanode_3_1  | 2020-04-17 18:50:41,928 [Command processor thread] INFO commandhandler.CreatePipelineCommandHandler: Created Pipeline RATIS ONE #id: "78615a2e-50d8-4031-9b8b-cc09c422f088"
datanode_3_1  | .
datanode_2_1  | java.io.IOException: 0e99e1b0-220f-42bd-a39f-d4658f80d0e4: Group group-385EF22ED913 not found.
datanode_2_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.XceiverServerRatis.removeGroup(XceiverServerRatis.java:659)
datanode_2_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.ClosePipelineCommandHandler.handle(ClosePipelineCommandHandler.java:77)
datanode_2_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.CommandDispatcher.handle(CommandDispatcher.java:99)
datanode_2_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.lambda$initCommandHandlerThread$1(DatanodeStateMachine.java:472)
datanode_2_1  | 	at java.base/java.lang.Thread.run(Thread.java:834)
datanode_2_1  | Caused by: org.apache.ratis.protocol.GroupMismatchException: 0e99e1b0-220f-42bd-a39f-d4658f80d0e4: Group group-385EF22ED913 not found.
datanode_2_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupRemoveAsync(RaftServerProxy.java:404)
datanode_2_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupManagementAsync(RaftServerProxy.java:367)
datanode_2_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupManagement(RaftServerProxy.java:350)
datanode_2_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.XceiverServerRatis.removeGroup(XceiverServerRatis.java:657)
datanode_2_1  | 	... 4 more
datanode_2_1  | 2020-04-17 18:52:30,140 [Command processor thread] INFO impl.RaftServerProxy: 0e99e1b0-220f-42bd-a39f-d4658f80d0e4: remove group-385EF22ED913:null
datanode_2_1  | 2020-04-17 18:52:30,140 [Command processor thread] ERROR commandhandler.ClosePipelineCommandHandler: Can't close pipeline #id: "be26d0dd-802f-4608-9a1c-385ef22ed913"
datanode_2_1  | 
datanode_2_1  | java.io.IOException: 0e99e1b0-220f-42bd-a39f-d4658f80d0e4: Group group-385EF22ED913 not found.
datanode_2_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.XceiverServerRatis.removeGroup(XceiverServerRatis.java:659)
datanode_2_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.ClosePipelineCommandHandler.handle(ClosePipelineCommandHandler.java:77)
datanode_2_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.CommandDispatcher.handle(CommandDispatcher.java:99)
datanode_2_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.lambda$initCommandHandlerThread$1(DatanodeStateMachine.java:472)
datanode_2_1  | 	at java.base/java.lang.Thread.run(Thread.java:834)
datanode_2_1  | Caused by: org.apache.ratis.protocol.GroupMismatchException: 0e99e1b0-220f-42bd-a39f-d4658f80d0e4: Group group-385EF22ED913 not found.
datanode_2_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupRemoveAsync(RaftServerProxy.java:404)
datanode_2_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupManagementAsync(RaftServerProxy.java:367)
datanode_2_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupManagement(RaftServerProxy.java:350)
datanode_2_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.XceiverServerRatis.removeGroup(XceiverServerRatis.java:657)
datanode_2_1  | 	... 4 more
datanode_2_1  | 2020-04-17 18:52:30,141 [Command processor thread] INFO impl.RaftServerProxy: 0e99e1b0-220f-42bd-a39f-d4658f80d0e4: remove group-385EF22ED913:null
datanode_2_1  | 2020-04-17 18:52:30,141 [Command processor thread] ERROR commandhandler.ClosePipelineCommandHandler: Can't close pipeline #id: "be26d0dd-802f-4608-9a1c-385ef22ed913"
datanode_2_1  | 
datanode_2_1  | java.io.IOException: 0e99e1b0-220f-42bd-a39f-d4658f80d0e4: Group group-385EF22ED913 not found.
datanode_2_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.XceiverServerRatis.removeGroup(XceiverServerRatis.java:659)
datanode_2_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.ClosePipelineCommandHandler.handle(ClosePipelineCommandHandler.java:77)
datanode_2_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.CommandDispatcher.handle(CommandDispatcher.java:99)
datanode_2_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.lambda$initCommandHandlerThread$1(DatanodeStateMachine.java:472)
datanode_2_1  | 	at java.base/java.lang.Thread.run(Thread.java:834)
datanode_2_1  | Caused by: org.apache.ratis.protocol.GroupMismatchException: 0e99e1b0-220f-42bd-a39f-d4658f80d0e4: Group group-385EF22ED913 not found.
datanode_2_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupRemoveAsync(RaftServerProxy.java:404)
datanode_2_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupManagementAsync(RaftServerProxy.java:367)
datanode_2_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupManagement(RaftServerProxy.java:350)
datanode_2_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.XceiverServerRatis.removeGroup(XceiverServerRatis.java:657)
datanode_2_1  | 	... 4 more
datanode_2_1  | 2020-04-17 18:52:30,141 [Command processor thread] INFO impl.RaftServerProxy: 0e99e1b0-220f-42bd-a39f-d4658f80d0e4: remove group-385EF22ED913:null
datanode_2_1  | 2020-04-17 18:52:30,141 [Command processor thread] ERROR commandhandler.ClosePipelineCommandHandler: Can't close pipeline #id: "be26d0dd-802f-4608-9a1c-385ef22ed913"
datanode_2_1  | 
datanode_2_1  | java.io.IOException: 0e99e1b0-220f-42bd-a39f-d4658f80d0e4: Group group-385EF22ED913 not found.
datanode_2_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.XceiverServerRatis.removeGroup(XceiverServerRatis.java:659)
datanode_2_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.ClosePipelineCommandHandler.handle(ClosePipelineCommandHandler.java:77)
datanode_2_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.CommandDispatcher.handle(CommandDispatcher.java:99)
datanode_2_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.lambda$initCommandHandlerThread$1(DatanodeStateMachine.java:472)
datanode_2_1  | 	at java.base/java.lang.Thread.run(Thread.java:834)
datanode_2_1  | Caused by: org.apache.ratis.protocol.GroupMismatchException: 0e99e1b0-220f-42bd-a39f-d4658f80d0e4: Group group-385EF22ED913 not found.
datanode_2_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupRemoveAsync(RaftServerProxy.java:404)
datanode_2_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupManagementAsync(RaftServerProxy.java:367)
datanode_2_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupManagement(RaftServerProxy.java:350)
datanode_2_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.XceiverServerRatis.removeGroup(XceiverServerRatis.java:657)
datanode_2_1  | 	... 4 more
datanode_2_1  | 2020-04-17 18:52:30,142 [Command processor thread] INFO impl.RaftServerProxy: 0e99e1b0-220f-42bd-a39f-d4658f80d0e4: remove group-385EF22ED913:null
datanode_2_1  | 2020-04-17 18:52:30,142 [Command processor thread] ERROR commandhandler.ClosePipelineCommandHandler: Can't close pipeline #id: "be26d0dd-802f-4608-9a1c-385ef22ed913"
datanode_2_1  | 
datanode_2_1  | java.io.IOException: 0e99e1b0-220f-42bd-a39f-d4658f80d0e4: Group group-385EF22ED913 not found.
datanode_2_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.XceiverServerRatis.removeGroup(XceiverServerRatis.java:659)
datanode_2_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.ClosePipelineCommandHandler.handle(ClosePipelineCommandHandler.java:77)
datanode_2_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.CommandDispatcher.handle(CommandDispatcher.java:99)
datanode_2_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.lambda$initCommandHandlerThread$1(DatanodeStateMachine.java:472)
datanode_2_1  | 	at java.base/java.lang.Thread.run(Thread.java:834)
datanode_2_1  | Caused by: org.apache.ratis.protocol.GroupMismatchException: 0e99e1b0-220f-42bd-a39f-d4658f80d0e4: Group group-385EF22ED913 not found.
datanode_2_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupRemoveAsync(RaftServerProxy.java:404)
datanode_3_1  | 2020-04-17 18:50:41,928 [Command processor thread] INFO impl.RaftServerProxy: 32863f73-3555-4b23-932a-0d28eb668aea: addNew group-F5BD6C5F0281:[b23d8fb0-3698-40b4-ac98-17b8605a770b:10.5.0.4:9858, 32863f73-3555-4b23-932a-0d28eb668aea:10.5.0.6:9858, 79669a1f-2445-496e-a337-3115205f3ae5:10.5.0.9:9858] returns group-F5BD6C5F0281:java.util.concurrent.CompletableFuture@395029df[Not completed]
datanode_3_1  | 2020-04-17 18:50:41,930 [pool-69-thread-1] INFO impl.RaftServerImpl: 32863f73-3555-4b23-932a-0d28eb668aea: new RaftServerImpl for group-F5BD6C5F0281:[b23d8fb0-3698-40b4-ac98-17b8605a770b:10.5.0.4:9858, 32863f73-3555-4b23-932a-0d28eb668aea:10.5.0.6:9858, 79669a1f-2445-496e-a337-3115205f3ae5:10.5.0.9:9858] with ContainerStateMachine:uninitialized
datanode_3_1  | 2020-04-17 18:50:41,941 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.rpc.timeout.min = 5s (custom)
datanode_3_1  | 2020-04-17 18:50:41,941 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.rpc.timeout.max = 5200ms (custom)
datanode_3_1  | 2020-04-17 18:50:41,942 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.rpcslowness.timeout = 300s (custom)
datanode_3_1  | 2020-04-17 18:50:41,942 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.sleep.deviation.threshold = 300 (default)
datanode_3_1  | 2020-04-17 18:50:41,942 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.appender.install.snapshot.enabled = false (custom)
datanode_3_1  | 2020-04-17 18:50:41,942 [pool-69-thread-1] INFO impl.RaftServerImpl: 32863f73-3555-4b23-932a-0d28eb668aea@group-F5BD6C5F0281: ConfigurationManager, init=-1: [b23d8fb0-3698-40b4-ac98-17b8605a770b:10.5.0.4:9858, 32863f73-3555-4b23-932a-0d28eb668aea:10.5.0.6:9858, 79669a1f-2445-496e-a337-3115205f3ae5:10.5.0.9:9858], old=null, confs=<EMPTY_MAP>
datanode_3_1  | 2020-04-17 18:50:41,942 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.storage.dir = [/data/metadata/ratis] (custom)
datanode_3_1  | 2020-04-17 18:50:41,956 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.corruption.policy = EXCEPTION (default)
datanode_3_1  | 2020-04-17 18:50:41,957 [pool-69-thread-1] INFO storage.RaftStorageDirectory: The storage directory /data/metadata/ratis/315eee3a-6983-45b7-a699-f5bd6c5f0281 does not exist. Creating ...
datanode_3_1  | 2020-04-17 18:50:41,967 [pool-69-thread-1] INFO storage.RaftStorageDirectory: Lock on /data/metadata/ratis/315eee3a-6983-45b7-a699-f5bd6c5f0281/in_use.lock acquired by nodename 7@758abb5d524f
datanode_3_1  | 2020-04-17 18:50:41,983 [pool-69-thread-1] INFO storage.RaftStorage: Storage directory /data/metadata/ratis/315eee3a-6983-45b7-a699-f5bd6c5f0281 has been successfully formatted.
datanode_3_1  | 2020-04-17 18:50:41,984 [pool-69-thread-1] INFO ratis.ContainerStateMachine: group-F5BD6C5F0281: The snapshot info is null. Setting the last applied indexto:(t:0, i:~)
datanode_3_1  | 2020-04-17 18:50:41,985 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.notification.no-leader.timeout = 60s (default)
datanode_3_1  | 2020-04-17 18:50:41,986 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.use.memory = false (default)
datanode_3_1  | 2020-04-17 18:50:42,000 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.purge.gap = 1000000 (custom)
datanode_3_1  | 2020-04-17 18:50:42,001 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
datanode_3_1  | 2020-04-17 18:50:42,001 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.segment.size.max = 1048576 (custom)
datanode_3_1  | 2020-04-17 18:50:42,001 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.segment.cache.num.max = 2 (custom)
datanode_3_1  | 2020-04-17 18:50:42,001 [pool-69-thread-1] INFO segmented.SegmentedRaftLogWorker: new 32863f73-3555-4b23-932a-0d28eb668aea@group-F5BD6C5F0281-SegmentedRaftLogWorker for RaftStorage:Storage Directory /data/metadata/ratis/315eee3a-6983-45b7-a699-f5bd6c5f0281
datanode_3_1  | 2020-04-17 18:50:42,001 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.queue.byte-limit = 2147483647 (custom)
datanode_3_1  | 2020-04-17 18:50:42,002 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.queue.element-limit = 1024 (custom)
datanode_3_1  | 2020-04-17 18:50:42,002 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.segment.size.max = 1048576 (custom)
datanode_3_1  | 2020-04-17 18:50:42,002 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.preallocated.size = 16384 (custom)
datanode_3_1  | 2020-04-17 18:50:42,002 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.write.buffer.size = 1048576 (custom)
datanode_3_1  | 2020-04-17 18:50:42,002 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.force.sync.num = 128 (default)
datanode_3_1  | 2020-04-17 18:50:42,005 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.statemachine.data.sync = true (default)
datanode_3_1  | 2020-04-17 18:50:42,006 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.statemachine.data.sync.timeout = 10s (default)
datanode_3_1  | 2020-04-17 18:50:42,010 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
datanode_3_1  | 2020-04-17 18:50:42,011 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.statemachine.data.caching.enabled = true (custom)
datanode_3_1  | 2020-04-17 18:50:42,014 [pool-69-thread-1] INFO segmented.SegmentedRaftLogWorker: 32863f73-3555-4b23-932a-0d28eb668aea@group-F5BD6C5F0281-SegmentedRaftLogWorker: flushIndex: setUnconditionally 0 -> -1
datanode_3_1  | 2020-04-17 18:50:42,025 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.snapshot.auto.trigger.enabled = true (custom)
datanode_3_1  | 2020-04-17 18:50:42,026 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
datanode_3_1  | 2020-04-17 18:50:42,029 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.snapshot.retention.file.num = 5 (custom)
datanode_3_1  | 2020-04-17 18:50:42,030 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.retrycache.expirytime = 600000ms (custom)
datanode_3_1  | 2020-04-17 18:50:42,032 [pool-69-thread-1] INFO metrics.RatisMetrics: Creating Metrics Registry : ratis.leader_election.32863f73-3555-4b23-932a-0d28eb668aea@group-F5BD6C5F0281
datanode_3_1  | 2020-04-17 18:50:42,034 [pool-69-thread-1] INFO metrics.RatisMetrics: Creating Metrics Registry : ratis.server.32863f73-3555-4b23-932a-0d28eb668aea@group-F5BD6C5F0281
datanode_3_1  | 2020-04-17 18:50:42,045 [pool-69-thread-1] INFO impl.RaftServerImpl: 32863f73-3555-4b23-932a-0d28eb668aea@group-F5BD6C5F0281: start as a follower, conf=-1: [b23d8fb0-3698-40b4-ac98-17b8605a770b:10.5.0.4:9858, 32863f73-3555-4b23-932a-0d28eb668aea:10.5.0.6:9858, 79669a1f-2445-496e-a337-3115205f3ae5:10.5.0.9:9858], old=null
datanode_3_1  | 2020-04-17 18:50:42,052 [pool-69-thread-1] INFO impl.RaftServerImpl: 32863f73-3555-4b23-932a-0d28eb668aea@group-F5BD6C5F0281: changes role from      null to FOLLOWER at term 0 for startAsFollower
datanode_3_1  | 2020-04-17 18:50:42,052 [pool-69-thread-1] INFO impl.RoleInfo: 32863f73-3555-4b23-932a-0d28eb668aea: start FollowerState
datanode_3_1  | 2020-04-17 18:50:42,054 [pool-69-thread-1] INFO util.JmxRegister: Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-F5BD6C5F0281,id=32863f73-3555-4b23-932a-0d28eb668aea
datanode_3_1  | 2020-04-17 18:50:42,061 [pool-69-thread-1] INFO metrics.RatisMetrics: Creating Metrics Registry : ratis.state_machine.32863f73-3555-4b23-932a-0d28eb668aea@group-F5BD6C5F0281
datanode_3_1  | 2020-04-17 18:50:46,202 [Command processor thread] INFO commandhandler.CreatePipelineCommandHandler: Created Pipeline RATIS THREE #id: "315eee3a-6983-45b7-a699-f5bd6c5f0281"
datanode_3_1  | .
datanode_2_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupManagementAsync(RaftServerProxy.java:367)
datanode_2_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupManagement(RaftServerProxy.java:350)
datanode_2_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.XceiverServerRatis.removeGroup(XceiverServerRatis.java:657)
datanode_2_1  | 	... 4 more
datanode_2_1  | 2020-04-17 18:52:30,142 [Command processor thread] INFO impl.RaftServerProxy: 0e99e1b0-220f-42bd-a39f-d4658f80d0e4: remove group-385EF22ED913:null
datanode_2_1  | 2020-04-17 18:52:30,143 [Command processor thread] ERROR commandhandler.ClosePipelineCommandHandler: Can't close pipeline #id: "be26d0dd-802f-4608-9a1c-385ef22ed913"
datanode_2_1  | 
datanode_2_1  | java.io.IOException: 0e99e1b0-220f-42bd-a39f-d4658f80d0e4: Group group-385EF22ED913 not found.
datanode_2_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.XceiverServerRatis.removeGroup(XceiverServerRatis.java:659)
datanode_2_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.ClosePipelineCommandHandler.handle(ClosePipelineCommandHandler.java:77)
datanode_2_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.CommandDispatcher.handle(CommandDispatcher.java:99)
datanode_2_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.lambda$initCommandHandlerThread$1(DatanodeStateMachine.java:472)
datanode_2_1  | 	at java.base/java.lang.Thread.run(Thread.java:834)
datanode_2_1  | Caused by: org.apache.ratis.protocol.GroupMismatchException: 0e99e1b0-220f-42bd-a39f-d4658f80d0e4: Group group-385EF22ED913 not found.
datanode_2_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupRemoveAsync(RaftServerProxy.java:404)
datanode_2_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupManagementAsync(RaftServerProxy.java:367)
datanode_2_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupManagement(RaftServerProxy.java:350)
datanode_2_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.XceiverServerRatis.removeGroup(XceiverServerRatis.java:657)
datanode_2_1  | 	... 4 more
datanode_2_1  | 2020-04-17 18:52:35,115 [grpc-default-executor-0] INFO impl.RaftServerImpl: 0e99e1b0-220f-42bd-a39f-d4658f80d0e4@group-79E0035D853A: changes role from  FOLLOWER to FOLLOWER at term 1 for recognizeCandidate:978c057e-5c38-4e20-8a8b-f271c823af7e
datanode_2_1  | 2020-04-17 18:52:35,115 [grpc-default-executor-0] INFO impl.RoleInfo: 0e99e1b0-220f-42bd-a39f-d4658f80d0e4: shutdown FollowerState
datanode_2_1  | 2020-04-17 18:52:35,115 [grpc-default-executor-0] INFO impl.RoleInfo: 0e99e1b0-220f-42bd-a39f-d4658f80d0e4: start FollowerState
datanode_2_1  | 2020-04-17 18:52:35,115 [Thread-81] INFO impl.FollowerState: 0e99e1b0-220f-42bd-a39f-d4658f80d0e4@group-79E0035D853A-FollowerState was interrupted: java.lang.InterruptedException: sleep interrupted
datanode_2_1  | 2020-04-17 18:52:35,187 [grpc-default-executor-0] INFO ratis.XceiverServerRatis: Leader change notification received for group: group-79E0035D853A with new leaderId: 978c057e-5c38-4e20-8a8b-f271c823af7e
datanode_2_1  | 2020-04-17 18:52:35,187 [grpc-default-executor-0] INFO impl.RaftServerImpl: 0e99e1b0-220f-42bd-a39f-d4658f80d0e4@group-79E0035D853A: change Leader from null to 978c057e-5c38-4e20-8a8b-f271c823af7e at term 1 for appendEntries, leader elected after 5116ms
datanode_2_1  | 2020-04-17 18:52:35,222 [grpc-default-executor-0] INFO impl.RaftServerImpl: 0e99e1b0-220f-42bd-a39f-d4658f80d0e4@group-79E0035D853A: set configuration 0: [978c057e-5c38-4e20-8a8b-f271c823af7e:10.5.0.8:9858, a0acbcec-d753-414c-b077-647d02aaa7fb:10.5.0.7:9858, 0e99e1b0-220f-42bd-a39f-d4658f80d0e4:10.5.0.5:9858], old=null at 0
datanode_2_1  | 2020-04-17 18:52:35,227 [grpc-default-executor-0] INFO segmented.SegmentedRaftLogWorker: 0e99e1b0-220f-42bd-a39f-d4658f80d0e4@group-79E0035D853A-SegmentedRaftLogWorker: Starting segment from index:0
datanode_2_1  | 2020-04-17 18:52:35,230 [0e99e1b0-220f-42bd-a39f-d4658f80d0e4@group-79E0035D853A-SegmentedRaftLogWorker] INFO segmented.SegmentedRaftLogWorker: 0e99e1b0-220f-42bd-a39f-d4658f80d0e4@group-79E0035D853A-SegmentedRaftLogWorker: created new log segment /data/metadata/ratis/cad403d1-ea2f-4530-84e5-79e0035d853a/current/log_inprogress_0
datanode_2_1  | 2020-04-17 18:52:37,638 [ChunkWriter-40-0] INFO keyvalue.KeyValueHandler: Operation: CreateContainer , Trace ID: dbf2e28874f8e582:fd88223a75928210:dbf2e28874f8e582:0 , Message: Container creation failed, due to disk out of space , Result: DISK_OUT_OF_SPACE , StorageContainerException Occurred.
datanode_2_1  | org.apache.hadoop.hdds.scm.container.common.helpers.StorageContainerException: Container creation failed, due to disk out of space
datanode_2_1  | 	at org.apache.hadoop.ozone.container.keyvalue.KeyValueContainer.create(KeyValueContainer.java:165)
datanode_2_1  | 	at org.apache.hadoop.ozone.container.keyvalue.KeyValueHandler.handleCreateContainer(KeyValueHandler.java:247)
datanode_2_1  | 	at org.apache.hadoop.ozone.container.keyvalue.KeyValueHandler.dispatchRequest(KeyValueHandler.java:164)
datanode_2_1  | 	at org.apache.hadoop.ozone.container.keyvalue.KeyValueHandler.handle(KeyValueHandler.java:152)
datanode_2_1  | 	at org.apache.hadoop.ozone.container.common.impl.HddsDispatcher.createContainer(HddsDispatcher.java:414)
datanode_2_1  | 	at org.apache.hadoop.ozone.container.common.impl.HddsDispatcher.dispatchRequest(HddsDispatcher.java:250)
datanode_2_1  | 	at org.apache.hadoop.ozone.container.common.impl.HddsDispatcher.dispatch(HddsDispatcher.java:162)
datanode_2_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.ContainerStateMachine.dispatchCommand(ContainerStateMachine.java:402)
datanode_2_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.ContainerStateMachine.runCommand(ContainerStateMachine.java:412)
datanode_2_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.ContainerStateMachine.lambda$handleWriteChunk$2(ContainerStateMachine.java:447)
datanode_2_1  | 	at java.base/java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1700)
datanode_2_1  | 	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
datanode_2_1  | 	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
datanode_2_1  | 	at java.base/java.lang.Thread.run(Thread.java:834)
datanode_2_1  | Caused by: org.apache.hadoop.util.DiskChecker$DiskOutOfSpaceException: Out of space: The volume with the most available space (=965185536 B) is less than the container size (=1073741824 B).
datanode_2_1  | 	at org.apache.hadoop.ozone.container.common.volume.RoundRobinVolumeChoosingPolicy.chooseVolume(RoundRobinVolumeChoosingPolicy.java:77)
datanode_2_1  | 	at org.apache.hadoop.ozone.container.keyvalue.KeyValueContainer.create(KeyValueContainer.java:124)
datanode_2_1  | 	... 13 more
datanode_2_1  | 2020-04-17 18:52:37,639 [ChunkWriter-40-0] INFO impl.HddsDispatcher: Operation: WriteChunk , Trace ID: dbf2e28874f8e582:fd88223a75928210:dbf2e28874f8e582:0 , Message: ContainerID 3 creation failed , Result: DISK_OUT_OF_SPACE , StorageContainerException Occurred.
datanode_2_1  | org.apache.hadoop.hdds.scm.container.common.helpers.StorageContainerException: ContainerID 3 creation failed
datanode_2_1  | 	at org.apache.hadoop.ozone.container.common.impl.HddsDispatcher.dispatchRequest(HddsDispatcher.java:254)
datanode_2_1  | 	at org.apache.hadoop.ozone.container.common.impl.HddsDispatcher.dispatch(HddsDispatcher.java:162)
datanode_2_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.ContainerStateMachine.dispatchCommand(ContainerStateMachine.java:402)
datanode_2_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.ContainerStateMachine.runCommand(ContainerStateMachine.java:412)
datanode_2_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.ContainerStateMachine.lambda$handleWriteChunk$2(ContainerStateMachine.java:447)
datanode_2_1  | 	at java.base/java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1700)
datanode_2_1  | 	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
datanode_2_1  | 	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
datanode_2_1  | 	at java.base/java.lang.Thread.run(Thread.java:834)
datanode_2_1  | 2020-04-17 18:52:37,640 [ChunkWriter-40-0] ERROR ratis.ContainerStateMachine: group-79E0035D853A: writeChunk writeStateMachineData failed: blockIdcontainerID: 3
datanode_2_1  | localID: 104015433404579858
datanode_2_1  | blockCommitSequenceId: 0
datanode_2_1  |  logIndex 1 chunkName 104015433404579858_chunk_1 Error message: ContainerID 3 creation failed Container Result: DISK_OUT_OF_SPACE
datanode_2_1  | 2020-04-17 18:52:37,640 [0e99e1b0-220f-42bd-a39f-d4658f80d0e4@group-79E0035D853A-SegmentedRaftLogWorker] ERROR ratis.XceiverServerRatis: pipeline Action CLOSE on pipeline PipelineID=cad403d1-ea2f-4530-84e5-79e0035d853a.Reason : ContainerID 3 creation failed
datanode_2_1  | 2020-04-17 18:52:37,652 [0e99e1b0-220f-42bd-a39f-d4658f80d0e4@group-79E0035D853A-SegmentedRaftLogWorker] ERROR ratis.XceiverServerRatis: pipeline Action CLOSE on pipeline PipelineID=cad403d1-ea2f-4530-84e5-79e0035d853a.Reason : Log already failed at index 1 for task WriteLog:1: (t:1, i:1), STATEMACHINELOGENTRY, client-B8993CFB43DC, cid=57
datanode_2_1  | 	 State Machine: cmdType: WriteChunk traceID: "dbf2e28874f8e582:fd88223a75928210:dbf2e28874f8e582:0" containerID: 3 datanodeUuid: "a0acbcec-d753-414c-b077-647d02aaa7fb" pipelineID: "cad403d1-ea2f-4530-84e5-79e0035d853a" writeChunk { blockID { containerID: 3 localID: 104015433404579858 blockCommitSequenceId: 0 } chunkData { chunkName: "104015433404579858_chunk_1" offset: 0 len: 10240 checksumData { type: CRC32 bytesPerChecksum: 1048576 checksums: ">\344\315\231" } } }, container path=nonexistent
datanode_2_1  | 2020-04-17 18:53:01,070 [Command processor thread] INFO impl.RaftServerProxy: 0e99e1b0-220f-42bd-a39f-d4658f80d0e4: remove group-385EF22ED913:null
datanode_2_1  | 2020-04-17 18:53:01,070 [Command processor thread] ERROR commandhandler.ClosePipelineCommandHandler: Can't close pipeline #id: "be26d0dd-802f-4608-9a1c-385ef22ed913"
datanode_2_1  | 
datanode_2_1  | java.io.IOException: 0e99e1b0-220f-42bd-a39f-d4658f80d0e4: Group group-385EF22ED913 not found.
datanode_2_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.XceiverServerRatis.removeGroup(XceiverServerRatis.java:659)
datanode_2_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.ClosePipelineCommandHandler.handle(ClosePipelineCommandHandler.java:77)
datanode_2_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.CommandDispatcher.handle(CommandDispatcher.java:99)
datanode_2_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.lambda$initCommandHandlerThread$1(DatanodeStateMachine.java:472)
datanode_2_1  | 	at java.base/java.lang.Thread.run(Thread.java:834)
datanode_2_1  | Caused by: org.apache.ratis.protocol.GroupMismatchException: 0e99e1b0-220f-42bd-a39f-d4658f80d0e4: Group group-385EF22ED913 not found.
datanode_2_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupRemoveAsync(RaftServerProxy.java:404)
datanode_2_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupManagementAsync(RaftServerProxy.java:367)
datanode_2_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupManagement(RaftServerProxy.java:350)
datanode_2_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.XceiverServerRatis.removeGroup(XceiverServerRatis.java:657)
datanode_2_1  | 	... 4 more
datanode_2_1  | 2020-04-17 18:53:01,071 [Command processor thread] ERROR commandhandler.CloseContainerCommandHandler: Container #3 does not exist in datanode. Container close failed.
datanode_2_1  | 2020-04-17 18:53:58,404 [grpc-default-executor-0] INFO impl.RaftServerProxy: 0e99e1b0-220f-42bd-a39f-d4658f80d0e4: addNew group-CFD51574C841:[978c057e-5c38-4e20-8a8b-f271c823af7e:10.5.0.8:9858, 79669a1f-2445-496e-a337-3115205f3ae5:10.5.0.9:9858, 0e99e1b0-220f-42bd-a39f-d4658f80d0e4:10.5.0.5:9858] returns group-CFD51574C841:java.util.concurrent.CompletableFuture@4591d613[Not completed]
datanode_2_1  | 2020-04-17 18:53:58,406 [pool-69-thread-1] INFO impl.RaftServerImpl: 0e99e1b0-220f-42bd-a39f-d4658f80d0e4: new RaftServerImpl for group-CFD51574C841:[978c057e-5c38-4e20-8a8b-f271c823af7e:10.5.0.8:9858, 79669a1f-2445-496e-a337-3115205f3ae5:10.5.0.9:9858, 0e99e1b0-220f-42bd-a39f-d4658f80d0e4:10.5.0.5:9858] with ContainerStateMachine:uninitialized
datanode_2_1  | 2020-04-17 18:53:58,409 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.rpc.timeout.min = 5s (custom)
datanode_2_1  | 2020-04-17 18:53:58,409 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.rpc.timeout.max = 5200ms (custom)
datanode_2_1  | 2020-04-17 18:53:58,409 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.rpcslowness.timeout = 300s (custom)
datanode_2_1  | 2020-04-17 18:53:58,409 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.sleep.deviation.threshold = 300 (default)
datanode_2_1  | 2020-04-17 18:53:58,409 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.appender.install.snapshot.enabled = false (custom)
datanode_2_1  | 2020-04-17 18:53:58,409 [pool-69-thread-1] INFO impl.RaftServerImpl: 0e99e1b0-220f-42bd-a39f-d4658f80d0e4@group-CFD51574C841: ConfigurationManager, init=-1: [978c057e-5c38-4e20-8a8b-f271c823af7e:10.5.0.8:9858, 79669a1f-2445-496e-a337-3115205f3ae5:10.5.0.9:9858, 0e99e1b0-220f-42bd-a39f-d4658f80d0e4:10.5.0.5:9858], old=null, confs=<EMPTY_MAP>
datanode_2_1  | 2020-04-17 18:53:58,410 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.storage.dir = [/data/metadata/ratis] (custom)
datanode_2_1  | 2020-04-17 18:53:58,410 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.corruption.policy = EXCEPTION (default)
datanode_2_1  | 2020-04-17 18:53:58,410 [pool-69-thread-1] INFO storage.RaftStorageDirectory: The storage directory /data/metadata/ratis/825f4d0e-2629-43e6-a52f-cfd51574c841 does not exist. Creating ...
datanode_2_1  | 2020-04-17 18:53:58,413 [pool-69-thread-1] INFO storage.RaftStorageDirectory: Lock on /data/metadata/ratis/825f4d0e-2629-43e6-a52f-cfd51574c841/in_use.lock acquired by nodename 6@3511460463af
datanode_2_1  | 2020-04-17 18:53:58,415 [pool-69-thread-1] INFO storage.RaftStorage: Storage directory /data/metadata/ratis/825f4d0e-2629-43e6-a52f-cfd51574c841 has been successfully formatted.
datanode_2_1  | 2020-04-17 18:53:58,415 [pool-69-thread-1] INFO ratis.ContainerStateMachine: group-CFD51574C841: The snapshot info is null. Setting the last applied indexto:(t:0, i:~)
datanode_2_1  | 2020-04-17 18:53:58,415 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.notification.no-leader.timeout = 60s (default)
datanode_2_1  | 2020-04-17 18:53:58,416 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.use.memory = false (default)
datanode_2_1  | 2020-04-17 18:53:58,416 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.purge.gap = 1000000 (custom)
datanode_2_1  | 2020-04-17 18:53:58,416 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
datanode_2_1  | 2020-04-17 18:53:58,416 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.segment.size.max = 1048576 (custom)
datanode_2_1  | 2020-04-17 18:53:58,416 [pool-69-thread-1] INFO metrics.RatisMetrics: Creating Metrics Registry : ratis.log_worker.0e99e1b0-220f-42bd-a39f-d4658f80d0e4
datanode_2_1  | 2020-04-17 18:53:58,416 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.segment.cache.num.max = 2 (custom)
datanode_2_1  | 2020-04-17 18:53:58,417 [pool-69-thread-1] INFO segmented.SegmentedRaftLogWorker: new 0e99e1b0-220f-42bd-a39f-d4658f80d0e4@group-CFD51574C841-SegmentedRaftLogWorker for RaftStorage:Storage Directory /data/metadata/ratis/825f4d0e-2629-43e6-a52f-cfd51574c841
datanode_2_1  | 2020-04-17 18:53:58,418 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.queue.byte-limit = 2147483647 (custom)
datanode_2_1  | 2020-04-17 18:53:58,418 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.queue.element-limit = 1024 (custom)
datanode_5_1  | 2020-04-17 18:50:44,192 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.statemachine.data.sync = true (default)
datanode_5_1  | 2020-04-17 18:50:44,192 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.statemachine.data.sync.timeout = 10s (default)
datanode_5_1  | 2020-04-17 18:50:44,192 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
datanode_5_1  | 2020-04-17 18:50:44,193 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.statemachine.data.caching.enabled = true (custom)
datanode_5_1  | 2020-04-17 18:50:44,193 [pool-69-thread-1] INFO segmented.SegmentedRaftLogWorker: 978c057e-5c38-4e20-8a8b-f271c823af7e@group-385EF22ED913-SegmentedRaftLogWorker: flushIndex: setUnconditionally 0 -> -1
datanode_5_1  | 2020-04-17 18:50:44,199 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.snapshot.auto.trigger.enabled = true (custom)
datanode_5_1  | 2020-04-17 18:50:44,203 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
datanode_5_1  | 2020-04-17 18:50:44,203 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.snapshot.retention.file.num = 5 (custom)
datanode_5_1  | 2020-04-17 18:50:44,203 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.retrycache.expirytime = 600000ms (custom)
datanode_5_1  | 2020-04-17 18:50:44,203 [pool-69-thread-1] INFO metrics.RatisMetrics: Creating Metrics Registry : ratis.leader_election.978c057e-5c38-4e20-8a8b-f271c823af7e@group-385EF22ED913
datanode_5_1  | 2020-04-17 18:50:44,204 [pool-69-thread-1] INFO metrics.RatisMetrics: Creating Metrics Registry : ratis.server.978c057e-5c38-4e20-8a8b-f271c823af7e@group-385EF22ED913
datanode_5_1  | 2020-04-17 18:50:44,207 [pool-69-thread-1] INFO impl.RaftServerImpl: 978c057e-5c38-4e20-8a8b-f271c823af7e@group-385EF22ED913: start as a follower, conf=-1: [978c057e-5c38-4e20-8a8b-f271c823af7e:10.5.0.8:9858, a0acbcec-d753-414c-b077-647d02aaa7fb:10.5.0.7:9858, 0e99e1b0-220f-42bd-a39f-d4658f80d0e4:10.5.0.5:9858], old=null
datanode_5_1  | 2020-04-17 18:50:44,209 [pool-69-thread-1] INFO impl.RaftServerImpl: 978c057e-5c38-4e20-8a8b-f271c823af7e@group-385EF22ED913: changes role from      null to FOLLOWER at term 0 for startAsFollower
datanode_5_1  | 2020-04-17 18:50:44,209 [pool-69-thread-1] INFO impl.RoleInfo: 978c057e-5c38-4e20-8a8b-f271c823af7e: start FollowerState
datanode_5_1  | 2020-04-17 18:50:44,247 [pool-69-thread-1] INFO util.JmxRegister: Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-385EF22ED913,id=978c057e-5c38-4e20-8a8b-f271c823af7e
datanode_5_1  | 2020-04-17 18:50:44,247 [pool-69-thread-1] INFO metrics.RatisMetrics: Creating Metrics Registry : ratis.state_machine.978c057e-5c38-4e20-8a8b-f271c823af7e@group-385EF22ED913
datanode_5_1  | 2020-04-17 18:50:46,473 [grpc-default-executor-1] WARN impl.RaftServerProxy: 978c057e-5c38-4e20-8a8b-f271c823af7e: Failed groupAdd* GroupManagementRequest:client-9E5CB14C62CF->978c057e-5c38-4e20-8a8b-f271c823af7e@group-385EF22ED913, cid=1, seq=0, RW, null, Add:group-385EF22ED913:[978c057e-5c38-4e20-8a8b-f271c823af7e:10.5.0.8:9858, a0acbcec-d753-414c-b077-647d02aaa7fb:10.5.0.7:9858, 0e99e1b0-220f-42bd-a39f-d4658f80d0e4:10.5.0.5:9858]
datanode_5_1  | java.util.concurrent.CompletionException: org.apache.ratis.protocol.AlreadyExistsException: 978c057e-5c38-4e20-8a8b-f271c823af7e: Failed to add group-385EF22ED913:[978c057e-5c38-4e20-8a8b-f271c823af7e:10.5.0.8:9858, a0acbcec-d753-414c-b077-647d02aaa7fb:10.5.0.7:9858, 0e99e1b0-220f-42bd-a39f-d4658f80d0e4:10.5.0.5:9858] since the group already exists in the map.
datanode_5_1  | 	at java.base/java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:331)
datanode_5_1  | 	at java.base/java.util.concurrent.CompletableFuture.uniApplyNow(CompletableFuture.java:670)
datanode_5_1  | 	at java.base/java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:658)
datanode_5_1  | 	at java.base/java.util.concurrent.CompletableFuture.thenApplyAsync(CompletableFuture.java:2104)
datanode_5_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupAddAsync(RaftServerProxy.java:379)
datanode_5_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupManagementAsync(RaftServerProxy.java:363)
datanode_5_1  | 	at org.apache.ratis.grpc.server.GrpcAdminProtocolService.lambda$groupManagement$0(GrpcAdminProtocolService.java:42)
datanode_5_1  | 	at org.apache.ratis.grpc.GrpcUtil.asyncCall(GrpcUtil.java:160)
datanode_5_1  | 	at org.apache.ratis.grpc.server.GrpcAdminProtocolService.groupManagement(GrpcAdminProtocolService.java:42)
datanode_5_1  | 	at org.apache.ratis.proto.grpc.AdminProtocolServiceGrpc$MethodHandlers.invoke(AdminProtocolServiceGrpc.java:358)
datanode_5_1  | 	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$UnaryServerCallHandler$UnaryServerCallListener.onHalfClose(ServerCalls.java:172)
datanode_5_1  | 	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.halfClosed(ServerCallImpl.java:331)
datanode_1_1  | 	at java.base/java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1700)
datanode_1_1  | 	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
datanode_1_1  | 	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
datanode_1_1  | 	at java.base/java.lang.Thread.run(Thread.java:834)
datanode_1_1  | Caused by: org.apache.hadoop.util.DiskChecker$DiskOutOfSpaceException: Out of space: The volume with the most available space (=0 B) is less than the container size (=1073741824 B).
datanode_1_1  | 	at org.apache.hadoop.ozone.container.common.volume.RoundRobinVolumeChoosingPolicy.chooseVolume(RoundRobinVolumeChoosingPolicy.java:77)
datanode_1_1  | 	at org.apache.hadoop.ozone.container.keyvalue.KeyValueContainer.create(KeyValueContainer.java:124)
datanode_1_1  | 	... 13 more
datanode_1_1  | 2020-04-17 18:55:40,940 [ChunkWriter-25-0] INFO impl.HddsDispatcher: Operation: WriteChunk , Trace ID: 9f59c7868aa8c134:53a78add67987187:9f59c7868aa8c134:0 , Message: ContainerID 5 creation failed , Result: DISK_OUT_OF_SPACE , StorageContainerException Occurred.
datanode_1_1  | org.apache.hadoop.hdds.scm.container.common.helpers.StorageContainerException: ContainerID 5 creation failed
datanode_1_1  | 	at org.apache.hadoop.ozone.container.common.impl.HddsDispatcher.dispatchRequest(HddsDispatcher.java:254)
datanode_1_1  | 	at org.apache.hadoop.ozone.container.common.impl.HddsDispatcher.dispatch(HddsDispatcher.java:162)
datanode_1_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.ContainerStateMachine.dispatchCommand(ContainerStateMachine.java:402)
datanode_1_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.ContainerStateMachine.runCommand(ContainerStateMachine.java:412)
datanode_1_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.ContainerStateMachine.lambda$handleWriteChunk$2(ContainerStateMachine.java:447)
datanode_1_1  | 	at java.base/java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1700)
datanode_1_1  | 	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
datanode_1_1  | 	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
datanode_1_1  | 	at java.base/java.lang.Thread.run(Thread.java:834)
datanode_1_1  | 2020-04-17 18:55:40,970 [ChunkWriter-25-0] ERROR ratis.ContainerStateMachine: group-95C80522151F: writeChunk writeStateMachineData failed: blockIdcontainerID: 5
datanode_1_1  | localID: 104015445419098136
datanode_1_1  | blockCommitSequenceId: 0
datanode_1_1  |  logIndex 1 chunkName 104015445419098136_chunk_1 Error message: ContainerID 5 creation failed Container Result: DISK_OUT_OF_SPACE
datanode_1_1  | 2020-04-17 18:55:40,978 [b23d8fb0-3698-40b4-ac98-17b8605a770b@group-95C80522151F-SegmentedRaftLogWorker] ERROR ratis.XceiverServerRatis: pipeline Action CLOSE on pipeline PipelineID=b5a22a8d-2392-4c7a-923f-95c80522151f.Reason : ContainerID 5 creation failed
datanode_1_1  | 2020-04-17 18:55:41,038 [b23d8fb0-3698-40b4-ac98-17b8605a770b@group-95C80522151F-SegmentedRaftLogWorker] ERROR ratis.XceiverServerRatis: pipeline Action CLOSE on pipeline PipelineID=b5a22a8d-2392-4c7a-923f-95c80522151f.Reason : Log already failed at index 1 for task WriteLog:1: (t:1, i:1), STATEMACHINELOGENTRY, client-B5B53B577AA5, cid=77
datanode_1_1  | 	 State Machine: cmdType: WriteChunk traceID: "9f59c7868aa8c134:53a78add67987187:9f59c7868aa8c134:0" containerID: 5 datanodeUuid: "0e99e1b0-220f-42bd-a39f-d4658f80d0e4" pipelineID: "b5a22a8d-2392-4c7a-923f-95c80522151f" writeChunk { blockID { containerID: 5 localID: 104015445419098136 blockCommitSequenceId: 0 } chunkData { chunkName: "104015445419098136_chunk_1" offset: 0 len: 10240 checksumData { type: CRC32 bytesPerChecksum: 1048576 checksums: ">\344\315\231" } } }, container path=nonexistent
datanode_5_1  | 	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1HalfClosed.runInContext(ServerImpl.java:814)
datanode_5_1  | 	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
datanode_5_1  | 	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:123)
datanode_5_1  | 	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
datanode_5_1  | 	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
datanode_5_1  | 	at java.base/java.lang.Thread.run(Thread.java:834)
datanode_5_1  | Caused by: org.apache.ratis.protocol.AlreadyExistsException: 978c057e-5c38-4e20-8a8b-f271c823af7e: Failed to add group-385EF22ED913:[978c057e-5c38-4e20-8a8b-f271c823af7e:10.5.0.8:9858, a0acbcec-d753-414c-b077-647d02aaa7fb:10.5.0.7:9858, 0e99e1b0-220f-42bd-a39f-d4658f80d0e4:10.5.0.5:9858] since the group already exists in the map.
datanode_5_1  | 	at org.apache.ratis.server.impl.RaftServerProxy$ImplMap.addNew(RaftServerProxy.java:83)
datanode_5_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupAddAsync(RaftServerProxy.java:378)
datanode_5_1  | 	... 13 more
datanode_5_1  | 2020-04-17 18:50:46,479 [grpc-default-executor-0] WARN impl.RaftServerProxy: 978c057e-5c38-4e20-8a8b-f271c823af7e: Failed groupAdd* GroupManagementRequest:client-BD36FA3B314D->978c057e-5c38-4e20-8a8b-f271c823af7e@group-385EF22ED913, cid=1, seq=0, RW, null, Add:group-385EF22ED913:[978c057e-5c38-4e20-8a8b-f271c823af7e:10.5.0.8:9858, a0acbcec-d753-414c-b077-647d02aaa7fb:10.5.0.7:9858, 0e99e1b0-220f-42bd-a39f-d4658f80d0e4:10.5.0.5:9858]
datanode_5_1  | java.util.concurrent.CompletionException: org.apache.ratis.protocol.AlreadyExistsException: 978c057e-5c38-4e20-8a8b-f271c823af7e: Failed to add group-385EF22ED913:[978c057e-5c38-4e20-8a8b-f271c823af7e:10.5.0.8:9858, a0acbcec-d753-414c-b077-647d02aaa7fb:10.5.0.7:9858, 0e99e1b0-220f-42bd-a39f-d4658f80d0e4:10.5.0.5:9858] since the group already exists in the map.
datanode_5_1  | 	at java.base/java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:331)
datanode_5_1  | 	at java.base/java.util.concurrent.CompletableFuture.uniApplyNow(CompletableFuture.java:670)
datanode_5_1  | 	at java.base/java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:658)
datanode_5_1  | 	at java.base/java.util.concurrent.CompletableFuture.thenApplyAsync(CompletableFuture.java:2104)
datanode_5_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupAddAsync(RaftServerProxy.java:379)
datanode_5_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupManagementAsync(RaftServerProxy.java:363)
datanode_5_1  | 	at org.apache.ratis.grpc.server.GrpcAdminProtocolService.lambda$groupManagement$0(GrpcAdminProtocolService.java:42)
datanode_5_1  | 	at org.apache.ratis.grpc.GrpcUtil.asyncCall(GrpcUtil.java:160)
datanode_5_1  | 	at org.apache.ratis.grpc.server.GrpcAdminProtocolService.groupManagement(GrpcAdminProtocolService.java:42)
datanode_3_1  | 2020-04-17 18:50:46,550 [grpc-default-executor-0] WARN impl.RaftServerProxy: 32863f73-3555-4b23-932a-0d28eb668aea: Failed groupAdd* GroupManagementRequest:client-D08903A7702A->32863f73-3555-4b23-932a-0d28eb668aea@group-F5BD6C5F0281, cid=1, seq=0, RW, null, Add:group-F5BD6C5F0281:[b23d8fb0-3698-40b4-ac98-17b8605a770b:10.5.0.4:9858, 32863f73-3555-4b23-932a-0d28eb668aea:10.5.0.6:9858, 79669a1f-2445-496e-a337-3115205f3ae5:10.5.0.9:9858]
datanode_3_1  | java.util.concurrent.CompletionException: org.apache.ratis.protocol.AlreadyExistsException: 32863f73-3555-4b23-932a-0d28eb668aea: Failed to add group-F5BD6C5F0281:[b23d8fb0-3698-40b4-ac98-17b8605a770b:10.5.0.4:9858, 32863f73-3555-4b23-932a-0d28eb668aea:10.5.0.6:9858, 79669a1f-2445-496e-a337-3115205f3ae5:10.5.0.9:9858] since the group already exists in the map.
datanode_3_1  | 	at java.base/java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:331)
datanode_3_1  | 	at java.base/java.util.concurrent.CompletableFuture.uniApplyNow(CompletableFuture.java:670)
datanode_3_1  | 	at java.base/java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:658)
datanode_3_1  | 	at java.base/java.util.concurrent.CompletableFuture.thenApplyAsync(CompletableFuture.java:2104)
datanode_3_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupAddAsync(RaftServerProxy.java:379)
datanode_3_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupManagementAsync(RaftServerProxy.java:363)
datanode_3_1  | 	at org.apache.ratis.grpc.server.GrpcAdminProtocolService.lambda$groupManagement$0(GrpcAdminProtocolService.java:42)
datanode_3_1  | 	at org.apache.ratis.grpc.GrpcUtil.asyncCall(GrpcUtil.java:160)
datanode_3_1  | 	at org.apache.ratis.grpc.server.GrpcAdminProtocolService.groupManagement(GrpcAdminProtocolService.java:42)
datanode_3_1  | 	at org.apache.ratis.proto.grpc.AdminProtocolServiceGrpc$MethodHandlers.invoke(AdminProtocolServiceGrpc.java:358)
datanode_3_1  | 	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$UnaryServerCallHandler$UnaryServerCallListener.onHalfClose(ServerCalls.java:172)
datanode_3_1  | 	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.halfClosed(ServerCallImpl.java:331)
datanode_3_1  | 	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1HalfClosed.runInContext(ServerImpl.java:814)
datanode_3_1  | 	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
datanode_3_1  | 	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:123)
datanode_3_1  | 	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
datanode_3_1  | 	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
datanode_3_1  | 	at java.base/java.lang.Thread.run(Thread.java:834)
datanode_3_1  | Caused by: org.apache.ratis.protocol.AlreadyExistsException: 32863f73-3555-4b23-932a-0d28eb668aea: Failed to add group-F5BD6C5F0281:[b23d8fb0-3698-40b4-ac98-17b8605a770b:10.5.0.4:9858, 32863f73-3555-4b23-932a-0d28eb668aea:10.5.0.6:9858, 79669a1f-2445-496e-a337-3115205f3ae5:10.5.0.9:9858] since the group already exists in the map.
datanode_3_1  | 	at org.apache.ratis.server.impl.RaftServerProxy$ImplMap.addNew(RaftServerProxy.java:83)
datanode_3_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupAddAsync(RaftServerProxy.java:378)
datanode_3_1  | 	... 13 more
datanode_3_1  | 2020-04-17 18:50:46,559 [grpc-default-executor-1] WARN impl.RaftServerProxy: 32863f73-3555-4b23-932a-0d28eb668aea: Failed groupAdd* GroupManagementRequest:client-7E21DC5AD129->32863f73-3555-4b23-932a-0d28eb668aea@group-F5BD6C5F0281, cid=1, seq=0, RW, null, Add:group-F5BD6C5F0281:[b23d8fb0-3698-40b4-ac98-17b8605a770b:10.5.0.4:9858, 32863f73-3555-4b23-932a-0d28eb668aea:10.5.0.6:9858, 79669a1f-2445-496e-a337-3115205f3ae5:10.5.0.9:9858]
datanode_3_1  | java.util.concurrent.CompletionException: org.apache.ratis.protocol.AlreadyExistsException: 32863f73-3555-4b23-932a-0d28eb668aea: Failed to add group-F5BD6C5F0281:[b23d8fb0-3698-40b4-ac98-17b8605a770b:10.5.0.4:9858, 32863f73-3555-4b23-932a-0d28eb668aea:10.5.0.6:9858, 79669a1f-2445-496e-a337-3115205f3ae5:10.5.0.9:9858] since the group already exists in the map.
datanode_3_1  | 	at java.base/java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:331)
datanode_3_1  | 	at java.base/java.util.concurrent.CompletableFuture.uniApplyNow(CompletableFuture.java:670)
datanode_3_1  | 	at java.base/java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:658)
datanode_3_1  | 	at java.base/java.util.concurrent.CompletableFuture.thenApplyAsync(CompletableFuture.java:2104)
datanode_3_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupAddAsync(RaftServerProxy.java:379)
datanode_3_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupManagementAsync(RaftServerProxy.java:363)
datanode_3_1  | 	at org.apache.ratis.grpc.server.GrpcAdminProtocolService.lambda$groupManagement$0(GrpcAdminProtocolService.java:42)
datanode_3_1  | 	at org.apache.ratis.grpc.GrpcUtil.asyncCall(GrpcUtil.java:160)
datanode_3_1  | 	at org.apache.ratis.grpc.server.GrpcAdminProtocolService.groupManagement(GrpcAdminProtocolService.java:42)
datanode_3_1  | 	at org.apache.ratis.proto.grpc.AdminProtocolServiceGrpc$MethodHandlers.invoke(AdminProtocolServiceGrpc.java:358)
datanode_3_1  | 	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$UnaryServerCallHandler$UnaryServerCallListener.onHalfClose(ServerCalls.java:172)
datanode_3_1  | 	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.halfClosed(ServerCallImpl.java:331)
datanode_3_1  | 	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1HalfClosed.runInContext(ServerImpl.java:814)
datanode_3_1  | 	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
datanode_3_1  | 	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:123)
datanode_3_1  | 	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
datanode_3_1  | 	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
datanode_3_1  | 	at java.base/java.lang.Thread.run(Thread.java:834)
datanode_3_1  | Caused by: org.apache.ratis.protocol.AlreadyExistsException: 32863f73-3555-4b23-932a-0d28eb668aea: Failed to add group-F5BD6C5F0281:[b23d8fb0-3698-40b4-ac98-17b8605a770b:10.5.0.4:9858, 32863f73-3555-4b23-932a-0d28eb668aea:10.5.0.6:9858, 79669a1f-2445-496e-a337-3115205f3ae5:10.5.0.9:9858] since the group already exists in the map.
datanode_3_1  | 	at org.apache.ratis.server.impl.RaftServerProxy$ImplMap.addNew(RaftServerProxy.java:83)
datanode_3_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupAddAsync(RaftServerProxy.java:378)
datanode_3_1  | 	... 13 more
datanode_3_1  | 2020-04-17 18:50:46,929 [Thread-23] INFO impl.FollowerState: 32863f73-3555-4b23-932a-0d28eb668aea@group-CC09C422F088-FollowerState: change to CANDIDATE, lastRpcTime:5066ms, electionTimeout:5046ms
datanode_3_1  | 2020-04-17 18:50:46,931 [Thread-23] INFO impl.RoleInfo: 32863f73-3555-4b23-932a-0d28eb668aea: shutdown FollowerState
datanode_3_1  | 2020-04-17 18:50:46,931 [Thread-23] INFO impl.RaftServerImpl: 32863f73-3555-4b23-932a-0d28eb668aea@group-CC09C422F088: changes role from  FOLLOWER to CANDIDATE at term 0 for changeToCandidate
datanode_3_1  | 2020-04-17 18:50:46,934 [Thread-23] INFO impl.RoleInfo: 32863f73-3555-4b23-932a-0d28eb668aea: start LeaderElection
datanode_3_1  | 2020-04-17 18:50:46,947 [32863f73-3555-4b23-932a-0d28eb668aea@group-CC09C422F088-LeaderElection1] INFO impl.LeaderElection: 32863f73-3555-4b23-932a-0d28eb668aea@group-CC09C422F088-LeaderElection1: begin an election at term 1 for -1: [32863f73-3555-4b23-932a-0d28eb668aea:10.5.0.6:9858], old=null
datanode_3_1  | 2020-04-17 18:50:46,954 [32863f73-3555-4b23-932a-0d28eb668aea@group-CC09C422F088-LeaderElection1] INFO impl.RoleInfo: 32863f73-3555-4b23-932a-0d28eb668aea: shutdown LeaderElection
datanode_5_1  | 	at org.apache.ratis.proto.grpc.AdminProtocolServiceGrpc$MethodHandlers.invoke(AdminProtocolServiceGrpc.java:358)
datanode_5_1  | 	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$UnaryServerCallHandler$UnaryServerCallListener.onHalfClose(ServerCalls.java:172)
datanode_5_1  | 	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.halfClosed(ServerCallImpl.java:331)
datanode_5_1  | 	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1HalfClosed.runInContext(ServerImpl.java:814)
datanode_5_1  | 	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
datanode_5_1  | 	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:123)
datanode_5_1  | 	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
datanode_5_1  | 	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
datanode_5_1  | 	at java.base/java.lang.Thread.run(Thread.java:834)
datanode_5_1  | Caused by: org.apache.ratis.protocol.AlreadyExistsException: 978c057e-5c38-4e20-8a8b-f271c823af7e: Failed to add group-385EF22ED913:[978c057e-5c38-4e20-8a8b-f271c823af7e:10.5.0.8:9858, a0acbcec-d753-414c-b077-647d02aaa7fb:10.5.0.7:9858, 0e99e1b0-220f-42bd-a39f-d4658f80d0e4:10.5.0.5:9858] since the group already exists in the map.
datanode_5_1  | 	at org.apache.ratis.server.impl.RaftServerProxy$ImplMap.addNew(RaftServerProxy.java:83)
datanode_5_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupAddAsync(RaftServerProxy.java:378)
datanode_5_1  | 	... 13 more
datanode_5_1  | 2020-04-17 18:50:46,988 [Command processor thread] INFO commandhandler.CreatePipelineCommandHandler: Created Pipeline RATIS THREE #id: "be26d0dd-802f-4608-9a1c-385ef22ed913"
datanode_5_1  | .
datanode_5_1  | 2020-04-17 18:50:47,869 [grpc-default-executor-0] INFO impl.RaftServerImpl: 978c057e-5c38-4e20-8a8b-f271c823af7e@group-385EF22ED913: changes role from  FOLLOWER to FOLLOWER at term 1 for recognizeCandidate:a0acbcec-d753-414c-b077-647d02aaa7fb
datanode_5_1  | 2020-04-17 18:50:47,871 [grpc-default-executor-0] INFO impl.RoleInfo: 978c057e-5c38-4e20-8a8b-f271c823af7e: shutdown FollowerState
datanode_5_1  | 2020-04-17 18:50:47,872 [Thread-26] INFO impl.FollowerState: 978c057e-5c38-4e20-8a8b-f271c823af7e@group-385EF22ED913-FollowerState was interrupted: java.lang.InterruptedException: sleep interrupted
datanode_5_1  | 2020-04-17 18:50:47,872 [grpc-default-executor-0] INFO impl.RoleInfo: 978c057e-5c38-4e20-8a8b-f271c823af7e: start FollowerState
datanode_5_1  | 2020-04-17 18:50:48,250 [grpc-default-executor-0] INFO ratis.XceiverServerRatis: Leader change notification received for group: group-385EF22ED913 with new leaderId: a0acbcec-d753-414c-b077-647d02aaa7fb
datanode_5_1  | 2020-04-17 18:50:48,250 [grpc-default-executor-0] INFO impl.RaftServerImpl: 978c057e-5c38-4e20-8a8b-f271c823af7e@group-385EF22ED913: change Leader from null to a0acbcec-d753-414c-b077-647d02aaa7fb at term 1 for appendEntries, leader elected after 4101ms
datanode_5_1  | 2020-04-17 18:50:48,305 [grpc-default-executor-0] INFO impl.RaftServerImpl: 978c057e-5c38-4e20-8a8b-f271c823af7e@group-385EF22ED913: set configuration 0: [978c057e-5c38-4e20-8a8b-f271c823af7e:10.5.0.8:9858, a0acbcec-d753-414c-b077-647d02aaa7fb:10.5.0.7:9858, 0e99e1b0-220f-42bd-a39f-d4658f80d0e4:10.5.0.5:9858], old=null at 0
datanode_5_1  | 2020-04-17 18:50:48,341 [grpc-default-executor-0] INFO segmented.SegmentedRaftLogWorker: 978c057e-5c38-4e20-8a8b-f271c823af7e@group-385EF22ED913-SegmentedRaftLogWorker: Starting segment from index:0
datanode_5_1  | 2020-04-17 18:50:48,704 [978c057e-5c38-4e20-8a8b-f271c823af7e@group-385EF22ED913-SegmentedRaftLogWorker] INFO segmented.SegmentedRaftLogWorker: 978c057e-5c38-4e20-8a8b-f271c823af7e@group-385EF22ED913-SegmentedRaftLogWorker: created new log segment /data/metadata/ratis/be26d0dd-802f-4608-9a1c-385ef22ed913/current/log_inprogress_0
datanode_5_1  | 2020-04-17 18:50:49,223 [Thread-24] INFO impl.FollowerState: 978c057e-5c38-4e20-8a8b-f271c823af7e@group-D621A9FFD9B9-FollowerState: change to CANDIDATE, lastRpcTime:5205ms, electionTimeout:5185ms
datanode_5_1  | 2020-04-17 18:50:49,226 [Thread-24] INFO impl.RoleInfo: 978c057e-5c38-4e20-8a8b-f271c823af7e: shutdown FollowerState
datanode_5_1  | 2020-04-17 18:50:49,226 [Thread-24] INFO impl.RaftServerImpl: 978c057e-5c38-4e20-8a8b-f271c823af7e@group-D621A9FFD9B9: changes role from  FOLLOWER to CANDIDATE at term 0 for changeToCandidate
datanode_5_1  | 2020-04-17 18:50:49,243 [Thread-24] INFO impl.RoleInfo: 978c057e-5c38-4e20-8a8b-f271c823af7e: start LeaderElection
datanode_5_1  | 2020-04-17 18:50:49,260 [978c057e-5c38-4e20-8a8b-f271c823af7e@group-D621A9FFD9B9-LeaderElection1] INFO impl.LeaderElection: 978c057e-5c38-4e20-8a8b-f271c823af7e@group-D621A9FFD9B9-LeaderElection1: begin an election at term 1 for -1: [978c057e-5c38-4e20-8a8b-f271c823af7e:10.5.0.8:9858], old=null
datanode_5_1  | 2020-04-17 18:50:49,261 [978c057e-5c38-4e20-8a8b-f271c823af7e@group-D621A9FFD9B9-LeaderElection1] INFO impl.RoleInfo: 978c057e-5c38-4e20-8a8b-f271c823af7e: shutdown LeaderElection
datanode_5_1  | 2020-04-17 18:50:49,270 [978c057e-5c38-4e20-8a8b-f271c823af7e@group-D621A9FFD9B9-LeaderElection1] INFO impl.RaftServerImpl: 978c057e-5c38-4e20-8a8b-f271c823af7e@group-D621A9FFD9B9: changes role from CANDIDATE to LEADER at term 1 for changeToLeader
datanode_5_1  | 2020-04-17 18:50:49,272 [978c057e-5c38-4e20-8a8b-f271c823af7e@group-D621A9FFD9B9-LeaderElection1] INFO ratis.XceiverServerRatis: Leader change notification received for group: group-D621A9FFD9B9 with new leaderId: 978c057e-5c38-4e20-8a8b-f271c823af7e
datanode_5_1  | 2020-04-17 18:50:49,273 [978c057e-5c38-4e20-8a8b-f271c823af7e@group-D621A9FFD9B9-LeaderElection1] INFO impl.RaftServerImpl: 978c057e-5c38-4e20-8a8b-f271c823af7e@group-D621A9FFD9B9: change Leader from null to 978c057e-5c38-4e20-8a8b-f271c823af7e at term 1 for becomeLeader, leader elected after 6194ms
datanode_5_1  | 2020-04-17 18:50:49,275 [978c057e-5c38-4e20-8a8b-f271c823af7e@group-D621A9FFD9B9-LeaderElection1] INFO server.RaftServerConfigKeys: raft.server.staging.catchup.gap = 1000 (default)
datanode_5_1  | 2020-04-17 18:50:49,285 [978c057e-5c38-4e20-8a8b-f271c823af7e@group-D621A9FFD9B9-LeaderElection1] INFO server.RaftServerConfigKeys: raft.server.rpc.sleep.time = 25ms (default)
datanode_5_1  | 2020-04-17 18:50:49,294 [978c057e-5c38-4e20-8a8b-f271c823af7e@group-D621A9FFD9B9-LeaderElection1] INFO metrics.RatisMetrics: Creating Metrics Registry : ratis.log_appender.978c057e-5c38-4e20-8a8b-f271c823af7e@group-D621A9FFD9B9
datanode_5_1  | 2020-04-17 18:50:49,303 [978c057e-5c38-4e20-8a8b-f271c823af7e@group-D621A9FFD9B9-LeaderElection1] INFO server.RaftServerConfigKeys: raft.server.write.element-limit = 1024 (custom)
datanode_5_1  | 2020-04-17 18:50:49,304 [978c057e-5c38-4e20-8a8b-f271c823af7e@group-D621A9FFD9B9-LeaderElection1] INFO server.RaftServerConfigKeys: raft.server.write.byte-limit = 1073741824 (custom)
datanode_5_1  | 2020-04-17 18:50:49,328 [978c057e-5c38-4e20-8a8b-f271c823af7e@group-D621A9FFD9B9-LeaderElection1] INFO server.RaftServerConfigKeys: raft.server.watch.timeout = 180s (custom)
datanode_5_1  | 2020-04-17 18:50:49,334 [978c057e-5c38-4e20-8a8b-f271c823af7e@group-D621A9FFD9B9-LeaderElection1] INFO server.RaftServerConfigKeys: raft.server.watch.timeout.denomination = 1s (default)
datanode_5_1  | 2020-04-17 18:50:49,340 [978c057e-5c38-4e20-8a8b-f271c823af7e@group-D621A9FFD9B9-LeaderElection1] INFO server.RaftServerConfigKeys: raft.server.watch.element-limit = 65536 (default)
datanode_5_1  | 2020-04-17 18:50:49,412 [978c057e-5c38-4e20-8a8b-f271c823af7e@group-D621A9FFD9B9-LeaderElection1] INFO impl.RoleInfo: 978c057e-5c38-4e20-8a8b-f271c823af7e: start LeaderState
datanode_5_1  | 2020-04-17 18:50:49,431 [978c057e-5c38-4e20-8a8b-f271c823af7e@group-D621A9FFD9B9-LeaderElection1] INFO segmented.SegmentedRaftLogWorker: 978c057e-5c38-4e20-8a8b-f271c823af7e@group-D621A9FFD9B9-SegmentedRaftLogWorker: Starting segment from index:0
datanode_3_1  | 2020-04-17 18:50:46,959 [32863f73-3555-4b23-932a-0d28eb668aea@group-CC09C422F088-LeaderElection1] INFO impl.RaftServerImpl: 32863f73-3555-4b23-932a-0d28eb668aea@group-CC09C422F088: changes role from CANDIDATE to LEADER at term 1 for changeToLeader
datanode_3_1  | 2020-04-17 18:50:46,960 [32863f73-3555-4b23-932a-0d28eb668aea@group-CC09C422F088-LeaderElection1] INFO ratis.XceiverServerRatis: Leader change notification received for group: group-CC09C422F088 with new leaderId: 32863f73-3555-4b23-932a-0d28eb668aea
datanode_3_1  | 2020-04-17 18:50:46,962 [32863f73-3555-4b23-932a-0d28eb668aea@group-CC09C422F088-LeaderElection1] INFO impl.RaftServerImpl: 32863f73-3555-4b23-932a-0d28eb668aea@group-CC09C422F088: change Leader from null to 32863f73-3555-4b23-932a-0d28eb668aea at term 1 for becomeLeader, leader elected after 5657ms
datanode_3_1  | 2020-04-17 18:50:46,993 [32863f73-3555-4b23-932a-0d28eb668aea@group-CC09C422F088-LeaderElection1] INFO server.RaftServerConfigKeys: raft.server.staging.catchup.gap = 1000 (default)
datanode_3_1  | 2020-04-17 18:50:46,994 [32863f73-3555-4b23-932a-0d28eb668aea@group-CC09C422F088-LeaderElection1] INFO server.RaftServerConfigKeys: raft.server.rpc.sleep.time = 25ms (default)
datanode_3_1  | 2020-04-17 18:50:46,998 [32863f73-3555-4b23-932a-0d28eb668aea@group-CC09C422F088-LeaderElection1] INFO metrics.RatisMetrics: Creating Metrics Registry : ratis.log_appender.32863f73-3555-4b23-932a-0d28eb668aea@group-CC09C422F088
datanode_3_1  | 2020-04-17 18:50:47,014 [32863f73-3555-4b23-932a-0d28eb668aea@group-CC09C422F088-LeaderElection1] INFO server.RaftServerConfigKeys: raft.server.write.element-limit = 1024 (custom)
datanode_3_1  | 2020-04-17 18:50:47,051 [32863f73-3555-4b23-932a-0d28eb668aea@group-CC09C422F088-LeaderElection1] INFO server.RaftServerConfigKeys: raft.server.write.byte-limit = 1073741824 (custom)
datanode_3_1  | 2020-04-17 18:50:47,085 [grpc-default-executor-0] INFO impl.RaftServerImpl: 32863f73-3555-4b23-932a-0d28eb668aea@group-F5BD6C5F0281: changes role from  FOLLOWER to FOLLOWER at term 1 for recognizeCandidate:79669a1f-2445-496e-a337-3115205f3ae5
datanode_3_1  | 2020-04-17 18:50:47,085 [grpc-default-executor-0] INFO impl.RoleInfo: 32863f73-3555-4b23-932a-0d28eb668aea: shutdown FollowerState
datanode_3_1  | 2020-04-17 18:50:47,085 [Thread-25] INFO impl.FollowerState: 32863f73-3555-4b23-932a-0d28eb668aea@group-F5BD6C5F0281-FollowerState was interrupted: java.lang.InterruptedException: sleep interrupted
datanode_3_1  | 2020-04-17 18:50:47,086 [grpc-default-executor-0] INFO impl.RoleInfo: 32863f73-3555-4b23-932a-0d28eb668aea: start FollowerState
datanode_3_1  | 2020-04-17 18:50:47,092 [32863f73-3555-4b23-932a-0d28eb668aea@group-CC09C422F088-LeaderElection1] INFO server.RaftServerConfigKeys: raft.server.watch.timeout = 180s (custom)
datanode_3_1  | 2020-04-17 18:50:47,105 [32863f73-3555-4b23-932a-0d28eb668aea@group-CC09C422F088-LeaderElection1] INFO server.RaftServerConfigKeys: raft.server.watch.timeout.denomination = 1s (default)
datanode_3_1  | 2020-04-17 18:50:47,106 [32863f73-3555-4b23-932a-0d28eb668aea@group-CC09C422F088-LeaderElection1] INFO server.RaftServerConfigKeys: raft.server.watch.element-limit = 65536 (default)
datanode_3_1  | 2020-04-17 18:50:47,138 [32863f73-3555-4b23-932a-0d28eb668aea@group-CC09C422F088-LeaderElection1] INFO impl.RoleInfo: 32863f73-3555-4b23-932a-0d28eb668aea: start LeaderState
datanode_3_1  | 2020-04-17 18:50:47,219 [32863f73-3555-4b23-932a-0d28eb668aea@group-CC09C422F088-LeaderElection1] INFO segmented.SegmentedRaftLogWorker: 32863f73-3555-4b23-932a-0d28eb668aea@group-CC09C422F088-SegmentedRaftLogWorker: Starting segment from index:0
datanode_3_1  | 2020-04-17 18:50:47,322 [32863f73-3555-4b23-932a-0d28eb668aea@group-CC09C422F088-LeaderElection1] INFO impl.RaftServerImpl: 32863f73-3555-4b23-932a-0d28eb668aea@group-CC09C422F088: set configuration 0: [32863f73-3555-4b23-932a-0d28eb668aea:10.5.0.6:9858], old=null at 0
datanode_3_1  | 2020-04-17 18:50:47,374 [grpc-default-executor-0] INFO ratis.XceiverServerRatis: Leader change notification received for group: group-F5BD6C5F0281 with new leaderId: 79669a1f-2445-496e-a337-3115205f3ae5
datanode_3_1  | 2020-04-17 18:50:47,375 [grpc-default-executor-0] INFO impl.RaftServerImpl: 32863f73-3555-4b23-932a-0d28eb668aea@group-F5BD6C5F0281: change Leader from null to 79669a1f-2445-496e-a337-3115205f3ae5 at term 1 for appendEntries, leader elected after 5380ms
datanode_3_1  | 2020-04-17 18:50:47,509 [grpc-default-executor-0] INFO impl.RaftServerImpl: 32863f73-3555-4b23-932a-0d28eb668aea@group-F5BD6C5F0281: set configuration 0: [b23d8fb0-3698-40b4-ac98-17b8605a770b:10.5.0.4:9858, 32863f73-3555-4b23-932a-0d28eb668aea:10.5.0.6:9858, 79669a1f-2445-496e-a337-3115205f3ae5:10.5.0.9:9858], old=null at 0
datanode_3_1  | 2020-04-17 18:50:47,509 [grpc-default-executor-0] INFO segmented.SegmentedRaftLogWorker: 32863f73-3555-4b23-932a-0d28eb668aea@group-F5BD6C5F0281-SegmentedRaftLogWorker: Starting segment from index:0
datanode_3_1  | 2020-04-17 18:50:47,574 [32863f73-3555-4b23-932a-0d28eb668aea@group-F5BD6C5F0281-SegmentedRaftLogWorker] INFO segmented.SegmentedRaftLogWorker: 32863f73-3555-4b23-932a-0d28eb668aea@group-F5BD6C5F0281-SegmentedRaftLogWorker: created new log segment /data/metadata/ratis/315eee3a-6983-45b7-a699-f5bd6c5f0281/current/log_inprogress_0
datanode_3_1  | 2020-04-17 18:50:47,582 [32863f73-3555-4b23-932a-0d28eb668aea@group-CC09C422F088-SegmentedRaftLogWorker] INFO segmented.SegmentedRaftLogWorker: 32863f73-3555-4b23-932a-0d28eb668aea@group-CC09C422F088-SegmentedRaftLogWorker: created new log segment /data/metadata/ratis/78615a2e-50d8-4031-9b8b-cc09c422f088/current/log_inprogress_0
datanode_4_1  | Enabled profiling in kernel
datanode_4_1  | No '-XX:...' jvm parameters are used. Adding safer GC settings to the HADOOP_OPTS
datanode_4_1  | OpenJDK 64-Bit Server VM warning: Option UseConcMarkSweepGC was deprecated in version 9.0 and will likely be removed in a future release.
datanode_4_1  | 2020-04-17 18:50:12,419 [main] INFO ozone.HddsDatanodeService: STARTUP_MSG: 
datanode_4_1  | /************************************************************
datanode_4_1  | STARTUP_MSG: Starting HddsDatanodeService
datanode_4_1  | STARTUP_MSG:   host = cea2015b57a1/10.5.0.7
datanode_4_1  | STARTUP_MSG:   args = []
datanode_4_1  | STARTUP_MSG:   version = 3.2.0
datanode_4_1  | STARTUP_MSG:   classpath = /etc/hadoop:/opt/hadoop/share/hadoop/common/*:/opt/hadoop/share/ozone/lib/kerb-simplekdc-1.0.1.jar:/opt/hadoop/share/ozone/lib/jackson-databind-2.10.3.jar:/opt/hadoop/share/ozone/lib/protobuf-java-2.5.0.jar:/opt/hadoop/share/ozone/lib/bcpkix-jdk15on-1.60.jar:/opt/hadoop/share/ozone/lib/netty-3.10.5.Final.jar:/opt/hadoop/share/ozone/lib/ratis-proto-0.6.0-7c5b30d-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/commons-validator-1.6.jar:/opt/hadoop/share/ozone/lib/hadoop-hdds-client-0.6.0-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/jaxb-impl-2.3.0.1.jar:/opt/hadoop/share/ozone/lib/netty-all-4.1.47.Final.jar:/opt/hadoop/share/ozone/lib/kerb-core-1.0.1.jar:/opt/hadoop/share/ozone/lib/jsr305-3.0.0.jar:/opt/hadoop/share/ozone/lib/j2objc-annotations-1.3.jar:/opt/hadoop/share/ozone/lib/leveldbjni-all-1.8.jar:/opt/hadoop/share/ozone/lib/jetty-io-9.4.26.v20200117.jar:/opt/hadoop/share/ozone/lib/htrace-core4-4.1.0-incubating.jar:/opt/hadoop/share/ozone/lib/jaxb-api-2.3.0.jar:/opt/hadoop/share/ozone/lib/hadoop-annotations-3.2.0.jar:/opt/hadoop/share/ozone/lib/kerb-util-1.0.1.jar:/opt/hadoop/share/ozone/lib/jetty-http-9.4.26.v20200117.jar:/opt/hadoop/share/ozone/lib/jetty-xml-9.4.26.v20200117.jar:/opt/hadoop/share/ozone/lib/jackson-jaxrs-1.9.13.jar:/opt/hadoop/share/ozone/lib/ratis-thirdparty-misc-0.3.0.jar:/opt/hadoop/share/ozone/lib/kerby-xdr-1.0.1.jar:/opt/hadoop/share/ozone/lib/jackson-core-asl-1.9.13.jar:/opt/hadoop/share/ozone/lib/jetty-server-9.4.26.v20200117.jar:/opt/hadoop/share/ozone/lib/commons-net-3.6.jar:/opt/hadoop/share/ozone/lib/log4j-api-2.11.0.jar:/opt/hadoop/share/ozone/lib/hadoop-hdfs-3.2.0.jar:/opt/hadoop/share/ozone/lib/opentracing-api-0.31.0.jar:/opt/hadoop/share/ozone/lib/slf4j-log4j12-1.7.25.jar:/opt/hadoop/share/ozone/lib/hadoop-hdfs-client-3.2.0.jar:/opt/hadoop/share/ozone/lib/kerby-config-1.0.1.jar:/opt/hadoop/share/ozone/lib/libthrift-0.12.0.jar:/opt/hadoop/share/ozone/lib/jetty-util-ajax-9.4.26.v20200117.jar:/opt/hadoop/share/ozone/lib/metrics-core-3.2.4.jar:/opt/hadoop/share/ozone/lib/kerby-pkix-1.0.1.jar:/opt/hadoop/share/ozone/lib/guava-28.2-jre.jar:/opt/hadoop/share/ozone/lib/jetty-servlet-9.4.26.v20200117.jar:/opt/hadoop/share/ozone/lib/xz-1.0.jar:/opt/hadoop/share/ozone/lib/activation-1.1.1.jar:/opt/hadoop/share/ozone/lib/jsr311-api-1.1.1.jar:/opt/hadoop/share/ozone/lib/commons-beanutils-1.9.4.jar:/opt/hadoop/share/ozone/lib/rocksdbjni-6.6.4.jar:/opt/hadoop/share/ozone/lib/jetty-security-9.4.26.v20200117.jar:/opt/hadoop/share/ozone/lib/hadoop-hdds-container-service-0.6.0-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/kerb-server-1.0.1.jar:/opt/hadoop/share/ozone/lib/javax.servlet-api-3.1.0.jar:/opt/hadoop/share/ozone/lib/avro-1.7.7.jar:/opt/hadoop/share/ozone/lib/kerb-client-1.0.1.jar:/opt/hadoop/share/ozone/lib/jackson-xc-1.9.13.jar:/opt/hadoop/share/ozone/lib/disruptor-3.4.2.jar:/opt/hadoop/share/ozone/lib/simpleclient_common-0.7.0.jar:/opt/hadoop/share/ozone/lib/dnsjava-2.1.7.jar:/opt/hadoop/share/ozone/lib/jackson-annotations-2.10.3.jar:/opt/hadoop/share/ozone/lib/commons-configuration2-2.1.1.jar:/opt/hadoop/share/ozone/lib/json-smart-2.3.jar:/opt/hadoop/share/ozone/lib/token-provider-1.0.1.jar:/opt/hadoop/share/ozone/lib/log4j-1.2.17.jar:/opt/hadoop/share/ozone/lib/commons-daemon-1.0.13.jar:/opt/hadoop/share/ozone/lib/listenablefuture-9999.0-empty-to-avoid-conflict-with-guava.jar:/opt/hadoop/share/ozone/lib/bcprov-jdk15on-1.60.jar:/opt/hadoop/share/ozone/lib/ratis-grpc-0.6.0-7c5b30d-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/jetty-webapp-9.4.26.v20200117.jar:/opt/hadoop/share/ozone/lib/commons-lang3-3.7.jar:/opt/hadoop/share/ozone/lib/jaeger-client-0.34.0.jar:/opt/hadoop/share/ozone/lib/commons-compress-1.4.1.jar:/opt/hadoop/share/ozone/lib/accessors-smart-1.2.jar:/opt/hadoop/share/ozone/lib/re2j-1.1.jar:/opt/hadoop/share/ozone/lib/ratis-client-0.6.0-7c5b30d-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/commons-math3-3.1.1.jar:/opt/hadoop/share/ozone/lib/simpleclient_dropwizard-0.7.0.jar:/opt/hadoop/share/ozone/lib/opentracing-noop-0.31.0.jar:/opt/hadoop/share/ozone/lib/simpleclient-0.7.0.jar:/opt/hadoop/share/ozone/lib/httpclient-4.5.2.jar:/opt/hadoop/share/ozone/lib/jaeger-core-0.34.0.jar:/opt/hadoop/share/ozone/lib/asm-5.0.4.jar:/opt/hadoop/share/ozone/lib/kerby-util-1.0.1.jar:/opt/hadoop/share/ozone/lib/failureaccess-1.0.1.jar:/opt/hadoop/share/ozone/lib/jackson-mapper-asl-1.9.13.jar:/opt/hadoop/share/ozone/lib/jsp-api-2.1.jar:/opt/hadoop/share/ozone/lib/jsch-0.1.54.jar:/opt/hadoop/share/ozone/lib/ratis-metrics-0.6.0-7c5b30d-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/opentracing-tracerresolver-0.1.5.jar:/opt/hadoop/share/ozone/lib/ratis-common-0.6.0-7c5b30d-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/paranamer-2.3.jar:/opt/hadoop/share/ozone/lib/log4j-core-2.11.0.jar:/opt/hadoop/share/ozone/lib/nimbus-jose-jwt-7.9.jar:/opt/hadoop/share/ozone/lib/commons-codec-1.11.jar:/opt/hadoop/share/ozone/lib/commons-pool2-2.6.0.jar:/opt/hadoop/share/ozone/lib/jackson-datatype-jsr310-2.10.3.jar:/opt/hadoop/share/ozone/lib/gson-2.2.4.jar:/opt/hadoop/share/ozone/lib/jcip-annotations-1.0-1.jar:/opt/hadoop/share/ozone/lib/kerb-admin-1.0.1.jar:/opt/hadoop/share/ozone/lib/commons-io-2.5.jar:/opt/hadoop/share/ozone/lib/okio-1.13.0.jar:/opt/hadoop/share/ozone/lib/snakeyaml-1.16.jar:/opt/hadoop/share/ozone/lib/jetty-util-9.4.26.v20200117.jar:/opt/hadoop/share/ozone/lib/jersey-core-1.19.jar:/opt/hadoop/share/ozone/lib/hadoop-hdds-hadoop-dependency-client-0.6.0-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/checker-qual-2.10.0.jar:/opt/hadoop/share/ozone/lib/ratis-server-0.6.0-7c5b30d-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/hadoop-hdds-server-framework-0.6.0-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/error_prone_annotations-2.3.4.jar:/opt/hadoop/share/ozone/lib/picocli-3.9.6.jar:/opt/hadoop/share/ozone/lib/jaeger-thrift-0.34.0.jar:/opt/hadoop/share/ozone/lib/hadoop-hdds-common-0.6.0-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/commons-cli-1.2.jar:/opt/hadoop/share/ozone/lib/woodstox-core-5.0.3.jar:/opt/hadoop/share/ozone/lib/snappy-java-1.0.5.jar:/opt/hadoop/share/ozone/lib/javax.annotation-api-1.2.jar:/opt/hadoop/share/ozone/lib/jaeger-tracerresolver-0.34.0.jar:/opt/hadoop/share/ozone/lib/kerby-asn1-1.0.1.jar:/opt/hadoop/share/ozone/lib/okhttp-3.9.0.jar:/opt/hadoop/share/ozone/lib/hadoop-hdds-config-0.6.0-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/stax2-api-3.1.4.jar:/opt/hadoop/share/ozone/lib/commons-collections-3.2.2.jar:/opt/hadoop/share/ozone/lib/commons-digester-1.8.1.jar:/opt/hadoop/share/ozone/lib/jettison-1.1.jar:/opt/hadoop/share/ozone/lib/commons-text-1.4.jar:/opt/hadoop/share/ozone/lib/jackson-core-2.10.3.jar:/opt/hadoop/share/ozone/lib/jersey-servlet-1.19.jar:/opt/hadoop/share/ozone/lib/jersey-json-1.19.jar:/opt/hadoop/share/ozone/lib/slf4j-api-1.7.25.jar:/opt/hadoop/share/ozone/lib/commons-logging-1.1.3.jar:/opt/hadoop/share/ozone/lib/kerb-identity-1.0.1.jar:/opt/hadoop/share/ozone/lib/opentracing-util-0.31.0.jar:/opt/hadoop/share/ozone/lib/hadoop-hdds-hadoop-dependency-server-0.6.0-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/hadoop-common-3.2.0.jar:/opt/hadoop/share/ozone/lib/hadoop-auth-3.2.0.jar:/opt/hadoop/share/ozone/lib/kerb-common-1.0.1.jar:/opt/hadoop/share/ozone/lib/jaxb-core-2.3.0.1.jar:/opt/hadoop/share/ozone/lib/jersey-server-1.19.jar:/opt/hadoop/share/ozone/lib/hadoop-hdds-common-0.6.0-SNAPSHOT-tests.jar:/opt/hadoop/share/ozone/lib/kerb-crypto-1.0.1.jar:/opt/hadoop/share/ozone/lib/httpcore-4.4.4.jar:/opt/hadoop/share/ozone/lib/ratis-netty-0.6.0-7c5b30d-SNAPSHOT.jar:/opt/hadoop/share/ozone/web:/opt/hadoop/share/ozone/lib/hadoop-ozone-datanode-0.6.0-SNAPSHOT.jar
datanode_4_1  | STARTUP_MSG:   build = https://github.com/apache/hadoop.git -r e97acb3bd8f3befd27418996fa5d4b50bf2e17bf; compiled by 'sunilg' on 2019-01-15T17:34Z
datanode_4_1  | STARTUP_MSG:   java = 11.0.6
datanode_4_1  | ************************************************************/
datanode_4_1  | 2020-04-17 18:50:12,451 [main] INFO ozone.HddsDatanodeService: registered UNIX signal handlers for [TERM, HUP, INT]
datanode_4_1  | 2020-04-17 18:50:14,401 [main] INFO metrics.MetricRegistries: Loaded MetricRegistries class org.apache.ratis.metrics.impl.MetricRegistriesImpl
datanode_4_1  | 2020-04-17 18:50:14,920 [main] INFO impl.MetricsConfig: Loaded properties from hadoop-metrics2.properties
datanode_4_1  | 2020-04-17 18:50:15,995 [main] INFO impl.MetricsSystemImpl: Scheduled Metric snapshot period at 10 second(s).
datanode_4_1  | 2020-04-17 18:50:15,999 [main] INFO impl.MetricsSystemImpl: HddsDatanode metrics system started
datanode_4_1  | 2020-04-17 18:50:17,215 [main] INFO ozone.HddsDatanodeService: HddsDatanodeService host:cea2015b57a1 ip:10.5.0.7
datanode_4_1  | 2020-04-17 18:50:17,645 [main] INFO fs.SaveSpaceUsageToFile: Cached usage info file /data/hdds/scmUsed not found
datanode_4_1  | 2020-04-17 18:50:17,656 [main] INFO volume.HddsVolume: Creating Volume: /data/hdds/hdds of storage type : DISK and capacity : 89311358976
datanode_4_1  | 2020-04-17 18:50:17,660 [main] INFO volume.MutableVolumeSet: Added Volume : /data/hdds/hdds to VolumeSet
datanode_4_1  | 2020-04-17 18:50:17,710 [main] INFO volume.ThrottledAsyncChecker: Scheduling a check for /data/hdds/hdds
datanode_4_1  | 2020-04-17 18:50:17,854 [main] INFO volume.HddsVolumeChecker: Scheduled health check for volume /data/hdds/hdds
datanode_4_1  | 2020-04-17 18:50:24,189 [main] WARN server.ServerUtils: Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
datanode_4_1  | 2020-04-17 18:50:24,486 [main] INFO impl.RaftServerProxy: raft.rpc.type = GRPC (default)
datanode_4_1  | 2020-04-17 18:50:24,960 [main] INFO grpc.GrpcConfigKeys: raft.grpc.server.port = 9858 (custom)
datanode_4_1  | 2020-04-17 18:50:24,961 [main] INFO server.GrpcService: raft.grpc.message.size.max = 32MB (=33554432) (custom)
datanode_4_1  | 2020-04-17 18:50:24,968 [main] INFO server.RaftServerConfigKeys: raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
datanode_4_1  | 2020-04-17 18:50:24,968 [main] INFO server.GrpcService: raft.grpc.flow.control.window = 5MB (=5242880) (custom)
datanode_4_1  | 2020-04-17 18:50:24,989 [main] INFO server.RaftServerConfigKeys: raft.server.rpc.request.timeout = 60s (custom)
datanode_4_1  | 2020-04-17 18:50:26,699 [main] INFO server.RaftServerConfigKeys: raft.server.storage.dir = [/data/metadata/ratis] (custom)
datanode_4_1  | 2020-04-17 18:50:28,026 [main] INFO http.BaseHttpServer: Starting Web-server for hddsDatanode at: http://0.0.0.0:9882
datanode_4_1  | 2020-04-17 18:50:28,183 [main] INFO util.log: Logging initialized @20732ms to org.eclipse.jetty.util.log.Slf4jLog
datanode_4_1  | 2020-04-17 18:50:28,808 [main] INFO server.AuthenticationFilter: Unable to initialize FileSignerSecretProvider, falling back to use random secrets.
datanode_4_1  | 2020-04-17 18:50:28,863 [main] INFO http.HttpRequestLog: Http request log for http.requests.hddsDatanode is not defined
datanode_4_1  | 2020-04-17 18:50:28,934 [main] INFO http.HttpServer2: Added global filter 'safety' (class=org.apache.hadoop.hdds.server.http.HttpServer2$QuotingInputFilter)
datanode_4_1  | 2020-04-17 18:50:28,948 [main] INFO http.HttpServer2: Added filter static_user_filter (class=org.apache.hadoop.hdds.server.http.StaticUserWebFilter$StaticUserFilter) to context hddsDatanode
datanode_4_1  | 2020-04-17 18:50:28,952 [main] INFO http.HttpServer2: Added filter static_user_filter (class=org.apache.hadoop.hdds.server.http.StaticUserWebFilter$StaticUserFilter) to context static
datanode_4_1  | 2020-04-17 18:50:28,953 [main] INFO http.HttpServer2: Added filter static_user_filter (class=org.apache.hadoop.hdds.server.http.StaticUserWebFilter$StaticUserFilter) to context logs
datanode_4_1  | 2020-04-17 18:50:29,062 [main] WARN http.BaseHttpServer: /prof java profiling servlet is activated. Not safe for production!
datanode_4_1  | 2020-04-17 18:50:29,080 [main] INFO http.HttpServer2: Jetty bound to port 9882
datanode_4_1  | 2020-04-17 18:50:29,086 [main] INFO server.Server: jetty-9.4.26.v20200117; built: 2020-01-17T12:35:33.676Z; git: 7b38981d25d14afb4a12ff1f2596756144edf695; jvm 11.0.6+10-LTS
datanode_4_1  | 2020-04-17 18:50:29,366 [main] INFO server.session: DefaultSessionIdManager workerName=node0
datanode_4_1  | 2020-04-17 18:50:29,387 [main] INFO server.session: No SessionScavenger set, using defaults
datanode_4_1  | 2020-04-17 18:50:29,389 [main] INFO server.session: node0 Scavenging every 660000ms
datanode_4_1  | 2020-04-17 18:50:29,504 [main] INFO handler.ContextHandler: Started o.e.j.s.ServletContextHandler@367f0121{logs,/logs,file:///var/log/hadoop/,AVAILABLE}
datanode_4_1  | 2020-04-17 18:50:29,505 [main] INFO handler.ContextHandler: Started o.e.j.s.ServletContextHandler@2aaf152b{static,/static,jar:file:/opt/hadoop/share/ozone/lib/hadoop-hdds-container-service-0.6.0-SNAPSHOT.jar!/webapps/static,AVAILABLE}
datanode_4_1  | 2020-04-17 18:50:30,010 [main] INFO handler.ContextHandler: Started o.e.j.w.WebAppContext@340d6d89{hddsDatanode,/,file:///tmp/jetty-0_0_0_0-9882-hadoop-hdds-container-service-0_6_0-SNAPSHOT_jar-_-any-11810608197836059000.dir/webapp/,AVAILABLE}{jar:file:/opt/hadoop/share/ozone/lib/hadoop-hdds-container-service-0.6.0-SNAPSHOT.jar!/webapps/hddsDatanode}
datanode_4_1  | 2020-04-17 18:50:30,108 [main] INFO server.AbstractConnector: Started ServerConnector@433c6abb{HTTP/1.1,[http/1.1]}{0.0.0.0:9882}
datanode_4_1  | 2020-04-17 18:50:30,108 [main] INFO server.Server: Started @22657ms
datanode_4_1  | 2020-04-17 18:50:30,131 [main] INFO impl.MetricsSinkAdapter: Sink prometheus started
datanode_4_1  | 2020-04-17 18:50:30,131 [main] INFO impl.MetricsSystemImpl: Registered sink prometheus
datanode_4_1  | 2020-04-17 18:50:30,141 [main] INFO http.BaseHttpServer: HTTP server of hddsDatanode listening at http://0.0.0.0:9882
datanode_4_1  | 2020-04-17 18:50:30,233 [org.apache.hadoop.util.JvmPauseMonitor$Monitor@51b372cb] INFO util.JvmPauseMonitor: Starting JVM pause monitor
datanode_4_1  | 2020-04-17 18:50:31,303 [Datanode State Machine Thread - 0] INFO datanode.InitDatanodeState: DatanodeDetails is persisted to /data/datanode.id
datanode_4_1  | 2020-04-17 18:50:33,469 [Datanode State Machine Thread - 0] INFO ipc.Client: Retrying connect to server: scm/10.5.0.71:9861. Already tried 0 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=2147483647, sleepTime=1000 MILLISECONDS)
datanode_4_1  | 2020-04-17 18:50:34,470 [Datanode State Machine Thread - 0] INFO ipc.Client: Retrying connect to server: scm/10.5.0.71:9861. Already tried 1 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=2147483647, sleepTime=1000 MILLISECONDS)
datanode_4_1  | 2020-04-17 18:50:35,471 [Datanode State Machine Thread - 0] INFO ipc.Client: Retrying connect to server: scm/10.5.0.71:9861. Already tried 2 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=2147483647, sleepTime=1000 MILLISECONDS)
datanode_4_1  | 2020-04-17 18:50:36,503 [Datanode State Machine Thread - 0] WARN statemachine.EndpointStateMachine: Unable to communicate to SCM server at scm:9861 for past 0 seconds.
datanode_4_1  | java.net.SocketTimeoutException: Call From cea2015b57a1/10.5.0.7 to scm:9861 failed on socket timeout exception: java.net.SocketTimeoutException: 1000 millis timeout while waiting for channel to be ready for read. ch : java.nio.channels.SocketChannel[connected local=/10.5.0.7:50998 remote=scm/10.5.0.71:9861]; For more details see:  http://wiki.apache.org/hadoop/SocketTimeout
datanode_5_1  | 2020-04-17 18:50:49,440 [978c057e-5c38-4e20-8a8b-f271c823af7e@group-D621A9FFD9B9-SegmentedRaftLogWorker] INFO segmented.SegmentedRaftLogWorker: 978c057e-5c38-4e20-8a8b-f271c823af7e@group-D621A9FFD9B9-SegmentedRaftLogWorker: created new log segment /data/metadata/ratis/aed8cd39-62be-40dc-818c-d621a9ffd9b9/current/log_inprogress_0
datanode_5_1  | 2020-04-17 18:50:49,459 [978c057e-5c38-4e20-8a8b-f271c823af7e@group-D621A9FFD9B9-LeaderElection1] INFO impl.RaftServerImpl: 978c057e-5c38-4e20-8a8b-f271c823af7e@group-D621A9FFD9B9: set configuration 0: [978c057e-5c38-4e20-8a8b-f271c823af7e:10.5.0.8:9858], old=null at 0
datanode_5_1  | 2020-04-17 18:50:58,726 [ChunkWriter-12-0] INFO keyvalue.KeyValueHandler: Operation: CreateContainer , Trace ID: e215c60bfe250702:7a34a8519fdccc42:e215c60bfe250702:0 , Message: Container creation failed, due to disk out of space , Result: DISK_OUT_OF_SPACE , StorageContainerException Occurred.
datanode_5_1  | org.apache.hadoop.hdds.scm.container.common.helpers.StorageContainerException: Container creation failed, due to disk out of space
datanode_5_1  | 	at org.apache.hadoop.ozone.container.keyvalue.KeyValueContainer.create(KeyValueContainer.java:165)
datanode_5_1  | 	at org.apache.hadoop.ozone.container.keyvalue.KeyValueHandler.handleCreateContainer(KeyValueHandler.java:247)
datanode_5_1  | 	at org.apache.hadoop.ozone.container.keyvalue.KeyValueHandler.dispatchRequest(KeyValueHandler.java:164)
datanode_5_1  | 	at org.apache.hadoop.ozone.container.keyvalue.KeyValueHandler.handle(KeyValueHandler.java:152)
datanode_5_1  | 	at org.apache.hadoop.ozone.container.common.impl.HddsDispatcher.createContainer(HddsDispatcher.java:414)
datanode_5_1  | 	at org.apache.hadoop.ozone.container.common.impl.HddsDispatcher.dispatchRequest(HddsDispatcher.java:250)
datanode_5_1  | 	at org.apache.hadoop.ozone.container.common.impl.HddsDispatcher.dispatch(HddsDispatcher.java:162)
datanode_5_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.ContainerStateMachine.dispatchCommand(ContainerStateMachine.java:402)
datanode_5_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.ContainerStateMachine.runCommand(ContainerStateMachine.java:412)
datanode_5_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.ContainerStateMachine.lambda$handleWriteChunk$2(ContainerStateMachine.java:447)
datanode_5_1  | 	at java.base/java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1700)
datanode_5_1  | 	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
datanode_5_1  | 	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
datanode_5_1  | 	at java.base/java.lang.Thread.run(Thread.java:834)
datanode_5_1  | Caused by: org.apache.hadoop.util.DiskChecker$DiskOutOfSpaceException: Out of space: The volume with the most available space (=966037504 B) is less than the container size (=1073741824 B).
datanode_5_1  | 	at org.apache.hadoop.ozone.container.common.volume.RoundRobinVolumeChoosingPolicy.chooseVolume(RoundRobinVolumeChoosingPolicy.java:77)
datanode_5_1  | 	at org.apache.hadoop.ozone.container.keyvalue.KeyValueContainer.create(KeyValueContainer.java:124)
datanode_5_1  | 	... 13 more
datanode_5_1  | 2020-04-17 18:50:58,762 [ChunkWriter-12-0] INFO impl.HddsDispatcher: Operation: WriteChunk , Trace ID: e215c60bfe250702:7a34a8519fdccc42:e215c60bfe250702:0 , Message: ContainerID 2 creation failed , Result: DISK_OUT_OF_SPACE , StorageContainerException Occurred.
datanode_5_1  | org.apache.hadoop.hdds.scm.container.common.helpers.StorageContainerException: ContainerID 2 creation failed
datanode_5_1  | 	at org.apache.hadoop.ozone.container.common.impl.HddsDispatcher.dispatchRequest(HddsDispatcher.java:254)
datanode_5_1  | 	at org.apache.hadoop.ozone.container.common.impl.HddsDispatcher.dispatch(HddsDispatcher.java:162)
datanode_5_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.ContainerStateMachine.dispatchCommand(ContainerStateMachine.java:402)
datanode_5_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.ContainerStateMachine.runCommand(ContainerStateMachine.java:412)
datanode_5_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.ContainerStateMachine.lambda$handleWriteChunk$2(ContainerStateMachine.java:447)
datanode_5_1  | 	at java.base/java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1700)
datanode_5_1  | 	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
datanode_5_1  | 	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
datanode_5_1  | 	at java.base/java.lang.Thread.run(Thread.java:834)
datanode_5_1  | 2020-04-17 18:50:58,800 [ChunkWriter-12-0] ERROR ratis.ContainerStateMachine: group-385EF22ED913: writeChunk writeStateMachineData failed: blockIdcontainerID: 2
datanode_5_1  | localID: 104015426885648386
datanode_5_1  | blockCommitSequenceId: 0
datanode_5_1  |  logIndex 1 chunkName 104015426885648386_chunk_1 Error message: ContainerID 2 creation failed Container Result: DISK_OUT_OF_SPACE
datanode_5_1  | 2020-04-17 18:50:58,807 [978c057e-5c38-4e20-8a8b-f271c823af7e@group-385EF22ED913-SegmentedRaftLogWorker] ERROR ratis.XceiverServerRatis: pipeline Action CLOSE on pipeline PipelineID=be26d0dd-802f-4608-9a1c-385ef22ed913.Reason : ContainerID 2 creation failed
datanode_5_1  | 2020-04-17 18:50:58,919 [978c057e-5c38-4e20-8a8b-f271c823af7e@group-385EF22ED913-SegmentedRaftLogWorker] ERROR ratis.XceiverServerRatis: pipeline Action CLOSE on pipeline PipelineID=be26d0dd-802f-4608-9a1c-385ef22ed913.Reason : Log already failed at index 1 for task WriteLog:1: (t:1, i:1), STATEMACHINELOGENTRY, client-884610206644, cid=8
datanode_5_1  | 	 State Machine: cmdType: WriteChunk traceID: "e215c60bfe250702:7a34a8519fdccc42:e215c60bfe250702:0" containerID: 2 datanodeUuid: "0e99e1b0-220f-42bd-a39f-d4658f80d0e4" pipelineID: "be26d0dd-802f-4608-9a1c-385ef22ed913" writeChunk { blockID { containerID: 2 localID: 104015426885648386 blockCommitSequenceId: 0 } chunkData { chunkName: "104015426885648386_chunk_1" offset: 0 len: 10240 checksumData { type: CRC32 bytesPerChecksum: 1048576 checksums: ">\344\315\231" } } }, container path=nonexistent
datanode_5_1  | 2020-04-17 18:51:15,149 [Command processor thread] ERROR commandhandler.CloseContainerCommandHandler: Container #2 does not exist in datanode. Container close failed.
datanode_5_1  | 2020-04-17 18:52:29,914 [Command processor thread] INFO impl.RaftServerProxy: 978c057e-5c38-4e20-8a8b-f271c823af7e: remove  FOLLOWER 978c057e-5c38-4e20-8a8b-f271c823af7e@group-385EF22ED913:t1, leader=a0acbcec-d753-414c-b077-647d02aaa7fb, voted=a0acbcec-d753-414c-b077-647d02aaa7fb, raftlog=978c057e-5c38-4e20-8a8b-f271c823af7e@group-385EF22ED913-SegmentedRaftLog:OPENED:c0,f0,i2, conf=0: [978c057e-5c38-4e20-8a8b-f271c823af7e:10.5.0.8:9858, a0acbcec-d753-414c-b077-647d02aaa7fb:10.5.0.7:9858, 0e99e1b0-220f-42bd-a39f-d4658f80d0e4:10.5.0.5:9858], old=null RUNNING
datanode_5_1  | 2020-04-17 18:52:29,915 [Command processor thread] INFO impl.RaftServerImpl: 978c057e-5c38-4e20-8a8b-f271c823af7e@group-385EF22ED913: shutdown
datanode_5_1  | 2020-04-17 18:52:29,915 [Command processor thread] INFO util.JmxRegister: Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-385EF22ED913,id=978c057e-5c38-4e20-8a8b-f271c823af7e
datanode_5_1  | 2020-04-17 18:52:29,916 [Command processor thread] INFO impl.RoleInfo: 978c057e-5c38-4e20-8a8b-f271c823af7e: shutdown FollowerState
datanode_5_1  | 2020-04-17 18:52:29,916 [Thread-29] INFO impl.FollowerState: 978c057e-5c38-4e20-8a8b-f271c823af7e@group-385EF22ED913-FollowerState was interrupted: java.lang.InterruptedException: sleep interrupted
datanode_5_1  | 2020-04-17 18:52:29,916 [Command processor thread] INFO impl.StateMachineUpdater: 978c057e-5c38-4e20-8a8b-f271c823af7e@group-385EF22ED913-StateMachineUpdater: set stopIndex = 0
datanode_5_1  | 2020-04-17 18:52:29,919 [978c057e-5c38-4e20-8a8b-f271c823af7e@group-385EF22ED913-StateMachineUpdater] ERROR ratis.ContainerStateMachine: Failed to take snapshot  for group-385EF22ED913 as the stateMachine is unhealthy. The last applied index is at (t:1, i:0)
datanode_4_1  | 	at java.base/jdk.internal.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
datanode_4_1  | 	at java.base/jdk.internal.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
datanode_4_1  | 	at java.base/jdk.internal.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
datanode_4_1  | 	at java.base/java.lang.reflect.Constructor.newInstance(Constructor.java:490)
datanode_4_1  | 	at org.apache.hadoop.net.NetUtils.wrapWithMessage(NetUtils.java:831)
datanode_4_1  | 	at org.apache.hadoop.net.NetUtils.wrapException(NetUtils.java:775)
datanode_4_1  | 	at org.apache.hadoop.ipc.Client.getRpcResponse(Client.java:1515)
datanode_4_1  | 	at org.apache.hadoop.ipc.Client.call(Client.java:1457)
datanode_4_1  | 	at org.apache.hadoop.ipc.Client.call(Client.java:1367)
datanode_4_1  | 	at org.apache.hadoop.ipc.ProtobufRpcEngine$Invoker.invoke(ProtobufRpcEngine.java:228)
datanode_4_1  | 	at org.apache.hadoop.ipc.ProtobufRpcEngine$Invoker.invoke(ProtobufRpcEngine.java:116)
datanode_4_1  | 	at com.sun.proxy.$Proxy39.submitRequest(Unknown Source)
datanode_4_1  | 	at org.apache.hadoop.ozone.protocolPB.StorageContainerDatanodeProtocolClientSideTranslatorPB.submitRequest(StorageContainerDatanodeProtocolClientSideTranslatorPB.java:116)
datanode_4_1  | 	at org.apache.hadoop.ozone.protocolPB.StorageContainerDatanodeProtocolClientSideTranslatorPB.getVersion(StorageContainerDatanodeProtocolClientSideTranslatorPB.java:132)
datanode_4_1  | 	at org.apache.hadoop.ozone.container.common.states.endpoint.VersionEndpointTask.call(VersionEndpointTask.java:71)
datanode_4_1  | 	at org.apache.hadoop.ozone.container.common.states.endpoint.VersionEndpointTask.call(VersionEndpointTask.java:42)
datanode_4_1  | 	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
datanode_4_1  | 	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
datanode_4_1  | 	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
datanode_4_1  | 	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
datanode_4_1  | 	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
datanode_4_1  | 	at java.base/java.lang.Thread.run(Thread.java:834)
datanode_4_1  | Caused by: java.net.SocketTimeoutException: 1000 millis timeout while waiting for channel to be ready for read. ch : java.nio.channels.SocketChannel[connected local=/10.5.0.7:50998 remote=scm/10.5.0.71:9861]
datanode_4_1  | 	at org.apache.hadoop.net.SocketIOWithTimeout.doIO(SocketIOWithTimeout.java:164)
datanode_4_1  | 	at org.apache.hadoop.net.SocketInputStream.read(SocketInputStream.java:161)
datanode_4_1  | 	at org.apache.hadoop.net.SocketInputStream.read(SocketInputStream.java:131)
datanode_4_1  | 	at java.base/java.io.FilterInputStream.read(FilterInputStream.java:133)
datanode_4_1  | 	at java.base/java.io.BufferedInputStream.fill(BufferedInputStream.java:252)
datanode_4_1  | 	at java.base/java.io.BufferedInputStream.read(BufferedInputStream.java:271)
datanode_4_1  | 	at java.base/java.io.FilterInputStream.read(FilterInputStream.java:83)
datanode_4_1  | 	at java.base/java.io.FilterInputStream.read(FilterInputStream.java:83)
datanode_4_1  | 	at org.apache.hadoop.ipc.Client$Connection$PingInputStream.read(Client.java:557)
datanode_4_1  | 	at java.base/java.io.DataInputStream.readInt(DataInputStream.java:392)
datanode_4_1  | 	at org.apache.hadoop.ipc.Client$IpcStreams.readResponse(Client.java:1816)
datanode_4_1  | 	at org.apache.hadoop.ipc.Client$Connection.receiveRpcResponse(Client.java:1173)
datanode_4_1  | 	at org.apache.hadoop.ipc.Client$Connection.run(Client.java:1069)
datanode_4_1  | 2020-04-17 18:50:36,755 [Datanode State Machine Thread - 1] INFO ozoneimpl.OzoneContainer: Attempting to start container services.
datanode_4_1  | 2020-04-17 18:50:36,756 [Datanode State Machine Thread - 1] INFO ozoneimpl.OzoneContainer: Background container scanner has been disabled.
datanode_4_1  | 2020-04-17 18:50:36,756 [Datanode State Machine Thread - 1] INFO ratis.XceiverServerRatis: Starting XceiverServerRatis a0acbcec-d753-414c-b077-647d02aaa7fb at port 9858
datanode_4_1  | 2020-04-17 18:50:36,877 [Datanode State Machine Thread - 1] INFO impl.RaftServerProxy: a0acbcec-d753-414c-b077-647d02aaa7fb: start RPC server
datanode_4_1  | 2020-04-17 18:50:37,354 [Datanode State Machine Thread - 1] INFO server.GrpcService: a0acbcec-d753-414c-b077-647d02aaa7fb: GrpcService started, listening on 0.0.0.0/0.0.0.0:9858
datanode_4_1  | 2020-04-17 18:50:41,369 [Command processor thread] INFO impl.RaftServerProxy: a0acbcec-d753-414c-b077-647d02aaa7fb: addNew group-51477CB1F421:[a0acbcec-d753-414c-b077-647d02aaa7fb:10.5.0.7:9858] returns group-51477CB1F421:java.util.concurrent.CompletableFuture@23415121[Not completed]
datanode_4_1  | 2020-04-17 18:50:41,430 [pool-69-thread-1] INFO impl.RaftServerImpl: a0acbcec-d753-414c-b077-647d02aaa7fb: new RaftServerImpl for group-51477CB1F421:[a0acbcec-d753-414c-b077-647d02aaa7fb:10.5.0.7:9858] with ContainerStateMachine:uninitialized
datanode_4_1  | 2020-04-17 18:50:41,436 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.rpc.timeout.min = 5s (custom)
datanode_4_1  | 2020-04-17 18:50:41,446 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.rpc.timeout.max = 5200ms (custom)
datanode_4_1  | 2020-04-17 18:50:41,446 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.rpcslowness.timeout = 300s (custom)
datanode_4_1  | 2020-04-17 18:50:41,446 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.sleep.deviation.threshold = 300 (default)
datanode_4_1  | 2020-04-17 18:50:41,452 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.appender.install.snapshot.enabled = false (custom)
datanode_4_1  | 2020-04-17 18:50:41,498 [pool-69-thread-1] INFO impl.RaftServerImpl: a0acbcec-d753-414c-b077-647d02aaa7fb@group-51477CB1F421: ConfigurationManager, init=-1: [a0acbcec-d753-414c-b077-647d02aaa7fb:10.5.0.7:9858], old=null, confs=<EMPTY_MAP>
datanode_4_1  | 2020-04-17 18:50:41,513 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.storage.dir = [/data/metadata/ratis] (custom)
datanode_4_1  | 2020-04-17 18:50:41,538 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.corruption.policy = EXCEPTION (default)
datanode_4_1  | 2020-04-17 18:50:41,550 [pool-69-thread-1] INFO storage.RaftStorageDirectory: The storage directory /data/metadata/ratis/f9d10128-1d59-4577-ad6c-51477cb1f421 does not exist. Creating ...
datanode_4_1  | 2020-04-17 18:50:41,599 [pool-69-thread-1] INFO storage.RaftStorageDirectory: Lock on /data/metadata/ratis/f9d10128-1d59-4577-ad6c-51477cb1f421/in_use.lock acquired by nodename 6@cea2015b57a1
datanode_4_1  | 2020-04-17 18:50:41,607 [pool-69-thread-1] INFO storage.RaftStorage: Storage directory /data/metadata/ratis/f9d10128-1d59-4577-ad6c-51477cb1f421 has been successfully formatted.
datanode_4_1  | 2020-04-17 18:50:41,633 [pool-69-thread-1] INFO ratis.ContainerStateMachine: group-51477CB1F421: The snapshot info is null. Setting the last applied indexto:(t:0, i:~)
datanode_4_1  | 2020-04-17 18:50:41,635 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.notification.no-leader.timeout = 60s (default)
datanode_4_1  | 2020-04-17 18:50:41,644 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.use.memory = false (default)
datanode_4_1  | 2020-04-17 18:50:41,679 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.purge.gap = 1000000 (custom)
datanode_4_1  | 2020-04-17 18:50:41,679 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
datanode_4_1  | 2020-04-17 18:50:41,681 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.segment.size.max = 1048576 (custom)
datanode_4_1  | 2020-04-17 18:50:41,720 [pool-69-thread-1] INFO metrics.RatisMetrics: Creating Metrics Registry : ratis.log_worker.a0acbcec-d753-414c-b077-647d02aaa7fb
datanode_4_1  | 2020-04-17 18:50:41,806 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.segment.cache.num.max = 2 (custom)
datanode_5_1  | 2020-04-17 18:52:29,919 [978c057e-5c38-4e20-8a8b-f271c823af7e@group-385EF22ED913-StateMachineUpdater] ERROR impl.StateMachineUpdater: 978c057e-5c38-4e20-8a8b-f271c823af7e@group-385EF22ED913-StateMachineUpdater: Failed to take snapshot
datanode_5_1  | org.apache.ratis.protocol.StateMachineException: Failed to take snapshot  for group-385EF22ED913 as the stateMachine is unhealthy. The last applied index is at (t:1, i:0)
datanode_5_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.ContainerStateMachine.takeSnapshot(ContainerStateMachine.java:288)
datanode_5_1  | 	at org.apache.ratis.server.impl.StateMachineUpdater.takeSnapshot(StateMachineUpdater.java:258)
datanode_5_1  | 	at org.apache.ratis.server.impl.StateMachineUpdater.checkAndTakeSnapshot(StateMachineUpdater.java:250)
datanode_5_1  | 	at org.apache.ratis.server.impl.StateMachineUpdater.run(StateMachineUpdater.java:169)
datanode_5_1  | 	at java.base/java.lang.Thread.run(Thread.java:834)
datanode_5_1  | 2020-04-17 18:52:29,920 [978c057e-5c38-4e20-8a8b-f271c823af7e@group-385EF22ED913-StateMachineUpdater] ERROR ratis.ContainerStateMachine: Failed to take snapshot  for group-385EF22ED913 as the stateMachine is unhealthy. The last applied index is at (t:1, i:0)
datanode_5_1  | 2020-04-17 18:52:29,920 [978c057e-5c38-4e20-8a8b-f271c823af7e@group-385EF22ED913-StateMachineUpdater] ERROR impl.StateMachineUpdater: 978c057e-5c38-4e20-8a8b-f271c823af7e@group-385EF22ED913-StateMachineUpdater: Failed to take snapshot
datanode_5_1  | org.apache.ratis.protocol.StateMachineException: Failed to take snapshot  for group-385EF22ED913 as the stateMachine is unhealthy. The last applied index is at (t:1, i:0)
datanode_5_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.ContainerStateMachine.takeSnapshot(ContainerStateMachine.java:288)
datanode_5_1  | 	at org.apache.ratis.server.impl.StateMachineUpdater.takeSnapshot(StateMachineUpdater.java:258)
datanode_5_1  | 	at org.apache.ratis.server.impl.StateMachineUpdater.checkAndTakeSnapshot(StateMachineUpdater.java:250)
datanode_5_1  | 	at org.apache.ratis.server.impl.StateMachineUpdater.run(StateMachineUpdater.java:172)
datanode_5_1  | 	at java.base/java.lang.Thread.run(Thread.java:834)
datanode_5_1  | 2020-04-17 18:52:29,921 [978c057e-5c38-4e20-8a8b-f271c823af7e@group-385EF22ED913-StateMachineUpdater] INFO metrics.RatisMetrics: Unregistering Metrics Registry : ratis.state_machine.978c057e-5c38-4e20-8a8b-f271c823af7e@group-385EF22ED913
datanode_5_1  | 2020-04-17 18:52:29,924 [Command processor thread] INFO impl.RaftServerImpl: 978c057e-5c38-4e20-8a8b-f271c823af7e@group-385EF22ED913: closes. applyIndex: 0
datanode_5_1  | 2020-04-17 18:52:29,925 [978c057e-5c38-4e20-8a8b-f271c823af7e@group-385EF22ED913-SegmentedRaftLogWorker] INFO segmented.SegmentedRaftLogWorker: 978c057e-5c38-4e20-8a8b-f271c823af7e@group-385EF22ED913-SegmentedRaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
datanode_5_1  | 2020-04-17 18:52:29,926 [Command processor thread] INFO segmented.SegmentedRaftLogWorker: 978c057e-5c38-4e20-8a8b-f271c823af7e@group-385EF22ED913-SegmentedRaftLogWorker close()
datanode_5_1  | 2020-04-17 18:52:29,926 [Command processor thread] INFO metrics.RatisMetrics: Unregistering Metrics Registry : ratis.log_worker.978c057e-5c38-4e20-8a8b-f271c823af7e
datanode_5_1  | 2020-04-17 18:52:29,926 [Command processor thread] INFO metrics.RatisMetrics: Unregistering Metrics Registry : ratis.leader_election.978c057e-5c38-4e20-8a8b-f271c823af7e@group-385EF22ED913
datanode_5_1  | 2020-04-17 18:52:29,926 [Command processor thread] INFO metrics.RatisMetrics: Unregistering Metrics Registry : ratis.server.978c057e-5c38-4e20-8a8b-f271c823af7e@group-385EF22ED913
datanode_5_1  | 2020-04-17 18:52:29,929 [Command processor thread] INFO commandhandler.ClosePipelineCommandHandler: Close Pipeline #id: "be26d0dd-802f-4608-9a1c-385ef22ed913"
datanode_5_1  |  command on datanode #978c057e-5c38-4e20-8a8b-f271c823af7e.
datanode_5_1  | 2020-04-17 18:52:29,932 [pool-69-thread-1] INFO impl.RaftServerImpl: 978c057e-5c38-4e20-8a8b-f271c823af7e: new RaftServerImpl for group-79E0035D853A:[978c057e-5c38-4e20-8a8b-f271c823af7e:10.5.0.8:9858, a0acbcec-d753-414c-b077-647d02aaa7fb:10.5.0.7:9858, 0e99e1b0-220f-42bd-a39f-d4658f80d0e4:10.5.0.5:9858] with ContainerStateMachine:uninitialized
datanode_5_1  | 2020-04-17 18:52:29,932 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.rpc.timeout.min = 5s (custom)
datanode_5_1  | 2020-04-17 18:52:29,933 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.rpc.timeout.max = 5200ms (custom)
datanode_5_1  | 2020-04-17 18:52:29,933 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.rpcslowness.timeout = 300s (custom)
datanode_5_1  | 2020-04-17 18:52:29,933 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.sleep.deviation.threshold = 300 (default)
datanode_5_1  | 2020-04-17 18:52:29,933 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.appender.install.snapshot.enabled = false (custom)
datanode_5_1  | 2020-04-17 18:52:29,933 [pool-69-thread-1] INFO impl.RaftServerImpl: 978c057e-5c38-4e20-8a8b-f271c823af7e@group-79E0035D853A: ConfigurationManager, init=-1: [978c057e-5c38-4e20-8a8b-f271c823af7e:10.5.0.8:9858, a0acbcec-d753-414c-b077-647d02aaa7fb:10.5.0.7:9858, 0e99e1b0-220f-42bd-a39f-d4658f80d0e4:10.5.0.5:9858], old=null, confs=<EMPTY_MAP>
datanode_5_1  | 2020-04-17 18:52:29,933 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.storage.dir = [/data/metadata/ratis] (custom)
datanode_5_1  | 2020-04-17 18:52:29,934 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.corruption.policy = EXCEPTION (default)
datanode_5_1  | 2020-04-17 18:52:29,934 [pool-69-thread-1] INFO storage.RaftStorageDirectory: The storage directory /data/metadata/ratis/cad403d1-ea2f-4530-84e5-79e0035d853a does not exist. Creating ...
datanode_5_1  | 2020-04-17 18:52:29,934 [Command processor thread] INFO impl.RaftServerProxy: 978c057e-5c38-4e20-8a8b-f271c823af7e: addNew group-79E0035D853A:[978c057e-5c38-4e20-8a8b-f271c823af7e:10.5.0.8:9858, a0acbcec-d753-414c-b077-647d02aaa7fb:10.5.0.7:9858, 0e99e1b0-220f-42bd-a39f-d4658f80d0e4:10.5.0.5:9858] returns group-79E0035D853A:java.util.concurrent.CompletableFuture@5a07f603[Not completed]
datanode_5_1  | 2020-04-17 18:52:29,935 [pool-69-thread-1] INFO storage.RaftStorageDirectory: Lock on /data/metadata/ratis/cad403d1-ea2f-4530-84e5-79e0035d853a/in_use.lock acquired by nodename 6@650579c681b3
datanode_5_1  | 2020-04-17 18:52:29,937 [pool-69-thread-1] INFO storage.RaftStorage: Storage directory /data/metadata/ratis/cad403d1-ea2f-4530-84e5-79e0035d853a has been successfully formatted.
datanode_5_1  | 2020-04-17 18:52:29,937 [pool-69-thread-1] INFO ratis.ContainerStateMachine: group-79E0035D853A: The snapshot info is null. Setting the last applied indexto:(t:0, i:~)
datanode_5_1  | 2020-04-17 18:52:29,938 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.notification.no-leader.timeout = 60s (default)
datanode_5_1  | 2020-04-17 18:52:29,938 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.use.memory = false (default)
datanode_5_1  | 2020-04-17 18:52:29,938 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.purge.gap = 1000000 (custom)
datanode_5_1  | 2020-04-17 18:52:29,938 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
datanode_5_1  | 2020-04-17 18:52:29,938 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.segment.size.max = 1048576 (custom)
datanode_5_1  | 2020-04-17 18:52:29,938 [pool-69-thread-1] INFO metrics.RatisMetrics: Creating Metrics Registry : ratis.log_worker.978c057e-5c38-4e20-8a8b-f271c823af7e
datanode_5_1  | 2020-04-17 18:52:29,938 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.segment.cache.num.max = 2 (custom)
datanode_5_1  | 2020-04-17 18:52:29,938 [pool-69-thread-1] INFO segmented.SegmentedRaftLogWorker: new 978c057e-5c38-4e20-8a8b-f271c823af7e@group-79E0035D853A-SegmentedRaftLogWorker for RaftStorage:Storage Directory /data/metadata/ratis/cad403d1-ea2f-4530-84e5-79e0035d853a
datanode_5_1  | 2020-04-17 18:52:29,938 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.queue.byte-limit = 2147483647 (custom)
datanode_2_1  | 2020-04-17 18:53:58,418 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.segment.size.max = 1048576 (custom)
datanode_2_1  | 2020-04-17 18:53:58,418 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.preallocated.size = 16384 (custom)
datanode_2_1  | 2020-04-17 18:53:58,418 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.write.buffer.size = 1048576 (custom)
datanode_2_1  | 2020-04-17 18:53:58,418 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.force.sync.num = 128 (default)
datanode_2_1  | 2020-04-17 18:53:58,418 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.statemachine.data.sync = true (default)
datanode_2_1  | 2020-04-17 18:53:58,419 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.statemachine.data.sync.timeout = 10s (default)
datanode_2_1  | 2020-04-17 18:53:58,422 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
datanode_2_1  | 2020-04-17 18:53:58,424 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.statemachine.data.caching.enabled = true (custom)
datanode_2_1  | 2020-04-17 18:53:58,424 [pool-69-thread-1] INFO segmented.SegmentedRaftLogWorker: 0e99e1b0-220f-42bd-a39f-d4658f80d0e4@group-CFD51574C841-SegmentedRaftLogWorker: flushIndex: setUnconditionally 0 -> -1
datanode_2_1  | 2020-04-17 18:53:58,429 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.snapshot.auto.trigger.enabled = true (custom)
datanode_2_1  | 2020-04-17 18:53:58,430 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
datanode_2_1  | 2020-04-17 18:53:58,431 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.snapshot.retention.file.num = 5 (custom)
datanode_2_1  | 2020-04-17 18:53:58,431 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.retrycache.expirytime = 600000ms (custom)
datanode_2_1  | 2020-04-17 18:53:58,432 [pool-69-thread-1] INFO metrics.RatisMetrics: Creating Metrics Registry : ratis.leader_election.0e99e1b0-220f-42bd-a39f-d4658f80d0e4@group-CFD51574C841
datanode_2_1  | 2020-04-17 18:53:58,432 [pool-69-thread-1] INFO metrics.RatisMetrics: Creating Metrics Registry : ratis.server.0e99e1b0-220f-42bd-a39f-d4658f80d0e4@group-CFD51574C841
datanode_2_1  | 2020-04-17 18:53:58,433 [pool-69-thread-1] INFO impl.RaftServerImpl: 0e99e1b0-220f-42bd-a39f-d4658f80d0e4@group-CFD51574C841: start as a follower, conf=-1: [978c057e-5c38-4e20-8a8b-f271c823af7e:10.5.0.8:9858, 79669a1f-2445-496e-a337-3115205f3ae5:10.5.0.9:9858, 0e99e1b0-220f-42bd-a39f-d4658f80d0e4:10.5.0.5:9858], old=null
datanode_2_1  | 2020-04-17 18:53:58,434 [pool-69-thread-1] INFO impl.RaftServerImpl: 0e99e1b0-220f-42bd-a39f-d4658f80d0e4@group-CFD51574C841: changes role from      null to FOLLOWER at term 0 for startAsFollower
datanode_2_1  | 2020-04-17 18:53:58,435 [pool-69-thread-1] INFO impl.RoleInfo: 0e99e1b0-220f-42bd-a39f-d4658f80d0e4: start FollowerState
datanode_2_1  | 2020-04-17 18:53:58,437 [pool-69-thread-1] INFO util.JmxRegister: Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-CFD51574C841,id=0e99e1b0-220f-42bd-a39f-d4658f80d0e4
datanode_2_1  | 2020-04-17 18:53:58,438 [pool-69-thread-1] INFO metrics.RatisMetrics: Creating Metrics Registry : ratis.state_machine.0e99e1b0-220f-42bd-a39f-d4658f80d0e4@group-CFD51574C841
datanode_2_1  | 2020-04-17 18:54:03,463 [Thread-127] INFO impl.FollowerState: 0e99e1b0-220f-42bd-a39f-d4658f80d0e4@group-CFD51574C841-FollowerState: change to CANDIDATE, lastRpcTime:5028ms, electionTimeout:5025ms
datanode_2_1  | 2020-04-17 18:54:03,464 [Thread-127] INFO impl.RoleInfo: 0e99e1b0-220f-42bd-a39f-d4658f80d0e4: shutdown FollowerState
datanode_2_1  | 2020-04-17 18:54:03,464 [Thread-127] INFO impl.RaftServerImpl: 0e99e1b0-220f-42bd-a39f-d4658f80d0e4@group-CFD51574C841: changes role from  FOLLOWER to CANDIDATE at term 0 for changeToCandidate
datanode_2_1  | 2020-04-17 18:54:03,464 [Thread-127] INFO impl.RoleInfo: 0e99e1b0-220f-42bd-a39f-d4658f80d0e4: start LeaderElection
datanode_2_1  | 2020-04-17 18:54:03,467 [0e99e1b0-220f-42bd-a39f-d4658f80d0e4@group-CFD51574C841-LeaderElection2] INFO impl.LeaderElection: 0e99e1b0-220f-42bd-a39f-d4658f80d0e4@group-CFD51574C841-LeaderElection2: begin an election at term 1 for -1: [978c057e-5c38-4e20-8a8b-f271c823af7e:10.5.0.8:9858, 79669a1f-2445-496e-a337-3115205f3ae5:10.5.0.9:9858, 0e99e1b0-220f-42bd-a39f-d4658f80d0e4:10.5.0.5:9858], old=null
datanode_2_1  | 2020-04-17 18:54:03,512 [0e99e1b0-220f-42bd-a39f-d4658f80d0e4@group-CFD51574C841-LeaderElection2] INFO impl.LeaderElection: 0e99e1b0-220f-42bd-a39f-d4658f80d0e4@group-CFD51574C841-LeaderElection2: Election PASSED; received 1 response(s) [0e99e1b0-220f-42bd-a39f-d4658f80d0e4<-978c057e-5c38-4e20-8a8b-f271c823af7e#0:OK-t1] and 0 exception(s); 0e99e1b0-220f-42bd-a39f-d4658f80d0e4@group-CFD51574C841:t1, leader=null, voted=0e99e1b0-220f-42bd-a39f-d4658f80d0e4, raftlog=0e99e1b0-220f-42bd-a39f-d4658f80d0e4@group-CFD51574C841-SegmentedRaftLog:OPENED:c-1,f-1,i0, conf=-1: [978c057e-5c38-4e20-8a8b-f271c823af7e:10.5.0.8:9858, 79669a1f-2445-496e-a337-3115205f3ae5:10.5.0.9:9858, 0e99e1b0-220f-42bd-a39f-d4658f80d0e4:10.5.0.5:9858], old=null
datanode_2_1  | 2020-04-17 18:54:03,513 [0e99e1b0-220f-42bd-a39f-d4658f80d0e4@group-CFD51574C841-LeaderElection2] INFO impl.RoleInfo: 0e99e1b0-220f-42bd-a39f-d4658f80d0e4: shutdown LeaderElection
datanode_2_1  | 2020-04-17 18:54:03,514 [0e99e1b0-220f-42bd-a39f-d4658f80d0e4@group-CFD51574C841-LeaderElection2] INFO impl.RaftServerImpl: 0e99e1b0-220f-42bd-a39f-d4658f80d0e4@group-CFD51574C841: changes role from CANDIDATE to LEADER at term 1 for changeToLeader
datanode_2_1  | 2020-04-17 18:54:03,514 [0e99e1b0-220f-42bd-a39f-d4658f80d0e4@group-CFD51574C841-LeaderElection2] INFO ratis.XceiverServerRatis: Leader change notification received for group: group-CFD51574C841 with new leaderId: 0e99e1b0-220f-42bd-a39f-d4658f80d0e4
datanode_2_1  | 2020-04-17 18:54:03,514 [0e99e1b0-220f-42bd-a39f-d4658f80d0e4@group-CFD51574C841-LeaderElection2] INFO impl.RaftServerImpl: 0e99e1b0-220f-42bd-a39f-d4658f80d0e4@group-CFD51574C841: change Leader from null to 0e99e1b0-220f-42bd-a39f-d4658f80d0e4 at term 1 for becomeLeader, leader elected after 5098ms
datanode_2_1  | 2020-04-17 18:54:03,514 [0e99e1b0-220f-42bd-a39f-d4658f80d0e4@group-CFD51574C841-LeaderElection2] INFO server.RaftServerConfigKeys: raft.server.staging.catchup.gap = 1000 (default)
datanode_2_1  | 2020-04-17 18:54:03,515 [0e99e1b0-220f-42bd-a39f-d4658f80d0e4@group-CFD51574C841-LeaderElection2] INFO server.RaftServerConfigKeys: raft.server.rpc.sleep.time = 25ms (default)
datanode_2_1  | 2020-04-17 18:54:03,515 [0e99e1b0-220f-42bd-a39f-d4658f80d0e4@group-CFD51574C841-LeaderElection2] INFO metrics.RatisMetrics: Creating Metrics Registry : ratis.log_appender.0e99e1b0-220f-42bd-a39f-d4658f80d0e4@group-CFD51574C841
datanode_2_1  | 2020-04-17 18:54:03,515 [0e99e1b0-220f-42bd-a39f-d4658f80d0e4@group-CFD51574C841-LeaderElection2] INFO server.RaftServerConfigKeys: raft.server.write.element-limit = 1024 (custom)
datanode_2_1  | 2020-04-17 18:54:03,515 [0e99e1b0-220f-42bd-a39f-d4658f80d0e4@group-CFD51574C841-LeaderElection2] INFO server.RaftServerConfigKeys: raft.server.write.byte-limit = 1073741824 (custom)
datanode_2_1  | 2020-04-17 18:54:03,516 [0e99e1b0-220f-42bd-a39f-d4658f80d0e4@group-CFD51574C841-LeaderElection2] INFO server.RaftServerConfigKeys: raft.server.watch.timeout = 180s (custom)
datanode_2_1  | 2020-04-17 18:54:03,516 [0e99e1b0-220f-42bd-a39f-d4658f80d0e4@group-CFD51574C841-LeaderElection2] INFO server.RaftServerConfigKeys: raft.server.watch.timeout.denomination = 1s (default)
datanode_2_1  | 2020-04-17 18:54:03,516 [0e99e1b0-220f-42bd-a39f-d4658f80d0e4@group-CFD51574C841-LeaderElection2] INFO server.RaftServerConfigKeys: raft.server.watch.element-limit = 65536 (default)
datanode_2_1  | 2020-04-17 18:54:03,519 [0e99e1b0-220f-42bd-a39f-d4658f80d0e4@group-CFD51574C841-LeaderElection2] INFO server.RaftServerConfigKeys: raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
datanode_4_1  | 2020-04-17 18:50:41,857 [pool-69-thread-1] INFO segmented.SegmentedRaftLogWorker: new a0acbcec-d753-414c-b077-647d02aaa7fb@group-51477CB1F421-SegmentedRaftLogWorker for RaftStorage:Storage Directory /data/metadata/ratis/f9d10128-1d59-4577-ad6c-51477cb1f421
datanode_4_1  | 2020-04-17 18:50:41,867 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.queue.byte-limit = 2147483647 (custom)
datanode_4_1  | 2020-04-17 18:50:41,879 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.queue.element-limit = 1024 (custom)
datanode_4_1  | 2020-04-17 18:50:41,880 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.segment.size.max = 1048576 (custom)
datanode_4_1  | 2020-04-17 18:50:41,887 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.preallocated.size = 16384 (custom)
datanode_4_1  | 2020-04-17 18:50:41,891 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.write.buffer.size = 1048576 (custom)
datanode_4_1  | 2020-04-17 18:50:41,891 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.force.sync.num = 128 (default)
datanode_4_1  | 2020-04-17 18:50:41,895 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.statemachine.data.sync = true (default)
datanode_4_1  | 2020-04-17 18:50:41,905 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.statemachine.data.sync.timeout = 10s (default)
datanode_4_1  | 2020-04-17 18:50:41,906 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
datanode_4_1  | 2020-04-17 18:50:42,044 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.statemachine.data.caching.enabled = true (custom)
datanode_4_1  | 2020-04-17 18:50:42,115 [pool-69-thread-1] INFO segmented.SegmentedRaftLogWorker: a0acbcec-d753-414c-b077-647d02aaa7fb@group-51477CB1F421-SegmentedRaftLogWorker: flushIndex: setUnconditionally 0 -> -1
datanode_4_1  | 2020-04-17 18:50:42,139 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.snapshot.auto.trigger.enabled = true (custom)
datanode_4_1  | 2020-04-17 18:50:42,150 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
datanode_4_1  | 2020-04-17 18:50:42,155 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.snapshot.retention.file.num = 5 (custom)
datanode_4_1  | 2020-04-17 18:50:42,156 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.retrycache.expirytime = 600000ms (custom)
datanode_4_1  | 2020-04-17 18:50:42,306 [pool-69-thread-1] INFO metrics.RatisMetrics: Creating Metrics Registry : ratis.leader_election.a0acbcec-d753-414c-b077-647d02aaa7fb@group-51477CB1F421
datanode_4_1  | 2020-04-17 18:50:42,317 [pool-69-thread-1] INFO metrics.RatisMetrics: Creating Metrics Registry : ratis.server.a0acbcec-d753-414c-b077-647d02aaa7fb@group-51477CB1F421
datanode_4_1  | 2020-04-17 18:50:42,335 [pool-69-thread-1] INFO impl.RaftServerImpl: a0acbcec-d753-414c-b077-647d02aaa7fb@group-51477CB1F421: start as a follower, conf=-1: [a0acbcec-d753-414c-b077-647d02aaa7fb:10.5.0.7:9858], old=null
datanode_4_1  | 2020-04-17 18:50:42,347 [pool-69-thread-1] INFO impl.RaftServerImpl: a0acbcec-d753-414c-b077-647d02aaa7fb@group-51477CB1F421: changes role from      null to FOLLOWER at term 0 for startAsFollower
datanode_4_1  | 2020-04-17 18:50:42,356 [pool-69-thread-1] INFO impl.RoleInfo: a0acbcec-d753-414c-b077-647d02aaa7fb: start FollowerState
datanode_4_1  | 2020-04-17 18:50:42,405 [pool-69-thread-1] INFO util.JmxRegister: Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-51477CB1F421,id=a0acbcec-d753-414c-b077-647d02aaa7fb
datanode_4_1  | 2020-04-17 18:50:42,440 [pool-69-thread-1] INFO metrics.RatisMetrics: Creating Metrics Registry : ratis.state_machine.a0acbcec-d753-414c-b077-647d02aaa7fb@group-51477CB1F421
datanode_4_1  | 2020-04-17 18:50:42,533 [Command processor thread] INFO commandhandler.CreatePipelineCommandHandler: Created Pipeline RATIS ONE #id: "f9d10128-1d59-4577-ad6c-51477cb1f421"
datanode_4_1  | .
datanode_4_1  | 2020-04-17 18:50:42,540 [Command processor thread] INFO impl.RaftServerProxy: a0acbcec-d753-414c-b077-647d02aaa7fb: addNew group-385EF22ED913:[978c057e-5c38-4e20-8a8b-f271c823af7e:10.5.0.8:9858, a0acbcec-d753-414c-b077-647d02aaa7fb:10.5.0.7:9858, 0e99e1b0-220f-42bd-a39f-d4658f80d0e4:10.5.0.5:9858] returns group-385EF22ED913:java.util.concurrent.CompletableFuture@293e181[Not completed]
datanode_4_1  | 2020-04-17 18:50:42,589 [pool-69-thread-1] INFO impl.RaftServerImpl: a0acbcec-d753-414c-b077-647d02aaa7fb: new RaftServerImpl for group-385EF22ED913:[978c057e-5c38-4e20-8a8b-f271c823af7e:10.5.0.8:9858, a0acbcec-d753-414c-b077-647d02aaa7fb:10.5.0.7:9858, 0e99e1b0-220f-42bd-a39f-d4658f80d0e4:10.5.0.5:9858] with ContainerStateMachine:uninitialized
datanode_4_1  | 2020-04-17 18:50:42,602 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.rpc.timeout.min = 5s (custom)
datanode_4_1  | 2020-04-17 18:50:42,603 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.rpc.timeout.max = 5200ms (custom)
datanode_4_1  | 2020-04-17 18:50:42,604 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.rpcslowness.timeout = 300s (custom)
datanode_4_1  | 2020-04-17 18:50:42,604 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.sleep.deviation.threshold = 300 (default)
datanode_4_1  | 2020-04-17 18:50:42,604 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.appender.install.snapshot.enabled = false (custom)
datanode_4_1  | 2020-04-17 18:50:42,604 [pool-69-thread-1] INFO impl.RaftServerImpl: a0acbcec-d753-414c-b077-647d02aaa7fb@group-385EF22ED913: ConfigurationManager, init=-1: [978c057e-5c38-4e20-8a8b-f271c823af7e:10.5.0.8:9858, a0acbcec-d753-414c-b077-647d02aaa7fb:10.5.0.7:9858, 0e99e1b0-220f-42bd-a39f-d4658f80d0e4:10.5.0.5:9858], old=null, confs=<EMPTY_MAP>
datanode_4_1  | 2020-04-17 18:50:42,604 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.storage.dir = [/data/metadata/ratis] (custom)
datanode_4_1  | 2020-04-17 18:50:42,612 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.corruption.policy = EXCEPTION (default)
datanode_4_1  | 2020-04-17 18:50:42,612 [pool-69-thread-1] INFO storage.RaftStorageDirectory: The storage directory /data/metadata/ratis/be26d0dd-802f-4608-9a1c-385ef22ed913 does not exist. Creating ...
datanode_4_1  | 2020-04-17 18:50:42,622 [pool-69-thread-1] INFO storage.RaftStorageDirectory: Lock on /data/metadata/ratis/be26d0dd-802f-4608-9a1c-385ef22ed913/in_use.lock acquired by nodename 6@cea2015b57a1
datanode_4_1  | 2020-04-17 18:50:42,630 [pool-69-thread-1] INFO storage.RaftStorage: Storage directory /data/metadata/ratis/be26d0dd-802f-4608-9a1c-385ef22ed913 has been successfully formatted.
datanode_4_1  | 2020-04-17 18:50:42,630 [pool-69-thread-1] INFO ratis.ContainerStateMachine: group-385EF22ED913: The snapshot info is null. Setting the last applied indexto:(t:0, i:~)
datanode_4_1  | 2020-04-17 18:50:42,631 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.notification.no-leader.timeout = 60s (default)
datanode_4_1  | 2020-04-17 18:50:42,631 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.use.memory = false (default)
datanode_4_1  | 2020-04-17 18:50:42,632 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.purge.gap = 1000000 (custom)
datanode_4_1  | 2020-04-17 18:50:42,632 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
datanode_4_1  | 2020-04-17 18:50:42,633 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.segment.size.max = 1048576 (custom)
datanode_4_1  | 2020-04-17 18:50:42,635 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.segment.cache.num.max = 2 (custom)
datanode_4_1  | 2020-04-17 18:50:42,636 [pool-69-thread-1] INFO segmented.SegmentedRaftLogWorker: new a0acbcec-d753-414c-b077-647d02aaa7fb@group-385EF22ED913-SegmentedRaftLogWorker for RaftStorage:Storage Directory /data/metadata/ratis/be26d0dd-802f-4608-9a1c-385ef22ed913
datanode_4_1  | 2020-04-17 18:50:42,656 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.queue.byte-limit = 2147483647 (custom)
datanode_2_1  | 2020-04-17 18:54:03,519 [0e99e1b0-220f-42bd-a39f-d4658f80d0e4@group-CFD51574C841-LeaderElection2] INFO server.RaftServerConfigKeys: raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
datanode_2_1  | 2020-04-17 18:54:03,519 [0e99e1b0-220f-42bd-a39f-d4658f80d0e4@group-CFD51574C841-LeaderElection2] INFO server.RaftServerConfigKeys: raft.server.log.appender.buffer.element-limit = 1 (custom)
datanode_2_1  | 2020-04-17 18:54:03,530 [0e99e1b0-220f-42bd-a39f-d4658f80d0e4@group-CFD51574C841-LeaderElection2] INFO grpc.GrpcConfigKeys: raft.grpc.server.leader.outstanding.appends.max = 128 (default)
datanode_2_1  | 2020-04-17 18:54:03,535 [0e99e1b0-220f-42bd-a39f-d4658f80d0e4@group-CFD51574C841-LeaderElection2] INFO server.RaftServerConfigKeys: raft.server.rpc.request.timeout = 60s (custom)
datanode_2_1  | 2020-04-17 18:54:03,535 [0e99e1b0-220f-42bd-a39f-d4658f80d0e4@group-CFD51574C841-LeaderElection2] INFO server.RaftServerConfigKeys: raft.server.log.appender.install.snapshot.enabled = false (custom)
datanode_2_1  | 2020-04-17 18:54:03,538 [0e99e1b0-220f-42bd-a39f-d4658f80d0e4@group-CFD51574C841-LeaderElection2] INFO server.RaftServerConfigKeys: raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
datanode_2_1  | 2020-04-17 18:54:03,542 [0e99e1b0-220f-42bd-a39f-d4658f80d0e4@group-CFD51574C841-LeaderElection2] INFO server.RaftServerConfigKeys: raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
datanode_2_1  | 2020-04-17 18:54:03,543 [0e99e1b0-220f-42bd-a39f-d4658f80d0e4@group-CFD51574C841-LeaderElection2] INFO server.RaftServerConfigKeys: raft.server.log.appender.buffer.element-limit = 1 (custom)
datanode_2_1  | 2020-04-17 18:54:03,543 [0e99e1b0-220f-42bd-a39f-d4658f80d0e4@group-CFD51574C841-LeaderElection2] INFO grpc.GrpcConfigKeys: raft.grpc.server.leader.outstanding.appends.max = 128 (default)
datanode_2_1  | 2020-04-17 18:54:03,543 [0e99e1b0-220f-42bd-a39f-d4658f80d0e4@group-CFD51574C841-LeaderElection2] INFO server.RaftServerConfigKeys: raft.server.rpc.request.timeout = 60s (custom)
datanode_2_1  | 2020-04-17 18:54:03,543 [0e99e1b0-220f-42bd-a39f-d4658f80d0e4@group-CFD51574C841-LeaderElection2] INFO server.RaftServerConfigKeys: raft.server.log.appender.install.snapshot.enabled = false (custom)
datanode_2_1  | 2020-04-17 18:54:03,544 [0e99e1b0-220f-42bd-a39f-d4658f80d0e4@group-CFD51574C841-LeaderElection2] INFO impl.RoleInfo: 0e99e1b0-220f-42bd-a39f-d4658f80d0e4: start LeaderState
datanode_2_1  | 2020-04-17 18:54:03,546 [0e99e1b0-220f-42bd-a39f-d4658f80d0e4@group-CFD51574C841-LeaderElection2] INFO segmented.SegmentedRaftLogWorker: 0e99e1b0-220f-42bd-a39f-d4658f80d0e4@group-CFD51574C841-SegmentedRaftLogWorker: Starting segment from index:0
datanode_2_1  | 2020-04-17 18:54:03,548 [0e99e1b0-220f-42bd-a39f-d4658f80d0e4@group-CFD51574C841-SegmentedRaftLogWorker] INFO segmented.SegmentedRaftLogWorker: 0e99e1b0-220f-42bd-a39f-d4658f80d0e4@group-CFD51574C841-SegmentedRaftLogWorker: created new log segment /data/metadata/ratis/825f4d0e-2629-43e6-a52f-cfd51574c841/current/log_inprogress_0
datanode_2_1  | 2020-04-17 18:54:03,556 [0e99e1b0-220f-42bd-a39f-d4658f80d0e4@group-CFD51574C841-LeaderElection2] INFO impl.RaftServerImpl: 0e99e1b0-220f-42bd-a39f-d4658f80d0e4@group-CFD51574C841: set configuration 0: [978c057e-5c38-4e20-8a8b-f271c823af7e:10.5.0.8:9858, 79669a1f-2445-496e-a337-3115205f3ae5:10.5.0.9:9858, 0e99e1b0-220f-42bd-a39f-d4658f80d0e4:10.5.0.5:9858], old=null at 0
datanode_2_1  | 2020-04-17 18:54:08,641 [grpc-default-executor-0] INFO server.GrpcServerProtocolService: 0e99e1b0-220f-42bd-a39f-d4658f80d0e4: Completed APPEND_ENTRIES, lastRequest: 978c057e-5c38-4e20-8a8b-f271c823af7e->0e99e1b0-220f-42bd-a39f-d4658f80d0e4#3-t1, previous=(t:1, i:1), leaderCommit=0, initializing? false, entries: size=1, first=(t:1, i:2), STATEMACHINELOGENTRY, client-B8993CFB43DC, cid=58
datanode_2_1  | 2020-04-17 18:54:08,652 [Command processor thread] INFO impl.RaftServerProxy: 0e99e1b0-220f-42bd-a39f-d4658f80d0e4: remove  FOLLOWER 0e99e1b0-220f-42bd-a39f-d4658f80d0e4@group-79E0035D853A:t1, leader=978c057e-5c38-4e20-8a8b-f271c823af7e, voted=978c057e-5c38-4e20-8a8b-f271c823af7e, raftlog=0e99e1b0-220f-42bd-a39f-d4658f80d0e4@group-79E0035D853A-SegmentedRaftLog:OPENED:c0,f0,i2, conf=0: [978c057e-5c38-4e20-8a8b-f271c823af7e:10.5.0.8:9858, a0acbcec-d753-414c-b077-647d02aaa7fb:10.5.0.7:9858, 0e99e1b0-220f-42bd-a39f-d4658f80d0e4:10.5.0.5:9858], old=null RUNNING
datanode_2_1  | 2020-04-17 18:54:08,653 [Command processor thread] INFO impl.RaftServerImpl: 0e99e1b0-220f-42bd-a39f-d4658f80d0e4@group-79E0035D853A: shutdown
datanode_2_1  | 2020-04-17 18:54:08,653 [Command processor thread] INFO util.JmxRegister: Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-79E0035D853A,id=0e99e1b0-220f-42bd-a39f-d4658f80d0e4
datanode_2_1  | 2020-04-17 18:54:08,653 [Command processor thread] INFO impl.RoleInfo: 0e99e1b0-220f-42bd-a39f-d4658f80d0e4: shutdown FollowerState
datanode_2_1  | 2020-04-17 18:54:08,653 [Command processor thread] INFO impl.StateMachineUpdater: 0e99e1b0-220f-42bd-a39f-d4658f80d0e4@group-79E0035D853A-StateMachineUpdater: set stopIndex = 0
datanode_2_1  | 2020-04-17 18:54:08,653 [0e99e1b0-220f-42bd-a39f-d4658f80d0e4@group-79E0035D853A-StateMachineUpdater] ERROR ratis.ContainerStateMachine: Failed to take snapshot  for group-79E0035D853A as the stateMachine is unhealthy. The last applied index is at (t:1, i:0)
datanode_2_1  | 2020-04-17 18:54:08,654 [0e99e1b0-220f-42bd-a39f-d4658f80d0e4@group-79E0035D853A-StateMachineUpdater] ERROR impl.StateMachineUpdater: 0e99e1b0-220f-42bd-a39f-d4658f80d0e4@group-79E0035D853A-StateMachineUpdater: Failed to take snapshot
datanode_2_1  | org.apache.ratis.protocol.StateMachineException: Failed to take snapshot  for group-79E0035D853A as the stateMachine is unhealthy. The last applied index is at (t:1, i:0)
datanode_2_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.ContainerStateMachine.takeSnapshot(ContainerStateMachine.java:288)
datanode_2_1  | 	at org.apache.ratis.server.impl.StateMachineUpdater.takeSnapshot(StateMachineUpdater.java:258)
datanode_2_1  | 	at org.apache.ratis.server.impl.StateMachineUpdater.checkAndTakeSnapshot(StateMachineUpdater.java:250)
datanode_2_1  | 	at org.apache.ratis.server.impl.StateMachineUpdater.run(StateMachineUpdater.java:169)
datanode_2_1  | 	at java.base/java.lang.Thread.run(Thread.java:834)
datanode_2_1  | 2020-04-17 18:54:08,653 [Thread-83] INFO impl.FollowerState: 0e99e1b0-220f-42bd-a39f-d4658f80d0e4@group-79E0035D853A-FollowerState was interrupted: java.lang.InterruptedException: sleep interrupted
datanode_2_1  | 2020-04-17 18:54:08,654 [0e99e1b0-220f-42bd-a39f-d4658f80d0e4@group-79E0035D853A-StateMachineUpdater] ERROR ratis.ContainerStateMachine: Failed to take snapshot  for group-79E0035D853A as the stateMachine is unhealthy. The last applied index is at (t:1, i:0)
datanode_2_1  | 2020-04-17 18:54:08,654 [0e99e1b0-220f-42bd-a39f-d4658f80d0e4@group-79E0035D853A-StateMachineUpdater] ERROR impl.StateMachineUpdater: 0e99e1b0-220f-42bd-a39f-d4658f80d0e4@group-79E0035D853A-StateMachineUpdater: Failed to take snapshot
datanode_2_1  | org.apache.ratis.protocol.StateMachineException: Failed to take snapshot  for group-79E0035D853A as the stateMachine is unhealthy. The last applied index is at (t:1, i:0)
datanode_2_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.ContainerStateMachine.takeSnapshot(ContainerStateMachine.java:288)
datanode_2_1  | 	at org.apache.ratis.server.impl.StateMachineUpdater.takeSnapshot(StateMachineUpdater.java:258)
datanode_2_1  | 	at org.apache.ratis.server.impl.StateMachineUpdater.checkAndTakeSnapshot(StateMachineUpdater.java:250)
datanode_2_1  | 	at org.apache.ratis.server.impl.StateMachineUpdater.run(StateMachineUpdater.java:172)
datanode_2_1  | 	at java.base/java.lang.Thread.run(Thread.java:834)
datanode_2_1  | 2020-04-17 18:54:08,655 [0e99e1b0-220f-42bd-a39f-d4658f80d0e4@group-79E0035D853A-StateMachineUpdater] INFO metrics.RatisMetrics: Unregistering Metrics Registry : ratis.state_machine.0e99e1b0-220f-42bd-a39f-d4658f80d0e4@group-79E0035D853A
datanode_2_1  | 2020-04-17 18:54:08,655 [Command processor thread] INFO impl.RaftServerImpl: 0e99e1b0-220f-42bd-a39f-d4658f80d0e4@group-79E0035D853A: closes. applyIndex: 0
datanode_5_1  | 2020-04-17 18:52:29,938 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.queue.element-limit = 1024 (custom)
datanode_5_1  | 2020-04-17 18:52:29,938 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.segment.size.max = 1048576 (custom)
datanode_5_1  | 2020-04-17 18:52:29,938 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.preallocated.size = 16384 (custom)
datanode_5_1  | 2020-04-17 18:52:29,938 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.write.buffer.size = 1048576 (custom)
datanode_5_1  | 2020-04-17 18:52:29,938 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.force.sync.num = 128 (default)
datanode_5_1  | 2020-04-17 18:52:29,938 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.statemachine.data.sync = true (default)
datanode_5_1  | 2020-04-17 18:52:29,939 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.statemachine.data.sync.timeout = 10s (default)
datanode_5_1  | 2020-04-17 18:52:29,939 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
datanode_5_1  | 2020-04-17 18:52:29,956 [grpc-default-executor-0] INFO server.GrpcServerProtocolService: 978c057e-5c38-4e20-8a8b-f271c823af7e: Completed APPEND_ENTRIES, lastRequest: a0acbcec-d753-414c-b077-647d02aaa7fb->978c057e-5c38-4e20-8a8b-f271c823af7e#6-t1, previous=(t:1, i:1), leaderCommit=0, initializing? false, entries: size=1, first=(t:1, i:2), STATEMACHINELOGENTRY, client-884610206644, cid=9
datanode_5_1  | 2020-04-17 18:52:29,956 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.statemachine.data.caching.enabled = true (custom)
datanode_5_1  | 2020-04-17 18:52:29,956 [pool-69-thread-1] INFO segmented.SegmentedRaftLogWorker: 978c057e-5c38-4e20-8a8b-f271c823af7e@group-79E0035D853A-SegmentedRaftLogWorker: flushIndex: setUnconditionally 0 -> -1
datanode_5_1  | 2020-04-17 18:52:29,958 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.snapshot.auto.trigger.enabled = true (custom)
datanode_5_1  | 2020-04-17 18:52:29,958 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
datanode_5_1  | 2020-04-17 18:52:29,958 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.snapshot.retention.file.num = 5 (custom)
datanode_5_1  | 2020-04-17 18:52:29,958 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.retrycache.expirytime = 600000ms (custom)
datanode_5_1  | 2020-04-17 18:52:29,959 [pool-69-thread-1] INFO metrics.RatisMetrics: Creating Metrics Registry : ratis.leader_election.978c057e-5c38-4e20-8a8b-f271c823af7e@group-79E0035D853A
datanode_5_1  | 2020-04-17 18:52:29,959 [pool-69-thread-1] INFO metrics.RatisMetrics: Creating Metrics Registry : ratis.server.978c057e-5c38-4e20-8a8b-f271c823af7e@group-79E0035D853A
datanode_5_1  | 2020-04-17 18:52:29,960 [pool-69-thread-1] INFO impl.RaftServerImpl: 978c057e-5c38-4e20-8a8b-f271c823af7e@group-79E0035D853A: start as a follower, conf=-1: [978c057e-5c38-4e20-8a8b-f271c823af7e:10.5.0.8:9858, a0acbcec-d753-414c-b077-647d02aaa7fb:10.5.0.7:9858, 0e99e1b0-220f-42bd-a39f-d4658f80d0e4:10.5.0.5:9858], old=null
datanode_5_1  | 2020-04-17 18:52:29,960 [pool-69-thread-1] INFO impl.RaftServerImpl: 978c057e-5c38-4e20-8a8b-f271c823af7e@group-79E0035D853A: changes role from      null to FOLLOWER at term 0 for startAsFollower
datanode_5_1  | 2020-04-17 18:52:29,960 [pool-69-thread-1] INFO impl.RoleInfo: 978c057e-5c38-4e20-8a8b-f271c823af7e: start FollowerState
datanode_5_1  | 2020-04-17 18:52:29,960 [pool-69-thread-1] INFO util.JmxRegister: Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-79E0035D853A,id=978c057e-5c38-4e20-8a8b-f271c823af7e
datanode_5_1  | 2020-04-17 18:52:29,960 [pool-69-thread-1] INFO metrics.RatisMetrics: Creating Metrics Registry : ratis.state_machine.978c057e-5c38-4e20-8a8b-f271c823af7e@group-79E0035D853A
datanode_5_1  | 2020-04-17 18:52:30,104 [Command processor thread] INFO commandhandler.CreatePipelineCommandHandler: Created Pipeline RATIS THREE #id: "cad403d1-ea2f-4530-84e5-79e0035d853a"
datanode_5_1  | .
datanode_5_1  | 2020-04-17 18:52:30,104 [Command processor thread] INFO impl.RaftServerProxy: 978c057e-5c38-4e20-8a8b-f271c823af7e: remove group-385EF22ED913:null
datanode_5_1  | 2020-04-17 18:52:30,104 [Command processor thread] ERROR commandhandler.ClosePipelineCommandHandler: Can't close pipeline #id: "be26d0dd-802f-4608-9a1c-385ef22ed913"
datanode_5_1  | 
datanode_5_1  | java.io.IOException: 978c057e-5c38-4e20-8a8b-f271c823af7e: Group group-385EF22ED913 not found.
datanode_5_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.XceiverServerRatis.removeGroup(XceiverServerRatis.java:659)
datanode_5_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.ClosePipelineCommandHandler.handle(ClosePipelineCommandHandler.java:77)
datanode_5_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.CommandDispatcher.handle(CommandDispatcher.java:99)
datanode_5_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.lambda$initCommandHandlerThread$1(DatanodeStateMachine.java:472)
datanode_5_1  | 	at java.base/java.lang.Thread.run(Thread.java:834)
datanode_5_1  | Caused by: org.apache.ratis.protocol.GroupMismatchException: 978c057e-5c38-4e20-8a8b-f271c823af7e: Group group-385EF22ED913 not found.
datanode_5_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupRemoveAsync(RaftServerProxy.java:404)
datanode_5_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupManagementAsync(RaftServerProxy.java:367)
datanode_5_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupManagement(RaftServerProxy.java:350)
datanode_5_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.XceiverServerRatis.removeGroup(XceiverServerRatis.java:657)
datanode_5_1  | 	... 4 more
datanode_5_1  | 2020-04-17 18:52:30,105 [Command processor thread] INFO impl.RaftServerProxy: 978c057e-5c38-4e20-8a8b-f271c823af7e: remove group-385EF22ED913:null
datanode_5_1  | 2020-04-17 18:52:30,105 [Command processor thread] ERROR commandhandler.ClosePipelineCommandHandler: Can't close pipeline #id: "be26d0dd-802f-4608-9a1c-385ef22ed913"
datanode_5_1  | 
datanode_5_1  | java.io.IOException: 978c057e-5c38-4e20-8a8b-f271c823af7e: Group group-385EF22ED913 not found.
datanode_5_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.XceiverServerRatis.removeGroup(XceiverServerRatis.java:659)
datanode_5_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.ClosePipelineCommandHandler.handle(ClosePipelineCommandHandler.java:77)
datanode_5_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.CommandDispatcher.handle(CommandDispatcher.java:99)
datanode_5_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.lambda$initCommandHandlerThread$1(DatanodeStateMachine.java:472)
datanode_5_1  | 	at java.base/java.lang.Thread.run(Thread.java:834)
datanode_5_1  | Caused by: org.apache.ratis.protocol.GroupMismatchException: 978c057e-5c38-4e20-8a8b-f271c823af7e: Group group-385EF22ED913 not found.
datanode_5_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupRemoveAsync(RaftServerProxy.java:404)
datanode_5_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupManagementAsync(RaftServerProxy.java:367)
datanode_5_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupManagement(RaftServerProxy.java:350)
datanode_5_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.XceiverServerRatis.removeGroup(XceiverServerRatis.java:657)
datanode_5_1  | 	... 4 more
datanode_5_1  | 2020-04-17 18:52:30,105 [Command processor thread] INFO impl.RaftServerProxy: 978c057e-5c38-4e20-8a8b-f271c823af7e: remove group-385EF22ED913:null
datanode_5_1  | 2020-04-17 18:52:30,106 [Command processor thread] ERROR commandhandler.ClosePipelineCommandHandler: Can't close pipeline #id: "be26d0dd-802f-4608-9a1c-385ef22ed913"
datanode_5_1  | 
datanode_5_1  | java.io.IOException: 978c057e-5c38-4e20-8a8b-f271c823af7e: Group group-385EF22ED913 not found.
datanode_5_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.XceiverServerRatis.removeGroup(XceiverServerRatis.java:659)
datanode_5_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.ClosePipelineCommandHandler.handle(ClosePipelineCommandHandler.java:77)
datanode_5_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.CommandDispatcher.handle(CommandDispatcher.java:99)
datanode_5_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.lambda$initCommandHandlerThread$1(DatanodeStateMachine.java:472)
datanode_5_1  | 	at java.base/java.lang.Thread.run(Thread.java:834)
datanode_5_1  | Caused by: org.apache.ratis.protocol.GroupMismatchException: 978c057e-5c38-4e20-8a8b-f271c823af7e: Group group-385EF22ED913 not found.
datanode_5_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupRemoveAsync(RaftServerProxy.java:404)
datanode_5_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupManagementAsync(RaftServerProxy.java:367)
datanode_5_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupManagement(RaftServerProxy.java:350)
datanode_5_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.XceiverServerRatis.removeGroup(XceiverServerRatis.java:657)
datanode_5_1  | 	... 4 more
datanode_5_1  | 2020-04-17 18:52:30,106 [Command processor thread] INFO impl.RaftServerProxy: 978c057e-5c38-4e20-8a8b-f271c823af7e: remove group-385EF22ED913:null
datanode_5_1  | 2020-04-17 18:52:30,106 [Command processor thread] ERROR commandhandler.ClosePipelineCommandHandler: Can't close pipeline #id: "be26d0dd-802f-4608-9a1c-385ef22ed913"
datanode_5_1  | 
datanode_5_1  | java.io.IOException: 978c057e-5c38-4e20-8a8b-f271c823af7e: Group group-385EF22ED913 not found.
datanode_5_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.XceiverServerRatis.removeGroup(XceiverServerRatis.java:659)
datanode_5_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.ClosePipelineCommandHandler.handle(ClosePipelineCommandHandler.java:77)
datanode_5_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.CommandDispatcher.handle(CommandDispatcher.java:99)
datanode_5_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.lambda$initCommandHandlerThread$1(DatanodeStateMachine.java:472)
datanode_5_1  | 	at java.base/java.lang.Thread.run(Thread.java:834)
datanode_5_1  | Caused by: org.apache.ratis.protocol.GroupMismatchException: 978c057e-5c38-4e20-8a8b-f271c823af7e: Group group-385EF22ED913 not found.
datanode_5_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupRemoveAsync(RaftServerProxy.java:404)
datanode_5_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupManagementAsync(RaftServerProxy.java:367)
datanode_5_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupManagement(RaftServerProxy.java:350)
datanode_5_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.XceiverServerRatis.removeGroup(XceiverServerRatis.java:657)
datanode_5_1  | 	... 4 more
datanode_5_1  | 2020-04-17 18:52:30,107 [Command processor thread] INFO impl.RaftServerProxy: 978c057e-5c38-4e20-8a8b-f271c823af7e: remove group-385EF22ED913:null
datanode_4_1  | 2020-04-17 18:50:42,656 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.queue.element-limit = 1024 (custom)
datanode_4_1  | 2020-04-17 18:50:42,656 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.segment.size.max = 1048576 (custom)
datanode_4_1  | 2020-04-17 18:50:42,656 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.preallocated.size = 16384 (custom)
datanode_5_1  | 2020-04-17 18:52:30,107 [Command processor thread] ERROR commandhandler.ClosePipelineCommandHandler: Can't close pipeline #id: "be26d0dd-802f-4608-9a1c-385ef22ed913"
datanode_4_1  | 2020-04-17 18:50:42,656 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.write.buffer.size = 1048576 (custom)
om_1          | No '-XX:...' jvm parameters are used. Adding safer GC settings to the HADOOP_OPTS
datanode_5_1  | 
datanode_6_1  | Enabled profiling in kernel
datanode_2_1  | 2020-04-17 18:54:08,655 [0e99e1b0-220f-42bd-a39f-d4658f80d0e4@group-79E0035D853A-SegmentedRaftLogWorker] INFO segmented.SegmentedRaftLogWorker: 0e99e1b0-220f-42bd-a39f-d4658f80d0e4@group-79E0035D853A-SegmentedRaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
scm_1         | No '-XX:...' jvm parameters are used. Adding safer GC settings to the HADOOP_OPTS
datanode_4_1  | 2020-04-17 18:50:42,671 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.force.sync.num = 128 (default)
om_1          | OpenJDK 64-Bit Server VM warning: Option UseConcMarkSweepGC was deprecated in version 9.0 and will likely be removed in a future release.
om_1          | 2020-04-17 18:50:15,518 [main] INFO om.OzoneManagerStarter: STARTUP_MSG: 
datanode_6_1  | No '-XX:...' jvm parameters are used. Adding safer GC settings to the HADOOP_OPTS
datanode_2_1  | 2020-04-17 18:54:08,656 [Command processor thread] INFO segmented.SegmentedRaftLogWorker: 0e99e1b0-220f-42bd-a39f-d4658f80d0e4@group-79E0035D853A-SegmentedRaftLogWorker close()
scm_1         | OpenJDK 64-Bit Server VM warning: Option UseConcMarkSweepGC was deprecated in version 9.0 and will likely be removed in a future release.
datanode_4_1  | 2020-04-17 18:50:42,672 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.statemachine.data.sync = true (default)
datanode_5_1  | java.io.IOException: 978c057e-5c38-4e20-8a8b-f271c823af7e: Group group-385EF22ED913 not found.
om_1          | /************************************************************
datanode_6_1  | OpenJDK 64-Bit Server VM warning: Option UseConcMarkSweepGC was deprecated in version 9.0 and will likely be removed in a future release.
datanode_2_1  | 2020-04-17 18:54:08,656 [Command processor thread] INFO metrics.RatisMetrics: Unregistering Metrics Registry : ratis.log_worker.0e99e1b0-220f-42bd-a39f-d4658f80d0e4
scm_1         | 2020-04-17 18:50:14,659 [main] INFO server.StorageContainerManagerStarter: STARTUP_MSG: 
datanode_4_1  | 2020-04-17 18:50:42,672 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.statemachine.data.sync.timeout = 10s (default)
datanode_4_1  | 2020-04-17 18:50:42,672 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
om_1          | STARTUP_MSG: Starting OzoneManager
datanode_6_1  | 2020-04-17 18:50:16,683 [main] INFO ozone.HddsDatanodeService: STARTUP_MSG: 
datanode_2_1  | 2020-04-17 18:54:08,657 [Command processor thread] INFO metrics.RatisMetrics: Unregistering Metrics Registry : ratis.leader_election.0e99e1b0-220f-42bd-a39f-d4658f80d0e4@group-79E0035D853A
scm_1         | /************************************************************
datanode_4_1  | 2020-04-17 18:50:42,679 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.statemachine.data.caching.enabled = true (custom)
datanode_5_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.XceiverServerRatis.removeGroup(XceiverServerRatis.java:659)
om_1          | STARTUP_MSG:   host = f442795e723d/10.5.0.70
datanode_6_1  | /************************************************************
datanode_2_1  | 2020-04-17 18:54:08,657 [Command processor thread] INFO metrics.RatisMetrics: Unregistering Metrics Registry : ratis.server.0e99e1b0-220f-42bd-a39f-d4658f80d0e4@group-79E0035D853A
scm_1         | STARTUP_MSG: Starting StorageContainerManager
datanode_4_1  | 2020-04-17 18:50:42,681 [pool-69-thread-1] INFO segmented.SegmentedRaftLogWorker: a0acbcec-d753-414c-b077-647d02aaa7fb@group-385EF22ED913-SegmentedRaftLogWorker: flushIndex: setUnconditionally 0 -> -1
datanode_5_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.ClosePipelineCommandHandler.handle(ClosePipelineCommandHandler.java:77)
om_1          | STARTUP_MSG:   args = [--init]
datanode_6_1  | STARTUP_MSG: Starting HddsDatanodeService
datanode_2_1  | 2020-04-17 18:54:08,657 [Command processor thread] INFO commandhandler.ClosePipelineCommandHandler: Close Pipeline #id: "cad403d1-ea2f-4530-84e5-79e0035d853a"
scm_1         | STARTUP_MSG:   host = 1bdb9e39544a/10.5.0.71
datanode_4_1  | 2020-04-17 18:50:42,713 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.snapshot.auto.trigger.enabled = true (custom)
datanode_5_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.CommandDispatcher.handle(CommandDispatcher.java:99)
om_1          | STARTUP_MSG:   version = 3.2.0
datanode_6_1  | STARTUP_MSG:   host = 9608d796128b/10.5.0.9
datanode_6_1  | STARTUP_MSG:   args = []
datanode_2_1  |  command on datanode #0e99e1b0-220f-42bd-a39f-d4658f80d0e4.
scm_1         | STARTUP_MSG:   args = [--init]
datanode_4_1  | 2020-04-17 18:50:42,713 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
datanode_5_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.lambda$initCommandHandlerThread$1(DatanodeStateMachine.java:472)
datanode_6_1  | STARTUP_MSG:   version = 3.2.0
datanode_2_1  | 2020-04-17 18:54:08,659 [Command processor thread] INFO impl.RaftServerProxy: 0e99e1b0-220f-42bd-a39f-d4658f80d0e4: remove group-79E0035D853A:null
datanode_2_1  | 2020-04-17 18:54:08,659 [Command processor thread] ERROR commandhandler.ClosePipelineCommandHandler: Can't close pipeline #id: "cad403d1-ea2f-4530-84e5-79e0035d853a"
datanode_4_1  | 2020-04-17 18:50:42,717 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.snapshot.retention.file.num = 5 (custom)
datanode_5_1  | 	at java.base/java.lang.Thread.run(Thread.java:834)
om_1          | STARTUP_MSG:   classpath = /etc/hadoop:/opt/hadoop/share/hadoop/common/*:/opt/hadoop/share/ozone/lib/kerb-simplekdc-1.0.1.jar:/opt/hadoop/share/ozone/lib/jackson-databind-2.10.3.jar:/opt/hadoop/share/ozone/lib/protobuf-java-2.5.0.jar:/opt/hadoop/share/ozone/lib/bcpkix-jdk15on-1.60.jar:/opt/hadoop/share/ozone/lib/commons-validator-1.6.jar:/opt/hadoop/share/ozone/lib/hadoop-hdds-client-0.6.0-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/ratis-proto-0.6.0-7c5b30d-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/netty-3.10.5.Final.jar:/opt/hadoop/share/ozone/lib/jaxb-impl-2.3.0.1.jar:/opt/hadoop/share/ozone/lib/netty-all-4.1.47.Final.jar:/opt/hadoop/share/ozone/lib/kerb-core-1.0.1.jar:/opt/hadoop/share/ozone/lib/jsr305-3.0.0.jar:/opt/hadoop/share/ozone/lib/leveldbjni-all-1.8.jar:/opt/hadoop/share/ozone/lib/j2objc-annotations-1.3.jar:/opt/hadoop/share/ozone/lib/jetty-io-9.4.26.v20200117.jar:/opt/hadoop/share/ozone/lib/htrace-core4-4.1.0-incubating.jar:/opt/hadoop/share/ozone/lib/hadoop-annotations-3.2.0.jar:/opt/hadoop/share/ozone/lib/jetty-http-9.4.26.v20200117.jar:/opt/hadoop/share/ozone/lib/kerb-util-1.0.1.jar:/opt/hadoop/share/ozone/lib/jetty-xml-9.4.26.v20200117.jar:/opt/hadoop/share/ozone/lib/jackson-jaxrs-1.9.13.jar:/opt/hadoop/share/ozone/lib/ratis-thirdparty-misc-0.3.0.jar:/opt/hadoop/share/ozone/lib/kerby-xdr-1.0.1.jar:/opt/hadoop/share/ozone/lib/jackson-core-asl-1.9.13.jar:/opt/hadoop/share/ozone/lib/jetty-server-9.4.26.v20200117.jar:/opt/hadoop/share/ozone/lib/commons-net-3.6.jar:/opt/hadoop/share/ozone/lib/log4j-api-2.11.0.jar:/opt/hadoop/share/ozone/lib/hadoop-hdfs-3.2.0.jar:/opt/hadoop/share/ozone/lib/opentracing-api-0.31.0.jar:/opt/hadoop/share/ozone/lib/slf4j-log4j12-1.7.25.jar:/opt/hadoop/share/ozone/lib/hadoop-hdfs-client-3.2.0.jar:/opt/hadoop/share/ozone/lib/kerby-config-1.0.1.jar:/opt/hadoop/share/ozone/lib/hadoop-ozone-client-0.6.0-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/libthrift-0.12.0.jar:/opt/hadoop/share/ozone/lib/jetty-util-ajax-9.4.26.v20200117.jar:/opt/hadoop/share/ozone/lib/metrics-core-3.2.4.jar:/opt/hadoop/share/ozone/lib/guava-28.2-jre.jar:/opt/hadoop/share/ozone/lib/kerby-pkix-1.0.1.jar:/opt/hadoop/share/ozone/lib/xz-1.0.jar:/opt/hadoop/share/ozone/lib/jetty-servlet-9.4.26.v20200117.jar:/opt/hadoop/share/ozone/lib/jsr311-api-1.1.1.jar:/opt/hadoop/share/ozone/lib/commons-beanutils-1.9.4.jar:/opt/hadoop/share/ozone/lib/rocksdbjni-6.6.4.jar:/opt/hadoop/share/ozone/lib/jetty-security-9.4.26.v20200117.jar:/opt/hadoop/share/ozone/lib/javax.servlet-api-3.1.0.jar:/opt/hadoop/share/ozone/lib/kerb-server-1.0.1.jar:/opt/hadoop/share/ozone/lib/avro-1.7.7.jar:/opt/hadoop/share/ozone/lib/kerb-client-1.0.1.jar:/opt/hadoop/share/ozone/lib/jackson-xc-1.9.13.jar:/opt/hadoop/share/ozone/lib/disruptor-3.4.2.jar:/opt/hadoop/share/ozone/lib/hadoop-hdds-docs-0.6.0-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/simpleclient_common-0.7.0.jar:/opt/hadoop/share/ozone/lib/dnsjava-2.1.7.jar:/opt/hadoop/share/ozone/lib/jackson-annotations-2.10.3.jar:/opt/hadoop/share/ozone/lib/commons-configuration2-2.1.1.jar:/opt/hadoop/share/ozone/lib/json-smart-2.3.jar:/opt/hadoop/share/ozone/lib/token-provider-1.0.1.jar:/opt/hadoop/share/ozone/lib/log4j-1.2.17.jar:/opt/hadoop/share/ozone/lib/commons-daemon-1.0.13.jar:/opt/hadoop/share/ozone/lib/listenablefuture-9999.0-empty-to-avoid-conflict-with-guava.jar:/opt/hadoop/share/ozone/lib/bcprov-jdk15on-1.60.jar:/opt/hadoop/share/ozone/lib/ratis-grpc-0.6.0-7c5b30d-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/jetty-webapp-9.4.26.v20200117.jar:/opt/hadoop/share/ozone/lib/commons-lang3-3.7.jar:/opt/hadoop/share/ozone/lib/commons-compress-1.4.1.jar:/opt/hadoop/share/ozone/lib/jaeger-client-0.34.0.jar:/opt/hadoop/share/ozone/lib/accessors-smart-1.2.jar:/opt/hadoop/share/ozone/lib/re2j-1.1.jar:/opt/hadoop/share/ozone/lib/ratis-client-0.6.0-7c5b30d-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/commons-math3-3.1.1.jar:/opt/hadoop/share/ozone/lib/simpleclient_dropwizard-0.7.0.jar:/opt/hadoop/share/ozone/lib/opentracing-noop-0.31.0.jar:/opt/hadoop/share/ozone/lib/simpleclient-0.7.0.jar:/opt/hadoop/share/ozone/lib/httpclient-4.5.2.jar:/opt/hadoop/share/ozone/lib/jaeger-core-0.34.0.jar:/opt/hadoop/share/ozone/lib/asm-5.0.4.jar:/opt/hadoop/share/ozone/lib/kerby-util-1.0.1.jar:/opt/hadoop/share/ozone/lib/failureaccess-1.0.1.jar:/opt/hadoop/share/ozone/lib/jackson-mapper-asl-1.9.13.jar:/opt/hadoop/share/ozone/lib/jsp-api-2.1.jar:/opt/hadoop/share/ozone/lib/jsch-0.1.54.jar:/opt/hadoop/share/ozone/lib/opentracing-tracerresolver-0.1.5.jar:/opt/hadoop/share/ozone/lib/ratis-metrics-0.6.0-7c5b30d-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/ratis-common-0.6.0-7c5b30d-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/paranamer-2.3.jar:/opt/hadoop/share/ozone/lib/log4j-core-2.11.0.jar:/opt/hadoop/share/ozone/lib/nimbus-jose-jwt-7.9.jar:/opt/hadoop/share/ozone/lib/commons-codec-1.11.jar:/opt/hadoop/share/ozone/lib/commons-pool2-2.6.0.jar:/opt/hadoop/share/ozone/lib/jackson-datatype-jsr310-2.10.3.jar:/opt/hadoop/share/ozone/lib/gson-2.2.4.jar:/opt/hadoop/share/ozone/lib/jcip-annotations-1.0-1.jar:/opt/hadoop/share/ozone/lib/kerb-admin-1.0.1.jar:/opt/hadoop/share/ozone/lib/okio-1.13.0.jar:/opt/hadoop/share/ozone/lib/commons-io-2.5.jar:/opt/hadoop/share/ozone/lib/snakeyaml-1.16.jar:/opt/hadoop/share/ozone/lib/jetty-util-9.4.26.v20200117.jar:/opt/hadoop/share/ozone/lib/hadoop-hdds-hadoop-dependency-client-0.6.0-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/jersey-core-1.19.jar:/opt/hadoop/share/ozone/lib/checker-qual-2.10.0.jar:/opt/hadoop/share/ozone/lib/ratis-server-0.6.0-7c5b30d-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/hadoop-hdds-server-framework-0.6.0-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/error_prone_annotations-2.3.4.jar:/opt/hadoop/share/ozone/lib/picocli-3.9.6.jar:/opt/hadoop/share/ozone/lib/jaeger-thrift-0.34.0.jar:/opt/hadoop/share/ozone/lib/hadoop-hdds-common-0.6.0-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/commons-cli-1.2.jar:/opt/hadoop/share/ozone/lib/woodstox-core-5.0.3.jar:/opt/hadoop/share/ozone/lib/javax.annotation-api-1.2.jar:/opt/hadoop/share/ozone/lib/snappy-java-1.0.5.jar:/opt/hadoop/share/ozone/lib/hadoop-ozone-common-0.6.0-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/jaeger-tracerresolver-0.34.0.jar:/opt/hadoop/share/ozone/lib/kerby-asn1-1.0.1.jar:/opt/hadoop/share/ozone/lib/okhttp-3.9.0.jar:/opt/hadoop/share/ozone/lib/hadoop-hdds-config-0.6.0-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/stax2-api-3.1.4.jar:/opt/hadoop/share/ozone/lib/commons-digester-1.8.1.jar:/opt/hadoop/share/ozone/lib/commons-collections-3.2.2.jar:/opt/hadoop/share/ozone/lib/jettison-1.1.jar:/opt/hadoop/share/ozone/lib/jackson-core-2.10.3.jar:/opt/hadoop/share/ozone/lib/commons-text-1.4.jar:/opt/hadoop/share/ozone/lib/jersey-servlet-1.19.jar:/opt/hadoop/share/ozone/lib/jersey-json-1.19.jar:/opt/hadoop/share/ozone/lib/slf4j-api-1.7.25.jar:/opt/hadoop/share/ozone/lib/commons-logging-1.1.3.jar:/opt/hadoop/share/ozone/lib/kerb-identity-1.0.1.jar:/opt/hadoop/share/ozone/lib/opentracing-util-0.31.0.jar:/opt/hadoop/share/ozone/lib/hadoop-hdds-hadoop-dependency-server-0.6.0-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/hadoop-common-3.2.0.jar:/opt/hadoop/share/ozone/lib/hadoop-auth-3.2.0.jar:/opt/hadoop/share/ozone/lib/kerb-common-1.0.1.jar:/opt/hadoop/share/ozone/lib/jersey-server-1.19.jar:/opt/hadoop/share/ozone/lib/kerb-crypto-1.0.1.jar:/opt/hadoop/share/ozone/lib/httpcore-4.4.4.jar:/opt/hadoop/share/ozone/lib/ratis-netty-0.6.0-7c5b30d-SNAPSHOT.jar:/opt/hadoop/share/ozone/web:/opt/hadoop/share/ozone/lib/hadoop-ozone-ozone-manager-0.6.0-SNAPSHOT.jar
datanode_6_1  | STARTUP_MSG:   classpath = /etc/hadoop:/opt/hadoop/share/hadoop/common/*:/opt/hadoop/share/ozone/lib/kerb-simplekdc-1.0.1.jar:/opt/hadoop/share/ozone/lib/jackson-databind-2.10.3.jar:/opt/hadoop/share/ozone/lib/protobuf-java-2.5.0.jar:/opt/hadoop/share/ozone/lib/bcpkix-jdk15on-1.60.jar:/opt/hadoop/share/ozone/lib/netty-3.10.5.Final.jar:/opt/hadoop/share/ozone/lib/ratis-proto-0.6.0-7c5b30d-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/commons-validator-1.6.jar:/opt/hadoop/share/ozone/lib/hadoop-hdds-client-0.6.0-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/jaxb-impl-2.3.0.1.jar:/opt/hadoop/share/ozone/lib/netty-all-4.1.47.Final.jar:/opt/hadoop/share/ozone/lib/kerb-core-1.0.1.jar:/opt/hadoop/share/ozone/lib/jsr305-3.0.0.jar:/opt/hadoop/share/ozone/lib/j2objc-annotations-1.3.jar:/opt/hadoop/share/ozone/lib/leveldbjni-all-1.8.jar:/opt/hadoop/share/ozone/lib/jetty-io-9.4.26.v20200117.jar:/opt/hadoop/share/ozone/lib/htrace-core4-4.1.0-incubating.jar:/opt/hadoop/share/ozone/lib/jaxb-api-2.3.0.jar:/opt/hadoop/share/ozone/lib/hadoop-annotations-3.2.0.jar:/opt/hadoop/share/ozone/lib/kerb-util-1.0.1.jar:/opt/hadoop/share/ozone/lib/jetty-http-9.4.26.v20200117.jar:/opt/hadoop/share/ozone/lib/jetty-xml-9.4.26.v20200117.jar:/opt/hadoop/share/ozone/lib/jackson-jaxrs-1.9.13.jar:/opt/hadoop/share/ozone/lib/ratis-thirdparty-misc-0.3.0.jar:/opt/hadoop/share/ozone/lib/kerby-xdr-1.0.1.jar:/opt/hadoop/share/ozone/lib/jackson-core-asl-1.9.13.jar:/opt/hadoop/share/ozone/lib/jetty-server-9.4.26.v20200117.jar:/opt/hadoop/share/ozone/lib/commons-net-3.6.jar:/opt/hadoop/share/ozone/lib/log4j-api-2.11.0.jar:/opt/hadoop/share/ozone/lib/hadoop-hdfs-3.2.0.jar:/opt/hadoop/share/ozone/lib/opentracing-api-0.31.0.jar:/opt/hadoop/share/ozone/lib/slf4j-log4j12-1.7.25.jar:/opt/hadoop/share/ozone/lib/hadoop-hdfs-client-3.2.0.jar:/opt/hadoop/share/ozone/lib/kerby-config-1.0.1.jar:/opt/hadoop/share/ozone/lib/libthrift-0.12.0.jar:/opt/hadoop/share/ozone/lib/jetty-util-ajax-9.4.26.v20200117.jar:/opt/hadoop/share/ozone/lib/metrics-core-3.2.4.jar:/opt/hadoop/share/ozone/lib/kerby-pkix-1.0.1.jar:/opt/hadoop/share/ozone/lib/guava-28.2-jre.jar:/opt/hadoop/share/ozone/lib/jetty-servlet-9.4.26.v20200117.jar:/opt/hadoop/share/ozone/lib/xz-1.0.jar:/opt/hadoop/share/ozone/lib/activation-1.1.1.jar:/opt/hadoop/share/ozone/lib/jsr311-api-1.1.1.jar:/opt/hadoop/share/ozone/lib/commons-beanutils-1.9.4.jar:/opt/hadoop/share/ozone/lib/rocksdbjni-6.6.4.jar:/opt/hadoop/share/ozone/lib/jetty-security-9.4.26.v20200117.jar:/opt/hadoop/share/ozone/lib/hadoop-hdds-container-service-0.6.0-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/kerb-server-1.0.1.jar:/opt/hadoop/share/ozone/lib/javax.servlet-api-3.1.0.jar:/opt/hadoop/share/ozone/lib/avro-1.7.7.jar:/opt/hadoop/share/ozone/lib/kerb-client-1.0.1.jar:/opt/hadoop/share/ozone/lib/jackson-xc-1.9.13.jar:/opt/hadoop/share/ozone/lib/disruptor-3.4.2.jar:/opt/hadoop/share/ozone/lib/simpleclient_common-0.7.0.jar:/opt/hadoop/share/ozone/lib/dnsjava-2.1.7.jar:/opt/hadoop/share/ozone/lib/jackson-annotations-2.10.3.jar:/opt/hadoop/share/ozone/lib/commons-configuration2-2.1.1.jar:/opt/hadoop/share/ozone/lib/json-smart-2.3.jar:/opt/hadoop/share/ozone/lib/token-provider-1.0.1.jar:/opt/hadoop/share/ozone/lib/log4j-1.2.17.jar:/opt/hadoop/share/ozone/lib/commons-daemon-1.0.13.jar:/opt/hadoop/share/ozone/lib/listenablefuture-9999.0-empty-to-avoid-conflict-with-guava.jar:/opt/hadoop/share/ozone/lib/bcprov-jdk15on-1.60.jar:/opt/hadoop/share/ozone/lib/ratis-grpc-0.6.0-7c5b30d-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/jetty-webapp-9.4.26.v20200117.jar:/opt/hadoop/share/ozone/lib/commons-lang3-3.7.jar:/opt/hadoop/share/ozone/lib/jaeger-client-0.34.0.jar:/opt/hadoop/share/ozone/lib/commons-compress-1.4.1.jar:/opt/hadoop/share/ozone/lib/accessors-smart-1.2.jar:/opt/hadoop/share/ozone/lib/re2j-1.1.jar:/opt/hadoop/share/ozone/lib/ratis-client-0.6.0-7c5b30d-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/commons-math3-3.1.1.jar:/opt/hadoop/share/ozone/lib/simpleclient_dropwizard-0.7.0.jar:/opt/hadoop/share/ozone/lib/opentracing-noop-0.31.0.jar:/opt/hadoop/share/ozone/lib/simpleclient-0.7.0.jar:/opt/hadoop/share/ozone/lib/httpclient-4.5.2.jar:/opt/hadoop/share/ozone/lib/jaeger-core-0.34.0.jar:/opt/hadoop/share/ozone/lib/asm-5.0.4.jar:/opt/hadoop/share/ozone/lib/kerby-util-1.0.1.jar:/opt/hadoop/share/ozone/lib/failureaccess-1.0.1.jar:/opt/hadoop/share/ozone/lib/jackson-mapper-asl-1.9.13.jar:/opt/hadoop/share/ozone/lib/jsp-api-2.1.jar:/opt/hadoop/share/ozone/lib/jsch-0.1.54.jar:/opt/hadoop/share/ozone/lib/ratis-metrics-0.6.0-7c5b30d-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/opentracing-tracerresolver-0.1.5.jar:/opt/hadoop/share/ozone/lib/ratis-common-0.6.0-7c5b30d-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/paranamer-2.3.jar:/opt/hadoop/share/ozone/lib/log4j-core-2.11.0.jar:/opt/hadoop/share/ozone/lib/nimbus-jose-jwt-7.9.jar:/opt/hadoop/share/ozone/lib/commons-codec-1.11.jar:/opt/hadoop/share/ozone/lib/commons-pool2-2.6.0.jar:/opt/hadoop/share/ozone/lib/jackson-datatype-jsr310-2.10.3.jar:/opt/hadoop/share/ozone/lib/gson-2.2.4.jar:/opt/hadoop/share/ozone/lib/jcip-annotations-1.0-1.jar:/opt/hadoop/share/ozone/lib/kerb-admin-1.0.1.jar:/opt/hadoop/share/ozone/lib/commons-io-2.5.jar:/opt/hadoop/share/ozone/lib/okio-1.13.0.jar:/opt/hadoop/share/ozone/lib/snakeyaml-1.16.jar:/opt/hadoop/share/ozone/lib/jetty-util-9.4.26.v20200117.jar:/opt/hadoop/share/ozone/lib/jersey-core-1.19.jar:/opt/hadoop/share/ozone/lib/hadoop-hdds-hadoop-dependency-client-0.6.0-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/checker-qual-2.10.0.jar:/opt/hadoop/share/ozone/lib/ratis-server-0.6.0-7c5b30d-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/hadoop-hdds-server-framework-0.6.0-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/error_prone_annotations-2.3.4.jar:/opt/hadoop/share/ozone/lib/picocli-3.9.6.jar:/opt/hadoop/share/ozone/lib/jaeger-thrift-0.34.0.jar:/opt/hadoop/share/ozone/lib/hadoop-hdds-common-0.6.0-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/commons-cli-1.2.jar:/opt/hadoop/share/ozone/lib/woodstox-core-5.0.3.jar:/opt/hadoop/share/ozone/lib/snappy-java-1.0.5.jar:/opt/hadoop/share/ozone/lib/javax.annotation-api-1.2.jar:/opt/hadoop/share/ozone/lib/jaeger-tracerresolver-0.34.0.jar:/opt/hadoop/share/ozone/lib/kerby-asn1-1.0.1.jar:/opt/hadoop/share/ozone/lib/okhttp-3.9.0.jar:/opt/hadoop/share/ozone/lib/hadoop-hdds-config-0.6.0-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/stax2-api-3.1.4.jar:/opt/hadoop/share/ozone/lib/commons-collections-3.2.2.jar:/opt/hadoop/share/ozone/lib/commons-digester-1.8.1.jar:/opt/hadoop/share/ozone/lib/jettison-1.1.jar:/opt/hadoop/share/ozone/lib/commons-text-1.4.jar:/opt/hadoop/share/ozone/lib/jackson-core-2.10.3.jar:/opt/hadoop/share/ozone/lib/jersey-servlet-1.19.jar:/opt/hadoop/share/ozone/lib/jersey-json-1.19.jar:/opt/hadoop/share/ozone/lib/slf4j-api-1.7.25.jar:/opt/hadoop/share/ozone/lib/commons-logging-1.1.3.jar:/opt/hadoop/share/ozone/lib/kerb-identity-1.0.1.jar:/opt/hadoop/share/ozone/lib/opentracing-util-0.31.0.jar:/opt/hadoop/share/ozone/lib/hadoop-hdds-hadoop-dependency-server-0.6.0-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/hadoop-common-3.2.0.jar:/opt/hadoop/share/ozone/lib/hadoop-auth-3.2.0.jar:/opt/hadoop/share/ozone/lib/kerb-common-1.0.1.jar:/opt/hadoop/share/ozone/lib/jaxb-core-2.3.0.1.jar:/opt/hadoop/share/ozone/lib/jersey-server-1.19.jar:/opt/hadoop/share/ozone/lib/hadoop-hdds-common-0.6.0-SNAPSHOT-tests.jar:/opt/hadoop/share/ozone/lib/kerb-crypto-1.0.1.jar:/opt/hadoop/share/ozone/lib/httpcore-4.4.4.jar:/opt/hadoop/share/ozone/lib/ratis-netty-0.6.0-7c5b30d-SNAPSHOT.jar:/opt/hadoop/share/ozone/web:/opt/hadoop/share/ozone/lib/hadoop-ozone-datanode-0.6.0-SNAPSHOT.jar
datanode_2_1  | 
scm_1         | STARTUP_MSG:   version = 3.2.0
datanode_4_1  | 2020-04-17 18:50:42,719 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.retrycache.expirytime = 600000ms (custom)
datanode_5_1  | Caused by: org.apache.ratis.protocol.GroupMismatchException: 978c057e-5c38-4e20-8a8b-f271c823af7e: Group group-385EF22ED913 not found.
om_1          | STARTUP_MSG:   build = https://github.com/apache/hadoop.git -r e97acb3bd8f3befd27418996fa5d4b50bf2e17bf; compiled by 'sunilg' on 2019-01-15T17:34Z
datanode_6_1  | STARTUP_MSG:   build = https://github.com/apache/hadoop.git -r e97acb3bd8f3befd27418996fa5d4b50bf2e17bf; compiled by 'sunilg' on 2019-01-15T17:34Z
datanode_2_1  | java.io.IOException: 0e99e1b0-220f-42bd-a39f-d4658f80d0e4: Group group-79E0035D853A not found.
datanode_4_1  | 2020-04-17 18:50:42,719 [pool-69-thread-1] INFO metrics.RatisMetrics: Creating Metrics Registry : ratis.leader_election.a0acbcec-d753-414c-b077-647d02aaa7fb@group-385EF22ED913
scm_1         | STARTUP_MSG:   classpath = /etc/hadoop:/opt/hadoop/share/hadoop/common/*:/opt/hadoop/share/ozone/lib/kerb-simplekdc-1.0.1.jar:/opt/hadoop/share/ozone/lib/jackson-databind-2.10.3.jar:/opt/hadoop/share/ozone/lib/protobuf-java-2.5.0.jar:/opt/hadoop/share/ozone/lib/bcpkix-jdk15on-1.60.jar:/opt/hadoop/share/ozone/lib/ratis-proto-0.6.0-7c5b30d-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/commons-validator-1.6.jar:/opt/hadoop/share/ozone/lib/hadoop-hdds-client-0.6.0-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/netty-3.10.5.Final.jar:/opt/hadoop/share/ozone/lib/netty-all-4.1.47.Final.jar:/opt/hadoop/share/ozone/lib/kerb-core-1.0.1.jar:/opt/hadoop/share/ozone/lib/jsr305-3.0.0.jar:/opt/hadoop/share/ozone/lib/j2objc-annotations-1.3.jar:/opt/hadoop/share/ozone/lib/leveldbjni-all-1.8.jar:/opt/hadoop/share/ozone/lib/jetty-io-9.4.26.v20200117.jar:/opt/hadoop/share/ozone/lib/htrace-core4-4.1.0-incubating.jar:/opt/hadoop/share/ozone/lib/hadoop-annotations-3.2.0.jar:/opt/hadoop/share/ozone/lib/jetty-http-9.4.26.v20200117.jar:/opt/hadoop/share/ozone/lib/kerb-util-1.0.1.jar:/opt/hadoop/share/ozone/lib/jetty-xml-9.4.26.v20200117.jar:/opt/hadoop/share/ozone/lib/jackson-jaxrs-1.9.13.jar:/opt/hadoop/share/ozone/lib/ratis-thirdparty-misc-0.3.0.jar:/opt/hadoop/share/ozone/lib/kerby-xdr-1.0.1.jar:/opt/hadoop/share/ozone/lib/jackson-core-asl-1.9.13.jar:/opt/hadoop/share/ozone/lib/jetty-server-9.4.26.v20200117.jar:/opt/hadoop/share/ozone/lib/commons-net-3.6.jar:/opt/hadoop/share/ozone/lib/log4j-api-2.11.0.jar:/opt/hadoop/share/ozone/lib/hadoop-hdfs-3.2.0.jar:/opt/hadoop/share/ozone/lib/opentracing-api-0.31.0.jar:/opt/hadoop/share/ozone/lib/slf4j-log4j12-1.7.25.jar:/opt/hadoop/share/ozone/lib/hadoop-hdfs-client-3.2.0.jar:/opt/hadoop/share/ozone/lib/kerby-config-1.0.1.jar:/opt/hadoop/share/ozone/lib/libthrift-0.12.0.jar:/opt/hadoop/share/ozone/lib/jetty-util-ajax-9.4.26.v20200117.jar:/opt/hadoop/share/ozone/lib/metrics-core-3.2.4.jar:/opt/hadoop/share/ozone/lib/guava-28.2-jre.jar:/opt/hadoop/share/ozone/lib/kerby-pkix-1.0.1.jar:/opt/hadoop/share/ozone/lib/xz-1.0.jar:/opt/hadoop/share/ozone/lib/jetty-servlet-9.4.26.v20200117.jar:/opt/hadoop/share/ozone/lib/jsr311-api-1.1.1.jar:/opt/hadoop/share/ozone/lib/commons-beanutils-1.9.4.jar:/opt/hadoop/share/ozone/lib/rocksdbjni-6.6.4.jar:/opt/hadoop/share/ozone/lib/hadoop-hdds-container-service-0.6.0-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/jetty-security-9.4.26.v20200117.jar:/opt/hadoop/share/ozone/lib/javax.servlet-api-3.1.0.jar:/opt/hadoop/share/ozone/lib/kerb-server-1.0.1.jar:/opt/hadoop/share/ozone/lib/avro-1.7.7.jar:/opt/hadoop/share/ozone/lib/kerb-client-1.0.1.jar:/opt/hadoop/share/ozone/lib/jackson-xc-1.9.13.jar:/opt/hadoop/share/ozone/lib/disruptor-3.4.2.jar:/opt/hadoop/share/ozone/lib/hadoop-hdds-docs-0.6.0-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/simpleclient_common-0.7.0.jar:/opt/hadoop/share/ozone/lib/dnsjava-2.1.7.jar:/opt/hadoop/share/ozone/lib/jackson-annotations-2.10.3.jar:/opt/hadoop/share/ozone/lib/commons-configuration2-2.1.1.jar:/opt/hadoop/share/ozone/lib/json-smart-2.3.jar:/opt/hadoop/share/ozone/lib/token-provider-1.0.1.jar:/opt/hadoop/share/ozone/lib/log4j-1.2.17.jar:/opt/hadoop/share/ozone/lib/commons-daemon-1.0.13.jar:/opt/hadoop/share/ozone/lib/listenablefuture-9999.0-empty-to-avoid-conflict-with-guava.jar:/opt/hadoop/share/ozone/lib/bcprov-jdk15on-1.60.jar:/opt/hadoop/share/ozone/lib/ratis-grpc-0.6.0-7c5b30d-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/jetty-webapp-9.4.26.v20200117.jar:/opt/hadoop/share/ozone/lib/commons-lang3-3.7.jar:/opt/hadoop/share/ozone/lib/jaeger-client-0.34.0.jar:/opt/hadoop/share/ozone/lib/commons-compress-1.4.1.jar:/opt/hadoop/share/ozone/lib/accessors-smart-1.2.jar:/opt/hadoop/share/ozone/lib/re2j-1.1.jar:/opt/hadoop/share/ozone/lib/ratis-client-0.6.0-7c5b30d-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/commons-math3-3.1.1.jar:/opt/hadoop/share/ozone/lib/simpleclient_dropwizard-0.7.0.jar:/opt/hadoop/share/ozone/lib/opentracing-noop-0.31.0.jar:/opt/hadoop/share/ozone/lib/simpleclient-0.7.0.jar:/opt/hadoop/share/ozone/lib/httpclient-4.5.2.jar:/opt/hadoop/share/ozone/lib/jaeger-core-0.34.0.jar:/opt/hadoop/share/ozone/lib/asm-5.0.4.jar:/opt/hadoop/share/ozone/lib/kerby-util-1.0.1.jar:/opt/hadoop/share/ozone/lib/failureaccess-1.0.1.jar:/opt/hadoop/share/ozone/lib/jackson-mapper-asl-1.9.13.jar:/opt/hadoop/share/ozone/lib/jsp-api-2.1.jar:/opt/hadoop/share/ozone/lib/jsch-0.1.54.jar:/opt/hadoop/share/ozone/lib/ratis-metrics-0.6.0-7c5b30d-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/opentracing-tracerresolver-0.1.5.jar:/opt/hadoop/share/ozone/lib/ratis-common-0.6.0-7c5b30d-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/paranamer-2.3.jar:/opt/hadoop/share/ozone/lib/log4j-core-2.11.0.jar:/opt/hadoop/share/ozone/lib/nimbus-jose-jwt-7.9.jar:/opt/hadoop/share/ozone/lib/commons-codec-1.11.jar:/opt/hadoop/share/ozone/lib/commons-pool2-2.6.0.jar:/opt/hadoop/share/ozone/lib/jackson-datatype-jsr310-2.10.3.jar:/opt/hadoop/share/ozone/lib/gson-2.2.4.jar:/opt/hadoop/share/ozone/lib/jcip-annotations-1.0-1.jar:/opt/hadoop/share/ozone/lib/kerb-admin-1.0.1.jar:/opt/hadoop/share/ozone/lib/commons-io-2.5.jar:/opt/hadoop/share/ozone/lib/okio-1.13.0.jar:/opt/hadoop/share/ozone/lib/snakeyaml-1.16.jar:/opt/hadoop/share/ozone/lib/jetty-util-9.4.26.v20200117.jar:/opt/hadoop/share/ozone/lib/hadoop-hdds-hadoop-dependency-client-0.6.0-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/jersey-core-1.19.jar:/opt/hadoop/share/ozone/lib/checker-qual-2.10.0.jar:/opt/hadoop/share/ozone/lib/ratis-server-0.6.0-7c5b30d-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/hadoop-hdds-server-framework-0.6.0-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/error_prone_annotations-2.3.4.jar:/opt/hadoop/share/ozone/lib/picocli-3.9.6.jar:/opt/hadoop/share/ozone/lib/jaeger-thrift-0.34.0.jar:/opt/hadoop/share/ozone/lib/hadoop-hdds-common-0.6.0-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/commons-cli-1.2.jar:/opt/hadoop/share/ozone/lib/woodstox-core-5.0.3.jar:/opt/hadoop/share/ozone/lib/javax.annotation-api-1.2.jar:/opt/hadoop/share/ozone/lib/snappy-java-1.0.5.jar:/opt/hadoop/share/ozone/lib/jaeger-tracerresolver-0.34.0.jar:/opt/hadoop/share/ozone/lib/kerby-asn1-1.0.1.jar:/opt/hadoop/share/ozone/lib/okhttp-3.9.0.jar:/opt/hadoop/share/ozone/lib/hadoop-hdds-config-0.6.0-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/stax2-api-3.1.4.jar:/opt/hadoop/share/ozone/lib/commons-digester-1.8.1.jar:/opt/hadoop/share/ozone/lib/commons-collections-3.2.2.jar:/opt/hadoop/share/ozone/lib/jettison-1.1.jar:/opt/hadoop/share/ozone/lib/commons-text-1.4.jar:/opt/hadoop/share/ozone/lib/jackson-core-2.10.3.jar:/opt/hadoop/share/ozone/lib/jersey-servlet-1.19.jar:/opt/hadoop/share/ozone/lib/jersey-json-1.19.jar:/opt/hadoop/share/ozone/lib/slf4j-api-1.7.25.jar:/opt/hadoop/share/ozone/lib/commons-logging-1.1.3.jar:/opt/hadoop/share/ozone/lib/kerb-identity-1.0.1.jar:/opt/hadoop/share/ozone/lib/opentracing-util-0.31.0.jar:/opt/hadoop/share/ozone/lib/hadoop-hdds-hadoop-dependency-server-0.6.0-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/hadoop-common-3.2.0.jar:/opt/hadoop/share/ozone/lib/hadoop-auth-3.2.0.jar:/opt/hadoop/share/ozone/lib/kerb-common-1.0.1.jar:/opt/hadoop/share/ozone/lib/jersey-server-1.19.jar:/opt/hadoop/share/ozone/lib/hadoop-hdds-common-0.6.0-SNAPSHOT-tests.jar:/opt/hadoop/share/ozone/lib/kerb-crypto-1.0.1.jar:/opt/hadoop/share/ozone/lib/httpcore-4.4.4.jar:/opt/hadoop/share/ozone/lib/ratis-netty-0.6.0-7c5b30d-SNAPSHOT.jar:/opt/hadoop/share/ozone/web:/opt/hadoop/share/ozone/lib/hadoop-hdds-server-scm-0.6.0-SNAPSHOT.jar
datanode_5_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupRemoveAsync(RaftServerProxy.java:404)
om_1          | STARTUP_MSG:   java = 11.0.6
datanode_6_1  | STARTUP_MSG:   java = 11.0.6
datanode_2_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.XceiverServerRatis.removeGroup(XceiverServerRatis.java:659)
datanode_4_1  | 2020-04-17 18:50:42,720 [pool-69-thread-1] INFO metrics.RatisMetrics: Creating Metrics Registry : ratis.server.a0acbcec-d753-414c-b077-647d02aaa7fb@group-385EF22ED913
scm_1         | STARTUP_MSG:   build = https://github.com/apache/hadoop.git -r e97acb3bd8f3befd27418996fa5d4b50bf2e17bf; compiled by 'sunilg' on 2019-01-15T17:34Z
datanode_5_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupManagementAsync(RaftServerProxy.java:367)
om_1          | ************************************************************/
datanode_6_1  | ************************************************************/
datanode_2_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.ClosePipelineCommandHandler.handle(ClosePipelineCommandHandler.java:77)
datanode_4_1  | 2020-04-17 18:50:42,720 [pool-69-thread-1] INFO impl.RaftServerImpl: a0acbcec-d753-414c-b077-647d02aaa7fb@group-385EF22ED913: start as a follower, conf=-1: [978c057e-5c38-4e20-8a8b-f271c823af7e:10.5.0.8:9858, a0acbcec-d753-414c-b077-647d02aaa7fb:10.5.0.7:9858, 0e99e1b0-220f-42bd-a39f-d4658f80d0e4:10.5.0.5:9858], old=null
scm_1         | STARTUP_MSG:   java = 11.0.6
datanode_5_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupManagement(RaftServerProxy.java:350)
om_1          | 2020-04-17 18:50:15,599 [main] INFO om.OzoneManagerStarter: registered UNIX signal handlers for [TERM, HUP, INT]
datanode_6_1  | 2020-04-17 18:50:16,714 [main] INFO ozone.HddsDatanodeService: registered UNIX signal handlers for [TERM, HUP, INT]
datanode_2_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.CommandDispatcher.handle(CommandDispatcher.java:99)
datanode_4_1  | 2020-04-17 18:50:42,720 [pool-69-thread-1] INFO impl.RaftServerImpl: a0acbcec-d753-414c-b077-647d02aaa7fb@group-385EF22ED913: changes role from      null to FOLLOWER at term 0 for startAsFollower
scm_1         | ************************************************************/
datanode_5_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.XceiverServerRatis.removeGroup(XceiverServerRatis.java:657)
om_1          | 2020-04-17 18:50:21,554 [main] INFO ha.OMHANodeDetails: ozone.om.internal.service.id is not defined, falling back to ozone.om.service.ids to find serviceID for OzoneManager if it is HA enabled cluster
datanode_6_1  | 2020-04-17 18:50:18,752 [main] INFO metrics.MetricRegistries: Loaded MetricRegistries class org.apache.ratis.metrics.impl.MetricRegistriesImpl
datanode_2_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.lambda$initCommandHandlerThread$1(DatanodeStateMachine.java:472)
datanode_4_1  | 2020-04-17 18:50:42,720 [pool-69-thread-1] INFO impl.RoleInfo: a0acbcec-d753-414c-b077-647d02aaa7fb: start FollowerState
scm_1         | 2020-04-17 18:50:14,733 [main] INFO server.StorageContainerManagerStarter: registered UNIX signal handlers for [TERM, HUP, INT]
datanode_5_1  | 	... 4 more
om_1          | 2020-04-17 18:50:21,823 [main] INFO ha.OMHANodeDetails: Configuration either no ozone.om.address set. Falling back to the default OM address om/10.5.0.70:9862
datanode_6_1  | 2020-04-17 18:50:19,429 [main] INFO impl.MetricsConfig: Loaded properties from hadoop-metrics2.properties
datanode_2_1  | 	at java.base/java.lang.Thread.run(Thread.java:834)
datanode_4_1  | 2020-04-17 18:50:42,735 [pool-69-thread-1] INFO util.JmxRegister: Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-385EF22ED913,id=a0acbcec-d753-414c-b077-647d02aaa7fb
scm_1         | 2020-04-17 18:50:15,459 [main] WARN server.ServerUtils: ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
datanode_5_1  | 2020-04-17 18:52:35,083 [Thread-80] INFO impl.FollowerState: 978c057e-5c38-4e20-8a8b-f271c823af7e@group-79E0035D853A-FollowerState: change to CANDIDATE, lastRpcTime:5123ms, electionTimeout:5122ms
om_1          | 2020-04-17 18:50:21,823 [main] INFO ha.OMHANodeDetails: OM Service ID is not set. Setting it to the default ID: omServiceIdDefault
datanode_6_1  | 2020-04-17 18:50:20,790 [main] INFO impl.MetricsSystemImpl: Scheduled Metric snapshot period at 10 second(s).
datanode_2_1  | Caused by: org.apache.ratis.protocol.GroupMismatchException: 0e99e1b0-220f-42bd-a39f-d4658f80d0e4: Group group-79E0035D853A not found.
datanode_4_1  | 2020-04-17 18:50:42,735 [pool-69-thread-1] INFO metrics.RatisMetrics: Creating Metrics Registry : ratis.state_machine.a0acbcec-d753-414c-b077-647d02aaa7fb@group-385EF22ED913
scm_1         | 2020-04-17 18:50:15,849 [main] INFO server.StorageContainerManager: SCM initialization succeeded. Current cluster id for sd=/data/metadata/scm;cid=CID-46a43b72-9de3-4aef-aee3-5cfff90de303
datanode_5_1  | 2020-04-17 18:52:35,083 [Thread-80] INFO impl.RoleInfo: 978c057e-5c38-4e20-8a8b-f271c823af7e: shutdown FollowerState
om_1          | 2020-04-17 18:50:21,840 [main] WARN server.ServerUtils: ozone.om.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
datanode_6_1  | 2020-04-17 18:50:20,790 [main] INFO impl.MetricsSystemImpl: HddsDatanode metrics system started
datanode_6_1  | 2020-04-17 18:50:21,948 [main] INFO ozone.HddsDatanodeService: HddsDatanodeService host:9608d796128b ip:10.5.0.9
datanode_4_1  | 2020-04-17 18:50:45,213 [grpc-default-executor-0] WARN impl.RaftServerProxy: a0acbcec-d753-414c-b077-647d02aaa7fb: Failed groupAdd* GroupManagementRequest:client-2069A423E535->a0acbcec-d753-414c-b077-647d02aaa7fb@group-385EF22ED913, cid=0, seq=0, RW, null, Add:group-385EF22ED913:[978c057e-5c38-4e20-8a8b-f271c823af7e:10.5.0.8:9858, a0acbcec-d753-414c-b077-647d02aaa7fb:10.5.0.7:9858, 0e99e1b0-220f-42bd-a39f-d4658f80d0e4:10.5.0.5:9858]
scm_1         | 2020-04-17 18:50:16,028 [shutdown-hook-0] INFO server.StorageContainerManagerStarter: SHUTDOWN_MSG: 
datanode_5_1  | 2020-04-17 18:52:35,084 [Thread-80] INFO impl.RaftServerImpl: 978c057e-5c38-4e20-8a8b-f271c823af7e@group-79E0035D853A: changes role from  FOLLOWER to CANDIDATE at term 0 for changeToCandidate
om_1          | 2020-04-17 18:50:24,426 [main] INFO ipc.Client: Retrying connect to server: scm/10.5.0.71:9863. Already tried 0 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=10, sleepTime=1000 MILLISECONDS)
datanode_6_1  | 2020-04-17 18:50:22,517 [main] INFO fs.SaveSpaceUsageToFile: Cached usage info file /data/hdds/scmUsed not found
datanode_2_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupRemoveAsync(RaftServerProxy.java:404)
datanode_4_1  | java.util.concurrent.CompletionException: org.apache.ratis.protocol.AlreadyExistsException: a0acbcec-d753-414c-b077-647d02aaa7fb: Failed to add group-385EF22ED913:[978c057e-5c38-4e20-8a8b-f271c823af7e:10.5.0.8:9858, a0acbcec-d753-414c-b077-647d02aaa7fb:10.5.0.7:9858, 0e99e1b0-220f-42bd-a39f-d4658f80d0e4:10.5.0.5:9858] since the group already exists in the map.
scm_1         | /************************************************************
datanode_5_1  | 2020-04-17 18:52:35,084 [Thread-80] INFO impl.RoleInfo: 978c057e-5c38-4e20-8a8b-f271c823af7e: start LeaderElection
om_1          | 2020-04-17 18:50:25,427 [main] INFO ipc.Client: Retrying connect to server: scm/10.5.0.71:9863. Already tried 1 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=10, sleepTime=1000 MILLISECONDS)
datanode_6_1  | 2020-04-17 18:50:22,562 [main] INFO volume.HddsVolume: Creating Volume: /data/hdds/hdds of storage type : DISK and capacity : 89311358976
datanode_2_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupManagementAsync(RaftServerProxy.java:367)
datanode_4_1  | 	at java.base/java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:331)
scm_1         | SHUTDOWN_MSG: Shutting down StorageContainerManager at 1bdb9e39544a/10.5.0.71
datanode_5_1  | 2020-04-17 18:52:35,087 [978c057e-5c38-4e20-8a8b-f271c823af7e@group-79E0035D853A-LeaderElection2] INFO impl.LeaderElection: 978c057e-5c38-4e20-8a8b-f271c823af7e@group-79E0035D853A-LeaderElection2: begin an election at term 1 for -1: [978c057e-5c38-4e20-8a8b-f271c823af7e:10.5.0.8:9858, a0acbcec-d753-414c-b077-647d02aaa7fb:10.5.0.7:9858, 0e99e1b0-220f-42bd-a39f-d4658f80d0e4:10.5.0.5:9858], old=null
om_1          | 2020-04-17 18:50:26,428 [main] INFO ipc.Client: Retrying connect to server: scm/10.5.0.71:9863. Already tried 2 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=10, sleepTime=1000 MILLISECONDS)
datanode_6_1  | 2020-04-17 18:50:22,564 [main] INFO volume.MutableVolumeSet: Added Volume : /data/hdds/hdds to VolumeSet
datanode_2_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupManagement(RaftServerProxy.java:350)
datanode_4_1  | 	at java.base/java.util.concurrent.CompletableFuture.uniApplyNow(CompletableFuture.java:670)
scm_1         | ************************************************************/
datanode_5_1  | 2020-04-17 18:52:35,134 [978c057e-5c38-4e20-8a8b-f271c823af7e@group-79E0035D853A-LeaderElection2] INFO impl.LeaderElection: 978c057e-5c38-4e20-8a8b-f271c823af7e@group-79E0035D853A-LeaderElection2: Election PASSED; received 1 response(s) [978c057e-5c38-4e20-8a8b-f271c823af7e<-0e99e1b0-220f-42bd-a39f-d4658f80d0e4#0:OK-t1] and 0 exception(s); 978c057e-5c38-4e20-8a8b-f271c823af7e@group-79E0035D853A:t1, leader=null, voted=978c057e-5c38-4e20-8a8b-f271c823af7e, raftlog=978c057e-5c38-4e20-8a8b-f271c823af7e@group-79E0035D853A-SegmentedRaftLog:OPENED:c-1,f-1,i0, conf=-1: [978c057e-5c38-4e20-8a8b-f271c823af7e:10.5.0.8:9858, a0acbcec-d753-414c-b077-647d02aaa7fb:10.5.0.7:9858, 0e99e1b0-220f-42bd-a39f-d4658f80d0e4:10.5.0.5:9858], old=null
om_1          | 2020-04-17 18:50:27,428 [main] INFO ipc.Client: Retrying connect to server: scm/10.5.0.71:9863. Already tried 3 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=10, sleepTime=1000 MILLISECONDS)
datanode_6_1  | 2020-04-17 18:50:22,570 [main] INFO volume.ThrottledAsyncChecker: Scheduling a check for /data/hdds/hdds
datanode_2_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.XceiverServerRatis.removeGroup(XceiverServerRatis.java:657)
datanode_4_1  | 	at java.base/java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:658)
scm_1         | Enabled profiling in kernel
datanode_5_1  | 2020-04-17 18:52:35,135 [978c057e-5c38-4e20-8a8b-f271c823af7e@group-79E0035D853A-LeaderElection2] INFO impl.RoleInfo: 978c057e-5c38-4e20-8a8b-f271c823af7e: shutdown LeaderElection
om_1          | 2020-04-17 18:50:28,429 [main] INFO ipc.Client: Retrying connect to server: scm/10.5.0.71:9863. Already tried 4 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=10, sleepTime=1000 MILLISECONDS)
datanode_6_1  | 2020-04-17 18:50:22,781 [main] INFO volume.HddsVolumeChecker: Scheduled health check for volume /data/hdds/hdds
datanode_2_1  | 	... 4 more
datanode_4_1  | 	at java.base/java.util.concurrent.CompletableFuture.thenApplyAsync(CompletableFuture.java:2104)
scm_1         | No '-XX:...' jvm parameters are used. Adding safer GC settings to the HADOOP_OPTS
datanode_5_1  | 2020-04-17 18:52:35,135 [978c057e-5c38-4e20-8a8b-f271c823af7e@group-79E0035D853A-LeaderElection2] INFO impl.RaftServerImpl: 978c057e-5c38-4e20-8a8b-f271c823af7e@group-79E0035D853A: changes role from CANDIDATE to LEADER at term 1 for changeToLeader
om_1          | 2020-04-17 18:50:29,430 [main] INFO ipc.Client: Retrying connect to server: scm/10.5.0.71:9863. Already tried 5 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=10, sleepTime=1000 MILLISECONDS)
datanode_6_1  | 2020-04-17 18:50:28,700 [main] WARN server.ServerUtils: Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
datanode_2_1  | 2020-04-17 18:54:08,662 [Command processor thread] INFO impl.RaftServerProxy: 0e99e1b0-220f-42bd-a39f-d4658f80d0e4: remove group-79E0035D853A:null
datanode_4_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupAddAsync(RaftServerProxy.java:379)
scm_1         | OpenJDK 64-Bit Server VM warning: Option UseConcMarkSweepGC was deprecated in version 9.0 and will likely be removed in a future release.
datanode_5_1  | 2020-04-17 18:52:35,135 [978c057e-5c38-4e20-8a8b-f271c823af7e@group-79E0035D853A-LeaderElection2] INFO ratis.XceiverServerRatis: Leader change notification received for group: group-79E0035D853A with new leaderId: 978c057e-5c38-4e20-8a8b-f271c823af7e
om_1          | 2020-04-17 18:50:30,431 [main] INFO ipc.Client: Retrying connect to server: scm/10.5.0.71:9863. Already tried 6 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=10, sleepTime=1000 MILLISECONDS)
datanode_6_1  | 2020-04-17 18:50:28,972 [main] INFO impl.RaftServerProxy: raft.rpc.type = GRPC (default)
datanode_2_1  | 2020-04-17 18:54:08,662 [Command processor thread] ERROR commandhandler.ClosePipelineCommandHandler: Can't close pipeline #id: "cad403d1-ea2f-4530-84e5-79e0035d853a"
datanode_4_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupManagementAsync(RaftServerProxy.java:363)
scm_1         | 2020-04-17 18:50:31,320 [main] INFO server.StorageContainerManagerStarter: STARTUP_MSG: 
datanode_5_1  | 2020-04-17 18:52:35,136 [978c057e-5c38-4e20-8a8b-f271c823af7e@group-79E0035D853A-LeaderElection2] INFO impl.RaftServerImpl: 978c057e-5c38-4e20-8a8b-f271c823af7e@group-79E0035D853A: change Leader from null to 978c057e-5c38-4e20-8a8b-f271c823af7e at term 1 for becomeLeader, leader elected after 5197ms
om_1          | 2020-04-17 18:50:31,432 [main] INFO ipc.Client: Retrying connect to server: scm/10.5.0.71:9863. Already tried 7 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=10, sleepTime=1000 MILLISECONDS)
datanode_6_1  | 2020-04-17 18:50:29,512 [main] INFO grpc.GrpcConfigKeys: raft.grpc.server.port = 9858 (custom)
datanode_2_1  | 
datanode_4_1  | 	at org.apache.ratis.grpc.server.GrpcAdminProtocolService.lambda$groupManagement$0(GrpcAdminProtocolService.java:42)
scm_1         | /************************************************************
datanode_5_1  | 2020-04-17 18:52:35,136 [978c057e-5c38-4e20-8a8b-f271c823af7e@group-79E0035D853A-LeaderElection2] INFO server.RaftServerConfigKeys: raft.server.staging.catchup.gap = 1000 (default)
om_1          | 2020-04-17 18:50:32,433 [main] INFO ipc.Client: Retrying connect to server: scm/10.5.0.71:9863. Already tried 8 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=10, sleepTime=1000 MILLISECONDS)
datanode_6_1  | 2020-04-17 18:50:29,513 [main] INFO server.GrpcService: raft.grpc.message.size.max = 32MB (=33554432) (custom)
datanode_2_1  | java.io.IOException: 0e99e1b0-220f-42bd-a39f-d4658f80d0e4: Group group-79E0035D853A not found.
datanode_4_1  | 	at org.apache.ratis.grpc.GrpcUtil.asyncCall(GrpcUtil.java:160)
scm_1         | STARTUP_MSG: Starting StorageContainerManager
datanode_5_1  | 2020-04-17 18:52:35,138 [978c057e-5c38-4e20-8a8b-f271c823af7e@group-79E0035D853A-LeaderElection2] INFO server.RaftServerConfigKeys: raft.server.rpc.sleep.time = 25ms (default)
datanode_6_1  | 2020-04-17 18:50:29,513 [main] INFO server.RaftServerConfigKeys: raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
datanode_2_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.XceiverServerRatis.removeGroup(XceiverServerRatis.java:659)
datanode_4_1  | 	at org.apache.ratis.grpc.server.GrpcAdminProtocolService.groupManagement(GrpcAdminProtocolService.java:42)
scm_1         | STARTUP_MSG:   host = 1bdb9e39544a/10.5.0.71
om_1          | 2020-04-17 18:50:33,433 [main] INFO ipc.Client: Retrying connect to server: scm/10.5.0.71:9863. Already tried 9 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=10, sleepTime=1000 MILLISECONDS)
datanode_6_1  | 2020-04-17 18:50:29,514 [main] INFO server.GrpcService: raft.grpc.flow.control.window = 5MB (=5242880) (custom)
datanode_2_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.ClosePipelineCommandHandler.handle(ClosePipelineCommandHandler.java:77)
datanode_5_1  | 2020-04-17 18:52:35,139 [978c057e-5c38-4e20-8a8b-f271c823af7e@group-79E0035D853A-LeaderElection2] INFO metrics.RatisMetrics: Creating Metrics Registry : ratis.log_appender.978c057e-5c38-4e20-8a8b-f271c823af7e@group-79E0035D853A
datanode_4_1  | 	at org.apache.ratis.proto.grpc.AdminProtocolServiceGrpc$MethodHandlers.invoke(AdminProtocolServiceGrpc.java:358)
scm_1         | STARTUP_MSG:   args = []
om_1          | 2020-04-17 18:50:33,436 [main] INFO utils.RetriableTask: Execution of task OM#getScmInfo failed, will be retried in 5000 ms
datanode_6_1  | 2020-04-17 18:50:29,514 [main] INFO server.RaftServerConfigKeys: raft.server.rpc.request.timeout = 60s (custom)
datanode_2_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.CommandDispatcher.handle(CommandDispatcher.java:99)
datanode_5_1  | 2020-04-17 18:52:35,140 [978c057e-5c38-4e20-8a8b-f271c823af7e@group-79E0035D853A-LeaderElection2] INFO server.RaftServerConfigKeys: raft.server.write.element-limit = 1024 (custom)
datanode_4_1  | 	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$UnaryServerCallHandler$UnaryServerCallListener.onHalfClose(ServerCalls.java:172)
scm_1         | STARTUP_MSG:   version = 3.2.0
datanode_2_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.lambda$initCommandHandlerThread$1(DatanodeStateMachine.java:472)
datanode_5_1  | 2020-04-17 18:52:35,140 [978c057e-5c38-4e20-8a8b-f271c823af7e@group-79E0035D853A-LeaderElection2] INFO server.RaftServerConfigKeys: raft.server.write.byte-limit = 1073741824 (custom)
datanode_4_1  | 	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.halfClosed(ServerCallImpl.java:331)
datanode_6_1  | 2020-04-17 18:50:31,071 [main] INFO server.RaftServerConfigKeys: raft.server.storage.dir = [/data/metadata/ratis] (custom)
datanode_2_1  | 	at java.base/java.lang.Thread.run(Thread.java:834)
om_1          | OM initialization succeeded.Current cluster id for sd=/data/metadata/om;cid=CID-46a43b72-9de3-4aef-aee3-5cfff90de303
datanode_5_1  | 2020-04-17 18:52:35,141 [978c057e-5c38-4e20-8a8b-f271c823af7e@group-79E0035D853A-LeaderElection2] INFO server.RaftServerConfigKeys: raft.server.watch.timeout = 180s (custom)
datanode_4_1  | 	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1HalfClosed.runInContext(ServerImpl.java:814)
datanode_6_1  | 2020-04-17 18:50:31,766 [main] INFO http.BaseHttpServer: Starting Web-server for hddsDatanode at: http://0.0.0.0:9882
datanode_2_1  | Caused by: org.apache.ratis.protocol.GroupMismatchException: 0e99e1b0-220f-42bd-a39f-d4658f80d0e4: Group group-79E0035D853A not found.
om_1          | 2020-04-17 18:50:38,548 [shutdown-hook-0] INFO om.OzoneManagerStarter: SHUTDOWN_MSG: 
scm_1         | STARTUP_MSG:   classpath = /etc/hadoop:/opt/hadoop/share/hadoop/common/*:/opt/hadoop/share/ozone/lib/kerb-simplekdc-1.0.1.jar:/opt/hadoop/share/ozone/lib/jackson-databind-2.10.3.jar:/opt/hadoop/share/ozone/lib/protobuf-java-2.5.0.jar:/opt/hadoop/share/ozone/lib/bcpkix-jdk15on-1.60.jar:/opt/hadoop/share/ozone/lib/ratis-proto-0.6.0-7c5b30d-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/commons-validator-1.6.jar:/opt/hadoop/share/ozone/lib/hadoop-hdds-client-0.6.0-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/netty-3.10.5.Final.jar:/opt/hadoop/share/ozone/lib/netty-all-4.1.47.Final.jar:/opt/hadoop/share/ozone/lib/kerb-core-1.0.1.jar:/opt/hadoop/share/ozone/lib/jsr305-3.0.0.jar:/opt/hadoop/share/ozone/lib/j2objc-annotations-1.3.jar:/opt/hadoop/share/ozone/lib/leveldbjni-all-1.8.jar:/opt/hadoop/share/ozone/lib/jetty-io-9.4.26.v20200117.jar:/opt/hadoop/share/ozone/lib/htrace-core4-4.1.0-incubating.jar:/opt/hadoop/share/ozone/lib/hadoop-annotations-3.2.0.jar:/opt/hadoop/share/ozone/lib/jetty-http-9.4.26.v20200117.jar:/opt/hadoop/share/ozone/lib/kerb-util-1.0.1.jar:/opt/hadoop/share/ozone/lib/jetty-xml-9.4.26.v20200117.jar:/opt/hadoop/share/ozone/lib/jackson-jaxrs-1.9.13.jar:/opt/hadoop/share/ozone/lib/ratis-thirdparty-misc-0.3.0.jar:/opt/hadoop/share/ozone/lib/kerby-xdr-1.0.1.jar:/opt/hadoop/share/ozone/lib/jackson-core-asl-1.9.13.jar:/opt/hadoop/share/ozone/lib/jetty-server-9.4.26.v20200117.jar:/opt/hadoop/share/ozone/lib/commons-net-3.6.jar:/opt/hadoop/share/ozone/lib/log4j-api-2.11.0.jar:/opt/hadoop/share/ozone/lib/hadoop-hdfs-3.2.0.jar:/opt/hadoop/share/ozone/lib/opentracing-api-0.31.0.jar:/opt/hadoop/share/ozone/lib/slf4j-log4j12-1.7.25.jar:/opt/hadoop/share/ozone/lib/hadoop-hdfs-client-3.2.0.jar:/opt/hadoop/share/ozone/lib/kerby-config-1.0.1.jar:/opt/hadoop/share/ozone/lib/libthrift-0.12.0.jar:/opt/hadoop/share/ozone/lib/jetty-util-ajax-9.4.26.v20200117.jar:/opt/hadoop/share/ozone/lib/metrics-core-3.2.4.jar:/opt/hadoop/share/ozone/lib/guava-28.2-jre.jar:/opt/hadoop/share/ozone/lib/kerby-pkix-1.0.1.jar:/opt/hadoop/share/ozone/lib/xz-1.0.jar:/opt/hadoop/share/ozone/lib/jetty-servlet-9.4.26.v20200117.jar:/opt/hadoop/share/ozone/lib/jsr311-api-1.1.1.jar:/opt/hadoop/share/ozone/lib/commons-beanutils-1.9.4.jar:/opt/hadoop/share/ozone/lib/rocksdbjni-6.6.4.jar:/opt/hadoop/share/ozone/lib/hadoop-hdds-container-service-0.6.0-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/jetty-security-9.4.26.v20200117.jar:/opt/hadoop/share/ozone/lib/javax.servlet-api-3.1.0.jar:/opt/hadoop/share/ozone/lib/kerb-server-1.0.1.jar:/opt/hadoop/share/ozone/lib/avro-1.7.7.jar:/opt/hadoop/share/ozone/lib/kerb-client-1.0.1.jar:/opt/hadoop/share/ozone/lib/jackson-xc-1.9.13.jar:/opt/hadoop/share/ozone/lib/disruptor-3.4.2.jar:/opt/hadoop/share/ozone/lib/hadoop-hdds-docs-0.6.0-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/simpleclient_common-0.7.0.jar:/opt/hadoop/share/ozone/lib/dnsjava-2.1.7.jar:/opt/hadoop/share/ozone/lib/jackson-annotations-2.10.3.jar:/opt/hadoop/share/ozone/lib/commons-configuration2-2.1.1.jar:/opt/hadoop/share/ozone/lib/json-smart-2.3.jar:/opt/hadoop/share/ozone/lib/token-provider-1.0.1.jar:/opt/hadoop/share/ozone/lib/log4j-1.2.17.jar:/opt/hadoop/share/ozone/lib/commons-daemon-1.0.13.jar:/opt/hadoop/share/ozone/lib/listenablefuture-9999.0-empty-to-avoid-conflict-with-guava.jar:/opt/hadoop/share/ozone/lib/bcprov-jdk15on-1.60.jar:/opt/hadoop/share/ozone/lib/ratis-grpc-0.6.0-7c5b30d-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/jetty-webapp-9.4.26.v20200117.jar:/opt/hadoop/share/ozone/lib/commons-lang3-3.7.jar:/opt/hadoop/share/ozone/lib/jaeger-client-0.34.0.jar:/opt/hadoop/share/ozone/lib/commons-compress-1.4.1.jar:/opt/hadoop/share/ozone/lib/accessors-smart-1.2.jar:/opt/hadoop/share/ozone/lib/re2j-1.1.jar:/opt/hadoop/share/ozone/lib/ratis-client-0.6.0-7c5b30d-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/commons-math3-3.1.1.jar:/opt/hadoop/share/ozone/lib/simpleclient_dropwizard-0.7.0.jar:/opt/hadoop/share/ozone/lib/opentracing-noop-0.31.0.jar:/opt/hadoop/share/ozone/lib/simpleclient-0.7.0.jar:/opt/hadoop/share/ozone/lib/httpclient-4.5.2.jar:/opt/hadoop/share/ozone/lib/jaeger-core-0.34.0.jar:/opt/hadoop/share/ozone/lib/asm-5.0.4.jar:/opt/hadoop/share/ozone/lib/kerby-util-1.0.1.jar:/opt/hadoop/share/ozone/lib/failureaccess-1.0.1.jar:/opt/hadoop/share/ozone/lib/jackson-mapper-asl-1.9.13.jar:/opt/hadoop/share/ozone/lib/jsp-api-2.1.jar:/opt/hadoop/share/ozone/lib/jsch-0.1.54.jar:/opt/hadoop/share/ozone/lib/ratis-metrics-0.6.0-7c5b30d-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/opentracing-tracerresolver-0.1.5.jar:/opt/hadoop/share/ozone/lib/ratis-common-0.6.0-7c5b30d-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/paranamer-2.3.jar:/opt/hadoop/share/ozone/lib/log4j-core-2.11.0.jar:/opt/hadoop/share/ozone/lib/nimbus-jose-jwt-7.9.jar:/opt/hadoop/share/ozone/lib/commons-codec-1.11.jar:/opt/hadoop/share/ozone/lib/commons-pool2-2.6.0.jar:/opt/hadoop/share/ozone/lib/jackson-datatype-jsr310-2.10.3.jar:/opt/hadoop/share/ozone/lib/gson-2.2.4.jar:/opt/hadoop/share/ozone/lib/jcip-annotations-1.0-1.jar:/opt/hadoop/share/ozone/lib/kerb-admin-1.0.1.jar:/opt/hadoop/share/ozone/lib/commons-io-2.5.jar:/opt/hadoop/share/ozone/lib/okio-1.13.0.jar:/opt/hadoop/share/ozone/lib/snakeyaml-1.16.jar:/opt/hadoop/share/ozone/lib/jetty-util-9.4.26.v20200117.jar:/opt/hadoop/share/ozone/lib/hadoop-hdds-hadoop-dependency-client-0.6.0-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/jersey-core-1.19.jar:/opt/hadoop/share/ozone/lib/checker-qual-2.10.0.jar:/opt/hadoop/share/ozone/lib/ratis-server-0.6.0-7c5b30d-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/hadoop-hdds-server-framework-0.6.0-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/error_prone_annotations-2.3.4.jar:/opt/hadoop/share/ozone/lib/picocli-3.9.6.jar:/opt/hadoop/share/ozone/lib/jaeger-thrift-0.34.0.jar:/opt/hadoop/share/ozone/lib/hadoop-hdds-common-0.6.0-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/commons-cli-1.2.jar:/opt/hadoop/share/ozone/lib/woodstox-core-5.0.3.jar:/opt/hadoop/share/ozone/lib/javax.annotation-api-1.2.jar:/opt/hadoop/share/ozone/lib/snappy-java-1.0.5.jar:/opt/hadoop/share/ozone/lib/jaeger-tracerresolver-0.34.0.jar:/opt/hadoop/share/ozone/lib/kerby-asn1-1.0.1.jar:/opt/hadoop/share/ozone/lib/okhttp-3.9.0.jar:/opt/hadoop/share/ozone/lib/hadoop-hdds-config-0.6.0-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/stax2-api-3.1.4.jar:/opt/hadoop/share/ozone/lib/commons-digester-1.8.1.jar:/opt/hadoop/share/ozone/lib/commons-collections-3.2.2.jar:/opt/hadoop/share/ozone/lib/jettison-1.1.jar:/opt/hadoop/share/ozone/lib/commons-text-1.4.jar:/opt/hadoop/share/ozone/lib/jackson-core-2.10.3.jar:/opt/hadoop/share/ozone/lib/jersey-servlet-1.19.jar:/opt/hadoop/share/ozone/lib/jersey-json-1.19.jar:/opt/hadoop/share/ozone/lib/slf4j-api-1.7.25.jar:/opt/hadoop/share/ozone/lib/commons-logging-1.1.3.jar:/opt/hadoop/share/ozone/lib/kerb-identity-1.0.1.jar:/opt/hadoop/share/ozone/lib/opentracing-util-0.31.0.jar:/opt/hadoop/share/ozone/lib/hadoop-hdds-hadoop-dependency-server-0.6.0-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/hadoop-common-3.2.0.jar:/opt/hadoop/share/ozone/lib/hadoop-auth-3.2.0.jar:/opt/hadoop/share/ozone/lib/kerb-common-1.0.1.jar:/opt/hadoop/share/ozone/lib/jersey-server-1.19.jar:/opt/hadoop/share/ozone/lib/hadoop-hdds-common-0.6.0-SNAPSHOT-tests.jar:/opt/hadoop/share/ozone/lib/kerb-crypto-1.0.1.jar:/opt/hadoop/share/ozone/lib/httpcore-4.4.4.jar:/opt/hadoop/share/ozone/lib/ratis-netty-0.6.0-7c5b30d-SNAPSHOT.jar:/opt/hadoop/share/ozone/web:/opt/hadoop/share/ozone/lib/hadoop-hdds-server-scm-0.6.0-SNAPSHOT.jar
datanode_5_1  | 2020-04-17 18:52:35,141 [978c057e-5c38-4e20-8a8b-f271c823af7e@group-79E0035D853A-LeaderElection2] INFO server.RaftServerConfigKeys: raft.server.watch.timeout.denomination = 1s (default)
datanode_4_1  | 	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
datanode_6_1  | 2020-04-17 18:50:31,908 [main] INFO util.log: Logging initialized @20896ms to org.eclipse.jetty.util.log.Slf4jLog
datanode_2_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupRemoveAsync(RaftServerProxy.java:404)
om_1          | /************************************************************
scm_1         | STARTUP_MSG:   build = https://github.com/apache/hadoop.git -r e97acb3bd8f3befd27418996fa5d4b50bf2e17bf; compiled by 'sunilg' on 2019-01-15T17:34Z
datanode_5_1  | 2020-04-17 18:52:35,141 [978c057e-5c38-4e20-8a8b-f271c823af7e@group-79E0035D853A-LeaderElection2] INFO server.RaftServerConfigKeys: raft.server.watch.element-limit = 65536 (default)
datanode_4_1  | 	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:123)
datanode_6_1  | 2020-04-17 18:50:32,550 [main] INFO server.AuthenticationFilter: Unable to initialize FileSignerSecretProvider, falling back to use random secrets.
datanode_2_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupManagementAsync(RaftServerProxy.java:367)
om_1          | SHUTDOWN_MSG: Shutting down OzoneManager at f442795e723d/10.5.0.70
scm_1         | STARTUP_MSG:   java = 11.0.6
datanode_5_1  | 2020-04-17 18:52:35,144 [978c057e-5c38-4e20-8a8b-f271c823af7e@group-79E0035D853A-LeaderElection2] INFO server.RaftServerConfigKeys: raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
datanode_4_1  | 	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
datanode_6_1  | 2020-04-17 18:50:32,586 [main] INFO http.HttpRequestLog: Http request log for http.requests.hddsDatanode is not defined
datanode_2_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupManagement(RaftServerProxy.java:350)
om_1          | ************************************************************/
scm_1         | ************************************************************/
datanode_5_1  | 2020-04-17 18:52:35,145 [978c057e-5c38-4e20-8a8b-f271c823af7e@group-79E0035D853A-LeaderElection2] INFO server.RaftServerConfigKeys: raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
datanode_4_1  | 	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
datanode_6_1  | 2020-04-17 18:50:32,633 [main] INFO http.HttpServer2: Added global filter 'safety' (class=org.apache.hadoop.hdds.server.http.HttpServer2$QuotingInputFilter)
datanode_2_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.XceiverServerRatis.removeGroup(XceiverServerRatis.java:657)
om_1          | Enabled profiling in kernel
scm_1         | 2020-04-17 18:50:31,403 [main] INFO server.StorageContainerManagerStarter: registered UNIX signal handlers for [TERM, HUP, INT]
datanode_5_1  | 2020-04-17 18:52:35,146 [978c057e-5c38-4e20-8a8b-f271c823af7e@group-79E0035D853A-LeaderElection2] INFO server.RaftServerConfigKeys: raft.server.log.appender.buffer.element-limit = 1 (custom)
datanode_4_1  | 	at java.base/java.lang.Thread.run(Thread.java:834)
datanode_6_1  | 2020-04-17 18:50:32,653 [main] INFO http.HttpServer2: Added filter static_user_filter (class=org.apache.hadoop.hdds.server.http.StaticUserWebFilter$StaticUserFilter) to context hddsDatanode
datanode_2_1  | 	... 4 more
om_1          | No '-XX:...' jvm parameters are used. Adding safer GC settings to the HADOOP_OPTS
scm_1         | 2020-04-17 18:50:32,291 [main] WARN server.ServerUtils: ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
datanode_5_1  | 2020-04-17 18:52:35,151 [978c057e-5c38-4e20-8a8b-f271c823af7e@group-79E0035D853A-LeaderElection2] INFO grpc.GrpcConfigKeys: raft.grpc.server.leader.outstanding.appends.max = 128 (default)
datanode_4_1  | Caused by: org.apache.ratis.protocol.AlreadyExistsException: a0acbcec-d753-414c-b077-647d02aaa7fb: Failed to add group-385EF22ED913:[978c057e-5c38-4e20-8a8b-f271c823af7e:10.5.0.8:9858, a0acbcec-d753-414c-b077-647d02aaa7fb:10.5.0.7:9858, 0e99e1b0-220f-42bd-a39f-d4658f80d0e4:10.5.0.5:9858] since the group already exists in the map.
datanode_6_1  | 2020-04-17 18:50:32,653 [main] INFO http.HttpServer2: Added filter static_user_filter (class=org.apache.hadoop.hdds.server.http.StaticUserWebFilter$StaticUserFilter) to context static
datanode_2_1  | 2020-04-17 18:54:08,663 [Command processor thread] INFO impl.RaftServerProxy: 0e99e1b0-220f-42bd-a39f-d4658f80d0e4: remove group-79E0035D853A:null
om_1          | OpenJDK 64-Bit Server VM warning: Option UseConcMarkSweepGC was deprecated in version 9.0 and will likely be removed in a future release.
scm_1         | 2020-04-17 18:50:32,351 [main] WARN server.ServerUtils: ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
datanode_5_1  | 2020-04-17 18:52:35,153 [978c057e-5c38-4e20-8a8b-f271c823af7e@group-79E0035D853A-LeaderElection2] INFO server.RaftServerConfigKeys: raft.server.rpc.request.timeout = 60s (custom)
datanode_4_1  | 	at org.apache.ratis.server.impl.RaftServerProxy$ImplMap.addNew(RaftServerProxy.java:83)
datanode_6_1  | 2020-04-17 18:50:32,653 [main] INFO http.HttpServer2: Added filter static_user_filter (class=org.apache.hadoop.hdds.server.http.StaticUserWebFilter$StaticUserFilter) to context logs
datanode_2_1  | 2020-04-17 18:54:08,663 [Command processor thread] ERROR commandhandler.ClosePipelineCommandHandler: Can't close pipeline #id: "cad403d1-ea2f-4530-84e5-79e0035d853a"
om_1          | 2020-04-17 18:50:39,874 [main] INFO om.OzoneManagerStarter: STARTUP_MSG: 
scm_1         | 2020-04-17 18:50:33,360 [main] INFO net.NodeSchemaLoader: Loading file from java.lang.CompoundEnumeration@3336e6b6
datanode_5_1  | 2020-04-17 18:52:35,153 [978c057e-5c38-4e20-8a8b-f271c823af7e@group-79E0035D853A-LeaderElection2] INFO server.RaftServerConfigKeys: raft.server.log.appender.install.snapshot.enabled = false (custom)
datanode_4_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupAddAsync(RaftServerProxy.java:378)
datanode_6_1  | 2020-04-17 18:50:32,816 [main] WARN http.BaseHttpServer: /prof java profiling servlet is activated. Not safe for production!
datanode_2_1  | 
om_1          | /************************************************************
scm_1         | 2020-04-17 18:50:33,376 [main] INFO net.NodeSchemaLoader: Loading network topology layer schema file
datanode_5_1  | 2020-04-17 18:52:35,163 [978c057e-5c38-4e20-8a8b-f271c823af7e@group-79E0035D853A-LeaderElection2] INFO server.RaftServerConfigKeys: raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
datanode_4_1  | 	... 13 more
datanode_6_1  | 2020-04-17 18:50:32,835 [main] INFO http.HttpServer2: Jetty bound to port 9882
datanode_2_1  | java.io.IOException: 0e99e1b0-220f-42bd-a39f-d4658f80d0e4: Group group-79E0035D853A not found.
datanode_2_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.XceiverServerRatis.removeGroup(XceiverServerRatis.java:659)
scm_1         | 2020-04-17 18:50:33,851 [main] INFO node.SCMNodeManager: Entering startup safe mode.
datanode_5_1  | 2020-04-17 18:52:35,163 [978c057e-5c38-4e20-8a8b-f271c823af7e@group-79E0035D853A-LeaderElection2] INFO server.RaftServerConfigKeys: raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
datanode_4_1  | 2020-04-17 18:50:46,699 [Command processor thread] INFO commandhandler.CreatePipelineCommandHandler: Created Pipeline RATIS THREE #id: "be26d0dd-802f-4608-9a1c-385ef22ed913"
datanode_6_1  | 2020-04-17 18:50:32,840 [main] INFO server.Server: jetty-9.4.26.v20200117; built: 2020-01-17T12:35:33.676Z; git: 7b38981d25d14afb4a12ff1f2596756144edf695; jvm 11.0.6+10-LTS
datanode_2_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.ClosePipelineCommandHandler.handle(ClosePipelineCommandHandler.java:77)
om_1          | STARTUP_MSG: Starting OzoneManager
scm_1         | 2020-04-17 18:50:34,336 [main] INFO algorithms.ContainerPlacementPolicyFactory: Create container placement policy of type org.apache.hadoop.hdds.scm.container.placement.algorithms.SCMContainerPlacementRackAware
datanode_5_1  | 2020-04-17 18:52:35,163 [978c057e-5c38-4e20-8a8b-f271c823af7e@group-79E0035D853A-LeaderElection2] INFO server.RaftServerConfigKeys: raft.server.log.appender.buffer.element-limit = 1 (custom)
datanode_4_1  | .
datanode_6_1  | 2020-04-17 18:50:33,019 [main] INFO server.session: DefaultSessionIdManager workerName=node0
datanode_2_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.CommandDispatcher.handle(CommandDispatcher.java:99)
om_1          | STARTUP_MSG:   host = f442795e723d/10.5.0.70
scm_1         | 2020-04-17 18:50:34,358 [main] WARN server.ServerUtils: ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
datanode_5_1  | 2020-04-17 18:52:35,163 [978c057e-5c38-4e20-8a8b-f271c823af7e@group-79E0035D853A-LeaderElection2] INFO grpc.GrpcConfigKeys: raft.grpc.server.leader.outstanding.appends.max = 128 (default)
datanode_4_1  | 2020-04-17 18:50:46,913 [grpc-default-executor-0] WARN impl.RaftServerProxy: a0acbcec-d753-414c-b077-647d02aaa7fb: Failed groupAdd* GroupManagementRequest:client-463792C5BCB5->a0acbcec-d753-414c-b077-647d02aaa7fb@group-385EF22ED913, cid=1, seq=0, RW, null, Add:group-385EF22ED913:[978c057e-5c38-4e20-8a8b-f271c823af7e:10.5.0.8:9858, a0acbcec-d753-414c-b077-647d02aaa7fb:10.5.0.7:9858, 0e99e1b0-220f-42bd-a39f-d4658f80d0e4:10.5.0.5:9858]
datanode_6_1  | 2020-04-17 18:50:33,026 [main] INFO server.session: No SessionScavenger set, using defaults
datanode_2_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.lambda$initCommandHandlerThread$1(DatanodeStateMachine.java:472)
om_1          | STARTUP_MSG:   args = []
scm_1         | 2020-04-17 18:50:34,422 [main] INFO pipeline.SCMPipelineManager: No pipeline exists in current db
datanode_5_1  | 2020-04-17 18:52:35,164 [978c057e-5c38-4e20-8a8b-f271c823af7e@group-79E0035D853A-LeaderElection2] INFO server.RaftServerConfigKeys: raft.server.rpc.request.timeout = 60s (custom)
datanode_4_1  | java.util.concurrent.CompletionException: org.apache.ratis.protocol.AlreadyExistsException: a0acbcec-d753-414c-b077-647d02aaa7fb: Failed to add group-385EF22ED913:[978c057e-5c38-4e20-8a8b-f271c823af7e:10.5.0.8:9858, a0acbcec-d753-414c-b077-647d02aaa7fb:10.5.0.7:9858, 0e99e1b0-220f-42bd-a39f-d4658f80d0e4:10.5.0.5:9858] since the group already exists in the map.
datanode_6_1  | 2020-04-17 18:50:33,037 [main] INFO server.session: node0 Scavenging every 600000ms
datanode_2_1  | 	at java.base/java.lang.Thread.run(Thread.java:834)
om_1          | STARTUP_MSG:   version = 3.2.0
scm_1         | 2020-04-17 18:50:34,429 [main] WARN server.ServerUtils: ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
datanode_5_1  | 2020-04-17 18:52:35,164 [978c057e-5c38-4e20-8a8b-f271c823af7e@group-79E0035D853A-LeaderElection2] INFO server.RaftServerConfigKeys: raft.server.log.appender.install.snapshot.enabled = false (custom)
datanode_6_1  | 2020-04-17 18:50:33,104 [main] INFO handler.ContextHandler: Started o.e.j.s.ServletContextHandler@6f76c2cc{logs,/logs,file:///var/log/hadoop/,AVAILABLE}
datanode_4_1  | 	at java.base/java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:331)
datanode_2_1  | Caused by: org.apache.ratis.protocol.GroupMismatchException: 0e99e1b0-220f-42bd-a39f-d4658f80d0e4: Group group-79E0035D853A not found.
scm_1         | 2020-04-17 18:50:34,552 [main] INFO safemode.HealthyPipelineSafeModeRule: Total pipeline count is 0, healthy pipeline threshold count is 1
om_1          | STARTUP_MSG:   classpath = /etc/hadoop:/opt/hadoop/share/hadoop/common/*:/opt/hadoop/share/ozone/lib/kerb-simplekdc-1.0.1.jar:/opt/hadoop/share/ozone/lib/jackson-databind-2.10.3.jar:/opt/hadoop/share/ozone/lib/protobuf-java-2.5.0.jar:/opt/hadoop/share/ozone/lib/bcpkix-jdk15on-1.60.jar:/opt/hadoop/share/ozone/lib/commons-validator-1.6.jar:/opt/hadoop/share/ozone/lib/hadoop-hdds-client-0.6.0-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/ratis-proto-0.6.0-7c5b30d-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/netty-3.10.5.Final.jar:/opt/hadoop/share/ozone/lib/jaxb-impl-2.3.0.1.jar:/opt/hadoop/share/ozone/lib/netty-all-4.1.47.Final.jar:/opt/hadoop/share/ozone/lib/kerb-core-1.0.1.jar:/opt/hadoop/share/ozone/lib/jsr305-3.0.0.jar:/opt/hadoop/share/ozone/lib/leveldbjni-all-1.8.jar:/opt/hadoop/share/ozone/lib/j2objc-annotations-1.3.jar:/opt/hadoop/share/ozone/lib/jetty-io-9.4.26.v20200117.jar:/opt/hadoop/share/ozone/lib/htrace-core4-4.1.0-incubating.jar:/opt/hadoop/share/ozone/lib/hadoop-annotations-3.2.0.jar:/opt/hadoop/share/ozone/lib/jetty-http-9.4.26.v20200117.jar:/opt/hadoop/share/ozone/lib/kerb-util-1.0.1.jar:/opt/hadoop/share/ozone/lib/jetty-xml-9.4.26.v20200117.jar:/opt/hadoop/share/ozone/lib/jackson-jaxrs-1.9.13.jar:/opt/hadoop/share/ozone/lib/ratis-thirdparty-misc-0.3.0.jar:/opt/hadoop/share/ozone/lib/kerby-xdr-1.0.1.jar:/opt/hadoop/share/ozone/lib/jackson-core-asl-1.9.13.jar:/opt/hadoop/share/ozone/lib/jetty-server-9.4.26.v20200117.jar:/opt/hadoop/share/ozone/lib/commons-net-3.6.jar:/opt/hadoop/share/ozone/lib/log4j-api-2.11.0.jar:/opt/hadoop/share/ozone/lib/hadoop-hdfs-3.2.0.jar:/opt/hadoop/share/ozone/lib/opentracing-api-0.31.0.jar:/opt/hadoop/share/ozone/lib/slf4j-log4j12-1.7.25.jar:/opt/hadoop/share/ozone/lib/hadoop-hdfs-client-3.2.0.jar:/opt/hadoop/share/ozone/lib/kerby-config-1.0.1.jar:/opt/hadoop/share/ozone/lib/hadoop-ozone-client-0.6.0-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/libthrift-0.12.0.jar:/opt/hadoop/share/ozone/lib/jetty-util-ajax-9.4.26.v20200117.jar:/opt/hadoop/share/ozone/lib/metrics-core-3.2.4.jar:/opt/hadoop/share/ozone/lib/guava-28.2-jre.jar:/opt/hadoop/share/ozone/lib/kerby-pkix-1.0.1.jar:/opt/hadoop/share/ozone/lib/xz-1.0.jar:/opt/hadoop/share/ozone/lib/jetty-servlet-9.4.26.v20200117.jar:/opt/hadoop/share/ozone/lib/jsr311-api-1.1.1.jar:/opt/hadoop/share/ozone/lib/commons-beanutils-1.9.4.jar:/opt/hadoop/share/ozone/lib/rocksdbjni-6.6.4.jar:/opt/hadoop/share/ozone/lib/jetty-security-9.4.26.v20200117.jar:/opt/hadoop/share/ozone/lib/javax.servlet-api-3.1.0.jar:/opt/hadoop/share/ozone/lib/kerb-server-1.0.1.jar:/opt/hadoop/share/ozone/lib/avro-1.7.7.jar:/opt/hadoop/share/ozone/lib/kerb-client-1.0.1.jar:/opt/hadoop/share/ozone/lib/jackson-xc-1.9.13.jar:/opt/hadoop/share/ozone/lib/disruptor-3.4.2.jar:/opt/hadoop/share/ozone/lib/hadoop-hdds-docs-0.6.0-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/simpleclient_common-0.7.0.jar:/opt/hadoop/share/ozone/lib/dnsjava-2.1.7.jar:/opt/hadoop/share/ozone/lib/jackson-annotations-2.10.3.jar:/opt/hadoop/share/ozone/lib/commons-configuration2-2.1.1.jar:/opt/hadoop/share/ozone/lib/json-smart-2.3.jar:/opt/hadoop/share/ozone/lib/token-provider-1.0.1.jar:/opt/hadoop/share/ozone/lib/log4j-1.2.17.jar:/opt/hadoop/share/ozone/lib/commons-daemon-1.0.13.jar:/opt/hadoop/share/ozone/lib/listenablefuture-9999.0-empty-to-avoid-conflict-with-guava.jar:/opt/hadoop/share/ozone/lib/bcprov-jdk15on-1.60.jar:/opt/hadoop/share/ozone/lib/ratis-grpc-0.6.0-7c5b30d-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/jetty-webapp-9.4.26.v20200117.jar:/opt/hadoop/share/ozone/lib/commons-lang3-3.7.jar:/opt/hadoop/share/ozone/lib/commons-compress-1.4.1.jar:/opt/hadoop/share/ozone/lib/jaeger-client-0.34.0.jar:/opt/hadoop/share/ozone/lib/accessors-smart-1.2.jar:/opt/hadoop/share/ozone/lib/re2j-1.1.jar:/opt/hadoop/share/ozone/lib/ratis-client-0.6.0-7c5b30d-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/commons-math3-3.1.1.jar:/opt/hadoop/share/ozone/lib/simpleclient_dropwizard-0.7.0.jar:/opt/hadoop/share/ozone/lib/opentracing-noop-0.31.0.jar:/opt/hadoop/share/ozone/lib/simpleclient-0.7.0.jar:/opt/hadoop/share/ozone/lib/httpclient-4.5.2.jar:/opt/hadoop/share/ozone/lib/jaeger-core-0.34.0.jar:/opt/hadoop/share/ozone/lib/asm-5.0.4.jar:/opt/hadoop/share/ozone/lib/kerby-util-1.0.1.jar:/opt/hadoop/share/ozone/lib/failureaccess-1.0.1.jar:/opt/hadoop/share/ozone/lib/jackson-mapper-asl-1.9.13.jar:/opt/hadoop/share/ozone/lib/jsp-api-2.1.jar:/opt/hadoop/share/ozone/lib/jsch-0.1.54.jar:/opt/hadoop/share/ozone/lib/opentracing-tracerresolver-0.1.5.jar:/opt/hadoop/share/ozone/lib/ratis-metrics-0.6.0-7c5b30d-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/ratis-common-0.6.0-7c5b30d-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/paranamer-2.3.jar:/opt/hadoop/share/ozone/lib/log4j-core-2.11.0.jar:/opt/hadoop/share/ozone/lib/nimbus-jose-jwt-7.9.jar:/opt/hadoop/share/ozone/lib/commons-codec-1.11.jar:/opt/hadoop/share/ozone/lib/commons-pool2-2.6.0.jar:/opt/hadoop/share/ozone/lib/jackson-datatype-jsr310-2.10.3.jar:/opt/hadoop/share/ozone/lib/gson-2.2.4.jar:/opt/hadoop/share/ozone/lib/jcip-annotations-1.0-1.jar:/opt/hadoop/share/ozone/lib/kerb-admin-1.0.1.jar:/opt/hadoop/share/ozone/lib/okio-1.13.0.jar:/opt/hadoop/share/ozone/lib/commons-io-2.5.jar:/opt/hadoop/share/ozone/lib/snakeyaml-1.16.jar:/opt/hadoop/share/ozone/lib/jetty-util-9.4.26.v20200117.jar:/opt/hadoop/share/ozone/lib/hadoop-hdds-hadoop-dependency-client-0.6.0-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/jersey-core-1.19.jar:/opt/hadoop/share/ozone/lib/checker-qual-2.10.0.jar:/opt/hadoop/share/ozone/lib/ratis-server-0.6.0-7c5b30d-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/hadoop-hdds-server-framework-0.6.0-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/error_prone_annotations-2.3.4.jar:/opt/hadoop/share/ozone/lib/picocli-3.9.6.jar:/opt/hadoop/share/ozone/lib/jaeger-thrift-0.34.0.jar:/opt/hadoop/share/ozone/lib/hadoop-hdds-common-0.6.0-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/commons-cli-1.2.jar:/opt/hadoop/share/ozone/lib/woodstox-core-5.0.3.jar:/opt/hadoop/share/ozone/lib/javax.annotation-api-1.2.jar:/opt/hadoop/share/ozone/lib/snappy-java-1.0.5.jar:/opt/hadoop/share/ozone/lib/hadoop-ozone-common-0.6.0-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/jaeger-tracerresolver-0.34.0.jar:/opt/hadoop/share/ozone/lib/kerby-asn1-1.0.1.jar:/opt/hadoop/share/ozone/lib/okhttp-3.9.0.jar:/opt/hadoop/share/ozone/lib/hadoop-hdds-config-0.6.0-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/stax2-api-3.1.4.jar:/opt/hadoop/share/ozone/lib/commons-digester-1.8.1.jar:/opt/hadoop/share/ozone/lib/commons-collections-3.2.2.jar:/opt/hadoop/share/ozone/lib/jettison-1.1.jar:/opt/hadoop/share/ozone/lib/jackson-core-2.10.3.jar:/opt/hadoop/share/ozone/lib/commons-text-1.4.jar:/opt/hadoop/share/ozone/lib/jersey-servlet-1.19.jar:/opt/hadoop/share/ozone/lib/jersey-json-1.19.jar:/opt/hadoop/share/ozone/lib/slf4j-api-1.7.25.jar:/opt/hadoop/share/ozone/lib/commons-logging-1.1.3.jar:/opt/hadoop/share/ozone/lib/kerb-identity-1.0.1.jar:/opt/hadoop/share/ozone/lib/opentracing-util-0.31.0.jar:/opt/hadoop/share/ozone/lib/hadoop-hdds-hadoop-dependency-server-0.6.0-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/hadoop-common-3.2.0.jar:/opt/hadoop/share/ozone/lib/hadoop-auth-3.2.0.jar:/opt/hadoop/share/ozone/lib/kerb-common-1.0.1.jar:/opt/hadoop/share/ozone/lib/jersey-server-1.19.jar:/opt/hadoop/share/ozone/lib/kerb-crypto-1.0.1.jar:/opt/hadoop/share/ozone/lib/httpcore-4.4.4.jar:/opt/hadoop/share/ozone/lib/ratis-netty-0.6.0-7c5b30d-SNAPSHOT.jar:/opt/hadoop/share/ozone/web:/opt/hadoop/share/ozone/lib/hadoop-ozone-ozone-manager-0.6.0-SNAPSHOT.jar
om_1          | STARTUP_MSG:   build = https://github.com/apache/hadoop.git -r e97acb3bd8f3befd27418996fa5d4b50bf2e17bf; compiled by 'sunilg' on 2019-01-15T17:34Z
datanode_6_1  | 2020-04-17 18:50:33,114 [main] INFO handler.ContextHandler: Started o.e.j.s.ServletContextHandler@441b8382{static,/static,jar:file:/opt/hadoop/share/ozone/lib/hadoop-hdds-container-service-0.6.0-SNAPSHOT.jar!/webapps/static,AVAILABLE}
datanode_4_1  | 	at java.base/java.util.concurrent.CompletableFuture.uniApplyNow(CompletableFuture.java:670)
datanode_2_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupRemoveAsync(RaftServerProxy.java:404)
scm_1         | 2020-04-17 18:50:34,559 [main] INFO safemode.OneReplicaPipelineSafeModeRule: Total pipeline count is 0, pipeline's with at least one datanode reported threshold count is 0
datanode_5_1  | 2020-04-17 18:52:35,165 [978c057e-5c38-4e20-8a8b-f271c823af7e@group-79E0035D853A-LeaderElection2] INFO impl.RoleInfo: 978c057e-5c38-4e20-8a8b-f271c823af7e: start LeaderState
om_1          | STARTUP_MSG:   java = 11.0.6
datanode_6_1  | 2020-04-17 18:50:33,546 [main] INFO handler.ContextHandler: Started o.e.j.w.WebAppContext@7c011174{hddsDatanode,/,file:///tmp/jetty-0_0_0_0-9882-hadoop-hdds-container-service-0_6_0-SNAPSHOT_jar-_-any-2902145045453394679.dir/webapp/,AVAILABLE}{jar:file:/opt/hadoop/share/ozone/lib/hadoop-hdds-container-service-0.6.0-SNAPSHOT.jar!/webapps/hddsDatanode}
datanode_4_1  | 	at java.base/java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:658)
datanode_2_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupManagementAsync(RaftServerProxy.java:367)
scm_1         | 2020-04-17 18:50:34,632 [RatisPipelineUtilsThread] ERROR pipeline.SCMPipelineManager: Failed to create pipeline of type RATIS and factor ONE. Exception: Cannot create pipeline of factor 1 using 0 nodes. Used 0 nodes. Healthy nodes 0
datanode_5_1  | 2020-04-17 18:52:35,169 [978c057e-5c38-4e20-8a8b-f271c823af7e@group-79E0035D853A-LeaderElection2] INFO segmented.SegmentedRaftLogWorker: 978c057e-5c38-4e20-8a8b-f271c823af7e@group-79E0035D853A-SegmentedRaftLogWorker: Starting segment from index:0
om_1          | ************************************************************/
datanode_6_1  | 2020-04-17 18:50:33,600 [main] INFO server.AbstractConnector: Started ServerConnector@1491344a{HTTP/1.1,[http/1.1]}{0.0.0.0:9882}
datanode_4_1  | 	at java.base/java.util.concurrent.CompletableFuture.thenApplyAsync(CompletableFuture.java:2104)
datanode_2_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupManagement(RaftServerProxy.java:350)
scm_1         | 2020-04-17 18:50:35,436 [main] INFO ipc.CallQueueManager: Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 10000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false.
datanode_5_1  | 2020-04-17 18:52:35,171 [978c057e-5c38-4e20-8a8b-f271c823af7e@group-79E0035D853A-SegmentedRaftLogWorker] INFO segmented.SegmentedRaftLogWorker: 978c057e-5c38-4e20-8a8b-f271c823af7e@group-79E0035D853A-SegmentedRaftLogWorker: created new log segment /data/metadata/ratis/cad403d1-ea2f-4530-84e5-79e0035d853a/current/log_inprogress_0
om_1          | 2020-04-17 18:50:39,900 [main] INFO om.OzoneManagerStarter: registered UNIX signal handlers for [TERM, HUP, INT]
datanode_6_1  | 2020-04-17 18:50:33,602 [main] INFO server.Server: Started @22591ms
datanode_4_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupAddAsync(RaftServerProxy.java:379)
datanode_2_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.XceiverServerRatis.removeGroup(XceiverServerRatis.java:657)
scm_1         | 2020-04-17 18:50:35,460 [Socket Reader #1 for port 9861] INFO ipc.Server: Starting Socket Reader #1 for port 9861
datanode_5_1  | 2020-04-17 18:52:35,175 [978c057e-5c38-4e20-8a8b-f271c823af7e@group-79E0035D853A-LeaderElection2] INFO impl.RaftServerImpl: 978c057e-5c38-4e20-8a8b-f271c823af7e@group-79E0035D853A: set configuration 0: [978c057e-5c38-4e20-8a8b-f271c823af7e:10.5.0.8:9858, a0acbcec-d753-414c-b077-647d02aaa7fb:10.5.0.7:9858, 0e99e1b0-220f-42bd-a39f-d4658f80d0e4:10.5.0.5:9858], old=null at 0
om_1          | 2020-04-17 18:50:42,434 [main] INFO ha.OMHANodeDetails: ozone.om.internal.service.id is not defined, falling back to ozone.om.service.ids to find serviceID for OzoneManager if it is HA enabled cluster
datanode_6_1  | 2020-04-17 18:50:33,622 [main] INFO impl.MetricsSinkAdapter: Sink prometheus started
datanode_4_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupManagementAsync(RaftServerProxy.java:363)
datanode_2_1  | 	... 4 more
scm_1         | 2020-04-17 18:50:35,526 [main] INFO ipc.CallQueueManager: Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 10000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false.
datanode_5_1  | 2020-04-17 18:52:37,620 [ChunkWriter-57-0] INFO keyvalue.KeyValueHandler: Operation: CreateContainer , Trace ID: dbf2e28874f8e582:fd88223a75928210:dbf2e28874f8e582:0 , Message: Container creation failed, due to disk out of space , Result: DISK_OUT_OF_SPACE , StorageContainerException Occurred.
om_1          | 2020-04-17 18:50:42,800 [main] INFO ha.OMHANodeDetails: Configuration either no ozone.om.address set. Falling back to the default OM address om/10.5.0.70:9862
datanode_6_1  | 2020-04-17 18:50:33,622 [main] INFO impl.MetricsSystemImpl: Registered sink prometheus
datanode_4_1  | 	at org.apache.ratis.grpc.server.GrpcAdminProtocolService.lambda$groupManagement$0(GrpcAdminProtocolService.java:42)
datanode_2_1  | 2020-04-17 18:54:08,664 [Command processor thread] INFO impl.RaftServerProxy: 0e99e1b0-220f-42bd-a39f-d4658f80d0e4: remove group-79E0035D853A:null
scm_1         | 2020-04-17 18:50:35,527 [Socket Reader #1 for port 9863] INFO ipc.Server: Starting Socket Reader #1 for port 9863
datanode_5_1  | org.apache.hadoop.hdds.scm.container.common.helpers.StorageContainerException: Container creation failed, due to disk out of space
om_1          | 2020-04-17 18:50:42,815 [main] INFO ha.OMHANodeDetails: OM Service ID is not set. Setting it to the default ID: omServiceIdDefault
datanode_6_1  | 2020-04-17 18:50:33,632 [main] INFO http.BaseHttpServer: HTTP server of hddsDatanode listening at http://0.0.0.0:9882
datanode_4_1  | 	at org.apache.ratis.grpc.GrpcUtil.asyncCall(GrpcUtil.java:160)
datanode_2_1  | 2020-04-17 18:54:08,664 [Command processor thread] ERROR commandhandler.ClosePipelineCommandHandler: Can't close pipeline #id: "cad403d1-ea2f-4530-84e5-79e0035d853a"
scm_1         | 2020-04-17 18:50:35,546 [main] INFO ipc.CallQueueManager: Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 10000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false.
datanode_5_1  | 	at org.apache.hadoop.ozone.container.keyvalue.KeyValueContainer.create(KeyValueContainer.java:165)
om_1          | 2020-04-17 18:50:42,847 [main] WARN server.ServerUtils: ozone.om.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
datanode_6_1  | 2020-04-17 18:50:33,768 [org.apache.hadoop.util.JvmPauseMonitor$Monitor@1964658e] INFO util.JvmPauseMonitor: Starting JVM pause monitor
datanode_4_1  | 	at org.apache.ratis.grpc.server.GrpcAdminProtocolService.groupManagement(GrpcAdminProtocolService.java:42)
datanode_2_1  | 
scm_1         | 2020-04-17 18:50:35,547 [Socket Reader #1 for port 9860] INFO ipc.Server: Starting Socket Reader #1 for port 9860
om_1          | 2020-04-17 18:50:43,627 [main] WARN server.ServerUtils: ozone.om.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
datanode_4_1  | 	at org.apache.ratis.proto.grpc.AdminProtocolServiceGrpc$MethodHandlers.invoke(AdminProtocolServiceGrpc.java:358)
datanode_2_1  | java.io.IOException: 0e99e1b0-220f-42bd-a39f-d4658f80d0e4: Group group-79E0035D853A not found.
scm_1         | 2020-04-17 18:50:35,571 [main] INFO http.BaseHttpServer: Starting Web-server for scm at: http://0.0.0.0:9876
datanode_5_1  | 	at org.apache.hadoop.ozone.container.keyvalue.KeyValueHandler.handleCreateContainer(KeyValueHandler.java:247)
datanode_6_1  | 2020-04-17 18:50:34,289 [Datanode State Machine Thread - 0] INFO datanode.InitDatanodeState: DatanodeDetails is persisted to /data/datanode.id
om_1          | 2020-04-17 18:50:47,518 [main] WARN server.ServerUtils: ozone.om.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
datanode_4_1  | 	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$UnaryServerCallHandler$UnaryServerCallListener.onHalfClose(ServerCalls.java:172)
datanode_2_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.XceiverServerRatis.removeGroup(XceiverServerRatis.java:659)
scm_1         | 2020-04-17 18:50:35,590 [main] INFO util.log: Logging initialized @17646ms to org.eclipse.jetty.util.log.Slf4jLog
datanode_5_1  | 	at org.apache.hadoop.ozone.container.keyvalue.KeyValueHandler.dispatchRequest(KeyValueHandler.java:164)
datanode_6_1  | 2020-04-17 18:50:36,765 [Datanode State Machine Thread - 0] INFO ozoneimpl.OzoneContainer: Attempting to start container services.
om_1          | 2020-04-17 18:50:48,690 [main] INFO ipc.CallQueueManager: Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 10000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false.
datanode_4_1  | 	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.halfClosed(ServerCallImpl.java:331)
datanode_2_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.ClosePipelineCommandHandler.handle(ClosePipelineCommandHandler.java:77)
scm_1         | 2020-04-17 18:50:35,783 [main] INFO server.AuthenticationFilter: Unable to initialize FileSignerSecretProvider, falling back to use random secrets.
datanode_5_1  | 	at org.apache.hadoop.ozone.container.keyvalue.KeyValueHandler.handle(KeyValueHandler.java:152)
datanode_6_1  | 2020-04-17 18:50:36,766 [Datanode State Machine Thread - 0] INFO ozoneimpl.OzoneContainer: Background container scanner has been disabled.
om_1          | 2020-04-17 18:50:48,740 [Socket Reader #1 for port 9862] INFO ipc.Server: Starting Socket Reader #1 for port 9862
datanode_4_1  | 	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1HalfClosed.runInContext(ServerImpl.java:814)
datanode_2_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.CommandDispatcher.handle(CommandDispatcher.java:99)
scm_1         | 2020-04-17 18:50:35,809 [main] INFO http.HttpRequestLog: Http request log for http.requests.scm is not defined
datanode_5_1  | 	at org.apache.hadoop.ozone.container.common.impl.HddsDispatcher.createContainer(HddsDispatcher.java:414)
datanode_6_1  | 2020-04-17 18:50:36,766 [Datanode State Machine Thread - 0] INFO ratis.XceiverServerRatis: Starting XceiverServerRatis 79669a1f-2445-496e-a337-3115205f3ae5 at port 9858
om_1          | 2020-04-17 18:50:49,217 [main] INFO impl.MetricsConfig: Loaded properties from hadoop-metrics2.properties
datanode_4_1  | 	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
datanode_2_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.lambda$initCommandHandlerThread$1(DatanodeStateMachine.java:472)
scm_1         | 2020-04-17 18:50:35,822 [main] INFO http.HttpServer2: Added global filter 'safety' (class=org.apache.hadoop.hdds.server.http.HttpServer2$QuotingInputFilter)
scm_1         | 2020-04-17 18:50:35,824 [main] INFO http.HttpServer2: Added filter static_user_filter (class=org.apache.hadoop.hdds.server.http.StaticUserWebFilter$StaticUserFilter) to context scm
datanode_6_1  | 2020-04-17 18:50:36,885 [Datanode State Machine Thread - 0] INFO impl.RaftServerProxy: 79669a1f-2445-496e-a337-3115205f3ae5: start RPC server
om_1          | 2020-04-17 18:50:49,388 [main] INFO impl.MetricsSystemImpl: Scheduled Metric snapshot period at 10 second(s).
datanode_4_1  | 	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:123)
datanode_2_1  | 	at java.base/java.lang.Thread.run(Thread.java:834)
scm_1         | 2020-04-17 18:50:35,824 [main] INFO http.HttpServer2: Added filter static_user_filter (class=org.apache.hadoop.hdds.server.http.StaticUserWebFilter$StaticUserFilter) to context static
datanode_5_1  | 	at org.apache.hadoop.ozone.container.common.impl.HddsDispatcher.dispatchRequest(HddsDispatcher.java:250)
datanode_6_1  | 2020-04-17 18:50:37,167 [Datanode State Machine Thread - 0] INFO server.GrpcService: 79669a1f-2445-496e-a337-3115205f3ae5: GrpcService started, listening on 0.0.0.0/0.0.0.0:9858
om_1          | 2020-04-17 18:50:49,389 [main] INFO impl.MetricsSystemImpl: OzoneManager metrics system started
datanode_4_1  | 	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
datanode_2_1  | Caused by: org.apache.ratis.protocol.GroupMismatchException: 0e99e1b0-220f-42bd-a39f-d4658f80d0e4: Group group-79E0035D853A not found.
scm_1         | 2020-04-17 18:50:35,824 [main] INFO http.HttpServer2: Added filter static_user_filter (class=org.apache.hadoop.hdds.server.http.StaticUserWebFilter$StaticUserFilter) to context logs
datanode_5_1  | 	at org.apache.hadoop.ozone.container.common.impl.HddsDispatcher.dispatch(HddsDispatcher.java:162)
datanode_6_1  | 2020-04-17 18:50:40,808 [Command processor thread] INFO impl.RaftServerProxy: 79669a1f-2445-496e-a337-3115205f3ae5: addNew group-E8C5921C502F:[79669a1f-2445-496e-a337-3115205f3ae5:10.5.0.9:9858] returns group-E8C5921C502F:java.util.concurrent.CompletableFuture@23415121[Not completed]
om_1          | 2020-04-17 18:50:49,514 [main] INFO om.OzoneManager: OzoneManager RPC server is listening at om/10.5.0.70:9862
datanode_4_1  | 	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
datanode_2_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupRemoveAsync(RaftServerProxy.java:404)
scm_1         | 2020-04-17 18:50:35,852 [main] WARN http.BaseHttpServer: /prof java profiling servlet is activated. Not safe for production!
datanode_5_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.ContainerStateMachine.dispatchCommand(ContainerStateMachine.java:402)
datanode_6_1  | 2020-04-17 18:50:40,908 [pool-69-thread-1] INFO impl.RaftServerImpl: 79669a1f-2445-496e-a337-3115205f3ae5: new RaftServerImpl for group-E8C5921C502F:[79669a1f-2445-496e-a337-3115205f3ae5:10.5.0.9:9858] with ContainerStateMachine:uninitialized
om_1          | 2020-04-17 18:50:49,542 [IPC Server Responder] INFO ipc.Server: IPC Server Responder: starting
datanode_4_1  | 	at java.base/java.lang.Thread.run(Thread.java:834)
datanode_2_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupManagementAsync(RaftServerProxy.java:367)
datanode_2_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupManagement(RaftServerProxy.java:350)
datanode_5_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.ContainerStateMachine.runCommand(ContainerStateMachine.java:412)
datanode_6_1  | 2020-04-17 18:50:40,910 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.rpc.timeout.min = 5s (custom)
om_1          | 2020-04-17 18:50:49,543 [IPC Server listener on 9862] INFO ipc.Server: IPC Server listener on 9862: starting
datanode_4_1  | Caused by: org.apache.ratis.protocol.AlreadyExistsException: a0acbcec-d753-414c-b077-647d02aaa7fb: Failed to add group-385EF22ED913:[978c057e-5c38-4e20-8a8b-f271c823af7e:10.5.0.8:9858, a0acbcec-d753-414c-b077-647d02aaa7fb:10.5.0.7:9858, 0e99e1b0-220f-42bd-a39f-d4658f80d0e4:10.5.0.5:9858] since the group already exists in the map.
datanode_2_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.XceiverServerRatis.removeGroup(XceiverServerRatis.java:657)
scm_1         | 2020-04-17 18:50:35,867 [main] INFO server.StorageContainerManager: StorageContainerLocationProtocol RPC server is listening at /0.0.0.0:9860
datanode_5_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.ContainerStateMachine.lambda$handleWriteChunk$2(ContainerStateMachine.java:447)
datanode_6_1  | 2020-04-17 18:50:40,916 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.rpc.timeout.max = 5200ms (custom)
datanode_6_1  | 2020-04-17 18:50:40,919 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.rpcslowness.timeout = 300s (custom)
datanode_4_1  | 	at org.apache.ratis.server.impl.RaftServerProxy$ImplMap.addNew(RaftServerProxy.java:83)
datanode_2_1  | 	... 4 more
datanode_5_1  | 	at java.base/java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1700)
datanode_6_1  | 2020-04-17 18:50:40,923 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.sleep.deviation.threshold = 300 (default)
scm_1         | 2020-04-17 18:50:35,931 [main] INFO impl.MetricsConfig: Loaded properties from hadoop-metrics2.properties
om_1          | 2020-04-17 18:50:49,783 [main] INFO http.BaseHttpServer: Starting Web-server for ozoneManager at: http://0.0.0.0:9874
datanode_4_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupAddAsync(RaftServerProxy.java:378)
datanode_2_1  | 2020-04-17 18:54:08,664 [Command processor thread] INFO impl.RaftServerProxy: 0e99e1b0-220f-42bd-a39f-d4658f80d0e4: remove group-79E0035D853A:null
datanode_5_1  | 	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
datanode_6_1  | 2020-04-17 18:50:40,924 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.appender.install.snapshot.enabled = false (custom)
scm_1         | 2020-04-17 18:50:35,962 [main] INFO impl.MetricsSystemImpl: Scheduled Metric snapshot period at 10 second(s).
om_1          | 2020-04-17 18:50:49,827 [main] INFO util.log: Logging initialized @11124ms to org.eclipse.jetty.util.log.Slf4jLog
datanode_4_1  | 	... 13 more
datanode_2_1  | 2020-04-17 18:54:08,665 [Command processor thread] ERROR commandhandler.ClosePipelineCommandHandler: Can't close pipeline #id: "cad403d1-ea2f-4530-84e5-79e0035d853a"
datanode_5_1  | 	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
datanode_6_1  | 2020-04-17 18:50:40,938 [pool-69-thread-1] INFO impl.RaftServerImpl: 79669a1f-2445-496e-a337-3115205f3ae5@group-E8C5921C502F: ConfigurationManager, init=-1: [79669a1f-2445-496e-a337-3115205f3ae5:10.5.0.9:9858], old=null, confs=<EMPTY_MAP>
scm_1         | 2020-04-17 18:50:35,962 [main] INFO impl.MetricsSystemImpl: StorageContainerManager metrics system started
om_1          | 2020-04-17 18:50:50,104 [main] INFO server.AuthenticationFilter: Unable to initialize FileSignerSecretProvider, falling back to use random secrets.
datanode_4_1  | 2020-04-17 18:50:47,434 [Thread-24] INFO impl.FollowerState: a0acbcec-d753-414c-b077-647d02aaa7fb@group-51477CB1F421-FollowerState: change to CANDIDATE, lastRpcTime:5078ms, electionTimeout:5075ms
datanode_2_1  | 
datanode_5_1  | 	at java.base/java.lang.Thread.run(Thread.java:834)
datanode_6_1  | 2020-04-17 18:50:40,957 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.storage.dir = [/data/metadata/ratis] (custom)
scm_1         | 2020-04-17 18:50:36,150 [main] INFO server.SCMClientProtocolServer: RPC server for Client  is listening at /0.0.0.0:9860
om_1          | 2020-04-17 18:50:50,123 [main] INFO http.HttpRequestLog: Http request log for http.requests.ozoneManager is not defined
datanode_4_1  | 2020-04-17 18:50:47,436 [Thread-24] INFO impl.RoleInfo: a0acbcec-d753-414c-b077-647d02aaa7fb: shutdown FollowerState
datanode_2_1  | java.io.IOException: 0e99e1b0-220f-42bd-a39f-d4658f80d0e4: Group group-79E0035D853A not found.
datanode_5_1  | Caused by: org.apache.hadoop.util.DiskChecker$DiskOutOfSpaceException: Out of space: The volume with the most available space (=965193728 B) is less than the container size (=1073741824 B).
datanode_6_1  | 2020-04-17 18:50:40,991 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.corruption.policy = EXCEPTION (default)
scm_1         | 2020-04-17 18:50:36,150 [IPC Server Responder] INFO ipc.Server: IPC Server Responder: starting
om_1          | 2020-04-17 18:50:50,144 [main] INFO http.HttpServer2: Added global filter 'safety' (class=org.apache.hadoop.hdds.server.http.HttpServer2$QuotingInputFilter)
datanode_4_1  | 2020-04-17 18:50:47,436 [Thread-24] INFO impl.RaftServerImpl: a0acbcec-d753-414c-b077-647d02aaa7fb@group-51477CB1F421: changes role from  FOLLOWER to CANDIDATE at term 0 for changeToCandidate
datanode_2_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.XceiverServerRatis.removeGroup(XceiverServerRatis.java:659)
datanode_5_1  | 	at org.apache.hadoop.ozone.container.common.volume.RoundRobinVolumeChoosingPolicy.chooseVolume(RoundRobinVolumeChoosingPolicy.java:77)
datanode_6_1  | 2020-04-17 18:50:40,993 [pool-69-thread-1] INFO storage.RaftStorageDirectory: The storage directory /data/metadata/ratis/475144cc-6599-45a9-b1c7-e8c5921c502f does not exist. Creating ...
scm_1         | 2020-04-17 18:50:36,155 [IPC Server listener on 9860] INFO ipc.Server: IPC Server listener on 9860: starting
om_1          | 2020-04-17 18:50:50,146 [main] INFO http.HttpServer2: Added filter static_user_filter (class=org.apache.hadoop.hdds.server.http.StaticUserWebFilter$StaticUserFilter) to context ozoneManager
datanode_4_1  | 2020-04-17 18:50:47,443 [Thread-24] INFO impl.RoleInfo: a0acbcec-d753-414c-b077-647d02aaa7fb: start LeaderElection
datanode_2_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.ClosePipelineCommandHandler.handle(ClosePipelineCommandHandler.java:77)
datanode_5_1  | 	at org.apache.hadoop.ozone.container.keyvalue.KeyValueContainer.create(KeyValueContainer.java:124)
datanode_6_1  | 2020-04-17 18:50:41,010 [pool-69-thread-1] INFO storage.RaftStorageDirectory: Lock on /data/metadata/ratis/475144cc-6599-45a9-b1c7-e8c5921c502f/in_use.lock acquired by nodename 6@9608d796128b
scm_1         | 2020-04-17 18:50:36,247 [main] INFO server.StorageContainerManager: ScmBlockLocationProtocol RPC server is listening at /0.0.0.0:9863
om_1          | 2020-04-17 18:50:50,147 [main] INFO http.HttpServer2: Added filter static_user_filter (class=org.apache.hadoop.hdds.server.http.StaticUserWebFilter$StaticUserFilter) to context logs
datanode_4_1  | 2020-04-17 18:50:47,488 [a0acbcec-d753-414c-b077-647d02aaa7fb@group-51477CB1F421-LeaderElection1] INFO impl.LeaderElection: a0acbcec-d753-414c-b077-647d02aaa7fb@group-51477CB1F421-LeaderElection1: begin an election at term 1 for -1: [a0acbcec-d753-414c-b077-647d02aaa7fb:10.5.0.7:9858], old=null
datanode_2_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.CommandDispatcher.handle(CommandDispatcher.java:99)
datanode_5_1  | 	... 13 more
datanode_6_1  | 2020-04-17 18:50:41,014 [pool-69-thread-1] INFO storage.RaftStorage: Storage directory /data/metadata/ratis/475144cc-6599-45a9-b1c7-e8c5921c502f has been successfully formatted.
scm_1         | 2020-04-17 18:50:36,252 [main] INFO server.SCMBlockProtocolServer: RPC server for Block Protocol is listening at /0.0.0.0:9863
om_1          | 2020-04-17 18:50:50,147 [main] INFO http.HttpServer2: Added filter static_user_filter (class=org.apache.hadoop.hdds.server.http.StaticUserWebFilter$StaticUserFilter) to context static
datanode_4_1  | 2020-04-17 18:50:47,490 [a0acbcec-d753-414c-b077-647d02aaa7fb@group-51477CB1F421-LeaderElection1] INFO impl.RoleInfo: a0acbcec-d753-414c-b077-647d02aaa7fb: shutdown LeaderElection
datanode_2_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.lambda$initCommandHandlerThread$1(DatanodeStateMachine.java:472)
datanode_5_1  | 2020-04-17 18:52:37,621 [ChunkWriter-57-0] INFO impl.HddsDispatcher: Operation: WriteChunk , Trace ID: dbf2e28874f8e582:fd88223a75928210:dbf2e28874f8e582:0 , Message: ContainerID 3 creation failed , Result: DISK_OUT_OF_SPACE , StorageContainerException Occurred.
datanode_6_1  | 2020-04-17 18:50:41,030 [pool-69-thread-1] INFO ratis.ContainerStateMachine: group-E8C5921C502F: The snapshot info is null. Setting the last applied indexto:(t:0, i:~)
scm_1         | 2020-04-17 18:50:36,266 [IPC Server Responder] INFO ipc.Server: IPC Server Responder: starting
datanode_4_1  | 2020-04-17 18:50:47,490 [a0acbcec-d753-414c-b077-647d02aaa7fb@group-51477CB1F421-LeaderElection1] INFO impl.RaftServerImpl: a0acbcec-d753-414c-b077-647d02aaa7fb@group-51477CB1F421: changes role from CANDIDATE to LEADER at term 1 for changeToLeader
om_1          | 2020-04-17 18:50:50,214 [main] WARN http.BaseHttpServer: /prof java profiling servlet is activated. Not safe for production!
datanode_2_1  | 	at java.base/java.lang.Thread.run(Thread.java:834)
datanode_5_1  | org.apache.hadoop.hdds.scm.container.common.helpers.StorageContainerException: ContainerID 3 creation failed
datanode_6_1  | 2020-04-17 18:50:41,054 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.notification.no-leader.timeout = 60s (default)
scm_1         | 2020-04-17 18:50:36,272 [IPC Server listener on 9863] INFO ipc.Server: IPC Server listener on 9863: starting
datanode_4_1  | 2020-04-17 18:50:47,499 [a0acbcec-d753-414c-b077-647d02aaa7fb@group-51477CB1F421-LeaderElection1] INFO ratis.XceiverServerRatis: Leader change notification received for group: group-51477CB1F421 with new leaderId: a0acbcec-d753-414c-b077-647d02aaa7fb
om_1          | 2020-04-17 18:50:50,217 [main] INFO http.HttpServer2: Jetty bound to port 9874
datanode_2_1  | Caused by: org.apache.ratis.protocol.GroupMismatchException: 0e99e1b0-220f-42bd-a39f-d4658f80d0e4: Group group-79E0035D853A not found.
datanode_5_1  | 	at org.apache.hadoop.ozone.container.common.impl.HddsDispatcher.dispatchRequest(HddsDispatcher.java:254)
datanode_6_1  | 2020-04-17 18:50:41,067 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.use.memory = false (default)
scm_1         | 2020-04-17 18:50:36,307 [main] INFO server.StorageContainerManager: ScmDatanodeProtocl RPC server is listening at /0.0.0.0:9861
datanode_4_1  | 2020-04-17 18:50:47,503 [a0acbcec-d753-414c-b077-647d02aaa7fb@group-51477CB1F421-LeaderElection1] INFO impl.RaftServerImpl: a0acbcec-d753-414c-b077-647d02aaa7fb@group-51477CB1F421: change Leader from null to a0acbcec-d753-414c-b077-647d02aaa7fb at term 1 for becomeLeader, leader elected after 5865ms
om_1          | 2020-04-17 18:50:50,218 [main] INFO server.Server: jetty-9.4.26.v20200117; built: 2020-01-17T12:35:33.676Z; git: 7b38981d25d14afb4a12ff1f2596756144edf695; jvm 11.0.6+10-LTS
datanode_2_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupRemoveAsync(RaftServerProxy.java:404)
datanode_6_1  | 2020-04-17 18:50:41,075 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.purge.gap = 1000000 (custom)
scm_1         | 2020-04-17 18:50:36,307 [main] INFO server.SCMDatanodeProtocolServer: RPC server for DataNodes is listening at /0.0.0.0:9861
datanode_4_1  | 2020-04-17 18:50:47,528 [a0acbcec-d753-414c-b077-647d02aaa7fb@group-51477CB1F421-LeaderElection1] INFO server.RaftServerConfigKeys: raft.server.staging.catchup.gap = 1000 (default)
om_1          | 2020-04-17 18:50:50,281 [main] INFO server.session: DefaultSessionIdManager workerName=node0
datanode_5_1  | 	at org.apache.hadoop.ozone.container.common.impl.HddsDispatcher.dispatch(HddsDispatcher.java:162)
datanode_4_1  | 2020-04-17 18:50:47,535 [a0acbcec-d753-414c-b077-647d02aaa7fb@group-51477CB1F421-LeaderElection1] INFO server.RaftServerConfigKeys: raft.server.rpc.sleep.time = 25ms (default)
datanode_6_1  | 2020-04-17 18:50:41,079 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
datanode_6_1  | 2020-04-17 18:50:41,088 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.segment.size.max = 1048576 (custom)
om_1          | 2020-04-17 18:50:50,281 [main] INFO server.session: No SessionScavenger set, using defaults
datanode_2_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupManagementAsync(RaftServerProxy.java:367)
datanode_4_1  | 2020-04-17 18:50:47,551 [a0acbcec-d753-414c-b077-647d02aaa7fb@group-51477CB1F421-LeaderElection1] INFO metrics.RatisMetrics: Creating Metrics Registry : ratis.log_appender.a0acbcec-d753-414c-b077-647d02aaa7fb@group-51477CB1F421
datanode_6_1  | 2020-04-17 18:50:41,098 [pool-69-thread-1] INFO metrics.RatisMetrics: Creating Metrics Registry : ratis.log_worker.79669a1f-2445-496e-a337-3115205f3ae5
scm_1         | 2020-04-17 18:50:36,309 [IPC Server Responder] INFO ipc.Server: IPC Server Responder: starting
datanode_5_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.ContainerStateMachine.dispatchCommand(ContainerStateMachine.java:402)
om_1          | 2020-04-17 18:50:50,283 [main] INFO server.session: node0 Scavenging every 600000ms
datanode_2_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupManagement(RaftServerProxy.java:350)
datanode_4_1  | 2020-04-17 18:50:47,557 [a0acbcec-d753-414c-b077-647d02aaa7fb@group-51477CB1F421-LeaderElection1] INFO server.RaftServerConfigKeys: raft.server.write.element-limit = 1024 (custom)
datanode_6_1  | 2020-04-17 18:50:41,144 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.segment.cache.num.max = 2 (custom)
scm_1         | 2020-04-17 18:50:36,309 [IPC Server listener on 9861] INFO ipc.Server: IPC Server listener on 9861: starting
datanode_5_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.ContainerStateMachine.runCommand(ContainerStateMachine.java:412)
datanode_5_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.ContainerStateMachine.lambda$handleWriteChunk$2(ContainerStateMachine.java:447)
datanode_5_1  | 	at java.base/java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1700)
datanode_2_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.XceiverServerRatis.removeGroup(XceiverServerRatis.java:657)
datanode_6_1  | 2020-04-17 18:50:41,175 [pool-69-thread-1] INFO segmented.SegmentedRaftLogWorker: new 79669a1f-2445-496e-a337-3115205f3ae5@group-E8C5921C502F-SegmentedRaftLogWorker for RaftStorage:Storage Directory /data/metadata/ratis/475144cc-6599-45a9-b1c7-e8c5921c502f
datanode_5_1  | 	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
datanode_4_1  | 2020-04-17 18:50:47,558 [a0acbcec-d753-414c-b077-647d02aaa7fb@group-51477CB1F421-LeaderElection1] INFO server.RaftServerConfigKeys: raft.server.write.byte-limit = 1073741824 (custom)
om_1          | 2020-04-17 18:50:50,311 [main] INFO handler.ContextHandler: Started o.e.j.s.ServletContextHandler@35e26d05{logs,/logs,file:///var/log/hadoop/,AVAILABLE}
scm_1         | 2020-04-17 18:50:36,406 [main] INFO http.HttpServer2: Jetty bound to port 9876
datanode_2_1  | 	... 4 more
datanode_6_1  | 2020-04-17 18:50:41,181 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.queue.byte-limit = 2147483647 (custom)
datanode_5_1  | 	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
datanode_4_1  | 2020-04-17 18:50:47,573 [a0acbcec-d753-414c-b077-647d02aaa7fb@group-51477CB1F421-LeaderElection1] INFO server.RaftServerConfigKeys: raft.server.watch.timeout = 180s (custom)
om_1          | 2020-04-17 18:50:50,321 [main] INFO handler.ContextHandler: Started o.e.j.s.ServletContextHandler@2538bc06{static,/static,jar:file:/opt/hadoop/share/ozone/lib/hadoop-ozone-ozone-manager-0.6.0-SNAPSHOT.jar!/webapps/static,AVAILABLE}
scm_1         | 2020-04-17 18:50:36,407 [main] INFO server.Server: jetty-9.4.26.v20200117; built: 2020-01-17T12:35:33.676Z; git: 7b38981d25d14afb4a12ff1f2596756144edf695; jvm 11.0.6+10-LTS
datanode_2_1  | 2020-04-17 18:54:08,666 [Command processor thread] INFO impl.RaftServerProxy: 0e99e1b0-220f-42bd-a39f-d4658f80d0e4: remove group-79E0035D853A:null
datanode_6_1  | 2020-04-17 18:50:41,181 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.queue.element-limit = 1024 (custom)
datanode_5_1  | 	at java.base/java.lang.Thread.run(Thread.java:834)
datanode_4_1  | 2020-04-17 18:50:47,587 [a0acbcec-d753-414c-b077-647d02aaa7fb@group-51477CB1F421-LeaderElection1] INFO server.RaftServerConfigKeys: raft.server.watch.timeout.denomination = 1s (default)
om_1          | 2020-04-17 18:50:50,900 [main] INFO handler.ContextHandler: Started o.e.j.w.WebAppContext@12ad1b2a{ozoneManager,/,file:///tmp/jetty-0_0_0_0-9874-hadoop-ozone-ozone-manager-0_6_0-SNAPSHOT_jar-_-any-842565634405608182.dir/webapp/,AVAILABLE}{jar:file:/opt/hadoop/share/ozone/lib/hadoop-ozone-ozone-manager-0.6.0-SNAPSHOT.jar!/webapps/ozoneManager}
om_1          | 2020-04-17 18:50:50,959 [main] INFO server.AbstractConnector: Started ServerConnector@2121d1f9{HTTP/1.1,[http/1.1]}{0.0.0.0:9874}
datanode_2_1  | 2020-04-17 18:54:08,666 [Command processor thread] ERROR commandhandler.ClosePipelineCommandHandler: Can't close pipeline #id: "cad403d1-ea2f-4530-84e5-79e0035d853a"
datanode_6_1  | 2020-04-17 18:50:41,182 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.segment.size.max = 1048576 (custom)
datanode_5_1  | 2020-04-17 18:52:37,623 [ChunkWriter-57-0] ERROR ratis.ContainerStateMachine: group-79E0035D853A: writeChunk writeStateMachineData failed: blockIdcontainerID: 3
datanode_4_1  | 2020-04-17 18:50:47,588 [a0acbcec-d753-414c-b077-647d02aaa7fb@group-51477CB1F421-LeaderElection1] INFO server.RaftServerConfigKeys: raft.server.watch.element-limit = 65536 (default)
om_1          | 2020-04-17 18:50:50,959 [main] INFO server.Server: Started @12257ms
scm_1         | 2020-04-17 18:50:36,485 [main] INFO server.session: DefaultSessionIdManager workerName=node0
datanode_2_1  | 
datanode_6_1  | 2020-04-17 18:50:41,182 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.preallocated.size = 16384 (custom)
datanode_5_1  | localID: 104015433404579858
datanode_4_1  | 2020-04-17 18:50:47,618 [a0acbcec-d753-414c-b077-647d02aaa7fb@group-51477CB1F421-LeaderElection1] INFO impl.RoleInfo: a0acbcec-d753-414c-b077-647d02aaa7fb: start LeaderState
om_1          | 2020-04-17 18:50:50,971 [main] INFO impl.MetricsSinkAdapter: Sink prometheus started
scm_1         | 2020-04-17 18:50:36,486 [main] INFO server.session: No SessionScavenger set, using defaults
datanode_2_1  | java.io.IOException: 0e99e1b0-220f-42bd-a39f-d4658f80d0e4: Group group-79E0035D853A not found.
datanode_6_1  | 2020-04-17 18:50:41,182 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.write.buffer.size = 1048576 (custom)
datanode_5_1  | blockCommitSequenceId: 0
datanode_4_1  | 2020-04-17 18:50:47,670 [a0acbcec-d753-414c-b077-647d02aaa7fb@group-51477CB1F421-LeaderElection1] INFO segmented.SegmentedRaftLogWorker: a0acbcec-d753-414c-b077-647d02aaa7fb@group-51477CB1F421-SegmentedRaftLogWorker: Starting segment from index:0
om_1          | 2020-04-17 18:50:50,971 [main] INFO impl.MetricsSystemImpl: Registered sink prometheus
om_1          | 2020-04-17 18:50:50,975 [main] INFO http.BaseHttpServer: HTTP server of ozoneManager listening at http://0.0.0.0:9874
datanode_2_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.XceiverServerRatis.removeGroup(XceiverServerRatis.java:659)
datanode_6_1  | 2020-04-17 18:50:41,193 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.force.sync.num = 128 (default)
datanode_5_1  |  logIndex 1 chunkName 104015433404579858_chunk_1 Error message: ContainerID 3 creation failed Container Result: DISK_OUT_OF_SPACE
datanode_4_1  | 2020-04-17 18:50:47,727 [a0acbcec-d753-414c-b077-647d02aaa7fb@group-51477CB1F421-LeaderElection1] INFO impl.RaftServerImpl: a0acbcec-d753-414c-b077-647d02aaa7fb@group-51477CB1F421: set configuration 0: [a0acbcec-d753-414c-b077-647d02aaa7fb:10.5.0.7:9858], old=null at 0
om_1          | 2020-04-17 18:50:54,922 [IPC Server handler 3 on 9862] INFO volume.OMVolumeCreateRequest: created volume:vol-0-05727 for user:hadoop
scm_1         | 2020-04-17 18:50:36,489 [main] INFO server.session: node0 Scavenging every 660000ms
datanode_2_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.ClosePipelineCommandHandler.handle(ClosePipelineCommandHandler.java:77)
datanode_6_1  | 2020-04-17 18:50:41,202 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.statemachine.data.sync = true (default)
datanode_5_1  | 2020-04-17 18:52:37,623 [978c057e-5c38-4e20-8a8b-f271c823af7e@group-79E0035D853A-SegmentedRaftLogWorker] ERROR ratis.XceiverServerRatis: pipeline Action CLOSE on pipeline PipelineID=cad403d1-ea2f-4530-84e5-79e0035d853a.Reason : ContainerID 3 creation failed
datanode_4_1  | 2020-04-17 18:50:47,739 [Thread-26] INFO impl.FollowerState: a0acbcec-d753-414c-b077-647d02aaa7fb@group-385EF22ED913-FollowerState: change to CANDIDATE, lastRpcTime:5018ms, electionTimeout:5001ms
om_1          | 2020-04-17 18:50:54,952 [IPC Server handler 1 on 9862] INFO volume.OMVolumeCreateRequest: created volume:vol-1-01079 for user:hadoop
scm_1         | 2020-04-17 18:50:36,546 [main] INFO handler.ContextHandler: Started o.e.j.s.ServletContextHandler@25b5c5e3{logs,/logs,file:///var/log/hadoop/,AVAILABLE}
datanode_2_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.CommandDispatcher.handle(CommandDispatcher.java:99)
datanode_6_1  | 2020-04-17 18:50:41,203 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.statemachine.data.sync.timeout = 10s (default)
datanode_5_1  | 2020-04-17 18:52:37,635 [978c057e-5c38-4e20-8a8b-f271c823af7e@group-79E0035D853A-SegmentedRaftLogWorker] ERROR ratis.XceiverServerRatis: pipeline Action CLOSE on pipeline PipelineID=cad403d1-ea2f-4530-84e5-79e0035d853a.Reason : Log already failed at index 1 for task WriteLog:1: (t:1, i:1), STATEMACHINELOGENTRY, client-B8993CFB43DC, cid=57
datanode_4_1  | 2020-04-17 18:50:47,742 [Thread-26] INFO impl.RoleInfo: a0acbcec-d753-414c-b077-647d02aaa7fb: shutdown FollowerState
om_1          | 2020-04-17 18:50:54,961 [IPC Server handler 5 on 9862] INFO volume.OMVolumeCreateRequest: created volume:vol-2-01434 for user:hadoop
scm_1         | 2020-04-17 18:50:36,554 [main] INFO handler.ContextHandler: Started o.e.j.s.ServletContextHandler@2c708440{static,/static,jar:file:/opt/hadoop/share/ozone/lib/hadoop-hdds-server-scm-0.6.0-SNAPSHOT.jar!/webapps/static,AVAILABLE}
datanode_2_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.lambda$initCommandHandlerThread$1(DatanodeStateMachine.java:472)
datanode_6_1  | 2020-04-17 18:50:41,204 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
datanode_5_1  | 	 State Machine: cmdType: WriteChunk traceID: "dbf2e28874f8e582:fd88223a75928210:dbf2e28874f8e582:0" containerID: 3 datanodeUuid: "a0acbcec-d753-414c-b077-647d02aaa7fb" pipelineID: "cad403d1-ea2f-4530-84e5-79e0035d853a" writeChunk { blockID { containerID: 3 localID: 104015433404579858 blockCommitSequenceId: 0 } chunkData { chunkName: "104015433404579858_chunk_1" offset: 0 len: 10240 checksumData { type: CRC32 bytesPerChecksum: 1048576 checksums: ">\344\315\231" } } }, container path=nonexistent
datanode_4_1  | 2020-04-17 18:50:47,742 [Thread-26] INFO impl.RaftServerImpl: a0acbcec-d753-414c-b077-647d02aaa7fb@group-385EF22ED913: changes role from  FOLLOWER to CANDIDATE at term 0 for changeToCandidate
om_1          | 2020-04-17 18:50:54,970 [IPC Server handler 7 on 9862] INFO volume.OMVolumeCreateRequest: created volume:vol-3-04732 for user:hadoop
scm_1         | 2020-04-17 18:50:36,633 [IPC Server handler 0 on 9861] WARN ipc.Server: IPC Server handler 0 on 9861, call Call#0 Retry#0 org.apache.hadoop.ozone.protocol.StorageContainerDatanodeProtocol.submitRequest from 10.5.0.7:50998: output error
datanode_2_1  | 	at java.base/java.lang.Thread.run(Thread.java:834)
datanode_6_1  | 2020-04-17 18:50:41,260 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.statemachine.data.caching.enabled = true (custom)
datanode_5_1  | 2020-04-17 18:53:00,937 [Command processor thread] ERROR commandhandler.CloseContainerCommandHandler: Container #3 does not exist in datanode. Container close failed.
datanode_4_1  | 2020-04-17 18:50:47,742 [Thread-26] INFO impl.RoleInfo: a0acbcec-d753-414c-b077-647d02aaa7fb: start LeaderElection
om_1          | 2020-04-17 18:50:54,979 [IPC Server handler 9 on 9862] INFO volume.OMVolumeCreateRequest: created volume:vol-4-57183 for user:hadoop
scm_1         | 2020-04-17 18:50:36,634 [IPC Server handler 2 on 9861] WARN ipc.Server: IPC Server handler 2 on 9861, call Call#0 Retry#0 org.apache.hadoop.ozone.protocol.StorageContainerDatanodeProtocol.submitRequest from 10.5.0.8:37696: output error
datanode_2_1  | Caused by: org.apache.ratis.protocol.GroupMismatchException: 0e99e1b0-220f-42bd-a39f-d4658f80d0e4: Group group-79E0035D853A not found.
datanode_6_1  | 2020-04-17 18:50:41,286 [pool-69-thread-1] INFO segmented.SegmentedRaftLogWorker: 79669a1f-2445-496e-a337-3115205f3ae5@group-E8C5921C502F-SegmentedRaftLogWorker: flushIndex: setUnconditionally 0 -> -1
datanode_5_1  | 2020-04-17 18:53:37,633 [java.util.concurrent.ThreadPoolExecutor$Worker@7369ad42[State = -1, empty queue]] WARN server.GrpcLogAppender: 978c057e-5c38-4e20-8a8b-f271c823af7e@group-79E0035D853A->0e99e1b0-220f-42bd-a39f-d4658f80d0e4-GrpcLogAppender:  appendEntries Timeout, request=AppendEntriesRequest:cid=2,entriesCount=1,lastEntry=(t:1, i:1)
datanode_4_1  | 2020-04-17 18:50:47,759 [a0acbcec-d753-414c-b077-647d02aaa7fb@group-385EF22ED913-LeaderElection2] INFO impl.LeaderElection: a0acbcec-d753-414c-b077-647d02aaa7fb@group-385EF22ED913-LeaderElection2: begin an election at term 1 for -1: [978c057e-5c38-4e20-8a8b-f271c823af7e:10.5.0.8:9858, a0acbcec-d753-414c-b077-647d02aaa7fb:10.5.0.7:9858, 0e99e1b0-220f-42bd-a39f-d4658f80d0e4:10.5.0.5:9858], old=null
datanode_4_1  | 2020-04-17 18:50:47,963 [a0acbcec-d753-414c-b077-647d02aaa7fb@group-385EF22ED913-LeaderElection2] INFO impl.LeaderElection: a0acbcec-d753-414c-b077-647d02aaa7fb@group-385EF22ED913-LeaderElection2: Election PASSED; received 1 response(s) [a0acbcec-d753-414c-b077-647d02aaa7fb<-0e99e1b0-220f-42bd-a39f-d4658f80d0e4#0:OK-t1] and 0 exception(s); a0acbcec-d753-414c-b077-647d02aaa7fb@group-385EF22ED913:t1, leader=null, voted=a0acbcec-d753-414c-b077-647d02aaa7fb, raftlog=a0acbcec-d753-414c-b077-647d02aaa7fb@group-385EF22ED913-SegmentedRaftLog:OPENED:c-1,f-1,i0, conf=-1: [978c057e-5c38-4e20-8a8b-f271c823af7e:10.5.0.8:9858, a0acbcec-d753-414c-b077-647d02aaa7fb:10.5.0.7:9858, 0e99e1b0-220f-42bd-a39f-d4658f80d0e4:10.5.0.5:9858], old=null
scm_1         | 2020-04-17 18:50:36,683 [IPC Server handler 0 on 9861] INFO ipc.Server: IPC Server handler 0 on 9861 caught an exception
datanode_6_1  | 2020-04-17 18:50:41,341 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.snapshot.auto.trigger.enabled = true (custom)
datanode_5_1  | 2020-04-17 18:53:37,636 [java.util.concurrent.ThreadPoolExecutor$Worker@7369ad42[State = -1, empty queue]] WARN server.GrpcLogAppender: 978c057e-5c38-4e20-8a8b-f271c823af7e@group-79E0035D853A->a0acbcec-d753-414c-b077-647d02aaa7fb-GrpcLogAppender:  appendEntries Timeout, request=AppendEntriesRequest:cid=2,entriesCount=1,lastEntry=(t:1, i:1)
datanode_5_1  | 2020-04-17 18:53:37,637 [java.util.concurrent.ThreadPoolExecutor$Worker@7369ad42[State = -1, empty queue]] WARN server.GrpcLogAppender: 978c057e-5c38-4e20-8a8b-f271c823af7e@group-79E0035D853A->a0acbcec-d753-414c-b077-647d02aaa7fb-GrpcLogAppender:  appendEntries Timeout, request=AppendEntriesRequest:cid=3,entriesCount=1,lastEntry=(t:1, i:2)
datanode_4_1  | 2020-04-17 18:50:47,967 [a0acbcec-d753-414c-b077-647d02aaa7fb@group-385EF22ED913-LeaderElection2] INFO impl.RoleInfo: a0acbcec-d753-414c-b077-647d02aaa7fb: shutdown LeaderElection
scm_1         | java.nio.channels.AsynchronousCloseException
datanode_6_1  | 2020-04-17 18:50:41,342 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
datanode_5_1  | 2020-04-17 18:53:37,654 [java.util.concurrent.ThreadPoolExecutor$Worker@7369ad42[State = -1, empty queue]] WARN server.GrpcLogAppender: 978c057e-5c38-4e20-8a8b-f271c823af7e@group-79E0035D853A->0e99e1b0-220f-42bd-a39f-d4658f80d0e4-GrpcLogAppender:  appendEntries Timeout, request=AppendEntriesRequest:cid=3,entriesCount=1,lastEntry=(t:1, i:2)
datanode_2_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupRemoveAsync(RaftServerProxy.java:404)
datanode_4_1  | 2020-04-17 18:50:47,974 [a0acbcec-d753-414c-b077-647d02aaa7fb@group-385EF22ED913-LeaderElection2] INFO impl.RaftServerImpl: a0acbcec-d753-414c-b077-647d02aaa7fb@group-385EF22ED913: changes role from CANDIDATE to LEADER at term 1 for changeToLeader
scm_1         | 	at java.base/sun.nio.ch.SocketChannelImpl.write(SocketChannelImpl.java:471)
datanode_6_1  | 2020-04-17 18:50:41,342 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.snapshot.retention.file.num = 5 (custom)
datanode_5_1  | 2020-04-17 18:53:58,341 [grpc-default-executor-0] INFO impl.RaftServerProxy: 978c057e-5c38-4e20-8a8b-f271c823af7e: addNew group-CFD51574C841:[978c057e-5c38-4e20-8a8b-f271c823af7e:10.5.0.8:9858, 79669a1f-2445-496e-a337-3115205f3ae5:10.5.0.9:9858, 0e99e1b0-220f-42bd-a39f-d4658f80d0e4:10.5.0.5:9858] returns group-CFD51574C841:java.util.concurrent.CompletableFuture@8d5294b[Not completed]
datanode_2_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupManagementAsync(RaftServerProxy.java:367)
datanode_4_1  | 2020-04-17 18:50:47,974 [a0acbcec-d753-414c-b077-647d02aaa7fb@group-385EF22ED913-LeaderElection2] INFO ratis.XceiverServerRatis: Leader change notification received for group: group-385EF22ED913 with new leaderId: a0acbcec-d753-414c-b077-647d02aaa7fb
scm_1         | 	at org.apache.hadoop.ipc.Server.channelWrite(Server.java:3250)
datanode_6_1  | 2020-04-17 18:50:41,351 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.retrycache.expirytime = 600000ms (custom)
datanode_5_1  | 2020-04-17 18:53:58,342 [pool-69-thread-1] INFO impl.RaftServerImpl: 978c057e-5c38-4e20-8a8b-f271c823af7e: new RaftServerImpl for group-CFD51574C841:[978c057e-5c38-4e20-8a8b-f271c823af7e:10.5.0.8:9858, 79669a1f-2445-496e-a337-3115205f3ae5:10.5.0.9:9858, 0e99e1b0-220f-42bd-a39f-d4658f80d0e4:10.5.0.5:9858] with ContainerStateMachine:uninitialized
datanode_2_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupManagement(RaftServerProxy.java:350)
datanode_4_1  | 2020-04-17 18:50:47,974 [a0acbcec-d753-414c-b077-647d02aaa7fb@group-385EF22ED913-LeaderElection2] INFO impl.RaftServerImpl: a0acbcec-d753-414c-b077-647d02aaa7fb@group-385EF22ED913: change Leader from null to a0acbcec-d753-414c-b077-647d02aaa7fb at term 1 for becomeLeader, leader elected after 5342ms
datanode_4_1  | 2020-04-17 18:50:47,974 [a0acbcec-d753-414c-b077-647d02aaa7fb@group-385EF22ED913-LeaderElection2] INFO server.RaftServerConfigKeys: raft.server.staging.catchup.gap = 1000 (default)
datanode_4_1  | 2020-04-17 18:50:47,974 [a0acbcec-d753-414c-b077-647d02aaa7fb@group-385EF22ED913-LeaderElection2] INFO server.RaftServerConfigKeys: raft.server.rpc.sleep.time = 25ms (default)
datanode_4_1  | 2020-04-17 18:50:47,975 [a0acbcec-d753-414c-b077-647d02aaa7fb@group-385EF22ED913-LeaderElection2] INFO metrics.RatisMetrics: Creating Metrics Registry : ratis.log_appender.a0acbcec-d753-414c-b077-647d02aaa7fb@group-385EF22ED913
scm_1         | 	at org.apache.hadoop.ipc.Server.access$1700(Server.java:137)
datanode_5_1  | 2020-04-17 18:53:58,342 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.rpc.timeout.min = 5s (custom)
datanode_4_1  | 2020-04-17 18:50:47,975 [a0acbcec-d753-414c-b077-647d02aaa7fb@group-385EF22ED913-LeaderElection2] INFO server.RaftServerConfigKeys: raft.server.write.element-limit = 1024 (custom)
datanode_4_1  | 2020-04-17 18:50:47,975 [a0acbcec-d753-414c-b077-647d02aaa7fb@group-385EF22ED913-LeaderElection2] INFO server.RaftServerConfigKeys: raft.server.write.byte-limit = 1073741824 (custom)
datanode_4_1  | 2020-04-17 18:50:47,985 [a0acbcec-d753-414c-b077-647d02aaa7fb@group-385EF22ED913-LeaderElection2] INFO server.RaftServerConfigKeys: raft.server.watch.timeout = 180s (custom)
datanode_4_1  | 2020-04-17 18:50:47,985 [a0acbcec-d753-414c-b077-647d02aaa7fb@group-385EF22ED913-LeaderElection2] INFO server.RaftServerConfigKeys: raft.server.watch.timeout.denomination = 1s (default)
scm_1         | 	at org.apache.hadoop.ipc.Server$Responder.processResponse(Server.java:1473)
datanode_6_1  | 2020-04-17 18:50:41,434 [pool-69-thread-1] INFO metrics.RatisMetrics: Creating Metrics Registry : ratis.leader_election.79669a1f-2445-496e-a337-3115205f3ae5@group-E8C5921C502F
datanode_2_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.XceiverServerRatis.removeGroup(XceiverServerRatis.java:657)
datanode_5_1  | 2020-04-17 18:53:58,342 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.rpc.timeout.max = 5200ms (custom)
datanode_5_1  | 2020-04-17 18:53:58,343 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.rpcslowness.timeout = 300s (custom)
datanode_5_1  | 2020-04-17 18:53:58,343 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.sleep.deviation.threshold = 300 (default)
datanode_6_1  | 2020-04-17 18:50:41,457 [pool-69-thread-1] INFO metrics.RatisMetrics: Creating Metrics Registry : ratis.server.79669a1f-2445-496e-a337-3115205f3ae5@group-E8C5921C502F
datanode_2_1  | 	... 4 more
scm_1         | 	at org.apache.hadoop.ipc.Server$Responder.doRespond(Server.java:1543)
datanode_5_1  | 2020-04-17 18:53:58,343 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.appender.install.snapshot.enabled = false (custom)
datanode_4_1  | 2020-04-17 18:50:47,985 [a0acbcec-d753-414c-b077-647d02aaa7fb@group-385EF22ED913-LeaderElection2] INFO server.RaftServerConfigKeys: raft.server.watch.element-limit = 65536 (default)
datanode_2_1  | 2020-04-17 18:54:12,554 [ChunkWriter-2-0] INFO keyvalue.KeyValueHandler: Operation: CreateContainer , Trace ID: 25f4cbb29a905ffd:e4110cf328601a91:25f4cbb29a905ffd:0 , Message: Container creation failed, due to disk out of space , Result: DISK_OUT_OF_SPACE , StorageContainerException Occurred.
scm_1         | 	at org.apache.hadoop.ipc.Server$Connection.sendResponse(Server.java:2593)
datanode_6_1  | 2020-04-17 18:50:41,458 [pool-69-thread-1] INFO impl.RaftServerImpl: 79669a1f-2445-496e-a337-3115205f3ae5@group-E8C5921C502F: start as a follower, conf=-1: [79669a1f-2445-496e-a337-3115205f3ae5:10.5.0.9:9858], old=null
datanode_4_1  | 2020-04-17 18:50:47,992 [a0acbcec-d753-414c-b077-647d02aaa7fb@group-385EF22ED913-LeaderElection2] INFO server.RaftServerConfigKeys: raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
datanode_2_1  | org.apache.hadoop.hdds.scm.container.common.helpers.StorageContainerException: Container creation failed, due to disk out of space
datanode_5_1  | 2020-04-17 18:53:58,343 [pool-69-thread-1] INFO impl.RaftServerImpl: 978c057e-5c38-4e20-8a8b-f271c823af7e@group-CFD51574C841: ConfigurationManager, init=-1: [978c057e-5c38-4e20-8a8b-f271c823af7e:10.5.0.8:9858, 79669a1f-2445-496e-a337-3115205f3ae5:10.5.0.9:9858, 0e99e1b0-220f-42bd-a39f-d4658f80d0e4:10.5.0.5:9858], old=null, confs=<EMPTY_MAP>
scm_1         | 	at org.apache.hadoop.ipc.Server$Connection.access$300(Server.java:1615)
datanode_4_1  | 2020-04-17 18:50:47,992 [a0acbcec-d753-414c-b077-647d02aaa7fb@group-385EF22ED913-LeaderElection2] INFO server.RaftServerConfigKeys: raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
datanode_2_1  | 	at org.apache.hadoop.ozone.container.keyvalue.KeyValueContainer.create(KeyValueContainer.java:165)
datanode_5_1  | 2020-04-17 18:53:58,343 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.storage.dir = [/data/metadata/ratis] (custom)
datanode_6_1  | 2020-04-17 18:50:41,483 [pool-69-thread-1] INFO impl.RaftServerImpl: 79669a1f-2445-496e-a337-3115205f3ae5@group-E8C5921C502F: changes role from      null to FOLLOWER at term 0 for startAsFollower
scm_1         | 	at org.apache.hadoop.ipc.Server$RpcCall.doResponse(Server.java:940)
datanode_4_1  | 2020-04-17 18:50:47,993 [a0acbcec-d753-414c-b077-647d02aaa7fb@group-385EF22ED913-LeaderElection2] INFO server.RaftServerConfigKeys: raft.server.log.appender.buffer.element-limit = 1 (custom)
datanode_2_1  | 	at org.apache.hadoop.ozone.container.keyvalue.KeyValueHandler.handleCreateContainer(KeyValueHandler.java:247)
datanode_5_1  | 2020-04-17 18:53:58,343 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.corruption.policy = EXCEPTION (default)
datanode_6_1  | 2020-04-17 18:50:41,485 [pool-69-thread-1] INFO impl.RoleInfo: 79669a1f-2445-496e-a337-3115205f3ae5: start FollowerState
scm_1         | 	at org.apache.hadoop.ipc.Server$Call.sendResponse(Server.java:774)
datanode_4_1  | 2020-04-17 18:50:48,006 [a0acbcec-d753-414c-b077-647d02aaa7fb@group-385EF22ED913-LeaderElection2] INFO grpc.GrpcConfigKeys: raft.grpc.server.leader.outstanding.appends.max = 128 (default)
datanode_2_1  | 	at org.apache.hadoop.ozone.container.keyvalue.KeyValueHandler.dispatchRequest(KeyValueHandler.java:164)
datanode_5_1  | 2020-04-17 18:53:58,343 [pool-69-thread-1] INFO storage.RaftStorageDirectory: The storage directory /data/metadata/ratis/825f4d0e-2629-43e6-a52f-cfd51574c841 does not exist. Creating ...
datanode_6_1  | 2020-04-17 18:50:41,503 [pool-69-thread-1] INFO util.JmxRegister: Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-E8C5921C502F,id=79669a1f-2445-496e-a337-3115205f3ae5
scm_1         | 	at org.apache.hadoop.ipc.Server$RpcCall.run(Server.java:885)
datanode_4_1  | 2020-04-17 18:50:48,012 [a0acbcec-d753-414c-b077-647d02aaa7fb@group-385EF22ED913-LeaderElection2] INFO server.RaftServerConfigKeys: raft.server.rpc.request.timeout = 60s (custom)
datanode_2_1  | 	at org.apache.hadoop.ozone.container.keyvalue.KeyValueHandler.handle(KeyValueHandler.java:152)
datanode_5_1  | 2020-04-17 18:53:58,344 [pool-69-thread-1] INFO storage.RaftStorageDirectory: Lock on /data/metadata/ratis/825f4d0e-2629-43e6-a52f-cfd51574c841/in_use.lock acquired by nodename 6@650579c681b3
datanode_6_1  | 2020-04-17 18:50:41,505 [pool-69-thread-1] INFO metrics.RatisMetrics: Creating Metrics Registry : ratis.state_machine.79669a1f-2445-496e-a337-3115205f3ae5@group-E8C5921C502F
scm_1         | 	at org.apache.hadoop.ipc.Server$RpcCall.run(Server.java:822)
datanode_4_1  | 2020-04-17 18:50:48,012 [a0acbcec-d753-414c-b077-647d02aaa7fb@group-385EF22ED913-LeaderElection2] INFO server.RaftServerConfigKeys: raft.server.log.appender.install.snapshot.enabled = false (custom)
datanode_2_1  | 	at org.apache.hadoop.ozone.container.common.impl.HddsDispatcher.createContainer(HddsDispatcher.java:414)
datanode_5_1  | 2020-04-17 18:53:58,345 [pool-69-thread-1] INFO storage.RaftStorage: Storage directory /data/metadata/ratis/825f4d0e-2629-43e6-a52f-cfd51574c841 has been successfully formatted.
datanode_6_1  | 2020-04-17 18:50:41,539 [Command processor thread] INFO commandhandler.CreatePipelineCommandHandler: Created Pipeline RATIS ONE #id: "475144cc-6599-45a9-b1c7-e8c5921c502f"
scm_1         | 	at java.base/java.security.AccessController.doPrivileged(Native Method)
datanode_4_1  | 2020-04-17 18:50:48,024 [a0acbcec-d753-414c-b077-647d02aaa7fb@group-385EF22ED913-LeaderElection2] INFO server.RaftServerConfigKeys: raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
datanode_2_1  | 	at org.apache.hadoop.ozone.container.common.impl.HddsDispatcher.dispatchRequest(HddsDispatcher.java:250)
datanode_5_1  | 2020-04-17 18:53:58,346 [pool-69-thread-1] INFO ratis.ContainerStateMachine: group-CFD51574C841: The snapshot info is null. Setting the last applied indexto:(t:0, i:~)
datanode_6_1  | .
scm_1         | 	at java.base/javax.security.auth.Subject.doAs(Subject.java:423)
datanode_4_1  | 2020-04-17 18:50:48,040 [a0acbcec-d753-414c-b077-647d02aaa7fb@group-385EF22ED913-LeaderElection2] INFO server.RaftServerConfigKeys: raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
datanode_2_1  | 	at org.apache.hadoop.ozone.container.common.impl.HddsDispatcher.dispatch(HddsDispatcher.java:162)
datanode_5_1  | 2020-04-17 18:53:58,346 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.notification.no-leader.timeout = 60s (default)
datanode_6_1  | 2020-04-17 18:50:41,540 [Command processor thread] INFO impl.RaftServerProxy: 79669a1f-2445-496e-a337-3115205f3ae5: addNew group-F5BD6C5F0281:[b23d8fb0-3698-40b4-ac98-17b8605a770b:10.5.0.4:9858, 32863f73-3555-4b23-932a-0d28eb668aea:10.5.0.6:9858, 79669a1f-2445-496e-a337-3115205f3ae5:10.5.0.9:9858] returns group-F5BD6C5F0281:java.util.concurrent.CompletableFuture@293e181[Not completed]
scm_1         | 	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1730)
datanode_4_1  | 2020-04-17 18:50:48,040 [a0acbcec-d753-414c-b077-647d02aaa7fb@group-385EF22ED913-LeaderElection2] INFO server.RaftServerConfigKeys: raft.server.log.appender.buffer.element-limit = 1 (custom)
datanode_2_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.ContainerStateMachine.dispatchCommand(ContainerStateMachine.java:402)
datanode_5_1  | 2020-04-17 18:53:58,346 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.use.memory = false (default)
datanode_6_1  | 2020-04-17 18:50:41,579 [pool-69-thread-1] INFO impl.RaftServerImpl: 79669a1f-2445-496e-a337-3115205f3ae5: new RaftServerImpl for group-F5BD6C5F0281:[b23d8fb0-3698-40b4-ac98-17b8605a770b:10.5.0.4:9858, 32863f73-3555-4b23-932a-0d28eb668aea:10.5.0.6:9858, 79669a1f-2445-496e-a337-3115205f3ae5:10.5.0.9:9858] with ContainerStateMachine:uninitialized
scm_1         | 	at org.apache.hadoop.ipc.Server$Handler.run(Server.java:2682)
datanode_4_1  | 2020-04-17 18:50:48,040 [a0acbcec-d753-414c-b077-647d02aaa7fb@group-385EF22ED913-LeaderElection2] INFO grpc.GrpcConfigKeys: raft.grpc.server.leader.outstanding.appends.max = 128 (default)
datanode_2_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.ContainerStateMachine.runCommand(ContainerStateMachine.java:412)
datanode_5_1  | 2020-04-17 18:53:58,346 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.purge.gap = 1000000 (custom)
datanode_6_1  | 2020-04-17 18:50:41,580 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.rpc.timeout.min = 5s (custom)
scm_1         | 2020-04-17 18:50:36,684 [IPC Server handler 2 on 9861] INFO ipc.Server: IPC Server handler 2 on 9861 caught an exception
datanode_4_1  | 2020-04-17 18:50:48,040 [a0acbcec-d753-414c-b077-647d02aaa7fb@group-385EF22ED913-LeaderElection2] INFO server.RaftServerConfigKeys: raft.server.rpc.request.timeout = 60s (custom)
datanode_4_1  | 2020-04-17 18:50:48,047 [a0acbcec-d753-414c-b077-647d02aaa7fb@group-385EF22ED913-LeaderElection2] INFO server.RaftServerConfigKeys: raft.server.log.appender.install.snapshot.enabled = false (custom)
datanode_2_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.ContainerStateMachine.lambda$handleWriteChunk$2(ContainerStateMachine.java:447)
datanode_6_1  | 2020-04-17 18:50:41,580 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.rpc.timeout.max = 5200ms (custom)
scm_1         | java.nio.channels.AsynchronousCloseException
datanode_4_1  | 2020-04-17 18:50:48,056 [a0acbcec-d753-414c-b077-647d02aaa7fb@group-385EF22ED913-LeaderElection2] INFO impl.RoleInfo: a0acbcec-d753-414c-b077-647d02aaa7fb: start LeaderState
datanode_5_1  | 2020-04-17 18:53:58,346 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
datanode_2_1  | 	at java.base/java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1700)
scm_1         | 	at java.base/sun.nio.ch.SocketChannelImpl.write(SocketChannelImpl.java:471)
datanode_6_1  | 2020-04-17 18:50:41,580 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.rpcslowness.timeout = 300s (custom)
datanode_2_1  | 	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
scm_1         | 	at org.apache.hadoop.ipc.Server.channelWrite(Server.java:3250)
datanode_4_1  | 2020-04-17 18:50:48,056 [a0acbcec-d753-414c-b077-647d02aaa7fb@group-385EF22ED913-LeaderElection2] INFO segmented.SegmentedRaftLogWorker: a0acbcec-d753-414c-b077-647d02aaa7fb@group-385EF22ED913-SegmentedRaftLogWorker: Starting segment from index:0
datanode_6_1  | 2020-04-17 18:50:41,580 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.sleep.deviation.threshold = 300 (default)
datanode_5_1  | 2020-04-17 18:53:58,346 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.segment.size.max = 1048576 (custom)
datanode_5_1  | 2020-04-17 18:53:58,346 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.segment.cache.num.max = 2 (custom)
scm_1         | 	at org.apache.hadoop.ipc.Server.access$1700(Server.java:137)
datanode_4_1  | 2020-04-17 18:50:48,083 [a0acbcec-d753-414c-b077-647d02aaa7fb@group-385EF22ED913-LeaderElection2] INFO impl.RaftServerImpl: a0acbcec-d753-414c-b077-647d02aaa7fb@group-385EF22ED913: set configuration 0: [978c057e-5c38-4e20-8a8b-f271c823af7e:10.5.0.8:9858, a0acbcec-d753-414c-b077-647d02aaa7fb:10.5.0.7:9858, 0e99e1b0-220f-42bd-a39f-d4658f80d0e4:10.5.0.5:9858], old=null at 0
datanode_6_1  | 2020-04-17 18:50:41,580 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.appender.install.snapshot.enabled = false (custom)
datanode_5_1  | 2020-04-17 18:53:58,346 [pool-69-thread-1] INFO segmented.SegmentedRaftLogWorker: new 978c057e-5c38-4e20-8a8b-f271c823af7e@group-CFD51574C841-SegmentedRaftLogWorker for RaftStorage:Storage Directory /data/metadata/ratis/825f4d0e-2629-43e6-a52f-cfd51574c841
datanode_2_1  | 	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
scm_1         | 	at org.apache.hadoop.ipc.Server$Responder.processResponse(Server.java:1473)
datanode_4_1  | 2020-04-17 18:50:48,351 [a0acbcec-d753-414c-b077-647d02aaa7fb@group-385EF22ED913-SegmentedRaftLogWorker] INFO segmented.SegmentedRaftLogWorker: a0acbcec-d753-414c-b077-647d02aaa7fb@group-385EF22ED913-SegmentedRaftLogWorker: created new log segment /data/metadata/ratis/be26d0dd-802f-4608-9a1c-385ef22ed913/current/log_inprogress_0
datanode_6_1  | 2020-04-17 18:50:41,581 [pool-69-thread-1] INFO impl.RaftServerImpl: 79669a1f-2445-496e-a337-3115205f3ae5@group-F5BD6C5F0281: ConfigurationManager, init=-1: [b23d8fb0-3698-40b4-ac98-17b8605a770b:10.5.0.4:9858, 32863f73-3555-4b23-932a-0d28eb668aea:10.5.0.6:9858, 79669a1f-2445-496e-a337-3115205f3ae5:10.5.0.9:9858], old=null, confs=<EMPTY_MAP>
datanode_5_1  | 2020-04-17 18:53:58,346 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.queue.byte-limit = 2147483647 (custom)
datanode_5_1  | 2020-04-17 18:53:58,346 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.queue.element-limit = 1024 (custom)
scm_1         | 	at org.apache.hadoop.ipc.Server$Responder.doRespond(Server.java:1543)
scm_1         | 	at org.apache.hadoop.ipc.Server$Connection.sendResponse(Server.java:2593)
scm_1         | 	at org.apache.hadoop.ipc.Server$Connection.access$300(Server.java:1615)
scm_1         | 	at org.apache.hadoop.ipc.Server$RpcCall.doResponse(Server.java:940)
scm_1         | 	at org.apache.hadoop.ipc.Server$Call.sendResponse(Server.java:774)
scm_1         | 	at org.apache.hadoop.ipc.Server$RpcCall.run(Server.java:885)
scm_1         | 	at org.apache.hadoop.ipc.Server$RpcCall.run(Server.java:822)
scm_1         | 	at java.base/java.security.AccessController.doPrivileged(Native Method)
scm_1         | 	at java.base/javax.security.auth.Subject.doAs(Subject.java:423)
scm_1         | 	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1730)
scm_1         | 	at org.apache.hadoop.ipc.Server$Handler.run(Server.java:2682)
scm_1         | 2020-04-17 18:50:37,464 [main] INFO handler.ContextHandler: Started o.e.j.w.WebAppContext@1981d861{scm,/,file:///tmp/jetty-0_0_0_0-9876-hadoop-hdds-server-scm-0_6_0-SNAPSHOT_jar-_-any-15548150163000367037.dir/webapp/,AVAILABLE}{jar:file:/opt/hadoop/share/ozone/lib/hadoop-hdds-server-scm-0.6.0-SNAPSHOT.jar!/webapps/scm}
scm_1         | 2020-04-17 18:50:37,504 [main] INFO server.AbstractConnector: Started ServerConnector@507d20bb{HTTP/1.1,[http/1.1]}{0.0.0.0:9876}
scm_1         | 2020-04-17 18:50:37,504 [main] INFO server.Server: Started @19561ms
datanode_6_1  | 2020-04-17 18:50:41,581 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.storage.dir = [/data/metadata/ratis] (custom)
datanode_2_1  | 	at java.base/java.lang.Thread.run(Thread.java:834)
datanode_4_1  | 2020-04-17 18:50:48,356 [a0acbcec-d753-414c-b077-647d02aaa7fb@group-51477CB1F421-SegmentedRaftLogWorker] INFO segmented.SegmentedRaftLogWorker: a0acbcec-d753-414c-b077-647d02aaa7fb@group-51477CB1F421-SegmentedRaftLogWorker: created new log segment /data/metadata/ratis/f9d10128-1d59-4577-ad6c-51477cb1f421/current/log_inprogress_0
scm_1         | 2020-04-17 18:50:37,512 [main] INFO impl.MetricsSinkAdapter: Sink prometheus started
datanode_5_1  | 2020-04-17 18:53:58,346 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.segment.size.max = 1048576 (custom)
datanode_6_1  | 2020-04-17 18:50:41,581 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.corruption.policy = EXCEPTION (default)
datanode_2_1  | Caused by: org.apache.hadoop.util.DiskChecker$DiskOutOfSpaceException: Out of space: The volume with the most available space (=964890624 B) is less than the container size (=1073741824 B).
datanode_4_1  | 2020-04-17 18:50:58,562 [ChunkWriter-40-0] INFO keyvalue.KeyValueHandler: Operation: CreateContainer , Trace ID: e215c60bfe250702:7a34a8519fdccc42:e215c60bfe250702:0 , Message: Container creation failed, due to disk out of space , Result: DISK_OUT_OF_SPACE , StorageContainerException Occurred.
scm_1         | 2020-04-17 18:50:37,512 [main] INFO impl.MetricsSystemImpl: Registered sink prometheus
datanode_5_1  | 2020-04-17 18:53:58,346 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.preallocated.size = 16384 (custom)
datanode_6_1  | 2020-04-17 18:50:41,581 [pool-69-thread-1] INFO storage.RaftStorageDirectory: The storage directory /data/metadata/ratis/315eee3a-6983-45b7-a699-f5bd6c5f0281 does not exist. Creating ...
datanode_2_1  | 	at org.apache.hadoop.ozone.container.common.volume.RoundRobinVolumeChoosingPolicy.chooseVolume(RoundRobinVolumeChoosingPolicy.java:77)
datanode_4_1  | org.apache.hadoop.hdds.scm.container.common.helpers.StorageContainerException: Container creation failed, due to disk out of space
scm_1         | 2020-04-17 18:50:37,517 [main] INFO http.BaseHttpServer: HTTP server of scm listening at http://0.0.0.0:9876
datanode_5_1  | 2020-04-17 18:53:58,346 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.write.buffer.size = 1048576 (custom)
datanode_6_1  | 2020-04-17 18:50:41,583 [pool-69-thread-1] INFO storage.RaftStorageDirectory: Lock on /data/metadata/ratis/315eee3a-6983-45b7-a699-f5bd6c5f0281/in_use.lock acquired by nodename 6@9608d796128b
datanode_4_1  | 	at org.apache.hadoop.ozone.container.keyvalue.KeyValueContainer.create(KeyValueContainer.java:165)
datanode_5_1  | 2020-04-17 18:53:58,346 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.force.sync.num = 128 (default)
datanode_6_1  | 2020-04-17 18:50:41,592 [pool-69-thread-1] INFO storage.RaftStorage: Storage directory /data/metadata/ratis/315eee3a-6983-45b7-a699-f5bd6c5f0281 has been successfully formatted.
datanode_2_1  | 	at org.apache.hadoop.ozone.container.keyvalue.KeyValueContainer.create(KeyValueContainer.java:124)
scm_1         | 2020-04-17 18:50:37,544 [org.apache.hadoop.util.JvmPauseMonitor$Monitor@1e253c9d] INFO util.JvmPauseMonitor: Starting JVM pause monitor
datanode_4_1  | 	at org.apache.hadoop.ozone.container.keyvalue.KeyValueHandler.handleCreateContainer(KeyValueHandler.java:247)
datanode_5_1  | 2020-04-17 18:53:58,346 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.statemachine.data.sync = true (default)
datanode_6_1  | 2020-04-17 18:50:41,592 [pool-69-thread-1] INFO ratis.ContainerStateMachine: group-F5BD6C5F0281: The snapshot info is null. Setting the last applied indexto:(t:0, i:~)
datanode_2_1  | 	... 13 more
scm_1         | 2020-04-17 18:50:37,814 [IPC Server handler 7 on 9861] INFO net.NetworkTopology: Added a new node: /rack2/79669a1f-2445-496e-a337-3115205f3ae5
datanode_4_1  | 	at org.apache.hadoop.ozone.container.keyvalue.KeyValueHandler.dispatchRequest(KeyValueHandler.java:164)
datanode_5_1  | 2020-04-17 18:53:58,346 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.statemachine.data.sync.timeout = 10s (default)
datanode_6_1  | 2020-04-17 18:50:41,593 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.notification.no-leader.timeout = 60s (default)
datanode_2_1  | 2020-04-17 18:54:12,574 [ChunkWriter-2-0] INFO impl.HddsDispatcher: Operation: WriteChunk , Trace ID: 25f4cbb29a905ffd:e4110cf328601a91:25f4cbb29a905ffd:0 , Message: ContainerID 4 creation failed , Result: DISK_OUT_OF_SPACE , StorageContainerException Occurred.
scm_1         | 2020-04-17 18:50:37,815 [IPC Server handler 7 on 9861] INFO node.SCMNodeManager: Registered Data node : 79669a1f-2445-496e-a337-3115205f3ae5{ip: 10.5.0.9, host: ozone-topology_datanode_6_1.ozone-topology_net, networkLocation: /rack2, certSerialId: null}
datanode_4_1  | 	at org.apache.hadoop.ozone.container.keyvalue.KeyValueHandler.handle(KeyValueHandler.java:152)
datanode_5_1  | 2020-04-17 18:53:58,346 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
datanode_6_1  | 2020-04-17 18:50:41,593 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.use.memory = false (default)
datanode_2_1  | org.apache.hadoop.hdds.scm.container.common.helpers.StorageContainerException: ContainerID 4 creation failed
scm_1         | 2020-04-17 18:50:37,833 [EventQueue-NodeRegistrationContainerReportForContainerSafeModeRule] INFO safemode.SCMSafeModeManager: ContainerSafeModeRule rule is successfully validated
datanode_4_1  | 	at org.apache.hadoop.ozone.container.common.impl.HddsDispatcher.createContainer(HddsDispatcher.java:414)
datanode_5_1  | 2020-04-17 18:53:58,347 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.statemachine.data.caching.enabled = true (custom)
datanode_6_1  | 2020-04-17 18:50:41,593 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.purge.gap = 1000000 (custom)
datanode_2_1  | 	at org.apache.hadoop.ozone.container.common.impl.HddsDispatcher.dispatchRequest(HddsDispatcher.java:254)
scm_1         | 2020-04-17 18:50:37,834 [EventQueue-NodeRegistrationContainerReportForDataNodeSafeModeRule] INFO safemode.SCMSafeModeManager: SCM in safe mode. 1 DataNodes registered, 4 required.
datanode_4_1  | 	at org.apache.hadoop.ozone.container.common.impl.HddsDispatcher.dispatchRequest(HddsDispatcher.java:250)
datanode_5_1  | 2020-04-17 18:53:58,348 [pool-69-thread-1] INFO segmented.SegmentedRaftLogWorker: 978c057e-5c38-4e20-8a8b-f271c823af7e@group-CFD51574C841-SegmentedRaftLogWorker: flushIndex: setUnconditionally 0 -> -1
datanode_6_1  | 2020-04-17 18:50:41,593 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
datanode_2_1  | 	at org.apache.hadoop.ozone.container.common.impl.HddsDispatcher.dispatch(HddsDispatcher.java:162)
scm_1         | 2020-04-17 18:50:37,858 [RatisPipelineUtilsThread] INFO pipeline.RatisPipelineProvider: Sending CreatePipelineCommand for pipeline:PipelineID=475144cc-6599-45a9-b1c7-e8c5921c502f to datanode:79669a1f-2445-496e-a337-3115205f3ae5
datanode_4_1  | 	at org.apache.hadoop.ozone.container.common.impl.HddsDispatcher.dispatch(HddsDispatcher.java:162)
datanode_5_1  | 2020-04-17 18:53:58,348 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.snapshot.auto.trigger.enabled = true (custom)
datanode_6_1  | 2020-04-17 18:50:41,593 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.segment.size.max = 1048576 (custom)
datanode_2_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.ContainerStateMachine.dispatchCommand(ContainerStateMachine.java:402)
scm_1         | 2020-04-17 18:50:37,877 [RatisPipelineUtilsThread] INFO pipeline.PipelineStateManager: Created pipeline Pipeline[ Id: 475144cc-6599-45a9-b1c7-e8c5921c502f, Nodes: 79669a1f-2445-496e-a337-3115205f3ae5{ip: 10.5.0.9, host: ozone-topology_datanode_6_1.ozone-topology_net, networkLocation: /rack2, certSerialId: null}, Type:RATIS, Factor:ONE, State:ALLOCATED, leaderId:null, CreationTimestamp2020-04-17T18:50:37.848114Z]
datanode_4_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.ContainerStateMachine.dispatchCommand(ContainerStateMachine.java:402)
datanode_5_1  | 2020-04-17 18:53:58,348 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
datanode_6_1  | 2020-04-17 18:50:41,594 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.segment.cache.num.max = 2 (custom)
datanode_2_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.ContainerStateMachine.runCommand(ContainerStateMachine.java:412)
scm_1         | 2020-04-17 18:50:37,880 [RatisPipelineUtilsThread] ERROR pipeline.SCMPipelineManager: Failed to create pipeline of type RATIS and factor ONE. Exception: Cannot create pipeline of factor 1 using 0 nodes. Used 1 nodes. Healthy nodes 1
datanode_4_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.ContainerStateMachine.runCommand(ContainerStateMachine.java:412)
datanode_5_1  | 2020-04-17 18:53:58,348 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.snapshot.retention.file.num = 5 (custom)
datanode_6_1  | 2020-04-17 18:50:41,595 [pool-69-thread-1] INFO segmented.SegmentedRaftLogWorker: new 79669a1f-2445-496e-a337-3115205f3ae5@group-F5BD6C5F0281-SegmentedRaftLogWorker for RaftStorage:Storage Directory /data/metadata/ratis/315eee3a-6983-45b7-a699-f5bd6c5f0281
datanode_2_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.ContainerStateMachine.lambda$handleWriteChunk$2(ContainerStateMachine.java:447)
scm_1         | 2020-04-17 18:50:38,032 [IPC Server handler 8 on 9861] INFO net.NetworkTopology: Added a new node: /rack1/32863f73-3555-4b23-932a-0d28eb668aea
datanode_4_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.ContainerStateMachine.lambda$handleWriteChunk$2(ContainerStateMachine.java:447)
datanode_5_1  | 2020-04-17 18:53:58,348 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.retrycache.expirytime = 600000ms (custom)
datanode_6_1  | 2020-04-17 18:50:41,595 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.queue.byte-limit = 2147483647 (custom)
datanode_2_1  | 	at java.base/java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1700)
scm_1         | 2020-04-17 18:50:38,033 [IPC Server handler 8 on 9861] INFO node.SCMNodeManager: Registered Data node : 32863f73-3555-4b23-932a-0d28eb668aea{ip: 10.5.0.6, host: ozone-topology_datanode_3_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}
datanode_4_1  | 	at java.base/java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1700)
datanode_6_1  | 2020-04-17 18:50:41,595 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.queue.element-limit = 1024 (custom)
datanode_2_1  | 	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
datanode_2_1  | 	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
datanode_5_1  | 2020-04-17 18:53:58,348 [pool-69-thread-1] INFO metrics.RatisMetrics: Creating Metrics Registry : ratis.leader_election.978c057e-5c38-4e20-8a8b-f271c823af7e@group-CFD51574C841
datanode_4_1  | 	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
datanode_4_1  | 	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
datanode_2_1  | 	at java.base/java.lang.Thread.run(Thread.java:834)
scm_1         | 2020-04-17 18:50:38,034 [EventQueue-NodeRegistrationContainerReportForContainerSafeModeRule] INFO safemode.SCMSafeModeManager: ContainerSafeModeRule rule is successfully validated
datanode_5_1  | 2020-04-17 18:53:58,348 [pool-69-thread-1] INFO metrics.RatisMetrics: Creating Metrics Registry : ratis.server.978c057e-5c38-4e20-8a8b-f271c823af7e@group-CFD51574C841
datanode_4_1  | 	at java.base/java.lang.Thread.run(Thread.java:834)
datanode_6_1  | 2020-04-17 18:50:41,595 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.segment.size.max = 1048576 (custom)
datanode_2_1  | 2020-04-17 18:54:12,575 [ChunkWriter-2-0] ERROR ratis.ContainerStateMachine: group-CFD51574C841: writeChunk writeStateMachineData failed: blockIdcontainerID: 4
scm_1         | 2020-04-17 18:50:38,034 [EventQueue-NodeRegistrationContainerReportForDataNodeSafeModeRule] INFO safemode.SCMSafeModeManager: SCM in safe mode. 2 DataNodes registered, 4 required.
datanode_5_1  | 2020-04-17 18:53:58,349 [pool-69-thread-1] INFO impl.RaftServerImpl: 978c057e-5c38-4e20-8a8b-f271c823af7e@group-CFD51574C841: start as a follower, conf=-1: [978c057e-5c38-4e20-8a8b-f271c823af7e:10.5.0.8:9858, 79669a1f-2445-496e-a337-3115205f3ae5:10.5.0.9:9858, 0e99e1b0-220f-42bd-a39f-d4658f80d0e4:10.5.0.5:9858], old=null
datanode_2_1  | localID: 104015439626764310
datanode_4_1  | Caused by: org.apache.hadoop.util.DiskChecker$DiskOutOfSpaceException: Out of space: The volume with the most available space (=966049792 B) is less than the container size (=1073741824 B).
datanode_6_1  | 2020-04-17 18:50:41,595 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.preallocated.size = 16384 (custom)
scm_1         | 2020-04-17 18:50:38,035 [RatisPipelineUtilsThread] INFO pipeline.RatisPipelineProvider: Sending CreatePipelineCommand for pipeline:PipelineID=78615a2e-50d8-4031-9b8b-cc09c422f088 to datanode:32863f73-3555-4b23-932a-0d28eb668aea
datanode_5_1  | 2020-04-17 18:53:58,349 [pool-69-thread-1] INFO impl.RaftServerImpl: 978c057e-5c38-4e20-8a8b-f271c823af7e@group-CFD51574C841: changes role from      null to FOLLOWER at term 0 for startAsFollower
datanode_2_1  | blockCommitSequenceId: 0
datanode_4_1  | 	at org.apache.hadoop.ozone.container.common.volume.RoundRobinVolumeChoosingPolicy.chooseVolume(RoundRobinVolumeChoosingPolicy.java:77)
datanode_6_1  | 2020-04-17 18:50:41,595 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.write.buffer.size = 1048576 (custom)
scm_1         | 2020-04-17 18:50:38,037 [RatisPipelineUtilsThread] INFO pipeline.PipelineStateManager: Created pipeline Pipeline[ Id: 78615a2e-50d8-4031-9b8b-cc09c422f088, Nodes: 32863f73-3555-4b23-932a-0d28eb668aea{ip: 10.5.0.6, host: ozone-topology_datanode_3_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}, Type:RATIS, Factor:ONE, State:ALLOCATED, leaderId:null, CreationTimestamp2020-04-17T18:50:38.035960Z]
datanode_5_1  | 2020-04-17 18:53:58,349 [pool-69-thread-1] INFO impl.RoleInfo: 978c057e-5c38-4e20-8a8b-f271c823af7e: start FollowerState
datanode_5_1  | 2020-04-17 18:53:58,363 [pool-69-thread-1] INFO util.JmxRegister: Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-CFD51574C841,id=978c057e-5c38-4e20-8a8b-f271c823af7e
datanode_5_1  | 2020-04-17 18:53:58,364 [pool-69-thread-1] INFO metrics.RatisMetrics: Creating Metrics Registry : ratis.state_machine.978c057e-5c38-4e20-8a8b-f271c823af7e@group-CFD51574C841
datanode_6_1  | 2020-04-17 18:50:41,596 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.force.sync.num = 128 (default)
scm_1         | 2020-04-17 18:50:38,038 [RatisPipelineUtilsThread] ERROR pipeline.SCMPipelineManager: Failed to create pipeline of type RATIS and factor ONE. Exception: Cannot create pipeline of factor 1 using 0 nodes. Used 2 nodes. Healthy nodes 2
datanode_2_1  |  logIndex 1 chunkName 104015439626764310_chunk_1 Error message: ContainerID 4 creation failed Container Result: DISK_OUT_OF_SPACE
datanode_5_1  | 2020-04-17 18:54:03,489 [grpc-default-executor-0] INFO impl.RaftServerImpl: 978c057e-5c38-4e20-8a8b-f271c823af7e@group-CFD51574C841: changes role from  FOLLOWER to FOLLOWER at term 1 for recognizeCandidate:0e99e1b0-220f-42bd-a39f-d4658f80d0e4
datanode_4_1  | 	at org.apache.hadoop.ozone.container.keyvalue.KeyValueContainer.create(KeyValueContainer.java:124)
datanode_6_1  | 2020-04-17 18:50:41,596 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.statemachine.data.sync = true (default)
scm_1         | 2020-04-17 18:50:38,328 [IPC Server handler 12 on 9861] INFO net.NetworkTopology: Added a new node: /rack2/a0acbcec-d753-414c-b077-647d02aaa7fb
datanode_2_1  | 2020-04-17 18:54:12,576 [0e99e1b0-220f-42bd-a39f-d4658f80d0e4@group-CFD51574C841-SegmentedRaftLogWorker] ERROR ratis.XceiverServerRatis: pipeline Action CLOSE on pipeline PipelineID=825f4d0e-2629-43e6-a52f-cfd51574c841.Reason : ContainerID 4 creation failed
datanode_5_1  | 2020-04-17 18:54:03,489 [grpc-default-executor-0] INFO impl.RoleInfo: 978c057e-5c38-4e20-8a8b-f271c823af7e: shutdown FollowerState
datanode_4_1  | 	... 13 more
datanode_6_1  | 2020-04-17 18:50:41,596 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.statemachine.data.sync.timeout = 10s (default)
scm_1         | 2020-04-17 18:50:38,328 [IPC Server handler 12 on 9861] INFO node.SCMNodeManager: Registered Data node : a0acbcec-d753-414c-b077-647d02aaa7fb{ip: 10.5.0.7, host: ozone-topology_datanode_4_1.ozone-topology_net, networkLocation: /rack2, certSerialId: null}
datanode_2_1  | 2020-04-17 18:54:12,579 [0e99e1b0-220f-42bd-a39f-d4658f80d0e4@group-CFD51574C841-SegmentedRaftLogWorker] ERROR ratis.XceiverServerRatis: pipeline Action CLOSE on pipeline PipelineID=825f4d0e-2629-43e6-a52f-cfd51574c841.Reason : Log already failed at index 1 for task WriteLog:1: (t:1, i:1), STATEMACHINELOGENTRY, client-191241DA7A93, cid=70
datanode_5_1  | 2020-04-17 18:54:03,490 [Thread-95] INFO impl.FollowerState: 978c057e-5c38-4e20-8a8b-f271c823af7e@group-CFD51574C841-FollowerState was interrupted: java.lang.InterruptedException: sleep interrupted
datanode_4_1  | 2020-04-17 18:50:58,680 [ChunkWriter-40-0] INFO impl.HddsDispatcher: Operation: WriteChunk , Trace ID: e215c60bfe250702:7a34a8519fdccc42:e215c60bfe250702:0 , Message: ContainerID 2 creation failed , Result: DISK_OUT_OF_SPACE , StorageContainerException Occurred.
datanode_6_1  | 2020-04-17 18:50:41,599 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
scm_1         | 2020-04-17 18:50:38,328 [EventQueue-NodeRegistrationContainerReportForDataNodeSafeModeRule] INFO safemode.SCMSafeModeManager: SCM in safe mode. 3 DataNodes registered, 4 required.
datanode_2_1  | 	 State Machine: cmdType: WriteChunk traceID: "25f4cbb29a905ffd:e4110cf328601a91:25f4cbb29a905ffd:0" containerID: 4 datanodeUuid: "978c057e-5c38-4e20-8a8b-f271c823af7e" pipelineID: "825f4d0e-2629-43e6-a52f-cfd51574c841" writeChunk { blockID { containerID: 4 localID: 104015439626764310 blockCommitSequenceId: 0 } chunkData { chunkName: "104015439626764310_chunk_1" offset: 0 len: 10240 checksumData { type: CRC32 bytesPerChecksum: 1048576 checksums: ">\344\315\231" } } }, container path=nonexistent
datanode_5_1  | 2020-04-17 18:54:03,490 [grpc-default-executor-0] INFO impl.RoleInfo: 978c057e-5c38-4e20-8a8b-f271c823af7e: start FollowerState
datanode_4_1  | org.apache.hadoop.hdds.scm.container.common.helpers.StorageContainerException: ContainerID 2 creation failed
datanode_6_1  | 2020-04-17 18:50:41,599 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.statemachine.data.caching.enabled = true (custom)
scm_1         | 2020-04-17 18:50:38,329 [EventQueue-NodeRegistrationContainerReportForContainerSafeModeRule] INFO safemode.SCMSafeModeManager: ContainerSafeModeRule rule is successfully validated
datanode_2_1  | 2020-04-17 18:54:34,514 [Command processor thread] INFO impl.RaftServerProxy: 0e99e1b0-220f-42bd-a39f-d4658f80d0e4: remove group-79E0035D853A:null
datanode_5_1  | 2020-04-17 18:54:03,589 [grpc-default-executor-0] INFO ratis.XceiverServerRatis: Leader change notification received for group: group-CFD51574C841 with new leaderId: 0e99e1b0-220f-42bd-a39f-d4658f80d0e4
datanode_4_1  | 	at org.apache.hadoop.ozone.container.common.impl.HddsDispatcher.dispatchRequest(HddsDispatcher.java:254)
datanode_6_1  | 2020-04-17 18:50:41,600 [pool-69-thread-1] INFO segmented.SegmentedRaftLogWorker: 79669a1f-2445-496e-a337-3115205f3ae5@group-F5BD6C5F0281-SegmentedRaftLogWorker: flushIndex: setUnconditionally 0 -> -1
datanode_5_1  | 2020-04-17 18:54:03,589 [grpc-default-executor-0] INFO impl.RaftServerImpl: 978c057e-5c38-4e20-8a8b-f271c823af7e@group-CFD51574C841: change Leader from null to 0e99e1b0-220f-42bd-a39f-d4658f80d0e4 at term 1 for appendEntries, leader elected after 5243ms
datanode_4_1  | 	at org.apache.hadoop.ozone.container.common.impl.HddsDispatcher.dispatch(HddsDispatcher.java:162)
datanode_4_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.ContainerStateMachine.dispatchCommand(ContainerStateMachine.java:402)
datanode_4_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.ContainerStateMachine.runCommand(ContainerStateMachine.java:412)
datanode_4_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.ContainerStateMachine.lambda$handleWriteChunk$2(ContainerStateMachine.java:447)
datanode_4_1  | 	at java.base/java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1700)
datanode_6_1  | 2020-04-17 18:50:41,638 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.snapshot.auto.trigger.enabled = true (custom)
datanode_5_1  | 2020-04-17 18:54:03,602 [grpc-default-executor-0] INFO impl.RaftServerImpl: 978c057e-5c38-4e20-8a8b-f271c823af7e@group-CFD51574C841: set configuration 0: [978c057e-5c38-4e20-8a8b-f271c823af7e:10.5.0.8:9858, 79669a1f-2445-496e-a337-3115205f3ae5:10.5.0.9:9858, 0e99e1b0-220f-42bd-a39f-d4658f80d0e4:10.5.0.5:9858], old=null at 0
scm_1         | 2020-04-17 18:50:38,330 [RatisPipelineUtilsThread] INFO pipeline.RatisPipelineProvider: Sending CreatePipelineCommand for pipeline:PipelineID=f9d10128-1d59-4577-ad6c-51477cb1f421 to datanode:a0acbcec-d753-414c-b077-647d02aaa7fb
datanode_4_1  | 	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
datanode_2_1  | 2020-04-17 18:54:34,515 [Command processor thread] ERROR commandhandler.ClosePipelineCommandHandler: Can't close pipeline #id: "cad403d1-ea2f-4530-84e5-79e0035d853a"
datanode_6_1  | 2020-04-17 18:50:41,638 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
datanode_5_1  | 2020-04-17 18:54:03,602 [grpc-default-executor-0] INFO segmented.SegmentedRaftLogWorker: 978c057e-5c38-4e20-8a8b-f271c823af7e@group-CFD51574C841-SegmentedRaftLogWorker: Starting segment from index:0
scm_1         | 2020-04-17 18:50:38,333 [RatisPipelineUtilsThread] INFO pipeline.PipelineStateManager: Created pipeline Pipeline[ Id: f9d10128-1d59-4577-ad6c-51477cb1f421, Nodes: a0acbcec-d753-414c-b077-647d02aaa7fb{ip: 10.5.0.7, host: ozone-topology_datanode_4_1.ozone-topology_net, networkLocation: /rack2, certSerialId: null}, Type:RATIS, Factor:ONE, State:ALLOCATED, leaderId:null, CreationTimestamp2020-04-17T18:50:38.330093Z]
datanode_4_1  | 	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
datanode_4_1  | 	at java.base/java.lang.Thread.run(Thread.java:834)
scm_1         | 2020-04-17 18:50:38,334 [RatisPipelineUtilsThread] ERROR pipeline.SCMPipelineManager: Failed to create pipeline of type RATIS and factor ONE. Exception: Cannot create pipeline of factor 1 using 0 nodes. Used 3 nodes. Healthy nodes 3
scm_1         | 2020-04-17 18:50:38,963 [IPC Server handler 8 on 9861] INFO net.NetworkTopology: Added a new node: /rack1/b23d8fb0-3698-40b4-ac98-17b8605a770b
datanode_2_1  | 
datanode_5_1  | 2020-04-17 18:54:03,604 [978c057e-5c38-4e20-8a8b-f271c823af7e@group-CFD51574C841-SegmentedRaftLogWorker] INFO segmented.SegmentedRaftLogWorker: 978c057e-5c38-4e20-8a8b-f271c823af7e@group-CFD51574C841-SegmentedRaftLogWorker: created new log segment /data/metadata/ratis/825f4d0e-2629-43e6-a52f-cfd51574c841/current/log_inprogress_0
datanode_4_1  | 2020-04-17 18:50:58,727 [ChunkWriter-40-0] ERROR ratis.ContainerStateMachine: group-385EF22ED913: writeChunk writeStateMachineData failed: blockIdcontainerID: 2
scm_1         | 2020-04-17 18:50:38,963 [IPC Server handler 8 on 9861] INFO node.SCMNodeManager: Registered Data node : b23d8fb0-3698-40b4-ac98-17b8605a770b{ip: 10.5.0.4, host: ozone-topology_datanode_1_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}
datanode_6_1  | 2020-04-17 18:50:41,638 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.snapshot.retention.file.num = 5 (custom)
datanode_2_1  | java.io.IOException: 0e99e1b0-220f-42bd-a39f-d4658f80d0e4: Group group-79E0035D853A not found.
datanode_5_1  | 2020-04-17 18:54:08,637 [Command processor thread] INFO impl.RaftServerProxy: 978c057e-5c38-4e20-8a8b-f271c823af7e: remove    LEADER 978c057e-5c38-4e20-8a8b-f271c823af7e@group-79E0035D853A:t1, leader=978c057e-5c38-4e20-8a8b-f271c823af7e, voted=978c057e-5c38-4e20-8a8b-f271c823af7e, raftlog=978c057e-5c38-4e20-8a8b-f271c823af7e@group-79E0035D853A-SegmentedRaftLog:OPENED:c0,f0,i2, conf=0: [978c057e-5c38-4e20-8a8b-f271c823af7e:10.5.0.8:9858, a0acbcec-d753-414c-b077-647d02aaa7fb:10.5.0.7:9858, 0e99e1b0-220f-42bd-a39f-d4658f80d0e4:10.5.0.5:9858], old=null RUNNING
datanode_4_1  | localID: 104015426885648386
scm_1         | 2020-04-17 18:50:38,964 [EventQueue-NodeRegistrationContainerReportForContainerSafeModeRule] INFO safemode.SCMSafeModeManager: ContainerSafeModeRule rule is successfully validated
datanode_6_1  | 2020-04-17 18:50:41,638 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.retrycache.expirytime = 600000ms (custom)
datanode_2_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.XceiverServerRatis.removeGroup(XceiverServerRatis.java:659)
datanode_5_1  | 2020-04-17 18:54:08,637 [Command processor thread] INFO impl.RaftServerImpl: 978c057e-5c38-4e20-8a8b-f271c823af7e@group-79E0035D853A: shutdown
datanode_4_1  | blockCommitSequenceId: 0
scm_1         | 2020-04-17 18:50:38,964 [EventQueue-NodeRegistrationContainerReportForDataNodeSafeModeRule] INFO safemode.SCMSafeModeManager: SCM in safe mode. 4 DataNodes registered, 4 required.
datanode_6_1  | 2020-04-17 18:50:41,638 [pool-69-thread-1] INFO metrics.RatisMetrics: Creating Metrics Registry : ratis.leader_election.79669a1f-2445-496e-a337-3115205f3ae5@group-F5BD6C5F0281
datanode_2_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.ClosePipelineCommandHandler.handle(ClosePipelineCommandHandler.java:77)
datanode_5_1  | 2020-04-17 18:54:08,637 [Command processor thread] INFO util.JmxRegister: Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-79E0035D853A,id=978c057e-5c38-4e20-8a8b-f271c823af7e
datanode_4_1  |  logIndex 1 chunkName 104015426885648386_chunk_1 Error message: ContainerID 2 creation failed Container Result: DISK_OUT_OF_SPACE
scm_1         | 2020-04-17 18:50:38,967 [EventQueue-NodeRegistrationContainerReportForDataNodeSafeModeRule] INFO safemode.SCMSafeModeManager: DataNodeSafeModeRule rule is successfully validated
datanode_6_1  | 2020-04-17 18:50:41,639 [pool-69-thread-1] INFO metrics.RatisMetrics: Creating Metrics Registry : ratis.server.79669a1f-2445-496e-a337-3115205f3ae5@group-F5BD6C5F0281
datanode_2_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.CommandDispatcher.handle(CommandDispatcher.java:99)
datanode_5_1  | 2020-04-17 18:54:08,637 [Command processor thread] INFO impl.RoleInfo: 978c057e-5c38-4e20-8a8b-f271c823af7e: shutdown LeaderState
datanode_4_1  | 2020-04-17 18:50:58,745 [a0acbcec-d753-414c-b077-647d02aaa7fb@group-385EF22ED913-SegmentedRaftLogWorker] ERROR ratis.XceiverServerRatis: pipeline Action CLOSE on pipeline PipelineID=be26d0dd-802f-4608-9a1c-385ef22ed913.Reason : ContainerID 2 creation failed
scm_1         | 2020-04-17 18:50:38,967 [EventQueue-NodeRegistrationContainerReportForDataNodeSafeModeRule] INFO safemode.SCMSafeModeManager: All SCM safe mode pre check rules have passed
datanode_6_1  | 2020-04-17 18:50:41,640 [pool-69-thread-1] INFO impl.RaftServerImpl: 79669a1f-2445-496e-a337-3115205f3ae5@group-F5BD6C5F0281: start as a follower, conf=-1: [b23d8fb0-3698-40b4-ac98-17b8605a770b:10.5.0.4:9858, 32863f73-3555-4b23-932a-0d28eb668aea:10.5.0.6:9858, 79669a1f-2445-496e-a337-3115205f3ae5:10.5.0.9:9858], old=null
datanode_2_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.lambda$initCommandHandlerThread$1(DatanodeStateMachine.java:472)
datanode_5_1  | 2020-04-17 18:54:08,639 [Command processor thread] INFO impl.PendingRequests: 978c057e-5c38-4e20-8a8b-f271c823af7e@group-79E0035D853A-PendingRequests: sendNotLeaderResponses
datanode_4_1  | 2020-04-17 18:50:58,939 [a0acbcec-d753-414c-b077-647d02aaa7fb@group-385EF22ED913-SegmentedRaftLogWorker] ERROR ratis.XceiverServerRatis: pipeline Action CLOSE on pipeline PipelineID=be26d0dd-802f-4608-9a1c-385ef22ed913.Reason : Log already failed at index 1 for task WriteLog:1: (t:1, i:1), STATEMACHINELOGENTRY, client-884610206644, cid=8
scm_1         | 2020-04-17 18:50:38,968 [RatisPipelineUtilsThread] INFO pipeline.RatisPipelineProvider: Sending CreatePipelineCommand for pipeline:PipelineID=584150c2-fc44-4ccf-a30e-39398b1c5c01 to datanode:b23d8fb0-3698-40b4-ac98-17b8605a770b
datanode_6_1  | 2020-04-17 18:50:41,640 [pool-69-thread-1] INFO impl.RaftServerImpl: 79669a1f-2445-496e-a337-3115205f3ae5@group-F5BD6C5F0281: changes role from      null to FOLLOWER at term 0 for startAsFollower
datanode_2_1  | 	at java.base/java.lang.Thread.run(Thread.java:834)
datanode_5_1  | 2020-04-17 18:54:08,639 [org.apache.ratis.server.impl.LogAppender$AppenderDaemon$$Lambda$524/0x00000008405fe040@561fefa2] WARN server.GrpcLogAppender: 978c057e-5c38-4e20-8a8b-f271c823af7e@group-79E0035D853A->0e99e1b0-220f-42bd-a39f-d4658f80d0e4-GrpcLogAppender: Wait interrupted by java.lang.InterruptedException
datanode_4_1  | 	 State Machine: cmdType: WriteChunk traceID: "e215c60bfe250702:7a34a8519fdccc42:e215c60bfe250702:0" containerID: 2 datanodeUuid: "0e99e1b0-220f-42bd-a39f-d4658f80d0e4" pipelineID: "be26d0dd-802f-4608-9a1c-385ef22ed913" writeChunk { blockID { containerID: 2 localID: 104015426885648386 blockCommitSequenceId: 0 } chunkData { chunkName: "104015426885648386_chunk_1" offset: 0 len: 10240 checksumData { type: CRC32 bytesPerChecksum: 1048576 checksums: ">\344\315\231" } } }, container path=nonexistent
scm_1         | 2020-04-17 18:50:38,969 [RatisPipelineUtilsThread] INFO pipeline.PipelineStateManager: Created pipeline Pipeline[ Id: 584150c2-fc44-4ccf-a30e-39398b1c5c01, Nodes: b23d8fb0-3698-40b4-ac98-17b8605a770b{ip: 10.5.0.4, host: ozone-topology_datanode_1_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}, Type:RATIS, Factor:ONE, State:ALLOCATED, leaderId:null, CreationTimestamp2020-04-17T18:50:38.964295Z]
datanode_6_1  | 2020-04-17 18:50:41,640 [pool-69-thread-1] INFO impl.RoleInfo: 79669a1f-2445-496e-a337-3115205f3ae5: start FollowerState
datanode_2_1  | Caused by: org.apache.ratis.protocol.GroupMismatchException: 0e99e1b0-220f-42bd-a39f-d4658f80d0e4: Group group-79E0035D853A not found.
datanode_5_1  | 2020-04-17 18:54:08,638 [org.apache.ratis.server.impl.LogAppender$AppenderDaemon$$Lambda$524/0x00000008405fe040@3fefc00d] WARN server.GrpcLogAppender: 978c057e-5c38-4e20-8a8b-f271c823af7e@group-79E0035D853A->a0acbcec-d753-414c-b077-647d02aaa7fb-GrpcLogAppender: Wait interrupted by java.lang.InterruptedException
datanode_4_1  | 2020-04-17 18:51:13,634 [Command processor thread] ERROR commandhandler.CloseContainerCommandHandler: Container #2 does not exist in datanode. Container close failed.
scm_1         | 2020-04-17 18:50:38,970 [RatisPipelineUtilsThread] ERROR pipeline.SCMPipelineManager: Failed to create pipeline of type RATIS and factor ONE. Exception: Cannot create pipeline of factor 1 using 0 nodes. Used 4 nodes. Healthy nodes 4
datanode_6_1  | 2020-04-17 18:50:41,642 [pool-69-thread-1] INFO util.JmxRegister: Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-F5BD6C5F0281,id=79669a1f-2445-496e-a337-3115205f3ae5
datanode_5_1  | 2020-04-17 18:54:08,644 [grpc-default-executor-0] INFO server.GrpcLogAppender: 978c057e-5c38-4e20-8a8b-f271c823af7e@group-79E0035D853A->0e99e1b0-220f-42bd-a39f-d4658f80d0e4-AppendLogResponseHandler: follower responses appendEntries COMPLETED
datanode_4_1  | 2020-04-17 18:51:58,491 [java.util.concurrent.ThreadPoolExecutor$Worker@22d4cc9e[State = -1, empty queue]] WARN server.GrpcLogAppender: a0acbcec-d753-414c-b077-647d02aaa7fb@group-385EF22ED913->978c057e-5c38-4e20-8a8b-f271c823af7e-GrpcLogAppender:  appendEntries Timeout, request=AppendEntriesRequest:cid=5,entriesCount=1,lastEntry=(t:1, i:1)
scm_1         | 2020-04-17 18:50:38,971 [RatisPipelineUtilsThread] ERROR pipeline.SCMPipelineManager: Failed to create pipeline of type RATIS and factor ONE. Exception: Cannot create pipeline of factor 1 using 0 nodes. Used 4 nodes. Healthy nodes 4
datanode_6_1  | 2020-04-17 18:50:41,643 [pool-69-thread-1] INFO metrics.RatisMetrics: Creating Metrics Registry : ratis.state_machine.79669a1f-2445-496e-a337-3115205f3ae5@group-F5BD6C5F0281
datanode_2_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupRemoveAsync(RaftServerProxy.java:404)
datanode_5_1  | 2020-04-17 18:54:08,653 [Command processor thread] INFO metrics.RatisMetrics: Unregistering Metrics Registry : ratis.log_appender.978c057e-5c38-4e20-8a8b-f271c823af7e@group-79E0035D853A
datanode_5_1  | 2020-04-17 18:54:08,653 [Command processor thread] INFO impl.StateMachineUpdater: 978c057e-5c38-4e20-8a8b-f271c823af7e@group-79E0035D853A-StateMachineUpdater: set stopIndex = 0
scm_1         | 2020-04-17 18:50:38,975 [IPC Server handler 9 on 9861] INFO net.NetworkTopology: Added a new node: /rack1/0e99e1b0-220f-42bd-a39f-d4658f80d0e4
datanode_6_1  | 2020-04-17 18:50:45,209 [grpc-default-executor-0] WARN impl.RaftServerProxy: 79669a1f-2445-496e-a337-3115205f3ae5: Failed groupAdd* GroupManagementRequest:client-445ACEDDE7E3->79669a1f-2445-496e-a337-3115205f3ae5@group-F5BD6C5F0281, cid=0, seq=0, RW, null, Add:group-F5BD6C5F0281:[b23d8fb0-3698-40b4-ac98-17b8605a770b:10.5.0.4:9858, 32863f73-3555-4b23-932a-0d28eb668aea:10.5.0.6:9858, 79669a1f-2445-496e-a337-3115205f3ae5:10.5.0.9:9858]
datanode_2_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupManagementAsync(RaftServerProxy.java:367)
datanode_5_1  | 2020-04-17 18:54:08,654 [978c057e-5c38-4e20-8a8b-f271c823af7e@group-79E0035D853A-StateMachineUpdater] ERROR ratis.ContainerStateMachine: Failed to take snapshot  for group-79E0035D853A as the stateMachine is unhealthy. The last applied index is at (t:1, i:0)
datanode_4_1  | 2020-04-17 18:51:58,493 [java.util.concurrent.ThreadPoolExecutor$Worker@22d4cc9e[State = -1, empty queue]] WARN server.GrpcLogAppender: a0acbcec-d753-414c-b077-647d02aaa7fb@group-385EF22ED913->0e99e1b0-220f-42bd-a39f-d4658f80d0e4-GrpcLogAppender:  appendEntries Timeout, request=AppendEntriesRequest:cid=5,entriesCount=1,lastEntry=(t:1, i:1)
scm_1         | 2020-04-17 18:50:38,975 [IPC Server handler 9 on 9861] INFO node.SCMNodeManager: Registered Data node : 0e99e1b0-220f-42bd-a39f-d4658f80d0e4{ip: 10.5.0.5, host: ozone-topology_datanode_2_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}
datanode_6_1  | java.util.concurrent.CompletionException: org.apache.ratis.protocol.AlreadyExistsException: 79669a1f-2445-496e-a337-3115205f3ae5: Failed to add group-F5BD6C5F0281:[b23d8fb0-3698-40b4-ac98-17b8605a770b:10.5.0.4:9858, 32863f73-3555-4b23-932a-0d28eb668aea:10.5.0.6:9858, 79669a1f-2445-496e-a337-3115205f3ae5:10.5.0.9:9858] since the group already exists in the map.
datanode_2_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupManagement(RaftServerProxy.java:350)
datanode_5_1  | 2020-04-17 18:54:08,654 [978c057e-5c38-4e20-8a8b-f271c823af7e@group-79E0035D853A-StateMachineUpdater] ERROR impl.StateMachineUpdater: 978c057e-5c38-4e20-8a8b-f271c823af7e@group-79E0035D853A-StateMachineUpdater: Failed to take snapshot
datanode_4_1  | 2020-04-17 18:51:58,537 [java.util.concurrent.ThreadPoolExecutor$Worker@22d4cc9e[State = -1, empty queue]] WARN server.GrpcLogAppender: a0acbcec-d753-414c-b077-647d02aaa7fb@group-385EF22ED913->978c057e-5c38-4e20-8a8b-f271c823af7e-GrpcLogAppender:  appendEntries Timeout, request=AppendEntriesRequest:cid=6,entriesCount=1,lastEntry=(t:1, i:2)
datanode_2_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.XceiverServerRatis.removeGroup(XceiverServerRatis.java:657)
datanode_4_1  | 2020-04-17 18:51:58,546 [java.util.concurrent.ThreadPoolExecutor$Worker@22d4cc9e[State = -1, empty queue]] WARN server.GrpcLogAppender: a0acbcec-d753-414c-b077-647d02aaa7fb@group-385EF22ED913->0e99e1b0-220f-42bd-a39f-d4658f80d0e4-GrpcLogAppender:  appendEntries Timeout, request=AppendEntriesRequest:cid=6,entriesCount=1,lastEntry=(t:1, i:2)
datanode_6_1  | 	at java.base/java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:331)
datanode_5_1  | org.apache.ratis.protocol.StateMachineException: Failed to take snapshot  for group-79E0035D853A as the stateMachine is unhealthy. The last applied index is at (t:1, i:0)
datanode_2_1  | 	... 4 more
scm_1         | 2020-04-17 18:50:38,976 [EventQueue-NodeRegistrationContainerReportForContainerSafeModeRule] INFO safemode.SCMSafeModeManager: ContainerSafeModeRule rule is successfully validated
datanode_4_1  | 2020-04-17 18:52:29,943 [Command processor thread] INFO impl.RaftServerProxy: a0acbcec-d753-414c-b077-647d02aaa7fb: remove    LEADER a0acbcec-d753-414c-b077-647d02aaa7fb@group-385EF22ED913:t1, leader=a0acbcec-d753-414c-b077-647d02aaa7fb, voted=a0acbcec-d753-414c-b077-647d02aaa7fb, raftlog=a0acbcec-d753-414c-b077-647d02aaa7fb@group-385EF22ED913-SegmentedRaftLog:OPENED:c0,f0,i2, conf=0: [978c057e-5c38-4e20-8a8b-f271c823af7e:10.5.0.8:9858, a0acbcec-d753-414c-b077-647d02aaa7fb:10.5.0.7:9858, 0e99e1b0-220f-42bd-a39f-d4658f80d0e4:10.5.0.5:9858], old=null RUNNING
datanode_6_1  | 	at java.base/java.util.concurrent.CompletableFuture.uniApplyNow(CompletableFuture.java:670)
datanode_5_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.ContainerStateMachine.takeSnapshot(ContainerStateMachine.java:288)
datanode_2_1  | 2020-04-17 18:54:34,515 [Command processor thread] ERROR commandhandler.CloseContainerCommandHandler: Container #4 does not exist in datanode. Container close failed.
scm_1         | 2020-04-17 18:50:38,976 [EventQueue-NodeRegistrationContainerReportForDataNodeSafeModeRule] INFO safemode.SCMSafeModeManager: DataNodeSafeModeRule rule is successfully validated
datanode_4_1  | 2020-04-17 18:52:29,945 [Command processor thread] INFO impl.RaftServerImpl: a0acbcec-d753-414c-b077-647d02aaa7fb@group-385EF22ED913: shutdown
datanode_6_1  | 	at java.base/java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:658)
datanode_5_1  | 	at org.apache.ratis.server.impl.StateMachineUpdater.takeSnapshot(StateMachineUpdater.java:258)
datanode_2_1  | 2020-04-17 18:54:38,710 [grpc-default-executor-0] INFO impl.RaftServerProxy: 0e99e1b0-220f-42bd-a39f-d4658f80d0e4: addNew group-95C80522151F:[b23d8fb0-3698-40b4-ac98-17b8605a770b:10.5.0.4:9858, a0acbcec-d753-414c-b077-647d02aaa7fb:10.5.0.7:9858, 0e99e1b0-220f-42bd-a39f-d4658f80d0e4:10.5.0.5:9858] returns group-95C80522151F:java.util.concurrent.CompletableFuture@32a71e68[Not completed]
scm_1         | 2020-04-17 18:50:38,988 [RatisPipelineUtilsThread] INFO pipeline.RatisPipelineProvider: Sending CreatePipelineCommand for pipeline:PipelineID=315eee3a-6983-45b7-a699-f5bd6c5f0281 to datanode:79669a1f-2445-496e-a337-3115205f3ae5
datanode_4_1  | 2020-04-17 18:52:29,945 [Command processor thread] INFO util.JmxRegister: Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-385EF22ED913,id=a0acbcec-d753-414c-b077-647d02aaa7fb
datanode_6_1  | 	at java.base/java.util.concurrent.CompletableFuture.thenApplyAsync(CompletableFuture.java:2104)
datanode_5_1  | 	at org.apache.ratis.server.impl.StateMachineUpdater.checkAndTakeSnapshot(StateMachineUpdater.java:250)
datanode_2_1  | 2020-04-17 18:54:38,712 [pool-69-thread-1] INFO impl.RaftServerImpl: 0e99e1b0-220f-42bd-a39f-d4658f80d0e4: new RaftServerImpl for group-95C80522151F:[b23d8fb0-3698-40b4-ac98-17b8605a770b:10.5.0.4:9858, a0acbcec-d753-414c-b077-647d02aaa7fb:10.5.0.7:9858, 0e99e1b0-220f-42bd-a39f-d4658f80d0e4:10.5.0.5:9858] with ContainerStateMachine:uninitialized
scm_1         | 2020-04-17 18:50:38,989 [RatisPipelineUtilsThread] INFO pipeline.RatisPipelineProvider: Sending CreatePipelineCommand for pipeline:PipelineID=315eee3a-6983-45b7-a699-f5bd6c5f0281 to datanode:b23d8fb0-3698-40b4-ac98-17b8605a770b
datanode_4_1  | 2020-04-17 18:52:29,945 [Command processor thread] INFO impl.RoleInfo: a0acbcec-d753-414c-b077-647d02aaa7fb: shutdown LeaderState
datanode_6_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupAddAsync(RaftServerProxy.java:379)
datanode_5_1  | 	at org.apache.ratis.server.impl.StateMachineUpdater.run(StateMachineUpdater.java:169)
datanode_2_1  | 2020-04-17 18:54:38,712 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.rpc.timeout.min = 5s (custom)
scm_1         | 2020-04-17 18:50:38,990 [RatisPipelineUtilsThread] INFO pipeline.RatisPipelineProvider: Sending CreatePipelineCommand for pipeline:PipelineID=315eee3a-6983-45b7-a699-f5bd6c5f0281 to datanode:32863f73-3555-4b23-932a-0d28eb668aea
datanode_4_1  | 2020-04-17 18:52:29,946 [org.apache.ratis.server.impl.LogAppender$AppenderDaemon$$Lambda$443/0x0000000840592040@52047583] WARN server.GrpcLogAppender: a0acbcec-d753-414c-b077-647d02aaa7fb@group-385EF22ED913->0e99e1b0-220f-42bd-a39f-d4658f80d0e4-GrpcLogAppender: Wait interrupted by java.lang.InterruptedException
datanode_6_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupManagementAsync(RaftServerProxy.java:363)
datanode_5_1  | 	at java.base/java.lang.Thread.run(Thread.java:834)
datanode_5_1  | 2020-04-17 18:54:08,673 [978c057e-5c38-4e20-8a8b-f271c823af7e@group-79E0035D853A-StateMachineUpdater] ERROR ratis.ContainerStateMachine: Failed to take snapshot  for group-79E0035D853A as the stateMachine is unhealthy. The last applied index is at (t:1, i:0)
datanode_5_1  | 2020-04-17 18:54:08,673 [978c057e-5c38-4e20-8a8b-f271c823af7e@group-79E0035D853A-StateMachineUpdater] ERROR impl.StateMachineUpdater: 978c057e-5c38-4e20-8a8b-f271c823af7e@group-79E0035D853A-StateMachineUpdater: Failed to take snapshot
datanode_5_1  | org.apache.ratis.protocol.StateMachineException: Failed to take snapshot  for group-79E0035D853A as the stateMachine is unhealthy. The last applied index is at (t:1, i:0)
datanode_5_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.ContainerStateMachine.takeSnapshot(ContainerStateMachine.java:288)
scm_1         | 2020-04-17 18:50:38,991 [RatisPipelineUtilsThread] INFO pipeline.PipelineStateManager: Created pipeline Pipeline[ Id: 315eee3a-6983-45b7-a699-f5bd6c5f0281, Nodes: 79669a1f-2445-496e-a337-3115205f3ae5{ip: 10.5.0.9, host: ozone-topology_datanode_6_1.ozone-topology_net, networkLocation: /rack2, certSerialId: null}b23d8fb0-3698-40b4-ac98-17b8605a770b{ip: 10.5.0.4, host: ozone-topology_datanode_1_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}32863f73-3555-4b23-932a-0d28eb668aea{ip: 10.5.0.6, host: ozone-topology_datanode_3_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}, Type:RATIS, Factor:THREE, State:ALLOCATED, leaderId:null, CreationTimestamp2020-04-17T18:50:38.988869Z]
datanode_4_1  | 2020-04-17 18:52:29,947 [Command processor thread] INFO impl.PendingRequests: a0acbcec-d753-414c-b077-647d02aaa7fb@group-385EF22ED913-PendingRequests: sendNotLeaderResponses
datanode_5_1  | 	at org.apache.ratis.server.impl.StateMachineUpdater.takeSnapshot(StateMachineUpdater.java:258)
scm_1         | 2020-04-17 18:50:38,994 [RatisPipelineUtilsThread] ERROR pipeline.SCMPipelineManager: Failed to create pipeline of type RATIS and factor THREE. Exception: Pipeline creation failed because nodes are engaged in other pipelines and every node can only be engaged in max 2 pipelines. Required 3. Found 2
datanode_6_1  | 	at org.apache.ratis.grpc.server.GrpcAdminProtocolService.lambda$groupManagement$0(GrpcAdminProtocolService.java:42)
datanode_2_1  | 2020-04-17 18:54:38,712 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.rpc.timeout.max = 5200ms (custom)
scm_1         | 2020-04-17 18:50:39,497 [IPC Server handler 4 on 9861] INFO net.NetworkTopology: Added a new node: /rack2/978c057e-5c38-4e20-8a8b-f271c823af7e
datanode_5_1  | 	at org.apache.ratis.server.impl.StateMachineUpdater.checkAndTakeSnapshot(StateMachineUpdater.java:250)
datanode_6_1  | 	at org.apache.ratis.grpc.GrpcUtil.asyncCall(GrpcUtil.java:160)
datanode_4_1  | 2020-04-17 18:52:29,946 [org.apache.ratis.server.impl.LogAppender$AppenderDaemon$$Lambda$443/0x0000000840592040@66849d62] WARN server.GrpcLogAppender: a0acbcec-d753-414c-b077-647d02aaa7fb@group-385EF22ED913->978c057e-5c38-4e20-8a8b-f271c823af7e-GrpcLogAppender: Wait interrupted by java.lang.InterruptedException
datanode_2_1  | 2020-04-17 18:54:38,712 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.rpcslowness.timeout = 300s (custom)
scm_1         | 2020-04-17 18:50:39,498 [IPC Server handler 4 on 9861] INFO node.SCMNodeManager: Registered Data node : 978c057e-5c38-4e20-8a8b-f271c823af7e{ip: 10.5.0.8, host: ozone-topology_datanode_5_1.ozone-topology_net, networkLocation: /rack2, certSerialId: null}
datanode_5_1  | 	at org.apache.ratis.server.impl.StateMachineUpdater.run(StateMachineUpdater.java:172)
datanode_6_1  | 	at org.apache.ratis.grpc.server.GrpcAdminProtocolService.groupManagement(GrpcAdminProtocolService.java:42)
datanode_4_1  | 2020-04-17 18:52:29,955 [grpc-default-executor-2] INFO server.GrpcLogAppender: a0acbcec-d753-414c-b077-647d02aaa7fb@group-385EF22ED913->0e99e1b0-220f-42bd-a39f-d4658f80d0e4-AppendLogResponseHandler: follower responses appendEntries COMPLETED
datanode_2_1  | 2020-04-17 18:54:38,712 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.sleep.deviation.threshold = 300 (default)
scm_1         | 2020-04-17 18:50:39,498 [EventQueue-NodeRegistrationContainerReportForContainerSafeModeRule] INFO safemode.SCMSafeModeManager: ContainerSafeModeRule rule is successfully validated
datanode_6_1  | 	at org.apache.ratis.proto.grpc.AdminProtocolServiceGrpc$MethodHandlers.invoke(AdminProtocolServiceGrpc.java:358)
datanode_4_1  | 2020-04-17 18:52:29,957 [grpc-default-executor-1] INFO server.GrpcLogAppender: a0acbcec-d753-414c-b077-647d02aaa7fb@group-385EF22ED913->978c057e-5c38-4e20-8a8b-f271c823af7e-AppendLogResponseHandler: follower responses appendEntries COMPLETED
datanode_2_1  | 2020-04-17 18:54:38,712 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.appender.install.snapshot.enabled = false (custom)
scm_1         | 2020-04-17 18:50:39,499 [EventQueue-NodeRegistrationContainerReportForDataNodeSafeModeRule] INFO safemode.SCMSafeModeManager: DataNodeSafeModeRule rule is successfully validated
datanode_5_1  | 	at java.base/java.lang.Thread.run(Thread.java:834)
datanode_6_1  | 	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$UnaryServerCallHandler$UnaryServerCallListener.onHalfClose(ServerCalls.java:172)
datanode_6_1  | 	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.halfClosed(ServerCallImpl.java:331)
datanode_4_1  | 2020-04-17 18:52:29,972 [grpc-default-executor-2] INFO impl.FollowerInfo: a0acbcec-d753-414c-b077-647d02aaa7fb@group-385EF22ED913->0e99e1b0-220f-42bd-a39f-d4658f80d0e4: nextIndex: updateUnconditionally 3 -> 1
scm_1         | 2020-04-17 18:50:39,501 [RatisPipelineUtilsThread] INFO pipeline.RatisPipelineProvider: Sending CreatePipelineCommand for pipeline:PipelineID=046e56bb-291e-44e3-859a-48e39f71149f to datanode:0e99e1b0-220f-42bd-a39f-d4658f80d0e4
datanode_5_1  | 2020-04-17 18:54:08,672 [grpc-default-executor-0] INFO impl.FollowerInfo: 978c057e-5c38-4e20-8a8b-f271c823af7e@group-79E0035D853A->0e99e1b0-220f-42bd-a39f-d4658f80d0e4: nextIndex: updateUnconditionally 3 -> 1
datanode_6_1  | 	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1HalfClosed.runInContext(ServerImpl.java:814)
datanode_2_1  | 2020-04-17 18:54:38,712 [pool-69-thread-1] INFO impl.RaftServerImpl: 0e99e1b0-220f-42bd-a39f-d4658f80d0e4@group-95C80522151F: ConfigurationManager, init=-1: [b23d8fb0-3698-40b4-ac98-17b8605a770b:10.5.0.4:9858, a0acbcec-d753-414c-b077-647d02aaa7fb:10.5.0.7:9858, 0e99e1b0-220f-42bd-a39f-d4658f80d0e4:10.5.0.5:9858], old=null, confs=<EMPTY_MAP>
datanode_4_1  | 2020-04-17 18:52:29,978 [Command processor thread] INFO metrics.RatisMetrics: Unregistering Metrics Registry : ratis.log_appender.a0acbcec-d753-414c-b077-647d02aaa7fb@group-385EF22ED913
scm_1         | 2020-04-17 18:50:39,502 [RatisPipelineUtilsThread] INFO pipeline.PipelineStateManager: Created pipeline Pipeline[ Id: 046e56bb-291e-44e3-859a-48e39f71149f, Nodes: 0e99e1b0-220f-42bd-a39f-d4658f80d0e4{ip: 10.5.0.5, host: ozone-topology_datanode_2_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}, Type:RATIS, Factor:ONE, State:ALLOCATED, leaderId:null, CreationTimestamp2020-04-17T18:50:39.501703Z]
datanode_5_1  | 2020-04-17 18:54:08,656 [grpc-default-executor-3] INFO server.GrpcLogAppender: 978c057e-5c38-4e20-8a8b-f271c823af7e@group-79E0035D853A->a0acbcec-d753-414c-b077-647d02aaa7fb-AppendLogResponseHandler: follower responses appendEntries COMPLETED
datanode_6_1  | 	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
datanode_2_1  | 2020-04-17 18:54:38,712 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.storage.dir = [/data/metadata/ratis] (custom)
datanode_4_1  | 2020-04-17 18:52:29,979 [Command processor thread] INFO impl.StateMachineUpdater: a0acbcec-d753-414c-b077-647d02aaa7fb@group-385EF22ED913-StateMachineUpdater: set stopIndex = 0
scm_1         | 2020-04-17 18:50:39,504 [RatisPipelineUtilsThread] INFO pipeline.RatisPipelineProvider: Sending CreatePipelineCommand for pipeline:PipelineID=aed8cd39-62be-40dc-818c-d621a9ffd9b9 to datanode:978c057e-5c38-4e20-8a8b-f271c823af7e
datanode_5_1  | 2020-04-17 18:54:08,683 [978c057e-5c38-4e20-8a8b-f271c823af7e@group-79E0035D853A-StateMachineUpdater] INFO metrics.RatisMetrics: Unregistering Metrics Registry : ratis.state_machine.978c057e-5c38-4e20-8a8b-f271c823af7e@group-79E0035D853A
datanode_6_1  | 	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:123)
datanode_2_1  | 2020-04-17 18:54:38,713 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.corruption.policy = EXCEPTION (default)
datanode_4_1  | 2020-04-17 18:52:29,980 [a0acbcec-d753-414c-b077-647d02aaa7fb@group-385EF22ED913-StateMachineUpdater] ERROR ratis.ContainerStateMachine: Failed to take snapshot  for group-385EF22ED913 as the stateMachine is unhealthy. The last applied index is at (t:1, i:0)
scm_1         | 2020-04-17 18:50:39,509 [RatisPipelineUtilsThread] INFO pipeline.PipelineStateManager: Created pipeline Pipeline[ Id: aed8cd39-62be-40dc-818c-d621a9ffd9b9, Nodes: 978c057e-5c38-4e20-8a8b-f271c823af7e{ip: 10.5.0.8, host: ozone-topology_datanode_5_1.ozone-topology_net, networkLocation: /rack2, certSerialId: null}, Type:RATIS, Factor:ONE, State:ALLOCATED, leaderId:null, CreationTimestamp2020-04-17T18:50:39.504645Z]
datanode_5_1  | 2020-04-17 18:54:08,684 [Command processor thread] INFO impl.RaftServerImpl: 978c057e-5c38-4e20-8a8b-f271c823af7e@group-79E0035D853A: closes. applyIndex: 0
datanode_6_1  | 	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
datanode_2_1  | 2020-04-17 18:54:38,713 [pool-69-thread-1] INFO storage.RaftStorageDirectory: The storage directory /data/metadata/ratis/b5a22a8d-2392-4c7a-923f-95c80522151f does not exist. Creating ...
datanode_4_1  | 2020-04-17 18:52:29,977 [grpc-default-executor-1] INFO impl.FollowerInfo: a0acbcec-d753-414c-b077-647d02aaa7fb@group-385EF22ED913->978c057e-5c38-4e20-8a8b-f271c823af7e: nextIndex: updateUnconditionally 3 -> 1
scm_1         | 2020-04-17 18:50:39,511 [RatisPipelineUtilsThread] ERROR pipeline.SCMPipelineManager: Failed to create pipeline of type RATIS and factor ONE. Exception: Cannot create pipeline of factor 1 using 0 nodes. Used 6 nodes. Healthy nodes 6
datanode_5_1  | 2020-04-17 18:54:08,686 [978c057e-5c38-4e20-8a8b-f271c823af7e@group-79E0035D853A-SegmentedRaftLogWorker] INFO segmented.SegmentedRaftLogWorker: 978c057e-5c38-4e20-8a8b-f271c823af7e@group-79E0035D853A-SegmentedRaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
datanode_6_1  | 	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
datanode_2_1  | 2020-04-17 18:54:38,714 [pool-69-thread-1] INFO storage.RaftStorageDirectory: Lock on /data/metadata/ratis/b5a22a8d-2392-4c7a-923f-95c80522151f/in_use.lock acquired by nodename 6@3511460463af
datanode_4_1  | 2020-04-17 18:52:29,982 [a0acbcec-d753-414c-b077-647d02aaa7fb@group-385EF22ED913-StateMachineUpdater] ERROR impl.StateMachineUpdater: a0acbcec-d753-414c-b077-647d02aaa7fb@group-385EF22ED913-StateMachineUpdater: Failed to take snapshot
scm_1         | 2020-04-17 18:50:39,512 [RatisPipelineUtilsThread] INFO pipeline.RatisPipelineProvider: Sending CreatePipelineCommand for pipeline:PipelineID=be26d0dd-802f-4608-9a1c-385ef22ed913 to datanode:0e99e1b0-220f-42bd-a39f-d4658f80d0e4
datanode_5_1  | 2020-04-17 18:54:08,686 [grpc-default-executor-3] INFO impl.FollowerInfo: 978c057e-5c38-4e20-8a8b-f271c823af7e@group-79E0035D853A->a0acbcec-d753-414c-b077-647d02aaa7fb: nextIndex: updateUnconditionally 3 -> 1
datanode_6_1  | 	at java.base/java.lang.Thread.run(Thread.java:834)
datanode_2_1  | 2020-04-17 18:54:38,716 [pool-69-thread-1] INFO storage.RaftStorage: Storage directory /data/metadata/ratis/b5a22a8d-2392-4c7a-923f-95c80522151f has been successfully formatted.
datanode_4_1  | org.apache.ratis.protocol.StateMachineException: Failed to take snapshot  for group-385EF22ED913 as the stateMachine is unhealthy. The last applied index is at (t:1, i:0)
scm_1         | 2020-04-17 18:50:39,515 [RatisPipelineUtilsThread] INFO pipeline.RatisPipelineProvider: Sending CreatePipelineCommand for pipeline:PipelineID=be26d0dd-802f-4608-9a1c-385ef22ed913 to datanode:a0acbcec-d753-414c-b077-647d02aaa7fb
datanode_5_1  | 2020-04-17 18:54:08,689 [Command processor thread] INFO segmented.SegmentedRaftLogWorker: 978c057e-5c38-4e20-8a8b-f271c823af7e@group-79E0035D853A-SegmentedRaftLogWorker close()
datanode_6_1  | Caused by: org.apache.ratis.protocol.AlreadyExistsException: 79669a1f-2445-496e-a337-3115205f3ae5: Failed to add group-F5BD6C5F0281:[b23d8fb0-3698-40b4-ac98-17b8605a770b:10.5.0.4:9858, 32863f73-3555-4b23-932a-0d28eb668aea:10.5.0.6:9858, 79669a1f-2445-496e-a337-3115205f3ae5:10.5.0.9:9858] since the group already exists in the map.
datanode_6_1  | 	at org.apache.ratis.server.impl.RaftServerProxy$ImplMap.addNew(RaftServerProxy.java:83)
datanode_2_1  | 2020-04-17 18:54:38,716 [pool-69-thread-1] INFO ratis.ContainerStateMachine: group-95C80522151F: The snapshot info is null. Setting the last applied indexto:(t:0, i:~)
scm_1         | 2020-04-17 18:50:39,515 [RatisPipelineUtilsThread] INFO pipeline.RatisPipelineProvider: Sending CreatePipelineCommand for pipeline:PipelineID=be26d0dd-802f-4608-9a1c-385ef22ed913 to datanode:978c057e-5c38-4e20-8a8b-f271c823af7e
datanode_5_1  | 2020-04-17 18:54:08,689 [Command processor thread] INFO metrics.RatisMetrics: Unregistering Metrics Registry : ratis.log_worker.978c057e-5c38-4e20-8a8b-f271c823af7e
datanode_4_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.ContainerStateMachine.takeSnapshot(ContainerStateMachine.java:288)
datanode_6_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupAddAsync(RaftServerProxy.java:378)
datanode_2_1  | 2020-04-17 18:54:38,716 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.notification.no-leader.timeout = 60s (default)
scm_1         | 2020-04-17 18:50:39,516 [RatisPipelineUtilsThread] INFO pipeline.PipelineStateManager: Created pipeline Pipeline[ Id: be26d0dd-802f-4608-9a1c-385ef22ed913, Nodes: 0e99e1b0-220f-42bd-a39f-d4658f80d0e4{ip: 10.5.0.5, host: ozone-topology_datanode_2_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}a0acbcec-d753-414c-b077-647d02aaa7fb{ip: 10.5.0.7, host: ozone-topology_datanode_4_1.ozone-topology_net, networkLocation: /rack2, certSerialId: null}978c057e-5c38-4e20-8a8b-f271c823af7e{ip: 10.5.0.8, host: ozone-topology_datanode_5_1.ozone-topology_net, networkLocation: /rack2, certSerialId: null}, Type:RATIS, Factor:THREE, State:ALLOCATED, leaderId:null, CreationTimestamp2020-04-17T18:50:39.512923Z]
datanode_5_1  | 2020-04-17 18:54:08,689 [Command processor thread] INFO metrics.RatisMetrics: Unregistering Metrics Registry : ratis.leader_election.978c057e-5c38-4e20-8a8b-f271c823af7e@group-79E0035D853A
datanode_4_1  | 	at org.apache.ratis.server.impl.StateMachineUpdater.takeSnapshot(StateMachineUpdater.java:258)
datanode_6_1  | 	... 13 more
datanode_2_1  | 2020-04-17 18:54:38,716 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.use.memory = false (default)
scm_1         | 2020-04-17 18:50:39,522 [RatisPipelineUtilsThread] ERROR pipeline.SCMPipelineManager: Failed to create pipeline of type RATIS and factor THREE. Exception: Pipeline creation failed because nodes are engaged in other pipelines and every node can only be engaged in max 2 pipelines. Required 3. Found 0
datanode_5_1  | 2020-04-17 18:54:08,689 [Command processor thread] INFO metrics.RatisMetrics: Unregistering Metrics Registry : ratis.server.978c057e-5c38-4e20-8a8b-f271c823af7e@group-79E0035D853A
datanode_4_1  | 	at org.apache.ratis.server.impl.StateMachineUpdater.checkAndTakeSnapshot(StateMachineUpdater.java:250)
datanode_6_1  | 2020-04-17 18:50:45,856 [grpc-default-executor-0] WARN impl.RaftServerProxy: 79669a1f-2445-496e-a337-3115205f3ae5: Failed groupAdd* GroupManagementRequest:client-BBF944320B61->79669a1f-2445-496e-a337-3115205f3ae5@group-F5BD6C5F0281, cid=0, seq=0, RW, null, Add:group-F5BD6C5F0281:[b23d8fb0-3698-40b4-ac98-17b8605a770b:10.5.0.4:9858, 32863f73-3555-4b23-932a-0d28eb668aea:10.5.0.6:9858, 79669a1f-2445-496e-a337-3115205f3ae5:10.5.0.9:9858]
datanode_2_1  | 2020-04-17 18:54:38,716 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.purge.gap = 1000000 (custom)
scm_1         | 2020-04-17 18:50:41,399 [EventQueue-PipelineReportForPipelineReportHandler] INFO pipeline.PipelineStateManager: Pipeline Pipeline[ Id: 475144cc-6599-45a9-b1c7-e8c5921c502f, Nodes: 79669a1f-2445-496e-a337-3115205f3ae5{ip: 10.5.0.9, host: ozone-topology_datanode_6_1.ozone-topology_net, networkLocation: /rack2, certSerialId: null}, Type:RATIS, Factor:ONE, State:ALLOCATED, leaderId:79669a1f-2445-496e-a337-3115205f3ae5, CreationTimestamp2020-04-17T18:50:37.848114Z] moved to OPEN state
datanode_5_1  | 2020-04-17 18:54:08,690 [Command processor thread] INFO commandhandler.ClosePipelineCommandHandler: Close Pipeline #id: "cad403d1-ea2f-4530-84e5-79e0035d853a"
datanode_4_1  | 	at org.apache.ratis.server.impl.StateMachineUpdater.run(StateMachineUpdater.java:169)
datanode_6_1  | java.util.concurrent.CompletionException: org.apache.ratis.protocol.AlreadyExistsException: 79669a1f-2445-496e-a337-3115205f3ae5: Failed to add group-F5BD6C5F0281:[b23d8fb0-3698-40b4-ac98-17b8605a770b:10.5.0.4:9858, 32863f73-3555-4b23-932a-0d28eb668aea:10.5.0.6:9858, 79669a1f-2445-496e-a337-3115205f3ae5:10.5.0.9:9858] since the group already exists in the map.
datanode_2_1  | 2020-04-17 18:54:38,716 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
scm_1         | 2020-04-17 18:50:41,439 [EventQueue-OpenPipelineForOneReplicaPipelineSafeModeRule] INFO safemode.SCMSafeModeManager: AtleastOneDatanodeReportedRule rule is successfully validated
datanode_5_1  |  command on datanode #978c057e-5c38-4e20-8a8b-f271c823af7e.
datanode_4_1  | 	at java.base/java.lang.Thread.run(Thread.java:834)
datanode_6_1  | 	at java.base/java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:331)
datanode_2_1  | 2020-04-17 18:54:38,716 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.segment.size.max = 1048576 (custom)
scm_1         | 2020-04-17 18:50:41,446 [EventQueue-OpenPipelineForHealthyPipelineSafeModeRule] INFO safemode.SCMSafeModeManager: SCM in safe mode. Healthy pipelines reported count is 0, required healthy pipeline reported count is 1
datanode_5_1  | 2020-04-17 18:54:08,690 [Command processor thread] INFO impl.RaftServerProxy: 978c057e-5c38-4e20-8a8b-f271c823af7e: remove group-79E0035D853A:null
datanode_4_1  | 2020-04-17 18:52:29,991 [a0acbcec-d753-414c-b077-647d02aaa7fb@group-385EF22ED913-StateMachineUpdater] ERROR ratis.ContainerStateMachine: Failed to take snapshot  for group-385EF22ED913 as the stateMachine is unhealthy. The last applied index is at (t:1, i:0)
datanode_6_1  | 	at java.base/java.util.concurrent.CompletableFuture.uniApplyNow(CompletableFuture.java:670)
datanode_2_1  | 2020-04-17 18:54:38,716 [pool-69-thread-1] INFO metrics.RatisMetrics: Creating Metrics Registry : ratis.log_worker.0e99e1b0-220f-42bd-a39f-d4658f80d0e4
scm_1         | 2020-04-17 18:50:41,830 [EventQueue-PipelineReportForPipelineReportHandler] INFO pipeline.PipelineStateManager: Pipeline Pipeline[ Id: 78615a2e-50d8-4031-9b8b-cc09c422f088, Nodes: 32863f73-3555-4b23-932a-0d28eb668aea{ip: 10.5.0.6, host: ozone-topology_datanode_3_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}, Type:RATIS, Factor:ONE, State:ALLOCATED, leaderId:32863f73-3555-4b23-932a-0d28eb668aea, CreationTimestamp2020-04-17T18:50:38.035960Z] moved to OPEN state
datanode_5_1  | 2020-04-17 18:54:08,691 [Command processor thread] ERROR commandhandler.ClosePipelineCommandHandler: Can't close pipeline #id: "cad403d1-ea2f-4530-84e5-79e0035d853a"
datanode_4_1  | 2020-04-17 18:52:29,991 [a0acbcec-d753-414c-b077-647d02aaa7fb@group-385EF22ED913-StateMachineUpdater] ERROR impl.StateMachineUpdater: a0acbcec-d753-414c-b077-647d02aaa7fb@group-385EF22ED913-StateMachineUpdater: Failed to take snapshot
datanode_6_1  | 	at java.base/java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:658)
datanode_2_1  | 2020-04-17 18:54:38,717 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.segment.cache.num.max = 2 (custom)
scm_1         | 2020-04-17 18:50:41,830 [EventQueue-OpenPipelineForOneReplicaPipelineSafeModeRule] INFO safemode.SCMSafeModeManager: AtleastOneDatanodeReportedRule rule is successfully validated
datanode_5_1  | 
datanode_4_1  | org.apache.ratis.protocol.StateMachineException: Failed to take snapshot  for group-385EF22ED913 as the stateMachine is unhealthy. The last applied index is at (t:1, i:0)
datanode_6_1  | 	at java.base/java.util.concurrent.CompletableFuture.thenApplyAsync(CompletableFuture.java:2104)
datanode_2_1  | 2020-04-17 18:54:38,717 [pool-69-thread-1] INFO segmented.SegmentedRaftLogWorker: new 0e99e1b0-220f-42bd-a39f-d4658f80d0e4@group-95C80522151F-SegmentedRaftLogWorker for RaftStorage:Storage Directory /data/metadata/ratis/b5a22a8d-2392-4c7a-923f-95c80522151f
scm_1         | 2020-04-17 18:50:41,830 [EventQueue-OpenPipelineForHealthyPipelineSafeModeRule] INFO safemode.SCMSafeModeManager: SCM in safe mode. Healthy pipelines reported count is 0, required healthy pipeline reported count is 1
datanode_5_1  | java.io.IOException: 978c057e-5c38-4e20-8a8b-f271c823af7e: Group group-79E0035D853A not found.
datanode_4_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.ContainerStateMachine.takeSnapshot(ContainerStateMachine.java:288)
datanode_6_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupAddAsync(RaftServerProxy.java:379)
datanode_2_1  | 2020-04-17 18:54:38,717 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.queue.byte-limit = 2147483647 (custom)
scm_1         | 2020-04-17 18:50:42,205 [EventQueue-PipelineReportForPipelineReportHandler] INFO pipeline.PipelineStateManager: Pipeline Pipeline[ Id: f9d10128-1d59-4577-ad6c-51477cb1f421, Nodes: a0acbcec-d753-414c-b077-647d02aaa7fb{ip: 10.5.0.7, host: ozone-topology_datanode_4_1.ozone-topology_net, networkLocation: /rack2, certSerialId: null}, Type:RATIS, Factor:ONE, State:ALLOCATED, leaderId:a0acbcec-d753-414c-b077-647d02aaa7fb, CreationTimestamp2020-04-17T18:50:38.330093Z] moved to OPEN state
datanode_5_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.XceiverServerRatis.removeGroup(XceiverServerRatis.java:659)
datanode_4_1  | 	at org.apache.ratis.server.impl.StateMachineUpdater.takeSnapshot(StateMachineUpdater.java:258)
datanode_6_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupManagementAsync(RaftServerProxy.java:363)
datanode_2_1  | 2020-04-17 18:54:38,717 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.queue.element-limit = 1024 (custom)
scm_1         | 2020-04-17 18:50:42,206 [EventQueue-OpenPipelineForOneReplicaPipelineSafeModeRule] INFO safemode.SCMSafeModeManager: AtleastOneDatanodeReportedRule rule is successfully validated
datanode_5_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.ClosePipelineCommandHandler.handle(ClosePipelineCommandHandler.java:77)
datanode_4_1  | 	at org.apache.ratis.server.impl.StateMachineUpdater.checkAndTakeSnapshot(StateMachineUpdater.java:250)
datanode_6_1  | 	at org.apache.ratis.grpc.server.GrpcAdminProtocolService.lambda$groupManagement$0(GrpcAdminProtocolService.java:42)
datanode_2_1  | 2020-04-17 18:54:38,717 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.segment.size.max = 1048576 (custom)
scm_1         | 2020-04-17 18:50:42,206 [EventQueue-OpenPipelineForHealthyPipelineSafeModeRule] INFO safemode.SCMSafeModeManager: SCM in safe mode. Healthy pipelines reported count is 0, required healthy pipeline reported count is 1
datanode_5_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.CommandDispatcher.handle(CommandDispatcher.java:99)
datanode_4_1  | 	at org.apache.ratis.server.impl.StateMachineUpdater.run(StateMachineUpdater.java:172)
datanode_6_1  | 	at org.apache.ratis.grpc.GrpcUtil.asyncCall(GrpcUtil.java:160)
datanode_2_1  | 2020-04-17 18:54:38,717 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.preallocated.size = 16384 (custom)
scm_1         | 2020-04-17 18:50:43,119 [EventQueue-PipelineReportForPipelineReportHandler] INFO pipeline.PipelineStateManager: Pipeline Pipeline[ Id: 046e56bb-291e-44e3-859a-48e39f71149f, Nodes: 0e99e1b0-220f-42bd-a39f-d4658f80d0e4{ip: 10.5.0.5, host: ozone-topology_datanode_2_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}, Type:RATIS, Factor:ONE, State:ALLOCATED, leaderId:0e99e1b0-220f-42bd-a39f-d4658f80d0e4, CreationTimestamp2020-04-17T18:50:39.501703Z] moved to OPEN state
datanode_5_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.lambda$initCommandHandlerThread$1(DatanodeStateMachine.java:472)
datanode_4_1  | 	at java.base/java.lang.Thread.run(Thread.java:834)
datanode_6_1  | 	at org.apache.ratis.grpc.server.GrpcAdminProtocolService.groupManagement(GrpcAdminProtocolService.java:42)
datanode_2_1  | 2020-04-17 18:54:38,717 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.write.buffer.size = 1048576 (custom)
scm_1         | 2020-04-17 18:50:43,127 [EventQueue-OpenPipelineForOneReplicaPipelineSafeModeRule] INFO safemode.SCMSafeModeManager: AtleastOneDatanodeReportedRule rule is successfully validated
datanode_5_1  | 	at java.base/java.lang.Thread.run(Thread.java:834)
datanode_4_1  | 2020-04-17 18:52:29,992 [a0acbcec-d753-414c-b077-647d02aaa7fb@group-385EF22ED913-StateMachineUpdater] INFO metrics.RatisMetrics: Unregistering Metrics Registry : ratis.state_machine.a0acbcec-d753-414c-b077-647d02aaa7fb@group-385EF22ED913
datanode_2_1  | 2020-04-17 18:54:38,717 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.force.sync.num = 128 (default)
scm_1         | 2020-04-17 18:50:43,128 [EventQueue-OpenPipelineForHealthyPipelineSafeModeRule] INFO safemode.SCMSafeModeManager: SCM in safe mode. Healthy pipelines reported count is 0, required healthy pipeline reported count is 1
datanode_5_1  | Caused by: org.apache.ratis.protocol.GroupMismatchException: 978c057e-5c38-4e20-8a8b-f271c823af7e: Group group-79E0035D853A not found.
datanode_6_1  | 	at org.apache.ratis.proto.grpc.AdminProtocolServiceGrpc$MethodHandlers.invoke(AdminProtocolServiceGrpc.java:358)
datanode_4_1  | 2020-04-17 18:52:29,993 [Command processor thread] INFO impl.RaftServerImpl: a0acbcec-d753-414c-b077-647d02aaa7fb@group-385EF22ED913: closes. applyIndex: 0
scm_1         | 2020-04-17 18:50:43,617 [EventQueue-PipelineReportForPipelineReportHandler] INFO pipeline.PipelineStateManager: Pipeline Pipeline[ Id: 584150c2-fc44-4ccf-a30e-39398b1c5c01, Nodes: b23d8fb0-3698-40b4-ac98-17b8605a770b{ip: 10.5.0.4, host: ozone-topology_datanode_1_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}, Type:RATIS, Factor:ONE, State:ALLOCATED, leaderId:b23d8fb0-3698-40b4-ac98-17b8605a770b, CreationTimestamp2020-04-17T18:50:38.964295Z] moved to OPEN state
datanode_2_1  | 2020-04-17 18:54:38,717 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.statemachine.data.sync = true (default)
datanode_5_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupRemoveAsync(RaftServerProxy.java:404)
datanode_6_1  | 	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$UnaryServerCallHandler$UnaryServerCallListener.onHalfClose(ServerCalls.java:172)
datanode_4_1  | 2020-04-17 18:52:29,998 [a0acbcec-d753-414c-b077-647d02aaa7fb@group-385EF22ED913-SegmentedRaftLogWorker] INFO segmented.SegmentedRaftLogWorker: a0acbcec-d753-414c-b077-647d02aaa7fb@group-385EF22ED913-SegmentedRaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
scm_1         | 2020-04-17 18:50:43,619 [EventQueue-OpenPipelineForOneReplicaPipelineSafeModeRule] INFO safemode.SCMSafeModeManager: AtleastOneDatanodeReportedRule rule is successfully validated
datanode_2_1  | 2020-04-17 18:54:38,717 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.statemachine.data.sync.timeout = 10s (default)
datanode_5_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupManagementAsync(RaftServerProxy.java:367)
datanode_6_1  | 	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.halfClosed(ServerCallImpl.java:331)
datanode_4_1  | 2020-04-17 18:52:30,000 [grpc-default-executor-1] INFO impl.RaftServerProxy: a0acbcec-d753-414c-b077-647d02aaa7fb: addNew group-79E0035D853A:[978c057e-5c38-4e20-8a8b-f271c823af7e:10.5.0.8:9858, a0acbcec-d753-414c-b077-647d02aaa7fb:10.5.0.7:9858, 0e99e1b0-220f-42bd-a39f-d4658f80d0e4:10.5.0.5:9858] returns group-79E0035D853A:java.util.concurrent.CompletableFuture@39817f8b[Not completed]
scm_1         | 2020-04-17 18:50:43,619 [EventQueue-OpenPipelineForHealthyPipelineSafeModeRule] INFO safemode.SCMSafeModeManager: SCM in safe mode. Healthy pipelines reported count is 0, required healthy pipeline reported count is 1
datanode_2_1  | 2020-04-17 18:54:38,717 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
datanode_5_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupManagement(RaftServerProxy.java:350)
datanode_6_1  | 	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1HalfClosed.runInContext(ServerImpl.java:814)
datanode_4_1  | 2020-04-17 18:52:30,000 [Command processor thread] INFO segmented.SegmentedRaftLogWorker: a0acbcec-d753-414c-b077-647d02aaa7fb@group-385EF22ED913-SegmentedRaftLogWorker close()
datanode_2_1  | 2020-04-17 18:54:38,719 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.statemachine.data.caching.enabled = true (custom)
scm_1         | 2020-04-17 18:50:43,939 [EventQueue-PipelineReportForPipelineReportHandler] INFO pipeline.PipelineStateManager: Pipeline Pipeline[ Id: aed8cd39-62be-40dc-818c-d621a9ffd9b9, Nodes: 978c057e-5c38-4e20-8a8b-f271c823af7e{ip: 10.5.0.8, host: ozone-topology_datanode_5_1.ozone-topology_net, networkLocation: /rack2, certSerialId: null}, Type:RATIS, Factor:ONE, State:ALLOCATED, leaderId:978c057e-5c38-4e20-8a8b-f271c823af7e, CreationTimestamp2020-04-17T18:50:39.504645Z] moved to OPEN state
datanode_5_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.XceiverServerRatis.removeGroup(XceiverServerRatis.java:657)
datanode_6_1  | 	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
datanode_4_1  | 2020-04-17 18:52:30,002 [pool-69-thread-1] INFO impl.RaftServerImpl: a0acbcec-d753-414c-b077-647d02aaa7fb: new RaftServerImpl for group-79E0035D853A:[978c057e-5c38-4e20-8a8b-f271c823af7e:10.5.0.8:9858, a0acbcec-d753-414c-b077-647d02aaa7fb:10.5.0.7:9858, 0e99e1b0-220f-42bd-a39f-d4658f80d0e4:10.5.0.5:9858] with ContainerStateMachine:uninitialized
datanode_2_1  | 2020-04-17 18:54:38,719 [pool-69-thread-1] INFO segmented.SegmentedRaftLogWorker: 0e99e1b0-220f-42bd-a39f-d4658f80d0e4@group-95C80522151F-SegmentedRaftLogWorker: flushIndex: setUnconditionally 0 -> -1
scm_1         | 2020-04-17 18:50:43,945 [EventQueue-OpenPipelineForHealthyPipelineSafeModeRule] INFO safemode.SCMSafeModeManager: SCM in safe mode. Healthy pipelines reported count is 0, required healthy pipeline reported count is 1
datanode_5_1  | 	... 4 more
datanode_6_1  | 	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:123)
datanode_4_1  | 2020-04-17 18:52:30,002 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.rpc.timeout.min = 5s (custom)
scm_1         | 2020-04-17 18:50:43,945 [EventQueue-OpenPipelineForOneReplicaPipelineSafeModeRule] INFO safemode.SCMSafeModeManager: AtleastOneDatanodeReportedRule rule is successfully validated
datanode_6_1  | 	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
datanode_5_1  | 2020-04-17 18:54:08,708 [Command processor thread] INFO impl.RaftServerProxy: 978c057e-5c38-4e20-8a8b-f271c823af7e: remove group-79E0035D853A:null
datanode_2_1  | 2020-04-17 18:54:38,726 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.snapshot.auto.trigger.enabled = true (custom)
datanode_4_1  | 2020-04-17 18:52:30,002 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.rpc.timeout.max = 5200ms (custom)
scm_1         | 2020-04-17 18:50:47,143 [EventQueue-PipelineReportForPipelineReportHandler] INFO pipeline.PipelineStateManager: Pipeline Pipeline[ Id: 315eee3a-6983-45b7-a699-f5bd6c5f0281, Nodes: 79669a1f-2445-496e-a337-3115205f3ae5{ip: 10.5.0.9, host: ozone-topology_datanode_6_1.ozone-topology_net, networkLocation: /rack2, certSerialId: null}b23d8fb0-3698-40b4-ac98-17b8605a770b{ip: 10.5.0.4, host: ozone-topology_datanode_1_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}32863f73-3555-4b23-932a-0d28eb668aea{ip: 10.5.0.6, host: ozone-topology_datanode_3_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}, Type:RATIS, Factor:THREE, State:ALLOCATED, leaderId:79669a1f-2445-496e-a337-3115205f3ae5, CreationTimestamp2020-04-17T18:50:38.988869Z] moved to OPEN state
datanode_6_1  | 	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
datanode_5_1  | 2020-04-17 18:54:08,708 [Command processor thread] ERROR commandhandler.ClosePipelineCommandHandler: Can't close pipeline #id: "cad403d1-ea2f-4530-84e5-79e0035d853a"
datanode_2_1  | 2020-04-17 18:54:38,726 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
datanode_4_1  | 2020-04-17 18:52:30,003 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.rpcslowness.timeout = 300s (custom)
scm_1         | 2020-04-17 18:50:47,144 [EventQueue-OpenPipelineForOneReplicaPipelineSafeModeRule] INFO safemode.SCMSafeModeManager: AtleastOneDatanodeReportedRule rule is successfully validated
datanode_6_1  | 	at java.base/java.lang.Thread.run(Thread.java:834)
datanode_5_1  | 
datanode_2_1  | 2020-04-17 18:54:38,726 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.snapshot.retention.file.num = 5 (custom)
datanode_4_1  | 2020-04-17 18:52:30,003 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.sleep.deviation.threshold = 300 (default)
scm_1         | 2020-04-17 18:50:47,145 [EventQueue-OpenPipelineForHealthyPipelineSafeModeRule] INFO safemode.SCMSafeModeManager: SCM in safe mode. Healthy pipelines reported count is 1, required healthy pipeline reported count is 1
datanode_6_1  | Caused by: org.apache.ratis.protocol.AlreadyExistsException: 79669a1f-2445-496e-a337-3115205f3ae5: Failed to add group-F5BD6C5F0281:[b23d8fb0-3698-40b4-ac98-17b8605a770b:10.5.0.4:9858, 32863f73-3555-4b23-932a-0d28eb668aea:10.5.0.6:9858, 79669a1f-2445-496e-a337-3115205f3ae5:10.5.0.9:9858] since the group already exists in the map.
datanode_5_1  | java.io.IOException: 978c057e-5c38-4e20-8a8b-f271c823af7e: Group group-79E0035D853A not found.
datanode_2_1  | 2020-04-17 18:54:38,727 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.retrycache.expirytime = 600000ms (custom)
datanode_4_1  | 2020-04-17 18:52:30,003 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.appender.install.snapshot.enabled = false (custom)
scm_1         | 2020-04-17 18:50:47,147 [EventQueue-OpenPipelineForHealthyPipelineSafeModeRule] INFO safemode.SCMSafeModeManager: HealthyPipelineSafeModeRule rule is successfully validated
datanode_6_1  | 	at org.apache.ratis.server.impl.RaftServerProxy$ImplMap.addNew(RaftServerProxy.java:83)
datanode_5_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.XceiverServerRatis.removeGroup(XceiverServerRatis.java:659)
datanode_2_1  | 2020-04-17 18:54:38,727 [pool-69-thread-1] INFO metrics.RatisMetrics: Creating Metrics Registry : ratis.leader_election.0e99e1b0-220f-42bd-a39f-d4658f80d0e4@group-95C80522151F
datanode_4_1  | 2020-04-17 18:52:30,003 [pool-69-thread-1] INFO impl.RaftServerImpl: a0acbcec-d753-414c-b077-647d02aaa7fb@group-79E0035D853A: ConfigurationManager, init=-1: [978c057e-5c38-4e20-8a8b-f271c823af7e:10.5.0.8:9858, a0acbcec-d753-414c-b077-647d02aaa7fb:10.5.0.7:9858, 0e99e1b0-220f-42bd-a39f-d4658f80d0e4:10.5.0.5:9858], old=null, confs=<EMPTY_MAP>
scm_1         | 2020-04-17 18:50:47,151 [EventQueue-OpenPipelineForHealthyPipelineSafeModeRule] INFO safemode.SCMSafeModeManager: ScmSafeModeManager, all rules are successfully validated
datanode_6_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupAddAsync(RaftServerProxy.java:378)
datanode_5_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.ClosePipelineCommandHandler.handle(ClosePipelineCommandHandler.java:77)
datanode_2_1  | 2020-04-17 18:54:38,731 [pool-69-thread-1] INFO metrics.RatisMetrics: Creating Metrics Registry : ratis.server.0e99e1b0-220f-42bd-a39f-d4658f80d0e4@group-95C80522151F
datanode_4_1  | 2020-04-17 18:52:30,003 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.storage.dir = [/data/metadata/ratis] (custom)
scm_1         | 2020-04-17 18:50:47,154 [EventQueue-OpenPipelineForHealthyPipelineSafeModeRule] INFO safemode.SCMSafeModeManager: SCM exiting safe mode.
datanode_6_1  | 	... 13 more
datanode_5_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.CommandDispatcher.handle(CommandDispatcher.java:99)
datanode_2_1  | 2020-04-17 18:54:38,731 [pool-69-thread-1] INFO impl.RaftServerImpl: 0e99e1b0-220f-42bd-a39f-d4658f80d0e4@group-95C80522151F: start as a follower, conf=-1: [b23d8fb0-3698-40b4-ac98-17b8605a770b:10.5.0.4:9858, a0acbcec-d753-414c-b077-647d02aaa7fb:10.5.0.7:9858, 0e99e1b0-220f-42bd-a39f-d4658f80d0e4:10.5.0.5:9858], old=null
datanode_4_1  | 2020-04-17 18:52:30,004 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.corruption.policy = EXCEPTION (default)
scm_1         | 2020-04-17 18:50:47,988 [EventQueue-PipelineReportForPipelineReportHandler] INFO pipeline.PipelineStateManager: Pipeline Pipeline[ Id: be26d0dd-802f-4608-9a1c-385ef22ed913, Nodes: 0e99e1b0-220f-42bd-a39f-d4658f80d0e4{ip: 10.5.0.5, host: ozone-topology_datanode_2_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}a0acbcec-d753-414c-b077-647d02aaa7fb{ip: 10.5.0.7, host: ozone-topology_datanode_4_1.ozone-topology_net, networkLocation: /rack2, certSerialId: null}978c057e-5c38-4e20-8a8b-f271c823af7e{ip: 10.5.0.8, host: ozone-topology_datanode_5_1.ozone-topology_net, networkLocation: /rack2, certSerialId: null}, Type:RATIS, Factor:THREE, State:ALLOCATED, leaderId:a0acbcec-d753-414c-b077-647d02aaa7fb, CreationTimestamp2020-04-17T18:50:39.512923Z] moved to OPEN state
datanode_6_1  | 2020-04-17 18:50:46,538 [Thread-23] INFO impl.FollowerState: 79669a1f-2445-496e-a337-3115205f3ae5@group-E8C5921C502F-FollowerState: change to CANDIDATE, lastRpcTime:5053ms, electionTimeout:5011ms
datanode_5_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.lambda$initCommandHandlerThread$1(DatanodeStateMachine.java:472)
datanode_2_1  | 2020-04-17 18:54:38,731 [pool-69-thread-1] INFO impl.RaftServerImpl: 0e99e1b0-220f-42bd-a39f-d4658f80d0e4@group-95C80522151F: changes role from      null to FOLLOWER at term 0 for startAsFollower
datanode_4_1  | 2020-04-17 18:52:30,007 [pool-69-thread-1] INFO storage.RaftStorageDirectory: The storage directory /data/metadata/ratis/cad403d1-ea2f-4530-84e5-79e0035d853a does not exist. Creating ...
scm_1         | 2020-04-17 18:50:58,776 [EventQueue-PipelineActionsForPipelineActionHandler] INFO pipeline.PipelineActionHandler: Received pipeline action CLOSE for PipelineID=be26d0dd-802f-4608-9a1c-385ef22ed913 from datanode a0acbcec-d753-414c-b077-647d02aaa7fb. Reason : ContainerID 2 creation failed
datanode_6_1  | 2020-04-17 18:50:46,544 [Thread-23] INFO impl.RoleInfo: 79669a1f-2445-496e-a337-3115205f3ae5: shutdown FollowerState
datanode_5_1  | 	at java.base/java.lang.Thread.run(Thread.java:834)
datanode_2_1  | 2020-04-17 18:54:38,731 [pool-69-thread-1] INFO impl.RoleInfo: 0e99e1b0-220f-42bd-a39f-d4658f80d0e4: start FollowerState
datanode_4_1  | 2020-04-17 18:52:30,004 [Command processor thread] INFO metrics.RatisMetrics: Unregistering Metrics Registry : ratis.log_worker.a0acbcec-d753-414c-b077-647d02aaa7fb
scm_1         | 2020-04-17 18:50:58,776 [EventQueue-PipelineActionsForPipelineActionHandler] INFO pipeline.SCMPipelineManager: Destroying pipeline:Pipeline[ Id: be26d0dd-802f-4608-9a1c-385ef22ed913, Nodes: 0e99e1b0-220f-42bd-a39f-d4658f80d0e4{ip: 10.5.0.5, host: ozone-topology_datanode_2_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}a0acbcec-d753-414c-b077-647d02aaa7fb{ip: 10.5.0.7, host: ozone-topology_datanode_4_1.ozone-topology_net, networkLocation: /rack2, certSerialId: null}978c057e-5c38-4e20-8a8b-f271c823af7e{ip: 10.5.0.8, host: ozone-topology_datanode_5_1.ozone-topology_net, networkLocation: /rack2, certSerialId: null}, Type:RATIS, Factor:THREE, State:OPEN, leaderId:a0acbcec-d753-414c-b077-647d02aaa7fb, CreationTimestamp2020-04-17T18:50:39.512923Z]
datanode_6_1  | 2020-04-17 18:50:46,544 [Thread-23] INFO impl.RaftServerImpl: 79669a1f-2445-496e-a337-3115205f3ae5@group-E8C5921C502F: changes role from  FOLLOWER to CANDIDATE at term 0 for changeToCandidate
datanode_5_1  | Caused by: org.apache.ratis.protocol.GroupMismatchException: 978c057e-5c38-4e20-8a8b-f271c823af7e: Group group-79E0035D853A not found.
datanode_2_1  | 2020-04-17 18:54:38,733 [pool-69-thread-1] INFO util.JmxRegister: Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-95C80522151F,id=0e99e1b0-220f-42bd-a39f-d4658f80d0e4
datanode_4_1  | 2020-04-17 18:52:30,007 [Command processor thread] INFO metrics.RatisMetrics: Unregistering Metrics Registry : ratis.leader_election.a0acbcec-d753-414c-b077-647d02aaa7fb@group-385EF22ED913
scm_1         | 2020-04-17 18:50:58,776 [EventQueue-PipelineActionsForPipelineActionHandler] INFO pipeline.PipelineStateManager: Pipeline Pipeline[ Id: be26d0dd-802f-4608-9a1c-385ef22ed913, Nodes: 0e99e1b0-220f-42bd-a39f-d4658f80d0e4{ip: 10.5.0.5, host: ozone-topology_datanode_2_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}a0acbcec-d753-414c-b077-647d02aaa7fb{ip: 10.5.0.7, host: ozone-topology_datanode_4_1.ozone-topology_net, networkLocation: /rack2, certSerialId: null}978c057e-5c38-4e20-8a8b-f271c823af7e{ip: 10.5.0.8, host: ozone-topology_datanode_5_1.ozone-topology_net, networkLocation: /rack2, certSerialId: null}, Type:RATIS, Factor:THREE, State:CLOSED, leaderId:a0acbcec-d753-414c-b077-647d02aaa7fb, CreationTimestamp2020-04-17T18:50:39.512923Z] moved to CLOSED state
datanode_6_1  | 2020-04-17 18:50:46,547 [Thread-23] INFO impl.RoleInfo: 79669a1f-2445-496e-a337-3115205f3ae5: start LeaderElection
datanode_5_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupRemoveAsync(RaftServerProxy.java:404)
datanode_5_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupManagementAsync(RaftServerProxy.java:367)
datanode_4_1  | 2020-04-17 18:52:30,008 [Command processor thread] INFO metrics.RatisMetrics: Unregistering Metrics Registry : ratis.server.a0acbcec-d753-414c-b077-647d02aaa7fb@group-385EF22ED913
scm_1         | 2020-04-17 18:50:58,778 [EventQueue-CloseContainerForCloseContainerEventHandler] INFO container.CloseContainerEventHandler: Close container Event triggered for container : #2
datanode_6_1  | 2020-04-17 18:50:46,560 [79669a1f-2445-496e-a337-3115205f3ae5@group-E8C5921C502F-LeaderElection1] INFO impl.LeaderElection: 79669a1f-2445-496e-a337-3115205f3ae5@group-E8C5921C502F-LeaderElection1: begin an election at term 1 for -1: [79669a1f-2445-496e-a337-3115205f3ae5:10.5.0.9:9858], old=null
datanode_5_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupManagement(RaftServerProxy.java:350)
datanode_2_1  | 2020-04-17 18:54:38,733 [pool-69-thread-1] INFO metrics.RatisMetrics: Creating Metrics Registry : ratis.state_machine.0e99e1b0-220f-42bd-a39f-d4658f80d0e4@group-95C80522151F
datanode_4_1  | 2020-04-17 18:52:30,008 [pool-69-thread-1] INFO storage.RaftStorageDirectory: Lock on /data/metadata/ratis/cad403d1-ea2f-4530-84e5-79e0035d853a/in_use.lock acquired by nodename 6@cea2015b57a1
scm_1         | 2020-04-17 18:50:58,821 [EventQueue-PipelineActionsForPipelineActionHandler] INFO pipeline.PipelineActionHandler: Received pipeline action CLOSE for PipelineID=be26d0dd-802f-4608-9a1c-385ef22ed913 from datanode 978c057e-5c38-4e20-8a8b-f271c823af7e. Reason : ContainerID 2 creation failed
datanode_6_1  | 2020-04-17 18:50:46,561 [79669a1f-2445-496e-a337-3115205f3ae5@group-E8C5921C502F-LeaderElection1] INFO impl.RoleInfo: 79669a1f-2445-496e-a337-3115205f3ae5: shutdown LeaderElection
datanode_5_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.XceiverServerRatis.removeGroup(XceiverServerRatis.java:657)
datanode_2_1  | 2020-04-17 18:54:43,775 [grpc-default-executor-0] INFO impl.RaftServerImpl: 0e99e1b0-220f-42bd-a39f-d4658f80d0e4@group-95C80522151F: changes role from  FOLLOWER to FOLLOWER at term 1 for recognizeCandidate:a0acbcec-d753-414c-b077-647d02aaa7fb
datanode_2_1  | 2020-04-17 18:54:43,775 [grpc-default-executor-0] INFO impl.RoleInfo: 0e99e1b0-220f-42bd-a39f-d4658f80d0e4: shutdown FollowerState
scm_1         | 2020-04-17 18:50:58,822 [EventQueue-PipelineActionsForPipelineActionHandler] INFO pipeline.SCMPipelineManager: Destroying pipeline:Pipeline[ Id: be26d0dd-802f-4608-9a1c-385ef22ed913, Nodes: 0e99e1b0-220f-42bd-a39f-d4658f80d0e4{ip: 10.5.0.5, host: ozone-topology_datanode_2_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}a0acbcec-d753-414c-b077-647d02aaa7fb{ip: 10.5.0.7, host: ozone-topology_datanode_4_1.ozone-topology_net, networkLocation: /rack2, certSerialId: null}978c057e-5c38-4e20-8a8b-f271c823af7e{ip: 10.5.0.8, host: ozone-topology_datanode_5_1.ozone-topology_net, networkLocation: /rack2, certSerialId: null}, Type:RATIS, Factor:THREE, State:CLOSED, leaderId:a0acbcec-d753-414c-b077-647d02aaa7fb, CreationTimestamp2020-04-17T18:50:39.512923Z]
datanode_6_1  | 2020-04-17 18:50:46,561 [79669a1f-2445-496e-a337-3115205f3ae5@group-E8C5921C502F-LeaderElection1] INFO impl.RaftServerImpl: 79669a1f-2445-496e-a337-3115205f3ae5@group-E8C5921C502F: changes role from CANDIDATE to LEADER at term 1 for changeToLeader
datanode_5_1  | 	... 4 more
datanode_2_1  | 2020-04-17 18:54:43,775 [grpc-default-executor-0] INFO impl.RoleInfo: 0e99e1b0-220f-42bd-a39f-d4658f80d0e4: start FollowerState
datanode_4_1  | 2020-04-17 18:52:30,009 [pool-69-thread-1] INFO storage.RaftStorage: Storage directory /data/metadata/ratis/cad403d1-ea2f-4530-84e5-79e0035d853a has been successfully formatted.
datanode_4_1  | 2020-04-17 18:52:30,010 [pool-69-thread-1] INFO ratis.ContainerStateMachine: group-79E0035D853A: The snapshot info is null. Setting the last applied indexto:(t:0, i:~)
datanode_6_1  | 2020-04-17 18:50:46,562 [79669a1f-2445-496e-a337-3115205f3ae5@group-E8C5921C502F-LeaderElection1] INFO ratis.XceiverServerRatis: Leader change notification received for group: group-E8C5921C502F with new leaderId: 79669a1f-2445-496e-a337-3115205f3ae5
datanode_5_1  | 2020-04-17 18:54:08,709 [Command processor thread] INFO impl.RaftServerProxy: 978c057e-5c38-4e20-8a8b-f271c823af7e: remove group-79E0035D853A:null
datanode_2_1  | 2020-04-17 18:54:43,775 [Thread-144] INFO impl.FollowerState: 0e99e1b0-220f-42bd-a39f-d4658f80d0e4@group-95C80522151F-FollowerState was interrupted: java.lang.InterruptedException: sleep interrupted
datanode_4_1  | 2020-04-17 18:52:30,010 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.notification.no-leader.timeout = 60s (default)
scm_1         | 2020-04-17 18:50:58,919 [EventQueue-PipelineActionsForPipelineActionHandler] INFO pipeline.PipelineActionHandler: Received pipeline action CLOSE for PipelineID=be26d0dd-802f-4608-9a1c-385ef22ed913 from datanode 978c057e-5c38-4e20-8a8b-f271c823af7e. Reason : Log already failed at index 1 for task WriteLog:1: (t:1, i:1), STATEMACHINELOGENTRY, client-884610206644, cid=8
datanode_6_1  | 2020-04-17 18:50:46,562 [79669a1f-2445-496e-a337-3115205f3ae5@group-E8C5921C502F-LeaderElection1] INFO impl.RaftServerImpl: 79669a1f-2445-496e-a337-3115205f3ae5@group-E8C5921C502F: change Leader from null to 79669a1f-2445-496e-a337-3115205f3ae5 at term 1 for becomeLeader, leader elected after 5531ms
datanode_5_1  | 2020-04-17 18:54:08,709 [Command processor thread] ERROR commandhandler.ClosePipelineCommandHandler: Can't close pipeline #id: "cad403d1-ea2f-4530-84e5-79e0035d853a"
datanode_2_1  | 2020-04-17 18:54:43,817 [grpc-default-executor-0] INFO ratis.XceiverServerRatis: Leader change notification received for group: group-95C80522151F with new leaderId: a0acbcec-d753-414c-b077-647d02aaa7fb
datanode_4_1  | 2020-04-17 18:52:30,010 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.use.memory = false (default)
datanode_4_1  | 2020-04-17 18:52:30,011 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.purge.gap = 1000000 (custom)
datanode_6_1  | 2020-04-17 18:50:46,576 [79669a1f-2445-496e-a337-3115205f3ae5@group-E8C5921C502F-LeaderElection1] INFO server.RaftServerConfigKeys: raft.server.staging.catchup.gap = 1000 (default)
datanode_5_1  | 
datanode_4_1  | 2020-04-17 18:52:30,012 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
datanode_6_1  | 2020-04-17 18:50:46,591 [79669a1f-2445-496e-a337-3115205f3ae5@group-E8C5921C502F-LeaderElection1] INFO server.RaftServerConfigKeys: raft.server.rpc.sleep.time = 25ms (default)
scm_1         | 	 State Machine: cmdType: WriteChunk traceID: "e215c60bfe250702:7a34a8519fdccc42:e215c60bfe250702:0" containerID: 2 datanodeUuid: "0e99e1b0-220f-42bd-a39f-d4658f80d0e4" pipelineID: "be26d0dd-802f-4608-9a1c-385ef22ed913" writeChunk { blockID { containerID: 2 localID: 104015426885648386 blockCommitSequenceId: 0 } chunkData { chunkName: "104015426885648386_chunk_1" offset: 0 len: 10240 checksumData { type: CRC32 bytesPerChecksum: 1048576 checksums: ">\344\315\231" } } }, container path=nonexistent
datanode_2_1  | 2020-04-17 18:54:43,817 [grpc-default-executor-0] INFO impl.RaftServerImpl: 0e99e1b0-220f-42bd-a39f-d4658f80d0e4@group-95C80522151F: change Leader from null to a0acbcec-d753-414c-b077-647d02aaa7fb at term 1 for appendEntries, leader elected after 5100ms
datanode_5_1  | java.io.IOException: 978c057e-5c38-4e20-8a8b-f271c823af7e: Group group-79E0035D853A not found.
datanode_4_1  | 2020-04-17 18:52:30,012 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.segment.size.max = 1048576 (custom)
datanode_6_1  | 2020-04-17 18:50:46,597 [79669a1f-2445-496e-a337-3115205f3ae5@group-E8C5921C502F-LeaderElection1] INFO metrics.RatisMetrics: Creating Metrics Registry : ratis.log_appender.79669a1f-2445-496e-a337-3115205f3ae5@group-E8C5921C502F
scm_1         | 2020-04-17 18:50:58,920 [EventQueue-PipelineActionsForPipelineActionHandler] INFO pipeline.SCMPipelineManager: Destroying pipeline:Pipeline[ Id: be26d0dd-802f-4608-9a1c-385ef22ed913, Nodes: 0e99e1b0-220f-42bd-a39f-d4658f80d0e4{ip: 10.5.0.5, host: ozone-topology_datanode_2_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}a0acbcec-d753-414c-b077-647d02aaa7fb{ip: 10.5.0.7, host: ozone-topology_datanode_4_1.ozone-topology_net, networkLocation: /rack2, certSerialId: null}978c057e-5c38-4e20-8a8b-f271c823af7e{ip: 10.5.0.8, host: ozone-topology_datanode_5_1.ozone-topology_net, networkLocation: /rack2, certSerialId: null}, Type:RATIS, Factor:THREE, State:CLOSED, leaderId:a0acbcec-d753-414c-b077-647d02aaa7fb, CreationTimestamp2020-04-17T18:50:39.512923Z]
datanode_2_1  | 2020-04-17 18:54:43,819 [grpc-default-executor-0] INFO impl.RaftServerImpl: 0e99e1b0-220f-42bd-a39f-d4658f80d0e4@group-95C80522151F: set configuration 0: [b23d8fb0-3698-40b4-ac98-17b8605a770b:10.5.0.4:9858, a0acbcec-d753-414c-b077-647d02aaa7fb:10.5.0.7:9858, 0e99e1b0-220f-42bd-a39f-d4658f80d0e4:10.5.0.5:9858], old=null at 0
datanode_5_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.XceiverServerRatis.removeGroup(XceiverServerRatis.java:659)
datanode_4_1  | 2020-04-17 18:52:30,012 [pool-69-thread-1] INFO metrics.RatisMetrics: Creating Metrics Registry : ratis.log_worker.a0acbcec-d753-414c-b077-647d02aaa7fb
scm_1         | 2020-04-17 18:50:58,943 [EventQueue-PipelineActionsForPipelineActionHandler] INFO pipeline.PipelineActionHandler: Received pipeline action CLOSE for PipelineID=be26d0dd-802f-4608-9a1c-385ef22ed913 from datanode a0acbcec-d753-414c-b077-647d02aaa7fb. Reason : Log already failed at index 1 for task WriteLog:1: (t:1, i:1), STATEMACHINELOGENTRY, client-884610206644, cid=8
datanode_2_1  | 2020-04-17 18:54:43,819 [grpc-default-executor-0] INFO segmented.SegmentedRaftLogWorker: 0e99e1b0-220f-42bd-a39f-d4658f80d0e4@group-95C80522151F-SegmentedRaftLogWorker: Starting segment from index:0
datanode_6_1  | 2020-04-17 18:50:46,609 [79669a1f-2445-496e-a337-3115205f3ae5@group-E8C5921C502F-LeaderElection1] INFO server.RaftServerConfigKeys: raft.server.write.element-limit = 1024 (custom)
datanode_5_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.ClosePipelineCommandHandler.handle(ClosePipelineCommandHandler.java:77)
datanode_4_1  | 2020-04-17 18:52:30,015 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.segment.cache.num.max = 2 (custom)
scm_1         | 	 State Machine: cmdType: WriteChunk traceID: "e215c60bfe250702:7a34a8519fdccc42:e215c60bfe250702:0" containerID: 2 datanodeUuid: "0e99e1b0-220f-42bd-a39f-d4658f80d0e4" pipelineID: "be26d0dd-802f-4608-9a1c-385ef22ed913" writeChunk { blockID { containerID: 2 localID: 104015426885648386 blockCommitSequenceId: 0 } chunkData { chunkName: "104015426885648386_chunk_1" offset: 0 len: 10240 checksumData { type: CRC32 bytesPerChecksum: 1048576 checksums: ">\344\315\231" } } }, container path=nonexistent
datanode_2_1  | 2020-04-17 18:54:43,823 [0e99e1b0-220f-42bd-a39f-d4658f80d0e4@group-95C80522151F-SegmentedRaftLogWorker] INFO segmented.SegmentedRaftLogWorker: 0e99e1b0-220f-42bd-a39f-d4658f80d0e4@group-95C80522151F-SegmentedRaftLogWorker: created new log segment /data/metadata/ratis/b5a22a8d-2392-4c7a-923f-95c80522151f/current/log_inprogress_0
datanode_6_1  | 2020-04-17 18:50:46,615 [79669a1f-2445-496e-a337-3115205f3ae5@group-E8C5921C502F-LeaderElection1] INFO server.RaftServerConfigKeys: raft.server.write.byte-limit = 1073741824 (custom)
datanode_5_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.CommandDispatcher.handle(CommandDispatcher.java:99)
datanode_4_1  | 2020-04-17 18:52:30,015 [pool-69-thread-1] INFO segmented.SegmentedRaftLogWorker: new a0acbcec-d753-414c-b077-647d02aaa7fb@group-79E0035D853A-SegmentedRaftLogWorker for RaftStorage:Storage Directory /data/metadata/ratis/cad403d1-ea2f-4530-84e5-79e0035d853a
scm_1         | 2020-04-17 18:50:58,946 [EventQueue-PipelineActionsForPipelineActionHandler] INFO pipeline.SCMPipelineManager: Destroying pipeline:Pipeline[ Id: be26d0dd-802f-4608-9a1c-385ef22ed913, Nodes: 0e99e1b0-220f-42bd-a39f-d4658f80d0e4{ip: 10.5.0.5, host: ozone-topology_datanode_2_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}a0acbcec-d753-414c-b077-647d02aaa7fb{ip: 10.5.0.7, host: ozone-topology_datanode_4_1.ozone-topology_net, networkLocation: /rack2, certSerialId: null}978c057e-5c38-4e20-8a8b-f271c823af7e{ip: 10.5.0.8, host: ozone-topology_datanode_5_1.ozone-topology_net, networkLocation: /rack2, certSerialId: null}, Type:RATIS, Factor:THREE, State:CLOSED, leaderId:a0acbcec-d753-414c-b077-647d02aaa7fb, CreationTimestamp2020-04-17T18:50:39.512923Z]
datanode_2_1  | 2020-04-17 18:55:12,559 [java.util.concurrent.ThreadPoolExecutor$Worker@66fd1c6f[State = -1, empty queue]] WARN server.GrpcLogAppender: 0e99e1b0-220f-42bd-a39f-d4658f80d0e4@group-CFD51574C841->978c057e-5c38-4e20-8a8b-f271c823af7e-GrpcLogAppender:  appendEntries Timeout, request=AppendEntriesRequest:cid=5,entriesCount=1,lastEntry=(t:1, i:1)
datanode_6_1  | 2020-04-17 18:50:46,622 [79669a1f-2445-496e-a337-3115205f3ae5@group-E8C5921C502F-LeaderElection1] INFO server.RaftServerConfigKeys: raft.server.watch.timeout = 180s (custom)
datanode_5_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.lambda$initCommandHandlerThread$1(DatanodeStateMachine.java:472)
datanode_4_1  | 2020-04-17 18:52:30,015 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.queue.byte-limit = 2147483647 (custom)
scm_1         | 2020-04-17 18:50:58,990 [EventQueue-PipelineActionsForPipelineActionHandler] INFO pipeline.PipelineActionHandler: Received pipeline action CLOSE for PipelineID=be26d0dd-802f-4608-9a1c-385ef22ed913 from datanode 0e99e1b0-220f-42bd-a39f-d4658f80d0e4. Reason : ContainerID 2 creation failed
datanode_2_1  | 2020-04-17 18:55:12,559 [java.util.concurrent.ThreadPoolExecutor$Worker@66fd1c6f[State = -1, empty queue]] WARN server.GrpcLogAppender: 0e99e1b0-220f-42bd-a39f-d4658f80d0e4@group-CFD51574C841->79669a1f-2445-496e-a337-3115205f3ae5-GrpcLogAppender:  appendEntries Timeout, request=AppendEntriesRequest:cid=5,entriesCount=1,lastEntry=(t:1, i:1)
datanode_6_1  | 2020-04-17 18:50:46,637 [79669a1f-2445-496e-a337-3115205f3ae5@group-E8C5921C502F-LeaderElection1] INFO server.RaftServerConfigKeys: raft.server.watch.timeout.denomination = 1s (default)
datanode_5_1  | 	at java.base/java.lang.Thread.run(Thread.java:834)
datanode_4_1  | 2020-04-17 18:52:30,015 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.queue.element-limit = 1024 (custom)
scm_1         | 2020-04-17 18:50:58,990 [EventQueue-PipelineActionsForPipelineActionHandler] INFO pipeline.SCMPipelineManager: Destroying pipeline:Pipeline[ Id: be26d0dd-802f-4608-9a1c-385ef22ed913, Nodes: 0e99e1b0-220f-42bd-a39f-d4658f80d0e4{ip: 10.5.0.5, host: ozone-topology_datanode_2_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}a0acbcec-d753-414c-b077-647d02aaa7fb{ip: 10.5.0.7, host: ozone-topology_datanode_4_1.ozone-topology_net, networkLocation: /rack2, certSerialId: null}978c057e-5c38-4e20-8a8b-f271c823af7e{ip: 10.5.0.8, host: ozone-topology_datanode_5_1.ozone-topology_net, networkLocation: /rack2, certSerialId: null}, Type:RATIS, Factor:THREE, State:CLOSED, leaderId:a0acbcec-d753-414c-b077-647d02aaa7fb, CreationTimestamp2020-04-17T18:50:39.512923Z]
datanode_2_1  | 2020-04-17 18:55:12,595 [java.util.concurrent.ThreadPoolExecutor$Worker@66fd1c6f[State = -1, empty queue]] WARN server.GrpcLogAppender: 0e99e1b0-220f-42bd-a39f-d4658f80d0e4@group-CFD51574C841->79669a1f-2445-496e-a337-3115205f3ae5-GrpcLogAppender:  appendEntries Timeout, request=AppendEntriesRequest:cid=6,entriesCount=1,lastEntry=(t:1, i:2)
datanode_6_1  | 2020-04-17 18:50:46,638 [79669a1f-2445-496e-a337-3115205f3ae5@group-E8C5921C502F-LeaderElection1] INFO server.RaftServerConfigKeys: raft.server.watch.element-limit = 65536 (default)
datanode_5_1  | Caused by: org.apache.ratis.protocol.GroupMismatchException: 978c057e-5c38-4e20-8a8b-f271c823af7e: Group group-79E0035D853A not found.
datanode_4_1  | 2020-04-17 18:52:30,015 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.segment.size.max = 1048576 (custom)
scm_1         | 2020-04-17 18:50:59,124 [EventQueue-PipelineActionsForPipelineActionHandler] INFO pipeline.PipelineActionHandler: Received pipeline action CLOSE for PipelineID=be26d0dd-802f-4608-9a1c-385ef22ed913 from datanode 0e99e1b0-220f-42bd-a39f-d4658f80d0e4. Reason : Log already failed at index 1 for task WriteLog:1: (t:1, i:1), STATEMACHINELOGENTRY, client-884610206644, cid=8
datanode_2_1  | 2020-04-17 18:55:12,598 [java.util.concurrent.ThreadPoolExecutor$Worker@66fd1c6f[State = -1, empty queue]] WARN server.GrpcLogAppender: 0e99e1b0-220f-42bd-a39f-d4658f80d0e4@group-CFD51574C841->978c057e-5c38-4e20-8a8b-f271c823af7e-GrpcLogAppender:  appendEntries Timeout, request=AppendEntriesRequest:cid=6,entriesCount=1,lastEntry=(t:1, i:2)
datanode_6_1  | 2020-04-17 18:50:46,674 [79669a1f-2445-496e-a337-3115205f3ae5@group-E8C5921C502F-LeaderElection1] INFO impl.RoleInfo: 79669a1f-2445-496e-a337-3115205f3ae5: start LeaderState
datanode_5_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupRemoveAsync(RaftServerProxy.java:404)
datanode_4_1  | 2020-04-17 18:52:30,016 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.preallocated.size = 16384 (custom)
scm_1         | 	 State Machine: cmdType: WriteChunk traceID: "e215c60bfe250702:7a34a8519fdccc42:e215c60bfe250702:0" containerID: 2 datanodeUuid: "0e99e1b0-220f-42bd-a39f-d4658f80d0e4" pipelineID: "be26d0dd-802f-4608-9a1c-385ef22ed913" writeChunk { blockID { containerID: 2 localID: 104015426885648386 blockCommitSequenceId: 0 } chunkData { chunkName: "104015426885648386_chunk_1" offset: 0 len: 10240 checksumData { type: CRC32 bytesPerChecksum: 1048576 checksums: ">\344\315\231" } } }, container path=nonexistent
datanode_6_1  | 2020-04-17 18:50:46,704 [Command processor thread] INFO commandhandler.CreatePipelineCommandHandler: Created Pipeline RATIS THREE #id: "315eee3a-6983-45b7-a699-f5bd6c5f0281"
datanode_4_1  | 2020-04-17 18:52:30,016 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.write.buffer.size = 1048576 (custom)
scm_1         | 2020-04-17 18:50:59,125 [EventQueue-PipelineActionsForPipelineActionHandler] INFO pipeline.SCMPipelineManager: Destroying pipeline:Pipeline[ Id: be26d0dd-802f-4608-9a1c-385ef22ed913, Nodes: 0e99e1b0-220f-42bd-a39f-d4658f80d0e4{ip: 10.5.0.5, host: ozone-topology_datanode_2_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}a0acbcec-d753-414c-b077-647d02aaa7fb{ip: 10.5.0.7, host: ozone-topology_datanode_4_1.ozone-topology_net, networkLocation: /rack2, certSerialId: null}978c057e-5c38-4e20-8a8b-f271c823af7e{ip: 10.5.0.8, host: ozone-topology_datanode_5_1.ozone-topology_net, networkLocation: /rack2, certSerialId: null}, Type:RATIS, Factor:THREE, State:CLOSED, leaderId:a0acbcec-d753-414c-b077-647d02aaa7fb, CreationTimestamp2020-04-17T18:50:39.512923Z]
datanode_2_1  | 2020-04-17 18:55:39,716 [Command processor thread] INFO impl.RaftServerProxy: 0e99e1b0-220f-42bd-a39f-d4658f80d0e4: remove    LEADER 0e99e1b0-220f-42bd-a39f-d4658f80d0e4@group-CFD51574C841:t1, leader=0e99e1b0-220f-42bd-a39f-d4658f80d0e4, voted=0e99e1b0-220f-42bd-a39f-d4658f80d0e4, raftlog=0e99e1b0-220f-42bd-a39f-d4658f80d0e4@group-CFD51574C841-SegmentedRaftLog:OPENED:c0,f0,i2, conf=0: [978c057e-5c38-4e20-8a8b-f271c823af7e:10.5.0.8:9858, 79669a1f-2445-496e-a337-3115205f3ae5:10.5.0.9:9858, 0e99e1b0-220f-42bd-a39f-d4658f80d0e4:10.5.0.5:9858], old=null RUNNING
datanode_5_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupManagementAsync(RaftServerProxy.java:367)
datanode_6_1  | .
datanode_4_1  | 2020-04-17 18:52:30,016 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.force.sync.num = 128 (default)
scm_1         | 2020-04-17 18:52:04,779 [RatisPipelineUtilsThread] INFO pipeline.RatisPipelineProvider: Send pipeline:PipelineID=be26d0dd-802f-4608-9a1c-385ef22ed913 close command to datanode 0e99e1b0-220f-42bd-a39f-d4658f80d0e4
datanode_2_1  | 2020-04-17 18:55:39,717 [Command processor thread] INFO impl.RaftServerImpl: 0e99e1b0-220f-42bd-a39f-d4658f80d0e4@group-CFD51574C841: shutdown
datanode_5_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupManagement(RaftServerProxy.java:350)
datanode_6_1  | 2020-04-17 18:50:46,754 [Thread-25] INFO impl.FollowerState: 79669a1f-2445-496e-a337-3115205f3ae5@group-F5BD6C5F0281-FollowerState: change to CANDIDATE, lastRpcTime:5114ms, electionTimeout:5098ms
datanode_4_1  | 2020-04-17 18:52:30,016 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.statemachine.data.sync = true (default)
scm_1         | 2020-04-17 18:52:04,780 [RatisPipelineUtilsThread] INFO pipeline.RatisPipelineProvider: Send pipeline:PipelineID=be26d0dd-802f-4608-9a1c-385ef22ed913 close command to datanode a0acbcec-d753-414c-b077-647d02aaa7fb
datanode_2_1  | 2020-04-17 18:55:39,717 [Command processor thread] INFO util.JmxRegister: Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-CFD51574C841,id=0e99e1b0-220f-42bd-a39f-d4658f80d0e4
datanode_5_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.XceiverServerRatis.removeGroup(XceiverServerRatis.java:657)
datanode_6_1  | 2020-04-17 18:50:46,771 [Thread-25] INFO impl.RoleInfo: 79669a1f-2445-496e-a337-3115205f3ae5: shutdown FollowerState
datanode_4_1  | 2020-04-17 18:52:30,016 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.statemachine.data.sync.timeout = 10s (default)
scm_1         | 2020-04-17 18:52:04,780 [RatisPipelineUtilsThread] INFO pipeline.RatisPipelineProvider: Send pipeline:PipelineID=be26d0dd-802f-4608-9a1c-385ef22ed913 close command to datanode 978c057e-5c38-4e20-8a8b-f271c823af7e
datanode_2_1  | 2020-04-17 18:55:39,717 [Command processor thread] INFO impl.RoleInfo: 0e99e1b0-220f-42bd-a39f-d4658f80d0e4: shutdown LeaderState
datanode_5_1  | 	... 4 more
datanode_6_1  | 2020-04-17 18:50:46,771 [Thread-25] INFO impl.RaftServerImpl: 79669a1f-2445-496e-a337-3115205f3ae5@group-F5BD6C5F0281: changes role from  FOLLOWER to CANDIDATE at term 0 for changeToCandidate
datanode_4_1  | 2020-04-17 18:52:30,016 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
scm_1         | 2020-04-17 18:52:04,781 [RatisPipelineUtilsThread] INFO pipeline.PipelineStateManager: Pipeline Pipeline[ Id: be26d0dd-802f-4608-9a1c-385ef22ed913, Nodes: 0e99e1b0-220f-42bd-a39f-d4658f80d0e4{ip: 10.5.0.5, host: ozone-topology_datanode_2_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}a0acbcec-d753-414c-b077-647d02aaa7fb{ip: 10.5.0.7, host: ozone-topology_datanode_4_1.ozone-topology_net, networkLocation: /rack2, certSerialId: null}978c057e-5c38-4e20-8a8b-f271c823af7e{ip: 10.5.0.8, host: ozone-topology_datanode_5_1.ozone-topology_net, networkLocation: /rack2, certSerialId: null}, Type:RATIS, Factor:THREE, State:CLOSED, leaderId:a0acbcec-d753-414c-b077-647d02aaa7fb, CreationTimestamp2020-04-17T18:50:39.512923Z] removed from db
datanode_2_1  | 2020-04-17 18:55:39,718 [Command processor thread] INFO impl.PendingRequests: 0e99e1b0-220f-42bd-a39f-d4658f80d0e4@group-CFD51574C841-PendingRequests: sendNotLeaderResponses
datanode_5_1  | 2020-04-17 18:54:08,709 [Command processor thread] INFO impl.RaftServerProxy: 978c057e-5c38-4e20-8a8b-f271c823af7e: remove group-79E0035D853A:null
datanode_6_1  | 2020-04-17 18:50:46,771 [Thread-25] INFO impl.RoleInfo: 79669a1f-2445-496e-a337-3115205f3ae5: start LeaderElection
datanode_4_1  | 2020-04-17 18:52:30,017 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.statemachine.data.caching.enabled = true (custom)
scm_1         | 2020-04-17 18:52:04,783 [RatisPipelineUtilsThread] ERROR pipeline.SCMPipelineManager: Failed to create pipeline of type RATIS and factor ONE. Exception: Cannot create pipeline of factor 1 using 0 nodes. Used 6 nodes. Healthy nodes 6
datanode_2_1  | 2020-04-17 18:55:39,718 [org.apache.ratis.server.impl.LogAppender$AppenderDaemon$$Lambda$531/0x00000008405f4840@2316af58] WARN server.GrpcLogAppender: 0e99e1b0-220f-42bd-a39f-d4658f80d0e4@group-CFD51574C841->978c057e-5c38-4e20-8a8b-f271c823af7e-GrpcLogAppender: Wait interrupted by java.lang.InterruptedException
datanode_5_1  | 2020-04-17 18:54:08,709 [Command processor thread] ERROR commandhandler.ClosePipelineCommandHandler: Can't close pipeline #id: "cad403d1-ea2f-4530-84e5-79e0035d853a"
datanode_6_1  | 2020-04-17 18:50:46,791 [79669a1f-2445-496e-a337-3115205f3ae5@group-E8C5921C502F-LeaderElection1] INFO segmented.SegmentedRaftLogWorker: 79669a1f-2445-496e-a337-3115205f3ae5@group-E8C5921C502F-SegmentedRaftLogWorker: Starting segment from index:0
datanode_4_1  | 2020-04-17 18:52:30,018 [pool-69-thread-1] INFO segmented.SegmentedRaftLogWorker: a0acbcec-d753-414c-b077-647d02aaa7fb@group-79E0035D853A-SegmentedRaftLogWorker: flushIndex: setUnconditionally 0 -> -1
scm_1         | 2020-04-17 18:52:04,783 [RatisPipelineUtilsThread] INFO pipeline.RatisPipelineProvider: Sending CreatePipelineCommand for pipeline:PipelineID=cad403d1-ea2f-4530-84e5-79e0035d853a to datanode:a0acbcec-d753-414c-b077-647d02aaa7fb
datanode_5_1  | 
datanode_2_1  | 2020-04-17 18:55:39,718 [org.apache.ratis.server.impl.LogAppender$AppenderDaemon$$Lambda$531/0x00000008405f4840@4b2a7990] WARN server.GrpcLogAppender: 0e99e1b0-220f-42bd-a39f-d4658f80d0e4@group-CFD51574C841->79669a1f-2445-496e-a337-3115205f3ae5-GrpcLogAppender: Wait interrupted by java.lang.InterruptedException
datanode_6_1  | 2020-04-17 18:50:46,793 [79669a1f-2445-496e-a337-3115205f3ae5@group-F5BD6C5F0281-LeaderElection2] INFO impl.LeaderElection: 79669a1f-2445-496e-a337-3115205f3ae5@group-F5BD6C5F0281-LeaderElection2: begin an election at term 1 for -1: [b23d8fb0-3698-40b4-ac98-17b8605a770b:10.5.0.4:9858, 32863f73-3555-4b23-932a-0d28eb668aea:10.5.0.6:9858, 79669a1f-2445-496e-a337-3115205f3ae5:10.5.0.9:9858], old=null
datanode_4_1  | 2020-04-17 18:52:30,018 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.snapshot.auto.trigger.enabled = true (custom)
scm_1         | 2020-04-17 18:52:04,783 [RatisPipelineUtilsThread] INFO pipeline.RatisPipelineProvider: Sending CreatePipelineCommand for pipeline:PipelineID=cad403d1-ea2f-4530-84e5-79e0035d853a to datanode:0e99e1b0-220f-42bd-a39f-d4658f80d0e4
datanode_5_1  | java.io.IOException: 978c057e-5c38-4e20-8a8b-f271c823af7e: Group group-79E0035D853A not found.
datanode_2_1  | 2020-04-17 18:55:39,725 [grpc-default-executor-0] INFO server.GrpcLogAppender: 0e99e1b0-220f-42bd-a39f-d4658f80d0e4@group-CFD51574C841->79669a1f-2445-496e-a337-3115205f3ae5-AppendLogResponseHandler: follower responses appendEntries COMPLETED
datanode_6_1  | 2020-04-17 18:50:47,012 [79669a1f-2445-496e-a337-3115205f3ae5@group-E8C5921C502F-LeaderElection1] INFO impl.RaftServerImpl: 79669a1f-2445-496e-a337-3115205f3ae5@group-E8C5921C502F: set configuration 0: [79669a1f-2445-496e-a337-3115205f3ae5:10.5.0.9:9858], old=null at 0
datanode_4_1  | 2020-04-17 18:52:30,018 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
scm_1         | 2020-04-17 18:52:04,783 [RatisPipelineUtilsThread] INFO pipeline.RatisPipelineProvider: Sending CreatePipelineCommand for pipeline:PipelineID=cad403d1-ea2f-4530-84e5-79e0035d853a to datanode:978c057e-5c38-4e20-8a8b-f271c823af7e
datanode_5_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.XceiverServerRatis.removeGroup(XceiverServerRatis.java:659)
datanode_2_1  | 2020-04-17 18:55:39,728 [grpc-default-executor-1] INFO server.GrpcLogAppender: 0e99e1b0-220f-42bd-a39f-d4658f80d0e4@group-CFD51574C841->978c057e-5c38-4e20-8a8b-f271c823af7e-AppendLogResponseHandler: follower responses appendEntries COMPLETED
datanode_6_1  | 2020-04-17 18:50:47,098 [79669a1f-2445-496e-a337-3115205f3ae5@group-F5BD6C5F0281-LeaderElection2] INFO impl.LeaderElection: 79669a1f-2445-496e-a337-3115205f3ae5@group-F5BD6C5F0281-LeaderElection2: Election PASSED; received 1 response(s) [79669a1f-2445-496e-a337-3115205f3ae5<-b23d8fb0-3698-40b4-ac98-17b8605a770b#0:OK-t1] and 0 exception(s); 79669a1f-2445-496e-a337-3115205f3ae5@group-F5BD6C5F0281:t1, leader=null, voted=79669a1f-2445-496e-a337-3115205f3ae5, raftlog=79669a1f-2445-496e-a337-3115205f3ae5@group-F5BD6C5F0281-SegmentedRaftLog:OPENED:c-1,f-1,i0, conf=-1: [b23d8fb0-3698-40b4-ac98-17b8605a770b:10.5.0.4:9858, 32863f73-3555-4b23-932a-0d28eb668aea:10.5.0.6:9858, 79669a1f-2445-496e-a337-3115205f3ae5:10.5.0.9:9858], old=null
datanode_4_1  | 2020-04-17 18:52:30,018 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.snapshot.retention.file.num = 5 (custom)
scm_1         | 2020-04-17 18:52:04,784 [RatisPipelineUtilsThread] INFO pipeline.PipelineStateManager: Created pipeline Pipeline[ Id: cad403d1-ea2f-4530-84e5-79e0035d853a, Nodes: a0acbcec-d753-414c-b077-647d02aaa7fb{ip: 10.5.0.7, host: ozone-topology_datanode_4_1.ozone-topology_net, networkLocation: /rack2, certSerialId: null}0e99e1b0-220f-42bd-a39f-d4658f80d0e4{ip: 10.5.0.5, host: ozone-topology_datanode_2_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}978c057e-5c38-4e20-8a8b-f271c823af7e{ip: 10.5.0.8, host: ozone-topology_datanode_5_1.ozone-topology_net, networkLocation: /rack2, certSerialId: null}, Type:RATIS, Factor:THREE, State:ALLOCATED, leaderId:null, CreationTimestamp2020-04-17T18:52:04.783559Z]
datanode_5_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.ClosePipelineCommandHandler.handle(ClosePipelineCommandHandler.java:77)
datanode_2_1  | 2020-04-17 18:55:39,730 [grpc-default-executor-1] INFO impl.FollowerInfo: 0e99e1b0-220f-42bd-a39f-d4658f80d0e4@group-CFD51574C841->978c057e-5c38-4e20-8a8b-f271c823af7e: nextIndex: updateUnconditionally 3 -> 1
datanode_5_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.CommandDispatcher.handle(CommandDispatcher.java:99)
datanode_4_1  | 2020-04-17 18:52:30,018 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.retrycache.expirytime = 600000ms (custom)
scm_1         | 2020-04-17 18:52:04,784 [RatisPipelineUtilsThread] ERROR pipeline.SCMPipelineManager: Failed to create pipeline of type RATIS and factor THREE. Exception: Pipeline creation failed because nodes are engaged in other pipelines and every node can only be engaged in max 2 pipelines. Required 3. Found 0
datanode_6_1  | 2020-04-17 18:50:47,105 [79669a1f-2445-496e-a337-3115205f3ae5@group-F5BD6C5F0281-LeaderElection2] INFO impl.RoleInfo: 79669a1f-2445-496e-a337-3115205f3ae5: shutdown LeaderElection
datanode_2_1  | 2020-04-17 18:55:39,735 [Command processor thread] INFO metrics.RatisMetrics: Unregistering Metrics Registry : ratis.log_appender.0e99e1b0-220f-42bd-a39f-d4658f80d0e4@group-CFD51574C841
datanode_5_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.lambda$initCommandHandlerThread$1(DatanodeStateMachine.java:472)
datanode_4_1  | 2020-04-17 18:52:30,018 [pool-69-thread-1] INFO metrics.RatisMetrics: Creating Metrics Registry : ratis.leader_election.a0acbcec-d753-414c-b077-647d02aaa7fb@group-79E0035D853A
scm_1         | 2020-04-17 18:52:04,822 [RatisPipelineUtilsThread] INFO pipeline.RatisPipelineProvider: Send pipeline:PipelineID=be26d0dd-802f-4608-9a1c-385ef22ed913 close command to datanode 0e99e1b0-220f-42bd-a39f-d4658f80d0e4
datanode_6_1  | 2020-04-17 18:50:47,105 [79669a1f-2445-496e-a337-3115205f3ae5@group-F5BD6C5F0281-LeaderElection2] INFO impl.RaftServerImpl: 79669a1f-2445-496e-a337-3115205f3ae5@group-F5BD6C5F0281: changes role from CANDIDATE to LEADER at term 1 for changeToLeader
datanode_2_1  | 2020-04-17 18:55:39,746 [Command processor thread] INFO impl.StateMachineUpdater: 0e99e1b0-220f-42bd-a39f-d4658f80d0e4@group-CFD51574C841-StateMachineUpdater: set stopIndex = 0
datanode_5_1  | 	at java.base/java.lang.Thread.run(Thread.java:834)
datanode_4_1  | 2020-04-17 18:52:30,019 [pool-69-thread-1] INFO metrics.RatisMetrics: Creating Metrics Registry : ratis.server.a0acbcec-d753-414c-b077-647d02aaa7fb@group-79E0035D853A
datanode_6_1  | 2020-04-17 18:50:47,108 [79669a1f-2445-496e-a337-3115205f3ae5@group-F5BD6C5F0281-LeaderElection2] INFO ratis.XceiverServerRatis: Leader change notification received for group: group-F5BD6C5F0281 with new leaderId: 79669a1f-2445-496e-a337-3115205f3ae5
scm_1         | 2020-04-17 18:52:04,822 [RatisPipelineUtilsThread] INFO pipeline.RatisPipelineProvider: Send pipeline:PipelineID=be26d0dd-802f-4608-9a1c-385ef22ed913 close command to datanode a0acbcec-d753-414c-b077-647d02aaa7fb
datanode_2_1  | 2020-04-17 18:55:39,730 [grpc-default-executor-0] INFO impl.FollowerInfo: 0e99e1b0-220f-42bd-a39f-d4658f80d0e4@group-CFD51574C841->79669a1f-2445-496e-a337-3115205f3ae5: nextIndex: updateUnconditionally 3 -> 1
datanode_5_1  | Caused by: org.apache.ratis.protocol.GroupMismatchException: 978c057e-5c38-4e20-8a8b-f271c823af7e: Group group-79E0035D853A not found.
datanode_4_1  | 2020-04-17 18:52:30,019 [pool-69-thread-1] INFO impl.RaftServerImpl: a0acbcec-d753-414c-b077-647d02aaa7fb@group-79E0035D853A: start as a follower, conf=-1: [978c057e-5c38-4e20-8a8b-f271c823af7e:10.5.0.8:9858, a0acbcec-d753-414c-b077-647d02aaa7fb:10.5.0.7:9858, 0e99e1b0-220f-42bd-a39f-d4658f80d0e4:10.5.0.5:9858], old=null
datanode_6_1  | 2020-04-17 18:50:47,108 [79669a1f-2445-496e-a337-3115205f3ae5@group-F5BD6C5F0281-LeaderElection2] INFO impl.RaftServerImpl: 79669a1f-2445-496e-a337-3115205f3ae5@group-F5BD6C5F0281: change Leader from null to 79669a1f-2445-496e-a337-3115205f3ae5 at term 1 for becomeLeader, leader elected after 5515ms
scm_1         | 2020-04-17 18:52:04,823 [RatisPipelineUtilsThread] INFO pipeline.RatisPipelineProvider: Send pipeline:PipelineID=be26d0dd-802f-4608-9a1c-385ef22ed913 close command to datanode 978c057e-5c38-4e20-8a8b-f271c823af7e
datanode_2_1  | 2020-04-17 18:55:39,746 [0e99e1b0-220f-42bd-a39f-d4658f80d0e4@group-CFD51574C841-StateMachineUpdater] ERROR ratis.ContainerStateMachine: Failed to take snapshot  for group-CFD51574C841 as the stateMachine is unhealthy. The last applied index is at (t:1, i:0)
datanode_5_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupRemoveAsync(RaftServerProxy.java:404)
datanode_4_1  | 2020-04-17 18:52:30,019 [pool-69-thread-1] INFO impl.RaftServerImpl: a0acbcec-d753-414c-b077-647d02aaa7fb@group-79E0035D853A: changes role from      null to FOLLOWER at term 0 for startAsFollower
datanode_6_1  | 2020-04-17 18:50:47,109 [79669a1f-2445-496e-a337-3115205f3ae5@group-F5BD6C5F0281-LeaderElection2] INFO server.RaftServerConfigKeys: raft.server.staging.catchup.gap = 1000 (default)
datanode_5_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupManagementAsync(RaftServerProxy.java:367)
datanode_2_1  | 2020-04-17 18:55:39,747 [0e99e1b0-220f-42bd-a39f-d4658f80d0e4@group-CFD51574C841-StateMachineUpdater] ERROR impl.StateMachineUpdater: 0e99e1b0-220f-42bd-a39f-d4658f80d0e4@group-CFD51574C841-StateMachineUpdater: Failed to take snapshot
scm_1         | 2020-04-17 18:52:04,823 [RatisPipelineUtilsThread] ERROR pipeline.SCMPipelineManager: Destroy pipeline failed for pipeline:Pipeline[ Id: be26d0dd-802f-4608-9a1c-385ef22ed913, Nodes: 0e99e1b0-220f-42bd-a39f-d4658f80d0e4{ip: 10.5.0.5, host: ozone-topology_datanode_2_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}a0acbcec-d753-414c-b077-647d02aaa7fb{ip: 10.5.0.7, host: ozone-topology_datanode_4_1.ozone-topology_net, networkLocation: /rack2, certSerialId: null}978c057e-5c38-4e20-8a8b-f271c823af7e{ip: 10.5.0.8, host: ozone-topology_datanode_5_1.ozone-topology_net, networkLocation: /rack2, certSerialId: null}, Type:RATIS, Factor:THREE, State:CLOSED, leaderId:a0acbcec-d753-414c-b077-647d02aaa7fb, CreationTimestamp2020-04-17T18:50:39.512923Z]
datanode_4_1  | 2020-04-17 18:52:30,020 [pool-69-thread-1] INFO impl.RoleInfo: a0acbcec-d753-414c-b077-647d02aaa7fb: start FollowerState
datanode_5_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupManagement(RaftServerProxy.java:350)
datanode_6_1  | 2020-04-17 18:50:47,109 [79669a1f-2445-496e-a337-3115205f3ae5@group-F5BD6C5F0281-LeaderElection2] INFO server.RaftServerConfigKeys: raft.server.rpc.sleep.time = 25ms (default)
datanode_2_1  | org.apache.ratis.protocol.StateMachineException: Failed to take snapshot  for group-CFD51574C841 as the stateMachine is unhealthy. The last applied index is at (t:1, i:0)
scm_1         | org.apache.hadoop.hdds.scm.pipeline.PipelineNotFoundException: PipelineID=be26d0dd-802f-4608-9a1c-385ef22ed913 not found
datanode_4_1  | 2020-04-17 18:52:30,020 [pool-69-thread-1] INFO util.JmxRegister: Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-79E0035D853A,id=a0acbcec-d753-414c-b077-647d02aaa7fb
datanode_5_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.XceiverServerRatis.removeGroup(XceiverServerRatis.java:657)
datanode_6_1  | 2020-04-17 18:50:47,109 [79669a1f-2445-496e-a337-3115205f3ae5@group-F5BD6C5F0281-LeaderElection2] INFO metrics.RatisMetrics: Creating Metrics Registry : ratis.log_appender.79669a1f-2445-496e-a337-3115205f3ae5@group-F5BD6C5F0281
datanode_2_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.ContainerStateMachine.takeSnapshot(ContainerStateMachine.java:288)
scm_1         | 	at org.apache.hadoop.hdds.scm.pipeline.PipelineStateMap.getPipeline(PipelineStateMap.java:133)
datanode_4_1  | 2020-04-17 18:52:30,020 [pool-69-thread-1] INFO metrics.RatisMetrics: Creating Metrics Registry : ratis.state_machine.a0acbcec-d753-414c-b077-647d02aaa7fb@group-79E0035D853A
datanode_5_1  | 	... 4 more
datanode_6_1  | 2020-04-17 18:50:47,110 [79669a1f-2445-496e-a337-3115205f3ae5@group-F5BD6C5F0281-LeaderElection2] INFO server.RaftServerConfigKeys: raft.server.write.element-limit = 1024 (custom)
datanode_2_1  | 	at org.apache.ratis.server.impl.StateMachineUpdater.takeSnapshot(StateMachineUpdater.java:258)
scm_1         | 	at org.apache.hadoop.hdds.scm.pipeline.PipelineStateMap.removePipeline(PipelineStateMap.java:323)
datanode_4_1  | 2020-04-17 18:52:30,023 [Command processor thread] INFO commandhandler.ClosePipelineCommandHandler: Close Pipeline #id: "be26d0dd-802f-4608-9a1c-385ef22ed913"
datanode_5_1  | 2020-04-17 18:54:08,709 [Command processor thread] INFO impl.RaftServerProxy: 978c057e-5c38-4e20-8a8b-f271c823af7e: remove group-79E0035D853A:null
datanode_6_1  | 2020-04-17 18:50:47,115 [79669a1f-2445-496e-a337-3115205f3ae5@group-F5BD6C5F0281-LeaderElection2] INFO server.RaftServerConfigKeys: raft.server.write.byte-limit = 1073741824 (custom)
datanode_2_1  | 	at org.apache.ratis.server.impl.StateMachineUpdater.checkAndTakeSnapshot(StateMachineUpdater.java:250)
scm_1         | 	at org.apache.hadoop.hdds.scm.pipeline.PipelineStateManager.removePipeline(PipelineStateManager.java:104)
datanode_4_1  |  command on datanode #a0acbcec-d753-414c-b077-647d02aaa7fb.
datanode_5_1  | 2020-04-17 18:54:08,709 [Command processor thread] ERROR commandhandler.ClosePipelineCommandHandler: Can't close pipeline #id: "cad403d1-ea2f-4530-84e5-79e0035d853a"
datanode_6_1  | 2020-04-17 18:50:47,118 [79669a1f-2445-496e-a337-3115205f3ae5@group-F5BD6C5F0281-LeaderElection2] INFO server.RaftServerConfigKeys: raft.server.watch.timeout = 180s (custom)
datanode_2_1  | 	at org.apache.ratis.server.impl.StateMachineUpdater.run(StateMachineUpdater.java:169)
scm_1         | 	at org.apache.hadoop.hdds.scm.pipeline.SCMPipelineManager.removePipeline(SCMPipelineManager.java:595)
datanode_4_1  | 2020-04-17 18:52:30,025 [Command processor thread] INFO impl.RaftServerProxy: a0acbcec-d753-414c-b077-647d02aaa7fb: remove group-385EF22ED913:null
datanode_5_1  | 
datanode_6_1  | 2020-04-17 18:50:47,119 [79669a1f-2445-496e-a337-3115205f3ae5@group-F5BD6C5F0281-LeaderElection2] INFO server.RaftServerConfigKeys: raft.server.watch.timeout.denomination = 1s (default)
datanode_2_1  | 	at java.base/java.lang.Thread.run(Thread.java:834)
scm_1         | 	at org.apache.hadoop.hdds.scm.pipeline.SCMPipelineManager.destroyPipeline(SCMPipelineManager.java:579)
datanode_4_1  | 2020-04-17 18:52:30,027 [Command processor thread] ERROR commandhandler.ClosePipelineCommandHandler: Can't close pipeline #id: "be26d0dd-802f-4608-9a1c-385ef22ed913"
datanode_5_1  | java.io.IOException: 978c057e-5c38-4e20-8a8b-f271c823af7e: Group group-79E0035D853A not found.
datanode_6_1  | 2020-04-17 18:50:47,119 [79669a1f-2445-496e-a337-3115205f3ae5@group-F5BD6C5F0281-LeaderElection2] INFO server.RaftServerConfigKeys: raft.server.watch.element-limit = 65536 (default)
datanode_2_1  | 2020-04-17 18:55:39,747 [0e99e1b0-220f-42bd-a39f-d4658f80d0e4@group-CFD51574C841-StateMachineUpdater] ERROR ratis.ContainerStateMachine: Failed to take snapshot  for group-CFD51574C841 as the stateMachine is unhealthy. The last applied index is at (t:1, i:0)
scm_1         | 	at org.apache.hadoop.hdds.scm.pipeline.SCMPipelineManager.lambda$finalizeAndDestroyPipeline$0(SCMPipelineManager.java:422)
datanode_4_1  | 
datanode_5_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.XceiverServerRatis.removeGroup(XceiverServerRatis.java:659)
datanode_6_1  | 2020-04-17 18:50:47,129 [79669a1f-2445-496e-a337-3115205f3ae5@group-F5BD6C5F0281-LeaderElection2] INFO server.RaftServerConfigKeys: raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
datanode_2_1  | 2020-04-17 18:55:39,748 [0e99e1b0-220f-42bd-a39f-d4658f80d0e4@group-CFD51574C841-StateMachineUpdater] ERROR impl.StateMachineUpdater: 0e99e1b0-220f-42bd-a39f-d4658f80d0e4@group-CFD51574C841-StateMachineUpdater: Failed to take snapshot
scm_1         | 	at org.apache.hadoop.hdds.utils.Scheduler.lambda$schedule$1(Scheduler.java:70)
datanode_4_1  | java.io.IOException: a0acbcec-d753-414c-b077-647d02aaa7fb: Group group-385EF22ED913 not found.
datanode_5_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.ClosePipelineCommandHandler.handle(ClosePipelineCommandHandler.java:77)
datanode_6_1  | 2020-04-17 18:50:47,129 [79669a1f-2445-496e-a337-3115205f3ae5@group-F5BD6C5F0281-LeaderElection2] INFO server.RaftServerConfigKeys: raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
datanode_2_1  | org.apache.ratis.protocol.StateMachineException: Failed to take snapshot  for group-CFD51574C841 as the stateMachine is unhealthy. The last applied index is at (t:1, i:0)
scm_1         | 	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
datanode_4_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.XceiverServerRatis.removeGroup(XceiverServerRatis.java:659)
datanode_5_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.CommandDispatcher.handle(CommandDispatcher.java:99)
datanode_6_1  | 2020-04-17 18:50:47,130 [79669a1f-2445-496e-a337-3115205f3ae5@group-F5BD6C5F0281-LeaderElection2] INFO server.RaftServerConfigKeys: raft.server.log.appender.buffer.element-limit = 1 (custom)
datanode_2_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.ContainerStateMachine.takeSnapshot(ContainerStateMachine.java:288)
scm_1         | 	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
datanode_4_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.ClosePipelineCommandHandler.handle(ClosePipelineCommandHandler.java:77)
datanode_5_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.lambda$initCommandHandlerThread$1(DatanodeStateMachine.java:472)
datanode_6_1  | 2020-04-17 18:50:47,172 [79669a1f-2445-496e-a337-3115205f3ae5@group-F5BD6C5F0281-LeaderElection2] INFO grpc.GrpcConfigKeys: raft.grpc.server.leader.outstanding.appends.max = 128 (default)
datanode_2_1  | 	at org.apache.ratis.server.impl.StateMachineUpdater.takeSnapshot(StateMachineUpdater.java:258)
scm_1         | 	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:304)
datanode_4_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.CommandDispatcher.handle(CommandDispatcher.java:99)
datanode_5_1  | 	at java.base/java.lang.Thread.run(Thread.java:834)
datanode_6_1  | 2020-04-17 18:50:47,194 [79669a1f-2445-496e-a337-3115205f3ae5@group-F5BD6C5F0281-LeaderElection2] INFO server.RaftServerConfigKeys: raft.server.rpc.request.timeout = 60s (custom)
datanode_2_1  | 	at org.apache.ratis.server.impl.StateMachineUpdater.checkAndTakeSnapshot(StateMachineUpdater.java:250)
scm_1         | 	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
datanode_4_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.lambda$initCommandHandlerThread$1(DatanodeStateMachine.java:472)
datanode_5_1  | Caused by: org.apache.ratis.protocol.GroupMismatchException: 978c057e-5c38-4e20-8a8b-f271c823af7e: Group group-79E0035D853A not found.
datanode_6_1  | 2020-04-17 18:50:47,198 [79669a1f-2445-496e-a337-3115205f3ae5@group-F5BD6C5F0281-LeaderElection2] INFO server.RaftServerConfigKeys: raft.server.log.appender.install.snapshot.enabled = false (custom)
datanode_2_1  | 	at org.apache.ratis.server.impl.StateMachineUpdater.run(StateMachineUpdater.java:172)
scm_1         | 	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
datanode_4_1  | 	at java.base/java.lang.Thread.run(Thread.java:834)
datanode_5_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupRemoveAsync(RaftServerProxy.java:404)
datanode_6_1  | 2020-04-17 18:50:47,226 [79669a1f-2445-496e-a337-3115205f3ae5@group-F5BD6C5F0281-LeaderElection2] INFO server.RaftServerConfigKeys: raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
datanode_2_1  | 	at java.base/java.lang.Thread.run(Thread.java:834)
scm_1         | 	at java.base/java.lang.Thread.run(Thread.java:834)
datanode_4_1  | Caused by: org.apache.ratis.protocol.GroupMismatchException: a0acbcec-d753-414c-b077-647d02aaa7fb: Group group-385EF22ED913 not found.
datanode_5_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupManagementAsync(RaftServerProxy.java:367)
datanode_6_1  | 2020-04-17 18:50:47,233 [79669a1f-2445-496e-a337-3115205f3ae5@group-F5BD6C5F0281-LeaderElection2] INFO server.RaftServerConfigKeys: raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
datanode_2_1  | 2020-04-17 18:55:39,749 [0e99e1b0-220f-42bd-a39f-d4658f80d0e4@group-CFD51574C841-StateMachineUpdater] INFO metrics.RatisMetrics: Unregistering Metrics Registry : ratis.state_machine.0e99e1b0-220f-42bd-a39f-d4658f80d0e4@group-CFD51574C841
scm_1         | 2020-04-17 18:52:04,920 [RatisPipelineUtilsThread] INFO pipeline.RatisPipelineProvider: Send pipeline:PipelineID=be26d0dd-802f-4608-9a1c-385ef22ed913 close command to datanode 0e99e1b0-220f-42bd-a39f-d4658f80d0e4
datanode_4_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupRemoveAsync(RaftServerProxy.java:404)
datanode_5_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupManagement(RaftServerProxy.java:350)
datanode_2_1  | 2020-04-17 18:55:39,750 [Command processor thread] INFO impl.RaftServerImpl: 0e99e1b0-220f-42bd-a39f-d4658f80d0e4@group-CFD51574C841: closes. applyIndex: 0
datanode_4_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupManagementAsync(RaftServerProxy.java:367)
datanode_2_1  | 2020-04-17 18:55:39,750 [0e99e1b0-220f-42bd-a39f-d4658f80d0e4@group-CFD51574C841-SegmentedRaftLogWorker] INFO segmented.SegmentedRaftLogWorker: 0e99e1b0-220f-42bd-a39f-d4658f80d0e4@group-CFD51574C841-SegmentedRaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
scm_1         | 2020-04-17 18:52:04,921 [RatisPipelineUtilsThread] INFO pipeline.RatisPipelineProvider: Send pipeline:PipelineID=be26d0dd-802f-4608-9a1c-385ef22ed913 close command to datanode a0acbcec-d753-414c-b077-647d02aaa7fb
datanode_6_1  | 2020-04-17 18:50:47,233 [79669a1f-2445-496e-a337-3115205f3ae5@group-F5BD6C5F0281-LeaderElection2] INFO server.RaftServerConfigKeys: raft.server.log.appender.buffer.element-limit = 1 (custom)
datanode_5_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.XceiverServerRatis.removeGroup(XceiverServerRatis.java:657)
datanode_4_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupManagement(RaftServerProxy.java:350)
datanode_2_1  | 2020-04-17 18:55:39,755 [Command processor thread] INFO segmented.SegmentedRaftLogWorker: 0e99e1b0-220f-42bd-a39f-d4658f80d0e4@group-CFD51574C841-SegmentedRaftLogWorker close()
scm_1         | 2020-04-17 18:52:04,921 [RatisPipelineUtilsThread] INFO pipeline.RatisPipelineProvider: Send pipeline:PipelineID=be26d0dd-802f-4608-9a1c-385ef22ed913 close command to datanode 978c057e-5c38-4e20-8a8b-f271c823af7e
datanode_6_1  | 2020-04-17 18:50:47,233 [79669a1f-2445-496e-a337-3115205f3ae5@group-F5BD6C5F0281-LeaderElection2] INFO grpc.GrpcConfigKeys: raft.grpc.server.leader.outstanding.appends.max = 128 (default)
datanode_2_1  | 2020-04-17 18:55:39,756 [Command processor thread] INFO metrics.RatisMetrics: Unregistering Metrics Registry : ratis.log_worker.0e99e1b0-220f-42bd-a39f-d4658f80d0e4
scm_1         | 2020-04-17 18:52:04,921 [RatisPipelineUtilsThread] ERROR pipeline.SCMPipelineManager: Destroy pipeline failed for pipeline:Pipeline[ Id: be26d0dd-802f-4608-9a1c-385ef22ed913, Nodes: 0e99e1b0-220f-42bd-a39f-d4658f80d0e4{ip: 10.5.0.5, host: ozone-topology_datanode_2_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}a0acbcec-d753-414c-b077-647d02aaa7fb{ip: 10.5.0.7, host: ozone-topology_datanode_4_1.ozone-topology_net, networkLocation: /rack2, certSerialId: null}978c057e-5c38-4e20-8a8b-f271c823af7e{ip: 10.5.0.8, host: ozone-topology_datanode_5_1.ozone-topology_net, networkLocation: /rack2, certSerialId: null}, Type:RATIS, Factor:THREE, State:CLOSED, leaderId:a0acbcec-d753-414c-b077-647d02aaa7fb, CreationTimestamp2020-04-17T18:50:39.512923Z]
datanode_5_1  | 	... 4 more
datanode_6_1  | 2020-04-17 18:50:47,233 [79669a1f-2445-496e-a337-3115205f3ae5@group-F5BD6C5F0281-LeaderElection2] INFO server.RaftServerConfigKeys: raft.server.rpc.request.timeout = 60s (custom)
datanode_4_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.XceiverServerRatis.removeGroup(XceiverServerRatis.java:657)
datanode_2_1  | 2020-04-17 18:55:39,756 [Command processor thread] INFO metrics.RatisMetrics: Unregistering Metrics Registry : ratis.leader_election.0e99e1b0-220f-42bd-a39f-d4658f80d0e4@group-CFD51574C841
scm_1         | org.apache.hadoop.hdds.scm.pipeline.PipelineNotFoundException: PipelineID=be26d0dd-802f-4608-9a1c-385ef22ed913 not found
datanode_5_1  | 2020-04-17 18:54:12,561 [ChunkWriter-41-0] INFO keyvalue.KeyValueHandler: Operation: CreateContainer , Trace ID: 25f4cbb29a905ffd:e4110cf328601a91:25f4cbb29a905ffd:0 , Message: Container creation failed, due to disk out of space , Result: DISK_OUT_OF_SPACE , StorageContainerException Occurred.
datanode_6_1  | 2020-04-17 18:50:47,233 [79669a1f-2445-496e-a337-3115205f3ae5@group-F5BD6C5F0281-LeaderElection2] INFO server.RaftServerConfigKeys: raft.server.log.appender.install.snapshot.enabled = false (custom)
datanode_4_1  | 	... 4 more
datanode_2_1  | 2020-04-17 18:55:39,756 [Command processor thread] INFO metrics.RatisMetrics: Unregistering Metrics Registry : ratis.server.0e99e1b0-220f-42bd-a39f-d4658f80d0e4@group-CFD51574C841
scm_1         | 	at org.apache.hadoop.hdds.scm.pipeline.PipelineStateMap.getPipeline(PipelineStateMap.java:133)
datanode_5_1  | org.apache.hadoop.hdds.scm.container.common.helpers.StorageContainerException: Container creation failed, due to disk out of space
datanode_6_1  | 2020-04-17 18:50:47,255 [79669a1f-2445-496e-a337-3115205f3ae5@group-F5BD6C5F0281-LeaderElection2] INFO impl.RoleInfo: 79669a1f-2445-496e-a337-3115205f3ae5: start LeaderState
datanode_4_1  | 2020-04-17 18:52:30,033 [Command processor thread] INFO impl.RaftServerProxy: a0acbcec-d753-414c-b077-647d02aaa7fb: remove group-385EF22ED913:null
datanode_2_1  | 2020-04-17 18:55:39,757 [Command processor thread] INFO commandhandler.ClosePipelineCommandHandler: Close Pipeline #id: "825f4d0e-2629-43e6-a52f-cfd51574c841"
scm_1         | 	at org.apache.hadoop.hdds.scm.pipeline.PipelineStateMap.removePipeline(PipelineStateMap.java:323)
datanode_5_1  | 	at org.apache.hadoop.ozone.container.keyvalue.KeyValueContainer.create(KeyValueContainer.java:165)
datanode_6_1  | 2020-04-17 18:50:47,257 [79669a1f-2445-496e-a337-3115205f3ae5@group-F5BD6C5F0281-LeaderElection2] INFO segmented.SegmentedRaftLogWorker: 79669a1f-2445-496e-a337-3115205f3ae5@group-F5BD6C5F0281-SegmentedRaftLogWorker: Starting segment from index:0
datanode_4_1  | 2020-04-17 18:52:30,033 [Command processor thread] ERROR commandhandler.ClosePipelineCommandHandler: Can't close pipeline #id: "be26d0dd-802f-4608-9a1c-385ef22ed913"
datanode_2_1  |  command on datanode #0e99e1b0-220f-42bd-a39f-d4658f80d0e4.
scm_1         | 	at org.apache.hadoop.hdds.scm.pipeline.PipelineStateManager.removePipeline(PipelineStateManager.java:104)
datanode_5_1  | 	at org.apache.hadoop.ozone.container.keyvalue.KeyValueHandler.handleCreateContainer(KeyValueHandler.java:247)
datanode_6_1  | 2020-04-17 18:50:47,285 [79669a1f-2445-496e-a337-3115205f3ae5@group-F5BD6C5F0281-LeaderElection2] INFO impl.RaftServerImpl: 79669a1f-2445-496e-a337-3115205f3ae5@group-F5BD6C5F0281: set configuration 0: [b23d8fb0-3698-40b4-ac98-17b8605a770b:10.5.0.4:9858, 32863f73-3555-4b23-932a-0d28eb668aea:10.5.0.6:9858, 79669a1f-2445-496e-a337-3115205f3ae5:10.5.0.9:9858], old=null at 0
datanode_4_1  | 
datanode_2_1  | 2020-04-17 18:55:39,757 [Command processor thread] INFO impl.RaftServerProxy: 0e99e1b0-220f-42bd-a39f-d4658f80d0e4: remove group-CFD51574C841:null
scm_1         | 	at org.apache.hadoop.hdds.scm.pipeline.SCMPipelineManager.removePipeline(SCMPipelineManager.java:595)
datanode_5_1  | 	at org.apache.hadoop.ozone.container.keyvalue.KeyValueHandler.dispatchRequest(KeyValueHandler.java:164)
datanode_6_1  | 2020-04-17 18:50:47,397 [79669a1f-2445-496e-a337-3115205f3ae5@group-E8C5921C502F-SegmentedRaftLogWorker] INFO segmented.SegmentedRaftLogWorker: 79669a1f-2445-496e-a337-3115205f3ae5@group-E8C5921C502F-SegmentedRaftLogWorker: created new log segment /data/metadata/ratis/475144cc-6599-45a9-b1c7-e8c5921c502f/current/log_inprogress_0
datanode_4_1  | java.io.IOException: a0acbcec-d753-414c-b077-647d02aaa7fb: Group group-385EF22ED913 not found.
datanode_2_1  | 2020-04-17 18:55:39,757 [Command processor thread] ERROR commandhandler.ClosePipelineCommandHandler: Can't close pipeline #id: "825f4d0e-2629-43e6-a52f-cfd51574c841"
scm_1         | 	at org.apache.hadoop.hdds.scm.pipeline.SCMPipelineManager.destroyPipeline(SCMPipelineManager.java:579)
datanode_5_1  | 	at org.apache.hadoop.ozone.container.keyvalue.KeyValueHandler.handle(KeyValueHandler.java:152)
datanode_6_1  | 2020-04-17 18:50:47,397 [79669a1f-2445-496e-a337-3115205f3ae5@group-F5BD6C5F0281-SegmentedRaftLogWorker] INFO segmented.SegmentedRaftLogWorker: 79669a1f-2445-496e-a337-3115205f3ae5@group-F5BD6C5F0281-SegmentedRaftLogWorker: created new log segment /data/metadata/ratis/315eee3a-6983-45b7-a699-f5bd6c5f0281/current/log_inprogress_0
datanode_4_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.XceiverServerRatis.removeGroup(XceiverServerRatis.java:659)
datanode_2_1  | 
scm_1         | 	at org.apache.hadoop.hdds.scm.pipeline.SCMPipelineManager.lambda$finalizeAndDestroyPipeline$0(SCMPipelineManager.java:422)
datanode_5_1  | 	at org.apache.hadoop.ozone.container.common.impl.HddsDispatcher.createContainer(HddsDispatcher.java:414)
datanode_6_1  | 2020-04-17 18:53:58,308 [Command processor thread] INFO impl.RaftServerProxy: 79669a1f-2445-496e-a337-3115205f3ae5: addNew group-CFD51574C841:[978c057e-5c38-4e20-8a8b-f271c823af7e:10.5.0.8:9858, 79669a1f-2445-496e-a337-3115205f3ae5:10.5.0.9:9858, 0e99e1b0-220f-42bd-a39f-d4658f80d0e4:10.5.0.5:9858] returns group-CFD51574C841:java.util.concurrent.CompletableFuture@3f577fb1[Not completed]
datanode_4_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.ClosePipelineCommandHandler.handle(ClosePipelineCommandHandler.java:77)
datanode_2_1  | java.io.IOException: 0e99e1b0-220f-42bd-a39f-d4658f80d0e4: Group group-CFD51574C841 not found.
scm_1         | 	at org.apache.hadoop.hdds.utils.Scheduler.lambda$schedule$1(Scheduler.java:70)
datanode_5_1  | 	at org.apache.hadoop.ozone.container.common.impl.HddsDispatcher.dispatchRequest(HddsDispatcher.java:250)
datanode_6_1  | 2020-04-17 18:53:58,310 [pool-69-thread-1] INFO impl.RaftServerImpl: 79669a1f-2445-496e-a337-3115205f3ae5: new RaftServerImpl for group-CFD51574C841:[978c057e-5c38-4e20-8a8b-f271c823af7e:10.5.0.8:9858, 79669a1f-2445-496e-a337-3115205f3ae5:10.5.0.9:9858, 0e99e1b0-220f-42bd-a39f-d4658f80d0e4:10.5.0.5:9858] with ContainerStateMachine:uninitialized
datanode_2_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.XceiverServerRatis.removeGroup(XceiverServerRatis.java:659)
scm_1         | 	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
datanode_5_1  | 	at org.apache.hadoop.ozone.container.common.impl.HddsDispatcher.dispatch(HddsDispatcher.java:162)
datanode_6_1  | 2020-04-17 18:53:58,312 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.rpc.timeout.min = 5s (custom)
datanode_4_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.CommandDispatcher.handle(CommandDispatcher.java:99)
datanode_2_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.ClosePipelineCommandHandler.handle(ClosePipelineCommandHandler.java:77)
datanode_5_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.ContainerStateMachine.dispatchCommand(ContainerStateMachine.java:402)
datanode_5_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.ContainerStateMachine.runCommand(ContainerStateMachine.java:412)
scm_1         | 	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
datanode_2_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.CommandDispatcher.handle(CommandDispatcher.java:99)
datanode_5_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.ContainerStateMachine.lambda$handleWriteChunk$2(ContainerStateMachine.java:447)
datanode_6_1  | 2020-04-17 18:53:58,312 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.rpc.timeout.max = 5200ms (custom)
datanode_4_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.lambda$initCommandHandlerThread$1(DatanodeStateMachine.java:472)
scm_1         | 	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:304)
datanode_2_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.lambda$initCommandHandlerThread$1(DatanodeStateMachine.java:472)
datanode_5_1  | 	at java.base/java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1700)
datanode_6_1  | 2020-04-17 18:53:58,312 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.rpcslowness.timeout = 300s (custom)
datanode_4_1  | 	at java.base/java.lang.Thread.run(Thread.java:834)
scm_1         | 	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
scm_1         | 	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
datanode_2_1  | 	at java.base/java.lang.Thread.run(Thread.java:834)
datanode_6_1  | 2020-04-17 18:53:58,313 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.sleep.deviation.threshold = 300 (default)
datanode_4_1  | Caused by: org.apache.ratis.protocol.GroupMismatchException: a0acbcec-d753-414c-b077-647d02aaa7fb: Group group-385EF22ED913 not found.
scm_1         | 	at java.base/java.lang.Thread.run(Thread.java:834)
datanode_5_1  | 	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
datanode_2_1  | Caused by: org.apache.ratis.protocol.GroupMismatchException: 0e99e1b0-220f-42bd-a39f-d4658f80d0e4: Group group-CFD51574C841 not found.
datanode_6_1  | 2020-04-17 18:53:58,313 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.appender.install.snapshot.enabled = false (custom)
datanode_4_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupRemoveAsync(RaftServerProxy.java:404)
scm_1         | 2020-04-17 18:52:04,946 [RatisPipelineUtilsThread] INFO pipeline.RatisPipelineProvider: Send pipeline:PipelineID=be26d0dd-802f-4608-9a1c-385ef22ed913 close command to datanode 0e99e1b0-220f-42bd-a39f-d4658f80d0e4
datanode_5_1  | 	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
datanode_2_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupRemoveAsync(RaftServerProxy.java:404)
datanode_6_1  | 2020-04-17 18:53:58,313 [pool-69-thread-1] INFO impl.RaftServerImpl: 79669a1f-2445-496e-a337-3115205f3ae5@group-CFD51574C841: ConfigurationManager, init=-1: [978c057e-5c38-4e20-8a8b-f271c823af7e:10.5.0.8:9858, 79669a1f-2445-496e-a337-3115205f3ae5:10.5.0.9:9858, 0e99e1b0-220f-42bd-a39f-d4658f80d0e4:10.5.0.5:9858], old=null, confs=<EMPTY_MAP>
datanode_4_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupManagementAsync(RaftServerProxy.java:367)
scm_1         | 2020-04-17 18:52:04,946 [RatisPipelineUtilsThread] INFO pipeline.RatisPipelineProvider: Send pipeline:PipelineID=be26d0dd-802f-4608-9a1c-385ef22ed913 close command to datanode a0acbcec-d753-414c-b077-647d02aaa7fb
datanode_5_1  | 	at java.base/java.lang.Thread.run(Thread.java:834)
datanode_2_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupManagementAsync(RaftServerProxy.java:367)
datanode_6_1  | 2020-04-17 18:53:58,313 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.storage.dir = [/data/metadata/ratis] (custom)
datanode_4_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupManagement(RaftServerProxy.java:350)
scm_1         | 2020-04-17 18:52:04,947 [RatisPipelineUtilsThread] INFO pipeline.RatisPipelineProvider: Send pipeline:PipelineID=be26d0dd-802f-4608-9a1c-385ef22ed913 close command to datanode 978c057e-5c38-4e20-8a8b-f271c823af7e
datanode_5_1  | Caused by: org.apache.hadoop.util.DiskChecker$DiskOutOfSpaceException: Out of space: The volume with the most available space (=964890624 B) is less than the container size (=1073741824 B).
datanode_2_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupManagement(RaftServerProxy.java:350)
datanode_6_1  | 2020-04-17 18:53:58,314 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.corruption.policy = EXCEPTION (default)
datanode_4_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.XceiverServerRatis.removeGroup(XceiverServerRatis.java:657)
scm_1         | 2020-04-17 18:52:04,947 [RatisPipelineUtilsThread] ERROR pipeline.SCMPipelineManager: Destroy pipeline failed for pipeline:Pipeline[ Id: be26d0dd-802f-4608-9a1c-385ef22ed913, Nodes: 0e99e1b0-220f-42bd-a39f-d4658f80d0e4{ip: 10.5.0.5, host: ozone-topology_datanode_2_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}a0acbcec-d753-414c-b077-647d02aaa7fb{ip: 10.5.0.7, host: ozone-topology_datanode_4_1.ozone-topology_net, networkLocation: /rack2, certSerialId: null}978c057e-5c38-4e20-8a8b-f271c823af7e{ip: 10.5.0.8, host: ozone-topology_datanode_5_1.ozone-topology_net, networkLocation: /rack2, certSerialId: null}, Type:RATIS, Factor:THREE, State:CLOSED, leaderId:a0acbcec-d753-414c-b077-647d02aaa7fb, CreationTimestamp2020-04-17T18:50:39.512923Z]
datanode_5_1  | 	at org.apache.hadoop.ozone.container.common.volume.RoundRobinVolumeChoosingPolicy.chooseVolume(RoundRobinVolumeChoosingPolicy.java:77)
datanode_2_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.XceiverServerRatis.removeGroup(XceiverServerRatis.java:657)
datanode_6_1  | 2020-04-17 18:53:58,314 [pool-69-thread-1] INFO storage.RaftStorageDirectory: The storage directory /data/metadata/ratis/825f4d0e-2629-43e6-a52f-cfd51574c841 does not exist. Creating ...
datanode_4_1  | 	... 4 more
scm_1         | org.apache.hadoop.hdds.scm.pipeline.PipelineNotFoundException: PipelineID=be26d0dd-802f-4608-9a1c-385ef22ed913 not found
datanode_2_1  | 	... 4 more
datanode_6_1  | 2020-04-17 18:53:58,316 [pool-69-thread-1] INFO storage.RaftStorageDirectory: Lock on /data/metadata/ratis/825f4d0e-2629-43e6-a52f-cfd51574c841/in_use.lock acquired by nodename 6@9608d796128b
datanode_5_1  | 	at org.apache.hadoop.ozone.container.keyvalue.KeyValueContainer.create(KeyValueContainer.java:124)
datanode_4_1  | 2020-04-17 18:52:30,034 [Command processor thread] INFO impl.RaftServerProxy: a0acbcec-d753-414c-b077-647d02aaa7fb: remove group-385EF22ED913:null
scm_1         | 	at org.apache.hadoop.hdds.scm.pipeline.PipelineStateMap.getPipeline(PipelineStateMap.java:133)
datanode_2_1  | 2020-04-17 18:55:39,757 [Command processor thread] INFO impl.RaftServerProxy: 0e99e1b0-220f-42bd-a39f-d4658f80d0e4: remove group-CFD51574C841:null
datanode_6_1  | 2020-04-17 18:53:58,317 [pool-69-thread-1] INFO storage.RaftStorage: Storage directory /data/metadata/ratis/825f4d0e-2629-43e6-a52f-cfd51574c841 has been successfully formatted.
datanode_5_1  | 	... 13 more
datanode_4_1  | 2020-04-17 18:52:30,034 [Command processor thread] ERROR commandhandler.ClosePipelineCommandHandler: Can't close pipeline #id: "be26d0dd-802f-4608-9a1c-385ef22ed913"
scm_1         | 	at org.apache.hadoop.hdds.scm.pipeline.PipelineStateMap.removePipeline(PipelineStateMap.java:323)
datanode_2_1  | 2020-04-17 18:55:39,758 [Command processor thread] ERROR commandhandler.ClosePipelineCommandHandler: Can't close pipeline #id: "825f4d0e-2629-43e6-a52f-cfd51574c841"
datanode_6_1  | 2020-04-17 18:53:58,318 [pool-69-thread-1] INFO ratis.ContainerStateMachine: group-CFD51574C841: The snapshot info is null. Setting the last applied indexto:(t:0, i:~)
datanode_5_1  | 2020-04-17 18:54:12,561 [ChunkWriter-41-0] INFO impl.HddsDispatcher: Operation: WriteChunk , Trace ID: 25f4cbb29a905ffd:e4110cf328601a91:25f4cbb29a905ffd:0 , Message: ContainerID 4 creation failed , Result: DISK_OUT_OF_SPACE , StorageContainerException Occurred.
datanode_4_1  | 
scm_1         | 	at org.apache.hadoop.hdds.scm.pipeline.PipelineStateManager.removePipeline(PipelineStateManager.java:104)
datanode_2_1  | 
datanode_6_1  | 2020-04-17 18:53:58,318 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.notification.no-leader.timeout = 60s (default)
datanode_5_1  | org.apache.hadoop.hdds.scm.container.common.helpers.StorageContainerException: ContainerID 4 creation failed
datanode_4_1  | java.io.IOException: a0acbcec-d753-414c-b077-647d02aaa7fb: Group group-385EF22ED913 not found.
scm_1         | 	at org.apache.hadoop.hdds.scm.pipeline.SCMPipelineManager.removePipeline(SCMPipelineManager.java:595)
datanode_2_1  | java.io.IOException: 0e99e1b0-220f-42bd-a39f-d4658f80d0e4: Group group-CFD51574C841 not found.
datanode_6_1  | 2020-04-17 18:53:58,321 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.use.memory = false (default)
datanode_5_1  | 	at org.apache.hadoop.ozone.container.common.impl.HddsDispatcher.dispatchRequest(HddsDispatcher.java:254)
datanode_4_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.XceiverServerRatis.removeGroup(XceiverServerRatis.java:659)
scm_1         | 	at org.apache.hadoop.hdds.scm.pipeline.SCMPipelineManager.destroyPipeline(SCMPipelineManager.java:579)
datanode_2_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.XceiverServerRatis.removeGroup(XceiverServerRatis.java:659)
datanode_4_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.ClosePipelineCommandHandler.handle(ClosePipelineCommandHandler.java:77)
datanode_6_1  | 2020-04-17 18:53:58,321 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.purge.gap = 1000000 (custom)
scm_1         | 	at org.apache.hadoop.hdds.scm.pipeline.SCMPipelineManager.lambda$finalizeAndDestroyPipeline$0(SCMPipelineManager.java:422)
datanode_5_1  | 	at org.apache.hadoop.ozone.container.common.impl.HddsDispatcher.dispatch(HddsDispatcher.java:162)
datanode_2_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.ClosePipelineCommandHandler.handle(ClosePipelineCommandHandler.java:77)
datanode_4_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.CommandDispatcher.handle(CommandDispatcher.java:99)
datanode_6_1  | 2020-04-17 18:53:58,321 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
scm_1         | 	at org.apache.hadoop.hdds.utils.Scheduler.lambda$schedule$1(Scheduler.java:70)
datanode_2_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.CommandDispatcher.handle(CommandDispatcher.java:99)
datanode_6_1  | 2020-04-17 18:53:58,322 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.segment.size.max = 1048576 (custom)
scm_1         | 	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
datanode_5_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.ContainerStateMachine.dispatchCommand(ContainerStateMachine.java:402)
datanode_4_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.lambda$initCommandHandlerThread$1(DatanodeStateMachine.java:472)
datanode_2_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.lambda$initCommandHandlerThread$1(DatanodeStateMachine.java:472)
datanode_6_1  | 2020-04-17 18:53:58,322 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.segment.cache.num.max = 2 (custom)
scm_1         | 	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
datanode_5_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.ContainerStateMachine.runCommand(ContainerStateMachine.java:412)
datanode_4_1  | 	at java.base/java.lang.Thread.run(Thread.java:834)
datanode_2_1  | 	at java.base/java.lang.Thread.run(Thread.java:834)
datanode_6_1  | 2020-04-17 18:53:58,322 [pool-69-thread-1] INFO segmented.SegmentedRaftLogWorker: new 79669a1f-2445-496e-a337-3115205f3ae5@group-CFD51574C841-SegmentedRaftLogWorker for RaftStorage:Storage Directory /data/metadata/ratis/825f4d0e-2629-43e6-a52f-cfd51574c841
scm_1         | 	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:304)
datanode_5_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.ContainerStateMachine.lambda$handleWriteChunk$2(ContainerStateMachine.java:447)
datanode_4_1  | Caused by: org.apache.ratis.protocol.GroupMismatchException: a0acbcec-d753-414c-b077-647d02aaa7fb: Group group-385EF22ED913 not found.
datanode_2_1  | Caused by: org.apache.ratis.protocol.GroupMismatchException: 0e99e1b0-220f-42bd-a39f-d4658f80d0e4: Group group-CFD51574C841 not found.
datanode_6_1  | 2020-04-17 18:53:58,322 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.queue.byte-limit = 2147483647 (custom)
scm_1         | 	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
datanode_5_1  | 	at java.base/java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1700)
datanode_4_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupRemoveAsync(RaftServerProxy.java:404)
datanode_2_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupRemoveAsync(RaftServerProxy.java:404)
datanode_5_1  | 	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
datanode_4_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupManagementAsync(RaftServerProxy.java:367)
scm_1         | 	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
datanode_6_1  | 2020-04-17 18:53:58,322 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.queue.element-limit = 1024 (custom)
datanode_2_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupManagementAsync(RaftServerProxy.java:367)
datanode_5_1  | 	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
datanode_4_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupManagement(RaftServerProxy.java:350)
scm_1         | 	at java.base/java.lang.Thread.run(Thread.java:834)
datanode_6_1  | 2020-04-17 18:53:58,322 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.segment.size.max = 1048576 (custom)
datanode_2_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupManagement(RaftServerProxy.java:350)
datanode_5_1  | 	at java.base/java.lang.Thread.run(Thread.java:834)
datanode_4_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.XceiverServerRatis.removeGroup(XceiverServerRatis.java:657)
scm_1         | 2020-04-17 18:52:04,990 [RatisPipelineUtilsThread] INFO pipeline.RatisPipelineProvider: Send pipeline:PipelineID=be26d0dd-802f-4608-9a1c-385ef22ed913 close command to datanode 0e99e1b0-220f-42bd-a39f-d4658f80d0e4
datanode_6_1  | 2020-04-17 18:53:58,322 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.preallocated.size = 16384 (custom)
datanode_6_1  | 2020-04-17 18:53:58,322 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.write.buffer.size = 1048576 (custom)
datanode_2_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.XceiverServerRatis.removeGroup(XceiverServerRatis.java:657)
datanode_4_1  | 	... 4 more
scm_1         | 2020-04-17 18:52:04,991 [RatisPipelineUtilsThread] INFO pipeline.RatisPipelineProvider: Send pipeline:PipelineID=be26d0dd-802f-4608-9a1c-385ef22ed913 close command to datanode a0acbcec-d753-414c-b077-647d02aaa7fb
datanode_6_1  | 2020-04-17 18:53:58,322 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.force.sync.num = 128 (default)
datanode_5_1  | 2020-04-17 18:54:12,562 [ChunkWriter-41-0] ERROR ratis.ContainerStateMachine: group-CFD51574C841: writeChunk writeStateMachineData failed: blockIdcontainerID: 4
datanode_2_1  | 	... 4 more
datanode_4_1  | 2020-04-17 18:52:30,037 [Command processor thread] INFO impl.RaftServerProxy: a0acbcec-d753-414c-b077-647d02aaa7fb: remove group-385EF22ED913:null
scm_1         | 2020-04-17 18:52:04,991 [RatisPipelineUtilsThread] INFO pipeline.RatisPipelineProvider: Send pipeline:PipelineID=be26d0dd-802f-4608-9a1c-385ef22ed913 close command to datanode 978c057e-5c38-4e20-8a8b-f271c823af7e
datanode_6_1  | 2020-04-17 18:53:58,322 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.statemachine.data.sync = true (default)
datanode_5_1  | localID: 104015439626764310
datanode_2_1  | 2020-04-17 18:55:39,758 [Command processor thread] INFO impl.RaftServerProxy: 0e99e1b0-220f-42bd-a39f-d4658f80d0e4: remove group-CFD51574C841:null
datanode_4_1  | 2020-04-17 18:52:30,037 [Command processor thread] ERROR commandhandler.ClosePipelineCommandHandler: Can't close pipeline #id: "be26d0dd-802f-4608-9a1c-385ef22ed913"
scm_1         | 2020-04-17 18:52:04,991 [RatisPipelineUtilsThread] ERROR pipeline.SCMPipelineManager: Destroy pipeline failed for pipeline:Pipeline[ Id: be26d0dd-802f-4608-9a1c-385ef22ed913, Nodes: 0e99e1b0-220f-42bd-a39f-d4658f80d0e4{ip: 10.5.0.5, host: ozone-topology_datanode_2_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}a0acbcec-d753-414c-b077-647d02aaa7fb{ip: 10.5.0.7, host: ozone-topology_datanode_4_1.ozone-topology_net, networkLocation: /rack2, certSerialId: null}978c057e-5c38-4e20-8a8b-f271c823af7e{ip: 10.5.0.8, host: ozone-topology_datanode_5_1.ozone-topology_net, networkLocation: /rack2, certSerialId: null}, Type:RATIS, Factor:THREE, State:CLOSED, leaderId:a0acbcec-d753-414c-b077-647d02aaa7fb, CreationTimestamp2020-04-17T18:50:39.512923Z]
datanode_6_1  | 2020-04-17 18:53:58,322 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.statemachine.data.sync.timeout = 10s (default)
datanode_5_1  | blockCommitSequenceId: 0
datanode_2_1  | 2020-04-17 18:55:39,758 [Command processor thread] ERROR commandhandler.ClosePipelineCommandHandler: Can't close pipeline #id: "825f4d0e-2629-43e6-a52f-cfd51574c841"
datanode_4_1  | 
scm_1         | org.apache.hadoop.hdds.scm.pipeline.PipelineNotFoundException: PipelineID=be26d0dd-802f-4608-9a1c-385ef22ed913 not found
datanode_6_1  | 2020-04-17 18:53:58,322 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
datanode_5_1  |  logIndex 1 chunkName 104015439626764310_chunk_1 Error message: ContainerID 4 creation failed Container Result: DISK_OUT_OF_SPACE
datanode_6_1  | 2020-04-17 18:53:58,325 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.statemachine.data.caching.enabled = true (custom)
datanode_4_1  | java.io.IOException: a0acbcec-d753-414c-b077-647d02aaa7fb: Group group-385EF22ED913 not found.
scm_1         | 	at org.apache.hadoop.hdds.scm.pipeline.PipelineStateMap.getPipeline(PipelineStateMap.java:133)
datanode_5_1  | 2020-04-17 18:54:12,562 [978c057e-5c38-4e20-8a8b-f271c823af7e@group-CFD51574C841-SegmentedRaftLogWorker] ERROR ratis.XceiverServerRatis: pipeline Action CLOSE on pipeline PipelineID=825f4d0e-2629-43e6-a52f-cfd51574c841.Reason : ContainerID 4 creation failed
datanode_6_1  | 2020-04-17 18:53:58,327 [pool-69-thread-1] INFO segmented.SegmentedRaftLogWorker: 79669a1f-2445-496e-a337-3115205f3ae5@group-CFD51574C841-SegmentedRaftLogWorker: flushIndex: setUnconditionally 0 -> -1
datanode_4_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.XceiverServerRatis.removeGroup(XceiverServerRatis.java:659)
datanode_2_1  | 
scm_1         | 	at org.apache.hadoop.hdds.scm.pipeline.PipelineStateMap.removePipeline(PipelineStateMap.java:323)
datanode_5_1  | 2020-04-17 18:54:12,599 [978c057e-5c38-4e20-8a8b-f271c823af7e@group-CFD51574C841-SegmentedRaftLogWorker] ERROR ratis.XceiverServerRatis: pipeline Action CLOSE on pipeline PipelineID=825f4d0e-2629-43e6-a52f-cfd51574c841.Reason : Log already failed at index 1 for task WriteLog:1: (t:1, i:1), STATEMACHINELOGENTRY, client-191241DA7A93, cid=70
datanode_6_1  | 2020-04-17 18:53:58,327 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.snapshot.auto.trigger.enabled = true (custom)
datanode_4_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.ClosePipelineCommandHandler.handle(ClosePipelineCommandHandler.java:77)
datanode_2_1  | java.io.IOException: 0e99e1b0-220f-42bd-a39f-d4658f80d0e4: Group group-CFD51574C841 not found.
scm_1         | 	at org.apache.hadoop.hdds.scm.pipeline.PipelineStateManager.removePipeline(PipelineStateManager.java:104)
datanode_5_1  | 	 State Machine: cmdType: WriteChunk traceID: "25f4cbb29a905ffd:e4110cf328601a91:25f4cbb29a905ffd:0" containerID: 4 datanodeUuid: "978c057e-5c38-4e20-8a8b-f271c823af7e" pipelineID: "825f4d0e-2629-43e6-a52f-cfd51574c841" writeChunk { blockID { containerID: 4 localID: 104015439626764310 blockCommitSequenceId: 0 } chunkData { chunkName: "104015439626764310_chunk_1" offset: 0 len: 10240 checksumData { type: CRC32 bytesPerChecksum: 1048576 checksums: ">\344\315\231" } } }, container path=nonexistent
datanode_4_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.CommandDispatcher.handle(CommandDispatcher.java:99)
datanode_6_1  | 2020-04-17 18:53:58,327 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
datanode_2_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.XceiverServerRatis.removeGroup(XceiverServerRatis.java:659)
scm_1         | 	at org.apache.hadoop.hdds.scm.pipeline.SCMPipelineManager.removePipeline(SCMPipelineManager.java:595)
datanode_5_1  | 2020-04-17 18:54:29,346 [Command processor thread] INFO impl.RaftServerProxy: 978c057e-5c38-4e20-8a8b-f271c823af7e: remove group-79E0035D853A:null
datanode_4_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.lambda$initCommandHandlerThread$1(DatanodeStateMachine.java:472)
datanode_6_1  | 2020-04-17 18:53:58,327 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.snapshot.retention.file.num = 5 (custom)
datanode_2_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.ClosePipelineCommandHandler.handle(ClosePipelineCommandHandler.java:77)
scm_1         | 	at org.apache.hadoop.hdds.scm.pipeline.SCMPipelineManager.destroyPipeline(SCMPipelineManager.java:579)
datanode_5_1  | 2020-04-17 18:54:29,347 [Command processor thread] ERROR commandhandler.ClosePipelineCommandHandler: Can't close pipeline #id: "cad403d1-ea2f-4530-84e5-79e0035d853a"
datanode_4_1  | 	at java.base/java.lang.Thread.run(Thread.java:834)
datanode_6_1  | 2020-04-17 18:53:58,327 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.retrycache.expirytime = 600000ms (custom)
datanode_2_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.CommandDispatcher.handle(CommandDispatcher.java:99)
scm_1         | 	at org.apache.hadoop.hdds.scm.pipeline.SCMPipelineManager.lambda$finalizeAndDestroyPipeline$0(SCMPipelineManager.java:422)
datanode_5_1  | 
datanode_4_1  | Caused by: org.apache.ratis.protocol.GroupMismatchException: a0acbcec-d753-414c-b077-647d02aaa7fb: Group group-385EF22ED913 not found.
datanode_6_1  | 2020-04-17 18:53:58,328 [pool-69-thread-1] INFO metrics.RatisMetrics: Creating Metrics Registry : ratis.leader_election.79669a1f-2445-496e-a337-3115205f3ae5@group-CFD51574C841
datanode_2_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.lambda$initCommandHandlerThread$1(DatanodeStateMachine.java:472)
scm_1         | 	at org.apache.hadoop.hdds.utils.Scheduler.lambda$schedule$1(Scheduler.java:70)
datanode_5_1  | java.io.IOException: 978c057e-5c38-4e20-8a8b-f271c823af7e: Group group-79E0035D853A not found.
datanode_4_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupRemoveAsync(RaftServerProxy.java:404)
datanode_6_1  | 2020-04-17 18:53:58,328 [pool-69-thread-1] INFO metrics.RatisMetrics: Creating Metrics Registry : ratis.server.79669a1f-2445-496e-a337-3115205f3ae5@group-CFD51574C841
datanode_2_1  | 	at java.base/java.lang.Thread.run(Thread.java:834)
scm_1         | 	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
datanode_5_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.XceiverServerRatis.removeGroup(XceiverServerRatis.java:659)
datanode_4_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupManagementAsync(RaftServerProxy.java:367)
datanode_6_1  | 2020-04-17 18:53:58,329 [pool-69-thread-1] INFO impl.RaftServerImpl: 79669a1f-2445-496e-a337-3115205f3ae5@group-CFD51574C841: start as a follower, conf=-1: [978c057e-5c38-4e20-8a8b-f271c823af7e:10.5.0.8:9858, 79669a1f-2445-496e-a337-3115205f3ae5:10.5.0.9:9858, 0e99e1b0-220f-42bd-a39f-d4658f80d0e4:10.5.0.5:9858], old=null
datanode_2_1  | Caused by: org.apache.ratis.protocol.GroupMismatchException: 0e99e1b0-220f-42bd-a39f-d4658f80d0e4: Group group-CFD51574C841 not found.
scm_1         | 	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
datanode_5_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.ClosePipelineCommandHandler.handle(ClosePipelineCommandHandler.java:77)
datanode_4_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupManagement(RaftServerProxy.java:350)
datanode_6_1  | 2020-04-17 18:53:58,329 [pool-69-thread-1] INFO impl.RaftServerImpl: 79669a1f-2445-496e-a337-3115205f3ae5@group-CFD51574C841: changes role from      null to FOLLOWER at term 0 for startAsFollower
datanode_2_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupRemoveAsync(RaftServerProxy.java:404)
datanode_5_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.CommandDispatcher.handle(CommandDispatcher.java:99)
datanode_6_1  | 2020-04-17 18:53:58,329 [pool-69-thread-1] INFO impl.RoleInfo: 79669a1f-2445-496e-a337-3115205f3ae5: start FollowerState
datanode_2_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupManagementAsync(RaftServerProxy.java:367)
scm_1         | 	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:304)
datanode_4_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.XceiverServerRatis.removeGroup(XceiverServerRatis.java:657)
datanode_5_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.lambda$initCommandHandlerThread$1(DatanodeStateMachine.java:472)
datanode_6_1  | 2020-04-17 18:53:58,330 [pool-69-thread-1] INFO util.JmxRegister: Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-CFD51574C841,id=79669a1f-2445-496e-a337-3115205f3ae5
datanode_2_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupManagement(RaftServerProxy.java:350)
scm_1         | 	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
datanode_4_1  | 	... 4 more
datanode_5_1  | 	at java.base/java.lang.Thread.run(Thread.java:834)
datanode_5_1  | Caused by: org.apache.ratis.protocol.GroupMismatchException: 978c057e-5c38-4e20-8a8b-f271c823af7e: Group group-79E0035D853A not found.
datanode_2_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.XceiverServerRatis.removeGroup(XceiverServerRatis.java:657)
scm_1         | 	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
datanode_4_1  | 2020-04-17 18:52:30,037 [Command processor thread] INFO impl.RaftServerProxy: a0acbcec-d753-414c-b077-647d02aaa7fb: remove group-385EF22ED913:null
datanode_5_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupRemoveAsync(RaftServerProxy.java:404)
datanode_6_1  | 2020-04-17 18:53:58,330 [pool-69-thread-1] INFO metrics.RatisMetrics: Creating Metrics Registry : ratis.state_machine.79669a1f-2445-496e-a337-3115205f3ae5@group-CFD51574C841
datanode_2_1  | 	... 4 more
scm_1         | 	at java.base/java.lang.Thread.run(Thread.java:834)
datanode_4_1  | 2020-04-17 18:52:30,037 [Command processor thread] ERROR commandhandler.ClosePipelineCommandHandler: Can't close pipeline #id: "be26d0dd-802f-4608-9a1c-385ef22ed913"
datanode_5_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupManagementAsync(RaftServerProxy.java:367)
datanode_6_1  | 2020-04-17 18:53:58,450 [Command processor thread] INFO commandhandler.CreatePipelineCommandHandler: Created Pipeline RATIS THREE #id: "825f4d0e-2629-43e6-a52f-cfd51574c841"
datanode_2_1  | 2020-04-17 18:55:39,758 [Command processor thread] INFO impl.RaftServerProxy: 0e99e1b0-220f-42bd-a39f-d4658f80d0e4: remove group-CFD51574C841:null
scm_1         | 2020-04-17 18:52:05,126 [RatisPipelineUtilsThread] INFO pipeline.RatisPipelineProvider: Send pipeline:PipelineID=be26d0dd-802f-4608-9a1c-385ef22ed913 close command to datanode 0e99e1b0-220f-42bd-a39f-d4658f80d0e4
datanode_4_1  | 
datanode_5_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupManagement(RaftServerProxy.java:350)
datanode_6_1  | .
datanode_2_1  | 2020-04-17 18:55:39,759 [Command processor thread] ERROR commandhandler.ClosePipelineCommandHandler: Can't close pipeline #id: "825f4d0e-2629-43e6-a52f-cfd51574c841"
scm_1         | 2020-04-17 18:52:05,126 [RatisPipelineUtilsThread] INFO pipeline.RatisPipelineProvider: Send pipeline:PipelineID=be26d0dd-802f-4608-9a1c-385ef22ed913 close command to datanode a0acbcec-d753-414c-b077-647d02aaa7fb
datanode_4_1  | java.io.IOException: a0acbcec-d753-414c-b077-647d02aaa7fb: Group group-385EF22ED913 not found.
datanode_5_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.XceiverServerRatis.removeGroup(XceiverServerRatis.java:657)
datanode_6_1  | 2020-04-17 18:54:03,502 [grpc-default-executor-1] INFO impl.RaftServerImpl: 79669a1f-2445-496e-a337-3115205f3ae5@group-CFD51574C841: changes role from  FOLLOWER to FOLLOWER at term 1 for recognizeCandidate:0e99e1b0-220f-42bd-a39f-d4658f80d0e4
datanode_2_1  | 
scm_1         | 2020-04-17 18:52:05,126 [RatisPipelineUtilsThread] INFO pipeline.RatisPipelineProvider: Send pipeline:PipelineID=be26d0dd-802f-4608-9a1c-385ef22ed913 close command to datanode 978c057e-5c38-4e20-8a8b-f271c823af7e
datanode_4_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.XceiverServerRatis.removeGroup(XceiverServerRatis.java:659)
datanode_5_1  | 	... 4 more
datanode_6_1  | 2020-04-17 18:54:03,502 [grpc-default-executor-1] INFO impl.RoleInfo: 79669a1f-2445-496e-a337-3115205f3ae5: shutdown FollowerState
datanode_2_1  | java.io.IOException: 0e99e1b0-220f-42bd-a39f-d4658f80d0e4: Group group-CFD51574C841 not found.
scm_1         | 2020-04-17 18:52:05,126 [RatisPipelineUtilsThread] ERROR pipeline.SCMPipelineManager: Destroy pipeline failed for pipeline:Pipeline[ Id: be26d0dd-802f-4608-9a1c-385ef22ed913, Nodes: 0e99e1b0-220f-42bd-a39f-d4658f80d0e4{ip: 10.5.0.5, host: ozone-topology_datanode_2_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}a0acbcec-d753-414c-b077-647d02aaa7fb{ip: 10.5.0.7, host: ozone-topology_datanode_4_1.ozone-topology_net, networkLocation: /rack2, certSerialId: null}978c057e-5c38-4e20-8a8b-f271c823af7e{ip: 10.5.0.8, host: ozone-topology_datanode_5_1.ozone-topology_net, networkLocation: /rack2, certSerialId: null}, Type:RATIS, Factor:THREE, State:CLOSED, leaderId:a0acbcec-d753-414c-b077-647d02aaa7fb, CreationTimestamp2020-04-17T18:50:39.512923Z]
datanode_4_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.ClosePipelineCommandHandler.handle(ClosePipelineCommandHandler.java:77)
datanode_5_1  | 2020-04-17 18:54:29,347 [Command processor thread] ERROR commandhandler.CloseContainerCommandHandler: Container #4 does not exist in datanode. Container close failed.
datanode_6_1  | 2020-04-17 18:54:03,502 [grpc-default-executor-1] INFO impl.RoleInfo: 79669a1f-2445-496e-a337-3115205f3ae5: start FollowerState
datanode_2_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.XceiverServerRatis.removeGroup(XceiverServerRatis.java:659)
scm_1         | org.apache.hadoop.hdds.scm.pipeline.PipelineNotFoundException: PipelineID=be26d0dd-802f-4608-9a1c-385ef22ed913 not found
datanode_4_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.CommandDispatcher.handle(CommandDispatcher.java:99)
datanode_5_1  | 2020-04-17 18:55:39,720 [grpc-default-executor-3] INFO server.GrpcServerProtocolService: 978c057e-5c38-4e20-8a8b-f271c823af7e: Completed APPEND_ENTRIES, lastRequest: 0e99e1b0-220f-42bd-a39f-d4658f80d0e4->978c057e-5c38-4e20-8a8b-f271c823af7e#6-t1, previous=(t:1, i:1), leaderCommit=0, initializing? false, entries: size=1, first=(t:1, i:2), STATEMACHINELOGENTRY, client-191241DA7A93, cid=71
datanode_6_1  | 2020-04-17 18:54:03,503 [Thread-102] INFO impl.FollowerState: 79669a1f-2445-496e-a337-3115205f3ae5@group-CFD51574C841-FollowerState was interrupted: java.lang.InterruptedException: sleep interrupted
datanode_2_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.ClosePipelineCommandHandler.handle(ClosePipelineCommandHandler.java:77)
scm_1         | 	at org.apache.hadoop.hdds.scm.pipeline.PipelineStateMap.getPipeline(PipelineStateMap.java:133)
datanode_4_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.lambda$initCommandHandlerThread$1(DatanodeStateMachine.java:472)
datanode_5_1  | 2020-04-17 18:55:43,600 [Command processor thread] INFO impl.RaftServerProxy: 978c057e-5c38-4e20-8a8b-f271c823af7e: remove  FOLLOWER 978c057e-5c38-4e20-8a8b-f271c823af7e@group-CFD51574C841:t1, leader=0e99e1b0-220f-42bd-a39f-d4658f80d0e4, voted=0e99e1b0-220f-42bd-a39f-d4658f80d0e4, raftlog=978c057e-5c38-4e20-8a8b-f271c823af7e@group-CFD51574C841-SegmentedRaftLog:OPENED:c0,f0,i2, conf=0: [978c057e-5c38-4e20-8a8b-f271c823af7e:10.5.0.8:9858, 79669a1f-2445-496e-a337-3115205f3ae5:10.5.0.9:9858, 0e99e1b0-220f-42bd-a39f-d4658f80d0e4:10.5.0.5:9858], old=null RUNNING
datanode_6_1  | 2020-04-17 18:54:03,574 [grpc-default-executor-1] INFO ratis.XceiverServerRatis: Leader change notification received for group: group-CFD51574C841 with new leaderId: 0e99e1b0-220f-42bd-a39f-d4658f80d0e4
datanode_2_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.CommandDispatcher.handle(CommandDispatcher.java:99)
scm_1         | 	at org.apache.hadoop.hdds.scm.pipeline.PipelineStateMap.removePipeline(PipelineStateMap.java:323)
datanode_4_1  | 	at java.base/java.lang.Thread.run(Thread.java:834)
datanode_5_1  | 2020-04-17 18:55:43,600 [Command processor thread] INFO impl.RaftServerImpl: 978c057e-5c38-4e20-8a8b-f271c823af7e@group-CFD51574C841: shutdown
datanode_6_1  | 2020-04-17 18:54:03,574 [grpc-default-executor-1] INFO impl.RaftServerImpl: 79669a1f-2445-496e-a337-3115205f3ae5@group-CFD51574C841: change Leader from null to 0e99e1b0-220f-42bd-a39f-d4658f80d0e4 at term 1 for appendEntries, leader elected after 5255ms
scm_1         | 	at org.apache.hadoop.hdds.scm.pipeline.PipelineStateManager.removePipeline(PipelineStateManager.java:104)
datanode_2_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.lambda$initCommandHandlerThread$1(DatanodeStateMachine.java:472)
datanode_4_1  | Caused by: org.apache.ratis.protocol.GroupMismatchException: a0acbcec-d753-414c-b077-647d02aaa7fb: Group group-385EF22ED913 not found.
datanode_5_1  | 2020-04-17 18:55:43,600 [Command processor thread] INFO util.JmxRegister: Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-CFD51574C841,id=978c057e-5c38-4e20-8a8b-f271c823af7e
scm_1         | 	at org.apache.hadoop.hdds.scm.pipeline.SCMPipelineManager.removePipeline(SCMPipelineManager.java:595)
datanode_2_1  | 	at java.base/java.lang.Thread.run(Thread.java:834)
datanode_4_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupRemoveAsync(RaftServerProxy.java:404)
datanode_6_1  | 2020-04-17 18:54:03,606 [grpc-default-executor-1] INFO impl.RaftServerImpl: 79669a1f-2445-496e-a337-3115205f3ae5@group-CFD51574C841: set configuration 0: [978c057e-5c38-4e20-8a8b-f271c823af7e:10.5.0.8:9858, 79669a1f-2445-496e-a337-3115205f3ae5:10.5.0.9:9858, 0e99e1b0-220f-42bd-a39f-d4658f80d0e4:10.5.0.5:9858], old=null at 0
datanode_5_1  | 2020-04-17 18:55:43,600 [Command processor thread] INFO impl.RoleInfo: 978c057e-5c38-4e20-8a8b-f271c823af7e: shutdown FollowerState
scm_1         | 	at org.apache.hadoop.hdds.scm.pipeline.SCMPipelineManager.destroyPipeline(SCMPipelineManager.java:579)
datanode_2_1  | Caused by: org.apache.ratis.protocol.GroupMismatchException: 0e99e1b0-220f-42bd-a39f-d4658f80d0e4: Group group-CFD51574C841 not found.
datanode_4_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupManagementAsync(RaftServerProxy.java:367)
datanode_6_1  | 2020-04-17 18:54:03,606 [grpc-default-executor-1] INFO segmented.SegmentedRaftLogWorker: 79669a1f-2445-496e-a337-3115205f3ae5@group-CFD51574C841-SegmentedRaftLogWorker: Starting segment from index:0
datanode_5_1  | 2020-04-17 18:55:43,600 [Command processor thread] INFO impl.StateMachineUpdater: 978c057e-5c38-4e20-8a8b-f271c823af7e@group-CFD51574C841-StateMachineUpdater: set stopIndex = 0
scm_1         | 	at org.apache.hadoop.hdds.scm.pipeline.SCMPipelineManager.lambda$finalizeAndDestroyPipeline$0(SCMPipelineManager.java:422)
datanode_2_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupRemoveAsync(RaftServerProxy.java:404)
datanode_4_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupManagement(RaftServerProxy.java:350)
datanode_6_1  | 2020-04-17 18:54:03,608 [79669a1f-2445-496e-a337-3115205f3ae5@group-CFD51574C841-SegmentedRaftLogWorker] INFO segmented.SegmentedRaftLogWorker: 79669a1f-2445-496e-a337-3115205f3ae5@group-CFD51574C841-SegmentedRaftLogWorker: created new log segment /data/metadata/ratis/825f4d0e-2629-43e6-a52f-cfd51574c841/current/log_inprogress_0
datanode_5_1  | 2020-04-17 18:55:43,600 [Thread-97] INFO impl.FollowerState: 978c057e-5c38-4e20-8a8b-f271c823af7e@group-CFD51574C841-FollowerState was interrupted: java.lang.InterruptedException: sleep interrupted
scm_1         | 	at org.apache.hadoop.hdds.utils.Scheduler.lambda$schedule$1(Scheduler.java:70)
datanode_2_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupManagementAsync(RaftServerProxy.java:367)
datanode_4_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.XceiverServerRatis.removeGroup(XceiverServerRatis.java:657)
datanode_6_1  | 2020-04-17 18:54:12,563 [ChunkWriter-41-0] INFO keyvalue.KeyValueHandler: Operation: CreateContainer , Trace ID: 25f4cbb29a905ffd:e4110cf328601a91:25f4cbb29a905ffd:0 , Message: Container creation failed, due to disk out of space , Result: DISK_OUT_OF_SPACE , StorageContainerException Occurred.
datanode_5_1  | 2020-04-17 18:55:43,601 [978c057e-5c38-4e20-8a8b-f271c823af7e@group-CFD51574C841-StateMachineUpdater] ERROR ratis.ContainerStateMachine: Failed to take snapshot  for group-CFD51574C841 as the stateMachine is unhealthy. The last applied index is at (t:1, i:0)
scm_1         | 	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
datanode_2_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupManagement(RaftServerProxy.java:350)
datanode_4_1  | 	... 4 more
datanode_6_1  | org.apache.hadoop.hdds.scm.container.common.helpers.StorageContainerException: Container creation failed, due to disk out of space
datanode_5_1  | 2020-04-17 18:55:43,601 [978c057e-5c38-4e20-8a8b-f271c823af7e@group-CFD51574C841-StateMachineUpdater] ERROR impl.StateMachineUpdater: 978c057e-5c38-4e20-8a8b-f271c823af7e@group-CFD51574C841-StateMachineUpdater: Failed to take snapshot
scm_1         | 	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
datanode_2_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.XceiverServerRatis.removeGroup(XceiverServerRatis.java:657)
datanode_4_1  | 2020-04-17 18:52:30,038 [Command processor thread] INFO impl.RaftServerProxy: a0acbcec-d753-414c-b077-647d02aaa7fb: remove group-385EF22ED913:null
datanode_6_1  | 	at org.apache.hadoop.ozone.container.keyvalue.KeyValueContainer.create(KeyValueContainer.java:165)
datanode_5_1  | org.apache.ratis.protocol.StateMachineException: Failed to take snapshot  for group-CFD51574C841 as the stateMachine is unhealthy. The last applied index is at (t:1, i:0)
scm_1         | 	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:304)
datanode_2_1  | 	... 4 more
datanode_4_1  | 2020-04-17 18:52:30,038 [Command processor thread] ERROR commandhandler.ClosePipelineCommandHandler: Can't close pipeline #id: "be26d0dd-802f-4608-9a1c-385ef22ed913"
datanode_6_1  | 	at org.apache.hadoop.ozone.container.keyvalue.KeyValueHandler.handleCreateContainer(KeyValueHandler.java:247)
datanode_5_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.ContainerStateMachine.takeSnapshot(ContainerStateMachine.java:288)
scm_1         | 	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
datanode_2_1  | 2020-04-17 18:55:39,759 [Command processor thread] INFO impl.RaftServerProxy: 0e99e1b0-220f-42bd-a39f-d4658f80d0e4: remove group-CFD51574C841:null
datanode_4_1  | 
datanode_6_1  | 	at org.apache.hadoop.ozone.container.keyvalue.KeyValueHandler.dispatchRequest(KeyValueHandler.java:164)
datanode_5_1  | 	at org.apache.ratis.server.impl.StateMachineUpdater.takeSnapshot(StateMachineUpdater.java:258)
scm_1         | 	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
datanode_2_1  | 2020-04-17 18:55:39,759 [Command processor thread] ERROR commandhandler.ClosePipelineCommandHandler: Can't close pipeline #id: "825f4d0e-2629-43e6-a52f-cfd51574c841"
datanode_4_1  | java.io.IOException: a0acbcec-d753-414c-b077-647d02aaa7fb: Group group-385EF22ED913 not found.
datanode_6_1  | 	at org.apache.hadoop.ozone.container.keyvalue.KeyValueHandler.handle(KeyValueHandler.java:152)
datanode_5_1  | 	at org.apache.ratis.server.impl.StateMachineUpdater.checkAndTakeSnapshot(StateMachineUpdater.java:250)
scm_1         | 	at java.base/java.lang.Thread.run(Thread.java:834)
datanode_2_1  | 
datanode_4_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.XceiverServerRatis.removeGroup(XceiverServerRatis.java:659)
datanode_6_1  | 	at org.apache.hadoop.ozone.container.common.impl.HddsDispatcher.createContainer(HddsDispatcher.java:414)
datanode_5_1  | 	at org.apache.ratis.server.impl.StateMachineUpdater.run(StateMachineUpdater.java:169)
scm_1         | 2020-04-17 18:52:34,636 [RatisPipelineUtilsThread] ERROR pipeline.SCMPipelineManager: Failed to create pipeline of type RATIS and factor ONE. Exception: Cannot create pipeline of factor 1 using 0 nodes. Used 6 nodes. Healthy nodes 6
datanode_2_1  | java.io.IOException: 0e99e1b0-220f-42bd-a39f-d4658f80d0e4: Group group-CFD51574C841 not found.
datanode_4_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.ClosePipelineCommandHandler.handle(ClosePipelineCommandHandler.java:77)
datanode_6_1  | 	at org.apache.hadoop.ozone.container.common.impl.HddsDispatcher.dispatchRequest(HddsDispatcher.java:250)
datanode_5_1  | 	at java.base/java.lang.Thread.run(Thread.java:834)
scm_1         | 2020-04-17 18:52:34,637 [RatisPipelineUtilsThread] ERROR pipeline.SCMPipelineManager: Failed to create pipeline of type RATIS and factor THREE. Exception: Pipeline creation failed because nodes are engaged in other pipelines and every node can only be engaged in max 2 pipelines. Required 3. Found 0
datanode_2_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.XceiverServerRatis.removeGroup(XceiverServerRatis.java:659)
datanode_4_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.CommandDispatcher.handle(CommandDispatcher.java:99)
datanode_6_1  | 	at org.apache.hadoop.ozone.container.common.impl.HddsDispatcher.dispatch(HddsDispatcher.java:162)
scm_1         | 2020-04-17 18:52:35,139 [EventQueue-PipelineReportForPipelineReportHandler] INFO pipeline.PipelineStateManager: Pipeline Pipeline[ Id: cad403d1-ea2f-4530-84e5-79e0035d853a, Nodes: a0acbcec-d753-414c-b077-647d02aaa7fb{ip: 10.5.0.7, host: ozone-topology_datanode_4_1.ozone-topology_net, networkLocation: /rack2, certSerialId: null}0e99e1b0-220f-42bd-a39f-d4658f80d0e4{ip: 10.5.0.5, host: ozone-topology_datanode_2_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}978c057e-5c38-4e20-8a8b-f271c823af7e{ip: 10.5.0.8, host: ozone-topology_datanode_5_1.ozone-topology_net, networkLocation: /rack2, certSerialId: null}, Type:RATIS, Factor:THREE, State:ALLOCATED, leaderId:978c057e-5c38-4e20-8a8b-f271c823af7e, CreationTimestamp2020-04-17T18:52:04.783559Z] moved to OPEN state
datanode_5_1  | 2020-04-17 18:55:43,602 [978c057e-5c38-4e20-8a8b-f271c823af7e@group-CFD51574C841-StateMachineUpdater] ERROR ratis.ContainerStateMachine: Failed to take snapshot  for group-CFD51574C841 as the stateMachine is unhealthy. The last applied index is at (t:1, i:0)
datanode_2_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.ClosePipelineCommandHandler.handle(ClosePipelineCommandHandler.java:77)
datanode_4_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.lambda$initCommandHandlerThread$1(DatanodeStateMachine.java:472)
datanode_6_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.ContainerStateMachine.dispatchCommand(ContainerStateMachine.java:402)
datanode_5_1  | 2020-04-17 18:55:43,602 [978c057e-5c38-4e20-8a8b-f271c823af7e@group-CFD51574C841-StateMachineUpdater] ERROR impl.StateMachineUpdater: 978c057e-5c38-4e20-8a8b-f271c823af7e@group-CFD51574C841-StateMachineUpdater: Failed to take snapshot
scm_1         | 2020-04-17 18:52:37,625 [EventQueue-PipelineActionsForPipelineActionHandler] INFO pipeline.PipelineActionHandler: Received pipeline action CLOSE for PipelineID=cad403d1-ea2f-4530-84e5-79e0035d853a from datanode 978c057e-5c38-4e20-8a8b-f271c823af7e. Reason : ContainerID 3 creation failed
datanode_2_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.CommandDispatcher.handle(CommandDispatcher.java:99)
datanode_4_1  | 	at java.base/java.lang.Thread.run(Thread.java:834)
datanode_6_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.ContainerStateMachine.runCommand(ContainerStateMachine.java:412)
datanode_5_1  | org.apache.ratis.protocol.StateMachineException: Failed to take snapshot  for group-CFD51574C841 as the stateMachine is unhealthy. The last applied index is at (t:1, i:0)
scm_1         | 2020-04-17 18:52:37,626 [EventQueue-PipelineActionsForPipelineActionHandler] INFO pipeline.SCMPipelineManager: Destroying pipeline:Pipeline[ Id: cad403d1-ea2f-4530-84e5-79e0035d853a, Nodes: a0acbcec-d753-414c-b077-647d02aaa7fb{ip: 10.5.0.7, host: ozone-topology_datanode_4_1.ozone-topology_net, networkLocation: /rack2, certSerialId: null}0e99e1b0-220f-42bd-a39f-d4658f80d0e4{ip: 10.5.0.5, host: ozone-topology_datanode_2_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}978c057e-5c38-4e20-8a8b-f271c823af7e{ip: 10.5.0.8, host: ozone-topology_datanode_5_1.ozone-topology_net, networkLocation: /rack2, certSerialId: null}, Type:RATIS, Factor:THREE, State:OPEN, leaderId:978c057e-5c38-4e20-8a8b-f271c823af7e, CreationTimestamp2020-04-17T18:52:04.783559Z]
datanode_2_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.lambda$initCommandHandlerThread$1(DatanodeStateMachine.java:472)
datanode_4_1  | Caused by: org.apache.ratis.protocol.GroupMismatchException: a0acbcec-d753-414c-b077-647d02aaa7fb: Group group-385EF22ED913 not found.
datanode_6_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.ContainerStateMachine.lambda$handleWriteChunk$2(ContainerStateMachine.java:447)
datanode_5_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.ContainerStateMachine.takeSnapshot(ContainerStateMachine.java:288)
scm_1         | 2020-04-17 18:52:37,626 [EventQueue-PipelineActionsForPipelineActionHandler] INFO pipeline.PipelineStateManager: Pipeline Pipeline[ Id: cad403d1-ea2f-4530-84e5-79e0035d853a, Nodes: a0acbcec-d753-414c-b077-647d02aaa7fb{ip: 10.5.0.7, host: ozone-topology_datanode_4_1.ozone-topology_net, networkLocation: /rack2, certSerialId: null}0e99e1b0-220f-42bd-a39f-d4658f80d0e4{ip: 10.5.0.5, host: ozone-topology_datanode_2_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}978c057e-5c38-4e20-8a8b-f271c823af7e{ip: 10.5.0.8, host: ozone-topology_datanode_5_1.ozone-topology_net, networkLocation: /rack2, certSerialId: null}, Type:RATIS, Factor:THREE, State:CLOSED, leaderId:978c057e-5c38-4e20-8a8b-f271c823af7e, CreationTimestamp2020-04-17T18:52:04.783559Z] moved to CLOSED state
datanode_2_1  | 	at java.base/java.lang.Thread.run(Thread.java:834)
datanode_4_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupRemoveAsync(RaftServerProxy.java:404)
datanode_5_1  | 	at org.apache.ratis.server.impl.StateMachineUpdater.takeSnapshot(StateMachineUpdater.java:258)
scm_1         | 2020-04-17 18:52:37,626 [EventQueue-CloseContainerForCloseContainerEventHandler] INFO container.CloseContainerEventHandler: Close container Event triggered for container : #3
datanode_2_1  | Caused by: org.apache.ratis.protocol.GroupMismatchException: 0e99e1b0-220f-42bd-a39f-d4658f80d0e4: Group group-CFD51574C841 not found.
datanode_4_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupManagementAsync(RaftServerProxy.java:367)
datanode_6_1  | 	at java.base/java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1700)
datanode_6_1  | 	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
scm_1         | 2020-04-17 18:52:37,644 [EventQueue-PipelineActionsForPipelineActionHandler] INFO pipeline.PipelineActionHandler: Received pipeline action CLOSE for PipelineID=cad403d1-ea2f-4530-84e5-79e0035d853a from datanode 978c057e-5c38-4e20-8a8b-f271c823af7e. Reason : Log already failed at index 1 for task WriteLog:1: (t:1, i:1), STATEMACHINELOGENTRY, client-B8993CFB43DC, cid=57
datanode_2_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupRemoveAsync(RaftServerProxy.java:404)
datanode_4_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupManagement(RaftServerProxy.java:350)
datanode_5_1  | 	at org.apache.ratis.server.impl.StateMachineUpdater.checkAndTakeSnapshot(StateMachineUpdater.java:250)
datanode_6_1  | 	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
scm_1         | 	 State Machine: cmdType: WriteChunk traceID: "dbf2e28874f8e582:fd88223a75928210:dbf2e28874f8e582:0" containerID: 3 datanodeUuid: "a0acbcec-d753-414c-b077-647d02aaa7fb" pipelineID: "cad403d1-ea2f-4530-84e5-79e0035d853a" writeChunk { blockID { containerID: 3 localID: 104015433404579858 blockCommitSequenceId: 0 } chunkData { chunkName: "104015433404579858_chunk_1" offset: 0 len: 10240 checksumData { type: CRC32 bytesPerChecksum: 1048576 checksums: ">\344\315\231" } } }, container path=nonexistent
datanode_2_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupManagementAsync(RaftServerProxy.java:367)
datanode_4_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.XceiverServerRatis.removeGroup(XceiverServerRatis.java:657)
datanode_5_1  | 	at org.apache.ratis.server.impl.StateMachineUpdater.run(StateMachineUpdater.java:172)
datanode_6_1  | 	at java.base/java.lang.Thread.run(Thread.java:834)
scm_1         | 2020-04-17 18:52:37,648 [EventQueue-PipelineActionsForPipelineActionHandler] INFO pipeline.SCMPipelineManager: Destroying pipeline:Pipeline[ Id: cad403d1-ea2f-4530-84e5-79e0035d853a, Nodes: a0acbcec-d753-414c-b077-647d02aaa7fb{ip: 10.5.0.7, host: ozone-topology_datanode_4_1.ozone-topology_net, networkLocation: /rack2, certSerialId: null}0e99e1b0-220f-42bd-a39f-d4658f80d0e4{ip: 10.5.0.5, host: ozone-topology_datanode_2_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}978c057e-5c38-4e20-8a8b-f271c823af7e{ip: 10.5.0.8, host: ozone-topology_datanode_5_1.ozone-topology_net, networkLocation: /rack2, certSerialId: null}, Type:RATIS, Factor:THREE, State:CLOSED, leaderId:978c057e-5c38-4e20-8a8b-f271c823af7e, CreationTimestamp2020-04-17T18:52:04.783559Z]
datanode_2_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupManagement(RaftServerProxy.java:350)
datanode_4_1  | 	... 4 more
datanode_5_1  | 	at java.base/java.lang.Thread.run(Thread.java:834)
datanode_6_1  | Caused by: org.apache.hadoop.util.DiskChecker$DiskOutOfSpaceException: Out of space: The volume with the most available space (=0 B) is less than the container size (=1073741824 B).
scm_1         | 2020-04-17 18:52:37,649 [EventQueue-PipelineActionsForPipelineActionHandler] INFO pipeline.PipelineActionHandler: Received pipeline action CLOSE for PipelineID=cad403d1-ea2f-4530-84e5-79e0035d853a from datanode 0e99e1b0-220f-42bd-a39f-d4658f80d0e4. Reason : ContainerID 3 creation failed
datanode_2_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.XceiverServerRatis.removeGroup(XceiverServerRatis.java:657)
datanode_4_1  | 2020-04-17 18:52:35,132 [grpc-default-executor-1] INFO impl.RaftServerImpl: a0acbcec-d753-414c-b077-647d02aaa7fb@group-79E0035D853A: changes role from  FOLLOWER to FOLLOWER at term 1 for recognizeCandidate:978c057e-5c38-4e20-8a8b-f271c823af7e
datanode_5_1  | 2020-04-17 18:55:43,602 [978c057e-5c38-4e20-8a8b-f271c823af7e@group-CFD51574C841-StateMachineUpdater] INFO metrics.RatisMetrics: Unregistering Metrics Registry : ratis.state_machine.978c057e-5c38-4e20-8a8b-f271c823af7e@group-CFD51574C841
datanode_5_1  | 2020-04-17 18:55:43,602 [Command processor thread] INFO impl.RaftServerImpl: 978c057e-5c38-4e20-8a8b-f271c823af7e@group-CFD51574C841: closes. applyIndex: 0
scm_1         | 2020-04-17 18:52:37,649 [EventQueue-PipelineActionsForPipelineActionHandler] INFO pipeline.SCMPipelineManager: Destroying pipeline:Pipeline[ Id: cad403d1-ea2f-4530-84e5-79e0035d853a, Nodes: a0acbcec-d753-414c-b077-647d02aaa7fb{ip: 10.5.0.7, host: ozone-topology_datanode_4_1.ozone-topology_net, networkLocation: /rack2, certSerialId: null}0e99e1b0-220f-42bd-a39f-d4658f80d0e4{ip: 10.5.0.5, host: ozone-topology_datanode_2_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}978c057e-5c38-4e20-8a8b-f271c823af7e{ip: 10.5.0.8, host: ozone-topology_datanode_5_1.ozone-topology_net, networkLocation: /rack2, certSerialId: null}, Type:RATIS, Factor:THREE, State:CLOSED, leaderId:978c057e-5c38-4e20-8a8b-f271c823af7e, CreationTimestamp2020-04-17T18:52:04.783559Z]
datanode_2_1  | 	... 4 more
datanode_5_1  | 2020-04-17 18:55:43,602 [978c057e-5c38-4e20-8a8b-f271c823af7e@group-CFD51574C841-SegmentedRaftLogWorker] INFO segmented.SegmentedRaftLogWorker: 978c057e-5c38-4e20-8a8b-f271c823af7e@group-CFD51574C841-SegmentedRaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
datanode_6_1  | 	at org.apache.hadoop.ozone.container.common.volume.RoundRobinVolumeChoosingPolicy.chooseVolume(RoundRobinVolumeChoosingPolicy.java:77)
datanode_6_1  | 	at org.apache.hadoop.ozone.container.keyvalue.KeyValueContainer.create(KeyValueContainer.java:124)
scm_1         | 2020-04-17 18:52:37,657 [EventQueue-PipelineActionsForPipelineActionHandler] INFO pipeline.PipelineActionHandler: Received pipeline action CLOSE for PipelineID=cad403d1-ea2f-4530-84e5-79e0035d853a from datanode 0e99e1b0-220f-42bd-a39f-d4658f80d0e4. Reason : Log already failed at index 1 for task WriteLog:1: (t:1, i:1), STATEMACHINELOGENTRY, client-B8993CFB43DC, cid=57
datanode_2_1  | 2020-04-17 18:55:40,931 [ChunkWriter-51-0] INFO keyvalue.KeyValueHandler: Operation: CreateContainer , Trace ID: 9f59c7868aa8c134:53a78add67987187:9f59c7868aa8c134:0 , Message: Container creation failed, due to disk out of space , Result: DISK_OUT_OF_SPACE , StorageContainerException Occurred.
datanode_5_1  | 2020-04-17 18:55:43,604 [Command processor thread] INFO segmented.SegmentedRaftLogWorker: 978c057e-5c38-4e20-8a8b-f271c823af7e@group-CFD51574C841-SegmentedRaftLogWorker close()
datanode_6_1  | 	... 13 more
datanode_4_1  | 2020-04-17 18:52:35,133 [grpc-default-executor-1] INFO impl.RoleInfo: a0acbcec-d753-414c-b077-647d02aaa7fb: shutdown FollowerState
scm_1         | 	 State Machine: cmdType: WriteChunk traceID: "dbf2e28874f8e582:fd88223a75928210:dbf2e28874f8e582:0" containerID: 3 datanodeUuid: "a0acbcec-d753-414c-b077-647d02aaa7fb" pipelineID: "cad403d1-ea2f-4530-84e5-79e0035d853a" writeChunk { blockID { containerID: 3 localID: 104015433404579858 blockCommitSequenceId: 0 } chunkData { chunkName: "104015433404579858_chunk_1" offset: 0 len: 10240 checksumData { type: CRC32 bytesPerChecksum: 1048576 checksums: ">\344\315\231" } } }, container path=nonexistent
datanode_2_1  | org.apache.hadoop.hdds.scm.container.common.helpers.StorageContainerException: Container creation failed, due to disk out of space
datanode_5_1  | 2020-04-17 18:55:43,605 [Command processor thread] INFO metrics.RatisMetrics: Unregistering Metrics Registry : ratis.log_worker.978c057e-5c38-4e20-8a8b-f271c823af7e
datanode_6_1  | 2020-04-17 18:54:12,565 [ChunkWriter-41-0] INFO impl.HddsDispatcher: Operation: WriteChunk , Trace ID: 25f4cbb29a905ffd:e4110cf328601a91:25f4cbb29a905ffd:0 , Message: ContainerID 4 creation failed , Result: DISK_OUT_OF_SPACE , StorageContainerException Occurred.
datanode_4_1  | 2020-04-17 18:52:35,133 [grpc-default-executor-1] INFO impl.RoleInfo: a0acbcec-d753-414c-b077-647d02aaa7fb: start FollowerState
scm_1         | 2020-04-17 18:52:37,657 [EventQueue-PipelineActionsForPipelineActionHandler] INFO pipeline.SCMPipelineManager: Destroying pipeline:Pipeline[ Id: cad403d1-ea2f-4530-84e5-79e0035d853a, Nodes: a0acbcec-d753-414c-b077-647d02aaa7fb{ip: 10.5.0.7, host: ozone-topology_datanode_4_1.ozone-topology_net, networkLocation: /rack2, certSerialId: null}0e99e1b0-220f-42bd-a39f-d4658f80d0e4{ip: 10.5.0.5, host: ozone-topology_datanode_2_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}978c057e-5c38-4e20-8a8b-f271c823af7e{ip: 10.5.0.8, host: ozone-topology_datanode_5_1.ozone-topology_net, networkLocation: /rack2, certSerialId: null}, Type:RATIS, Factor:THREE, State:CLOSED, leaderId:978c057e-5c38-4e20-8a8b-f271c823af7e, CreationTimestamp2020-04-17T18:52:04.783559Z]
datanode_2_1  | 	at org.apache.hadoop.ozone.container.keyvalue.KeyValueContainer.create(KeyValueContainer.java:165)
datanode_5_1  | 2020-04-17 18:55:43,605 [Command processor thread] INFO metrics.RatisMetrics: Unregistering Metrics Registry : ratis.leader_election.978c057e-5c38-4e20-8a8b-f271c823af7e@group-CFD51574C841
datanode_6_1  | org.apache.hadoop.hdds.scm.container.common.helpers.StorageContainerException: ContainerID 4 creation failed
datanode_4_1  | 2020-04-17 18:52:35,133 [Thread-47] INFO impl.FollowerState: a0acbcec-d753-414c-b077-647d02aaa7fb@group-79E0035D853A-FollowerState was interrupted: java.lang.InterruptedException: sleep interrupted
scm_1         | 2020-04-17 18:52:37,672 [EventQueue-PipelineActionsForPipelineActionHandler] INFO pipeline.PipelineActionHandler: Received pipeline action CLOSE for PipelineID=cad403d1-ea2f-4530-84e5-79e0035d853a from datanode a0acbcec-d753-414c-b077-647d02aaa7fb. Reason : ContainerID 3 creation failed
scm_1         | 2020-04-17 18:52:37,672 [EventQueue-PipelineActionsForPipelineActionHandler] INFO pipeline.SCMPipelineManager: Destroying pipeline:Pipeline[ Id: cad403d1-ea2f-4530-84e5-79e0035d853a, Nodes: a0acbcec-d753-414c-b077-647d02aaa7fb{ip: 10.5.0.7, host: ozone-topology_datanode_4_1.ozone-topology_net, networkLocation: /rack2, certSerialId: null}0e99e1b0-220f-42bd-a39f-d4658f80d0e4{ip: 10.5.0.5, host: ozone-topology_datanode_2_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}978c057e-5c38-4e20-8a8b-f271c823af7e{ip: 10.5.0.8, host: ozone-topology_datanode_5_1.ozone-topology_net, networkLocation: /rack2, certSerialId: null}, Type:RATIS, Factor:THREE, State:CLOSED, leaderId:978c057e-5c38-4e20-8a8b-f271c823af7e, CreationTimestamp2020-04-17T18:52:04.783559Z]
datanode_5_1  | 2020-04-17 18:55:43,605 [Command processor thread] INFO metrics.RatisMetrics: Unregistering Metrics Registry : ratis.server.978c057e-5c38-4e20-8a8b-f271c823af7e@group-CFD51574C841
datanode_6_1  | 	at org.apache.hadoop.ozone.container.common.impl.HddsDispatcher.dispatchRequest(HddsDispatcher.java:254)
datanode_4_1  | 2020-04-17 18:52:35,208 [grpc-default-executor-1] INFO ratis.XceiverServerRatis: Leader change notification received for group: group-79E0035D853A with new leaderId: 978c057e-5c38-4e20-8a8b-f271c823af7e
scm_1         | 2020-04-17 18:52:37,679 [EventQueue-PipelineActionsForPipelineActionHandler] INFO pipeline.PipelineActionHandler: Received pipeline action CLOSE for PipelineID=cad403d1-ea2f-4530-84e5-79e0035d853a from datanode a0acbcec-d753-414c-b077-647d02aaa7fb. Reason : Log already failed at index 1 for task WriteLog:1: (t:1, i:1), STATEMACHINELOGENTRY, client-B8993CFB43DC, cid=57
datanode_2_1  | 	at org.apache.hadoop.ozone.container.keyvalue.KeyValueHandler.handleCreateContainer(KeyValueHandler.java:247)
datanode_5_1  | 2020-04-17 18:55:43,606 [Command processor thread] INFO commandhandler.ClosePipelineCommandHandler: Close Pipeline #id: "825f4d0e-2629-43e6-a52f-cfd51574c841"
datanode_6_1  | 	at org.apache.hadoop.ozone.container.common.impl.HddsDispatcher.dispatch(HddsDispatcher.java:162)
datanode_4_1  | 2020-04-17 18:52:35,208 [grpc-default-executor-1] INFO impl.RaftServerImpl: a0acbcec-d753-414c-b077-647d02aaa7fb@group-79E0035D853A: change Leader from null to 978c057e-5c38-4e20-8a8b-f271c823af7e at term 1 for appendEntries, leader elected after 5197ms
datanode_2_1  | 	at org.apache.hadoop.ozone.container.keyvalue.KeyValueHandler.dispatchRequest(KeyValueHandler.java:164)
datanode_5_1  |  command on datanode #978c057e-5c38-4e20-8a8b-f271c823af7e.
scm_1         | 	 State Machine: cmdType: WriteChunk traceID: "dbf2e28874f8e582:fd88223a75928210:dbf2e28874f8e582:0" containerID: 3 datanodeUuid: "a0acbcec-d753-414c-b077-647d02aaa7fb" pipelineID: "cad403d1-ea2f-4530-84e5-79e0035d853a" writeChunk { blockID { containerID: 3 localID: 104015433404579858 blockCommitSequenceId: 0 } chunkData { chunkName: "104015433404579858_chunk_1" offset: 0 len: 10240 checksumData { type: CRC32 bytesPerChecksum: 1048576 checksums: ">\344\315\231" } } }, container path=nonexistent
datanode_6_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.ContainerStateMachine.dispatchCommand(ContainerStateMachine.java:402)
datanode_4_1  | 2020-04-17 18:52:35,227 [grpc-default-executor-1] INFO impl.RaftServerImpl: a0acbcec-d753-414c-b077-647d02aaa7fb@group-79E0035D853A: set configuration 0: [978c057e-5c38-4e20-8a8b-f271c823af7e:10.5.0.8:9858, a0acbcec-d753-414c-b077-647d02aaa7fb:10.5.0.7:9858, 0e99e1b0-220f-42bd-a39f-d4658f80d0e4:10.5.0.5:9858], old=null at 0
datanode_2_1  | 	at org.apache.hadoop.ozone.container.keyvalue.KeyValueHandler.handle(KeyValueHandler.java:152)
datanode_2_1  | 	at org.apache.hadoop.ozone.container.common.impl.HddsDispatcher.createContainer(HddsDispatcher.java:414)
datanode_5_1  | 2020-04-17 18:55:43,606 [Command processor thread] INFO impl.RaftServerProxy: 978c057e-5c38-4e20-8a8b-f271c823af7e: remove group-CFD51574C841:null
datanode_6_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.ContainerStateMachine.runCommand(ContainerStateMachine.java:412)
datanode_4_1  | 2020-04-17 18:52:35,229 [grpc-default-executor-1] INFO segmented.SegmentedRaftLogWorker: a0acbcec-d753-414c-b077-647d02aaa7fb@group-79E0035D853A-SegmentedRaftLogWorker: Starting segment from index:0
datanode_4_1  | 2020-04-17 18:52:35,233 [a0acbcec-d753-414c-b077-647d02aaa7fb@group-79E0035D853A-SegmentedRaftLogWorker] INFO segmented.SegmentedRaftLogWorker: a0acbcec-d753-414c-b077-647d02aaa7fb@group-79E0035D853A-SegmentedRaftLogWorker: created new log segment /data/metadata/ratis/cad403d1-ea2f-4530-84e5-79e0035d853a/current/log_inprogress_0
datanode_2_1  | 	at org.apache.hadoop.ozone.container.common.impl.HddsDispatcher.dispatchRequest(HddsDispatcher.java:250)
datanode_5_1  | 2020-04-17 18:55:43,606 [Command processor thread] ERROR commandhandler.ClosePipelineCommandHandler: Can't close pipeline #id: "825f4d0e-2629-43e6-a52f-cfd51574c841"
datanode_6_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.ContainerStateMachine.lambda$handleWriteChunk$2(ContainerStateMachine.java:447)
datanode_4_1  | 2020-04-17 18:52:37,663 [ChunkWriter-33-0] INFO keyvalue.KeyValueHandler: Operation: CreateContainer , Trace ID: dbf2e28874f8e582:fd88223a75928210:dbf2e28874f8e582:0 , Message: Container creation failed, due to disk out of space , Result: DISK_OUT_OF_SPACE , StorageContainerException Occurred.
scm_1         | 2020-04-17 18:52:37,679 [EventQueue-PipelineActionsForPipelineActionHandler] INFO pipeline.SCMPipelineManager: Destroying pipeline:Pipeline[ Id: cad403d1-ea2f-4530-84e5-79e0035d853a, Nodes: a0acbcec-d753-414c-b077-647d02aaa7fb{ip: 10.5.0.7, host: ozone-topology_datanode_4_1.ozone-topology_net, networkLocation: /rack2, certSerialId: null}0e99e1b0-220f-42bd-a39f-d4658f80d0e4{ip: 10.5.0.5, host: ozone-topology_datanode_2_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}978c057e-5c38-4e20-8a8b-f271c823af7e{ip: 10.5.0.8, host: ozone-topology_datanode_5_1.ozone-topology_net, networkLocation: /rack2, certSerialId: null}, Type:RATIS, Factor:THREE, State:CLOSED, leaderId:978c057e-5c38-4e20-8a8b-f271c823af7e, CreationTimestamp2020-04-17T18:52:04.783559Z]
datanode_2_1  | 	at org.apache.hadoop.ozone.container.common.impl.HddsDispatcher.dispatch(HddsDispatcher.java:162)
datanode_5_1  | 
datanode_6_1  | 	at java.base/java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1700)
datanode_4_1  | org.apache.hadoop.hdds.scm.container.common.helpers.StorageContainerException: Container creation failed, due to disk out of space
scm_1         | 2020-04-17 18:53:43,628 [RatisPipelineUtilsThread] INFO pipeline.RatisPipelineProvider: Send pipeline:PipelineID=cad403d1-ea2f-4530-84e5-79e0035d853a close command to datanode a0acbcec-d753-414c-b077-647d02aaa7fb
datanode_2_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.ContainerStateMachine.dispatchCommand(ContainerStateMachine.java:402)
datanode_5_1  | java.io.IOException: 978c057e-5c38-4e20-8a8b-f271c823af7e: Group group-CFD51574C841 not found.
datanode_6_1  | 	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
datanode_4_1  | 	at org.apache.hadoop.ozone.container.keyvalue.KeyValueContainer.create(KeyValueContainer.java:165)
scm_1         | 2020-04-17 18:53:43,629 [RatisPipelineUtilsThread] INFO pipeline.RatisPipelineProvider: Send pipeline:PipelineID=cad403d1-ea2f-4530-84e5-79e0035d853a close command to datanode 0e99e1b0-220f-42bd-a39f-d4658f80d0e4
datanode_2_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.ContainerStateMachine.runCommand(ContainerStateMachine.java:412)
datanode_5_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.XceiverServerRatis.removeGroup(XceiverServerRatis.java:659)
datanode_6_1  | 	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
datanode_4_1  | 	at org.apache.hadoop.ozone.container.keyvalue.KeyValueHandler.handleCreateContainer(KeyValueHandler.java:247)
scm_1         | 2020-04-17 18:53:43,630 [RatisPipelineUtilsThread] INFO pipeline.RatisPipelineProvider: Send pipeline:PipelineID=cad403d1-ea2f-4530-84e5-79e0035d853a close command to datanode 978c057e-5c38-4e20-8a8b-f271c823af7e
datanode_4_1  | 	at org.apache.hadoop.ozone.container.keyvalue.KeyValueHandler.dispatchRequest(KeyValueHandler.java:164)
datanode_6_1  | 	at java.base/java.lang.Thread.run(Thread.java:834)
scm_1         | 2020-04-17 18:53:43,630 [RatisPipelineUtilsThread] INFO pipeline.PipelineStateManager: Pipeline Pipeline[ Id: cad403d1-ea2f-4530-84e5-79e0035d853a, Nodes: a0acbcec-d753-414c-b077-647d02aaa7fb{ip: 10.5.0.7, host: ozone-topology_datanode_4_1.ozone-topology_net, networkLocation: /rack2, certSerialId: null}0e99e1b0-220f-42bd-a39f-d4658f80d0e4{ip: 10.5.0.5, host: ozone-topology_datanode_2_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}978c057e-5c38-4e20-8a8b-f271c823af7e{ip: 10.5.0.8, host: ozone-topology_datanode_5_1.ozone-topology_net, networkLocation: /rack2, certSerialId: null}, Type:RATIS, Factor:THREE, State:CLOSED, leaderId:978c057e-5c38-4e20-8a8b-f271c823af7e, CreationTimestamp2020-04-17T18:52:04.783559Z] removed from db
datanode_2_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.ContainerStateMachine.lambda$handleWriteChunk$2(ContainerStateMachine.java:447)
datanode_5_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.ClosePipelineCommandHandler.handle(ClosePipelineCommandHandler.java:77)
datanode_5_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.CommandDispatcher.handle(CommandDispatcher.java:99)
datanode_6_1  | 2020-04-17 18:54:12,582 [ChunkWriter-41-0] ERROR ratis.ContainerStateMachine: group-CFD51574C841: writeChunk writeStateMachineData failed: blockIdcontainerID: 4
scm_1         | 2020-04-17 18:53:43,631 [RatisPipelineUtilsThread] ERROR pipeline.SCMPipelineManager: Failed to create pipeline of type RATIS and factor ONE. Exception: Cannot create pipeline of factor 1 using 0 nodes. Used 6 nodes. Healthy nodes 6
datanode_5_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.lambda$initCommandHandlerThread$1(DatanodeStateMachine.java:472)
datanode_4_1  | 	at org.apache.hadoop.ozone.container.keyvalue.KeyValueHandler.handle(KeyValueHandler.java:152)
datanode_2_1  | 	at java.base/java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1700)
datanode_6_1  | localID: 104015439626764310
scm_1         | 2020-04-17 18:53:43,632 [RatisPipelineUtilsThread] INFO pipeline.RatisPipelineProvider: Sending CreatePipelineCommand for pipeline:PipelineID=825f4d0e-2629-43e6-a52f-cfd51574c841 to datanode:978c057e-5c38-4e20-8a8b-f271c823af7e
datanode_5_1  | 	at java.base/java.lang.Thread.run(Thread.java:834)
datanode_4_1  | 	at org.apache.hadoop.ozone.container.common.impl.HddsDispatcher.createContainer(HddsDispatcher.java:414)
datanode_2_1  | 	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
datanode_6_1  | blockCommitSequenceId: 0
scm_1         | 2020-04-17 18:53:43,632 [RatisPipelineUtilsThread] INFO pipeline.RatisPipelineProvider: Sending CreatePipelineCommand for pipeline:PipelineID=825f4d0e-2629-43e6-a52f-cfd51574c841 to datanode:0e99e1b0-220f-42bd-a39f-d4658f80d0e4
datanode_5_1  | Caused by: org.apache.ratis.protocol.GroupMismatchException: 978c057e-5c38-4e20-8a8b-f271c823af7e: Group group-CFD51574C841 not found.
datanode_4_1  | 	at org.apache.hadoop.ozone.container.common.impl.HddsDispatcher.dispatchRequest(HddsDispatcher.java:250)
datanode_2_1  | 	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
datanode_6_1  |  logIndex 1 chunkName 104015439626764310_chunk_1 Error message: ContainerID 4 creation failed Container Result: DISK_OUT_OF_SPACE
scm_1         | 2020-04-17 18:53:43,632 [RatisPipelineUtilsThread] INFO pipeline.RatisPipelineProvider: Sending CreatePipelineCommand for pipeline:PipelineID=825f4d0e-2629-43e6-a52f-cfd51574c841 to datanode:79669a1f-2445-496e-a337-3115205f3ae5
datanode_5_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupRemoveAsync(RaftServerProxy.java:404)
datanode_6_1  | 2020-04-17 18:54:12,592 [79669a1f-2445-496e-a337-3115205f3ae5@group-CFD51574C841-SegmentedRaftLogWorker] ERROR ratis.XceiverServerRatis: pipeline Action CLOSE on pipeline PipelineID=825f4d0e-2629-43e6-a52f-cfd51574c841.Reason : ContainerID 4 creation failed
scm_1         | 2020-04-17 18:53:43,633 [RatisPipelineUtilsThread] INFO pipeline.PipelineStateManager: Created pipeline Pipeline[ Id: 825f4d0e-2629-43e6-a52f-cfd51574c841, Nodes: 978c057e-5c38-4e20-8a8b-f271c823af7e{ip: 10.5.0.8, host: ozone-topology_datanode_5_1.ozone-topology_net, networkLocation: /rack2, certSerialId: null}0e99e1b0-220f-42bd-a39f-d4658f80d0e4{ip: 10.5.0.5, host: ozone-topology_datanode_2_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}79669a1f-2445-496e-a337-3115205f3ae5{ip: 10.5.0.9, host: ozone-topology_datanode_6_1.ozone-topology_net, networkLocation: /rack2, certSerialId: null}, Type:RATIS, Factor:THREE, State:ALLOCATED, leaderId:null, CreationTimestamp2020-04-17T18:53:43.632228Z]
datanode_2_1  | 	at java.base/java.lang.Thread.run(Thread.java:834)
datanode_4_1  | 	at org.apache.hadoop.ozone.container.common.impl.HddsDispatcher.dispatch(HddsDispatcher.java:162)
datanode_5_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupManagementAsync(RaftServerProxy.java:367)
datanode_6_1  | 2020-04-17 18:54:12,647 [79669a1f-2445-496e-a337-3115205f3ae5@group-CFD51574C841-SegmentedRaftLogWorker] ERROR ratis.XceiverServerRatis: pipeline Action CLOSE on pipeline PipelineID=825f4d0e-2629-43e6-a52f-cfd51574c841.Reason : Log already failed at index 1 for task WriteLog:1: (t:1, i:1), STATEMACHINELOGENTRY, client-191241DA7A93, cid=70
scm_1         | 2020-04-17 18:53:43,634 [RatisPipelineUtilsThread] ERROR pipeline.SCMPipelineManager: Failed to create pipeline of type RATIS and factor THREE. Exception: Pipeline creation failed because nodes are engaged in other pipelines and every node can only be engaged in max 2 pipelines. Required 3. Found 1
datanode_2_1  | Caused by: org.apache.hadoop.util.DiskChecker$DiskOutOfSpaceException: Out of space: The volume with the most available space (=964628480 B) is less than the container size (=1073741824 B).
datanode_4_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.ContainerStateMachine.dispatchCommand(ContainerStateMachine.java:402)
datanode_5_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupManagement(RaftServerProxy.java:350)
datanode_2_1  | 	at org.apache.hadoop.ozone.container.common.volume.RoundRobinVolumeChoosingPolicy.chooseVolume(RoundRobinVolumeChoosingPolicy.java:77)
datanode_4_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.ContainerStateMachine.runCommand(ContainerStateMachine.java:412)
datanode_6_1  | 	 State Machine: cmdType: WriteChunk traceID: "25f4cbb29a905ffd:e4110cf328601a91:25f4cbb29a905ffd:0" containerID: 4 datanodeUuid: "978c057e-5c38-4e20-8a8b-f271c823af7e" pipelineID: "825f4d0e-2629-43e6-a52f-cfd51574c841" writeChunk { blockID { containerID: 4 localID: 104015439626764310 blockCommitSequenceId: 0 } chunkData { chunkName: "104015439626764310_chunk_1" offset: 0 len: 10240 checksumData { type: CRC32 bytesPerChecksum: 1048576 checksums: ">\344\315\231" } } }, container path=nonexistent
datanode_5_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.XceiverServerRatis.removeGroup(XceiverServerRatis.java:657)
scm_1         | 2020-04-17 18:53:43,649 [RatisPipelineUtilsThread] INFO pipeline.RatisPipelineProvider: Send pipeline:PipelineID=cad403d1-ea2f-4530-84e5-79e0035d853a close command to datanode a0acbcec-d753-414c-b077-647d02aaa7fb
scm_1         | 2020-04-17 18:53:43,651 [RatisPipelineUtilsThread] INFO pipeline.RatisPipelineProvider: Send pipeline:PipelineID=cad403d1-ea2f-4530-84e5-79e0035d853a close command to datanode 0e99e1b0-220f-42bd-a39f-d4658f80d0e4
datanode_5_1  | 	... 4 more
datanode_2_1  | 	at org.apache.hadoop.ozone.container.keyvalue.KeyValueContainer.create(KeyValueContainer.java:124)
datanode_6_1  | 2020-04-17 18:54:29,320 [Command processor thread] ERROR commandhandler.CloseContainerCommandHandler: Container #4 does not exist in datanode. Container close failed.
scm_1         | 2020-04-17 18:53:43,651 [RatisPipelineUtilsThread] INFO pipeline.RatisPipelineProvider: Send pipeline:PipelineID=cad403d1-ea2f-4530-84e5-79e0035d853a close command to datanode 978c057e-5c38-4e20-8a8b-f271c823af7e
datanode_5_1  | 2020-04-17 18:55:43,606 [Command processor thread] INFO impl.RaftServerProxy: 978c057e-5c38-4e20-8a8b-f271c823af7e: remove group-CFD51574C841:null
datanode_2_1  | 	... 13 more
datanode_6_1  | 2020-04-17 18:55:39,721 [grpc-default-executor-5] INFO server.GrpcServerProtocolService: 79669a1f-2445-496e-a337-3115205f3ae5: Completed APPEND_ENTRIES, lastRequest: 0e99e1b0-220f-42bd-a39f-d4658f80d0e4->79669a1f-2445-496e-a337-3115205f3ae5#6-t1, previous=(t:1, i:1), leaderCommit=0, initializing? false, entries: size=1, first=(t:1, i:2), STATEMACHINELOGENTRY, client-191241DA7A93, cid=71
datanode_4_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.ContainerStateMachine.lambda$handleWriteChunk$2(ContainerStateMachine.java:447)
scm_1         | 2020-04-17 18:53:43,652 [RatisPipelineUtilsThread] ERROR pipeline.SCMPipelineManager: Destroy pipeline failed for pipeline:Pipeline[ Id: cad403d1-ea2f-4530-84e5-79e0035d853a, Nodes: a0acbcec-d753-414c-b077-647d02aaa7fb{ip: 10.5.0.7, host: ozone-topology_datanode_4_1.ozone-topology_net, networkLocation: /rack2, certSerialId: null}0e99e1b0-220f-42bd-a39f-d4658f80d0e4{ip: 10.5.0.5, host: ozone-topology_datanode_2_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}978c057e-5c38-4e20-8a8b-f271c823af7e{ip: 10.5.0.8, host: ozone-topology_datanode_5_1.ozone-topology_net, networkLocation: /rack2, certSerialId: null}, Type:RATIS, Factor:THREE, State:CLOSED, leaderId:978c057e-5c38-4e20-8a8b-f271c823af7e, CreationTimestamp2020-04-17T18:52:04.783559Z]
datanode_5_1  | 2020-04-17 18:55:43,606 [Command processor thread] ERROR commandhandler.ClosePipelineCommandHandler: Can't close pipeline #id: "825f4d0e-2629-43e6-a52f-cfd51574c841"
datanode_2_1  | 2020-04-17 18:55:40,934 [ChunkWriter-51-0] INFO impl.HddsDispatcher: Operation: WriteChunk , Trace ID: 9f59c7868aa8c134:53a78add67987187:9f59c7868aa8c134:0 , Message: ContainerID 5 creation failed , Result: DISK_OUT_OF_SPACE , StorageContainerException Occurred.
datanode_6_1  | 2020-04-17 18:55:43,649 [Command processor thread] INFO impl.RaftServerProxy: 79669a1f-2445-496e-a337-3115205f3ae5: remove  FOLLOWER 79669a1f-2445-496e-a337-3115205f3ae5@group-CFD51574C841:t1, leader=0e99e1b0-220f-42bd-a39f-d4658f80d0e4, voted=0e99e1b0-220f-42bd-a39f-d4658f80d0e4, raftlog=79669a1f-2445-496e-a337-3115205f3ae5@group-CFD51574C841-SegmentedRaftLog:OPENED:c0,f0,i2, conf=0: [978c057e-5c38-4e20-8a8b-f271c823af7e:10.5.0.8:9858, 79669a1f-2445-496e-a337-3115205f3ae5:10.5.0.9:9858, 0e99e1b0-220f-42bd-a39f-d4658f80d0e4:10.5.0.5:9858], old=null RUNNING
datanode_4_1  | 	at java.base/java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1700)
scm_1         | org.apache.hadoop.hdds.scm.pipeline.PipelineNotFoundException: PipelineID=cad403d1-ea2f-4530-84e5-79e0035d853a not found
datanode_5_1  | 
datanode_2_1  | org.apache.hadoop.hdds.scm.container.common.helpers.StorageContainerException: ContainerID 5 creation failed
datanode_6_1  | 2020-04-17 18:55:43,650 [Command processor thread] INFO impl.RaftServerImpl: 79669a1f-2445-496e-a337-3115205f3ae5@group-CFD51574C841: shutdown
datanode_4_1  | 	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
scm_1         | 	at org.apache.hadoop.hdds.scm.pipeline.PipelineStateMap.getPipeline(PipelineStateMap.java:133)
datanode_5_1  | java.io.IOException: 978c057e-5c38-4e20-8a8b-f271c823af7e: Group group-CFD51574C841 not found.
datanode_2_1  | 	at org.apache.hadoop.ozone.container.common.impl.HddsDispatcher.dispatchRequest(HddsDispatcher.java:254)
datanode_6_1  | 2020-04-17 18:55:43,651 [Command processor thread] INFO util.JmxRegister: Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-CFD51574C841,id=79669a1f-2445-496e-a337-3115205f3ae5
datanode_4_1  | 	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
scm_1         | 	at org.apache.hadoop.hdds.scm.pipeline.PipelineStateMap.removePipeline(PipelineStateMap.java:323)
datanode_5_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.XceiverServerRatis.removeGroup(XceiverServerRatis.java:659)
datanode_2_1  | 	at org.apache.hadoop.ozone.container.common.impl.HddsDispatcher.dispatch(HddsDispatcher.java:162)
datanode_6_1  | 2020-04-17 18:55:43,651 [Command processor thread] INFO impl.RoleInfo: 79669a1f-2445-496e-a337-3115205f3ae5: shutdown FollowerState
datanode_4_1  | 	at java.base/java.lang.Thread.run(Thread.java:834)
scm_1         | 	at org.apache.hadoop.hdds.scm.pipeline.PipelineStateManager.removePipeline(PipelineStateManager.java:104)
datanode_5_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.ClosePipelineCommandHandler.handle(ClosePipelineCommandHandler.java:77)
datanode_2_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.ContainerStateMachine.dispatchCommand(ContainerStateMachine.java:402)
datanode_6_1  | 2020-04-17 18:55:43,651 [Thread-104] INFO impl.FollowerState: 79669a1f-2445-496e-a337-3115205f3ae5@group-CFD51574C841-FollowerState was interrupted: java.lang.InterruptedException: sleep interrupted
datanode_4_1  | Caused by: org.apache.hadoop.util.DiskChecker$DiskOutOfSpaceException: Out of space: The volume with the most available space (=965169152 B) is less than the container size (=1073741824 B).
scm_1         | 	at org.apache.hadoop.hdds.scm.pipeline.SCMPipelineManager.removePipeline(SCMPipelineManager.java:595)
datanode_5_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.CommandDispatcher.handle(CommandDispatcher.java:99)
datanode_2_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.ContainerStateMachine.runCommand(ContainerStateMachine.java:412)
datanode_6_1  | 2020-04-17 18:55:43,652 [79669a1f-2445-496e-a337-3115205f3ae5@group-CFD51574C841-StateMachineUpdater] ERROR ratis.ContainerStateMachine: Failed to take snapshot  for group-CFD51574C841 as the stateMachine is unhealthy. The last applied index is at (t:1, i:0)
datanode_6_1  | 2020-04-17 18:55:43,652 [79669a1f-2445-496e-a337-3115205f3ae5@group-CFD51574C841-StateMachineUpdater] ERROR impl.StateMachineUpdater: 79669a1f-2445-496e-a337-3115205f3ae5@group-CFD51574C841-StateMachineUpdater: Failed to take snapshot
datanode_4_1  | 	at org.apache.hadoop.ozone.container.common.volume.RoundRobinVolumeChoosingPolicy.chooseVolume(RoundRobinVolumeChoosingPolicy.java:77)
datanode_5_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.lambda$initCommandHandlerThread$1(DatanodeStateMachine.java:472)
datanode_2_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.ContainerStateMachine.lambda$handleWriteChunk$2(ContainerStateMachine.java:447)
datanode_6_1  | org.apache.ratis.protocol.StateMachineException: Failed to take snapshot  for group-CFD51574C841 as the stateMachine is unhealthy. The last applied index is at (t:1, i:0)
scm_1         | 	at org.apache.hadoop.hdds.scm.pipeline.SCMPipelineManager.destroyPipeline(SCMPipelineManager.java:579)
datanode_4_1  | 	at org.apache.hadoop.ozone.container.keyvalue.KeyValueContainer.create(KeyValueContainer.java:124)
datanode_5_1  | 	at java.base/java.lang.Thread.run(Thread.java:834)
datanode_2_1  | 	at java.base/java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1700)
datanode_6_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.ContainerStateMachine.takeSnapshot(ContainerStateMachine.java:288)
scm_1         | 	at org.apache.hadoop.hdds.scm.pipeline.SCMPipelineManager.lambda$finalizeAndDestroyPipeline$0(SCMPipelineManager.java:422)
datanode_4_1  | 	... 13 more
datanode_5_1  | Caused by: org.apache.ratis.protocol.GroupMismatchException: 978c057e-5c38-4e20-8a8b-f271c823af7e: Group group-CFD51574C841 not found.
datanode_2_1  | 	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
datanode_6_1  | 	at org.apache.ratis.server.impl.StateMachineUpdater.takeSnapshot(StateMachineUpdater.java:258)
scm_1         | 	at org.apache.hadoop.hdds.utils.Scheduler.lambda$schedule$1(Scheduler.java:70)
datanode_4_1  | 2020-04-17 18:52:37,664 [ChunkWriter-33-0] INFO impl.HddsDispatcher: Operation: WriteChunk , Trace ID: dbf2e28874f8e582:fd88223a75928210:dbf2e28874f8e582:0 , Message: ContainerID 3 creation failed , Result: DISK_OUT_OF_SPACE , StorageContainerException Occurred.
datanode_5_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupRemoveAsync(RaftServerProxy.java:404)
datanode_2_1  | 	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
datanode_6_1  | 	at org.apache.ratis.server.impl.StateMachineUpdater.checkAndTakeSnapshot(StateMachineUpdater.java:250)
scm_1         | 	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
datanode_4_1  | org.apache.hadoop.hdds.scm.container.common.helpers.StorageContainerException: ContainerID 3 creation failed
datanode_2_1  | 	at java.base/java.lang.Thread.run(Thread.java:834)
datanode_6_1  | 	at org.apache.ratis.server.impl.StateMachineUpdater.run(StateMachineUpdater.java:169)
scm_1         | 	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
datanode_4_1  | 	at org.apache.hadoop.ozone.container.common.impl.HddsDispatcher.dispatchRequest(HddsDispatcher.java:254)
datanode_5_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupManagementAsync(RaftServerProxy.java:367)
datanode_2_1  | 2020-04-17 18:55:40,934 [ChunkWriter-51-0] ERROR ratis.ContainerStateMachine: group-95C80522151F: writeChunk writeStateMachineData failed: blockIdcontainerID: 5
datanode_6_1  | 	at java.base/java.lang.Thread.run(Thread.java:834)
scm_1         | 	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:304)
datanode_4_1  | 	at org.apache.hadoop.ozone.container.common.impl.HddsDispatcher.dispatch(HddsDispatcher.java:162)
datanode_5_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupManagement(RaftServerProxy.java:350)
datanode_2_1  | localID: 104015445419098136
datanode_6_1  | 2020-04-17 18:55:43,653 [79669a1f-2445-496e-a337-3115205f3ae5@group-CFD51574C841-StateMachineUpdater] ERROR ratis.ContainerStateMachine: Failed to take snapshot  for group-CFD51574C841 as the stateMachine is unhealthy. The last applied index is at (t:1, i:0)
scm_1         | 	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
datanode_4_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.ContainerStateMachine.dispatchCommand(ContainerStateMachine.java:402)
datanode_5_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.XceiverServerRatis.removeGroup(XceiverServerRatis.java:657)
datanode_2_1  | blockCommitSequenceId: 0
datanode_6_1  | 2020-04-17 18:55:43,653 [79669a1f-2445-496e-a337-3115205f3ae5@group-CFD51574C841-StateMachineUpdater] ERROR impl.StateMachineUpdater: 79669a1f-2445-496e-a337-3115205f3ae5@group-CFD51574C841-StateMachineUpdater: Failed to take snapshot
scm_1         | 	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
datanode_4_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.ContainerStateMachine.runCommand(ContainerStateMachine.java:412)
datanode_5_1  | 	... 4 more
datanode_2_1  |  logIndex 1 chunkName 104015445419098136_chunk_1 Error message: ContainerID 5 creation failed Container Result: DISK_OUT_OF_SPACE
datanode_6_1  | org.apache.ratis.protocol.StateMachineException: Failed to take snapshot  for group-CFD51574C841 as the stateMachine is unhealthy. The last applied index is at (t:1, i:0)
scm_1         | 	at java.base/java.lang.Thread.run(Thread.java:834)
datanode_4_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.ContainerStateMachine.lambda$handleWriteChunk$2(ContainerStateMachine.java:447)
datanode_5_1  | 2020-04-17 18:55:43,606 [Command processor thread] INFO impl.RaftServerProxy: 978c057e-5c38-4e20-8a8b-f271c823af7e: remove group-CFD51574C841:null
datanode_2_1  | 2020-04-17 18:55:40,935 [0e99e1b0-220f-42bd-a39f-d4658f80d0e4@group-95C80522151F-SegmentedRaftLogWorker] ERROR ratis.XceiverServerRatis: pipeline Action CLOSE on pipeline PipelineID=b5a22a8d-2392-4c7a-923f-95c80522151f.Reason : ContainerID 5 creation failed
scm_1         | 2020-04-17 18:53:43,652 [RatisPipelineUtilsThread] INFO pipeline.RatisPipelineProvider: Send pipeline:PipelineID=cad403d1-ea2f-4530-84e5-79e0035d853a close command to datanode a0acbcec-d753-414c-b077-647d02aaa7fb
datanode_4_1  | 	at java.base/java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1700)
datanode_5_1  | 2020-04-17 18:55:43,607 [Command processor thread] ERROR commandhandler.ClosePipelineCommandHandler: Can't close pipeline #id: "825f4d0e-2629-43e6-a52f-cfd51574c841"
datanode_2_1  | 2020-04-17 18:55:40,951 [0e99e1b0-220f-42bd-a39f-d4658f80d0e4@group-95C80522151F-SegmentedRaftLogWorker] ERROR ratis.XceiverServerRatis: pipeline Action CLOSE on pipeline PipelineID=b5a22a8d-2392-4c7a-923f-95c80522151f.Reason : Log already failed at index 1 for task WriteLog:1: (t:1, i:1), STATEMACHINELOGENTRY, client-B5B53B577AA5, cid=77
datanode_6_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.ContainerStateMachine.takeSnapshot(ContainerStateMachine.java:288)
scm_1         | 2020-04-17 18:53:43,652 [RatisPipelineUtilsThread] INFO pipeline.RatisPipelineProvider: Send pipeline:PipelineID=cad403d1-ea2f-4530-84e5-79e0035d853a close command to datanode 0e99e1b0-220f-42bd-a39f-d4658f80d0e4
datanode_4_1  | 	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
datanode_5_1  | 
datanode_2_1  | 	 State Machine: cmdType: WriteChunk traceID: "9f59c7868aa8c134:53a78add67987187:9f59c7868aa8c134:0" containerID: 5 datanodeUuid: "0e99e1b0-220f-42bd-a39f-d4658f80d0e4" pipelineID: "b5a22a8d-2392-4c7a-923f-95c80522151f" writeChunk { blockID { containerID: 5 localID: 104015445419098136 blockCommitSequenceId: 0 } chunkData { chunkName: "104015445419098136_chunk_1" offset: 0 len: 10240 checksumData { type: CRC32 bytesPerChecksum: 1048576 checksums: ">\344\315\231" } } }, container path=nonexistent
datanode_6_1  | 	at org.apache.ratis.server.impl.StateMachineUpdater.takeSnapshot(StateMachineUpdater.java:258)
scm_1         | 2020-04-17 18:53:43,652 [RatisPipelineUtilsThread] INFO pipeline.RatisPipelineProvider: Send pipeline:PipelineID=cad403d1-ea2f-4530-84e5-79e0035d853a close command to datanode 978c057e-5c38-4e20-8a8b-f271c823af7e
datanode_4_1  | 	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
datanode_5_1  | java.io.IOException: 978c057e-5c38-4e20-8a8b-f271c823af7e: Group group-CFD51574C841 not found.
datanode_6_1  | 	at org.apache.ratis.server.impl.StateMachineUpdater.checkAndTakeSnapshot(StateMachineUpdater.java:250)
datanode_5_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.XceiverServerRatis.removeGroup(XceiverServerRatis.java:659)
datanode_6_1  | 	at org.apache.ratis.server.impl.StateMachineUpdater.run(StateMachineUpdater.java:172)
datanode_4_1  | 	at java.base/java.lang.Thread.run(Thread.java:834)
scm_1         | 2020-04-17 18:53:43,653 [RatisPipelineUtilsThread] ERROR pipeline.SCMPipelineManager: Destroy pipeline failed for pipeline:Pipeline[ Id: cad403d1-ea2f-4530-84e5-79e0035d853a, Nodes: a0acbcec-d753-414c-b077-647d02aaa7fb{ip: 10.5.0.7, host: ozone-topology_datanode_4_1.ozone-topology_net, networkLocation: /rack2, certSerialId: null}0e99e1b0-220f-42bd-a39f-d4658f80d0e4{ip: 10.5.0.5, host: ozone-topology_datanode_2_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}978c057e-5c38-4e20-8a8b-f271c823af7e{ip: 10.5.0.8, host: ozone-topology_datanode_5_1.ozone-topology_net, networkLocation: /rack2, certSerialId: null}, Type:RATIS, Factor:THREE, State:CLOSED, leaderId:978c057e-5c38-4e20-8a8b-f271c823af7e, CreationTimestamp2020-04-17T18:52:04.783559Z]
datanode_5_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.ClosePipelineCommandHandler.handle(ClosePipelineCommandHandler.java:77)
datanode_6_1  | 	at java.base/java.lang.Thread.run(Thread.java:834)
datanode_4_1  | 2020-04-17 18:52:37,665 [ChunkWriter-33-0] ERROR ratis.ContainerStateMachine: group-79E0035D853A: writeChunk writeStateMachineData failed: blockIdcontainerID: 3
scm_1         | org.apache.hadoop.hdds.scm.pipeline.PipelineNotFoundException: PipelineID=cad403d1-ea2f-4530-84e5-79e0035d853a not found
datanode_5_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.CommandDispatcher.handle(CommandDispatcher.java:99)
datanode_6_1  | 2020-04-17 18:55:43,653 [79669a1f-2445-496e-a337-3115205f3ae5@group-CFD51574C841-StateMachineUpdater] INFO metrics.RatisMetrics: Unregistering Metrics Registry : ratis.state_machine.79669a1f-2445-496e-a337-3115205f3ae5@group-CFD51574C841
datanode_4_1  | localID: 104015433404579858
scm_1         | 	at org.apache.hadoop.hdds.scm.pipeline.PipelineStateMap.getPipeline(PipelineStateMap.java:133)
datanode_5_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.lambda$initCommandHandlerThread$1(DatanodeStateMachine.java:472)
datanode_6_1  | 2020-04-17 18:55:43,654 [Command processor thread] INFO impl.StateMachineUpdater: 79669a1f-2445-496e-a337-3115205f3ae5@group-CFD51574C841-StateMachineUpdater: set stopIndex = 0
datanode_4_1  | blockCommitSequenceId: 0
scm_1         | 	at org.apache.hadoop.hdds.scm.pipeline.PipelineStateMap.removePipeline(PipelineStateMap.java:323)
datanode_5_1  | 	at java.base/java.lang.Thread.run(Thread.java:834)
datanode_6_1  | 2020-04-17 18:55:43,655 [Command processor thread] INFO impl.RaftServerImpl: 79669a1f-2445-496e-a337-3115205f3ae5@group-CFD51574C841: closes. applyIndex: 0
datanode_4_1  |  logIndex 1 chunkName 104015433404579858_chunk_1 Error message: ContainerID 3 creation failed Container Result: DISK_OUT_OF_SPACE
scm_1         | 	at org.apache.hadoop.hdds.scm.pipeline.PipelineStateManager.removePipeline(PipelineStateManager.java:104)
datanode_5_1  | Caused by: org.apache.ratis.protocol.GroupMismatchException: 978c057e-5c38-4e20-8a8b-f271c823af7e: Group group-CFD51574C841 not found.
datanode_6_1  | 2020-04-17 18:55:43,656 [79669a1f-2445-496e-a337-3115205f3ae5@group-CFD51574C841-SegmentedRaftLogWorker] INFO segmented.SegmentedRaftLogWorker: 79669a1f-2445-496e-a337-3115205f3ae5@group-CFD51574C841-SegmentedRaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
datanode_4_1  | 2020-04-17 18:52:37,665 [a0acbcec-d753-414c-b077-647d02aaa7fb@group-79E0035D853A-SegmentedRaftLogWorker] ERROR ratis.XceiverServerRatis: pipeline Action CLOSE on pipeline PipelineID=cad403d1-ea2f-4530-84e5-79e0035d853a.Reason : ContainerID 3 creation failed
scm_1         | 	at org.apache.hadoop.hdds.scm.pipeline.SCMPipelineManager.removePipeline(SCMPipelineManager.java:595)
datanode_5_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupRemoveAsync(RaftServerProxy.java:404)
datanode_5_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupManagementAsync(RaftServerProxy.java:367)
datanode_4_1  | 2020-04-17 18:52:37,674 [a0acbcec-d753-414c-b077-647d02aaa7fb@group-79E0035D853A-SegmentedRaftLogWorker] ERROR ratis.XceiverServerRatis: pipeline Action CLOSE on pipeline PipelineID=cad403d1-ea2f-4530-84e5-79e0035d853a.Reason : Log already failed at index 1 for task WriteLog:1: (t:1, i:1), STATEMACHINELOGENTRY, client-B8993CFB43DC, cid=57
scm_1         | 	at org.apache.hadoop.hdds.scm.pipeline.SCMPipelineManager.destroyPipeline(SCMPipelineManager.java:579)
datanode_5_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupManagement(RaftServerProxy.java:350)
datanode_6_1  | 2020-04-17 18:55:43,659 [Command processor thread] INFO segmented.SegmentedRaftLogWorker: 79669a1f-2445-496e-a337-3115205f3ae5@group-CFD51574C841-SegmentedRaftLogWorker close()
datanode_4_1  | 	 State Machine: cmdType: WriteChunk traceID: "dbf2e28874f8e582:fd88223a75928210:dbf2e28874f8e582:0" containerID: 3 datanodeUuid: "a0acbcec-d753-414c-b077-647d02aaa7fb" pipelineID: "cad403d1-ea2f-4530-84e5-79e0035d853a" writeChunk { blockID { containerID: 3 localID: 104015433404579858 blockCommitSequenceId: 0 } chunkData { chunkName: "104015433404579858_chunk_1" offset: 0 len: 10240 checksumData { type: CRC32 bytesPerChecksum: 1048576 checksums: ">\344\315\231" } } }, container path=nonexistent
scm_1         | 	at org.apache.hadoop.hdds.scm.pipeline.SCMPipelineManager.lambda$finalizeAndDestroyPipeline$0(SCMPipelineManager.java:422)
datanode_6_1  | 2020-04-17 18:55:43,660 [Command processor thread] INFO metrics.RatisMetrics: Unregistering Metrics Registry : ratis.log_worker.79669a1f-2445-496e-a337-3115205f3ae5
datanode_5_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.XceiverServerRatis.removeGroup(XceiverServerRatis.java:657)
datanode_4_1  | 2020-04-17 18:53:01,010 [Command processor thread] ERROR commandhandler.CloseContainerCommandHandler: Container #3 does not exist in datanode. Container close failed.
scm_1         | 	at org.apache.hadoop.hdds.utils.Scheduler.lambda$schedule$1(Scheduler.java:70)
datanode_6_1  | 2020-04-17 18:55:43,660 [Command processor thread] INFO metrics.RatisMetrics: Unregistering Metrics Registry : ratis.leader_election.79669a1f-2445-496e-a337-3115205f3ae5@group-CFD51574C841
datanode_5_1  | 	... 4 more
datanode_4_1  | 2020-04-17 18:54:08,642 [grpc-default-executor-1] INFO server.GrpcServerProtocolService: a0acbcec-d753-414c-b077-647d02aaa7fb: Completed APPEND_ENTRIES, lastRequest: 978c057e-5c38-4e20-8a8b-f271c823af7e->a0acbcec-d753-414c-b077-647d02aaa7fb#3-t1, previous=(t:1, i:1), leaderCommit=0, initializing? false, entries: size=1, first=(t:1, i:2), STATEMACHINELOGENTRY, client-B8993CFB43DC, cid=58
scm_1         | 	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
datanode_6_1  | 2020-04-17 18:55:43,660 [Command processor thread] INFO metrics.RatisMetrics: Unregistering Metrics Registry : ratis.server.79669a1f-2445-496e-a337-3115205f3ae5@group-CFD51574C841
datanode_5_1  | 2020-04-17 18:55:43,607 [Command processor thread] INFO impl.RaftServerProxy: 978c057e-5c38-4e20-8a8b-f271c823af7e: remove group-CFD51574C841:null
datanode_5_1  | 2020-04-17 18:55:43,607 [Command processor thread] ERROR commandhandler.ClosePipelineCommandHandler: Can't close pipeline #id: "825f4d0e-2629-43e6-a52f-cfd51574c841"
datanode_4_1  | 2020-04-17 18:54:08,674 [Command processor thread] INFO impl.RaftServerProxy: a0acbcec-d753-414c-b077-647d02aaa7fb: remove  FOLLOWER a0acbcec-d753-414c-b077-647d02aaa7fb@group-79E0035D853A:t1, leader=978c057e-5c38-4e20-8a8b-f271c823af7e, voted=978c057e-5c38-4e20-8a8b-f271c823af7e, raftlog=a0acbcec-d753-414c-b077-647d02aaa7fb@group-79E0035D853A-SegmentedRaftLog:OPENED:c0,f0,i2, conf=0: [978c057e-5c38-4e20-8a8b-f271c823af7e:10.5.0.8:9858, a0acbcec-d753-414c-b077-647d02aaa7fb:10.5.0.7:9858, 0e99e1b0-220f-42bd-a39f-d4658f80d0e4:10.5.0.5:9858], old=null RUNNING
datanode_6_1  | 2020-04-17 18:55:43,662 [Command processor thread] INFO commandhandler.ClosePipelineCommandHandler: Close Pipeline #id: "825f4d0e-2629-43e6-a52f-cfd51574c841"
datanode_5_1  | 
scm_1         | 	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
datanode_6_1  |  command on datanode #79669a1f-2445-496e-a337-3115205f3ae5.
datanode_5_1  | java.io.IOException: 978c057e-5c38-4e20-8a8b-f271c823af7e: Group group-CFD51574C841 not found.
scm_1         | 	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:304)
datanode_4_1  | 2020-04-17 18:54:08,674 [Command processor thread] INFO impl.RaftServerImpl: a0acbcec-d753-414c-b077-647d02aaa7fb@group-79E0035D853A: shutdown
datanode_6_1  | 2020-04-17 18:55:43,662 [Command processor thread] INFO impl.RaftServerProxy: 79669a1f-2445-496e-a337-3115205f3ae5: remove group-CFD51574C841:null
datanode_5_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.XceiverServerRatis.removeGroup(XceiverServerRatis.java:659)
scm_1         | 	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
datanode_4_1  | 2020-04-17 18:54:08,675 [Command processor thread] INFO util.JmxRegister: Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-79E0035D853A,id=a0acbcec-d753-414c-b077-647d02aaa7fb
datanode_5_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.ClosePipelineCommandHandler.handle(ClosePipelineCommandHandler.java:77)
datanode_6_1  | 2020-04-17 18:55:43,668 [Command processor thread] ERROR commandhandler.ClosePipelineCommandHandler: Can't close pipeline #id: "825f4d0e-2629-43e6-a52f-cfd51574c841"
datanode_6_1  | 
datanode_4_1  | 2020-04-17 18:54:08,675 [Command processor thread] INFO impl.RoleInfo: a0acbcec-d753-414c-b077-647d02aaa7fb: shutdown FollowerState
datanode_5_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.CommandDispatcher.handle(CommandDispatcher.java:99)
datanode_6_1  | java.io.IOException: 79669a1f-2445-496e-a337-3115205f3ae5: Group group-CFD51574C841 not found.
scm_1         | 	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
datanode_4_1  | 2020-04-17 18:54:08,675 [Command processor thread] INFO impl.StateMachineUpdater: a0acbcec-d753-414c-b077-647d02aaa7fb@group-79E0035D853A-StateMachineUpdater: set stopIndex = 0
datanode_5_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.lambda$initCommandHandlerThread$1(DatanodeStateMachine.java:472)
datanode_6_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.XceiverServerRatis.removeGroup(XceiverServerRatis.java:659)
scm_1         | 	at java.base/java.lang.Thread.run(Thread.java:834)
datanode_4_1  | 2020-04-17 18:54:08,675 [a0acbcec-d753-414c-b077-647d02aaa7fb@group-79E0035D853A-StateMachineUpdater] ERROR ratis.ContainerStateMachine: Failed to take snapshot  for group-79E0035D853A as the stateMachine is unhealthy. The last applied index is at (t:1, i:0)
datanode_5_1  | 	at java.base/java.lang.Thread.run(Thread.java:834)
datanode_6_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.ClosePipelineCommandHandler.handle(ClosePipelineCommandHandler.java:77)
scm_1         | 2020-04-17 18:53:43,658 [RatisPipelineUtilsThread] INFO pipeline.RatisPipelineProvider: Send pipeline:PipelineID=cad403d1-ea2f-4530-84e5-79e0035d853a close command to datanode a0acbcec-d753-414c-b077-647d02aaa7fb
datanode_4_1  | 2020-04-17 18:54:08,675 [a0acbcec-d753-414c-b077-647d02aaa7fb@group-79E0035D853A-StateMachineUpdater] ERROR impl.StateMachineUpdater: a0acbcec-d753-414c-b077-647d02aaa7fb@group-79E0035D853A-StateMachineUpdater: Failed to take snapshot
datanode_5_1  | Caused by: org.apache.ratis.protocol.GroupMismatchException: 978c057e-5c38-4e20-8a8b-f271c823af7e: Group group-CFD51574C841 not found.
datanode_6_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.CommandDispatcher.handle(CommandDispatcher.java:99)
scm_1         | 2020-04-17 18:53:43,658 [RatisPipelineUtilsThread] INFO pipeline.RatisPipelineProvider: Send pipeline:PipelineID=cad403d1-ea2f-4530-84e5-79e0035d853a close command to datanode 0e99e1b0-220f-42bd-a39f-d4658f80d0e4
datanode_4_1  | org.apache.ratis.protocol.StateMachineException: Failed to take snapshot  for group-79E0035D853A as the stateMachine is unhealthy. The last applied index is at (t:1, i:0)
datanode_5_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupRemoveAsync(RaftServerProxy.java:404)
datanode_6_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.lambda$initCommandHandlerThread$1(DatanodeStateMachine.java:472)
datanode_4_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.ContainerStateMachine.takeSnapshot(ContainerStateMachine.java:288)
datanode_5_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupManagementAsync(RaftServerProxy.java:367)
datanode_6_1  | 	at java.base/java.lang.Thread.run(Thread.java:834)
scm_1         | 2020-04-17 18:53:43,658 [RatisPipelineUtilsThread] INFO pipeline.RatisPipelineProvider: Send pipeline:PipelineID=cad403d1-ea2f-4530-84e5-79e0035d853a close command to datanode 978c057e-5c38-4e20-8a8b-f271c823af7e
datanode_4_1  | 	at org.apache.ratis.server.impl.StateMachineUpdater.takeSnapshot(StateMachineUpdater.java:258)
datanode_5_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupManagement(RaftServerProxy.java:350)
datanode_6_1  | Caused by: org.apache.ratis.protocol.GroupMismatchException: 79669a1f-2445-496e-a337-3115205f3ae5: Group group-CFD51574C841 not found.
datanode_6_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupRemoveAsync(RaftServerProxy.java:404)
datanode_4_1  | 	at org.apache.ratis.server.impl.StateMachineUpdater.checkAndTakeSnapshot(StateMachineUpdater.java:250)
datanode_5_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.XceiverServerRatis.removeGroup(XceiverServerRatis.java:657)
datanode_6_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupManagementAsync(RaftServerProxy.java:367)
scm_1         | 2020-04-17 18:53:43,660 [RatisPipelineUtilsThread] ERROR pipeline.SCMPipelineManager: Destroy pipeline failed for pipeline:Pipeline[ Id: cad403d1-ea2f-4530-84e5-79e0035d853a, Nodes: a0acbcec-d753-414c-b077-647d02aaa7fb{ip: 10.5.0.7, host: ozone-topology_datanode_4_1.ozone-topology_net, networkLocation: /rack2, certSerialId: null}0e99e1b0-220f-42bd-a39f-d4658f80d0e4{ip: 10.5.0.5, host: ozone-topology_datanode_2_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}978c057e-5c38-4e20-8a8b-f271c823af7e{ip: 10.5.0.8, host: ozone-topology_datanode_5_1.ozone-topology_net, networkLocation: /rack2, certSerialId: null}, Type:RATIS, Factor:THREE, State:CLOSED, leaderId:978c057e-5c38-4e20-8a8b-f271c823af7e, CreationTimestamp2020-04-17T18:52:04.783559Z]
datanode_4_1  | 	at org.apache.ratis.server.impl.StateMachineUpdater.run(StateMachineUpdater.java:169)
datanode_5_1  | 	... 4 more
datanode_6_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupManagement(RaftServerProxy.java:350)
scm_1         | org.apache.hadoop.hdds.scm.pipeline.PipelineNotFoundException: PipelineID=cad403d1-ea2f-4530-84e5-79e0035d853a not found
datanode_4_1  | 	at java.base/java.lang.Thread.run(Thread.java:834)
datanode_5_1  | 2020-04-17 18:55:43,607 [Command processor thread] INFO impl.RaftServerProxy: 978c057e-5c38-4e20-8a8b-f271c823af7e: remove group-CFD51574C841:null
datanode_6_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.XceiverServerRatis.removeGroup(XceiverServerRatis.java:657)
scm_1         | 	at org.apache.hadoop.hdds.scm.pipeline.PipelineStateMap.getPipeline(PipelineStateMap.java:133)
datanode_4_1  | 2020-04-17 18:54:08,676 [a0acbcec-d753-414c-b077-647d02aaa7fb@group-79E0035D853A-StateMachineUpdater] ERROR ratis.ContainerStateMachine: Failed to take snapshot  for group-79E0035D853A as the stateMachine is unhealthy. The last applied index is at (t:1, i:0)
datanode_5_1  | 2020-04-17 18:55:43,607 [Command processor thread] ERROR commandhandler.ClosePipelineCommandHandler: Can't close pipeline #id: "825f4d0e-2629-43e6-a52f-cfd51574c841"
datanode_6_1  | 	... 4 more
scm_1         | 	at org.apache.hadoop.hdds.scm.pipeline.PipelineStateMap.removePipeline(PipelineStateMap.java:323)
datanode_4_1  | 2020-04-17 18:54:08,676 [a0acbcec-d753-414c-b077-647d02aaa7fb@group-79E0035D853A-StateMachineUpdater] ERROR impl.StateMachineUpdater: a0acbcec-d753-414c-b077-647d02aaa7fb@group-79E0035D853A-StateMachineUpdater: Failed to take snapshot
datanode_5_1  | 
datanode_6_1  | 2020-04-17 18:55:43,669 [Command processor thread] INFO impl.RaftServerProxy: 79669a1f-2445-496e-a337-3115205f3ae5: remove group-CFD51574C841:null
scm_1         | 	at org.apache.hadoop.hdds.scm.pipeline.PipelineStateManager.removePipeline(PipelineStateManager.java:104)
datanode_4_1  | org.apache.ratis.protocol.StateMachineException: Failed to take snapshot  for group-79E0035D853A as the stateMachine is unhealthy. The last applied index is at (t:1, i:0)
datanode_5_1  | java.io.IOException: 978c057e-5c38-4e20-8a8b-f271c823af7e: Group group-CFD51574C841 not found.
datanode_6_1  | 2020-04-17 18:55:43,669 [Command processor thread] ERROR commandhandler.ClosePipelineCommandHandler: Can't close pipeline #id: "825f4d0e-2629-43e6-a52f-cfd51574c841"
scm_1         | 	at org.apache.hadoop.hdds.scm.pipeline.SCMPipelineManager.removePipeline(SCMPipelineManager.java:595)
datanode_4_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.ContainerStateMachine.takeSnapshot(ContainerStateMachine.java:288)
datanode_5_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.XceiverServerRatis.removeGroup(XceiverServerRatis.java:659)
datanode_6_1  | 
scm_1         | 	at org.apache.hadoop.hdds.scm.pipeline.SCMPipelineManager.destroyPipeline(SCMPipelineManager.java:579)
datanode_4_1  | 	at org.apache.ratis.server.impl.StateMachineUpdater.takeSnapshot(StateMachineUpdater.java:258)
datanode_5_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.ClosePipelineCommandHandler.handle(ClosePipelineCommandHandler.java:77)
datanode_6_1  | java.io.IOException: 79669a1f-2445-496e-a337-3115205f3ae5: Group group-CFD51574C841 not found.
scm_1         | 	at org.apache.hadoop.hdds.scm.pipeline.SCMPipelineManager.lambda$finalizeAndDestroyPipeline$0(SCMPipelineManager.java:422)
datanode_4_1  | 	at org.apache.ratis.server.impl.StateMachineUpdater.checkAndTakeSnapshot(StateMachineUpdater.java:250)
datanode_5_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.CommandDispatcher.handle(CommandDispatcher.java:99)
datanode_6_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.XceiverServerRatis.removeGroup(XceiverServerRatis.java:659)
scm_1         | 	at org.apache.hadoop.hdds.utils.Scheduler.lambda$schedule$1(Scheduler.java:70)
datanode_4_1  | 	at org.apache.ratis.server.impl.StateMachineUpdater.run(StateMachineUpdater.java:172)
datanode_5_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.lambda$initCommandHandlerThread$1(DatanodeStateMachine.java:472)
datanode_6_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.ClosePipelineCommandHandler.handle(ClosePipelineCommandHandler.java:77)
scm_1         | 	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
datanode_4_1  | 	at java.base/java.lang.Thread.run(Thread.java:834)
datanode_5_1  | 	at java.base/java.lang.Thread.run(Thread.java:834)
datanode_6_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.CommandDispatcher.handle(CommandDispatcher.java:99)
scm_1         | 	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
datanode_4_1  | 2020-04-17 18:54:08,676 [a0acbcec-d753-414c-b077-647d02aaa7fb@group-79E0035D853A-StateMachineUpdater] INFO metrics.RatisMetrics: Unregistering Metrics Registry : ratis.state_machine.a0acbcec-d753-414c-b077-647d02aaa7fb@group-79E0035D853A
datanode_5_1  | Caused by: org.apache.ratis.protocol.GroupMismatchException: 978c057e-5c38-4e20-8a8b-f271c823af7e: Group group-CFD51574C841 not found.
datanode_6_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.lambda$initCommandHandlerThread$1(DatanodeStateMachine.java:472)
scm_1         | 	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:304)
datanode_4_1  | 2020-04-17 18:54:08,675 [Thread-49] INFO impl.FollowerState: a0acbcec-d753-414c-b077-647d02aaa7fb@group-79E0035D853A-FollowerState was interrupted: java.lang.InterruptedException: sleep interrupted
datanode_4_1  | 2020-04-17 18:54:08,676 [Command processor thread] INFO impl.RaftServerImpl: a0acbcec-d753-414c-b077-647d02aaa7fb@group-79E0035D853A: closes. applyIndex: 0
datanode_6_1  | 	at java.base/java.lang.Thread.run(Thread.java:834)
datanode_6_1  | Caused by: org.apache.ratis.protocol.GroupMismatchException: 79669a1f-2445-496e-a337-3115205f3ae5: Group group-CFD51574C841 not found.
datanode_4_1  | 2020-04-17 18:54:08,677 [a0acbcec-d753-414c-b077-647d02aaa7fb@group-79E0035D853A-SegmentedRaftLogWorker] INFO segmented.SegmentedRaftLogWorker: a0acbcec-d753-414c-b077-647d02aaa7fb@group-79E0035D853A-SegmentedRaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
datanode_5_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupRemoveAsync(RaftServerProxy.java:404)
datanode_6_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupRemoveAsync(RaftServerProxy.java:404)
scm_1         | 	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
datanode_4_1  | 2020-04-17 18:54:08,678 [Command processor thread] INFO segmented.SegmentedRaftLogWorker: a0acbcec-d753-414c-b077-647d02aaa7fb@group-79E0035D853A-SegmentedRaftLogWorker close()
datanode_5_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupManagementAsync(RaftServerProxy.java:367)
datanode_6_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupManagementAsync(RaftServerProxy.java:367)
datanode_5_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupManagement(RaftServerProxy.java:350)
scm_1         | 	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
datanode_4_1  | 2020-04-17 18:54:08,678 [Command processor thread] INFO metrics.RatisMetrics: Unregistering Metrics Registry : ratis.log_worker.a0acbcec-d753-414c-b077-647d02aaa7fb
datanode_6_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupManagement(RaftServerProxy.java:350)
datanode_5_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.XceiverServerRatis.removeGroup(XceiverServerRatis.java:657)
scm_1         | 	at java.base/java.lang.Thread.run(Thread.java:834)
datanode_4_1  | 2020-04-17 18:54:08,678 [Command processor thread] INFO metrics.RatisMetrics: Unregistering Metrics Registry : ratis.leader_election.a0acbcec-d753-414c-b077-647d02aaa7fb@group-79E0035D853A
datanode_6_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.XceiverServerRatis.removeGroup(XceiverServerRatis.java:657)
datanode_5_1  | 	... 4 more
scm_1         | 2020-04-17 18:53:43,673 [RatisPipelineUtilsThread] INFO pipeline.RatisPipelineProvider: Send pipeline:PipelineID=cad403d1-ea2f-4530-84e5-79e0035d853a close command to datanode a0acbcec-d753-414c-b077-647d02aaa7fb
datanode_4_1  | 2020-04-17 18:54:08,678 [Command processor thread] INFO metrics.RatisMetrics: Unregistering Metrics Registry : ratis.server.a0acbcec-d753-414c-b077-647d02aaa7fb@group-79E0035D853A
datanode_6_1  | 	... 4 more
datanode_4_1  | 2020-04-17 18:54:08,679 [Command processor thread] INFO commandhandler.ClosePipelineCommandHandler: Close Pipeline #id: "cad403d1-ea2f-4530-84e5-79e0035d853a"
scm_1         | 2020-04-17 18:53:43,673 [RatisPipelineUtilsThread] INFO pipeline.RatisPipelineProvider: Send pipeline:PipelineID=cad403d1-ea2f-4530-84e5-79e0035d853a close command to datanode 0e99e1b0-220f-42bd-a39f-d4658f80d0e4
datanode_6_1  | 2020-04-17 18:55:43,669 [Command processor thread] INFO impl.RaftServerProxy: 79669a1f-2445-496e-a337-3115205f3ae5: remove group-CFD51574C841:null
datanode_4_1  |  command on datanode #a0acbcec-d753-414c-b077-647d02aaa7fb.
scm_1         | 2020-04-17 18:53:43,673 [RatisPipelineUtilsThread] INFO pipeline.RatisPipelineProvider: Send pipeline:PipelineID=cad403d1-ea2f-4530-84e5-79e0035d853a close command to datanode 978c057e-5c38-4e20-8a8b-f271c823af7e
datanode_4_1  | 2020-04-17 18:54:08,679 [Command processor thread] INFO impl.RaftServerProxy: a0acbcec-d753-414c-b077-647d02aaa7fb: remove group-79E0035D853A:null
datanode_6_1  | 2020-04-17 18:55:43,672 [Command processor thread] ERROR commandhandler.ClosePipelineCommandHandler: Can't close pipeline #id: "825f4d0e-2629-43e6-a52f-cfd51574c841"
scm_1         | 2020-04-17 18:53:43,674 [RatisPipelineUtilsThread] ERROR pipeline.SCMPipelineManager: Destroy pipeline failed for pipeline:Pipeline[ Id: cad403d1-ea2f-4530-84e5-79e0035d853a, Nodes: a0acbcec-d753-414c-b077-647d02aaa7fb{ip: 10.5.0.7, host: ozone-topology_datanode_4_1.ozone-topology_net, networkLocation: /rack2, certSerialId: null}0e99e1b0-220f-42bd-a39f-d4658f80d0e4{ip: 10.5.0.5, host: ozone-topology_datanode_2_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}978c057e-5c38-4e20-8a8b-f271c823af7e{ip: 10.5.0.8, host: ozone-topology_datanode_5_1.ozone-topology_net, networkLocation: /rack2, certSerialId: null}, Type:RATIS, Factor:THREE, State:CLOSED, leaderId:978c057e-5c38-4e20-8a8b-f271c823af7e, CreationTimestamp2020-04-17T18:52:04.783559Z]
datanode_4_1  | 2020-04-17 18:54:08,680 [Command processor thread] ERROR commandhandler.ClosePipelineCommandHandler: Can't close pipeline #id: "cad403d1-ea2f-4530-84e5-79e0035d853a"
datanode_6_1  | 
scm_1         | org.apache.hadoop.hdds.scm.pipeline.PipelineNotFoundException: PipelineID=cad403d1-ea2f-4530-84e5-79e0035d853a not found
datanode_4_1  | 
datanode_6_1  | java.io.IOException: 79669a1f-2445-496e-a337-3115205f3ae5: Group group-CFD51574C841 not found.
scm_1         | 	at org.apache.hadoop.hdds.scm.pipeline.PipelineStateMap.getPipeline(PipelineStateMap.java:133)
datanode_4_1  | java.io.IOException: a0acbcec-d753-414c-b077-647d02aaa7fb: Group group-79E0035D853A not found.
datanode_6_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.XceiverServerRatis.removeGroup(XceiverServerRatis.java:659)
scm_1         | 	at org.apache.hadoop.hdds.scm.pipeline.PipelineStateMap.removePipeline(PipelineStateMap.java:323)
datanode_4_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.XceiverServerRatis.removeGroup(XceiverServerRatis.java:659)
datanode_6_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.ClosePipelineCommandHandler.handle(ClosePipelineCommandHandler.java:77)
scm_1         | 	at org.apache.hadoop.hdds.scm.pipeline.PipelineStateManager.removePipeline(PipelineStateManager.java:104)
datanode_4_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.ClosePipelineCommandHandler.handle(ClosePipelineCommandHandler.java:77)
datanode_6_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.CommandDispatcher.handle(CommandDispatcher.java:99)
scm_1         | 	at org.apache.hadoop.hdds.scm.pipeline.SCMPipelineManager.removePipeline(SCMPipelineManager.java:595)
datanode_4_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.CommandDispatcher.handle(CommandDispatcher.java:99)
datanode_6_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.lambda$initCommandHandlerThread$1(DatanodeStateMachine.java:472)
scm_1         | 	at org.apache.hadoop.hdds.scm.pipeline.SCMPipelineManager.destroyPipeline(SCMPipelineManager.java:579)
datanode_4_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.lambda$initCommandHandlerThread$1(DatanodeStateMachine.java:472)
datanode_6_1  | 	at java.base/java.lang.Thread.run(Thread.java:834)
scm_1         | 	at org.apache.hadoop.hdds.scm.pipeline.SCMPipelineManager.lambda$finalizeAndDestroyPipeline$0(SCMPipelineManager.java:422)
datanode_4_1  | 	at java.base/java.lang.Thread.run(Thread.java:834)
datanode_6_1  | Caused by: org.apache.ratis.protocol.GroupMismatchException: 79669a1f-2445-496e-a337-3115205f3ae5: Group group-CFD51574C841 not found.
scm_1         | 	at org.apache.hadoop.hdds.utils.Scheduler.lambda$schedule$1(Scheduler.java:70)
datanode_4_1  | Caused by: org.apache.ratis.protocol.GroupMismatchException: a0acbcec-d753-414c-b077-647d02aaa7fb: Group group-79E0035D853A not found.
datanode_6_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupRemoveAsync(RaftServerProxy.java:404)
scm_1         | 	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
datanode_4_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupRemoveAsync(RaftServerProxy.java:404)
datanode_6_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupManagementAsync(RaftServerProxy.java:367)
scm_1         | 	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
datanode_4_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupManagementAsync(RaftServerProxy.java:367)
datanode_6_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupManagement(RaftServerProxy.java:350)
scm_1         | 	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:304)
datanode_4_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupManagement(RaftServerProxy.java:350)
datanode_6_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.XceiverServerRatis.removeGroup(XceiverServerRatis.java:657)
datanode_4_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.XceiverServerRatis.removeGroup(XceiverServerRatis.java:657)
datanode_6_1  | 	... 4 more
scm_1         | 	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
datanode_4_1  | 	... 4 more
datanode_6_1  | 2020-04-17 18:55:43,672 [Command processor thread] INFO impl.RaftServerProxy: 79669a1f-2445-496e-a337-3115205f3ae5: remove group-CFD51574C841:null
scm_1         | 	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
datanode_4_1  | 2020-04-17 18:54:08,680 [Command processor thread] INFO impl.RaftServerProxy: a0acbcec-d753-414c-b077-647d02aaa7fb: remove group-79E0035D853A:null
scm_1         | 	at java.base/java.lang.Thread.run(Thread.java:834)
datanode_4_1  | 2020-04-17 18:54:08,680 [Command processor thread] ERROR commandhandler.ClosePipelineCommandHandler: Can't close pipeline #id: "cad403d1-ea2f-4530-84e5-79e0035d853a"
datanode_4_1  | 
datanode_4_1  | java.io.IOException: a0acbcec-d753-414c-b077-647d02aaa7fb: Group group-79E0035D853A not found.
datanode_6_1  | 2020-04-17 18:55:43,672 [Command processor thread] ERROR commandhandler.ClosePipelineCommandHandler: Can't close pipeline #id: "825f4d0e-2629-43e6-a52f-cfd51574c841"
scm_1         | 2020-04-17 18:53:43,680 [RatisPipelineUtilsThread] INFO pipeline.RatisPipelineProvider: Send pipeline:PipelineID=cad403d1-ea2f-4530-84e5-79e0035d853a close command to datanode a0acbcec-d753-414c-b077-647d02aaa7fb
datanode_4_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.XceiverServerRatis.removeGroup(XceiverServerRatis.java:659)
datanode_6_1  | 
scm_1         | 2020-04-17 18:53:43,680 [RatisPipelineUtilsThread] INFO pipeline.RatisPipelineProvider: Send pipeline:PipelineID=cad403d1-ea2f-4530-84e5-79e0035d853a close command to datanode 0e99e1b0-220f-42bd-a39f-d4658f80d0e4
datanode_4_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.ClosePipelineCommandHandler.handle(ClosePipelineCommandHandler.java:77)
scm_1         | 2020-04-17 18:53:43,680 [RatisPipelineUtilsThread] INFO pipeline.RatisPipelineProvider: Send pipeline:PipelineID=cad403d1-ea2f-4530-84e5-79e0035d853a close command to datanode 978c057e-5c38-4e20-8a8b-f271c823af7e
datanode_4_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.CommandDispatcher.handle(CommandDispatcher.java:99)
datanode_6_1  | java.io.IOException: 79669a1f-2445-496e-a337-3115205f3ae5: Group group-CFD51574C841 not found.
scm_1         | 2020-04-17 18:53:43,680 [RatisPipelineUtilsThread] ERROR pipeline.SCMPipelineManager: Destroy pipeline failed for pipeline:Pipeline[ Id: cad403d1-ea2f-4530-84e5-79e0035d853a, Nodes: a0acbcec-d753-414c-b077-647d02aaa7fb{ip: 10.5.0.7, host: ozone-topology_datanode_4_1.ozone-topology_net, networkLocation: /rack2, certSerialId: null}0e99e1b0-220f-42bd-a39f-d4658f80d0e4{ip: 10.5.0.5, host: ozone-topology_datanode_2_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}978c057e-5c38-4e20-8a8b-f271c823af7e{ip: 10.5.0.8, host: ozone-topology_datanode_5_1.ozone-topology_net, networkLocation: /rack2, certSerialId: null}, Type:RATIS, Factor:THREE, State:CLOSED, leaderId:978c057e-5c38-4e20-8a8b-f271c823af7e, CreationTimestamp2020-04-17T18:52:04.783559Z]
datanode_6_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.XceiverServerRatis.removeGroup(XceiverServerRatis.java:659)
datanode_4_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.lambda$initCommandHandlerThread$1(DatanodeStateMachine.java:472)
scm_1         | org.apache.hadoop.hdds.scm.pipeline.PipelineNotFoundException: PipelineID=cad403d1-ea2f-4530-84e5-79e0035d853a not found
datanode_6_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.ClosePipelineCommandHandler.handle(ClosePipelineCommandHandler.java:77)
datanode_4_1  | 	at java.base/java.lang.Thread.run(Thread.java:834)
scm_1         | 	at org.apache.hadoop.hdds.scm.pipeline.PipelineStateMap.getPipeline(PipelineStateMap.java:133)
datanode_6_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.CommandDispatcher.handle(CommandDispatcher.java:99)
datanode_4_1  | Caused by: org.apache.ratis.protocol.GroupMismatchException: a0acbcec-d753-414c-b077-647d02aaa7fb: Group group-79E0035D853A not found.
scm_1         | 	at org.apache.hadoop.hdds.scm.pipeline.PipelineStateMap.removePipeline(PipelineStateMap.java:323)
datanode_6_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.lambda$initCommandHandlerThread$1(DatanodeStateMachine.java:472)
datanode_4_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupRemoveAsync(RaftServerProxy.java:404)
scm_1         | 	at org.apache.hadoop.hdds.scm.pipeline.PipelineStateManager.removePipeline(PipelineStateManager.java:104)
datanode_6_1  | 	at java.base/java.lang.Thread.run(Thread.java:834)
datanode_4_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupManagementAsync(RaftServerProxy.java:367)
scm_1         | 	at org.apache.hadoop.hdds.scm.pipeline.SCMPipelineManager.removePipeline(SCMPipelineManager.java:595)
datanode_6_1  | Caused by: org.apache.ratis.protocol.GroupMismatchException: 79669a1f-2445-496e-a337-3115205f3ae5: Group group-CFD51574C841 not found.
datanode_4_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupManagement(RaftServerProxy.java:350)
scm_1         | 	at org.apache.hadoop.hdds.scm.pipeline.SCMPipelineManager.destroyPipeline(SCMPipelineManager.java:579)
datanode_6_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupRemoveAsync(RaftServerProxy.java:404)
datanode_4_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.XceiverServerRatis.removeGroup(XceiverServerRatis.java:657)
scm_1         | 	at org.apache.hadoop.hdds.scm.pipeline.SCMPipelineManager.lambda$finalizeAndDestroyPipeline$0(SCMPipelineManager.java:422)
datanode_6_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupManagementAsync(RaftServerProxy.java:367)
datanode_4_1  | 	... 4 more
scm_1         | 	at org.apache.hadoop.hdds.utils.Scheduler.lambda$schedule$1(Scheduler.java:70)
datanode_6_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupManagement(RaftServerProxy.java:350)
scm_1         | 	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
datanode_4_1  | 2020-04-17 18:54:08,680 [Command processor thread] INFO impl.RaftServerProxy: a0acbcec-d753-414c-b077-647d02aaa7fb: remove group-79E0035D853A:null
datanode_6_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.XceiverServerRatis.removeGroup(XceiverServerRatis.java:657)
scm_1         | 	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
datanode_4_1  | 2020-04-17 18:54:08,680 [Command processor thread] ERROR commandhandler.ClosePipelineCommandHandler: Can't close pipeline #id: "cad403d1-ea2f-4530-84e5-79e0035d853a"
scm_1         | 	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:304)
scm_1         | 	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
datanode_6_1  | 	... 4 more
scm_1         | 	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
datanode_4_1  | 
datanode_6_1  | 2020-04-17 18:55:43,673 [Command processor thread] INFO impl.RaftServerProxy: 79669a1f-2445-496e-a337-3115205f3ae5: remove group-CFD51574C841:null
scm_1         | 	at java.base/java.lang.Thread.run(Thread.java:834)
datanode_4_1  | java.io.IOException: a0acbcec-d753-414c-b077-647d02aaa7fb: Group group-79E0035D853A not found.
datanode_6_1  | 2020-04-17 18:55:43,673 [Command processor thread] ERROR commandhandler.ClosePipelineCommandHandler: Can't close pipeline #id: "825f4d0e-2629-43e6-a52f-cfd51574c841"
scm_1         | 2020-04-17 18:54:03,520 [EventQueue-PipelineReportForPipelineReportHandler] INFO pipeline.PipelineStateManager: Pipeline Pipeline[ Id: 825f4d0e-2629-43e6-a52f-cfd51574c841, Nodes: 978c057e-5c38-4e20-8a8b-f271c823af7e{ip: 10.5.0.8, host: ozone-topology_datanode_5_1.ozone-topology_net, networkLocation: /rack2, certSerialId: null}0e99e1b0-220f-42bd-a39f-d4658f80d0e4{ip: 10.5.0.5, host: ozone-topology_datanode_2_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}79669a1f-2445-496e-a337-3115205f3ae5{ip: 10.5.0.9, host: ozone-topology_datanode_6_1.ozone-topology_net, networkLocation: /rack2, certSerialId: null}, Type:RATIS, Factor:THREE, State:ALLOCATED, leaderId:0e99e1b0-220f-42bd-a39f-d4658f80d0e4, CreationTimestamp2020-04-17T18:53:43.632228Z] moved to OPEN state
datanode_4_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.XceiverServerRatis.removeGroup(XceiverServerRatis.java:659)
datanode_6_1  | 
scm_1         | 2020-04-17 18:54:12,583 [EventQueue-PipelineActionsForPipelineActionHandler] INFO pipeline.PipelineActionHandler: Received pipeline action CLOSE for PipelineID=825f4d0e-2629-43e6-a52f-cfd51574c841 from datanode 978c057e-5c38-4e20-8a8b-f271c823af7e. Reason : ContainerID 4 creation failed
datanode_4_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.ClosePipelineCommandHandler.handle(ClosePipelineCommandHandler.java:77)
datanode_6_1  | java.io.IOException: 79669a1f-2445-496e-a337-3115205f3ae5: Group group-CFD51574C841 not found.
scm_1         | 2020-04-17 18:54:12,584 [EventQueue-PipelineActionsForPipelineActionHandler] INFO pipeline.SCMPipelineManager: Destroying pipeline:Pipeline[ Id: 825f4d0e-2629-43e6-a52f-cfd51574c841, Nodes: 978c057e-5c38-4e20-8a8b-f271c823af7e{ip: 10.5.0.8, host: ozone-topology_datanode_5_1.ozone-topology_net, networkLocation: /rack2, certSerialId: null}0e99e1b0-220f-42bd-a39f-d4658f80d0e4{ip: 10.5.0.5, host: ozone-topology_datanode_2_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}79669a1f-2445-496e-a337-3115205f3ae5{ip: 10.5.0.9, host: ozone-topology_datanode_6_1.ozone-topology_net, networkLocation: /rack2, certSerialId: null}, Type:RATIS, Factor:THREE, State:OPEN, leaderId:0e99e1b0-220f-42bd-a39f-d4658f80d0e4, CreationTimestamp2020-04-17T18:53:43.632228Z]
datanode_4_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.CommandDispatcher.handle(CommandDispatcher.java:99)
datanode_6_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.XceiverServerRatis.removeGroup(XceiverServerRatis.java:659)
datanode_4_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.lambda$initCommandHandlerThread$1(DatanodeStateMachine.java:472)
scm_1         | 2020-04-17 18:54:12,584 [EventQueue-PipelineActionsForPipelineActionHandler] INFO pipeline.PipelineStateManager: Pipeline Pipeline[ Id: 825f4d0e-2629-43e6-a52f-cfd51574c841, Nodes: 978c057e-5c38-4e20-8a8b-f271c823af7e{ip: 10.5.0.8, host: ozone-topology_datanode_5_1.ozone-topology_net, networkLocation: /rack2, certSerialId: null}0e99e1b0-220f-42bd-a39f-d4658f80d0e4{ip: 10.5.0.5, host: ozone-topology_datanode_2_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}79669a1f-2445-496e-a337-3115205f3ae5{ip: 10.5.0.9, host: ozone-topology_datanode_6_1.ozone-topology_net, networkLocation: /rack2, certSerialId: null}, Type:RATIS, Factor:THREE, State:CLOSED, leaderId:0e99e1b0-220f-42bd-a39f-d4658f80d0e4, CreationTimestamp2020-04-17T18:53:43.632228Z] moved to CLOSED state
datanode_6_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.ClosePipelineCommandHandler.handle(ClosePipelineCommandHandler.java:77)
datanode_4_1  | 	at java.base/java.lang.Thread.run(Thread.java:834)
scm_1         | 2020-04-17 18:54:12,585 [EventQueue-CloseContainerForCloseContainerEventHandler] INFO container.CloseContainerEventHandler: Close container Event triggered for container : #4
datanode_6_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.CommandDispatcher.handle(CommandDispatcher.java:99)
datanode_4_1  | Caused by: org.apache.ratis.protocol.GroupMismatchException: a0acbcec-d753-414c-b077-647d02aaa7fb: Group group-79E0035D853A not found.
scm_1         | 2020-04-17 18:54:12,595 [EventQueue-PipelineActionsForPipelineActionHandler] INFO pipeline.PipelineActionHandler: Received pipeline action CLOSE for PipelineID=825f4d0e-2629-43e6-a52f-cfd51574c841 from datanode 0e99e1b0-220f-42bd-a39f-d4658f80d0e4. Reason : ContainerID 4 creation failed
datanode_6_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.lambda$initCommandHandlerThread$1(DatanodeStateMachine.java:472)
datanode_4_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupRemoveAsync(RaftServerProxy.java:404)
scm_1         | 2020-04-17 18:54:12,597 [EventQueue-PipelineActionsForPipelineActionHandler] INFO pipeline.SCMPipelineManager: Destroying pipeline:Pipeline[ Id: 825f4d0e-2629-43e6-a52f-cfd51574c841, Nodes: 978c057e-5c38-4e20-8a8b-f271c823af7e{ip: 10.5.0.8, host: ozone-topology_datanode_5_1.ozone-topology_net, networkLocation: /rack2, certSerialId: null}0e99e1b0-220f-42bd-a39f-d4658f80d0e4{ip: 10.5.0.5, host: ozone-topology_datanode_2_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}79669a1f-2445-496e-a337-3115205f3ae5{ip: 10.5.0.9, host: ozone-topology_datanode_6_1.ozone-topology_net, networkLocation: /rack2, certSerialId: null}, Type:RATIS, Factor:THREE, State:CLOSED, leaderId:0e99e1b0-220f-42bd-a39f-d4658f80d0e4, CreationTimestamp2020-04-17T18:53:43.632228Z]
datanode_6_1  | 	at java.base/java.lang.Thread.run(Thread.java:834)
datanode_4_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupManagementAsync(RaftServerProxy.java:367)
scm_1         | 2020-04-17 18:54:12,600 [EventQueue-PipelineActionsForPipelineActionHandler] INFO pipeline.PipelineActionHandler: Received pipeline action CLOSE for PipelineID=825f4d0e-2629-43e6-a52f-cfd51574c841 from datanode 978c057e-5c38-4e20-8a8b-f271c823af7e. Reason : Log already failed at index 1 for task WriteLog:1: (t:1, i:1), STATEMACHINELOGENTRY, client-191241DA7A93, cid=70
datanode_6_1  | Caused by: org.apache.ratis.protocol.GroupMismatchException: 79669a1f-2445-496e-a337-3115205f3ae5: Group group-CFD51574C841 not found.
datanode_4_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupManagement(RaftServerProxy.java:350)
scm_1         | 	 State Machine: cmdType: WriteChunk traceID: "25f4cbb29a905ffd:e4110cf328601a91:25f4cbb29a905ffd:0" containerID: 4 datanodeUuid: "978c057e-5c38-4e20-8a8b-f271c823af7e" pipelineID: "825f4d0e-2629-43e6-a52f-cfd51574c841" writeChunk { blockID { containerID: 4 localID: 104015439626764310 blockCommitSequenceId: 0 } chunkData { chunkName: "104015439626764310_chunk_1" offset: 0 len: 10240 checksumData { type: CRC32 bytesPerChecksum: 1048576 checksums: ">\344\315\231" } } }, container path=nonexistent
datanode_6_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupRemoveAsync(RaftServerProxy.java:404)
datanode_6_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupManagementAsync(RaftServerProxy.java:367)
datanode_4_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.XceiverServerRatis.removeGroup(XceiverServerRatis.java:657)
datanode_4_1  | 	... 4 more
datanode_6_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupManagement(RaftServerProxy.java:350)
datanode_6_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.XceiverServerRatis.removeGroup(XceiverServerRatis.java:657)
scm_1         | 2020-04-17 18:54:12,601 [EventQueue-PipelineActionsForPipelineActionHandler] INFO pipeline.SCMPipelineManager: Destroying pipeline:Pipeline[ Id: 825f4d0e-2629-43e6-a52f-cfd51574c841, Nodes: 978c057e-5c38-4e20-8a8b-f271c823af7e{ip: 10.5.0.8, host: ozone-topology_datanode_5_1.ozone-topology_net, networkLocation: /rack2, certSerialId: null}0e99e1b0-220f-42bd-a39f-d4658f80d0e4{ip: 10.5.0.5, host: ozone-topology_datanode_2_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}79669a1f-2445-496e-a337-3115205f3ae5{ip: 10.5.0.9, host: ozone-topology_datanode_6_1.ozone-topology_net, networkLocation: /rack2, certSerialId: null}, Type:RATIS, Factor:THREE, State:CLOSED, leaderId:0e99e1b0-220f-42bd-a39f-d4658f80d0e4, CreationTimestamp2020-04-17T18:53:43.632228Z]
datanode_4_1  | 2020-04-17 18:54:08,681 [Command processor thread] INFO impl.RaftServerProxy: a0acbcec-d753-414c-b077-647d02aaa7fb: remove group-79E0035D853A:null
datanode_6_1  | 	... 4 more
scm_1         | 2020-04-17 18:54:12,610 [EventQueue-PipelineActionsForPipelineActionHandler] INFO pipeline.PipelineActionHandler: Received pipeline action CLOSE for PipelineID=825f4d0e-2629-43e6-a52f-cfd51574c841 from datanode 0e99e1b0-220f-42bd-a39f-d4658f80d0e4. Reason : Log already failed at index 1 for task WriteLog:1: (t:1, i:1), STATEMACHINELOGENTRY, client-191241DA7A93, cid=70
datanode_4_1  | 2020-04-17 18:54:08,681 [Command processor thread] ERROR commandhandler.ClosePipelineCommandHandler: Can't close pipeline #id: "cad403d1-ea2f-4530-84e5-79e0035d853a"
scm_1         | 	 State Machine: cmdType: WriteChunk traceID: "25f4cbb29a905ffd:e4110cf328601a91:25f4cbb29a905ffd:0" containerID: 4 datanodeUuid: "978c057e-5c38-4e20-8a8b-f271c823af7e" pipelineID: "825f4d0e-2629-43e6-a52f-cfd51574c841" writeChunk { blockID { containerID: 4 localID: 104015439626764310 blockCommitSequenceId: 0 } chunkData { chunkName: "104015439626764310_chunk_1" offset: 0 len: 10240 checksumData { type: CRC32 bytesPerChecksum: 1048576 checksums: ">\344\315\231" } } }, container path=nonexistent
scm_1         | 2020-04-17 18:54:12,610 [EventQueue-PipelineActionsForPipelineActionHandler] INFO pipeline.SCMPipelineManager: Destroying pipeline:Pipeline[ Id: 825f4d0e-2629-43e6-a52f-cfd51574c841, Nodes: 978c057e-5c38-4e20-8a8b-f271c823af7e{ip: 10.5.0.8, host: ozone-topology_datanode_5_1.ozone-topology_net, networkLocation: /rack2, certSerialId: null}0e99e1b0-220f-42bd-a39f-d4658f80d0e4{ip: 10.5.0.5, host: ozone-topology_datanode_2_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}79669a1f-2445-496e-a337-3115205f3ae5{ip: 10.5.0.9, host: ozone-topology_datanode_6_1.ozone-topology_net, networkLocation: /rack2, certSerialId: null}, Type:RATIS, Factor:THREE, State:CLOSED, leaderId:0e99e1b0-220f-42bd-a39f-d4658f80d0e4, CreationTimestamp2020-04-17T18:53:43.632228Z]
datanode_4_1  | 
scm_1         | 2020-04-17 18:54:12,615 [EventQueue-PipelineActionsForPipelineActionHandler] INFO pipeline.PipelineActionHandler: Received pipeline action CLOSE for PipelineID=825f4d0e-2629-43e6-a52f-cfd51574c841 from datanode 79669a1f-2445-496e-a337-3115205f3ae5. Reason : ContainerID 4 creation failed
datanode_4_1  | java.io.IOException: a0acbcec-d753-414c-b077-647d02aaa7fb: Group group-79E0035D853A not found.
scm_1         | 2020-04-17 18:54:12,615 [EventQueue-PipelineActionsForPipelineActionHandler] INFO pipeline.SCMPipelineManager: Destroying pipeline:Pipeline[ Id: 825f4d0e-2629-43e6-a52f-cfd51574c841, Nodes: 978c057e-5c38-4e20-8a8b-f271c823af7e{ip: 10.5.0.8, host: ozone-topology_datanode_5_1.ozone-topology_net, networkLocation: /rack2, certSerialId: null}0e99e1b0-220f-42bd-a39f-d4658f80d0e4{ip: 10.5.0.5, host: ozone-topology_datanode_2_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}79669a1f-2445-496e-a337-3115205f3ae5{ip: 10.5.0.9, host: ozone-topology_datanode_6_1.ozone-topology_net, networkLocation: /rack2, certSerialId: null}, Type:RATIS, Factor:THREE, State:CLOSED, leaderId:0e99e1b0-220f-42bd-a39f-d4658f80d0e4, CreationTimestamp2020-04-17T18:53:43.632228Z]
datanode_4_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.XceiverServerRatis.removeGroup(XceiverServerRatis.java:659)
scm_1         | 2020-04-17 18:54:12,649 [EventQueue-PipelineActionsForPipelineActionHandler] INFO pipeline.PipelineActionHandler: Received pipeline action CLOSE for PipelineID=825f4d0e-2629-43e6-a52f-cfd51574c841 from datanode 79669a1f-2445-496e-a337-3115205f3ae5. Reason : Log already failed at index 1 for task WriteLog:1: (t:1, i:1), STATEMACHINELOGENTRY, client-191241DA7A93, cid=70
datanode_4_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.ClosePipelineCommandHandler.handle(ClosePipelineCommandHandler.java:77)
scm_1         | 	 State Machine: cmdType: WriteChunk traceID: "25f4cbb29a905ffd:e4110cf328601a91:25f4cbb29a905ffd:0" containerID: 4 datanodeUuid: "978c057e-5c38-4e20-8a8b-f271c823af7e" pipelineID: "825f4d0e-2629-43e6-a52f-cfd51574c841" writeChunk { blockID { containerID: 4 localID: 104015439626764310 blockCommitSequenceId: 0 } chunkData { chunkName: "104015439626764310_chunk_1" offset: 0 len: 10240 checksumData { type: CRC32 bytesPerChecksum: 1048576 checksums: ">\344\315\231" } } }, container path=nonexistent
datanode_4_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.CommandDispatcher.handle(CommandDispatcher.java:99)
scm_1         | 2020-04-17 18:54:12,649 [EventQueue-PipelineActionsForPipelineActionHandler] INFO pipeline.SCMPipelineManager: Destroying pipeline:Pipeline[ Id: 825f4d0e-2629-43e6-a52f-cfd51574c841, Nodes: 978c057e-5c38-4e20-8a8b-f271c823af7e{ip: 10.5.0.8, host: ozone-topology_datanode_5_1.ozone-topology_net, networkLocation: /rack2, certSerialId: null}0e99e1b0-220f-42bd-a39f-d4658f80d0e4{ip: 10.5.0.5, host: ozone-topology_datanode_2_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}79669a1f-2445-496e-a337-3115205f3ae5{ip: 10.5.0.9, host: ozone-topology_datanode_6_1.ozone-topology_net, networkLocation: /rack2, certSerialId: null}, Type:RATIS, Factor:THREE, State:CLOSED, leaderId:0e99e1b0-220f-42bd-a39f-d4658f80d0e4, CreationTimestamp2020-04-17T18:53:43.632228Z]
datanode_4_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.lambda$initCommandHandlerThread$1(DatanodeStateMachine.java:472)
scm_1         | 2020-04-17 18:54:34,640 [RatisPipelineUtilsThread] ERROR pipeline.SCMPipelineManager: Failed to create pipeline of type RATIS and factor ONE. Exception: Cannot create pipeline of factor 1 using 0 nodes. Used 6 nodes. Healthy nodes 6
datanode_4_1  | 	at java.base/java.lang.Thread.run(Thread.java:834)
scm_1         | 2020-04-17 18:54:34,641 [RatisPipelineUtilsThread] INFO pipeline.RatisPipelineProvider: Sending CreatePipelineCommand for pipeline:PipelineID=b5a22a8d-2392-4c7a-923f-95c80522151f to datanode:0e99e1b0-220f-42bd-a39f-d4658f80d0e4
datanode_4_1  | Caused by: org.apache.ratis.protocol.GroupMismatchException: a0acbcec-d753-414c-b077-647d02aaa7fb: Group group-79E0035D853A not found.
scm_1         | 2020-04-17 18:54:34,641 [RatisPipelineUtilsThread] INFO pipeline.RatisPipelineProvider: Sending CreatePipelineCommand for pipeline:PipelineID=b5a22a8d-2392-4c7a-923f-95c80522151f to datanode:a0acbcec-d753-414c-b077-647d02aaa7fb
datanode_4_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupRemoveAsync(RaftServerProxy.java:404)
scm_1         | 2020-04-17 18:54:34,642 [RatisPipelineUtilsThread] INFO pipeline.RatisPipelineProvider: Sending CreatePipelineCommand for pipeline:PipelineID=b5a22a8d-2392-4c7a-923f-95c80522151f to datanode:b23d8fb0-3698-40b4-ac98-17b8605a770b
datanode_4_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupManagementAsync(RaftServerProxy.java:367)
scm_1         | 2020-04-17 18:54:34,642 [RatisPipelineUtilsThread] INFO pipeline.PipelineStateManager: Created pipeline Pipeline[ Id: b5a22a8d-2392-4c7a-923f-95c80522151f, Nodes: 0e99e1b0-220f-42bd-a39f-d4658f80d0e4{ip: 10.5.0.5, host: ozone-topology_datanode_2_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}a0acbcec-d753-414c-b077-647d02aaa7fb{ip: 10.5.0.7, host: ozone-topology_datanode_4_1.ozone-topology_net, networkLocation: /rack2, certSerialId: null}b23d8fb0-3698-40b4-ac98-17b8605a770b{ip: 10.5.0.4, host: ozone-topology_datanode_1_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}, Type:RATIS, Factor:THREE, State:ALLOCATED, leaderId:null, CreationTimestamp2020-04-17T18:54:34.641801Z]
datanode_4_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupManagement(RaftServerProxy.java:350)
scm_1         | 2020-04-17 18:54:34,642 [RatisPipelineUtilsThread] ERROR pipeline.SCMPipelineManager: Failed to create pipeline of type RATIS and factor THREE. Exception: Pipeline creation failed because nodes are engaged in other pipelines and every node can only be engaged in max 2 pipelines. Required 3. Found 1
datanode_4_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.XceiverServerRatis.removeGroup(XceiverServerRatis.java:657)
scm_1         | 2020-04-17 18:54:43,790 [EventQueue-PipelineReportForPipelineReportHandler] INFO pipeline.PipelineStateManager: Pipeline Pipeline[ Id: b5a22a8d-2392-4c7a-923f-95c80522151f, Nodes: 0e99e1b0-220f-42bd-a39f-d4658f80d0e4{ip: 10.5.0.5, host: ozone-topology_datanode_2_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}a0acbcec-d753-414c-b077-647d02aaa7fb{ip: 10.5.0.7, host: ozone-topology_datanode_4_1.ozone-topology_net, networkLocation: /rack2, certSerialId: null}b23d8fb0-3698-40b4-ac98-17b8605a770b{ip: 10.5.0.4, host: ozone-topology_datanode_1_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}, Type:RATIS, Factor:THREE, State:ALLOCATED, leaderId:a0acbcec-d753-414c-b077-647d02aaa7fb, CreationTimestamp2020-04-17T18:54:34.641801Z] moved to OPEN state
datanode_4_1  | 	... 4 more
datanode_4_1  | 2020-04-17 18:54:08,681 [Command processor thread] INFO impl.RaftServerProxy: a0acbcec-d753-414c-b077-647d02aaa7fb: remove group-79E0035D853A:null
datanode_4_1  | 2020-04-17 18:54:08,681 [Command processor thread] ERROR commandhandler.ClosePipelineCommandHandler: Can't close pipeline #id: "cad403d1-ea2f-4530-84e5-79e0035d853a"
scm_1         | 2020-04-17 18:55:18,585 [RatisPipelineUtilsThread] INFO pipeline.RatisPipelineProvider: Send pipeline:PipelineID=825f4d0e-2629-43e6-a52f-cfd51574c841 close command to datanode 978c057e-5c38-4e20-8a8b-f271c823af7e
scm_1         | 2020-04-17 18:55:18,585 [RatisPipelineUtilsThread] INFO pipeline.RatisPipelineProvider: Send pipeline:PipelineID=825f4d0e-2629-43e6-a52f-cfd51574c841 close command to datanode 0e99e1b0-220f-42bd-a39f-d4658f80d0e4
datanode_4_1  | 
scm_1         | 2020-04-17 18:55:18,585 [RatisPipelineUtilsThread] INFO pipeline.RatisPipelineProvider: Send pipeline:PipelineID=825f4d0e-2629-43e6-a52f-cfd51574c841 close command to datanode 79669a1f-2445-496e-a337-3115205f3ae5
datanode_4_1  | java.io.IOException: a0acbcec-d753-414c-b077-647d02aaa7fb: Group group-79E0035D853A not found.
scm_1         | 2020-04-17 18:55:18,586 [RatisPipelineUtilsThread] INFO pipeline.PipelineStateManager: Pipeline Pipeline[ Id: 825f4d0e-2629-43e6-a52f-cfd51574c841, Nodes: 978c057e-5c38-4e20-8a8b-f271c823af7e{ip: 10.5.0.8, host: ozone-topology_datanode_5_1.ozone-topology_net, networkLocation: /rack2, certSerialId: null}0e99e1b0-220f-42bd-a39f-d4658f80d0e4{ip: 10.5.0.5, host: ozone-topology_datanode_2_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}79669a1f-2445-496e-a337-3115205f3ae5{ip: 10.5.0.9, host: ozone-topology_datanode_6_1.ozone-topology_net, networkLocation: /rack2, certSerialId: null}, Type:RATIS, Factor:THREE, State:CLOSED, leaderId:0e99e1b0-220f-42bd-a39f-d4658f80d0e4, CreationTimestamp2020-04-17T18:53:43.632228Z] removed from db
datanode_4_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.XceiverServerRatis.removeGroup(XceiverServerRatis.java:659)
scm_1         | 2020-04-17 18:55:18,587 [RatisPipelineUtilsThread] ERROR pipeline.SCMPipelineManager: Failed to create pipeline of type RATIS and factor ONE. Exception: Cannot create pipeline of factor 1 using 0 nodes. Used 6 nodes. Healthy nodes 6
datanode_4_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.ClosePipelineCommandHandler.handle(ClosePipelineCommandHandler.java:77)
scm_1         | 2020-04-17 18:55:18,587 [RatisPipelineUtilsThread] ERROR pipeline.SCMPipelineManager: Failed to create pipeline of type RATIS and factor THREE. Exception: Pipeline creation failed because nodes are engaged in other pipelines and every node can only be engaged in max 2 pipelines. Required 3. Found 1
datanode_4_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.CommandDispatcher.handle(CommandDispatcher.java:99)
scm_1         | 2020-04-17 18:55:18,597 [RatisPipelineUtilsThread] INFO pipeline.RatisPipelineProvider: Send pipeline:PipelineID=825f4d0e-2629-43e6-a52f-cfd51574c841 close command to datanode 978c057e-5c38-4e20-8a8b-f271c823af7e
datanode_4_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.lambda$initCommandHandlerThread$1(DatanodeStateMachine.java:472)
scm_1         | 2020-04-17 18:55:18,597 [RatisPipelineUtilsThread] INFO pipeline.RatisPipelineProvider: Send pipeline:PipelineID=825f4d0e-2629-43e6-a52f-cfd51574c841 close command to datanode 0e99e1b0-220f-42bd-a39f-d4658f80d0e4
datanode_4_1  | 	at java.base/java.lang.Thread.run(Thread.java:834)
scm_1         | 2020-04-17 18:55:18,598 [RatisPipelineUtilsThread] INFO pipeline.RatisPipelineProvider: Send pipeline:PipelineID=825f4d0e-2629-43e6-a52f-cfd51574c841 close command to datanode 79669a1f-2445-496e-a337-3115205f3ae5
datanode_4_1  | Caused by: org.apache.ratis.protocol.GroupMismatchException: a0acbcec-d753-414c-b077-647d02aaa7fb: Group group-79E0035D853A not found.
scm_1         | 2020-04-17 18:55:18,598 [RatisPipelineUtilsThread] ERROR pipeline.SCMPipelineManager: Destroy pipeline failed for pipeline:Pipeline[ Id: 825f4d0e-2629-43e6-a52f-cfd51574c841, Nodes: 978c057e-5c38-4e20-8a8b-f271c823af7e{ip: 10.5.0.8, host: ozone-topology_datanode_5_1.ozone-topology_net, networkLocation: /rack2, certSerialId: null}0e99e1b0-220f-42bd-a39f-d4658f80d0e4{ip: 10.5.0.5, host: ozone-topology_datanode_2_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}79669a1f-2445-496e-a337-3115205f3ae5{ip: 10.5.0.9, host: ozone-topology_datanode_6_1.ozone-topology_net, networkLocation: /rack2, certSerialId: null}, Type:RATIS, Factor:THREE, State:CLOSED, leaderId:0e99e1b0-220f-42bd-a39f-d4658f80d0e4, CreationTimestamp2020-04-17T18:53:43.632228Z]
datanode_4_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupRemoveAsync(RaftServerProxy.java:404)
scm_1         | org.apache.hadoop.hdds.scm.pipeline.PipelineNotFoundException: PipelineID=825f4d0e-2629-43e6-a52f-cfd51574c841 not found
datanode_4_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupManagementAsync(RaftServerProxy.java:367)
scm_1         | 	at org.apache.hadoop.hdds.scm.pipeline.PipelineStateMap.getPipeline(PipelineStateMap.java:133)
datanode_4_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupManagement(RaftServerProxy.java:350)
scm_1         | 	at org.apache.hadoop.hdds.scm.pipeline.PipelineStateMap.removePipeline(PipelineStateMap.java:323)
datanode_4_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.XceiverServerRatis.removeGroup(XceiverServerRatis.java:657)
scm_1         | 	at org.apache.hadoop.hdds.scm.pipeline.PipelineStateManager.removePipeline(PipelineStateManager.java:104)
datanode_4_1  | 	... 4 more
scm_1         | 	at org.apache.hadoop.hdds.scm.pipeline.SCMPipelineManager.removePipeline(SCMPipelineManager.java:595)
datanode_4_1  | 2020-04-17 18:54:38,675 [Command processor thread] INFO impl.RaftServerProxy: a0acbcec-d753-414c-b077-647d02aaa7fb: addNew group-95C80522151F:[b23d8fb0-3698-40b4-ac98-17b8605a770b:10.5.0.4:9858, a0acbcec-d753-414c-b077-647d02aaa7fb:10.5.0.7:9858, 0e99e1b0-220f-42bd-a39f-d4658f80d0e4:10.5.0.5:9858] returns group-95C80522151F:java.util.concurrent.CompletableFuture@69282d09[Not completed]
scm_1         | 	at org.apache.hadoop.hdds.scm.pipeline.SCMPipelineManager.destroyPipeline(SCMPipelineManager.java:579)
datanode_4_1  | 2020-04-17 18:54:38,676 [pool-69-thread-1] INFO impl.RaftServerImpl: a0acbcec-d753-414c-b077-647d02aaa7fb: new RaftServerImpl for group-95C80522151F:[b23d8fb0-3698-40b4-ac98-17b8605a770b:10.5.0.4:9858, a0acbcec-d753-414c-b077-647d02aaa7fb:10.5.0.7:9858, 0e99e1b0-220f-42bd-a39f-d4658f80d0e4:10.5.0.5:9858] with ContainerStateMachine:uninitialized
scm_1         | 	at org.apache.hadoop.hdds.scm.pipeline.SCMPipelineManager.lambda$finalizeAndDestroyPipeline$0(SCMPipelineManager.java:422)
datanode_4_1  | 2020-04-17 18:54:38,677 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.rpc.timeout.min = 5s (custom)
scm_1         | 	at org.apache.hadoop.hdds.utils.Scheduler.lambda$schedule$1(Scheduler.java:70)
datanode_4_1  | 2020-04-17 18:54:38,677 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.rpc.timeout.max = 5200ms (custom)
datanode_4_1  | 2020-04-17 18:54:38,677 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.rpcslowness.timeout = 300s (custom)
datanode_4_1  | 2020-04-17 18:54:38,678 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.sleep.deviation.threshold = 300 (default)
datanode_4_1  | 2020-04-17 18:54:38,678 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.appender.install.snapshot.enabled = false (custom)
datanode_4_1  | 2020-04-17 18:54:38,678 [pool-69-thread-1] INFO impl.RaftServerImpl: a0acbcec-d753-414c-b077-647d02aaa7fb@group-95C80522151F: ConfigurationManager, init=-1: [b23d8fb0-3698-40b4-ac98-17b8605a770b:10.5.0.4:9858, a0acbcec-d753-414c-b077-647d02aaa7fb:10.5.0.7:9858, 0e99e1b0-220f-42bd-a39f-d4658f80d0e4:10.5.0.5:9858], old=null, confs=<EMPTY_MAP>
scm_1         | 	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
scm_1         | 	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
scm_1         | 	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:304)
scm_1         | 	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
scm_1         | 	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
scm_1         | 	at java.base/java.lang.Thread.run(Thread.java:834)
scm_1         | 2020-04-17 18:55:18,601 [RatisPipelineUtilsThread] INFO pipeline.RatisPipelineProvider: Send pipeline:PipelineID=825f4d0e-2629-43e6-a52f-cfd51574c841 close command to datanode 978c057e-5c38-4e20-8a8b-f271c823af7e
scm_1         | 2020-04-17 18:55:18,601 [RatisPipelineUtilsThread] INFO pipeline.RatisPipelineProvider: Send pipeline:PipelineID=825f4d0e-2629-43e6-a52f-cfd51574c841 close command to datanode 0e99e1b0-220f-42bd-a39f-d4658f80d0e4
scm_1         | 2020-04-17 18:55:18,601 [RatisPipelineUtilsThread] INFO pipeline.RatisPipelineProvider: Send pipeline:PipelineID=825f4d0e-2629-43e6-a52f-cfd51574c841 close command to datanode 79669a1f-2445-496e-a337-3115205f3ae5
scm_1         | 2020-04-17 18:55:18,601 [RatisPipelineUtilsThread] ERROR pipeline.SCMPipelineManager: Destroy pipeline failed for pipeline:Pipeline[ Id: 825f4d0e-2629-43e6-a52f-cfd51574c841, Nodes: 978c057e-5c38-4e20-8a8b-f271c823af7e{ip: 10.5.0.8, host: ozone-topology_datanode_5_1.ozone-topology_net, networkLocation: /rack2, certSerialId: null}0e99e1b0-220f-42bd-a39f-d4658f80d0e4{ip: 10.5.0.5, host: ozone-topology_datanode_2_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}79669a1f-2445-496e-a337-3115205f3ae5{ip: 10.5.0.9, host: ozone-topology_datanode_6_1.ozone-topology_net, networkLocation: /rack2, certSerialId: null}, Type:RATIS, Factor:THREE, State:CLOSED, leaderId:0e99e1b0-220f-42bd-a39f-d4658f80d0e4, CreationTimestamp2020-04-17T18:53:43.632228Z]
scm_1         | org.apache.hadoop.hdds.scm.pipeline.PipelineNotFoundException: PipelineID=825f4d0e-2629-43e6-a52f-cfd51574c841 not found
scm_1         | 	at org.apache.hadoop.hdds.scm.pipeline.PipelineStateMap.getPipeline(PipelineStateMap.java:133)
scm_1         | 	at org.apache.hadoop.hdds.scm.pipeline.PipelineStateMap.removePipeline(PipelineStateMap.java:323)
scm_1         | 	at org.apache.hadoop.hdds.scm.pipeline.PipelineStateManager.removePipeline(PipelineStateManager.java:104)
scm_1         | 	at org.apache.hadoop.hdds.scm.pipeline.SCMPipelineManager.removePipeline(SCMPipelineManager.java:595)
scm_1         | 	at org.apache.hadoop.hdds.scm.pipeline.SCMPipelineManager.destroyPipeline(SCMPipelineManager.java:579)
scm_1         | 	at org.apache.hadoop.hdds.scm.pipeline.SCMPipelineManager.lambda$finalizeAndDestroyPipeline$0(SCMPipelineManager.java:422)
scm_1         | 	at org.apache.hadoop.hdds.utils.Scheduler.lambda$schedule$1(Scheduler.java:70)
scm_1         | 	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
scm_1         | 	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
scm_1         | 	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:304)
scm_1         | 	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
scm_1         | 	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
scm_1         | 	at java.base/java.lang.Thread.run(Thread.java:834)
scm_1         | 2020-04-17 18:55:18,611 [RatisPipelineUtilsThread] INFO pipeline.RatisPipelineProvider: Send pipeline:PipelineID=825f4d0e-2629-43e6-a52f-cfd51574c841 close command to datanode 978c057e-5c38-4e20-8a8b-f271c823af7e
scm_1         | 2020-04-17 18:55:18,611 [RatisPipelineUtilsThread] INFO pipeline.RatisPipelineProvider: Send pipeline:PipelineID=825f4d0e-2629-43e6-a52f-cfd51574c841 close command to datanode 0e99e1b0-220f-42bd-a39f-d4658f80d0e4
datanode_4_1  | 2020-04-17 18:54:38,678 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.storage.dir = [/data/metadata/ratis] (custom)
datanode_4_1  | 2020-04-17 18:54:38,678 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.corruption.policy = EXCEPTION (default)
datanode_4_1  | 2020-04-17 18:54:38,678 [pool-69-thread-1] INFO storage.RaftStorageDirectory: The storage directory /data/metadata/ratis/b5a22a8d-2392-4c7a-923f-95c80522151f does not exist. Creating ...
datanode_4_1  | 2020-04-17 18:54:38,680 [pool-69-thread-1] INFO storage.RaftStorageDirectory: Lock on /data/metadata/ratis/b5a22a8d-2392-4c7a-923f-95c80522151f/in_use.lock acquired by nodename 6@cea2015b57a1
datanode_4_1  | 2020-04-17 18:54:38,681 [pool-69-thread-1] INFO storage.RaftStorage: Storage directory /data/metadata/ratis/b5a22a8d-2392-4c7a-923f-95c80522151f has been successfully formatted.
datanode_4_1  | 2020-04-17 18:54:38,682 [pool-69-thread-1] INFO ratis.ContainerStateMachine: group-95C80522151F: The snapshot info is null. Setting the last applied indexto:(t:0, i:~)
datanode_4_1  | 2020-04-17 18:54:38,682 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.notification.no-leader.timeout = 60s (default)
datanode_4_1  | 2020-04-17 18:54:38,682 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.use.memory = false (default)
datanode_4_1  | 2020-04-17 18:54:38,682 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.purge.gap = 1000000 (custom)
datanode_4_1  | 2020-04-17 18:54:38,683 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
datanode_4_1  | 2020-04-17 18:54:38,683 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.segment.size.max = 1048576 (custom)
datanode_4_1  | 2020-04-17 18:54:38,683 [pool-69-thread-1] INFO metrics.RatisMetrics: Creating Metrics Registry : ratis.log_worker.a0acbcec-d753-414c-b077-647d02aaa7fb
datanode_4_1  | 2020-04-17 18:54:38,683 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.segment.cache.num.max = 2 (custom)
datanode_4_1  | 2020-04-17 18:54:38,683 [pool-69-thread-1] INFO segmented.SegmentedRaftLogWorker: new a0acbcec-d753-414c-b077-647d02aaa7fb@group-95C80522151F-SegmentedRaftLogWorker for RaftStorage:Storage Directory /data/metadata/ratis/b5a22a8d-2392-4c7a-923f-95c80522151f
datanode_4_1  | 2020-04-17 18:54:38,685 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.queue.byte-limit = 2147483647 (custom)
datanode_4_1  | 2020-04-17 18:54:38,686 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.queue.element-limit = 1024 (custom)
datanode_4_1  | 2020-04-17 18:54:38,686 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.segment.size.max = 1048576 (custom)
datanode_4_1  | 2020-04-17 18:54:38,686 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.preallocated.size = 16384 (custom)
datanode_4_1  | 2020-04-17 18:54:38,686 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.write.buffer.size = 1048576 (custom)
datanode_4_1  | 2020-04-17 18:54:38,686 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.force.sync.num = 128 (default)
datanode_4_1  | 2020-04-17 18:54:38,686 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.statemachine.data.sync = true (default)
datanode_4_1  | 2020-04-17 18:54:38,686 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.statemachine.data.sync.timeout = 10s (default)
datanode_4_1  | 2020-04-17 18:54:38,687 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
datanode_4_1  | 2020-04-17 18:54:38,688 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.log.statemachine.data.caching.enabled = true (custom)
datanode_4_1  | 2020-04-17 18:54:38,689 [pool-69-thread-1] INFO segmented.SegmentedRaftLogWorker: a0acbcec-d753-414c-b077-647d02aaa7fb@group-95C80522151F-SegmentedRaftLogWorker: flushIndex: setUnconditionally 0 -> -1
datanode_4_1  | 2020-04-17 18:54:38,690 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.snapshot.auto.trigger.enabled = true (custom)
datanode_4_1  | 2020-04-17 18:54:38,690 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
datanode_4_1  | 2020-04-17 18:54:38,690 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.snapshot.retention.file.num = 5 (custom)
datanode_4_1  | 2020-04-17 18:54:38,690 [pool-69-thread-1] INFO server.RaftServerConfigKeys: raft.server.retrycache.expirytime = 600000ms (custom)
datanode_4_1  | 2020-04-17 18:54:38,691 [pool-69-thread-1] INFO metrics.RatisMetrics: Creating Metrics Registry : ratis.leader_election.a0acbcec-d753-414c-b077-647d02aaa7fb@group-95C80522151F
datanode_4_1  | 2020-04-17 18:54:38,692 [pool-69-thread-1] INFO metrics.RatisMetrics: Creating Metrics Registry : ratis.server.a0acbcec-d753-414c-b077-647d02aaa7fb@group-95C80522151F
datanode_4_1  | 2020-04-17 18:54:38,692 [pool-69-thread-1] INFO impl.RaftServerImpl: a0acbcec-d753-414c-b077-647d02aaa7fb@group-95C80522151F: start as a follower, conf=-1: [b23d8fb0-3698-40b4-ac98-17b8605a770b:10.5.0.4:9858, a0acbcec-d753-414c-b077-647d02aaa7fb:10.5.0.7:9858, 0e99e1b0-220f-42bd-a39f-d4658f80d0e4:10.5.0.5:9858], old=null
datanode_4_1  | 2020-04-17 18:54:38,694 [pool-69-thread-1] INFO impl.RaftServerImpl: a0acbcec-d753-414c-b077-647d02aaa7fb@group-95C80522151F: changes role from      null to FOLLOWER at term 0 for startAsFollower
datanode_4_1  | 2020-04-17 18:54:38,694 [pool-69-thread-1] INFO impl.RoleInfo: a0acbcec-d753-414c-b077-647d02aaa7fb: start FollowerState
datanode_4_1  | 2020-04-17 18:54:38,696 [pool-69-thread-1] INFO util.JmxRegister: Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-95C80522151F,id=a0acbcec-d753-414c-b077-647d02aaa7fb
datanode_4_1  | 2020-04-17 18:54:38,696 [pool-69-thread-1] INFO metrics.RatisMetrics: Creating Metrics Registry : ratis.state_machine.a0acbcec-d753-414c-b077-647d02aaa7fb@group-95C80522151F
datanode_4_1  | 2020-04-17 18:54:38,784 [Command processor thread] INFO commandhandler.CreatePipelineCommandHandler: Created Pipeline RATIS THREE #id: "b5a22a8d-2392-4c7a-923f-95c80522151f"
datanode_4_1  | .
datanode_4_1  | 2020-04-17 18:54:43,754 [Thread-98] INFO impl.FollowerState: a0acbcec-d753-414c-b077-647d02aaa7fb@group-95C80522151F-FollowerState: change to CANDIDATE, lastRpcTime:5059ms, electionTimeout:5058ms
datanode_4_1  | 2020-04-17 18:54:43,754 [Thread-98] INFO impl.RoleInfo: a0acbcec-d753-414c-b077-647d02aaa7fb: shutdown FollowerState
datanode_4_1  | 2020-04-17 18:54:43,754 [Thread-98] INFO impl.RaftServerImpl: a0acbcec-d753-414c-b077-647d02aaa7fb@group-95C80522151F: changes role from  FOLLOWER to CANDIDATE at term 0 for changeToCandidate
datanode_4_1  | 2020-04-17 18:54:43,754 [Thread-98] INFO impl.RoleInfo: a0acbcec-d753-414c-b077-647d02aaa7fb: start LeaderElection
datanode_4_1  | 2020-04-17 18:54:43,757 [a0acbcec-d753-414c-b077-647d02aaa7fb@group-95C80522151F-LeaderElection3] INFO impl.LeaderElection: a0acbcec-d753-414c-b077-647d02aaa7fb@group-95C80522151F-LeaderElection3: begin an election at term 1 for -1: [b23d8fb0-3698-40b4-ac98-17b8605a770b:10.5.0.4:9858, a0acbcec-d753-414c-b077-647d02aaa7fb:10.5.0.7:9858, 0e99e1b0-220f-42bd-a39f-d4658f80d0e4:10.5.0.5:9858], old=null
datanode_4_1  | 2020-04-17 18:54:43,784 [a0acbcec-d753-414c-b077-647d02aaa7fb@group-95C80522151F-LeaderElection3] INFO impl.LeaderElection: a0acbcec-d753-414c-b077-647d02aaa7fb@group-95C80522151F-LeaderElection3: Election PASSED; received 1 response(s) [a0acbcec-d753-414c-b077-647d02aaa7fb<-0e99e1b0-220f-42bd-a39f-d4658f80d0e4#0:OK-t1] and 0 exception(s); a0acbcec-d753-414c-b077-647d02aaa7fb@group-95C80522151F:t1, leader=null, voted=a0acbcec-d753-414c-b077-647d02aaa7fb, raftlog=a0acbcec-d753-414c-b077-647d02aaa7fb@group-95C80522151F-SegmentedRaftLog:OPENED:c-1,f-1,i0, conf=-1: [b23d8fb0-3698-40b4-ac98-17b8605a770b:10.5.0.4:9858, a0acbcec-d753-414c-b077-647d02aaa7fb:10.5.0.7:9858, 0e99e1b0-220f-42bd-a39f-d4658f80d0e4:10.5.0.5:9858], old=null
scm_1         | 2020-04-17 18:55:18,611 [RatisPipelineUtilsThread] INFO pipeline.RatisPipelineProvider: Send pipeline:PipelineID=825f4d0e-2629-43e6-a52f-cfd51574c841 close command to datanode 79669a1f-2445-496e-a337-3115205f3ae5
scm_1         | 2020-04-17 18:55:18,611 [RatisPipelineUtilsThread] ERROR pipeline.SCMPipelineManager: Destroy pipeline failed for pipeline:Pipeline[ Id: 825f4d0e-2629-43e6-a52f-cfd51574c841, Nodes: 978c057e-5c38-4e20-8a8b-f271c823af7e{ip: 10.5.0.8, host: ozone-topology_datanode_5_1.ozone-topology_net, networkLocation: /rack2, certSerialId: null}0e99e1b0-220f-42bd-a39f-d4658f80d0e4{ip: 10.5.0.5, host: ozone-topology_datanode_2_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}79669a1f-2445-496e-a337-3115205f3ae5{ip: 10.5.0.9, host: ozone-topology_datanode_6_1.ozone-topology_net, networkLocation: /rack2, certSerialId: null}, Type:RATIS, Factor:THREE, State:CLOSED, leaderId:0e99e1b0-220f-42bd-a39f-d4658f80d0e4, CreationTimestamp2020-04-17T18:53:43.632228Z]
scm_1         | org.apache.hadoop.hdds.scm.pipeline.PipelineNotFoundException: PipelineID=825f4d0e-2629-43e6-a52f-cfd51574c841 not found
scm_1         | 	at org.apache.hadoop.hdds.scm.pipeline.PipelineStateMap.getPipeline(PipelineStateMap.java:133)
scm_1         | 	at org.apache.hadoop.hdds.scm.pipeline.PipelineStateMap.removePipeline(PipelineStateMap.java:323)
scm_1         | 	at org.apache.hadoop.hdds.scm.pipeline.PipelineStateManager.removePipeline(PipelineStateManager.java:104)
scm_1         | 	at org.apache.hadoop.hdds.scm.pipeline.SCMPipelineManager.removePipeline(SCMPipelineManager.java:595)
scm_1         | 	at org.apache.hadoop.hdds.scm.pipeline.SCMPipelineManager.destroyPipeline(SCMPipelineManager.java:579)
scm_1         | 	at org.apache.hadoop.hdds.scm.pipeline.SCMPipelineManager.lambda$finalizeAndDestroyPipeline$0(SCMPipelineManager.java:422)
scm_1         | 	at org.apache.hadoop.hdds.utils.Scheduler.lambda$schedule$1(Scheduler.java:70)
scm_1         | 	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
scm_1         | 	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
scm_1         | 	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:304)
scm_1         | 	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
scm_1         | 	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
scm_1         | 	at java.base/java.lang.Thread.run(Thread.java:834)
scm_1         | 2020-04-17 18:55:18,615 [RatisPipelineUtilsThread] INFO pipeline.RatisPipelineProvider: Send pipeline:PipelineID=825f4d0e-2629-43e6-a52f-cfd51574c841 close command to datanode 978c057e-5c38-4e20-8a8b-f271c823af7e
scm_1         | 2020-04-17 18:55:18,616 [RatisPipelineUtilsThread] INFO pipeline.RatisPipelineProvider: Send pipeline:PipelineID=825f4d0e-2629-43e6-a52f-cfd51574c841 close command to datanode 0e99e1b0-220f-42bd-a39f-d4658f80d0e4
scm_1         | 2020-04-17 18:55:18,616 [RatisPipelineUtilsThread] INFO pipeline.RatisPipelineProvider: Send pipeline:PipelineID=825f4d0e-2629-43e6-a52f-cfd51574c841 close command to datanode 79669a1f-2445-496e-a337-3115205f3ae5
scm_1         | 2020-04-17 18:55:18,616 [RatisPipelineUtilsThread] ERROR pipeline.SCMPipelineManager: Destroy pipeline failed for pipeline:Pipeline[ Id: 825f4d0e-2629-43e6-a52f-cfd51574c841, Nodes: 978c057e-5c38-4e20-8a8b-f271c823af7e{ip: 10.5.0.8, host: ozone-topology_datanode_5_1.ozone-topology_net, networkLocation: /rack2, certSerialId: null}0e99e1b0-220f-42bd-a39f-d4658f80d0e4{ip: 10.5.0.5, host: ozone-topology_datanode_2_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}79669a1f-2445-496e-a337-3115205f3ae5{ip: 10.5.0.9, host: ozone-topology_datanode_6_1.ozone-topology_net, networkLocation: /rack2, certSerialId: null}, Type:RATIS, Factor:THREE, State:CLOSED, leaderId:0e99e1b0-220f-42bd-a39f-d4658f80d0e4, CreationTimestamp2020-04-17T18:53:43.632228Z]
scm_1         | org.apache.hadoop.hdds.scm.pipeline.PipelineNotFoundException: PipelineID=825f4d0e-2629-43e6-a52f-cfd51574c841 not found
scm_1         | 	at org.apache.hadoop.hdds.scm.pipeline.PipelineStateMap.getPipeline(PipelineStateMap.java:133)
scm_1         | 	at org.apache.hadoop.hdds.scm.pipeline.PipelineStateMap.removePipeline(PipelineStateMap.java:323)
scm_1         | 	at org.apache.hadoop.hdds.scm.pipeline.PipelineStateManager.removePipeline(PipelineStateManager.java:104)
scm_1         | 	at org.apache.hadoop.hdds.scm.pipeline.SCMPipelineManager.removePipeline(SCMPipelineManager.java:595)
scm_1         | 	at org.apache.hadoop.hdds.scm.pipeline.SCMPipelineManager.destroyPipeline(SCMPipelineManager.java:579)
scm_1         | 	at org.apache.hadoop.hdds.scm.pipeline.SCMPipelineManager.lambda$finalizeAndDestroyPipeline$0(SCMPipelineManager.java:422)
scm_1         | 	at org.apache.hadoop.hdds.utils.Scheduler.lambda$schedule$1(Scheduler.java:70)
scm_1         | 	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
scm_1         | 	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
scm_1         | 	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:304)
scm_1         | 	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
scm_1         | 	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
scm_1         | 	at java.base/java.lang.Thread.run(Thread.java:834)
scm_1         | 2020-04-17 18:55:18,650 [RatisPipelineUtilsThread] INFO pipeline.RatisPipelineProvider: Send pipeline:PipelineID=825f4d0e-2629-43e6-a52f-cfd51574c841 close command to datanode 978c057e-5c38-4e20-8a8b-f271c823af7e
scm_1         | 2020-04-17 18:55:18,650 [RatisPipelineUtilsThread] INFO pipeline.RatisPipelineProvider: Send pipeline:PipelineID=825f4d0e-2629-43e6-a52f-cfd51574c841 close command to datanode 0e99e1b0-220f-42bd-a39f-d4658f80d0e4
scm_1         | 2020-04-17 18:55:18,650 [RatisPipelineUtilsThread] INFO pipeline.RatisPipelineProvider: Send pipeline:PipelineID=825f4d0e-2629-43e6-a52f-cfd51574c841 close command to datanode 79669a1f-2445-496e-a337-3115205f3ae5
scm_1         | 2020-04-17 18:55:18,650 [RatisPipelineUtilsThread] ERROR pipeline.SCMPipelineManager: Destroy pipeline failed for pipeline:Pipeline[ Id: 825f4d0e-2629-43e6-a52f-cfd51574c841, Nodes: 978c057e-5c38-4e20-8a8b-f271c823af7e{ip: 10.5.0.8, host: ozone-topology_datanode_5_1.ozone-topology_net, networkLocation: /rack2, certSerialId: null}0e99e1b0-220f-42bd-a39f-d4658f80d0e4{ip: 10.5.0.5, host: ozone-topology_datanode_2_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}79669a1f-2445-496e-a337-3115205f3ae5{ip: 10.5.0.9, host: ozone-topology_datanode_6_1.ozone-topology_net, networkLocation: /rack2, certSerialId: null}, Type:RATIS, Factor:THREE, State:CLOSED, leaderId:0e99e1b0-220f-42bd-a39f-d4658f80d0e4, CreationTimestamp2020-04-17T18:53:43.632228Z]
scm_1         | org.apache.hadoop.hdds.scm.pipeline.PipelineNotFoundException: PipelineID=825f4d0e-2629-43e6-a52f-cfd51574c841 not found
scm_1         | 	at org.apache.hadoop.hdds.scm.pipeline.PipelineStateMap.getPipeline(PipelineStateMap.java:133)
scm_1         | 	at org.apache.hadoop.hdds.scm.pipeline.PipelineStateMap.removePipeline(PipelineStateMap.java:323)
scm_1         | 	at org.apache.hadoop.hdds.scm.pipeline.PipelineStateManager.removePipeline(PipelineStateManager.java:104)
scm_1         | 	at org.apache.hadoop.hdds.scm.pipeline.SCMPipelineManager.removePipeline(SCMPipelineManager.java:595)
scm_1         | 	at org.apache.hadoop.hdds.scm.pipeline.SCMPipelineManager.destroyPipeline(SCMPipelineManager.java:579)
scm_1         | 	at org.apache.hadoop.hdds.scm.pipeline.SCMPipelineManager.lambda$finalizeAndDestroyPipeline$0(SCMPipelineManager.java:422)
scm_1         | 	at org.apache.hadoop.hdds.utils.Scheduler.lambda$schedule$1(Scheduler.java:70)
scm_1         | 	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
scm_1         | 	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
scm_1         | 	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:304)
scm_1         | 	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
scm_1         | 	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
scm_1         | 	at java.base/java.lang.Thread.run(Thread.java:834)
scm_1         | 2020-04-17 18:55:40,955 [EventQueue-PipelineActionsForPipelineActionHandler] INFO pipeline.PipelineActionHandler: Received pipeline action CLOSE for PipelineID=b5a22a8d-2392-4c7a-923f-95c80522151f from datanode 0e99e1b0-220f-42bd-a39f-d4658f80d0e4. Reason : ContainerID 5 creation failed
scm_1         | 2020-04-17 18:55:40,956 [EventQueue-PipelineActionsForPipelineActionHandler] INFO pipeline.SCMPipelineManager: Destroying pipeline:Pipeline[ Id: b5a22a8d-2392-4c7a-923f-95c80522151f, Nodes: 0e99e1b0-220f-42bd-a39f-d4658f80d0e4{ip: 10.5.0.5, host: ozone-topology_datanode_2_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}a0acbcec-d753-414c-b077-647d02aaa7fb{ip: 10.5.0.7, host: ozone-topology_datanode_4_1.ozone-topology_net, networkLocation: /rack2, certSerialId: null}b23d8fb0-3698-40b4-ac98-17b8605a770b{ip: 10.5.0.4, host: ozone-topology_datanode_1_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}, Type:RATIS, Factor:THREE, State:OPEN, leaderId:a0acbcec-d753-414c-b077-647d02aaa7fb, CreationTimestamp2020-04-17T18:54:34.641801Z]
scm_1         | 2020-04-17 18:55:40,956 [EventQueue-PipelineActionsForPipelineActionHandler] INFO pipeline.PipelineStateManager: Pipeline Pipeline[ Id: b5a22a8d-2392-4c7a-923f-95c80522151f, Nodes: 0e99e1b0-220f-42bd-a39f-d4658f80d0e4{ip: 10.5.0.5, host: ozone-topology_datanode_2_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}a0acbcec-d753-414c-b077-647d02aaa7fb{ip: 10.5.0.7, host: ozone-topology_datanode_4_1.ozone-topology_net, networkLocation: /rack2, certSerialId: null}b23d8fb0-3698-40b4-ac98-17b8605a770b{ip: 10.5.0.4, host: ozone-topology_datanode_1_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}, Type:RATIS, Factor:THREE, State:CLOSED, leaderId:a0acbcec-d753-414c-b077-647d02aaa7fb, CreationTimestamp2020-04-17T18:54:34.641801Z] moved to CLOSED state
scm_1         | 2020-04-17 18:55:40,956 [EventQueue-CloseContainerForCloseContainerEventHandler] INFO container.CloseContainerEventHandler: Close container Event triggered for container : #5
scm_1         | 2020-04-17 18:55:40,962 [EventQueue-PipelineActionsForPipelineActionHandler] INFO pipeline.PipelineActionHandler: Received pipeline action CLOSE for PipelineID=b5a22a8d-2392-4c7a-923f-95c80522151f from datanode a0acbcec-d753-414c-b077-647d02aaa7fb. Reason : ContainerID 5 creation failed
scm_1         | 2020-04-17 18:55:40,971 [EventQueue-PipelineActionsForPipelineActionHandler] INFO pipeline.SCMPipelineManager: Destroying pipeline:Pipeline[ Id: b5a22a8d-2392-4c7a-923f-95c80522151f, Nodes: 0e99e1b0-220f-42bd-a39f-d4658f80d0e4{ip: 10.5.0.5, host: ozone-topology_datanode_2_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}a0acbcec-d753-414c-b077-647d02aaa7fb{ip: 10.5.0.7, host: ozone-topology_datanode_4_1.ozone-topology_net, networkLocation: /rack2, certSerialId: null}b23d8fb0-3698-40b4-ac98-17b8605a770b{ip: 10.5.0.4, host: ozone-topology_datanode_1_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}, Type:RATIS, Factor:THREE, State:CLOSED, leaderId:a0acbcec-d753-414c-b077-647d02aaa7fb, CreationTimestamp2020-04-17T18:54:34.641801Z]
scm_1         | 2020-04-17 18:55:40,972 [EventQueue-PipelineActionsForPipelineActionHandler] INFO pipeline.PipelineActionHandler: Received pipeline action CLOSE for PipelineID=b5a22a8d-2392-4c7a-923f-95c80522151f from datanode 0e99e1b0-220f-42bd-a39f-d4658f80d0e4. Reason : Log already failed at index 1 for task WriteLog:1: (t:1, i:1), STATEMACHINELOGENTRY, client-B5B53B577AA5, cid=77
scm_1         | 	 State Machine: cmdType: WriteChunk traceID: "9f59c7868aa8c134:53a78add67987187:9f59c7868aa8c134:0" containerID: 5 datanodeUuid: "0e99e1b0-220f-42bd-a39f-d4658f80d0e4" pipelineID: "b5a22a8d-2392-4c7a-923f-95c80522151f" writeChunk { blockID { containerID: 5 localID: 104015445419098136 blockCommitSequenceId: 0 } chunkData { chunkName: "104015445419098136_chunk_1" offset: 0 len: 10240 checksumData { type: CRC32 bytesPerChecksum: 1048576 checksums: ">\344\315\231" } } }, container path=nonexistent
scm_1         | 2020-04-17 18:55:40,976 [EventQueue-PipelineActionsForPipelineActionHandler] INFO pipeline.SCMPipelineManager: Destroying pipeline:Pipeline[ Id: b5a22a8d-2392-4c7a-923f-95c80522151f, Nodes: 0e99e1b0-220f-42bd-a39f-d4658f80d0e4{ip: 10.5.0.5, host: ozone-topology_datanode_2_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}a0acbcec-d753-414c-b077-647d02aaa7fb{ip: 10.5.0.7, host: ozone-topology_datanode_4_1.ozone-topology_net, networkLocation: /rack2, certSerialId: null}b23d8fb0-3698-40b4-ac98-17b8605a770b{ip: 10.5.0.4, host: ozone-topology_datanode_1_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}, Type:RATIS, Factor:THREE, State:CLOSED, leaderId:a0acbcec-d753-414c-b077-647d02aaa7fb, CreationTimestamp2020-04-17T18:54:34.641801Z]
scm_1         | 2020-04-17 18:55:40,976 [EventQueue-PipelineActionsForPipelineActionHandler] INFO pipeline.PipelineActionHandler: Received pipeline action CLOSE for PipelineID=b5a22a8d-2392-4c7a-923f-95c80522151f from datanode a0acbcec-d753-414c-b077-647d02aaa7fb. Reason : Log already failed at index 1 for task WriteLog:1: (t:1, i:1), STATEMACHINELOGENTRY, client-B5B53B577AA5, cid=77
scm_1         | 	 State Machine: cmdType: WriteChunk traceID: "9f59c7868aa8c134:53a78add67987187:9f59c7868aa8c134:0" containerID: 5 datanodeUuid: "0e99e1b0-220f-42bd-a39f-d4658f80d0e4" pipelineID: "b5a22a8d-2392-4c7a-923f-95c80522151f" writeChunk { blockID { containerID: 5 localID: 104015445419098136 blockCommitSequenceId: 0 } chunkData { chunkName: "104015445419098136_chunk_1" offset: 0 len: 10240 checksumData { type: CRC32 bytesPerChecksum: 1048576 checksums: ">\344\315\231" } } }, container path=nonexistent
scm_1         | 2020-04-17 18:55:40,976 [EventQueue-PipelineActionsForPipelineActionHandler] INFO pipeline.SCMPipelineManager: Destroying pipeline:Pipeline[ Id: b5a22a8d-2392-4c7a-923f-95c80522151f, Nodes: 0e99e1b0-220f-42bd-a39f-d4658f80d0e4{ip: 10.5.0.5, host: ozone-topology_datanode_2_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}a0acbcec-d753-414c-b077-647d02aaa7fb{ip: 10.5.0.7, host: ozone-topology_datanode_4_1.ozone-topology_net, networkLocation: /rack2, certSerialId: null}b23d8fb0-3698-40b4-ac98-17b8605a770b{ip: 10.5.0.4, host: ozone-topology_datanode_1_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}, Type:RATIS, Factor:THREE, State:CLOSED, leaderId:a0acbcec-d753-414c-b077-647d02aaa7fb, CreationTimestamp2020-04-17T18:54:34.641801Z]
scm_1         | 2020-04-17 18:55:40,987 [EventQueue-PipelineActionsForPipelineActionHandler] INFO pipeline.PipelineActionHandler: Received pipeline action CLOSE for PipelineID=b5a22a8d-2392-4c7a-923f-95c80522151f from datanode b23d8fb0-3698-40b4-ac98-17b8605a770b. Reason : ContainerID 5 creation failed
scm_1         | 2020-04-17 18:55:40,987 [EventQueue-PipelineActionsForPipelineActionHandler] INFO pipeline.SCMPipelineManager: Destroying pipeline:Pipeline[ Id: b5a22a8d-2392-4c7a-923f-95c80522151f, Nodes: 0e99e1b0-220f-42bd-a39f-d4658f80d0e4{ip: 10.5.0.5, host: ozone-topology_datanode_2_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}a0acbcec-d753-414c-b077-647d02aaa7fb{ip: 10.5.0.7, host: ozone-topology_datanode_4_1.ozone-topology_net, networkLocation: /rack2, certSerialId: null}b23d8fb0-3698-40b4-ac98-17b8605a770b{ip: 10.5.0.4, host: ozone-topology_datanode_1_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}, Type:RATIS, Factor:THREE, State:CLOSED, leaderId:a0acbcec-d753-414c-b077-647d02aaa7fb, CreationTimestamp2020-04-17T18:54:34.641801Z]
scm_1         | 2020-04-17 18:55:41,039 [EventQueue-PipelineActionsForPipelineActionHandler] INFO pipeline.PipelineActionHandler: Received pipeline action CLOSE for PipelineID=b5a22a8d-2392-4c7a-923f-95c80522151f from datanode b23d8fb0-3698-40b4-ac98-17b8605a770b. Reason : Log already failed at index 1 for task WriteLog:1: (t:1, i:1), STATEMACHINELOGENTRY, client-B5B53B577AA5, cid=77
scm_1         | 	 State Machine: cmdType: WriteChunk traceID: "9f59c7868aa8c134:53a78add67987187:9f59c7868aa8c134:0" containerID: 5 datanodeUuid: "0e99e1b0-220f-42bd-a39f-d4658f80d0e4" pipelineID: "b5a22a8d-2392-4c7a-923f-95c80522151f" writeChunk { blockID { containerID: 5 localID: 104015445419098136 blockCommitSequenceId: 0 } chunkData { chunkName: "104015445419098136_chunk_1" offset: 0 len: 10240 checksumData { type: CRC32 bytesPerChecksum: 1048576 checksums: ">\344\315\231" } } }, container path=nonexistent
scm_1         | 2020-04-17 18:55:41,039 [EventQueue-PipelineActionsForPipelineActionHandler] INFO pipeline.SCMPipelineManager: Destroying pipeline:Pipeline[ Id: b5a22a8d-2392-4c7a-923f-95c80522151f, Nodes: 0e99e1b0-220f-42bd-a39f-d4658f80d0e4{ip: 10.5.0.5, host: ozone-topology_datanode_2_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}a0acbcec-d753-414c-b077-647d02aaa7fb{ip: 10.5.0.7, host: ozone-topology_datanode_4_1.ozone-topology_net, networkLocation: /rack2, certSerialId: null}b23d8fb0-3698-40b4-ac98-17b8605a770b{ip: 10.5.0.4, host: ozone-topology_datanode_1_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}, Type:RATIS, Factor:THREE, State:CLOSED, leaderId:a0acbcec-d753-414c-b077-647d02aaa7fb, CreationTimestamp2020-04-17T18:54:34.641801Z]
scm_1         | 2020-04-17 18:55:47,178 [Thread-338] INFO container.ReplicationManager: Starting Replication Monitor Thread.
scm_1         | 2020-04-17 18:55:47,189 [ReplicationMonitor] INFO container.ReplicationManager: Replication Monitor Thread took 4 milliseconds for processing 5 containers.
datanode_4_1  | 2020-04-17 18:54:43,785 [a0acbcec-d753-414c-b077-647d02aaa7fb@group-95C80522151F-LeaderElection3] INFO impl.RoleInfo: a0acbcec-d753-414c-b077-647d02aaa7fb: shutdown LeaderElection
datanode_4_1  | 2020-04-17 18:54:43,785 [a0acbcec-d753-414c-b077-647d02aaa7fb@group-95C80522151F-LeaderElection3] INFO impl.RaftServerImpl: a0acbcec-d753-414c-b077-647d02aaa7fb@group-95C80522151F: changes role from CANDIDATE to LEADER at term 1 for changeToLeader
datanode_4_1  | 2020-04-17 18:54:43,785 [a0acbcec-d753-414c-b077-647d02aaa7fb@group-95C80522151F-LeaderElection3] INFO ratis.XceiverServerRatis: Leader change notification received for group: group-95C80522151F with new leaderId: a0acbcec-d753-414c-b077-647d02aaa7fb
datanode_4_1  | 2020-04-17 18:54:43,785 [a0acbcec-d753-414c-b077-647d02aaa7fb@group-95C80522151F-LeaderElection3] INFO impl.RaftServerImpl: a0acbcec-d753-414c-b077-647d02aaa7fb@group-95C80522151F: change Leader from null to a0acbcec-d753-414c-b077-647d02aaa7fb at term 1 for becomeLeader, leader elected after 5102ms
datanode_4_1  | 2020-04-17 18:54:43,785 [a0acbcec-d753-414c-b077-647d02aaa7fb@group-95C80522151F-LeaderElection3] INFO server.RaftServerConfigKeys: raft.server.staging.catchup.gap = 1000 (default)
datanode_4_1  | 2020-04-17 18:54:43,785 [a0acbcec-d753-414c-b077-647d02aaa7fb@group-95C80522151F-LeaderElection3] INFO server.RaftServerConfigKeys: raft.server.rpc.sleep.time = 25ms (default)
datanode_4_1  | 2020-04-17 18:54:43,785 [a0acbcec-d753-414c-b077-647d02aaa7fb@group-95C80522151F-LeaderElection3] INFO metrics.RatisMetrics: Creating Metrics Registry : ratis.log_appender.a0acbcec-d753-414c-b077-647d02aaa7fb@group-95C80522151F
datanode_4_1  | 2020-04-17 18:54:43,786 [a0acbcec-d753-414c-b077-647d02aaa7fb@group-95C80522151F-LeaderElection3] INFO server.RaftServerConfigKeys: raft.server.write.element-limit = 1024 (custom)
datanode_4_1  | 2020-04-17 18:54:43,786 [a0acbcec-d753-414c-b077-647d02aaa7fb@group-95C80522151F-LeaderElection3] INFO server.RaftServerConfigKeys: raft.server.write.byte-limit = 1073741824 (custom)
datanode_4_1  | 2020-04-17 18:54:43,786 [a0acbcec-d753-414c-b077-647d02aaa7fb@group-95C80522151F-LeaderElection3] INFO server.RaftServerConfigKeys: raft.server.watch.timeout = 180s (custom)
datanode_4_1  | 2020-04-17 18:54:43,786 [a0acbcec-d753-414c-b077-647d02aaa7fb@group-95C80522151F-LeaderElection3] INFO server.RaftServerConfigKeys: raft.server.watch.timeout.denomination = 1s (default)
datanode_4_1  | 2020-04-17 18:54:43,786 [a0acbcec-d753-414c-b077-647d02aaa7fb@group-95C80522151F-LeaderElection3] INFO server.RaftServerConfigKeys: raft.server.watch.element-limit = 65536 (default)
datanode_4_1  | 2020-04-17 18:54:43,787 [a0acbcec-d753-414c-b077-647d02aaa7fb@group-95C80522151F-LeaderElection3] INFO server.RaftServerConfigKeys: raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
datanode_4_1  | 2020-04-17 18:54:43,787 [a0acbcec-d753-414c-b077-647d02aaa7fb@group-95C80522151F-LeaderElection3] INFO server.RaftServerConfigKeys: raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
datanode_4_1  | 2020-04-17 18:54:43,787 [a0acbcec-d753-414c-b077-647d02aaa7fb@group-95C80522151F-LeaderElection3] INFO server.RaftServerConfigKeys: raft.server.log.appender.buffer.element-limit = 1 (custom)
datanode_4_1  | 2020-04-17 18:54:43,787 [a0acbcec-d753-414c-b077-647d02aaa7fb@group-95C80522151F-LeaderElection3] INFO grpc.GrpcConfigKeys: raft.grpc.server.leader.outstanding.appends.max = 128 (default)
datanode_4_1  | 2020-04-17 18:54:43,787 [a0acbcec-d753-414c-b077-647d02aaa7fb@group-95C80522151F-LeaderElection3] INFO server.RaftServerConfigKeys: raft.server.rpc.request.timeout = 60s (custom)
datanode_4_1  | 2020-04-17 18:54:43,788 [a0acbcec-d753-414c-b077-647d02aaa7fb@group-95C80522151F-LeaderElection3] INFO server.RaftServerConfigKeys: raft.server.log.appender.install.snapshot.enabled = false (custom)
datanode_4_1  | 2020-04-17 18:54:43,794 [a0acbcec-d753-414c-b077-647d02aaa7fb@group-95C80522151F-LeaderElection3] INFO server.RaftServerConfigKeys: raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
datanode_4_1  | 2020-04-17 18:54:43,794 [a0acbcec-d753-414c-b077-647d02aaa7fb@group-95C80522151F-LeaderElection3] INFO server.RaftServerConfigKeys: raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
datanode_4_1  | 2020-04-17 18:54:43,794 [a0acbcec-d753-414c-b077-647d02aaa7fb@group-95C80522151F-LeaderElection3] INFO server.RaftServerConfigKeys: raft.server.log.appender.buffer.element-limit = 1 (custom)
datanode_4_1  | 2020-04-17 18:54:43,794 [a0acbcec-d753-414c-b077-647d02aaa7fb@group-95C80522151F-LeaderElection3] INFO grpc.GrpcConfigKeys: raft.grpc.server.leader.outstanding.appends.max = 128 (default)
datanode_4_1  | 2020-04-17 18:54:43,794 [a0acbcec-d753-414c-b077-647d02aaa7fb@group-95C80522151F-LeaderElection3] INFO server.RaftServerConfigKeys: raft.server.rpc.request.timeout = 60s (custom)
datanode_4_1  | 2020-04-17 18:54:43,795 [a0acbcec-d753-414c-b077-647d02aaa7fb@group-95C80522151F-LeaderElection3] INFO server.RaftServerConfigKeys: raft.server.log.appender.install.snapshot.enabled = false (custom)
datanode_4_1  | 2020-04-17 18:54:43,795 [a0acbcec-d753-414c-b077-647d02aaa7fb@group-95C80522151F-LeaderElection3] INFO impl.RoleInfo: a0acbcec-d753-414c-b077-647d02aaa7fb: start LeaderState
datanode_4_1  | 2020-04-17 18:54:43,796 [a0acbcec-d753-414c-b077-647d02aaa7fb@group-95C80522151F-LeaderElection3] INFO segmented.SegmentedRaftLogWorker: a0acbcec-d753-414c-b077-647d02aaa7fb@group-95C80522151F-SegmentedRaftLogWorker: Starting segment from index:0
datanode_4_1  | 2020-04-17 18:54:43,799 [a0acbcec-d753-414c-b077-647d02aaa7fb@group-95C80522151F-SegmentedRaftLogWorker] INFO segmented.SegmentedRaftLogWorker: a0acbcec-d753-414c-b077-647d02aaa7fb@group-95C80522151F-SegmentedRaftLogWorker: created new log segment /data/metadata/ratis/b5a22a8d-2392-4c7a-923f-95c80522151f/current/log_inprogress_0
datanode_4_1  | 2020-04-17 18:54:43,804 [a0acbcec-d753-414c-b077-647d02aaa7fb@group-95C80522151F-LeaderElection3] INFO impl.RaftServerImpl: a0acbcec-d753-414c-b077-647d02aaa7fb@group-95C80522151F: set configuration 0: [b23d8fb0-3698-40b4-ac98-17b8605a770b:10.5.0.4:9858, a0acbcec-d753-414c-b077-647d02aaa7fb:10.5.0.7:9858, 0e99e1b0-220f-42bd-a39f-d4658f80d0e4:10.5.0.5:9858], old=null at 0
datanode_4_1  | 2020-04-17 18:55:40,934 [ChunkWriter-22-0] INFO keyvalue.KeyValueHandler: Operation: CreateContainer , Trace ID: 9f59c7868aa8c134:53a78add67987187:9f59c7868aa8c134:0 , Message: Container creation failed, due to disk out of space , Result: DISK_OUT_OF_SPACE , StorageContainerException Occurred.
datanode_4_1  | org.apache.hadoop.hdds.scm.container.common.helpers.StorageContainerException: Container creation failed, due to disk out of space
datanode_4_1  | 	at org.apache.hadoop.ozone.container.keyvalue.KeyValueContainer.create(KeyValueContainer.java:165)
datanode_4_1  | 	at org.apache.hadoop.ozone.container.keyvalue.KeyValueHandler.handleCreateContainer(KeyValueHandler.java:247)
datanode_4_1  | 	at org.apache.hadoop.ozone.container.keyvalue.KeyValueHandler.dispatchRequest(KeyValueHandler.java:164)
datanode_4_1  | 	at org.apache.hadoop.ozone.container.keyvalue.KeyValueHandler.handle(KeyValueHandler.java:152)
datanode_4_1  | 	at org.apache.hadoop.ozone.container.common.impl.HddsDispatcher.createContainer(HddsDispatcher.java:414)
datanode_4_1  | 	at org.apache.hadoop.ozone.container.common.impl.HddsDispatcher.dispatchRequest(HddsDispatcher.java:250)
datanode_4_1  | 	at org.apache.hadoop.ozone.container.common.impl.HddsDispatcher.dispatch(HddsDispatcher.java:162)
datanode_4_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.ContainerStateMachine.dispatchCommand(ContainerStateMachine.java:402)
datanode_4_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.ContainerStateMachine.runCommand(ContainerStateMachine.java:412)
datanode_4_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.ContainerStateMachine.lambda$handleWriteChunk$2(ContainerStateMachine.java:447)
datanode_4_1  | 	at java.base/java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1700)
datanode_4_1  | 	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
datanode_4_1  | 	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
datanode_4_1  | 	at java.base/java.lang.Thread.run(Thread.java:834)
datanode_4_1  | Caused by: org.apache.hadoop.util.DiskChecker$DiskOutOfSpaceException: Out of space: The volume with the most available space (=964624384 B) is less than the container size (=1073741824 B).
datanode_4_1  | 	at org.apache.hadoop.ozone.container.common.volume.RoundRobinVolumeChoosingPolicy.chooseVolume(RoundRobinVolumeChoosingPolicy.java:77)
datanode_4_1  | 	at org.apache.hadoop.ozone.container.keyvalue.KeyValueContainer.create(KeyValueContainer.java:124)
datanode_4_1  | 	... 13 more
datanode_4_1  | 2020-04-17 18:55:40,943 [ChunkWriter-22-0] INFO impl.HddsDispatcher: Operation: WriteChunk , Trace ID: 9f59c7868aa8c134:53a78add67987187:9f59c7868aa8c134:0 , Message: ContainerID 5 creation failed , Result: DISK_OUT_OF_SPACE , StorageContainerException Occurred.
datanode_4_1  | org.apache.hadoop.hdds.scm.container.common.helpers.StorageContainerException: ContainerID 5 creation failed
datanode_4_1  | 	at org.apache.hadoop.ozone.container.common.impl.HddsDispatcher.dispatchRequest(HddsDispatcher.java:254)
datanode_4_1  | 	at org.apache.hadoop.ozone.container.common.impl.HddsDispatcher.dispatch(HddsDispatcher.java:162)
datanode_4_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.ContainerStateMachine.dispatchCommand(ContainerStateMachine.java:402)
datanode_4_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.ContainerStateMachine.runCommand(ContainerStateMachine.java:412)
datanode_4_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.ContainerStateMachine.lambda$handleWriteChunk$2(ContainerStateMachine.java:447)
datanode_4_1  | 	at java.base/java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1700)
datanode_4_1  | 	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
datanode_4_1  | 	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
datanode_4_1  | 	at java.base/java.lang.Thread.run(Thread.java:834)
datanode_4_1  | 2020-04-17 18:55:40,948 [ChunkWriter-22-0] ERROR ratis.ContainerStateMachine: group-95C80522151F: writeChunk writeStateMachineData failed: blockIdcontainerID: 5
datanode_4_1  | localID: 104015445419098136
datanode_4_1  | blockCommitSequenceId: 0
datanode_4_1  |  logIndex 1 chunkName 104015445419098136_chunk_1 Error message: ContainerID 5 creation failed Container Result: DISK_OUT_OF_SPACE
datanode_4_1  | 2020-04-17 18:55:40,950 [a0acbcec-d753-414c-b077-647d02aaa7fb@group-95C80522151F-SegmentedRaftLogWorker] ERROR ratis.XceiverServerRatis: pipeline Action CLOSE on pipeline PipelineID=b5a22a8d-2392-4c7a-923f-95c80522151f.Reason : ContainerID 5 creation failed
datanode_4_1  | 2020-04-17 18:55:40,952 [a0acbcec-d753-414c-b077-647d02aaa7fb@group-95C80522151F-SegmentedRaftLogWorker] ERROR ratis.XceiverServerRatis: pipeline Action CLOSE on pipeline PipelineID=b5a22a8d-2392-4c7a-923f-95c80522151f.Reason : Log already failed at index 1 for task WriteLog:1: (t:1, i:1), STATEMACHINELOGENTRY, client-B5B53B577AA5, cid=77
datanode_4_1  | 	 State Machine: cmdType: WriteChunk traceID: "9f59c7868aa8c134:53a78add67987187:9f59c7868aa8c134:0" containerID: 5 datanodeUuid: "0e99e1b0-220f-42bd-a39f-d4658f80d0e4" pipelineID: "b5a22a8d-2392-4c7a-923f-95c80522151f" writeChunk { blockID { containerID: 5 localID: 104015445419098136 blockCommitSequenceId: 0 } chunkData { chunkName: "104015445419098136_chunk_1" offset: 0 len: 10240 checksumData { type: CRC32 bytesPerChecksum: 1048576 checksums: ">\344\315\231" } } }, container path=nonexistent
datanode_4_1  | 2020-04-17 18:55:44,789 [Command processor thread] ERROR commandhandler.CloseContainerCommandHandler: Container #5 does not exist in datanode. Container close failed.
