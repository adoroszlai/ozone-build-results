rm: cannot remove '/home/runner/work/ozone/ozone/hadoop-ozone/dist/target/ozone-2.0.0-SNAPSHOT/compose/result/*': No such file or directory
Using Docker Compose v2
Executing test ozonesecure/test-certificate-rotation.sh
Using Docker Compose v2
Error response from daemon: Head "https://registry-1.docker.io/v2/apache/hadoop/manifests/3.3.6": Get "https://auth.docker.io/token?account=githubactions&scope=repository%3Aapache%2Fhadoop%3Apull&service=registry.docker.io": net/http: request canceled (Client.Timeout exceeded while awaiting headers)
ERROR: Test execution of ozonesecure/test-certificate-rotation.sh is FAILED!!!!
mkdir: created directory '/home/runner/work/ozone/ozone/hadoop-ozone/dist/target/ozone-2.0.0-SNAPSHOT/compose/result/ozonesecure'
mkdir: created directory '/home/runner/work/ozone/ozone/hadoop-ozone/dist/target/ozone-2.0.0-SNAPSHOT/compose/result/ozonesecure/certificate-rotation'
mv: cannot stat 'ozonesecure/result/*': No such file or directory
Executing test ozonesecure/test-root-ca-rotation.sh
Using Docker Compose v2
Port 88 is available on kdc
Port 9860 is not available on scm yet
Port 9860 is not available on scm yet
Port 9860 is not available on scm yet
Port 9860 is not available on scm yet
Port 9860 is not available on scm yet
Port 9860 is not available on scm yet
Port 9860 is not available on scm yet
Port 9860 is not available on scm yet
Port 9860 is not available on scm yet
Port 9860 is not available on scm yet
Port 9860 is not available on scm yet
Port 9860 is not available on scm yet
Port 9860 is not available on scm yet
Port 9860 is not available on scm yet
Port 9860 is not available on scm yet
Port 9860 is not available on scm yet
Port 9860 is not available on scm yet
Port 9860 is not available on scm yet
Port 9860 is not available on scm yet
Port 9860 is not available on scm yet
Port 9860 is not available on scm yet
Port 9860 is available on scm
SCM is in safe mode. Will retry in 1 sec. Remaining time (sec): 237
SCM is in safe mode. Will retry in 1 sec. Remaining time (sec): 236
SCM is in safe mode. Will retry in 1 sec. Remaining time (sec): 235
SCM is in safe mode. Will retry in 1 sec. Remaining time (sec): 234
SCM is in safe mode. Will retry in 1 sec. Remaining time (sec): 233
SCM is in safe mode. Will retry in 1 sec. Remaining time (sec): 232
SCM is in safe mode. Will retry in 1 sec. Remaining time (sec): 231
SCM is in safe mode. Will retry in 1 sec. Remaining time (sec): 230
SCM is in safe mode. Will retry in 1 sec. Remaining time (sec): 229
SCM is in safe mode. Will retry in 1 sec. Remaining time (sec): 228
SCM is in safe mode. Will retry in 1 sec. Remaining time (sec): 227
SCM is in safe mode. Will retry in 1 sec. Remaining time (sec): 226
SCM is in safe mode. Will retry in 1 sec. Remaining time (sec): 225
SCM is in safe mode. Will retry in 1 sec. Remaining time (sec): 224
SCM is in safe mode. Will retry in 1 sec. Remaining time (sec): 223
SCM is in safe mode. Will retry in 1 sec. Remaining time (sec): 222
SCM is in safe mode. Will retry in 1 sec. Remaining time (sec): 221
SCM is in safe mode. Will retry in 1 sec. Remaining time (sec): 220
SCM is in safe mode. Will retry in 1 sec. Remaining time (sec): 219
SCM is in safe mode. Will retry in 1 sec. Remaining time (sec): 218
SCM is in safe mode. Will retry in 1 sec. Remaining time (sec): 217
SCM is in safe mode. Will retry in 1 sec. Remaining time (sec): 216
SCM is in safe mode. Will retry in 1 sec. Remaining time (sec): 215
SCM is in safe mode. Will retry in 1 sec. Remaining time (sec): 214
SCM is out of safe mode.
No OM HA service, no need to wait
key1 has been successfully created with options Options{cipher='AES/CTR/NoPadding', bitLength=128, description='null', attributes=null}.
org.apache.hadoop.crypto.key.kms.LoadBalancingKMSClientProvider@662b4c69 has been updated.
==============================================================================
Kinit :: Kinit test user                                                      
==============================================================================
Kinit                                                                 | PASS |
------------------------------------------------------------------------------
Kinit :: Kinit test user                                              | PASS |
1 test, 1 passed, 0 failed
==============================================================================
Output:  /tmp/smoketest/ozonesecure/result/robot-1.xml
"RootCARotationManager-Active" #303 daemon prio=5 os_prio=0 cpu=5.00ms elapsed=32.88s tid=0x00007f5952121600 nid=0x2af waiting on condition  [0x00007f590534e000]
jps | grep StorageContainerManagerStarter |  sed 's/StorageContainerManagerStarter//' | xargs | xargs -I {} jstack {} | grep 'RootCARotationManager-Active' succeed
2 root certificates are not found yet
2 root certificates are not found yet
2 root certificates are not found yet
2 root certificates are not found yet
2 root certificates are not found yet
2 root certificates are not found yet
2 root certificates are not found yet
2 root certificates are not found yet
2 root certificates are not found yet
2 root certificates are not found yet
2 root certificates are found
==============================================================================
Kinit :: Kinit test user                                                      
==============================================================================
Kinit                                                                 | PASS |
------------------------------------------------------------------------------
Kinit :: Kinit test user                                              | PASS |
1 test, 1 passed, 0 failed
==============================================================================
Output:  /tmp/smoketest/ozonesecure/result/robot-2.xml
/data/metadata/dn/certs/ROOTCA-24.crt
ozone admin cert list --role=scm | grep -v 'scm-sub' | grep 'scm' | cut -d ' ' -f 1 | sort | tail -n 1 | xargs -I {} echo /data/metadata/dn/certs/ROOTCA-{}.crt | xargs find succeed
==============================================================================
Kinit :: Kinit test user                                                      
==============================================================================
Kinit                                                                 | PASS |
------------------------------------------------------------------------------
Kinit :: Kinit test user                                              | PASS |
1 test, 1 passed, 0 failed
==============================================================================
Output:  /tmp/smoketest/ozonesecure/result/robot-3.xml
/data/metadata/om/certs/ROOTCA-24.crt
ozone admin cert list --role=scm | grep -v 'scm-sub' | grep 'scm' | cut -d ' ' -f 1 | sort | tail -n 1 | xargs -I {} echo /data/metadata/om/certs/ROOTCA-{}.crt | xargs find succeed
==============================================================================
Root-Ca-Rotation-Client-Checks :: Generate data                               
==============================================================================
Create a volume and bucket                                            | PASS |
------------------------------------------------------------------------------
Create key                                                            | PASS |
------------------------------------------------------------------------------
Read data from previously created key                                 | PASS |
------------------------------------------------------------------------------
Root-Ca-Rotation-Client-Checks :: Generate data                       | PASS |
3 tests, 3 passed, 0 failed
==============================================================================
Output:  /tmp/smoketest/ozonesecure/result/robot-4.xml
3 root certificates are not found yet
3 root certificates are not found yet
3 root certificates are not found yet
3 root certificates are not found yet
3 root certificates are not found yet
3 root certificates are not found yet
3 root certificates are not found yet
3 root certificates are not found yet
3 root certificates are not found yet
3 root certificates are not found yet
3 root certificates are not found yet
3 root certificates are not found yet
3 root certificates are found
/data/metadata/om/certs/ROOTCA-56.crt
ozone admin cert list --role=scm | grep -v 'scm-sub' | grep 'scm' | cut -d ' ' -f 1 | sort | tail -n 1 | xargs -I {} echo /data/metadata/om/certs/ROOTCA-{}.crt | xargs find succeed
Certificate id: 1
  [0]         Version: 3
         SerialNumber: 1
             IssuerDN: CN=scm@scm,OU=e1765d3e-be04-4415-855b-592bc44fbfb9,O=CID-bebd8019-fe02-498f-8d82-38d57cd78e7c,SERIALNUMBER=1
           Start Date: Wed Nov 13 15:49:02 UTC 2024
           Final Date: Wed Nov 13 15:52:02 UTC 2024
            SubjectDN: CN=scm@scm,OU=e1765d3e-be04-4415-855b-592bc44fbfb9,O=CID-bebd8019-fe02-498f-8d82-38d57cd78e7c,SERIALNUMBER=1
           Public Key: RSA Public Key [1a:d3:5e:c5:47:6e:bf:37:37:17:3e:b3:61:91:cf:bf:f8:11:52:c8],[56:66:d1:a4]
        modulus: c9ee5991765f0b2b03d24fe11c0bd93c40213fb1d48294879c70ae0fb9985b1f9a4da5f091df5ec88dadbd3ce3811fa583b9c46af18afc4fc2835b74277884c5054c367bb1055bf92008ecd87acef55a7f1bfc15894809030e752f9947aa3d4faf690ff81b7852d2194e12be9d211cd3e275734feb98f6b383191b7bd56c39fe4e6ce19178390dd505e6c05aabf2cb5a9d8dfa0ece4c3bd41f072640412e9c6fad493cc2db000aa58b4953672556b6b70251d050c72a2e779038eaa8f9f59593c195f1d70519a4598940f970f23ace9f78ea9f47f5519f35f016761b43a804fbd3238c8b3e5839c4f7a1b24d0cb4dc2c3d0f9b89323bd3ff4c4717dee059cd19
public exponent: 10001

  Signature Algorithm: SHA256WITHRSA
            Signature: bae46e30fd2f8d7f9045b19758098ada55590a28
                       dd6217f7cd38dc2ccdbd23df9d8d3c1e720bfcb1
                       fa08733d6597f3c200265ffaea18143617ed8fee
                       3c6aa8b42c53edac0c3efc15515d3760d9416b0e
                       1d480305b1d471d98f45381b4db71b16799d6714
                       7fbfad28060e773e1d54c24a722d8863d92d5127
                       85191533c580a27035c34fdde9525935d74d2710
                       a0dcb6b2443008ecabad6db050268aa2f3526d2f
                       9dbd26836285be82b5505df6e2e081eca368bd59
                       7336ef314086c9125fa81f06e8fe1b67d22bd669
                       9e880e3bb3f70bf1c09c07cc55515541ae9f0f09
                       cef2a5a22bcb2753026fb5b1b3ff53ee893e91ca
                       615e57cdd3cea5ba598bcaf613060bc7
       Extensions: 
                       critical(true) BasicConstraints: isCa(true)
                       critical(true) KeyUsage: 0x6
                       critical(false) 2.5.29.17 value = Sequence
    Tagged [CONTEXT 7] IMPLICIT 
        DER Octet String[4] 


! ozone admin cert info 1 hasn't succeed yet
Certificate not found
! ozone admin cert info 1 succeed
==============================================================================
Root-Ca-Rotation-Client-Checks :: Generate data                               
==============================================================================
Create a volume and bucket                                            | PASS |
------------------------------------------------------------------------------
Create key                                                            | PASS |
------------------------------------------------------------------------------
Read data from previously created key                                 | PASS |
------------------------------------------------------------------------------
Root-Ca-Rotation-Client-Checks :: Generate data                       | PASS |
3 tests, 3 passed, 0 failed
==============================================================================
Output:  /tmp/smoketest/ozonesecure/result/robot-5.xml
==============================================================================
Root-Ca-Rotation :: Smoketest ozone cluster startup                           
==============================================================================
Verify root CA rotation metrics                                       | PASS |
------------------------------------------------------------------------------
Root-Ca-Rotation :: Smoketest ozone cluster startup                   | PASS |
1 test, 1 passed, 0 failed
==============================================================================
Output:  /tmp/smoketest/ozonesecure/result/robot-6.xml
To use Ozone please mount ozone folder to /opt/hadoop
Log:     /rebot-output/log.html
Report:  /rebot-output/report.html
renamed '/home/runner/work/ozone/ozone/hadoop-ozone/dist/target/ozone-2.0.0-SNAPSHOT/compose/ozonesecure/result/tmp.y4EVMlotSrrebot/log.html' -> '/home/runner/work/ozone/ozone/hadoop-ozone/dist/target/ozone-2.0.0-SNAPSHOT/compose/ozonesecure/result/log.html'
renamed '/home/runner/work/ozone/ozone/hadoop-ozone/dist/target/ozone-2.0.0-SNAPSHOT/compose/ozonesecure/result/tmp.y4EVMlotSrrebot/report.html' -> '/home/runner/work/ozone/ozone/hadoop-ozone/dist/target/ozone-2.0.0-SNAPSHOT/compose/ozonesecure/result/report.html'
To use Ozone please mount ozone folder to /opt/hadoop
Output:  /rebot-output/ozonesecure-root-ca-rotation.xml
renamed '/home/runner/work/ozone/ozone/hadoop-ozone/dist/target/ozone-2.0.0-SNAPSHOT/compose/result/tmp.ueeUqETe98rebot/ozonesecure-root-ca-rotation.xml' -> '/home/runner/work/ozone/ozone/hadoop-ozone/dist/target/ozone-2.0.0-SNAPSHOT/compose/result/ozonesecure-root-ca-rotation.xml'
removed 'ozonesecure/result/robot-1.xml'
removed 'ozonesecure/result/robot-2.xml'
removed 'ozonesecure/result/robot-3.xml'
removed 'ozonesecure/result/robot-4.xml'
removed 'ozonesecure/result/robot-5.xml'
removed 'ozonesecure/result/robot-6.xml'
removed 'ozonesecure/result/log.html'
removed 'ozonesecure/result/report.html'
mkdir: created directory '/home/runner/work/ozone/ozone/hadoop-ozone/dist/target/ozone-2.0.0-SNAPSHOT/compose/result/ozonesecure/root-ca-rotation'
renamed 'ozonesecure/result/dn-audit-dn.log' -> '/home/runner/work/ozone/ozone/hadoop-ozone/dist/target/ozone-2.0.0-SNAPSHOT/compose/result/ozonesecure/root-ca-rotation/dn-audit-dn.log'
renamed 'ozonesecure/result/docker-ozonesecure-datanode-1.log' -> '/home/runner/work/ozone/ozone/hadoop-ozone/dist/target/ozone-2.0.0-SNAPSHOT/compose/result/ozonesecure/root-ca-rotation/docker-ozonesecure-datanode-1.log'
renamed 'ozonesecure/result/docker-ozonesecure-datanode-2.log' -> '/home/runner/work/ozone/ozone/hadoop-ozone/dist/target/ozone-2.0.0-SNAPSHOT/compose/result/ozonesecure/root-ca-rotation/docker-ozonesecure-datanode-2.log'
renamed 'ozonesecure/result/docker-ozonesecure-datanode-3.log' -> '/home/runner/work/ozone/ozone/hadoop-ozone/dist/target/ozone-2.0.0-SNAPSHOT/compose/result/ozonesecure/root-ca-rotation/docker-ozonesecure-datanode-3.log'
renamed 'ozonesecure/result/docker-ozonesecure-httpfs-1.log' -> '/home/runner/work/ozone/ozone/hadoop-ozone/dist/target/ozone-2.0.0-SNAPSHOT/compose/result/ozonesecure/root-ca-rotation/docker-ozonesecure-httpfs-1.log'
renamed 'ozonesecure/result/docker-ozonesecure-kdc-1.log' -> '/home/runner/work/ozone/ozone/hadoop-ozone/dist/target/ozone-2.0.0-SNAPSHOT/compose/result/ozonesecure/root-ca-rotation/docker-ozonesecure-kdc-1.log'
renamed 'ozonesecure/result/docker-ozonesecure-kms-1.log' -> '/home/runner/work/ozone/ozone/hadoop-ozone/dist/target/ozone-2.0.0-SNAPSHOT/compose/result/ozonesecure/root-ca-rotation/docker-ozonesecure-kms-1.log'
renamed 'ozonesecure/result/docker-ozonesecure-om-1.log' -> '/home/runner/work/ozone/ozone/hadoop-ozone/dist/target/ozone-2.0.0-SNAPSHOT/compose/result/ozonesecure/root-ca-rotation/docker-ozonesecure-om-1.log'
renamed 'ozonesecure/result/docker-ozonesecure-recon-1.log' -> '/home/runner/work/ozone/ozone/hadoop-ozone/dist/target/ozone-2.0.0-SNAPSHOT/compose/result/ozonesecure/root-ca-rotation/docker-ozonesecure-recon-1.log'
renamed 'ozonesecure/result/docker-ozonesecure-s3g-1.log' -> '/home/runner/work/ozone/ozone/hadoop-ozone/dist/target/ozone-2.0.0-SNAPSHOT/compose/result/ozonesecure/root-ca-rotation/docker-ozonesecure-s3g-1.log'
renamed 'ozonesecure/result/docker-ozonesecure-scm-1.log' -> '/home/runner/work/ozone/ozone/hadoop-ozone/dist/target/ozone-2.0.0-SNAPSHOT/compose/result/ozonesecure/root-ca-rotation/docker-ozonesecure-scm-1.log'
renamed 'ozonesecure/result/kms-audit.log' -> '/home/runner/work/ozone/ozone/hadoop-ozone/dist/target/ozone-2.0.0-SNAPSHOT/compose/result/ozonesecure/root-ca-rotation/kms-audit.log'
renamed 'ozonesecure/result/om-audit-om.log' -> '/home/runner/work/ozone/ozone/hadoop-ozone/dist/target/ozone-2.0.0-SNAPSHOT/compose/result/ozonesecure/root-ca-rotation/om-audit-om.log'
renamed 'ozonesecure/result/om-sys-audit-om.log' -> '/home/runner/work/ozone/ozone/hadoop-ozone/dist/target/ozone-2.0.0-SNAPSHOT/compose/result/ozonesecure/root-ca-rotation/om-sys-audit-om.log'
renamed 'ozonesecure/result/s3g-audit-s3g.log' -> '/home/runner/work/ozone/ozone/hadoop-ozone/dist/target/ozone-2.0.0-SNAPSHOT/compose/result/ozonesecure/root-ca-rotation/s3g-audit-s3g.log'
renamed 'ozonesecure/result/scm-audit-scm.log' -> '/home/runner/work/ozone/ozone/hadoop-ozone/dist/target/ozone-2.0.0-SNAPSHOT/compose/result/ozonesecure/root-ca-rotation/scm-audit-scm.log'
Exception in thread "main" To use Ozone please mount ozone folder to /opt/hadoop
Log:     /rebot-output/log.html
Report:  /rebot-output/report.html
renamed '/home/runner/work/ozone/ozone/hadoop-ozone/dist/target/ozone-2.0.0-SNAPSHOT/compose/result/tmp.tWby88mZZSrebot/log.html' -> '/home/runner/work/ozone/ozone/hadoop-ozone/dist/target/ozone-2.0.0-SNAPSHOT/compose/result/log.html'
renamed '/home/runner/work/ozone/ozone/hadoop-ozone/dist/target/ozone-2.0.0-SNAPSHOT/compose/result/tmp.tWby88mZZSrebot/report.html' -> '/home/runner/work/ozone/ozone/hadoop-ozone/dist/target/ozone-2.0.0-SNAPSHOT/compose/result/report.html'
