2024-05-22 06:02:31,577 [main] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchemaFromFile(129)) - Loading schema from [file:/home/runner/work/ozone/ozone/hadoop-hdds/common/target/classes/network-topology-default.xml]
2024-05-22 06:02:31,580 [main] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchema(176)) - Loading network topology layer schema file
2024-05-22 06:02:31,642 [main] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchemaFromFile(129)) - Loading schema from [file:/home/runner/work/ozone/ozone/hadoop-hdds/common/target/classes/network-topology-default.xml]
2024-05-22 06:02:31,643 [main] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchema(176)) - Loading network topology layer schema file
2024-05-22 06:02:31,852 [main] INFO  reflections.Reflections (Reflections.java:scan(219)) - Reflections took 150 ms to scan 6 urls, producing 158 keys and 360 values
2024-05-22 06:02:31,938 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(134)) - Added a new node: /default-rack/dcbaac4b-16df-4c63-aa1b-f46237ef8373
2024-05-22 06:02:31,939 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(134)) - Added a new node: /default-rack/cf248946-7389-403d-bf9a-a1362c3489cb
2024-05-22 06:02:31,940 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(134)) - Added a new node: /default-rack/caf869e5-6dd7-436f-ad74-1049c2f5b88d
2024-05-22 06:02:31,941 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(134)) - Added a new node: /default-rack/c1ac0555-2a4e-47a2-85b9-db3ae2c105fd
2024-05-22 06:02:31,942 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(134)) - Added a new node: /default-rack/8f2d1398-21fa-48c8-afb1-e39cc4ca0141
2024-05-22 06:02:31,942 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(134)) - Added a new node: /default-rack/fdc3b192-adf0-42eb-90ac-9461a447a600
2024-05-22 06:02:31,943 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(134)) - Added a new node: /default-rack/d2a15ce1-ac0b-44d7-955b-cd18c18de599
2024-05-22 06:02:31,944 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(134)) - Added a new node: /default-rack/5918e2aa-f885-4d40-a303-04a86ff375f5
2024-05-22 06:02:31,945 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(134)) - Added a new node: /default-rack/95123359-4a2d-4eae-bf3c-372667cf2c10
2024-05-22 06:02:31,946 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(134)) - Added a new node: /default-rack/b068e3c1-9a5f-47c7-89d6-82c0dea69908
2024-05-22 06:02:32,048 [main] WARN  utils.HAUtils (HAUtils.java:getMetaDir(339)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2024-05-22 06:02:32,201 [main] WARN  db.DBStoreBuilder (DBStoreBuilder.java:applyDBDefinition(171)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2024-05-22 06:02:32,210 [main] INFO  utils.LeakDetector (LeakDetector.java:start(73)) - Starting leak detector thread ManagedRocksObject0.
2024-05-22 06:02:32,366 [main] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:<init>(241)) - Init the HA SequenceIdGenerator.
2024-05-22 06:02:32,377 [main] INFO  pipeline.PipelineStateManagerImpl (PipelineStateManagerImpl.java:initialize(78)) - No pipeline exists in current db
2024-05-22 06:02:32,395 [main] INFO  algorithms.LeaderChoosePolicyFactory (LeaderChoosePolicyFactory.java:getPolicy(57)) - Create leader choose policy of type org.apache.hadoop.hdds.scm.pipeline.leader.choose.algorithms.MinLeaderCountChoosePolicy
2024-05-22 06:02:32,401 [main] INFO  algorithms.ContainerPlacementPolicyFactory (ContainerPlacementPolicyFactory.java:getPolicyInternal(86)) - Create container placement policy of type org.apache.hadoop.hdds.scm.container.placement.algorithms.SCMContainerPlacementRackScatter
2024-05-22 06:02:32,472 [main] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service BackgroundPipelineCreator.
2024-05-22 06:02:32,474 [main] INFO  pipeline.BackgroundPipelineCreator (BackgroundPipelineCreator.java:start(127)) - Starting RatisPipelineUtilsThread.
2024-05-22 06:02:32,481 [main] INFO  BackgroundPipelineScrubber (BackgroundSCMService.java:start(65)) - Starting BackgroundPipelineScrubber Service.
2024-05-22 06:02:32,482 [main] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service BackgroundPipelineScrubber.
2024-05-22 06:02:32,483 [main] INFO  algorithms.LeaderChoosePolicyFactory (LeaderChoosePolicyFactory.java:getPolicy(57)) - Create leader choose policy of type org.apache.hadoop.hdds.scm.pipeline.leader.choose.algorithms.MinLeaderCountChoosePolicy
2024-05-22 06:02:32,534 [main] INFO  safemode.ContainerSafeModeRule (ContainerSafeModeRule.java:<init>(91)) - containers with one replica threshold count 0
2024-05-22 06:02:32,537 [main] INFO  safemode.HealthyPipelineSafeModeRule (HealthyPipelineSafeModeRule.java:initializeRule(176)) - Total pipeline count is 0, healthy pipeline threshold count is 0
2024-05-22 06:02:32,539 [main] INFO  safemode.OneReplicaPipelineSafeModeRule (OneReplicaPipelineSafeModeRule.java:initializeRule(193)) - Total pipeline count is 0, pipeline's with at least one datanode reported threshold count is 0
2024-05-22 06:02:32,547 [main] WARN  server.ServerUtils (ServerUtils.java:getScmDbDir(143)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2024-05-22 06:02:32,566 [main] WARN  server.ServerUtils (ServerUtils.java:getScmDbDir(143)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2024-05-22 06:02:32,569 [main] INFO  ha.SCMHANodeDetails (SCMHANodeDetails.java:loadSCMHAConfig(207)) - ServiceID for StorageContainerManager is null
2024-05-22 06:02:32,569 [main] INFO  ha.SCMHANodeDetails (SCMHANodeDetails.java:loadSCMHAConfig(212)) - ozone.scm.default.service.id is not defined, falling back to ozone.scm.service.ids to find serviceID for StorageContainerManager if it is HA enabled cluster
2024-05-22 06:02:32,880 [main] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchemaFromFile(129)) - Loading schema from [file:/home/runner/work/ozone/ozone/hadoop-hdds/common/target/classes/network-topology-default.xml]
2024-05-22 06:02:32,880 [main] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchema(176)) - Loading network topology layer schema file
2024-05-22 06:02:32,891 [main] INFO  metrics.MetricRegistries (MetricRegistriesLoader.java:load(64)) - Loaded MetricRegistries class org.apache.ratis.metrics.dropwizard3.Dm3MetricRegistriesImpl
2024-05-22 06:02:32,892 [main] INFO  upgrade.AbstractLayoutVersionManager (AbstractLayoutVersionManager.java:init(83)) - Initializing Layout version manager with metadata layout = HADOOP_PRC_PORTS_IN_DATANODEDETAILS (version = 7), software layout = HADOOP_PRC_PORTS_IN_DATANODEDETAILS (version = 7)
2024-05-22 06:02:32,960 [main] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:upgradeToSequenceId(370)) - upgrade localId to 113750153625600000
2024-05-22 06:02:32,961 [main] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:upgradeToSequenceId(380)) - upgrade delTxnId to 0
2024-05-22 06:02:32,962 [main] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:upgradeToSequenceId(397)) - upgrade containerId to 0
2024-05-22 06:02:32,964 [main] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:upgradeToCertificateSequenceId(444)) - upgrade CertificateId to 2
2024-05-22 06:02:32,965 [main] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:<init>(241)) - Init the HA SequenceIdGenerator.
2024-05-22 06:02:32,968 [main] INFO  algorithms.ContainerPlacementPolicyFactory (ContainerPlacementPolicyFactory.java:getPolicyInternal(86)) - Create container placement policy of type org.apache.hadoop.hdds.scm.container.placement.algorithms.SCMContainerPlacementRackAware
2024-05-22 06:02:32,968 [main] INFO  algorithms.ContainerPlacementPolicyFactory (ContainerPlacementPolicyFactory.java:getPolicyInternal(86)) - Create container placement policy of type org.apache.hadoop.hdds.scm.container.placement.algorithms.SCMContainerPlacementRackScatter
2024-05-22 06:02:32,973 [main] INFO  ExpiredContainerReplicaOpScrubber (BackgroundSCMService.java:start(65)) - Starting ExpiredContainerReplicaOpScrubber Service.
2024-05-22 06:02:32,974 [main] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service ExpiredContainerReplicaOpScrubber.
2024-05-22 06:02:32,980 [main] INFO  algorithms.PipelineChoosePolicyFactory (PipelineChoosePolicyFactory.java:createPipelineChoosePolicyFromClass(80)) - Create pipeline choose policy of type org.apache.hadoop.hdds.scm.pipeline.choose.algorithms.RandomPipelineChoosePolicy
2024-05-22 06:02:32,981 [main] INFO  algorithms.PipelineChoosePolicyFactory (PipelineChoosePolicyFactory.java:createPipelineChoosePolicyFromClass(80)) - Create pipeline choose policy of type org.apache.hadoop.hdds.scm.pipeline.choose.algorithms.RandomPipelineChoosePolicy
2024-05-22 06:02:33,004 [main] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service SCMBlockDeletingService.
2024-05-22 06:02:33,062 [main] INFO  replication.ReplicationManager (ReplicationManager.java:start(296)) - Starting Replication Monitor Thread.
2024-05-22 06:02:33,064 [ReplicationMonitor] INFO  replication.ReplicationManager (ReplicationManager.java:processAll(373)) - Replication Manager is not ready to run until 300000ms after safemode exit
2024-05-22 06:02:33,064 [main] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service ReplicationManager.
2024-05-22 06:02:33,088 [main] WARN  util.NativeCodeLoader (NativeCodeLoader.java:<clinit>(60)) - Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
2024-05-22 06:02:33,113 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:<init>(440)) - SCM start with adminUsers: [runner]
2024-05-22 06:02:33,331 [main] INFO  audit.AuditLogger (AuditLogger.java:refreshDebugCmdSet(135)) - Refresh DebugCmdSet for SCMAudit to [].
2024-05-22 06:02:33,353 [main] INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(90)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 10000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false.
2024-05-22 06:02:33,376 [main] INFO  ipc.Server (Server.java:<init>(1287)) - Listener at 0.0.0.0:35181
2024-05-22 06:02:33,378 [Socket Reader #1 for port 0] INFO  ipc.Server (Server.java:run(1323)) - Starting Socket Reader #1 for port 0
2024-05-22 06:02:33,407 [main] INFO  audit.AuditLogger (AuditLogger.java:refreshDebugCmdSet(135)) - Refresh DebugCmdSet for SCMAudit to [].
2024-05-22 06:02:33,413 [main] INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(90)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 10000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false.
2024-05-22 06:02:33,413 [main] INFO  ipc.Server (Server.java:<init>(1287)) - Listener at 0.0.0.0:40327
2024-05-22 06:02:33,415 [Socket Reader #1 for port 0] INFO  ipc.Server (Server.java:run(1323)) - Starting Socket Reader #1 for port 0
2024-05-22 06:02:33,438 [main] INFO  audit.AuditLogger (AuditLogger.java:refreshDebugCmdSet(135)) - Refresh DebugCmdSet for SCMAudit to [].
2024-05-22 06:02:33,447 [main] INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(90)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 10000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false.
2024-05-22 06:02:33,448 [main] INFO  ipc.Server (Server.java:<init>(1287)) - Listener at 0.0.0.0:39519
2024-05-22 06:02:33,450 [Socket Reader #1 for port 0] INFO  ipc.Server (Server.java:run(1323)) - Starting Socket Reader #1 for port 0
2024-05-22 06:02:33,509 [main] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service ContainerBalancer.
2024-05-22 06:02:33,514 [main] INFO  ha.SCMContext (SCMContext.java:updateSafeModeStatus(225)) - Update SafeModeStatus from SafeModeStatus{safeModeStatus=false, preCheckPassed=true} to SafeModeStatus{safeModeStatus=false, preCheckPassed=true}.
2024-05-22 06:02:33,548 [main] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(205)) - Sending CreatePipelineCommand for pipeline:PipelineID=4fd1ab77-41c2-4899-a508-0697a9224d00 to datanode:caf869e5-6dd7-436f-ad74-1049c2f5b88d
2024-05-22 06:02:33,549 [main] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(205)) - Sending CreatePipelineCommand for pipeline:PipelineID=4fd1ab77-41c2-4899-a508-0697a9224d00 to datanode:c1ac0555-2a4e-47a2-85b9-db3ae2c105fd
2024-05-22 06:02:33,550 [main] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(205)) - Sending CreatePipelineCommand for pipeline:PipelineID=4fd1ab77-41c2-4899-a508-0697a9224d00 to datanode:fdc3b192-adf0-42eb-90ac-9461a447a600
2024-05-22 06:02:33,650 [main] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(205)) - Sending CreatePipelineCommand for pipeline:PipelineID=379cd9e8-46fa-4eb7-89a7-8ca6daa92353 to datanode:cf248946-7389-403d-bf9a-a1362c3489cb
2024-05-22 06:02:33,651 [main] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(205)) - Sending CreatePipelineCommand for pipeline:PipelineID=379cd9e8-46fa-4eb7-89a7-8ca6daa92353 to datanode:dcbaac4b-16df-4c63-aa1b-f46237ef8373
2024-05-22 06:02:33,652 [main] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(205)) - Sending CreatePipelineCommand for pipeline:PipelineID=379cd9e8-46fa-4eb7-89a7-8ca6daa92353 to datanode:8f2d1398-21fa-48c8-afb1-e39cc4ca0141
2024-05-22 06:02:33,673 [main] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:getNextId(145)) - Allocate a batch for containerId, change lastId from 0 to 1000.
2024-05-22 06:02:33,682 [main] WARN  ha.SequenceIdGenerator (SequenceIdGenerator.java:allocateBatch(258)) - Failed to allocate a batch for localId, expected lastId is 0, actual lastId is 113750153625600000.
2024-05-22 06:02:33,683 [main] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:getNextId(145)) - Allocate a batch for localId, change lastId from 113750153625600000 to 113750153625601000.
2024-05-22 06:02:33,804 [EventQueue-CloseContainerForCloseContainerEventHandler] INFO  container.CloseContainerEventHandler (CloseContainerEventHandler.java:onMessage(88)) - Close container Event triggered for container : #4, current state: OPEN
2024-05-22 06:02:33,809 [EventQueue-CloseContainerForCloseContainerEventHandler] INFO  container.CloseContainerEventHandler (CloseContainerEventHandler.java:onMessage(88)) - Close container Event triggered for container : #5, current state: OPEN
2024-05-22 06:02:33,810 [EventQueue-CloseContainerForCloseContainerEventHandler] INFO  container.CloseContainerEventHandler (CloseContainerEventHandler.java:onMessage(88)) - Close container Event triggered for container : #6, current state: OPEN
2024-05-22 06:02:33,810 [EventQueue-CloseContainerForCloseContainerEventHandler] INFO  container.CloseContainerEventHandler (CloseContainerEventHandler.java:onMessage(88)) - Close container Event triggered for container : #1, current state: OPEN
2024-05-22 06:02:33,811 [EventQueue-CloseContainerForCloseContainerEventHandler] INFO  container.CloseContainerEventHandler (CloseContainerEventHandler.java:onMessage(88)) - Close container Event triggered for container : #2, current state: OPEN
2024-05-22 06:02:33,812 [EventQueue-CloseContainerForCloseContainerEventHandler] INFO  container.CloseContainerEventHandler (CloseContainerEventHandler.java:onMessage(88)) - Close container Event triggered for container : #3, current state: OPEN
2024-05-22 06:02:33,882 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1653)) - Container Balancer is not running.
2024-05-22 06:02:33,882 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stopReplicationManager(1786)) - Stopping Replication Manager Service.
2024-05-22 06:02:33,882 [main] INFO  replication.ReplicationManager (ReplicationManager.java:stop(329)) - Stopping Replication Monitor Thread.
2024-05-22 06:02:33,883 [OverReplicatedProcessor] WARN  replication.UnhealthyReplicationProcessor (UnhealthyReplicationProcessor.java:run(180)) - OverReplicatedProcessor interrupted. Exiting...
2024-05-22 06:02:33,883 [UnderReplicatedProcessor] WARN  replication.UnhealthyReplicationProcessor (UnhealthyReplicationProcessor.java:run(180)) - UnderReplicatedProcessor interrupted. Exiting...
2024-05-22 06:02:33,883 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1662)) - Stopping the Datanode Admin Monitor.
2024-05-22 06:02:33,884 [ReplicationMonitor] INFO  replication.ReplicationManager (ReplicationManager.java:run(938)) - Replication Monitor Thread is stopped
2024-05-22 06:02:33,884 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1669)) - Stopping datanode service RPC server
2024-05-22 06:02:33,884 [main] INFO  server.SCMDatanodeProtocolServer (SCMDatanodeProtocolServer.java:stop(425)) - Stopping the RPC server for DataNodes
2024-05-22 06:02:33,884 [main] INFO  ipc.Server (Server.java:stop(3523)) - Stopping server on 35181
2024-05-22 06:02:33,885 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1677)) - Stopping block service RPC server
2024-05-22 06:02:33,886 [main] INFO  server.SCMBlockProtocolServer (SCMBlockProtocolServer.java:stop(171)) - Stopping the RPC server for Block Protocol
2024-05-22 06:02:33,886 [main] INFO  ipc.Server (Server.java:stop(3523)) - Stopping server on 40327
2024-05-22 06:02:33,887 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1684)) - Stopping the StorageContainerLocationProtocol RPC server
2024-05-22 06:02:33,887 [main] INFO  server.SCMClientProtocolServer (SCMClientProtocolServer.java:stop(213)) - Stopping the RPC server for Client Protocol
2024-05-22 06:02:33,888 [main] INFO  ipc.Server (Server.java:stop(3523)) - Stopping server on 39519
2024-05-22 06:02:33,888 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1691)) - Stopping Storage Container Manager HTTP server.
2024-05-22 06:02:33,888 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1699)) - Stopping SCM LayoutVersionManager Service.
2024-05-22 06:02:33,889 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1711)) - Stopping Block Manager Service.
2024-05-22 06:02:33,889 [main] INFO  utils.BackgroundService (BackgroundService.java:shutdown(160)) - Shutting down service SCMBlockDeletingService
2024-05-22 06:02:33,889 [main] INFO  utils.BackgroundService (BackgroundService.java:shutdown(160)) - Shutting down service SCMBlockDeletingService
2024-05-22 06:02:33,890 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1731)) - Stopping SCM Event Queue.
2024-05-22 06:02:33,890 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1742)) - Stopping SCM HA services.
2024-05-22 06:02:33,892 [main] INFO  pipeline.BackgroundPipelineCreator (BackgroundPipelineCreator.java:stop(152)) - Stopping RatisPipelineUtilsThread.
2024-05-22 06:02:33,892 [RatisPipelineUtilsThread-0] WARN  pipeline.BackgroundPipelineCreator (BackgroundPipelineCreator.java:run(183)) - RatisPipelineUtilsThread is interrupted.
2024-05-22 06:02:33,892 [main] INFO  BackgroundPipelineScrubber (BackgroundSCMService.java:stop(128)) - Stopping BackgroundPipelineScrubber Service.
2024-05-22 06:02:33,892 [BackgroundPipelineScrubber] WARN  BackgroundPipelineScrubber (BackgroundSCMService.java:run(112)) - BackgroundPipelineScrubber is interrupted, exit
2024-05-22 06:02:33,893 [ExpiredContainerReplicaOpScrubber] WARN  ExpiredContainerReplicaOpScrubber (BackgroundSCMService.java:run(112)) - ExpiredContainerReplicaOpScrubber is interrupted, exit
2024-05-22 06:02:33,894 [main] INFO  ExpiredContainerReplicaOpScrubber (BackgroundSCMService.java:stop(128)) - Stopping ExpiredContainerReplicaOpScrubber Service.
2024-05-22 06:02:33,894 [main] INFO  utils.BackgroundService (BackgroundService.java:shutdown(160)) - Shutting down service SCMBlockDeletingService
2024-05-22 06:02:33,894 [main] INFO  replication.ReplicationManager (ReplicationManager.java:stop(339)) - Replication Monitor Thread is not running.
2024-05-22 06:02:33,894 [main] WARN  balancer.ContainerBalancer (ContainerBalancer.java:stop(327)) - Cannot stop Container Balancer because it's not running or stopping
2024-05-22 06:02:33,895 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1777)) - Stopping SCM MetadataStore.
2024-05-22 06:02:33,936 [main] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchemaFromFile(129)) - Loading schema from [file:/home/runner/work/ozone/ozone/hadoop-hdds/common/target/classes/network-topology-default.xml]
2024-05-22 06:02:33,936 [main] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchema(176)) - Loading network topology layer schema file
2024-05-22 06:02:33,950 [main] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchemaFromFile(129)) - Loading schema from [file:/home/runner/work/ozone/ozone/hadoop-hdds/common/target/classes/network-topology-default.xml]
2024-05-22 06:02:33,950 [main] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchema(176)) - Loading network topology layer schema file
2024-05-22 06:02:33,952 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(134)) - Added a new node: /default-rack/80a7af59-b9a3-4c97-8482-bfe00dcb81e8
2024-05-22 06:02:33,953 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(134)) - Added a new node: /default-rack/272dd25b-15bf-47e9-b6da-068343c769f0
2024-05-22 06:02:33,953 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(134)) - Added a new node: /default-rack/3e7c9a1c-8355-496e-bbaa-9724ea4a9256
2024-05-22 06:02:33,953 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(134)) - Added a new node: /default-rack/ea2ed72c-22fb-4ed4-9969-08e70525d59c
2024-05-22 06:02:33,954 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(134)) - Added a new node: /default-rack/4e78187d-70c8-4b1d-869c-295b2c681462
2024-05-22 06:02:33,954 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(134)) - Added a new node: /default-rack/49d1b608-8f24-4933-a2dd-803c60bcf2c0
2024-05-22 06:02:33,954 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(134)) - Added a new node: /default-rack/9b1648f9-7889-4867-a69d-4eb9f71e1464
2024-05-22 06:02:33,955 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(134)) - Added a new node: /default-rack/f2292544-96f0-40a0-bdc0-74426577b58c
2024-05-22 06:02:33,955 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(134)) - Added a new node: /default-rack/aced4697-8dc6-424b-ab7e-07bd0d7aa8e0
2024-05-22 06:02:33,955 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(134)) - Added a new node: /default-rack/15ce35ba-895a-42fb-a6e2-f1ddfe3db0eb
2024-05-22 06:02:33,955 [main] WARN  utils.HAUtils (HAUtils.java:getMetaDir(339)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2024-05-22 06:02:33,956 [main] WARN  db.DBStoreBuilder (DBStoreBuilder.java:applyDBDefinition(171)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2024-05-22 06:02:34,026 [main] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:<init>(241)) - Init the HA SequenceIdGenerator.
2024-05-22 06:02:34,027 [main] INFO  pipeline.PipelineStateManagerImpl (PipelineStateManagerImpl.java:initialize(78)) - No pipeline exists in current db
2024-05-22 06:02:34,027 [main] INFO  algorithms.LeaderChoosePolicyFactory (LeaderChoosePolicyFactory.java:getPolicy(57)) - Create leader choose policy of type org.apache.hadoop.hdds.scm.pipeline.leader.choose.algorithms.MinLeaderCountChoosePolicy
2024-05-22 06:02:34,027 [main] INFO  algorithms.ContainerPlacementPolicyFactory (ContainerPlacementPolicyFactory.java:getPolicyInternal(86)) - Create container placement policy of type org.apache.hadoop.hdds.scm.container.placement.algorithms.SCMContainerPlacementRackScatter
2024-05-22 06:02:34,028 [main] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service BackgroundPipelineCreator.
2024-05-22 06:02:34,028 [main] INFO  pipeline.BackgroundPipelineCreator (BackgroundPipelineCreator.java:start(127)) - Starting RatisPipelineUtilsThread.
2024-05-22 06:02:34,028 [main] INFO  BackgroundPipelineScrubber (BackgroundSCMService.java:start(65)) - Starting BackgroundPipelineScrubber Service.
2024-05-22 06:02:34,029 [main] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service BackgroundPipelineScrubber.
2024-05-22 06:02:34,029 [main] INFO  algorithms.LeaderChoosePolicyFactory (LeaderChoosePolicyFactory.java:getPolicy(57)) - Create leader choose policy of type org.apache.hadoop.hdds.scm.pipeline.leader.choose.algorithms.MinLeaderCountChoosePolicy
2024-05-22 06:02:34,030 [main] INFO  safemode.ContainerSafeModeRule (ContainerSafeModeRule.java:<init>(91)) - containers with one replica threshold count 0
2024-05-22 06:02:34,031 [main] INFO  safemode.HealthyPipelineSafeModeRule (HealthyPipelineSafeModeRule.java:initializeRule(176)) - Total pipeline count is 0, healthy pipeline threshold count is 0
2024-05-22 06:02:34,031 [main] INFO  safemode.OneReplicaPipelineSafeModeRule (OneReplicaPipelineSafeModeRule.java:initializeRule(193)) - Total pipeline count is 0, pipeline's with at least one datanode reported threshold count is 0
2024-05-22 06:02:34,031 [main] WARN  server.ServerUtils (ServerUtils.java:getScmDbDir(143)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2024-05-22 06:02:34,032 [main] WARN  server.ServerUtils (ServerUtils.java:getScmDbDir(143)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2024-05-22 06:02:34,033 [main] INFO  ha.SCMHANodeDetails (SCMHANodeDetails.java:loadSCMHAConfig(207)) - ServiceID for StorageContainerManager is null
2024-05-22 06:02:34,033 [main] INFO  ha.SCMHANodeDetails (SCMHANodeDetails.java:loadSCMHAConfig(212)) - ozone.scm.default.service.id is not defined, falling back to ozone.scm.service.ids to find serviceID for StorageContainerManager if it is HA enabled cluster
2024-05-22 06:02:34,034 [main] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchemaFromFile(129)) - Loading schema from [file:/home/runner/work/ozone/ozone/hadoop-hdds/common/target/classes/network-topology-default.xml]
2024-05-22 06:02:34,034 [main] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchema(176)) - Loading network topology layer schema file
2024-05-22 06:02:34,037 [main] INFO  upgrade.AbstractLayoutVersionManager (AbstractLayoutVersionManager.java:init(83)) - Initializing Layout version manager with metadata layout = HADOOP_PRC_PORTS_IN_DATANODEDETAILS (version = 7), software layout = HADOOP_PRC_PORTS_IN_DATANODEDETAILS (version = 7)
2024-05-22 06:02:34,040 [main] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:upgradeToSequenceId(370)) - upgrade localId to 113750153625600000
2024-05-22 06:02:34,040 [main] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:upgradeToSequenceId(380)) - upgrade delTxnId to 0
2024-05-22 06:02:34,041 [main] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:upgradeToSequenceId(397)) - upgrade containerId to 0
2024-05-22 06:02:34,042 [main] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:upgradeToCertificateSequenceId(444)) - upgrade CertificateId to 2
2024-05-22 06:02:34,042 [main] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:<init>(241)) - Init the HA SequenceIdGenerator.
2024-05-22 06:02:34,042 [main] INFO  algorithms.ContainerPlacementPolicyFactory (ContainerPlacementPolicyFactory.java:getPolicyInternal(86)) - Create container placement policy of type org.apache.hadoop.hdds.scm.container.placement.algorithms.SCMContainerPlacementRackAware
2024-05-22 06:02:34,042 [main] INFO  algorithms.ContainerPlacementPolicyFactory (ContainerPlacementPolicyFactory.java:getPolicyInternal(86)) - Create container placement policy of type org.apache.hadoop.hdds.scm.container.placement.algorithms.SCMContainerPlacementRackScatter
2024-05-22 06:02:34,043 [main] INFO  ExpiredContainerReplicaOpScrubber (BackgroundSCMService.java:start(65)) - Starting ExpiredContainerReplicaOpScrubber Service.
2024-05-22 06:02:34,043 [main] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service ExpiredContainerReplicaOpScrubber.
2024-05-22 06:02:34,043 [main] INFO  algorithms.PipelineChoosePolicyFactory (PipelineChoosePolicyFactory.java:createPipelineChoosePolicyFromClass(80)) - Create pipeline choose policy of type org.apache.hadoop.hdds.scm.pipeline.choose.algorithms.RandomPipelineChoosePolicy
2024-05-22 06:02:34,043 [main] INFO  algorithms.PipelineChoosePolicyFactory (PipelineChoosePolicyFactory.java:createPipelineChoosePolicyFromClass(80)) - Create pipeline choose policy of type org.apache.hadoop.hdds.scm.pipeline.choose.algorithms.RandomPipelineChoosePolicy
2024-05-22 06:02:34,045 [main] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service SCMBlockDeletingService.
2024-05-22 06:02:34,046 [main] INFO  replication.ReplicationManager (ReplicationManager.java:start(296)) - Starting Replication Monitor Thread.
2024-05-22 06:02:34,047 [ReplicationMonitor] INFO  replication.ReplicationManager (ReplicationManager.java:processAll(373)) - Replication Manager is not ready to run until 300000ms after safemode exit
2024-05-22 06:02:34,047 [main] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service ReplicationManager.
2024-05-22 06:02:34,048 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:<init>(440)) - SCM start with adminUsers: [runner]
2024-05-22 06:02:34,049 [main] INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(90)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 10000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false.
2024-05-22 06:02:34,049 [main] INFO  ipc.Server (Server.java:<init>(1287)) - Listener at 0.0.0.0:44225
2024-05-22 06:02:34,050 [Socket Reader #1 for port 0] INFO  ipc.Server (Server.java:run(1323)) - Starting Socket Reader #1 for port 0
2024-05-22 06:02:34,051 [main] INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(90)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 10000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false.
2024-05-22 06:02:34,051 [main] INFO  ipc.Server (Server.java:<init>(1287)) - Listener at 0.0.0.0:37473
2024-05-22 06:02:34,052 [Socket Reader #1 for port 0] INFO  ipc.Server (Server.java:run(1323)) - Starting Socket Reader #1 for port 0
2024-05-22 06:02:34,054 [main] INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(90)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 10000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false.
2024-05-22 06:02:34,054 [main] INFO  ipc.Server (Server.java:<init>(1287)) - Listener at 0.0.0.0:37289
2024-05-22 06:02:34,054 [Socket Reader #1 for port 0] INFO  ipc.Server (Server.java:run(1323)) - Starting Socket Reader #1 for port 0
2024-05-22 06:02:34,061 [main] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service ContainerBalancer.
2024-05-22 06:02:34,062 [main] INFO  ha.SCMContext (SCMContext.java:updateSafeModeStatus(225)) - Update SafeModeStatus from SafeModeStatus{safeModeStatus=false, preCheckPassed=true} to SafeModeStatus{safeModeStatus=false, preCheckPassed=true}.
2024-05-22 06:02:34,064 [main] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(205)) - Sending CreatePipelineCommand for pipeline:PipelineID=196b5561-ef5f-4d08-84a4-7034718d4a63 to datanode:9b1648f9-7889-4867-a69d-4eb9f71e1464
2024-05-22 06:02:34,065 [main] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(205)) - Sending CreatePipelineCommand for pipeline:PipelineID=196b5561-ef5f-4d08-84a4-7034718d4a63 to datanode:f2292544-96f0-40a0-bdc0-74426577b58c
2024-05-22 06:02:34,066 [main] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(205)) - Sending CreatePipelineCommand for pipeline:PipelineID=196b5561-ef5f-4d08-84a4-7034718d4a63 to datanode:80a7af59-b9a3-4c97-8482-bfe00dcb81e8
2024-05-22 06:02:34,069 [main] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(205)) - Sending CreatePipelineCommand for pipeline:PipelineID=d8876cfd-00ae-4f03-b013-76b086ed3928 to datanode:f2292544-96f0-40a0-bdc0-74426577b58c
2024-05-22 06:02:34,070 [main] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(205)) - Sending CreatePipelineCommand for pipeline:PipelineID=d8876cfd-00ae-4f03-b013-76b086ed3928 to datanode:9b1648f9-7889-4867-a69d-4eb9f71e1464
2024-05-22 06:02:34,070 [main] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(205)) - Sending CreatePipelineCommand for pipeline:PipelineID=d8876cfd-00ae-4f03-b013-76b086ed3928 to datanode:4e78187d-70c8-4b1d-869c-295b2c681462
2024-05-22 06:02:34,076 [main] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:getNextId(145)) - Allocate a batch for containerId, change lastId from 0 to 1000.
2024-05-22 06:02:34,077 [main] WARN  ha.SequenceIdGenerator (SequenceIdGenerator.java:allocateBatch(258)) - Failed to allocate a batch for localId, expected lastId is 0, actual lastId is 113750153625600000.
2024-05-22 06:02:34,078 [main] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:getNextId(145)) - Allocate a batch for localId, change lastId from 113750153625600000 to 113750153625601000.
2024-05-22 06:02:34,481 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1653)) - Container Balancer is not running.
2024-05-22 06:02:34,482 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stopReplicationManager(1786)) - Stopping Replication Manager Service.
2024-05-22 06:02:34,482 [main] INFO  replication.ReplicationManager (ReplicationManager.java:stop(329)) - Stopping Replication Monitor Thread.
2024-05-22 06:02:34,482 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1662)) - Stopping the Datanode Admin Monitor.
2024-05-22 06:02:34,482 [UnderReplicatedProcessor] WARN  replication.UnhealthyReplicationProcessor (UnhealthyReplicationProcessor.java:run(180)) - UnderReplicatedProcessor interrupted. Exiting...
2024-05-22 06:02:34,482 [ReplicationMonitor] INFO  replication.ReplicationManager (ReplicationManager.java:run(938)) - Replication Monitor Thread is stopped
2024-05-22 06:02:34,482 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1669)) - Stopping datanode service RPC server
2024-05-22 06:02:34,483 [main] INFO  server.SCMDatanodeProtocolServer (SCMDatanodeProtocolServer.java:stop(425)) - Stopping the RPC server for DataNodes
2024-05-22 06:02:34,483 [OverReplicatedProcessor] WARN  replication.UnhealthyReplicationProcessor (UnhealthyReplicationProcessor.java:run(180)) - OverReplicatedProcessor interrupted. Exiting...
2024-05-22 06:02:34,483 [main] INFO  ipc.Server (Server.java:stop(3523)) - Stopping server on 44225
2024-05-22 06:02:34,484 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1677)) - Stopping block service RPC server
2024-05-22 06:02:34,484 [main] INFO  server.SCMBlockProtocolServer (SCMBlockProtocolServer.java:stop(171)) - Stopping the RPC server for Block Protocol
2024-05-22 06:02:34,484 [main] INFO  ipc.Server (Server.java:stop(3523)) - Stopping server on 37473
2024-05-22 06:02:34,484 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1684)) - Stopping the StorageContainerLocationProtocol RPC server
2024-05-22 06:02:34,485 [main] INFO  server.SCMClientProtocolServer (SCMClientProtocolServer.java:stop(213)) - Stopping the RPC server for Client Protocol
2024-05-22 06:02:34,485 [main] INFO  ipc.Server (Server.java:stop(3523)) - Stopping server on 37289
2024-05-22 06:02:34,485 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1691)) - Stopping Storage Container Manager HTTP server.
2024-05-22 06:02:34,485 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1699)) - Stopping SCM LayoutVersionManager Service.
2024-05-22 06:02:34,485 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1711)) - Stopping Block Manager Service.
2024-05-22 06:02:34,486 [main] INFO  utils.BackgroundService (BackgroundService.java:shutdown(160)) - Shutting down service SCMBlockDeletingService
2024-05-22 06:02:34,486 [main] INFO  utils.BackgroundService (BackgroundService.java:shutdown(160)) - Shutting down service SCMBlockDeletingService
2024-05-22 06:02:34,486 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1731)) - Stopping SCM Event Queue.
2024-05-22 06:02:34,486 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1742)) - Stopping SCM HA services.
2024-05-22 06:02:34,487 [main] INFO  pipeline.BackgroundPipelineCreator (BackgroundPipelineCreator.java:stop(152)) - Stopping RatisPipelineUtilsThread.
2024-05-22 06:02:34,487 [RatisPipelineUtilsThread-0] WARN  pipeline.BackgroundPipelineCreator (BackgroundPipelineCreator.java:run(183)) - RatisPipelineUtilsThread is interrupted.
2024-05-22 06:02:34,487 [main] INFO  BackgroundPipelineScrubber (BackgroundSCMService.java:stop(128)) - Stopping BackgroundPipelineScrubber Service.
2024-05-22 06:02:34,487 [main] INFO  ExpiredContainerReplicaOpScrubber (BackgroundSCMService.java:stop(128)) - Stopping ExpiredContainerReplicaOpScrubber Service.
2024-05-22 06:02:34,488 [main] INFO  utils.BackgroundService (BackgroundService.java:shutdown(160)) - Shutting down service SCMBlockDeletingService
2024-05-22 06:02:34,488 [main] INFO  replication.ReplicationManager (ReplicationManager.java:stop(339)) - Replication Monitor Thread is not running.
2024-05-22 06:02:34,487 [ExpiredContainerReplicaOpScrubber] WARN  ExpiredContainerReplicaOpScrubber (BackgroundSCMService.java:run(112)) - ExpiredContainerReplicaOpScrubber is interrupted, exit
2024-05-22 06:02:34,487 [BackgroundPipelineScrubber] WARN  BackgroundPipelineScrubber (BackgroundSCMService.java:run(112)) - BackgroundPipelineScrubber is interrupted, exit
2024-05-22 06:02:34,488 [main] WARN  balancer.ContainerBalancer (ContainerBalancer.java:stop(327)) - Cannot stop Container Balancer because it's not running or stopping
2024-05-22 06:02:34,489 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1777)) - Stopping SCM MetadataStore.
2024-05-22 06:02:34,489 [test-leaseManagerLeaseManager#LeaseMonitor] WARN  lease.LeaseManager (LeaseManager.java:run(287)) - Lease manager is interrupted. Shutting down...
java.lang.InterruptedException
	at java.base/java.util.concurrent.locks.AbstractQueuedSynchronizer.tryAcquireSharedNanos(AbstractQueuedSynchronizer.java:1081)
	at java.base/java.util.concurrent.Semaphore.tryAcquire(Semaphore.java:415)
	at org.apache.hadoop.ozone.lease.LeaseManager$LeaseMonitor.run(LeaseManager.java:285)
	at java.base/java.lang.Thread.run(Thread.java:840)
2024-05-22 06:02:34,513 [main] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchemaFromFile(129)) - Loading schema from [file:/home/runner/work/ozone/ozone/hadoop-hdds/common/target/classes/network-topology-default.xml]
2024-05-22 06:02:34,513 [main] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchema(176)) - Loading network topology layer schema file
2024-05-22 06:02:34,525 [main] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchemaFromFile(129)) - Loading schema from [file:/home/runner/work/ozone/ozone/hadoop-hdds/common/target/classes/network-topology-default.xml]
2024-05-22 06:02:34,525 [main] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchema(176)) - Loading network topology layer schema file
2024-05-22 06:02:34,528 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(134)) - Added a new node: /default-rack/7b69364f-5447-4ab8-a3f3-9c4fdff7da94
2024-05-22 06:02:34,528 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(134)) - Added a new node: /default-rack/4357fc8d-876f-403b-9a7b-62c8300bf658
2024-05-22 06:02:34,529 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(134)) - Added a new node: /default-rack/0d7c5e7b-4539-413c-b3d2-9e97a52601b6
2024-05-22 06:02:34,529 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(134)) - Added a new node: /default-rack/f94ab83f-1b78-4ce0-8c3f-420ff1d9849b
2024-05-22 06:02:34,529 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(134)) - Added a new node: /default-rack/a1562103-90c9-460c-b3e0-d154af1119c8
2024-05-22 06:02:34,530 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(134)) - Added a new node: /default-rack/d1c040d5-aec7-48a8-b0ce-0f8e2be464ef
2024-05-22 06:02:34,530 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(134)) - Added a new node: /default-rack/af44fc08-8acd-480c-85e9-9fd38d916594
2024-05-22 06:02:34,530 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(134)) - Added a new node: /default-rack/975dc89f-6e2a-47c3-ae92-848bc2ed708c
2024-05-22 06:02:34,530 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(134)) - Added a new node: /default-rack/b4eeb7f3-96dd-4249-9cf3-60cd7cded03d
2024-05-22 06:02:34,531 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(134)) - Added a new node: /default-rack/4e76ced5-dd79-48db-8c66-ab206f735106
2024-05-22 06:02:34,531 [main] WARN  utils.HAUtils (HAUtils.java:getMetaDir(339)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2024-05-22 06:02:34,532 [main] WARN  db.DBStoreBuilder (DBStoreBuilder.java:applyDBDefinition(171)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2024-05-22 06:02:34,613 [main] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:<init>(241)) - Init the HA SequenceIdGenerator.
2024-05-22 06:02:34,613 [main] INFO  pipeline.PipelineStateManagerImpl (PipelineStateManagerImpl.java:initialize(78)) - No pipeline exists in current db
2024-05-22 06:02:34,613 [main] INFO  algorithms.LeaderChoosePolicyFactory (LeaderChoosePolicyFactory.java:getPolicy(57)) - Create leader choose policy of type org.apache.hadoop.hdds.scm.pipeline.leader.choose.algorithms.MinLeaderCountChoosePolicy
2024-05-22 06:02:34,614 [main] INFO  algorithms.ContainerPlacementPolicyFactory (ContainerPlacementPolicyFactory.java:getPolicyInternal(86)) - Create container placement policy of type org.apache.hadoop.hdds.scm.container.placement.algorithms.SCMContainerPlacementRackScatter
2024-05-22 06:02:34,614 [main] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service BackgroundPipelineCreator.
2024-05-22 06:02:34,614 [main] INFO  pipeline.BackgroundPipelineCreator (BackgroundPipelineCreator.java:start(127)) - Starting RatisPipelineUtilsThread.
2024-05-22 06:02:34,615 [main] INFO  BackgroundPipelineScrubber (BackgroundSCMService.java:start(65)) - Starting BackgroundPipelineScrubber Service.
2024-05-22 06:02:34,615 [main] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service BackgroundPipelineScrubber.
2024-05-22 06:02:34,615 [main] INFO  algorithms.LeaderChoosePolicyFactory (LeaderChoosePolicyFactory.java:getPolicy(57)) - Create leader choose policy of type org.apache.hadoop.hdds.scm.pipeline.leader.choose.algorithms.MinLeaderCountChoosePolicy
2024-05-22 06:02:34,616 [main] INFO  safemode.ContainerSafeModeRule (ContainerSafeModeRule.java:<init>(91)) - containers with one replica threshold count 0
2024-05-22 06:02:34,617 [main] INFO  safemode.HealthyPipelineSafeModeRule (HealthyPipelineSafeModeRule.java:initializeRule(176)) - Total pipeline count is 0, healthy pipeline threshold count is 0
2024-05-22 06:02:34,617 [main] INFO  safemode.OneReplicaPipelineSafeModeRule (OneReplicaPipelineSafeModeRule.java:initializeRule(193)) - Total pipeline count is 0, pipeline's with at least one datanode reported threshold count is 0
2024-05-22 06:02:34,617 [main] WARN  server.ServerUtils (ServerUtils.java:getScmDbDir(143)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2024-05-22 06:02:34,619 [main] WARN  server.ServerUtils (ServerUtils.java:getScmDbDir(143)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2024-05-22 06:02:34,619 [main] INFO  ha.SCMHANodeDetails (SCMHANodeDetails.java:loadSCMHAConfig(207)) - ServiceID for StorageContainerManager is null
2024-05-22 06:02:34,619 [main] INFO  ha.SCMHANodeDetails (SCMHANodeDetails.java:loadSCMHAConfig(212)) - ozone.scm.default.service.id is not defined, falling back to ozone.scm.service.ids to find serviceID for StorageContainerManager if it is HA enabled cluster
2024-05-22 06:02:34,620 [main] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchemaFromFile(129)) - Loading schema from [file:/home/runner/work/ozone/ozone/hadoop-hdds/common/target/classes/network-topology-default.xml]
2024-05-22 06:02:34,620 [main] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchema(176)) - Loading network topology layer schema file
2024-05-22 06:02:34,622 [main] INFO  upgrade.AbstractLayoutVersionManager (AbstractLayoutVersionManager.java:init(83)) - Initializing Layout version manager with metadata layout = HADOOP_PRC_PORTS_IN_DATANODEDETAILS (version = 7), software layout = HADOOP_PRC_PORTS_IN_DATANODEDETAILS (version = 7)
2024-05-22 06:02:34,624 [main] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:upgradeToSequenceId(370)) - upgrade localId to 113750153625600000
2024-05-22 06:02:34,624 [main] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:upgradeToSequenceId(380)) - upgrade delTxnId to 0
2024-05-22 06:02:34,625 [main] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:upgradeToSequenceId(397)) - upgrade containerId to 0
2024-05-22 06:02:34,626 [main] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:upgradeToCertificateSequenceId(444)) - upgrade CertificateId to 2
2024-05-22 06:02:34,626 [main] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:<init>(241)) - Init the HA SequenceIdGenerator.
2024-05-22 06:02:34,626 [main] INFO  algorithms.ContainerPlacementPolicyFactory (ContainerPlacementPolicyFactory.java:getPolicyInternal(86)) - Create container placement policy of type org.apache.hadoop.hdds.scm.container.placement.algorithms.SCMContainerPlacementRackAware
2024-05-22 06:02:34,626 [main] INFO  algorithms.ContainerPlacementPolicyFactory (ContainerPlacementPolicyFactory.java:getPolicyInternal(86)) - Create container placement policy of type org.apache.hadoop.hdds.scm.container.placement.algorithms.SCMContainerPlacementRackScatter
2024-05-22 06:02:34,626 [main] INFO  ExpiredContainerReplicaOpScrubber (BackgroundSCMService.java:start(65)) - Starting ExpiredContainerReplicaOpScrubber Service.
2024-05-22 06:02:34,627 [main] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service ExpiredContainerReplicaOpScrubber.
2024-05-22 06:02:34,627 [main] INFO  algorithms.PipelineChoosePolicyFactory (PipelineChoosePolicyFactory.java:createPipelineChoosePolicyFromClass(80)) - Create pipeline choose policy of type org.apache.hadoop.hdds.scm.pipeline.choose.algorithms.RandomPipelineChoosePolicy
2024-05-22 06:02:34,627 [main] INFO  algorithms.PipelineChoosePolicyFactory (PipelineChoosePolicyFactory.java:createPipelineChoosePolicyFromClass(80)) - Create pipeline choose policy of type org.apache.hadoop.hdds.scm.pipeline.choose.algorithms.RandomPipelineChoosePolicy
2024-05-22 06:02:34,628 [main] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service SCMBlockDeletingService.
2024-05-22 06:02:34,629 [main] INFO  replication.ReplicationManager (ReplicationManager.java:start(296)) - Starting Replication Monitor Thread.
2024-05-22 06:02:34,630 [main] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service ReplicationManager.
2024-05-22 06:02:34,630 [ReplicationMonitor] INFO  replication.ReplicationManager (ReplicationManager.java:processAll(373)) - Replication Manager is not ready to run until 300000ms after safemode exit
2024-05-22 06:02:34,630 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:<init>(440)) - SCM start with adminUsers: [runner]
2024-05-22 06:02:34,631 [main] INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(90)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 10000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false.
2024-05-22 06:02:34,631 [main] INFO  ipc.Server (Server.java:<init>(1287)) - Listener at 0.0.0.0:41533
2024-05-22 06:02:34,631 [Socket Reader #1 for port 0] INFO  ipc.Server (Server.java:run(1323)) - Starting Socket Reader #1 for port 0
2024-05-22 06:02:34,633 [main] INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(90)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 10000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false.
2024-05-22 06:02:34,633 [main] INFO  ipc.Server (Server.java:<init>(1287)) - Listener at 0.0.0.0:33093
2024-05-22 06:02:34,633 [Socket Reader #1 for port 0] INFO  ipc.Server (Server.java:run(1323)) - Starting Socket Reader #1 for port 0
2024-05-22 06:02:34,637 [main] INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(90)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 10000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false.
2024-05-22 06:02:34,637 [main] INFO  ipc.Server (Server.java:<init>(1287)) - Listener at 0.0.0.0:33185
2024-05-22 06:02:34,637 [Socket Reader #1 for port 0] INFO  ipc.Server (Server.java:run(1323)) - Starting Socket Reader #1 for port 0
2024-05-22 06:02:34,647 [main] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service ContainerBalancer.
2024-05-22 06:02:34,648 [main] INFO  ha.SCMContext (SCMContext.java:updateSafeModeStatus(225)) - Update SafeModeStatus from SafeModeStatus{safeModeStatus=false, preCheckPassed=true} to SafeModeStatus{safeModeStatus=false, preCheckPassed=true}.
2024-05-22 06:02:34,650 [main] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(205)) - Sending CreatePipelineCommand for pipeline:PipelineID=401c2eba-56c2-43fd-9504-77938f645770 to datanode:4357fc8d-876f-403b-9a7b-62c8300bf658
2024-05-22 06:02:34,650 [main] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(205)) - Sending CreatePipelineCommand for pipeline:PipelineID=401c2eba-56c2-43fd-9504-77938f645770 to datanode:d1c040d5-aec7-48a8-b0ce-0f8e2be464ef
2024-05-22 06:02:34,650 [main] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(205)) - Sending CreatePipelineCommand for pipeline:PipelineID=401c2eba-56c2-43fd-9504-77938f645770 to datanode:7b69364f-5447-4ab8-a3f3-9c4fdff7da94
2024-05-22 06:02:34,655 [main] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(205)) - Sending CreatePipelineCommand for pipeline:PipelineID=43b47dd9-c3a6-4534-a3cf-645a39c51a0b to datanode:4357fc8d-876f-403b-9a7b-62c8300bf658
2024-05-22 06:02:34,656 [main] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(205)) - Sending CreatePipelineCommand for pipeline:PipelineID=43b47dd9-c3a6-4534-a3cf-645a39c51a0b to datanode:7b69364f-5447-4ab8-a3f3-9c4fdff7da94
2024-05-22 06:02:34,656 [main] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(205)) - Sending CreatePipelineCommand for pipeline:PipelineID=43b47dd9-c3a6-4534-a3cf-645a39c51a0b to datanode:975dc89f-6e2a-47c3-ae92-848bc2ed708c
2024-05-22 06:02:34,659 [main] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(205)) - Sending CreatePipelineCommand for pipeline:PipelineID=6b706c0e-4489-4d2e-856d-87be8fc01c0b to datanode:0d7c5e7b-4539-413c-b3d2-9e97a52601b6
2024-05-22 06:02:34,659 [main] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(205)) - Sending CreatePipelineCommand for pipeline:PipelineID=6b706c0e-4489-4d2e-856d-87be8fc01c0b to datanode:a1562103-90c9-460c-b3e0-d154af1119c8
2024-05-22 06:02:34,659 [main] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(205)) - Sending CreatePipelineCommand for pipeline:PipelineID=6b706c0e-4489-4d2e-856d-87be8fc01c0b to datanode:d1c040d5-aec7-48a8-b0ce-0f8e2be464ef
2024-05-22 06:02:34,662 [main] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(205)) - Sending CreatePipelineCommand for pipeline:PipelineID=94f7c51a-34e8-4912-a4b7-0c6fee7440e7 to datanode:af44fc08-8acd-480c-85e9-9fd38d916594
2024-05-22 06:02:34,662 [main] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(205)) - Sending CreatePipelineCommand for pipeline:PipelineID=94f7c51a-34e8-4912-a4b7-0c6fee7440e7 to datanode:a1562103-90c9-460c-b3e0-d154af1119c8
2024-05-22 06:02:34,662 [main] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(205)) - Sending CreatePipelineCommand for pipeline:PipelineID=94f7c51a-34e8-4912-a4b7-0c6fee7440e7 to datanode:975dc89f-6e2a-47c3-ae92-848bc2ed708c
2024-05-22 06:02:34,665 [main] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(205)) - Sending CreatePipelineCommand for pipeline:PipelineID=c2a14029-22b3-4c4d-b8a3-5bc96b3edaae to datanode:0d7c5e7b-4539-413c-b3d2-9e97a52601b6
2024-05-22 06:02:34,665 [main] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(205)) - Sending CreatePipelineCommand for pipeline:PipelineID=c2a14029-22b3-4c4d-b8a3-5bc96b3edaae to datanode:f94ab83f-1b78-4ce0-8c3f-420ff1d9849b
2024-05-22 06:02:34,665 [main] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(205)) - Sending CreatePipelineCommand for pipeline:PipelineID=c2a14029-22b3-4c4d-b8a3-5bc96b3edaae to datanode:af44fc08-8acd-480c-85e9-9fd38d916594
2024-05-22 06:02:34,673 [main] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:getNextId(145)) - Allocate a batch for containerId, change lastId from 0 to 1000.
2024-05-22 06:02:34,675 [main] WARN  ha.SequenceIdGenerator (SequenceIdGenerator.java:allocateBatch(258)) - Failed to allocate a batch for localId, expected lastId is 0, actual lastId is 113750153625600000.
2024-05-22 06:02:34,676 [main] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:getNextId(145)) - Allocate a batch for localId, change lastId from 113750153625600000 to 113750153625601000.
2024-05-22 06:02:34,704 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1653)) - Container Balancer is not running.
2024-05-22 06:02:34,704 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stopReplicationManager(1786)) - Stopping Replication Manager Service.
2024-05-22 06:02:34,704 [main] INFO  replication.ReplicationManager (ReplicationManager.java:stop(329)) - Stopping Replication Monitor Thread.
2024-05-22 06:02:34,704 [UnderReplicatedProcessor] WARN  replication.UnhealthyReplicationProcessor (UnhealthyReplicationProcessor.java:run(180)) - UnderReplicatedProcessor interrupted. Exiting...
2024-05-22 06:02:34,704 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1662)) - Stopping the Datanode Admin Monitor.
2024-05-22 06:02:34,704 [ReplicationMonitor] INFO  replication.ReplicationManager (ReplicationManager.java:run(938)) - Replication Monitor Thread is stopped
2024-05-22 06:02:34,704 [OverReplicatedProcessor] WARN  replication.UnhealthyReplicationProcessor (UnhealthyReplicationProcessor.java:run(180)) - OverReplicatedProcessor interrupted. Exiting...
2024-05-22 06:02:34,705 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1669)) - Stopping datanode service RPC server
2024-05-22 06:02:34,705 [main] INFO  server.SCMDatanodeProtocolServer (SCMDatanodeProtocolServer.java:stop(425)) - Stopping the RPC server for DataNodes
2024-05-22 06:02:34,705 [main] INFO  ipc.Server (Server.java:stop(3523)) - Stopping server on 41533
2024-05-22 06:02:34,706 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1677)) - Stopping block service RPC server
2024-05-22 06:02:34,706 [main] INFO  server.SCMBlockProtocolServer (SCMBlockProtocolServer.java:stop(171)) - Stopping the RPC server for Block Protocol
2024-05-22 06:02:34,706 [main] INFO  ipc.Server (Server.java:stop(3523)) - Stopping server on 33093
2024-05-22 06:02:34,706 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1684)) - Stopping the StorageContainerLocationProtocol RPC server
2024-05-22 06:02:34,706 [main] INFO  server.SCMClientProtocolServer (SCMClientProtocolServer.java:stop(213)) - Stopping the RPC server for Client Protocol
2024-05-22 06:02:34,706 [main] INFO  ipc.Server (Server.java:stop(3523)) - Stopping server on 33185
2024-05-22 06:02:34,707 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1691)) - Stopping Storage Container Manager HTTP server.
2024-05-22 06:02:34,707 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1699)) - Stopping SCM LayoutVersionManager Service.
2024-05-22 06:02:34,707 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1711)) - Stopping Block Manager Service.
2024-05-22 06:02:34,707 [main] INFO  utils.BackgroundService (BackgroundService.java:shutdown(160)) - Shutting down service SCMBlockDeletingService
2024-05-22 06:02:34,707 [main] INFO  utils.BackgroundService (BackgroundService.java:shutdown(160)) - Shutting down service SCMBlockDeletingService
2024-05-22 06:02:34,708 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1731)) - Stopping SCM Event Queue.
2024-05-22 06:02:34,708 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1742)) - Stopping SCM HA services.
2024-05-22 06:02:34,708 [main] INFO  pipeline.BackgroundPipelineCreator (BackgroundPipelineCreator.java:stop(152)) - Stopping RatisPipelineUtilsThread.
2024-05-22 06:02:34,708 [RatisPipelineUtilsThread-0] WARN  pipeline.BackgroundPipelineCreator (BackgroundPipelineCreator.java:run(183)) - RatisPipelineUtilsThread is interrupted.
2024-05-22 06:02:34,708 [BackgroundPipelineScrubber] WARN  BackgroundPipelineScrubber (BackgroundSCMService.java:run(112)) - BackgroundPipelineScrubber is interrupted, exit
2024-05-22 06:02:34,709 [main] INFO  BackgroundPipelineScrubber (BackgroundSCMService.java:stop(128)) - Stopping BackgroundPipelineScrubber Service.
2024-05-22 06:02:34,709 [main] INFO  ExpiredContainerReplicaOpScrubber (BackgroundSCMService.java:stop(128)) - Stopping ExpiredContainerReplicaOpScrubber Service.
2024-05-22 06:02:34,709 [ExpiredContainerReplicaOpScrubber] WARN  ExpiredContainerReplicaOpScrubber (BackgroundSCMService.java:run(112)) - ExpiredContainerReplicaOpScrubber is interrupted, exit
2024-05-22 06:02:34,709 [main] INFO  utils.BackgroundService (BackgroundService.java:shutdown(160)) - Shutting down service SCMBlockDeletingService
2024-05-22 06:02:34,709 [main] INFO  replication.ReplicationManager (ReplicationManager.java:stop(339)) - Replication Monitor Thread is not running.
2024-05-22 06:02:34,709 [main] WARN  balancer.ContainerBalancer (ContainerBalancer.java:stop(327)) - Cannot stop Container Balancer because it's not running or stopping
2024-05-22 06:02:34,710 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1777)) - Stopping SCM MetadataStore.
2024-05-22 06:02:34,710 [test-leaseManagerLeaseManager#LeaseMonitor] WARN  lease.LeaseManager (LeaseManager.java:run(287)) - Lease manager is interrupted. Shutting down...
java.lang.InterruptedException
	at java.base/java.util.concurrent.locks.AbstractQueuedSynchronizer.tryAcquireSharedNanos(AbstractQueuedSynchronizer.java:1081)
	at java.base/java.util.concurrent.Semaphore.tryAcquire(Semaphore.java:415)
	at org.apache.hadoop.ozone.lease.LeaseManager$LeaseMonitor.run(LeaseManager.java:285)
	at java.base/java.lang.Thread.run(Thread.java:840)
2024-05-22 06:02:34,740 [main] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchemaFromFile(129)) - Loading schema from [file:/home/runner/work/ozone/ozone/hadoop-hdds/common/target/classes/network-topology-default.xml]
2024-05-22 06:02:34,740 [main] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchema(176)) - Loading network topology layer schema file
2024-05-22 06:02:34,755 [main] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchemaFromFile(129)) - Loading schema from [file:/home/runner/work/ozone/ozone/hadoop-hdds/common/target/classes/network-topology-default.xml]
2024-05-22 06:02:34,755 [main] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchema(176)) - Loading network topology layer schema file
2024-05-22 06:02:34,758 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(134)) - Added a new node: /default-rack/4d0e55bc-6b1c-42a7-a8b2-9c6f3f2cbd98
2024-05-22 06:02:34,758 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(134)) - Added a new node: /default-rack/df20fb93-fbed-4b7a-823a-c36003fe77af
2024-05-22 06:02:34,758 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(134)) - Added a new node: /default-rack/0ab58df8-1c21-4862-895a-f4a70090364c
2024-05-22 06:02:34,759 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(134)) - Added a new node: /default-rack/64e419b8-6b0f-4160-97cf-55fd70eaa44e
2024-05-22 06:02:34,759 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(134)) - Added a new node: /default-rack/59761f0c-dd5c-4450-bf20-0176dd0f967a
2024-05-22 06:02:34,759 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(134)) - Added a new node: /default-rack/24592afc-ee59-4797-bce1-368ce94dce50
2024-05-22 06:02:34,759 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(134)) - Added a new node: /default-rack/2d47fbca-077d-4693-8694-c7962b01dbff
2024-05-22 06:02:34,759 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(134)) - Added a new node: /default-rack/78695be0-3b4d-46b0-b4ed-2157457864f6
2024-05-22 06:02:34,760 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(134)) - Added a new node: /default-rack/90d003ea-e4de-4c2f-99a9-5b93e9f2aa50
2024-05-22 06:02:34,760 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(134)) - Added a new node: /default-rack/8ec973b3-2e3e-4af2-99f6-d95f8f79aac7
2024-05-22 06:02:34,760 [main] WARN  utils.HAUtils (HAUtils.java:getMetaDir(339)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2024-05-22 06:02:34,761 [main] WARN  db.DBStoreBuilder (DBStoreBuilder.java:applyDBDefinition(171)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2024-05-22 06:02:34,841 [main] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:<init>(241)) - Init the HA SequenceIdGenerator.
2024-05-22 06:02:34,841 [main] INFO  pipeline.PipelineStateManagerImpl (PipelineStateManagerImpl.java:initialize(78)) - No pipeline exists in current db
2024-05-22 06:02:34,841 [main] INFO  algorithms.LeaderChoosePolicyFactory (LeaderChoosePolicyFactory.java:getPolicy(57)) - Create leader choose policy of type org.apache.hadoop.hdds.scm.pipeline.leader.choose.algorithms.MinLeaderCountChoosePolicy
2024-05-22 06:02:34,842 [main] INFO  algorithms.ContainerPlacementPolicyFactory (ContainerPlacementPolicyFactory.java:getPolicyInternal(86)) - Create container placement policy of type org.apache.hadoop.hdds.scm.container.placement.algorithms.SCMContainerPlacementRackScatter
2024-05-22 06:02:34,842 [main] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service BackgroundPipelineCreator.
2024-05-22 06:02:34,842 [main] INFO  pipeline.BackgroundPipelineCreator (BackgroundPipelineCreator.java:start(127)) - Starting RatisPipelineUtilsThread.
2024-05-22 06:02:34,843 [main] INFO  BackgroundPipelineScrubber (BackgroundSCMService.java:start(65)) - Starting BackgroundPipelineScrubber Service.
2024-05-22 06:02:34,843 [main] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service BackgroundPipelineScrubber.
2024-05-22 06:02:34,844 [main] INFO  algorithms.LeaderChoosePolicyFactory (LeaderChoosePolicyFactory.java:getPolicy(57)) - Create leader choose policy of type org.apache.hadoop.hdds.scm.pipeline.leader.choose.algorithms.MinLeaderCountChoosePolicy
2024-05-22 06:02:34,845 [main] INFO  safemode.ContainerSafeModeRule (ContainerSafeModeRule.java:<init>(91)) - containers with one replica threshold count 0
2024-05-22 06:02:34,845 [main] INFO  safemode.HealthyPipelineSafeModeRule (HealthyPipelineSafeModeRule.java:initializeRule(176)) - Total pipeline count is 0, healthy pipeline threshold count is 0
2024-05-22 06:02:34,845 [main] INFO  safemode.OneReplicaPipelineSafeModeRule (OneReplicaPipelineSafeModeRule.java:initializeRule(193)) - Total pipeline count is 0, pipeline's with at least one datanode reported threshold count is 0
2024-05-22 06:02:34,846 [main] WARN  server.ServerUtils (ServerUtils.java:getScmDbDir(143)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2024-05-22 06:02:34,847 [main] WARN  server.ServerUtils (ServerUtils.java:getScmDbDir(143)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2024-05-22 06:02:34,847 [main] INFO  ha.SCMHANodeDetails (SCMHANodeDetails.java:loadSCMHAConfig(207)) - ServiceID for StorageContainerManager is null
2024-05-22 06:02:34,848 [main] INFO  ha.SCMHANodeDetails (SCMHANodeDetails.java:loadSCMHAConfig(212)) - ozone.scm.default.service.id is not defined, falling back to ozone.scm.service.ids to find serviceID for StorageContainerManager if it is HA enabled cluster
2024-05-22 06:02:34,849 [main] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchemaFromFile(129)) - Loading schema from [file:/home/runner/work/ozone/ozone/hadoop-hdds/common/target/classes/network-topology-default.xml]
2024-05-22 06:02:34,849 [main] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchema(176)) - Loading network topology layer schema file
2024-05-22 06:02:34,851 [main] INFO  upgrade.AbstractLayoutVersionManager (AbstractLayoutVersionManager.java:init(83)) - Initializing Layout version manager with metadata layout = HADOOP_PRC_PORTS_IN_DATANODEDETAILS (version = 7), software layout = HADOOP_PRC_PORTS_IN_DATANODEDETAILS (version = 7)
2024-05-22 06:02:34,853 [main] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:upgradeToSequenceId(370)) - upgrade localId to 113750153625600000
2024-05-22 06:02:34,853 [main] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:upgradeToSequenceId(380)) - upgrade delTxnId to 0
2024-05-22 06:02:34,854 [main] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:upgradeToSequenceId(397)) - upgrade containerId to 0
2024-05-22 06:02:34,855 [main] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:upgradeToCertificateSequenceId(444)) - upgrade CertificateId to 2
2024-05-22 06:02:34,855 [main] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:<init>(241)) - Init the HA SequenceIdGenerator.
2024-05-22 06:02:34,855 [main] INFO  algorithms.ContainerPlacementPolicyFactory (ContainerPlacementPolicyFactory.java:getPolicyInternal(86)) - Create container placement policy of type org.apache.hadoop.hdds.scm.container.placement.algorithms.SCMContainerPlacementRackAware
2024-05-22 06:02:34,855 [main] INFO  algorithms.ContainerPlacementPolicyFactory (ContainerPlacementPolicyFactory.java:getPolicyInternal(86)) - Create container placement policy of type org.apache.hadoop.hdds.scm.container.placement.algorithms.SCMContainerPlacementRackScatter
2024-05-22 06:02:34,856 [main] INFO  ExpiredContainerReplicaOpScrubber (BackgroundSCMService.java:start(65)) - Starting ExpiredContainerReplicaOpScrubber Service.
2024-05-22 06:02:34,856 [main] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service ExpiredContainerReplicaOpScrubber.
2024-05-22 06:02:34,856 [main] INFO  algorithms.PipelineChoosePolicyFactory (PipelineChoosePolicyFactory.java:createPipelineChoosePolicyFromClass(80)) - Create pipeline choose policy of type org.apache.hadoop.hdds.scm.pipeline.choose.algorithms.RandomPipelineChoosePolicy
2024-05-22 06:02:34,856 [main] INFO  algorithms.PipelineChoosePolicyFactory (PipelineChoosePolicyFactory.java:createPipelineChoosePolicyFromClass(80)) - Create pipeline choose policy of type org.apache.hadoop.hdds.scm.pipeline.choose.algorithms.RandomPipelineChoosePolicy
2024-05-22 06:02:34,857 [main] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service SCMBlockDeletingService.
2024-05-22 06:02:34,859 [main] INFO  replication.ReplicationManager (ReplicationManager.java:start(296)) - Starting Replication Monitor Thread.
2024-05-22 06:02:34,860 [main] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service ReplicationManager.
2024-05-22 06:02:34,860 [ReplicationMonitor] INFO  replication.ReplicationManager (ReplicationManager.java:processAll(373)) - Replication Manager is not ready to run until 300000ms after safemode exit
2024-05-22 06:02:34,861 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:<init>(440)) - SCM start with adminUsers: [runner]
2024-05-22 06:02:34,861 [main] INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(90)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 10000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false.
2024-05-22 06:02:34,861 [main] INFO  ipc.Server (Server.java:<init>(1287)) - Listener at 0.0.0.0:45693
2024-05-22 06:02:34,862 [Socket Reader #1 for port 0] INFO  ipc.Server (Server.java:run(1323)) - Starting Socket Reader #1 for port 0
2024-05-22 06:02:34,863 [main] INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(90)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 10000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false.
2024-05-22 06:02:34,863 [main] INFO  ipc.Server (Server.java:<init>(1287)) - Listener at 0.0.0.0:34529
2024-05-22 06:02:34,864 [Socket Reader #1 for port 0] INFO  ipc.Server (Server.java:run(1323)) - Starting Socket Reader #1 for port 0
2024-05-22 06:02:34,866 [main] INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(90)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 10000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false.
2024-05-22 06:02:34,866 [main] INFO  ipc.Server (Server.java:<init>(1287)) - Listener at 0.0.0.0:37001
2024-05-22 06:02:34,867 [Socket Reader #1 for port 0] INFO  ipc.Server (Server.java:run(1323)) - Starting Socket Reader #1 for port 0
2024-05-22 06:02:34,872 [main] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service ContainerBalancer.
2024-05-22 06:02:34,873 [main] INFO  ha.SCMContext (SCMContext.java:updateSafeModeStatus(225)) - Update SafeModeStatus from SafeModeStatus{safeModeStatus=false, preCheckPassed=true} to SafeModeStatus{safeModeStatus=false, preCheckPassed=true}.
2024-05-22 06:02:34,875 [main] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(205)) - Sending CreatePipelineCommand for pipeline:PipelineID=459a9eca-8965-4804-8a0b-ef00ea008c75 to datanode:59761f0c-dd5c-4450-bf20-0176dd0f967a
2024-05-22 06:02:34,875 [main] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(205)) - Sending CreatePipelineCommand for pipeline:PipelineID=459a9eca-8965-4804-8a0b-ef00ea008c75 to datanode:2d47fbca-077d-4693-8694-c7962b01dbff
2024-05-22 06:02:34,899 [LeakDetector-ManagedRocksObject0] WARN  managed.ManagedRocksObjectUtils (ManagedRocksObjectUtils.java:reportLeak(63)) - ManagedWriteBatch is not closed properly
2024-05-22 06:02:34,899 [LeakDetector-ManagedRocksObject0] WARN  managed.ManagedRocksObjectUtils (ManagedRocksObjectUtils.java:reportLeak(63)) - ManagedWriteBatch is not closed properly
2024-05-22 06:02:34,899 [main] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(205)) - Sending CreatePipelineCommand for pipeline:PipelineID=459a9eca-8965-4804-8a0b-ef00ea008c75 to datanode:78695be0-3b4d-46b0-b4ed-2157457864f6
2024-05-22 06:02:34,911 [pool-126-thread-1] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:getNextId(145)) - Allocate a batch for containerId, change lastId from 0 to 1000.
2024-05-22 06:02:34,912 [pool-126-thread-1] WARN  ha.SequenceIdGenerator (SequenceIdGenerator.java:allocateBatch(258)) - Failed to allocate a batch for localId, expected lastId is 0, actual lastId is 113750153625600000.
2024-05-22 06:02:34,918 [pool-126-thread-1] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:getNextId(145)) - Allocate a batch for localId, change lastId from 113750153625600000 to 113750153625601000.
2024-05-22 06:02:34,923 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1653)) - Container Balancer is not running.
2024-05-22 06:02:34,923 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stopReplicationManager(1786)) - Stopping Replication Manager Service.
2024-05-22 06:02:34,923 [main] INFO  replication.ReplicationManager (ReplicationManager.java:stop(329)) - Stopping Replication Monitor Thread.
2024-05-22 06:02:34,924 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1662)) - Stopping the Datanode Admin Monitor.
2024-05-22 06:02:34,924 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1669)) - Stopping datanode service RPC server
2024-05-22 06:02:34,924 [main] INFO  server.SCMDatanodeProtocolServer (SCMDatanodeProtocolServer.java:stop(425)) - Stopping the RPC server for DataNodes
2024-05-22 06:02:34,924 [main] INFO  ipc.Server (Server.java:stop(3523)) - Stopping server on 45693
2024-05-22 06:02:34,924 [ReplicationMonitor] INFO  replication.ReplicationManager (ReplicationManager.java:run(938)) - Replication Monitor Thread is stopped
2024-05-22 06:02:34,924 [OverReplicatedProcessor] WARN  replication.UnhealthyReplicationProcessor (UnhealthyReplicationProcessor.java:run(180)) - OverReplicatedProcessor interrupted. Exiting...
2024-05-22 06:02:34,924 [UnderReplicatedProcessor] WARN  replication.UnhealthyReplicationProcessor (UnhealthyReplicationProcessor.java:run(180)) - UnderReplicatedProcessor interrupted. Exiting...
2024-05-22 06:02:34,925 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1677)) - Stopping block service RPC server
2024-05-22 06:02:34,925 [main] INFO  server.SCMBlockProtocolServer (SCMBlockProtocolServer.java:stop(171)) - Stopping the RPC server for Block Protocol
2024-05-22 06:02:34,926 [main] INFO  ipc.Server (Server.java:stop(3523)) - Stopping server on 34529
2024-05-22 06:02:34,926 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1684)) - Stopping the StorageContainerLocationProtocol RPC server
2024-05-22 06:02:34,926 [main] INFO  server.SCMClientProtocolServer (SCMClientProtocolServer.java:stop(213)) - Stopping the RPC server for Client Protocol
2024-05-22 06:02:34,926 [main] INFO  ipc.Server (Server.java:stop(3523)) - Stopping server on 37001
2024-05-22 06:02:34,926 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1691)) - Stopping Storage Container Manager HTTP server.
2024-05-22 06:02:34,927 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1699)) - Stopping SCM LayoutVersionManager Service.
2024-05-22 06:02:34,927 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1711)) - Stopping Block Manager Service.
2024-05-22 06:02:34,927 [main] INFO  utils.BackgroundService (BackgroundService.java:shutdown(160)) - Shutting down service SCMBlockDeletingService
2024-05-22 06:02:34,927 [main] INFO  utils.BackgroundService (BackgroundService.java:shutdown(160)) - Shutting down service SCMBlockDeletingService
2024-05-22 06:02:34,927 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1731)) - Stopping SCM Event Queue.
2024-05-22 06:02:34,928 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1742)) - Stopping SCM HA services.
2024-05-22 06:02:34,928 [main] INFO  pipeline.BackgroundPipelineCreator (BackgroundPipelineCreator.java:stop(152)) - Stopping RatisPipelineUtilsThread.
2024-05-22 06:02:34,928 [RatisPipelineUtilsThread-0] WARN  pipeline.BackgroundPipelineCreator (BackgroundPipelineCreator.java:run(183)) - RatisPipelineUtilsThread is interrupted.
2024-05-22 06:02:34,928 [BackgroundPipelineScrubber] WARN  BackgroundPipelineScrubber (BackgroundSCMService.java:run(112)) - BackgroundPipelineScrubber is interrupted, exit
2024-05-22 06:02:34,928 [main] INFO  BackgroundPipelineScrubber (BackgroundSCMService.java:stop(128)) - Stopping BackgroundPipelineScrubber Service.
2024-05-22 06:02:34,928 [main] INFO  ExpiredContainerReplicaOpScrubber (BackgroundSCMService.java:stop(128)) - Stopping ExpiredContainerReplicaOpScrubber Service.
2024-05-22 06:02:34,929 [ExpiredContainerReplicaOpScrubber] WARN  ExpiredContainerReplicaOpScrubber (BackgroundSCMService.java:run(112)) - ExpiredContainerReplicaOpScrubber is interrupted, exit
2024-05-22 06:02:34,929 [main] INFO  utils.BackgroundService (BackgroundService.java:shutdown(160)) - Shutting down service SCMBlockDeletingService
2024-05-22 06:02:34,929 [main] INFO  replication.ReplicationManager (ReplicationManager.java:stop(339)) - Replication Monitor Thread is not running.
2024-05-22 06:02:34,929 [main] WARN  balancer.ContainerBalancer (ContainerBalancer.java:stop(327)) - Cannot stop Container Balancer because it's not running or stopping
2024-05-22 06:02:34,929 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1777)) - Stopping SCM MetadataStore.
2024-05-22 06:02:34,950 [main] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchemaFromFile(129)) - Loading schema from [file:/home/runner/work/ozone/ozone/hadoop-hdds/common/target/classes/network-topology-default.xml]
2024-05-22 06:02:34,950 [main] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchema(176)) - Loading network topology layer schema file
2024-05-22 06:02:34,961 [main] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchemaFromFile(129)) - Loading schema from [file:/home/runner/work/ozone/ozone/hadoop-hdds/common/target/classes/network-topology-default.xml]
2024-05-22 06:02:34,961 [main] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchema(176)) - Loading network topology layer schema file
2024-05-22 06:02:34,963 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(134)) - Added a new node: /default-rack/e09a5939-406d-4a71-8870-020bbc76c4ca
2024-05-22 06:02:34,963 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(134)) - Added a new node: /default-rack/89c6172f-81aa-4db6-9ef4-75d3159f12c3
2024-05-22 06:02:34,963 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(134)) - Added a new node: /default-rack/f03bd42d-1382-4266-a142-c143bac8ebd0
2024-05-22 06:02:34,963 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(134)) - Added a new node: /default-rack/475d47ac-101b-42fc-90b5-6d7ff2264bd5
2024-05-22 06:02:34,964 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(134)) - Added a new node: /default-rack/e708a8f4-a439-4ba3-80d3-3ca1cfd8456b
2024-05-22 06:02:34,964 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(134)) - Added a new node: /default-rack/788f1060-f744-4e9b-abed-6b3261dc4b91
2024-05-22 06:02:34,964 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(134)) - Added a new node: /default-rack/c3d1e262-4d65-486f-ae4d-3d67a39f19f1
2024-05-22 06:02:34,964 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(134)) - Added a new node: /default-rack/1220f9fe-9293-42ea-9cd5-481d84efef1d
2024-05-22 06:02:34,965 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(134)) - Added a new node: /default-rack/93a006f7-c87c-48af-818e-672611cef8cd
2024-05-22 06:02:34,965 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(134)) - Added a new node: /default-rack/4b6665d3-eee6-4cdf-a073-4c8143a7f233
2024-05-22 06:02:34,965 [main] WARN  utils.HAUtils (HAUtils.java:getMetaDir(339)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2024-05-22 06:02:34,966 [main] WARN  db.DBStoreBuilder (DBStoreBuilder.java:applyDBDefinition(171)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2024-05-22 06:02:35,029 [main] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:<init>(241)) - Init the HA SequenceIdGenerator.
2024-05-22 06:02:35,030 [main] INFO  pipeline.PipelineStateManagerImpl (PipelineStateManagerImpl.java:initialize(78)) - No pipeline exists in current db
2024-05-22 06:02:35,030 [main] INFO  algorithms.LeaderChoosePolicyFactory (LeaderChoosePolicyFactory.java:getPolicy(57)) - Create leader choose policy of type org.apache.hadoop.hdds.scm.pipeline.leader.choose.algorithms.MinLeaderCountChoosePolicy
2024-05-22 06:02:35,030 [main] INFO  algorithms.ContainerPlacementPolicyFactory (ContainerPlacementPolicyFactory.java:getPolicyInternal(86)) - Create container placement policy of type org.apache.hadoop.hdds.scm.container.placement.algorithms.SCMContainerPlacementRackScatter
2024-05-22 06:02:35,031 [main] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service BackgroundPipelineCreator.
2024-05-22 06:02:35,031 [main] INFO  pipeline.BackgroundPipelineCreator (BackgroundPipelineCreator.java:start(127)) - Starting RatisPipelineUtilsThread.
2024-05-22 06:02:35,032 [main] INFO  BackgroundPipelineScrubber (BackgroundSCMService.java:start(65)) - Starting BackgroundPipelineScrubber Service.
2024-05-22 06:02:35,033 [main] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service BackgroundPipelineScrubber.
2024-05-22 06:02:35,033 [main] INFO  algorithms.LeaderChoosePolicyFactory (LeaderChoosePolicyFactory.java:getPolicy(57)) - Create leader choose policy of type org.apache.hadoop.hdds.scm.pipeline.leader.choose.algorithms.MinLeaderCountChoosePolicy
2024-05-22 06:02:35,034 [main] INFO  safemode.ContainerSafeModeRule (ContainerSafeModeRule.java:<init>(91)) - containers with one replica threshold count 0
2024-05-22 06:02:35,034 [main] INFO  safemode.HealthyPipelineSafeModeRule (HealthyPipelineSafeModeRule.java:initializeRule(176)) - Total pipeline count is 0, healthy pipeline threshold count is 0
2024-05-22 06:02:35,035 [main] INFO  safemode.OneReplicaPipelineSafeModeRule (OneReplicaPipelineSafeModeRule.java:initializeRule(193)) - Total pipeline count is 0, pipeline's with at least one datanode reported threshold count is 0
2024-05-22 06:02:35,035 [main] WARN  server.ServerUtils (ServerUtils.java:getScmDbDir(143)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2024-05-22 06:02:35,036 [main] WARN  server.ServerUtils (ServerUtils.java:getScmDbDir(143)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2024-05-22 06:02:35,037 [main] INFO  ha.SCMHANodeDetails (SCMHANodeDetails.java:loadSCMHAConfig(207)) - ServiceID for StorageContainerManager is null
2024-05-22 06:02:35,037 [main] INFO  ha.SCMHANodeDetails (SCMHANodeDetails.java:loadSCMHAConfig(212)) - ozone.scm.default.service.id is not defined, falling back to ozone.scm.service.ids to find serviceID for StorageContainerManager if it is HA enabled cluster
2024-05-22 06:02:35,038 [main] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchemaFromFile(129)) - Loading schema from [file:/home/runner/work/ozone/ozone/hadoop-hdds/common/target/classes/network-topology-default.xml]
2024-05-22 06:02:35,038 [main] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchema(176)) - Loading network topology layer schema file
2024-05-22 06:02:35,040 [main] INFO  upgrade.AbstractLayoutVersionManager (AbstractLayoutVersionManager.java:init(83)) - Initializing Layout version manager with metadata layout = HADOOP_PRC_PORTS_IN_DATANODEDETAILS (version = 7), software layout = HADOOP_PRC_PORTS_IN_DATANODEDETAILS (version = 7)
2024-05-22 06:02:35,042 [main] ERROR util.ResourceLeakDetector (ResourceLeakDetector.java:reportTracedLeak(337)) - LEAK: ByteBuf.release() was not called before it's garbage-collected. See https://netty.io/wiki/reference-counted-objects.html for more information.
Recent access records: 
Created at:
	org.apache.ratis.thirdparty.io.netty.buffer.PooledByteBufAllocator.newDirectBuffer(PooledByteBufAllocator.java:402)
	org.apache.ratis.thirdparty.io.netty.buffer.AbstractByteBufAllocator.directBuffer(AbstractByteBufAllocator.java:188)
	org.apache.hadoop.hdds.utils.db.CodecBuffer.lambda$static$0(CodecBuffer.java:130)
	org.apache.hadoop.hdds.utils.db.CodecBuffer.allocate(CodecBuffer.java:196)
	org.apache.hadoop.hdds.utils.db.CodecBuffer$Allocator$1.apply(CodecBuffer.java:148)
	org.apache.hadoop.hdds.utils.db.CodecBuffer$Allocator$1.apply(CodecBuffer.java:145)
	org.apache.hadoop.hdds.utils.db.StringCodecBase.toCodecBuffer(StringCodecBase.java:173)
	org.apache.hadoop.hdds.utils.db.StringCodec.toCodecBuffer(StringCodec.java:28)
	org.apache.hadoop.hdds.utils.db.StringCodecBase.toCodecBuffer(StringCodecBase.java:42)
	org.apache.hadoop.hdds.utils.db.Codec.toDirectCodecBuffer(Codec.java:65)
	org.apache.hadoop.hdds.utils.db.TypedTable.putWithBatch(TypedTable.java:172)
	org.apache.hadoop.hdds.scm.ha.SCMHADBTransactionBufferStub.addToBuffer(SCMHADBTransactionBufferStub.java:62)
	org.apache.hadoop.hdds.scm.ha.SequenceIdGenerator$StateManagerImpl.allocateBatch(SequenceIdGenerator.java:265)
	java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	java.base/java.lang.reflect.Method.invoke(Method.java:568)
	org.apache.hadoop.hdds.scm.ha.SCMHAManagerStub$RatisServerStub.process(SCMHAManagerStub.java:229)
	org.apache.hadoop.hdds.scm.ha.SCMHAManagerStub$RatisServerStub.submitRequest(SCMHAManagerStub.java:191)
	org.apache.hadoop.hdds.scm.ha.SCMHAInvocationHandler.invokeRatisServer(SCMHAInvocationHandler.java:123)
	org.apache.hadoop.hdds.scm.ha.SCMHAInvocationHandler.invokeRatis(SCMHAInvocationHandler.java:112)
	org.apache.hadoop.hdds.scm.ha.SCMHAInvocationHandler.invoke(SCMHAInvocationHandler.java:74)
	org.apache.hadoop.hdds.scm.ha.$Proxy35.allocateBatch(Unknown Source)
	org.apache.hadoop.hdds.scm.ha.SequenceIdGenerator.getNextId(SequenceIdGenerator.java:142)
	org.apache.hadoop.hdds.scm.block.BlockManagerImpl.newBlock(BlockManagerImpl.java:188)
	org.apache.hadoop.hdds.scm.block.BlockManagerImpl.allocateBlock(BlockManagerImpl.java:167)
	org.apache.hadoop.hdds.scm.block.TestBlockManager.testAllocateBlockWithExclusion(TestBlockManager.java:232)
	java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	java.base/java.lang.reflect.Method.invoke(Method.java:568)
	org.junit.platform.commons.util.ReflectionUtils.invokeMethod(ReflectionUtils.java:728)
	org.junit.jupiter.engine.execution.MethodInvocation.proceed(MethodInvocation.java:60)
	org.junit.jupiter.engine.execution.InvocationInterceptorChain$ValidatingInvocation.proceed(InvocationInterceptorChain.java:131)
	org.junit.jupiter.engine.extension.TimeoutExtension.intercept(TimeoutExtension.java:156)
	org.junit.jupiter.engine.extension.TimeoutExtension.interceptTestableMethod(TimeoutExtension.java:147)
	org.junit.jupiter.engine.extension.TimeoutExtension.interceptTestMethod(TimeoutExtension.java:86)
	org.junit.jupiter.engine.execution.InterceptingExecutableInvoker$ReflectiveInterceptorCall.lambda$ofVoidMethod$0(InterceptingExecutableInvoker.java:103)
	org.junit.jupiter.engine.execution.InterceptingExecutableInvoker.lambda$invoke$0(InterceptingExecutableInvoker.java:93)
	org.junit.jupiter.engine.execution.InvocationInterceptorChain$InterceptedInvocation.proceed(InvocationInterceptorChain.java:106)
	org.junit.jupiter.engine.execution.InvocationInterceptorChain.proceed(InvocationInterceptorChain.java:64)
	org.junit.jupiter.engine.execution.InvocationInterceptorChain.chainAndInvoke(InvocationInterceptorChain.java:45)
	org.junit.jupiter.engine.execution.InvocationInterceptorChain.invoke(InvocationInterceptorChain.java:37)
	org.junit.jupiter.engine.execution.InterceptingExecutableInvoker.invoke(InterceptingExecutableInvoker.java:92)
	org.junit.jupiter.engine.execution.InterceptingExecutableInvoker.invoke(InterceptingExecutableInvoker.java:86)
	org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.lambda$invokeTestMethod$7(TestMethodTestDescriptor.java:218)
	org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.invokeTestMethod(TestMethodTestDescriptor.java:214)
	org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.execute(TestMethodTestDescriptor.java:139)
	org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.execute(TestMethodTestDescriptor.java:69)
	org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:151)
	org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:141)
	org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:139)
	org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:138)
	org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:95)
	java.base/java.util.ArrayList.forEach(ArrayList.java:1511)
	org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:41)
	org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:155)
	org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:141)
	org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:139)
	org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:138)
	org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:95)
	java.base/java.util.ArrayList.forEach(ArrayList.java:1511)
	org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:41)
	org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:155)
	org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:141)
	org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:139)
	org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:138)
	org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:95)
	org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.submit(SameThreadHierarchicalTestExecutorService.java:35)
	org.junit.platform.engine.support.hierarchical.HierarchicalTestExecutor.execute(HierarchicalTestExecutor.java:57)
	org.junit.platform.engine.support.hierarchical.HierarchicalTestEngine.execute(HierarchicalTestEngine.java:54)
	org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:198)
	org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:169)
	org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:93)
	org.junit.platform.launcher.core.EngineExecutionOrchestrator.lambda$execute$0(EngineExecutionOrchestrator.java:58)
	org.junit.platform.launcher.core.EngineExecutionOrchestrator.withInterceptedStreams(EngineExecutionOrchestrator.java:141)
	org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:57)
	org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:103)
	org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:85)
	org.junit.platform.launcher.core.DelegatingLauncher.execute(DelegatingLauncher.java:47)
	org.junit.platform.launcher.core.SessionPerRequestLauncher.execute(SessionPerRequestLauncher.java:63)
	org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154)
	org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123)
	org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377)
	org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138)
	org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465)
	org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451)
2024-05-22 06:02:35,043 [main] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:upgradeToSequenceId(370)) - upgrade localId to 113750153625600000
2024-05-22 06:02:35,043 [main] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:upgradeToSequenceId(380)) - upgrade delTxnId to 0
2024-05-22 06:02:35,044 [main] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:upgradeToSequenceId(397)) - upgrade containerId to 0
2024-05-22 06:02:35,044 [main] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:upgradeToCertificateSequenceId(444)) - upgrade CertificateId to 2
2024-05-22 06:02:35,045 [main] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:<init>(241)) - Init the HA SequenceIdGenerator.
2024-05-22 06:02:35,045 [main] INFO  algorithms.ContainerPlacementPolicyFactory (ContainerPlacementPolicyFactory.java:getPolicyInternal(86)) - Create container placement policy of type org.apache.hadoop.hdds.scm.container.placement.algorithms.SCMContainerPlacementRackAware
2024-05-22 06:02:35,045 [main] INFO  algorithms.ContainerPlacementPolicyFactory (ContainerPlacementPolicyFactory.java:getPolicyInternal(86)) - Create container placement policy of type org.apache.hadoop.hdds.scm.container.placement.algorithms.SCMContainerPlacementRackScatter
2024-05-22 06:02:35,045 [main] INFO  ExpiredContainerReplicaOpScrubber (BackgroundSCMService.java:start(65)) - Starting ExpiredContainerReplicaOpScrubber Service.
2024-05-22 06:02:35,049 [main] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service ExpiredContainerReplicaOpScrubber.
2024-05-22 06:02:35,049 [main] INFO  algorithms.PipelineChoosePolicyFactory (PipelineChoosePolicyFactory.java:createPipelineChoosePolicyFromClass(80)) - Create pipeline choose policy of type org.apache.hadoop.hdds.scm.pipeline.choose.algorithms.RandomPipelineChoosePolicy
2024-05-22 06:02:35,049 [main] INFO  algorithms.PipelineChoosePolicyFactory (PipelineChoosePolicyFactory.java:createPipelineChoosePolicyFromClass(80)) - Create pipeline choose policy of type org.apache.hadoop.hdds.scm.pipeline.choose.algorithms.RandomPipelineChoosePolicy
2024-05-22 06:02:35,050 [main] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service SCMBlockDeletingService.
2024-05-22 06:02:35,051 [main] INFO  replication.ReplicationManager (ReplicationManager.java:start(296)) - Starting Replication Monitor Thread.
2024-05-22 06:02:35,052 [ReplicationMonitor] INFO  replication.ReplicationManager (ReplicationManager.java:processAll(373)) - Replication Manager is not ready to run until 300000ms after safemode exit
2024-05-22 06:02:35,052 [main] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service ReplicationManager.
2024-05-22 06:02:35,053 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:<init>(440)) - SCM start with adminUsers: [runner]
2024-05-22 06:02:35,053 [main] INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(90)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 10000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false.
2024-05-22 06:02:35,053 [main] INFO  ipc.Server (Server.java:<init>(1287)) - Listener at 0.0.0.0:46663
2024-05-22 06:02:35,054 [Socket Reader #1 for port 0] INFO  ipc.Server (Server.java:run(1323)) - Starting Socket Reader #1 for port 0
2024-05-22 06:02:35,058 [main] INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(90)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 10000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false.
2024-05-22 06:02:35,059 [main] INFO  ipc.Server (Server.java:<init>(1287)) - Listener at 0.0.0.0:44507
2024-05-22 06:02:35,059 [Socket Reader #1 for port 0] INFO  ipc.Server (Server.java:run(1323)) - Starting Socket Reader #1 for port 0
2024-05-22 06:02:35,060 [main] INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(90)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 10000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false.
2024-05-22 06:02:35,060 [main] INFO  ipc.Server (Server.java:<init>(1287)) - Listener at 0.0.0.0:46767
2024-05-22 06:02:35,060 [Socket Reader #1 for port 0] INFO  ipc.Server (Server.java:run(1323)) - Starting Socket Reader #1 for port 0
2024-05-22 06:02:35,064 [main] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service ContainerBalancer.
2024-05-22 06:02:35,065 [main] INFO  ha.SCMContext (SCMContext.java:updateSafeModeStatus(225)) - Update SafeModeStatus from SafeModeStatus{safeModeStatus=false, preCheckPassed=true} to SafeModeStatus{safeModeStatus=false, preCheckPassed=true}.
2024-05-22 06:02:35,070 [pool-166-thread-1] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(205)) - Sending CreatePipelineCommand for pipeline:PipelineID=c1b41811-7baf-49b7-a00e-9653b14d8b6b to datanode:788f1060-f744-4e9b-abed-6b3261dc4b91
2024-05-22 06:02:35,070 [pool-166-thread-1] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(205)) - Sending CreatePipelineCommand for pipeline:PipelineID=c1b41811-7baf-49b7-a00e-9653b14d8b6b to datanode:e09a5939-406d-4a71-8870-020bbc76c4ca
2024-05-22 06:02:35,070 [pool-166-thread-1] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(205)) - Sending CreatePipelineCommand for pipeline:PipelineID=c1b41811-7baf-49b7-a00e-9653b14d8b6b to datanode:c3d1e262-4d65-486f-ae4d-3d67a39f19f1
2024-05-22 06:02:35,073 [pool-167-thread-1] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(205)) - Sending CreatePipelineCommand for pipeline:PipelineID=028f2caa-5cec-4a79-aa8e-b80e8837c63e to datanode:e09a5939-406d-4a71-8870-020bbc76c4ca
2024-05-22 06:02:35,073 [pool-167-thread-1] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(205)) - Sending CreatePipelineCommand for pipeline:PipelineID=028f2caa-5cec-4a79-aa8e-b80e8837c63e to datanode:89c6172f-81aa-4db6-9ef4-75d3159f12c3
2024-05-22 06:02:35,074 [pool-167-thread-1] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(205)) - Sending CreatePipelineCommand for pipeline:PipelineID=028f2caa-5cec-4a79-aa8e-b80e8837c63e to datanode:f03bd42d-1382-4266-a142-c143bac8ebd0
2024-05-22 06:02:35,077 [pool-179-thread-1] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:getNextId(145)) - Allocate a batch for containerId, change lastId from 0 to 1000.
2024-05-22 06:02:35,078 [pool-179-thread-1] WARN  ha.SequenceIdGenerator (SequenceIdGenerator.java:allocateBatch(258)) - Failed to allocate a batch for localId, expected lastId is 0, actual lastId is 113750153625600000.
2024-05-22 06:02:35,078 [pool-179-thread-1] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:getNextId(145)) - Allocate a batch for localId, change lastId from 113750153625600000 to 113750153625601000.
2024-05-22 06:02:35,175 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1653)) - Container Balancer is not running.
2024-05-22 06:02:35,175 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stopReplicationManager(1786)) - Stopping Replication Manager Service.
2024-05-22 06:02:35,175 [main] INFO  replication.ReplicationManager (ReplicationManager.java:stop(329)) - Stopping Replication Monitor Thread.
2024-05-22 06:02:35,176 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1662)) - Stopping the Datanode Admin Monitor.
2024-05-22 06:02:35,176 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1669)) - Stopping datanode service RPC server
2024-05-22 06:02:35,176 [main] INFO  server.SCMDatanodeProtocolServer (SCMDatanodeProtocolServer.java:stop(425)) - Stopping the RPC server for DataNodes
2024-05-22 06:02:35,176 [main] INFO  ipc.Server (Server.java:stop(3523)) - Stopping server on 46663
2024-05-22 06:02:35,176 [ReplicationMonitor] INFO  replication.ReplicationManager (ReplicationManager.java:run(938)) - Replication Monitor Thread is stopped
2024-05-22 06:02:35,177 [OverReplicatedProcessor] WARN  replication.UnhealthyReplicationProcessor (UnhealthyReplicationProcessor.java:run(180)) - OverReplicatedProcessor interrupted. Exiting...
2024-05-22 06:02:35,177 [UnderReplicatedProcessor] WARN  replication.UnhealthyReplicationProcessor (UnhealthyReplicationProcessor.java:run(180)) - UnderReplicatedProcessor interrupted. Exiting...
2024-05-22 06:02:35,177 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1677)) - Stopping block service RPC server
2024-05-22 06:02:35,177 [main] INFO  server.SCMBlockProtocolServer (SCMBlockProtocolServer.java:stop(171)) - Stopping the RPC server for Block Protocol
2024-05-22 06:02:35,177 [main] INFO  ipc.Server (Server.java:stop(3523)) - Stopping server on 44507
2024-05-22 06:02:35,178 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1684)) - Stopping the StorageContainerLocationProtocol RPC server
2024-05-22 06:02:35,178 [main] INFO  server.SCMClientProtocolServer (SCMClientProtocolServer.java:stop(213)) - Stopping the RPC server for Client Protocol
2024-05-22 06:02:35,178 [main] INFO  ipc.Server (Server.java:stop(3523)) - Stopping server on 46767
2024-05-22 06:02:35,178 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1691)) - Stopping Storage Container Manager HTTP server.
2024-05-22 06:02:35,178 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1699)) - Stopping SCM LayoutVersionManager Service.
2024-05-22 06:02:35,179 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1711)) - Stopping Block Manager Service.
2024-05-22 06:02:35,179 [main] INFO  utils.BackgroundService (BackgroundService.java:shutdown(160)) - Shutting down service SCMBlockDeletingService
2024-05-22 06:02:35,179 [main] INFO  utils.BackgroundService (BackgroundService.java:shutdown(160)) - Shutting down service SCMBlockDeletingService
2024-05-22 06:02:35,179 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1731)) - Stopping SCM Event Queue.
2024-05-22 06:02:35,179 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1742)) - Stopping SCM HA services.
2024-05-22 06:02:35,179 [main] INFO  pipeline.BackgroundPipelineCreator (BackgroundPipelineCreator.java:stop(152)) - Stopping RatisPipelineUtilsThread.
2024-05-22 06:02:35,180 [RatisPipelineUtilsThread-0] WARN  pipeline.BackgroundPipelineCreator (BackgroundPipelineCreator.java:run(183)) - RatisPipelineUtilsThread is interrupted.
2024-05-22 06:02:35,180 [main] INFO  BackgroundPipelineScrubber (BackgroundSCMService.java:stop(128)) - Stopping BackgroundPipelineScrubber Service.
2024-05-22 06:02:35,180 [BackgroundPipelineScrubber] WARN  BackgroundPipelineScrubber (BackgroundSCMService.java:run(112)) - BackgroundPipelineScrubber is interrupted, exit
2024-05-22 06:02:35,180 [ExpiredContainerReplicaOpScrubber] WARN  ExpiredContainerReplicaOpScrubber (BackgroundSCMService.java:run(112)) - ExpiredContainerReplicaOpScrubber is interrupted, exit
2024-05-22 06:02:35,180 [main] INFO  ExpiredContainerReplicaOpScrubber (BackgroundSCMService.java:stop(128)) - Stopping ExpiredContainerReplicaOpScrubber Service.
2024-05-22 06:02:35,181 [main] INFO  utils.BackgroundService (BackgroundService.java:shutdown(160)) - Shutting down service SCMBlockDeletingService
2024-05-22 06:02:35,181 [main] INFO  replication.ReplicationManager (ReplicationManager.java:stop(339)) - Replication Monitor Thread is not running.
2024-05-22 06:02:35,181 [main] WARN  balancer.ContainerBalancer (ContainerBalancer.java:stop(327)) - Cannot stop Container Balancer because it's not running or stopping
2024-05-22 06:02:35,181 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1777)) - Stopping SCM MetadataStore.
2024-05-22 06:02:35,181 [test-leaseManagerLeaseManager#LeaseMonitor] WARN  lease.LeaseManager (LeaseManager.java:run(287)) - Lease manager is interrupted. Shutting down...
java.lang.InterruptedException
	at java.base/java.util.concurrent.locks.AbstractQueuedSynchronizer.tryAcquireSharedNanos(AbstractQueuedSynchronizer.java:1081)
	at java.base/java.util.concurrent.Semaphore.tryAcquire(Semaphore.java:415)
	at org.apache.hadoop.ozone.lease.LeaseManager$LeaseMonitor.run(LeaseManager.java:285)
	at java.base/java.lang.Thread.run(Thread.java:840)
2024-05-22 06:02:35,205 [main] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchemaFromFile(129)) - Loading schema from [file:/home/runner/work/ozone/ozone/hadoop-hdds/common/target/classes/network-topology-default.xml]
2024-05-22 06:02:35,205 [main] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchema(176)) - Loading network topology layer schema file
2024-05-22 06:02:35,216 [main] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchemaFromFile(129)) - Loading schema from [file:/home/runner/work/ozone/ozone/hadoop-hdds/common/target/classes/network-topology-default.xml]
2024-05-22 06:02:35,217 [main] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchema(176)) - Loading network topology layer schema file
2024-05-22 06:02:35,218 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(134)) - Added a new node: /default-rack/93c5d343-b5df-41b2-a5d7-c3b18021e46a
2024-05-22 06:02:35,218 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(134)) - Added a new node: /default-rack/9b04fbb9-889e-4520-a1ab-7af87d50d7cd
2024-05-22 06:02:35,219 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(134)) - Added a new node: /default-rack/d5e9adec-cbdb-4c49-b8e9-0d7fb95baf1b
2024-05-22 06:02:35,219 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(134)) - Added a new node: /default-rack/c9495569-b479-4353-8ed7-61a45e29afe3
2024-05-22 06:02:35,219 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(134)) - Added a new node: /default-rack/9d498420-bfa1-4d57-b15c-200b15011458
2024-05-22 06:02:35,219 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(134)) - Added a new node: /default-rack/0fb943b2-0692-485f-bb27-fa18dfc7ebb1
2024-05-22 06:02:35,219 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(134)) - Added a new node: /default-rack/c8c967c5-691e-4287-b78e-954455ddb2f8
2024-05-22 06:02:35,220 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(134)) - Added a new node: /default-rack/d1cb8303-cd22-4f05-885c-46345131f745
2024-05-22 06:02:35,220 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(134)) - Added a new node: /default-rack/d83e33bc-f2f2-4355-a221-96de889bcd39
2024-05-22 06:02:35,220 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(134)) - Added a new node: /default-rack/2d0608f1-de25-4466-8be1-a9aa51068063
2024-05-22 06:02:35,220 [main] WARN  utils.HAUtils (HAUtils.java:getMetaDir(339)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2024-05-22 06:02:35,221 [main] WARN  db.DBStoreBuilder (DBStoreBuilder.java:applyDBDefinition(171)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2024-05-22 06:02:35,286 [main] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:<init>(241)) - Init the HA SequenceIdGenerator.
2024-05-22 06:02:35,286 [main] INFO  pipeline.PipelineStateManagerImpl (PipelineStateManagerImpl.java:initialize(78)) - No pipeline exists in current db
2024-05-22 06:02:35,286 [main] INFO  algorithms.LeaderChoosePolicyFactory (LeaderChoosePolicyFactory.java:getPolicy(57)) - Create leader choose policy of type org.apache.hadoop.hdds.scm.pipeline.leader.choose.algorithms.MinLeaderCountChoosePolicy
2024-05-22 06:02:35,286 [main] INFO  algorithms.ContainerPlacementPolicyFactory (ContainerPlacementPolicyFactory.java:getPolicyInternal(86)) - Create container placement policy of type org.apache.hadoop.hdds.scm.container.placement.algorithms.SCMContainerPlacementRackScatter
2024-05-22 06:02:35,287 [main] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service BackgroundPipelineCreator.
2024-05-22 06:02:35,287 [main] INFO  pipeline.BackgroundPipelineCreator (BackgroundPipelineCreator.java:start(127)) - Starting RatisPipelineUtilsThread.
2024-05-22 06:02:35,287 [main] INFO  BackgroundPipelineScrubber (BackgroundSCMService.java:start(65)) - Starting BackgroundPipelineScrubber Service.
2024-05-22 06:02:35,287 [main] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service BackgroundPipelineScrubber.
2024-05-22 06:02:35,288 [main] INFO  algorithms.LeaderChoosePolicyFactory (LeaderChoosePolicyFactory.java:getPolicy(57)) - Create leader choose policy of type org.apache.hadoop.hdds.scm.pipeline.leader.choose.algorithms.MinLeaderCountChoosePolicy
2024-05-22 06:02:35,289 [main] INFO  safemode.ContainerSafeModeRule (ContainerSafeModeRule.java:<init>(91)) - containers with one replica threshold count 0
2024-05-22 06:02:35,289 [main] INFO  safemode.HealthyPipelineSafeModeRule (HealthyPipelineSafeModeRule.java:initializeRule(176)) - Total pipeline count is 0, healthy pipeline threshold count is 0
2024-05-22 06:02:35,289 [main] INFO  safemode.OneReplicaPipelineSafeModeRule (OneReplicaPipelineSafeModeRule.java:initializeRule(193)) - Total pipeline count is 0, pipeline's with at least one datanode reported threshold count is 0
2024-05-22 06:02:35,290 [main] WARN  server.ServerUtils (ServerUtils.java:getScmDbDir(143)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2024-05-22 06:02:35,291 [main] WARN  server.ServerUtils (ServerUtils.java:getScmDbDir(143)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2024-05-22 06:02:35,291 [main] INFO  ha.SCMHANodeDetails (SCMHANodeDetails.java:loadSCMHAConfig(207)) - ServiceID for StorageContainerManager is null
2024-05-22 06:02:35,291 [main] INFO  ha.SCMHANodeDetails (SCMHANodeDetails.java:loadSCMHAConfig(212)) - ozone.scm.default.service.id is not defined, falling back to ozone.scm.service.ids to find serviceID for StorageContainerManager if it is HA enabled cluster
2024-05-22 06:02:35,292 [main] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchemaFromFile(129)) - Loading schema from [file:/home/runner/work/ozone/ozone/hadoop-hdds/common/target/classes/network-topology-default.xml]
2024-05-22 06:02:35,292 [main] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchema(176)) - Loading network topology layer schema file
2024-05-22 06:02:35,294 [main] INFO  upgrade.AbstractLayoutVersionManager (AbstractLayoutVersionManager.java:init(83)) - Initializing Layout version manager with metadata layout = HADOOP_PRC_PORTS_IN_DATANODEDETAILS (version = 7), software layout = HADOOP_PRC_PORTS_IN_DATANODEDETAILS (version = 7)
2024-05-22 06:02:35,295 [main] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:upgradeToSequenceId(370)) - upgrade localId to 113750153625600000
2024-05-22 06:02:35,295 [main] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:upgradeToSequenceId(380)) - upgrade delTxnId to 0
2024-05-22 06:02:35,296 [main] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:upgradeToSequenceId(397)) - upgrade containerId to 0
2024-05-22 06:02:35,296 [main] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:upgradeToCertificateSequenceId(444)) - upgrade CertificateId to 2
2024-05-22 06:02:35,297 [main] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:<init>(241)) - Init the HA SequenceIdGenerator.
2024-05-22 06:02:35,297 [main] INFO  algorithms.ContainerPlacementPolicyFactory (ContainerPlacementPolicyFactory.java:getPolicyInternal(86)) - Create container placement policy of type org.apache.hadoop.hdds.scm.container.placement.algorithms.SCMContainerPlacementRackAware
2024-05-22 06:02:35,297 [main] INFO  algorithms.ContainerPlacementPolicyFactory (ContainerPlacementPolicyFactory.java:getPolicyInternal(86)) - Create container placement policy of type org.apache.hadoop.hdds.scm.container.placement.algorithms.SCMContainerPlacementRackScatter
2024-05-22 06:02:35,297 [main] INFO  ExpiredContainerReplicaOpScrubber (BackgroundSCMService.java:start(65)) - Starting ExpiredContainerReplicaOpScrubber Service.
2024-05-22 06:02:35,297 [main] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service ExpiredContainerReplicaOpScrubber.
2024-05-22 06:02:35,298 [main] INFO  algorithms.PipelineChoosePolicyFactory (PipelineChoosePolicyFactory.java:createPipelineChoosePolicyFromClass(80)) - Create pipeline choose policy of type org.apache.hadoop.hdds.scm.pipeline.choose.algorithms.RandomPipelineChoosePolicy
2024-05-22 06:02:35,298 [main] INFO  algorithms.PipelineChoosePolicyFactory (PipelineChoosePolicyFactory.java:createPipelineChoosePolicyFromClass(80)) - Create pipeline choose policy of type org.apache.hadoop.hdds.scm.pipeline.choose.algorithms.RandomPipelineChoosePolicy
2024-05-22 06:02:35,299 [main] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service SCMBlockDeletingService.
2024-05-22 06:02:35,300 [main] INFO  replication.ReplicationManager (ReplicationManager.java:start(296)) - Starting Replication Monitor Thread.
2024-05-22 06:02:35,301 [main] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service ReplicationManager.
2024-05-22 06:02:35,301 [ReplicationMonitor] INFO  replication.ReplicationManager (ReplicationManager.java:processAll(373)) - Replication Manager is not ready to run until 300000ms after safemode exit
2024-05-22 06:02:35,302 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:<init>(440)) - SCM start with adminUsers: [runner]
2024-05-22 06:02:35,303 [main] INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(90)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 10000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false.
2024-05-22 06:02:35,303 [main] INFO  ipc.Server (Server.java:<init>(1287)) - Listener at 0.0.0.0:33437
2024-05-22 06:02:35,304 [Socket Reader #1 for port 0] INFO  ipc.Server (Server.java:run(1323)) - Starting Socket Reader #1 for port 0
2024-05-22 06:02:35,305 [main] INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(90)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 10000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false.
2024-05-22 06:02:35,306 [main] INFO  ipc.Server (Server.java:<init>(1287)) - Listener at 0.0.0.0:45029
2024-05-22 06:02:35,306 [Socket Reader #1 for port 0] INFO  ipc.Server (Server.java:run(1323)) - Starting Socket Reader #1 for port 0
2024-05-22 06:02:35,307 [main] INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(90)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 10000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false.
2024-05-22 06:02:35,307 [main] INFO  ipc.Server (Server.java:<init>(1287)) - Listener at 0.0.0.0:45853
2024-05-22 06:02:35,307 [Socket Reader #1 for port 0] INFO  ipc.Server (Server.java:run(1323)) - Starting Socket Reader #1 for port 0
2024-05-22 06:02:35,312 [main] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service ContainerBalancer.
2024-05-22 06:02:35,312 [main] INFO  ha.SCMContext (SCMContext.java:updateSafeModeStatus(225)) - Update SafeModeStatus from SafeModeStatus{safeModeStatus=false, preCheckPassed=true} to SafeModeStatus{safeModeStatus=false, preCheckPassed=true}.
2024-05-22 06:02:35,314 [main] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(205)) - Sending CreatePipelineCommand for pipeline:PipelineID=3d2ef9cb-d1ce-4372-8d1a-78cb8f5acc6d to datanode:0fb943b2-0692-485f-bb27-fa18dfc7ebb1
2024-05-22 06:02:35,314 [main] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(205)) - Sending CreatePipelineCommand for pipeline:PipelineID=3d2ef9cb-d1ce-4372-8d1a-78cb8f5acc6d to datanode:d1cb8303-cd22-4f05-885c-46345131f745
2024-05-22 06:02:35,314 [main] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(205)) - Sending CreatePipelineCommand for pipeline:PipelineID=3d2ef9cb-d1ce-4372-8d1a-78cb8f5acc6d to datanode:93c5d343-b5df-41b2-a5d7-c3b18021e46a
2024-05-22 06:02:35,416 [main] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:getNextId(145)) - Allocate a batch for containerId, change lastId from 0 to 1000.
2024-05-22 06:02:35,417 [main] WARN  ha.SequenceIdGenerator (SequenceIdGenerator.java:allocateBatch(258)) - Failed to allocate a batch for localId, expected lastId is 0, actual lastId is 113750153625600000.
2024-05-22 06:02:35,418 [main] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:getNextId(145)) - Allocate a batch for localId, change lastId from 113750153625600000 to 113750153625601000.
2024-05-22 06:02:35,418 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1653)) - Container Balancer is not running.
2024-05-22 06:02:35,418 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stopReplicationManager(1786)) - Stopping Replication Manager Service.
2024-05-22 06:02:35,418 [main] INFO  replication.ReplicationManager (ReplicationManager.java:stop(329)) - Stopping Replication Monitor Thread.
2024-05-22 06:02:35,418 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1662)) - Stopping the Datanode Admin Monitor.
2024-05-22 06:02:35,418 [UnderReplicatedProcessor] WARN  replication.UnhealthyReplicationProcessor (UnhealthyReplicationProcessor.java:run(180)) - UnderReplicatedProcessor interrupted. Exiting...
2024-05-22 06:02:35,418 [OverReplicatedProcessor] WARN  replication.UnhealthyReplicationProcessor (UnhealthyReplicationProcessor.java:run(180)) - OverReplicatedProcessor interrupted. Exiting...
2024-05-22 06:02:35,418 [ReplicationMonitor] INFO  replication.ReplicationManager (ReplicationManager.java:run(938)) - Replication Monitor Thread is stopped
2024-05-22 06:02:35,418 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1669)) - Stopping datanode service RPC server
2024-05-22 06:02:35,419 [main] INFO  server.SCMDatanodeProtocolServer (SCMDatanodeProtocolServer.java:stop(425)) - Stopping the RPC server for DataNodes
2024-05-22 06:02:35,419 [main] INFO  ipc.Server (Server.java:stop(3523)) - Stopping server on 33437
2024-05-22 06:02:35,419 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1677)) - Stopping block service RPC server
2024-05-22 06:02:35,419 [main] INFO  server.SCMBlockProtocolServer (SCMBlockProtocolServer.java:stop(171)) - Stopping the RPC server for Block Protocol
2024-05-22 06:02:35,419 [main] INFO  ipc.Server (Server.java:stop(3523)) - Stopping server on 45029
2024-05-22 06:02:35,420 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1684)) - Stopping the StorageContainerLocationProtocol RPC server
2024-05-22 06:02:35,420 [main] INFO  server.SCMClientProtocolServer (SCMClientProtocolServer.java:stop(213)) - Stopping the RPC server for Client Protocol
2024-05-22 06:02:35,420 [main] INFO  ipc.Server (Server.java:stop(3523)) - Stopping server on 45853
2024-05-22 06:02:35,420 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1691)) - Stopping Storage Container Manager HTTP server.
2024-05-22 06:02:35,421 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1699)) - Stopping SCM LayoutVersionManager Service.
2024-05-22 06:02:35,421 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1711)) - Stopping Block Manager Service.
2024-05-22 06:02:35,421 [main] INFO  utils.BackgroundService (BackgroundService.java:shutdown(160)) - Shutting down service SCMBlockDeletingService
2024-05-22 06:02:35,421 [main] INFO  utils.BackgroundService (BackgroundService.java:shutdown(160)) - Shutting down service SCMBlockDeletingService
2024-05-22 06:02:35,421 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1731)) - Stopping SCM Event Queue.
2024-05-22 06:02:35,422 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1742)) - Stopping SCM HA services.
2024-05-22 06:02:35,422 [main] INFO  pipeline.BackgroundPipelineCreator (BackgroundPipelineCreator.java:stop(152)) - Stopping RatisPipelineUtilsThread.
2024-05-22 06:02:35,422 [RatisPipelineUtilsThread-0] WARN  pipeline.BackgroundPipelineCreator (BackgroundPipelineCreator.java:run(183)) - RatisPipelineUtilsThread is interrupted.
2024-05-22 06:02:35,422 [main] INFO  BackgroundPipelineScrubber (BackgroundSCMService.java:stop(128)) - Stopping BackgroundPipelineScrubber Service.
2024-05-22 06:02:35,422 [BackgroundPipelineScrubber] WARN  BackgroundPipelineScrubber (BackgroundSCMService.java:run(112)) - BackgroundPipelineScrubber is interrupted, exit
2024-05-22 06:02:35,423 [main] INFO  ExpiredContainerReplicaOpScrubber (BackgroundSCMService.java:stop(128)) - Stopping ExpiredContainerReplicaOpScrubber Service.
2024-05-22 06:02:35,423 [main] INFO  utils.BackgroundService (BackgroundService.java:shutdown(160)) - Shutting down service SCMBlockDeletingService
2024-05-22 06:02:35,423 [main] INFO  replication.ReplicationManager (ReplicationManager.java:stop(339)) - Replication Monitor Thread is not running.
2024-05-22 06:02:35,423 [main] WARN  balancer.ContainerBalancer (ContainerBalancer.java:stop(327)) - Cannot stop Container Balancer because it's not running or stopping
2024-05-22 06:02:35,423 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1777)) - Stopping SCM MetadataStore.
2024-05-22 06:02:35,424 [test-leaseManagerLeaseManager#LeaseMonitor] WARN  lease.LeaseManager (LeaseManager.java:run(287)) - Lease manager is interrupted. Shutting down...
java.lang.InterruptedException
	at java.base/java.util.concurrent.locks.AbstractQueuedSynchronizer.tryAcquireSharedNanos(AbstractQueuedSynchronizer.java:1081)
	at java.base/java.util.concurrent.Semaphore.tryAcquire(Semaphore.java:415)
	at org.apache.hadoop.ozone.lease.LeaseManager$LeaseMonitor.run(LeaseManager.java:285)
	at java.base/java.lang.Thread.run(Thread.java:840)
2024-05-22 06:02:35,423 [ExpiredContainerReplicaOpScrubber] WARN  ExpiredContainerReplicaOpScrubber (BackgroundSCMService.java:run(112)) - ExpiredContainerReplicaOpScrubber is interrupted, exit
2024-05-22 06:02:35,447 [main] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchemaFromFile(129)) - Loading schema from [file:/home/runner/work/ozone/ozone/hadoop-hdds/common/target/classes/network-topology-default.xml]
2024-05-22 06:02:35,447 [main] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchema(176)) - Loading network topology layer schema file
2024-05-22 06:02:35,459 [main] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchemaFromFile(129)) - Loading schema from [file:/home/runner/work/ozone/ozone/hadoop-hdds/common/target/classes/network-topology-default.xml]
2024-05-22 06:02:35,459 [main] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchema(176)) - Loading network topology layer schema file
2024-05-22 06:02:35,460 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(134)) - Added a new node: /default-rack/ca2cddde-7161-4e4c-9546-71c1c6c0c5b2
2024-05-22 06:02:35,460 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(134)) - Added a new node: /default-rack/0d9e162f-7626-49a1-a5f5-5f7922d86edc
2024-05-22 06:02:35,461 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(134)) - Added a new node: /default-rack/2760bed9-00a3-4c5f-a346-93f24eadc323
2024-05-22 06:02:35,461 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(134)) - Added a new node: /default-rack/e847f24d-a688-46db-bc26-82f16c1ab4e9
2024-05-22 06:02:35,461 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(134)) - Added a new node: /default-rack/b9606f1c-d669-4b76-a8e8-3a88e7863b5a
2024-05-22 06:02:35,461 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(134)) - Added a new node: /default-rack/1df86069-c739-47f2-8b2d-856e539f6029
2024-05-22 06:02:35,461 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(134)) - Added a new node: /default-rack/5b2977a1-4941-489d-90b8-37961485ee50
2024-05-22 06:02:35,461 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(134)) - Added a new node: /default-rack/b4022656-2901-4273-b7f8-7801f245bc1a
2024-05-22 06:02:35,462 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(134)) - Added a new node: /default-rack/60ab26ad-49e5-47ee-a7c3-ce8bd705adba
2024-05-22 06:02:35,462 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(134)) - Added a new node: /default-rack/f765e105-4945-4f37-a76e-9689eff9525c
2024-05-22 06:02:35,462 [main] WARN  utils.HAUtils (HAUtils.java:getMetaDir(339)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2024-05-22 06:02:35,462 [main] WARN  db.DBStoreBuilder (DBStoreBuilder.java:applyDBDefinition(171)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2024-05-22 06:02:35,524 [main] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:<init>(241)) - Init the HA SequenceIdGenerator.
2024-05-22 06:02:35,525 [main] INFO  pipeline.PipelineStateManagerImpl (PipelineStateManagerImpl.java:initialize(78)) - No pipeline exists in current db
2024-05-22 06:02:35,525 [main] INFO  algorithms.LeaderChoosePolicyFactory (LeaderChoosePolicyFactory.java:getPolicy(57)) - Create leader choose policy of type org.apache.hadoop.hdds.scm.pipeline.leader.choose.algorithms.MinLeaderCountChoosePolicy
2024-05-22 06:02:35,525 [main] INFO  algorithms.ContainerPlacementPolicyFactory (ContainerPlacementPolicyFactory.java:getPolicyInternal(86)) - Create container placement policy of type org.apache.hadoop.hdds.scm.container.placement.algorithms.SCMContainerPlacementRackScatter
2024-05-22 06:02:35,525 [main] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service BackgroundPipelineCreator.
2024-05-22 06:02:35,526 [main] INFO  pipeline.BackgroundPipelineCreator (BackgroundPipelineCreator.java:start(127)) - Starting RatisPipelineUtilsThread.
2024-05-22 06:02:35,526 [main] INFO  BackgroundPipelineScrubber (BackgroundSCMService.java:start(65)) - Starting BackgroundPipelineScrubber Service.
2024-05-22 06:02:35,526 [main] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service BackgroundPipelineScrubber.
2024-05-22 06:02:35,526 [main] INFO  algorithms.LeaderChoosePolicyFactory (LeaderChoosePolicyFactory.java:getPolicy(57)) - Create leader choose policy of type org.apache.hadoop.hdds.scm.pipeline.leader.choose.algorithms.MinLeaderCountChoosePolicy
2024-05-22 06:02:35,527 [main] INFO  safemode.ContainerSafeModeRule (ContainerSafeModeRule.java:<init>(91)) - containers with one replica threshold count 0
2024-05-22 06:02:35,528 [main] INFO  safemode.HealthyPipelineSafeModeRule (HealthyPipelineSafeModeRule.java:initializeRule(176)) - Total pipeline count is 0, healthy pipeline threshold count is 0
2024-05-22 06:02:35,528 [main] INFO  safemode.OneReplicaPipelineSafeModeRule (OneReplicaPipelineSafeModeRule.java:initializeRule(193)) - Total pipeline count is 0, pipeline's with at least one datanode reported threshold count is 0
2024-05-22 06:02:35,528 [main] WARN  server.ServerUtils (ServerUtils.java:getScmDbDir(143)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2024-05-22 06:02:35,529 [main] WARN  server.ServerUtils (ServerUtils.java:getScmDbDir(143)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2024-05-22 06:02:35,529 [main] INFO  ha.SCMHANodeDetails (SCMHANodeDetails.java:loadSCMHAConfig(207)) - ServiceID for StorageContainerManager is null
2024-05-22 06:02:35,530 [main] INFO  ha.SCMHANodeDetails (SCMHANodeDetails.java:loadSCMHAConfig(212)) - ozone.scm.default.service.id is not defined, falling back to ozone.scm.service.ids to find serviceID for StorageContainerManager if it is HA enabled cluster
2024-05-22 06:02:35,530 [main] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchemaFromFile(129)) - Loading schema from [file:/home/runner/work/ozone/ozone/hadoop-hdds/common/target/classes/network-topology-default.xml]
2024-05-22 06:02:35,531 [main] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchema(176)) - Loading network topology layer schema file
2024-05-22 06:02:35,532 [main] INFO  upgrade.AbstractLayoutVersionManager (AbstractLayoutVersionManager.java:init(83)) - Initializing Layout version manager with metadata layout = HADOOP_PRC_PORTS_IN_DATANODEDETAILS (version = 7), software layout = HADOOP_PRC_PORTS_IN_DATANODEDETAILS (version = 7)
2024-05-22 06:02:35,533 [main] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:upgradeToSequenceId(370)) - upgrade localId to 113750153625600000
2024-05-22 06:02:35,533 [main] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:upgradeToSequenceId(380)) - upgrade delTxnId to 0
2024-05-22 06:02:35,534 [main] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:upgradeToSequenceId(397)) - upgrade containerId to 0
2024-05-22 06:02:35,534 [main] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:upgradeToCertificateSequenceId(444)) - upgrade CertificateId to 2
2024-05-22 06:02:35,535 [main] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:<init>(241)) - Init the HA SequenceIdGenerator.
2024-05-22 06:02:35,535 [main] INFO  algorithms.ContainerPlacementPolicyFactory (ContainerPlacementPolicyFactory.java:getPolicyInternal(86)) - Create container placement policy of type org.apache.hadoop.hdds.scm.container.placement.algorithms.SCMContainerPlacementRackAware
2024-05-22 06:02:35,535 [main] INFO  algorithms.ContainerPlacementPolicyFactory (ContainerPlacementPolicyFactory.java:getPolicyInternal(86)) - Create container placement policy of type org.apache.hadoop.hdds.scm.container.placement.algorithms.SCMContainerPlacementRackScatter
2024-05-22 06:02:35,535 [main] INFO  ExpiredContainerReplicaOpScrubber (BackgroundSCMService.java:start(65)) - Starting ExpiredContainerReplicaOpScrubber Service.
2024-05-22 06:02:35,535 [main] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service ExpiredContainerReplicaOpScrubber.
2024-05-22 06:02:35,536 [main] INFO  algorithms.PipelineChoosePolicyFactory (PipelineChoosePolicyFactory.java:createPipelineChoosePolicyFromClass(80)) - Create pipeline choose policy of type org.apache.hadoop.hdds.scm.pipeline.choose.algorithms.RandomPipelineChoosePolicy
2024-05-22 06:02:35,536 [main] INFO  algorithms.PipelineChoosePolicyFactory (PipelineChoosePolicyFactory.java:createPipelineChoosePolicyFromClass(80)) - Create pipeline choose policy of type org.apache.hadoop.hdds.scm.pipeline.choose.algorithms.RandomPipelineChoosePolicy
2024-05-22 06:02:35,537 [main] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service SCMBlockDeletingService.
2024-05-22 06:02:35,538 [main] INFO  replication.ReplicationManager (ReplicationManager.java:start(296)) - Starting Replication Monitor Thread.
2024-05-22 06:02:35,538 [ReplicationMonitor] INFO  replication.ReplicationManager (ReplicationManager.java:processAll(373)) - Replication Manager is not ready to run until 300000ms after safemode exit
2024-05-22 06:02:35,538 [main] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service ReplicationManager.
2024-05-22 06:02:35,539 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:<init>(440)) - SCM start with adminUsers: [runner]
2024-05-22 06:02:35,539 [main] INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(90)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 10000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false.
2024-05-22 06:02:35,539 [main] INFO  ipc.Server (Server.java:<init>(1287)) - Listener at 0.0.0.0:45277
2024-05-22 06:02:35,540 [Socket Reader #1 for port 0] INFO  ipc.Server (Server.java:run(1323)) - Starting Socket Reader #1 for port 0
2024-05-22 06:02:35,541 [main] INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(90)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 10000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false.
2024-05-22 06:02:35,541 [main] INFO  ipc.Server (Server.java:<init>(1287)) - Listener at 0.0.0.0:37139
2024-05-22 06:02:35,542 [Socket Reader #1 for port 0] INFO  ipc.Server (Server.java:run(1323)) - Starting Socket Reader #1 for port 0
2024-05-22 06:02:35,546 [main] INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(90)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 10000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false.
2024-05-22 06:02:35,546 [main] INFO  ipc.Server (Server.java:<init>(1287)) - Listener at 0.0.0.0:41967
2024-05-22 06:02:35,546 [Socket Reader #1 for port 0] INFO  ipc.Server (Server.java:run(1323)) - Starting Socket Reader #1 for port 0
2024-05-22 06:02:35,549 [main] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service ContainerBalancer.
2024-05-22 06:02:35,550 [main] INFO  ha.SCMContext (SCMContext.java:updateSafeModeStatus(225)) - Update SafeModeStatus from SafeModeStatus{safeModeStatus=false, preCheckPassed=true} to SafeModeStatus{safeModeStatus=false, preCheckPassed=true}.
2024-05-22 06:02:35,551 [main] WARN  block.BlockManagerImpl (BlockManagerImpl.java:allocateBlock(158)) - Invalid block size requested : 6442450944
2024-05-22 06:02:35,551 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1653)) - Container Balancer is not running.
2024-05-22 06:02:35,551 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stopReplicationManager(1786)) - Stopping Replication Manager Service.
2024-05-22 06:02:35,552 [main] INFO  replication.ReplicationManager (ReplicationManager.java:stop(329)) - Stopping Replication Monitor Thread.
2024-05-22 06:02:35,552 [UnderReplicatedProcessor] WARN  replication.UnhealthyReplicationProcessor (UnhealthyReplicationProcessor.java:run(180)) - UnderReplicatedProcessor interrupted. Exiting...
2024-05-22 06:02:35,552 [OverReplicatedProcessor] WARN  replication.UnhealthyReplicationProcessor (UnhealthyReplicationProcessor.java:run(180)) - OverReplicatedProcessor interrupted. Exiting...
2024-05-22 06:02:35,552 [ReplicationMonitor] INFO  replication.ReplicationManager (ReplicationManager.java:run(938)) - Replication Monitor Thread is stopped
2024-05-22 06:02:35,552 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1662)) - Stopping the Datanode Admin Monitor.
2024-05-22 06:02:35,553 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1669)) - Stopping datanode service RPC server
2024-05-22 06:02:35,553 [main] INFO  server.SCMDatanodeProtocolServer (SCMDatanodeProtocolServer.java:stop(425)) - Stopping the RPC server for DataNodes
2024-05-22 06:02:35,553 [main] INFO  ipc.Server (Server.java:stop(3523)) - Stopping server on 45277
2024-05-22 06:02:35,553 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1677)) - Stopping block service RPC server
2024-05-22 06:02:35,553 [main] INFO  server.SCMBlockProtocolServer (SCMBlockProtocolServer.java:stop(171)) - Stopping the RPC server for Block Protocol
2024-05-22 06:02:35,554 [main] INFO  ipc.Server (Server.java:stop(3523)) - Stopping server on 37139
2024-05-22 06:02:35,554 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1684)) - Stopping the StorageContainerLocationProtocol RPC server
2024-05-22 06:02:35,554 [main] INFO  server.SCMClientProtocolServer (SCMClientProtocolServer.java:stop(213)) - Stopping the RPC server for Client Protocol
2024-05-22 06:02:35,554 [main] INFO  ipc.Server (Server.java:stop(3523)) - Stopping server on 41967
2024-05-22 06:02:35,555 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1691)) - Stopping Storage Container Manager HTTP server.
2024-05-22 06:02:35,555 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1699)) - Stopping SCM LayoutVersionManager Service.
2024-05-22 06:02:35,555 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1711)) - Stopping Block Manager Service.
2024-05-22 06:02:35,555 [main] INFO  utils.BackgroundService (BackgroundService.java:shutdown(160)) - Shutting down service SCMBlockDeletingService
2024-05-22 06:02:35,555 [main] INFO  utils.BackgroundService (BackgroundService.java:shutdown(160)) - Shutting down service SCMBlockDeletingService
2024-05-22 06:02:35,555 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1731)) - Stopping SCM Event Queue.
2024-05-22 06:02:35,555 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1742)) - Stopping SCM HA services.
2024-05-22 06:02:35,556 [main] INFO  pipeline.BackgroundPipelineCreator (BackgroundPipelineCreator.java:stop(152)) - Stopping RatisPipelineUtilsThread.
2024-05-22 06:02:35,556 [RatisPipelineUtilsThread-0] WARN  pipeline.BackgroundPipelineCreator (BackgroundPipelineCreator.java:run(183)) - RatisPipelineUtilsThread is interrupted.
2024-05-22 06:02:35,556 [BackgroundPipelineScrubber] WARN  BackgroundPipelineScrubber (BackgroundSCMService.java:run(112)) - BackgroundPipelineScrubber is interrupted, exit
2024-05-22 06:02:35,556 [main] INFO  BackgroundPipelineScrubber (BackgroundSCMService.java:stop(128)) - Stopping BackgroundPipelineScrubber Service.
2024-05-22 06:02:35,557 [main] INFO  ExpiredContainerReplicaOpScrubber (BackgroundSCMService.java:stop(128)) - Stopping ExpiredContainerReplicaOpScrubber Service.
2024-05-22 06:02:35,557 [ExpiredContainerReplicaOpScrubber] WARN  ExpiredContainerReplicaOpScrubber (BackgroundSCMService.java:run(112)) - ExpiredContainerReplicaOpScrubber is interrupted, exit
2024-05-22 06:02:35,557 [main] INFO  utils.BackgroundService (BackgroundService.java:shutdown(160)) - Shutting down service SCMBlockDeletingService
2024-05-22 06:02:35,557 [main] INFO  replication.ReplicationManager (ReplicationManager.java:stop(339)) - Replication Monitor Thread is not running.
2024-05-22 06:02:35,557 [main] WARN  balancer.ContainerBalancer (ContainerBalancer.java:stop(327)) - Cannot stop Container Balancer because it's not running or stopping
2024-05-22 06:02:35,557 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1777)) - Stopping SCM MetadataStore.
2024-05-22 06:02:35,557 [test-leaseManagerLeaseManager#LeaseMonitor] WARN  lease.LeaseManager (LeaseManager.java:run(287)) - Lease manager is interrupted. Shutting down...
java.lang.InterruptedException
	at java.base/java.util.concurrent.locks.AbstractQueuedSynchronizer.tryAcquireSharedNanos(AbstractQueuedSynchronizer.java:1081)
	at java.base/java.util.concurrent.Semaphore.tryAcquire(Semaphore.java:415)
	at org.apache.hadoop.ozone.lease.LeaseManager$LeaseMonitor.run(LeaseManager.java:285)
	at java.base/java.lang.Thread.run(Thread.java:840)
2024-05-22 06:02:35,576 [main] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchemaFromFile(129)) - Loading schema from [file:/home/runner/work/ozone/ozone/hadoop-hdds/common/target/classes/network-topology-default.xml]
2024-05-22 06:02:35,576 [main] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchema(176)) - Loading network topology layer schema file
2024-05-22 06:02:35,584 [main] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchemaFromFile(129)) - Loading schema from [file:/home/runner/work/ozone/ozone/hadoop-hdds/common/target/classes/network-topology-default.xml]
2024-05-22 06:02:35,584 [main] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchema(176)) - Loading network topology layer schema file
2024-05-22 06:02:35,585 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(134)) - Added a new node: /default-rack/5df6c55b-500e-46c5-b90f-6e66cec7debc
2024-05-22 06:02:35,585 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(134)) - Added a new node: /default-rack/f9ac723c-f186-4d06-8b12-777662112ec3
2024-05-22 06:02:35,586 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(134)) - Added a new node: /default-rack/73c69794-13a9-495b-96aa-4511b5e82f3c
2024-05-22 06:02:35,586 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(134)) - Added a new node: /default-rack/69a1c0df-e12e-4418-841b-ce8b0ccc2fcc
2024-05-22 06:02:35,586 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(134)) - Added a new node: /default-rack/e32b4350-f124-4fb2-8c4c-b90b9cfa8fc0
2024-05-22 06:02:35,586 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(134)) - Added a new node: /default-rack/954f9e00-96a8-4406-a4f7-a8b8da0a3b2d
2024-05-22 06:02:35,586 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(134)) - Added a new node: /default-rack/e2f66c38-34f9-4095-9bfb-3f9958ad5a1f
2024-05-22 06:02:35,586 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(134)) - Added a new node: /default-rack/acd13d03-8846-4bfb-9da9-90bf93a629b9
2024-05-22 06:02:35,587 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(134)) - Added a new node: /default-rack/b6d02987-34ea-47d0-a77d-a02e1dc36fe1
2024-05-22 06:02:35,587 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(134)) - Added a new node: /default-rack/7a313d74-d25d-4a0b-a8d2-3d5616d48870
2024-05-22 06:02:35,587 [main] WARN  utils.HAUtils (HAUtils.java:getMetaDir(339)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2024-05-22 06:02:35,587 [main] WARN  db.DBStoreBuilder (DBStoreBuilder.java:applyDBDefinition(171)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2024-05-22 06:02:35,648 [main] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:<init>(241)) - Init the HA SequenceIdGenerator.
2024-05-22 06:02:35,648 [main] INFO  pipeline.PipelineStateManagerImpl (PipelineStateManagerImpl.java:initialize(78)) - No pipeline exists in current db
2024-05-22 06:02:35,649 [main] INFO  algorithms.LeaderChoosePolicyFactory (LeaderChoosePolicyFactory.java:getPolicy(57)) - Create leader choose policy of type org.apache.hadoop.hdds.scm.pipeline.leader.choose.algorithms.MinLeaderCountChoosePolicy
2024-05-22 06:02:35,649 [main] INFO  algorithms.ContainerPlacementPolicyFactory (ContainerPlacementPolicyFactory.java:getPolicyInternal(86)) - Create container placement policy of type org.apache.hadoop.hdds.scm.container.placement.algorithms.SCMContainerPlacementRackScatter
2024-05-22 06:02:35,649 [main] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service BackgroundPipelineCreator.
2024-05-22 06:02:35,649 [main] INFO  pipeline.BackgroundPipelineCreator (BackgroundPipelineCreator.java:start(127)) - Starting RatisPipelineUtilsThread.
2024-05-22 06:02:35,650 [main] INFO  BackgroundPipelineScrubber (BackgroundSCMService.java:start(65)) - Starting BackgroundPipelineScrubber Service.
2024-05-22 06:02:35,650 [main] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service BackgroundPipelineScrubber.
2024-05-22 06:02:35,651 [main] INFO  algorithms.LeaderChoosePolicyFactory (LeaderChoosePolicyFactory.java:getPolicy(57)) - Create leader choose policy of type org.apache.hadoop.hdds.scm.pipeline.leader.choose.algorithms.MinLeaderCountChoosePolicy
2024-05-22 06:02:35,652 [main] INFO  safemode.ContainerSafeModeRule (ContainerSafeModeRule.java:<init>(91)) - containers with one replica threshold count 0
2024-05-22 06:02:35,652 [main] INFO  safemode.HealthyPipelineSafeModeRule (HealthyPipelineSafeModeRule.java:initializeRule(176)) - Total pipeline count is 0, healthy pipeline threshold count is 0
2024-05-22 06:02:35,652 [main] INFO  safemode.OneReplicaPipelineSafeModeRule (OneReplicaPipelineSafeModeRule.java:initializeRule(193)) - Total pipeline count is 0, pipeline's with at least one datanode reported threshold count is 0
2024-05-22 06:02:35,652 [main] WARN  server.ServerUtils (ServerUtils.java:getScmDbDir(143)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2024-05-22 06:02:35,653 [main] WARN  server.ServerUtils (ServerUtils.java:getScmDbDir(143)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2024-05-22 06:02:35,657 [main] INFO  ha.SCMHANodeDetails (SCMHANodeDetails.java:loadSCMHAConfig(207)) - ServiceID for StorageContainerManager is null
2024-05-22 06:02:35,657 [main] INFO  ha.SCMHANodeDetails (SCMHANodeDetails.java:loadSCMHAConfig(212)) - ozone.scm.default.service.id is not defined, falling back to ozone.scm.service.ids to find serviceID for StorageContainerManager if it is HA enabled cluster
2024-05-22 06:02:35,658 [main] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchemaFromFile(129)) - Loading schema from [file:/home/runner/work/ozone/ozone/hadoop-hdds/common/target/classes/network-topology-default.xml]
2024-05-22 06:02:35,659 [main] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchema(176)) - Loading network topology layer schema file
2024-05-22 06:02:35,660 [main] INFO  upgrade.AbstractLayoutVersionManager (AbstractLayoutVersionManager.java:init(83)) - Initializing Layout version manager with metadata layout = HADOOP_PRC_PORTS_IN_DATANODEDETAILS (version = 7), software layout = HADOOP_PRC_PORTS_IN_DATANODEDETAILS (version = 7)
2024-05-22 06:02:35,661 [main] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:upgradeToSequenceId(370)) - upgrade localId to 113750153625600000
2024-05-22 06:02:35,662 [main] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:upgradeToSequenceId(380)) - upgrade delTxnId to 0
2024-05-22 06:02:35,663 [main] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:upgradeToSequenceId(397)) - upgrade containerId to 0
2024-05-22 06:02:35,663 [main] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:upgradeToCertificateSequenceId(444)) - upgrade CertificateId to 2
2024-05-22 06:02:35,663 [main] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:<init>(241)) - Init the HA SequenceIdGenerator.
2024-05-22 06:02:35,664 [main] INFO  algorithms.ContainerPlacementPolicyFactory (ContainerPlacementPolicyFactory.java:getPolicyInternal(86)) - Create container placement policy of type org.apache.hadoop.hdds.scm.container.placement.algorithms.SCMContainerPlacementRackAware
2024-05-22 06:02:35,664 [main] INFO  algorithms.ContainerPlacementPolicyFactory (ContainerPlacementPolicyFactory.java:getPolicyInternal(86)) - Create container placement policy of type org.apache.hadoop.hdds.scm.container.placement.algorithms.SCMContainerPlacementRackScatter
2024-05-22 06:02:35,664 [main] INFO  ExpiredContainerReplicaOpScrubber (BackgroundSCMService.java:start(65)) - Starting ExpiredContainerReplicaOpScrubber Service.
2024-05-22 06:02:35,665 [main] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service ExpiredContainerReplicaOpScrubber.
2024-05-22 06:02:35,665 [main] INFO  algorithms.PipelineChoosePolicyFactory (PipelineChoosePolicyFactory.java:createPipelineChoosePolicyFromClass(80)) - Create pipeline choose policy of type org.apache.hadoop.hdds.scm.pipeline.choose.algorithms.RandomPipelineChoosePolicy
2024-05-22 06:02:35,665 [main] INFO  algorithms.PipelineChoosePolicyFactory (PipelineChoosePolicyFactory.java:createPipelineChoosePolicyFromClass(80)) - Create pipeline choose policy of type org.apache.hadoop.hdds.scm.pipeline.choose.algorithms.RandomPipelineChoosePolicy
2024-05-22 06:02:35,666 [main] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service SCMBlockDeletingService.
2024-05-22 06:02:35,668 [main] INFO  replication.ReplicationManager (ReplicationManager.java:start(296)) - Starting Replication Monitor Thread.
2024-05-22 06:02:35,668 [ReplicationMonitor] INFO  replication.ReplicationManager (ReplicationManager.java:processAll(373)) - Replication Manager is not ready to run until 300000ms after safemode exit
2024-05-22 06:02:35,668 [main] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service ReplicationManager.
2024-05-22 06:02:35,669 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:<init>(440)) - SCM start with adminUsers: [runner]
2024-05-22 06:02:35,670 [main] INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(90)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 10000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false.
2024-05-22 06:02:35,670 [main] INFO  ipc.Server (Server.java:<init>(1287)) - Listener at 0.0.0.0:44013
2024-05-22 06:02:35,674 [Socket Reader #1 for port 0] INFO  ipc.Server (Server.java:run(1323)) - Starting Socket Reader #1 for port 0
2024-05-22 06:02:35,675 [main] INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(90)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 10000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false.
2024-05-22 06:02:35,675 [main] INFO  ipc.Server (Server.java:<init>(1287)) - Listener at 0.0.0.0:34965
2024-05-22 06:02:35,676 [Socket Reader #1 for port 0] INFO  ipc.Server (Server.java:run(1323)) - Starting Socket Reader #1 for port 0
2024-05-22 06:02:35,676 [main] INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(90)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 10000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false.
2024-05-22 06:02:35,677 [main] INFO  ipc.Server (Server.java:<init>(1287)) - Listener at 0.0.0.0:41565
2024-05-22 06:02:35,677 [Socket Reader #1 for port 0] INFO  ipc.Server (Server.java:run(1323)) - Starting Socket Reader #1 for port 0
2024-05-22 06:02:35,684 [main] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service ContainerBalancer.
2024-05-22 06:02:35,685 [main] INFO  ha.SCMContext (SCMContext.java:updateSafeModeStatus(225)) - Update SafeModeStatus from SafeModeStatus{safeModeStatus=false, preCheckPassed=true} to SafeModeStatus{safeModeStatus=false, preCheckPassed=true}.
2024-05-22 06:02:35,685 [main] INFO  ha.SCMContext (SCMContext.java:updateSafeModeStatus(225)) - Update SafeModeStatus from SafeModeStatus{safeModeStatus=false, preCheckPassed=true} to SafeModeStatus{safeModeStatus=true, preCheckPassed=true}.
2024-05-22 06:02:35,686 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1653)) - Container Balancer is not running.
2024-05-22 06:02:35,686 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stopReplicationManager(1786)) - Stopping Replication Manager Service.
2024-05-22 06:02:35,686 [main] INFO  replication.ReplicationManager (ReplicationManager.java:stop(329)) - Stopping Replication Monitor Thread.
2024-05-22 06:02:35,686 [UnderReplicatedProcessor] WARN  replication.UnhealthyReplicationProcessor (UnhealthyReplicationProcessor.java:run(180)) - UnderReplicatedProcessor interrupted. Exiting...
2024-05-22 06:02:35,687 [OverReplicatedProcessor] WARN  replication.UnhealthyReplicationProcessor (UnhealthyReplicationProcessor.java:run(180)) - OverReplicatedProcessor interrupted. Exiting...
2024-05-22 06:02:35,687 [ReplicationMonitor] INFO  replication.ReplicationManager (ReplicationManager.java:run(938)) - Replication Monitor Thread is stopped
2024-05-22 06:02:35,687 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1662)) - Stopping the Datanode Admin Monitor.
2024-05-22 06:02:35,687 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1669)) - Stopping datanode service RPC server
2024-05-22 06:02:35,687 [main] INFO  server.SCMDatanodeProtocolServer (SCMDatanodeProtocolServer.java:stop(425)) - Stopping the RPC server for DataNodes
2024-05-22 06:02:35,687 [main] INFO  ipc.Server (Server.java:stop(3523)) - Stopping server on 44013
2024-05-22 06:02:35,688 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1677)) - Stopping block service RPC server
2024-05-22 06:02:35,688 [main] INFO  server.SCMBlockProtocolServer (SCMBlockProtocolServer.java:stop(171)) - Stopping the RPC server for Block Protocol
2024-05-22 06:02:35,688 [main] INFO  ipc.Server (Server.java:stop(3523)) - Stopping server on 34965
2024-05-22 06:02:35,688 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1684)) - Stopping the StorageContainerLocationProtocol RPC server
2024-05-22 06:02:35,688 [main] INFO  server.SCMClientProtocolServer (SCMClientProtocolServer.java:stop(213)) - Stopping the RPC server for Client Protocol
2024-05-22 06:02:35,688 [main] INFO  ipc.Server (Server.java:stop(3523)) - Stopping server on 41565
2024-05-22 06:02:35,689 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1691)) - Stopping Storage Container Manager HTTP server.
2024-05-22 06:02:35,689 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1699)) - Stopping SCM LayoutVersionManager Service.
2024-05-22 06:02:35,689 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1711)) - Stopping Block Manager Service.
2024-05-22 06:02:35,689 [main] INFO  utils.BackgroundService (BackgroundService.java:shutdown(160)) - Shutting down service SCMBlockDeletingService
2024-05-22 06:02:35,689 [main] INFO  utils.BackgroundService (BackgroundService.java:shutdown(160)) - Shutting down service SCMBlockDeletingService
2024-05-22 06:02:35,689 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1731)) - Stopping SCM Event Queue.
2024-05-22 06:02:35,689 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1742)) - Stopping SCM HA services.
2024-05-22 06:02:35,690 [main] INFO  pipeline.BackgroundPipelineCreator (BackgroundPipelineCreator.java:stop(152)) - Stopping RatisPipelineUtilsThread.
2024-05-22 06:02:35,690 [RatisPipelineUtilsThread-0] WARN  pipeline.BackgroundPipelineCreator (BackgroundPipelineCreator.java:run(183)) - RatisPipelineUtilsThread is interrupted.
2024-05-22 06:02:35,690 [main] INFO  BackgroundPipelineScrubber (BackgroundSCMService.java:stop(128)) - Stopping BackgroundPipelineScrubber Service.
2024-05-22 06:02:35,690 [BackgroundPipelineScrubber] WARN  BackgroundPipelineScrubber (BackgroundSCMService.java:run(112)) - BackgroundPipelineScrubber is interrupted, exit
2024-05-22 06:02:35,690 [main] INFO  ExpiredContainerReplicaOpScrubber (BackgroundSCMService.java:stop(128)) - Stopping ExpiredContainerReplicaOpScrubber Service.
2024-05-22 06:02:35,690 [main] INFO  utils.BackgroundService (BackgroundService.java:shutdown(160)) - Shutting down service SCMBlockDeletingService
2024-05-22 06:02:35,690 [ExpiredContainerReplicaOpScrubber] WARN  ExpiredContainerReplicaOpScrubber (BackgroundSCMService.java:run(112)) - ExpiredContainerReplicaOpScrubber is interrupted, exit
2024-05-22 06:02:35,691 [main] INFO  replication.ReplicationManager (ReplicationManager.java:stop(339)) - Replication Monitor Thread is not running.
2024-05-22 06:02:35,691 [main] WARN  balancer.ContainerBalancer (ContainerBalancer.java:stop(327)) - Cannot stop Container Balancer because it's not running or stopping
2024-05-22 06:02:35,691 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1777)) - Stopping SCM MetadataStore.
2024-05-22 06:02:35,691 [test-leaseManagerLeaseManager#LeaseMonitor] WARN  lease.LeaseManager (LeaseManager.java:run(287)) - Lease manager is interrupted. Shutting down...
java.lang.InterruptedException
	at java.base/java.util.concurrent.locks.AbstractQueuedSynchronizer.tryAcquireSharedNanos(AbstractQueuedSynchronizer.java:1081)
	at java.base/java.util.concurrent.Semaphore.tryAcquire(Semaphore.java:415)
	at org.apache.hadoop.ozone.lease.LeaseManager$LeaseMonitor.run(LeaseManager.java:285)
	at java.base/java.lang.Thread.run(Thread.java:840)
2024-05-22 06:02:35,719 [main] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchemaFromFile(129)) - Loading schema from [file:/home/runner/work/ozone/ozone/hadoop-hdds/common/target/classes/network-topology-default.xml]
2024-05-22 06:02:35,719 [main] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchema(176)) - Loading network topology layer schema file
2024-05-22 06:02:35,731 [main] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchemaFromFile(129)) - Loading schema from [file:/home/runner/work/ozone/ozone/hadoop-hdds/common/target/classes/network-topology-default.xml]
2024-05-22 06:02:35,731 [main] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchema(176)) - Loading network topology layer schema file
2024-05-22 06:02:35,732 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(134)) - Added a new node: /default-rack/bd60cd02-bf19-4f78-8acf-25e99cfafc0e
2024-05-22 06:02:35,733 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(134)) - Added a new node: /default-rack/88afcf62-ad3a-446d-9cae-c3086a55edd0
2024-05-22 06:02:35,733 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(134)) - Added a new node: /default-rack/5ec7348b-7ed7-4489-bef3-0d89fc493ba7
2024-05-22 06:02:35,733 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(134)) - Added a new node: /default-rack/6c0a7992-e7b4-4692-bc07-b4db8b12ef1f
2024-05-22 06:02:35,733 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(134)) - Added a new node: /default-rack/a98eb194-a480-4c7c-940c-9078908a0de5
2024-05-22 06:02:35,733 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(134)) - Added a new node: /default-rack/07f52205-1180-4859-a509-eb463d172f10
2024-05-22 06:02:35,733 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(134)) - Added a new node: /default-rack/b11f8d9e-5a01-40df-a166-d70afb423163
2024-05-22 06:02:35,734 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(134)) - Added a new node: /default-rack/66f8af79-c441-466f-b2f5-0d074b516f4a
2024-05-22 06:02:35,734 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(134)) - Added a new node: /default-rack/4a1ac267-abda-4e81-95b4-198663e0a8f9
2024-05-22 06:02:35,734 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(134)) - Added a new node: /default-rack/05efa883-0611-4564-9140-30a7dbd3164e
2024-05-22 06:02:35,734 [main] WARN  utils.HAUtils (HAUtils.java:getMetaDir(339)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2024-05-22 06:02:35,734 [main] WARN  db.DBStoreBuilder (DBStoreBuilder.java:applyDBDefinition(171)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2024-05-22 06:02:35,809 [main] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:<init>(241)) - Init the HA SequenceIdGenerator.
2024-05-22 06:02:35,809 [main] INFO  pipeline.PipelineStateManagerImpl (PipelineStateManagerImpl.java:initialize(78)) - No pipeline exists in current db
2024-05-22 06:02:35,809 [main] INFO  algorithms.LeaderChoosePolicyFactory (LeaderChoosePolicyFactory.java:getPolicy(57)) - Create leader choose policy of type org.apache.hadoop.hdds.scm.pipeline.leader.choose.algorithms.MinLeaderCountChoosePolicy
2024-05-22 06:02:35,810 [main] INFO  algorithms.ContainerPlacementPolicyFactory (ContainerPlacementPolicyFactory.java:getPolicyInternal(86)) - Create container placement policy of type org.apache.hadoop.hdds.scm.container.placement.algorithms.SCMContainerPlacementRackScatter
2024-05-22 06:02:35,810 [main] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service BackgroundPipelineCreator.
2024-05-22 06:02:35,810 [main] INFO  pipeline.BackgroundPipelineCreator (BackgroundPipelineCreator.java:start(127)) - Starting RatisPipelineUtilsThread.
2024-05-22 06:02:35,811 [main] INFO  BackgroundPipelineScrubber (BackgroundSCMService.java:start(65)) - Starting BackgroundPipelineScrubber Service.
2024-05-22 06:02:35,811 [main] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service BackgroundPipelineScrubber.
2024-05-22 06:02:35,811 [main] INFO  algorithms.LeaderChoosePolicyFactory (LeaderChoosePolicyFactory.java:getPolicy(57)) - Create leader choose policy of type org.apache.hadoop.hdds.scm.pipeline.leader.choose.algorithms.MinLeaderCountChoosePolicy
2024-05-22 06:02:35,812 [main] INFO  safemode.ContainerSafeModeRule (ContainerSafeModeRule.java:<init>(91)) - containers with one replica threshold count 0
2024-05-22 06:02:35,812 [main] INFO  safemode.HealthyPipelineSafeModeRule (HealthyPipelineSafeModeRule.java:initializeRule(176)) - Total pipeline count is 0, healthy pipeline threshold count is 0
2024-05-22 06:02:35,813 [main] INFO  safemode.OneReplicaPipelineSafeModeRule (OneReplicaPipelineSafeModeRule.java:initializeRule(193)) - Total pipeline count is 0, pipeline's with at least one datanode reported threshold count is 0
2024-05-22 06:02:35,813 [main] WARN  server.ServerUtils (ServerUtils.java:getScmDbDir(143)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2024-05-22 06:02:35,814 [main] WARN  server.ServerUtils (ServerUtils.java:getScmDbDir(143)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2024-05-22 06:02:35,815 [main] INFO  ha.SCMHANodeDetails (SCMHANodeDetails.java:loadSCMHAConfig(207)) - ServiceID for StorageContainerManager is null
2024-05-22 06:02:35,815 [main] INFO  ha.SCMHANodeDetails (SCMHANodeDetails.java:loadSCMHAConfig(212)) - ozone.scm.default.service.id is not defined, falling back to ozone.scm.service.ids to find serviceID for StorageContainerManager if it is HA enabled cluster
2024-05-22 06:02:35,816 [main] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchemaFromFile(129)) - Loading schema from [file:/home/runner/work/ozone/ozone/hadoop-hdds/common/target/classes/network-topology-default.xml]
2024-05-22 06:02:35,816 [main] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchema(176)) - Loading network topology layer schema file
2024-05-22 06:02:35,818 [main] INFO  upgrade.AbstractLayoutVersionManager (AbstractLayoutVersionManager.java:init(83)) - Initializing Layout version manager with metadata layout = HADOOP_PRC_PORTS_IN_DATANODEDETAILS (version = 7), software layout = HADOOP_PRC_PORTS_IN_DATANODEDETAILS (version = 7)
2024-05-22 06:02:35,819 [main] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:upgradeToSequenceId(370)) - upgrade localId to 113750153625600000
2024-05-22 06:02:35,820 [main] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:upgradeToSequenceId(380)) - upgrade delTxnId to 0
2024-05-22 06:02:35,820 [main] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:upgradeToSequenceId(397)) - upgrade containerId to 0
2024-05-22 06:02:35,821 [main] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:upgradeToCertificateSequenceId(444)) - upgrade CertificateId to 2
2024-05-22 06:02:35,821 [main] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:<init>(241)) - Init the HA SequenceIdGenerator.
2024-05-22 06:02:35,821 [main] INFO  algorithms.ContainerPlacementPolicyFactory (ContainerPlacementPolicyFactory.java:getPolicyInternal(86)) - Create container placement policy of type org.apache.hadoop.hdds.scm.container.placement.algorithms.SCMContainerPlacementRackAware
2024-05-22 06:02:35,821 [main] INFO  algorithms.ContainerPlacementPolicyFactory (ContainerPlacementPolicyFactory.java:getPolicyInternal(86)) - Create container placement policy of type org.apache.hadoop.hdds.scm.container.placement.algorithms.SCMContainerPlacementRackScatter
2024-05-22 06:02:35,821 [main] INFO  ExpiredContainerReplicaOpScrubber (BackgroundSCMService.java:start(65)) - Starting ExpiredContainerReplicaOpScrubber Service.
2024-05-22 06:02:35,822 [main] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service ExpiredContainerReplicaOpScrubber.
2024-05-22 06:02:35,822 [main] INFO  algorithms.PipelineChoosePolicyFactory (PipelineChoosePolicyFactory.java:createPipelineChoosePolicyFromClass(80)) - Create pipeline choose policy of type org.apache.hadoop.hdds.scm.pipeline.choose.algorithms.RandomPipelineChoosePolicy
2024-05-22 06:02:35,822 [main] INFO  algorithms.PipelineChoosePolicyFactory (PipelineChoosePolicyFactory.java:createPipelineChoosePolicyFromClass(80)) - Create pipeline choose policy of type org.apache.hadoop.hdds.scm.pipeline.choose.algorithms.RandomPipelineChoosePolicy
2024-05-22 06:02:35,823 [main] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service SCMBlockDeletingService.
2024-05-22 06:02:35,824 [main] INFO  replication.ReplicationManager (ReplicationManager.java:start(296)) - Starting Replication Monitor Thread.
2024-05-22 06:02:35,824 [main] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service ReplicationManager.
2024-05-22 06:02:35,829 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:<init>(440)) - SCM start with adminUsers: [runner]
2024-05-22 06:02:35,829 [main] INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(90)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 10000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false.
2024-05-22 06:02:35,829 [main] INFO  ipc.Server (Server.java:<init>(1287)) - Listener at 0.0.0.0:36125
2024-05-22 06:02:35,829 [LeakDetector-ManagedRocksObject0] WARN  managed.ManagedRocksObjectUtils (ManagedRocksObjectUtils.java:reportLeak(63)) - ManagedWriteBatch is not closed properly
2024-05-22 06:02:35,830 [LeakDetector-ManagedRocksObject0] WARN  managed.ManagedRocksObjectUtils (ManagedRocksObjectUtils.java:reportLeak(63)) - ManagedWriteBatch is not closed properly
2024-05-22 06:02:35,830 [LeakDetector-ManagedRocksObject0] WARN  managed.ManagedRocksObjectUtils (ManagedRocksObjectUtils.java:reportLeak(63)) - ManagedWriteBatch is not closed properly
2024-05-22 06:02:35,830 [ReplicationMonitor] INFO  replication.ReplicationManager (ReplicationManager.java:processAll(373)) - Replication Manager is not ready to run until 300000ms after safemode exit
2024-05-22 06:02:35,831 [main] INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(90)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 10000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false.
2024-05-22 06:02:35,835 [main] INFO  ipc.Server (Server.java:<init>(1287)) - Listener at 0.0.0.0:42633
2024-05-22 06:02:35,836 [Socket Reader #1 for port 0] INFO  ipc.Server (Server.java:run(1323)) - Starting Socket Reader #1 for port 0
2024-05-22 06:02:35,837 [Socket Reader #1 for port 0] INFO  ipc.Server (Server.java:run(1323)) - Starting Socket Reader #1 for port 0
2024-05-22 06:02:35,842 [main] INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(90)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 10000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false.
2024-05-22 06:02:35,842 [main] INFO  ipc.Server (Server.java:<init>(1287)) - Listener at 0.0.0.0:34473
2024-05-22 06:02:35,843 [Socket Reader #1 for port 0] INFO  ipc.Server (Server.java:run(1323)) - Starting Socket Reader #1 for port 0
2024-05-22 06:02:35,848 [main] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service ContainerBalancer.
2024-05-22 06:02:35,849 [main] INFO  ha.SCMContext (SCMContext.java:updateSafeModeStatus(225)) - Update SafeModeStatus from SafeModeStatus{safeModeStatus=false, preCheckPassed=true} to SafeModeStatus{safeModeStatus=false, preCheckPassed=true}.
2024-05-22 06:02:35,851 [main] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(205)) - Sending CreatePipelineCommand for pipeline:PipelineID=bc217c94-87e6-4e87-b4a9-8f2712dfb270 to datanode:07f52205-1180-4859-a509-eb463d172f10
2024-05-22 06:02:35,851 [main] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(205)) - Sending CreatePipelineCommand for pipeline:PipelineID=bc217c94-87e6-4e87-b4a9-8f2712dfb270 to datanode:bd60cd02-bf19-4f78-8acf-25e99cfafc0e
2024-05-22 06:02:35,851 [main] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(205)) - Sending CreatePipelineCommand for pipeline:PipelineID=bc217c94-87e6-4e87-b4a9-8f2712dfb270 to datanode:88afcf62-ad3a-446d-9cae-c3086a55edd0
2024-05-22 06:02:35,854 [main] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:getNextId(145)) - Allocate a batch for containerId, change lastId from 0 to 1000.
2024-05-22 06:02:35,855 [main] WARN  ha.SequenceIdGenerator (SequenceIdGenerator.java:allocateBatch(258)) - Failed to allocate a batch for localId, expected lastId is 0, actual lastId is 113750153625600000.
2024-05-22 06:02:35,855 [main] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:getNextId(145)) - Allocate a batch for localId, change lastId from 113750153625600000 to 113750153625601000.
2024-05-22 06:02:35,856 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1653)) - Container Balancer is not running.
2024-05-22 06:02:35,856 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stopReplicationManager(1786)) - Stopping Replication Manager Service.
2024-05-22 06:02:35,856 [main] INFO  replication.ReplicationManager (ReplicationManager.java:stop(329)) - Stopping Replication Monitor Thread.
2024-05-22 06:02:35,856 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1662)) - Stopping the Datanode Admin Monitor.
2024-05-22 06:02:35,856 [UnderReplicatedProcessor] WARN  replication.UnhealthyReplicationProcessor (UnhealthyReplicationProcessor.java:run(180)) - UnderReplicatedProcessor interrupted. Exiting...
2024-05-22 06:02:35,856 [OverReplicatedProcessor] WARN  replication.UnhealthyReplicationProcessor (UnhealthyReplicationProcessor.java:run(180)) - OverReplicatedProcessor interrupted. Exiting...
2024-05-22 06:02:35,856 [ReplicationMonitor] INFO  replication.ReplicationManager (ReplicationManager.java:run(938)) - Replication Monitor Thread is stopped
2024-05-22 06:02:35,856 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1669)) - Stopping datanode service RPC server
2024-05-22 06:02:35,856 [main] INFO  server.SCMDatanodeProtocolServer (SCMDatanodeProtocolServer.java:stop(425)) - Stopping the RPC server for DataNodes
2024-05-22 06:02:35,857 [main] INFO  ipc.Server (Server.java:stop(3523)) - Stopping server on 36125
2024-05-22 06:02:35,857 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1677)) - Stopping block service RPC server
2024-05-22 06:02:35,857 [main] INFO  server.SCMBlockProtocolServer (SCMBlockProtocolServer.java:stop(171)) - Stopping the RPC server for Block Protocol
2024-05-22 06:02:35,857 [main] INFO  ipc.Server (Server.java:stop(3523)) - Stopping server on 42633
2024-05-22 06:02:35,858 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1684)) - Stopping the StorageContainerLocationProtocol RPC server
2024-05-22 06:02:35,858 [main] INFO  server.SCMClientProtocolServer (SCMClientProtocolServer.java:stop(213)) - Stopping the RPC server for Client Protocol
2024-05-22 06:02:35,858 [main] INFO  ipc.Server (Server.java:stop(3523)) - Stopping server on 34473
2024-05-22 06:02:35,858 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1691)) - Stopping Storage Container Manager HTTP server.
2024-05-22 06:02:35,858 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1699)) - Stopping SCM LayoutVersionManager Service.
2024-05-22 06:02:35,858 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1711)) - Stopping Block Manager Service.
2024-05-22 06:02:35,858 [main] INFO  utils.BackgroundService (BackgroundService.java:shutdown(160)) - Shutting down service SCMBlockDeletingService
2024-05-22 06:02:35,859 [main] INFO  utils.BackgroundService (BackgroundService.java:shutdown(160)) - Shutting down service SCMBlockDeletingService
2024-05-22 06:02:35,859 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1731)) - Stopping SCM Event Queue.
2024-05-22 06:02:35,859 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1742)) - Stopping SCM HA services.
2024-05-22 06:02:35,859 [main] INFO  pipeline.BackgroundPipelineCreator (BackgroundPipelineCreator.java:stop(152)) - Stopping RatisPipelineUtilsThread.
2024-05-22 06:02:35,859 [RatisPipelineUtilsThread-0] WARN  pipeline.BackgroundPipelineCreator (BackgroundPipelineCreator.java:run(183)) - RatisPipelineUtilsThread is interrupted.
2024-05-22 06:02:35,859 [main] INFO  BackgroundPipelineScrubber (BackgroundSCMService.java:stop(128)) - Stopping BackgroundPipelineScrubber Service.
2024-05-22 06:02:35,859 [BackgroundPipelineScrubber] WARN  BackgroundPipelineScrubber (BackgroundSCMService.java:run(112)) - BackgroundPipelineScrubber is interrupted, exit
2024-05-22 06:02:35,859 [ExpiredContainerReplicaOpScrubber] WARN  ExpiredContainerReplicaOpScrubber (BackgroundSCMService.java:run(112)) - ExpiredContainerReplicaOpScrubber is interrupted, exit
2024-05-22 06:02:35,859 [main] INFO  ExpiredContainerReplicaOpScrubber (BackgroundSCMService.java:stop(128)) - Stopping ExpiredContainerReplicaOpScrubber Service.
2024-05-22 06:02:35,861 [main] INFO  utils.BackgroundService (BackgroundService.java:shutdown(160)) - Shutting down service SCMBlockDeletingService
2024-05-22 06:02:35,861 [main] INFO  replication.ReplicationManager (ReplicationManager.java:stop(339)) - Replication Monitor Thread is not running.
2024-05-22 06:02:35,861 [main] WARN  balancer.ContainerBalancer (ContainerBalancer.java:stop(327)) - Cannot stop Container Balancer because it's not running or stopping
2024-05-22 06:02:35,861 [test-leaseManagerLeaseManager#LeaseMonitor] WARN  lease.LeaseManager (LeaseManager.java:run(287)) - Lease manager is interrupted. Shutting down...
java.lang.InterruptedException
	at java.base/java.util.concurrent.locks.AbstractQueuedSynchronizer.tryAcquireSharedNanos(AbstractQueuedSynchronizer.java:1081)
	at java.base/java.util.concurrent.Semaphore.tryAcquire(Semaphore.java:415)
	at org.apache.hadoop.ozone.lease.LeaseManager$LeaseMonitor.run(LeaseManager.java:285)
	at java.base/java.lang.Thread.run(Thread.java:840)
2024-05-22 06:02:35,861 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1777)) - Stopping SCM MetadataStore.
2024-05-22 06:02:35,889 [main] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchemaFromFile(129)) - Loading schema from [file:/home/runner/work/ozone/ozone/hadoop-hdds/common/target/classes/network-topology-default.xml]
2024-05-22 06:02:35,889 [main] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchema(176)) - Loading network topology layer schema file
2024-05-22 06:02:35,901 [main] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchemaFromFile(129)) - Loading schema from [file:/home/runner/work/ozone/ozone/hadoop-hdds/common/target/classes/network-topology-default.xml]
2024-05-22 06:02:35,902 [main] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchema(176)) - Loading network topology layer schema file
2024-05-22 06:02:35,903 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(134)) - Added a new node: /default-rack/f318d2a1-4c96-4815-97ad-0c9db6685468
2024-05-22 06:02:35,903 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(134)) - Added a new node: /default-rack/f4598461-a21e-4819-8018-584d7a0b9338
2024-05-22 06:02:35,903 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(134)) - Added a new node: /default-rack/7b63216d-0361-4ec2-b5f3-0baf83023e65
2024-05-22 06:02:35,903 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(134)) - Added a new node: /default-rack/e4af8e4d-f473-4428-946d-41b097155623
2024-05-22 06:02:35,904 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(134)) - Added a new node: /default-rack/0fa1aa8e-8255-462f-ac46-ae0af1a34ce4
2024-05-22 06:02:35,904 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(134)) - Added a new node: /default-rack/beef3195-ed33-43d6-8bd9-65f65e6b4835
2024-05-22 06:02:35,904 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(134)) - Added a new node: /default-rack/17cd5d49-c104-4a85-a732-eed890bd2d21
2024-05-22 06:02:35,904 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(134)) - Added a new node: /default-rack/ba0ced0a-cc29-416a-a655-e5ecb3e6f1ac
2024-05-22 06:02:35,904 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(134)) - Added a new node: /default-rack/c421842f-4023-48c5-ac88-378d9170436e
2024-05-22 06:02:35,904 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(134)) - Added a new node: /default-rack/ea1faf79-112b-42af-aa86-78a48a796a2e
2024-05-22 06:02:35,905 [main] WARN  utils.HAUtils (HAUtils.java:getMetaDir(339)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2024-05-22 06:02:35,905 [main] WARN  db.DBStoreBuilder (DBStoreBuilder.java:applyDBDefinition(171)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2024-05-22 06:02:35,970 [main] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:<init>(241)) - Init the HA SequenceIdGenerator.
2024-05-22 06:02:35,970 [main] INFO  pipeline.PipelineStateManagerImpl (PipelineStateManagerImpl.java:initialize(78)) - No pipeline exists in current db
2024-05-22 06:02:35,971 [main] INFO  algorithms.LeaderChoosePolicyFactory (LeaderChoosePolicyFactory.java:getPolicy(57)) - Create leader choose policy of type org.apache.hadoop.hdds.scm.pipeline.leader.choose.algorithms.MinLeaderCountChoosePolicy
2024-05-22 06:02:35,971 [main] INFO  algorithms.ContainerPlacementPolicyFactory (ContainerPlacementPolicyFactory.java:getPolicyInternal(86)) - Create container placement policy of type org.apache.hadoop.hdds.scm.container.placement.algorithms.SCMContainerPlacementRackScatter
2024-05-22 06:02:35,971 [main] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service BackgroundPipelineCreator.
2024-05-22 06:02:35,971 [main] INFO  pipeline.BackgroundPipelineCreator (BackgroundPipelineCreator.java:start(127)) - Starting RatisPipelineUtilsThread.
2024-05-22 06:02:35,972 [main] INFO  BackgroundPipelineScrubber (BackgroundSCMService.java:start(65)) - Starting BackgroundPipelineScrubber Service.
2024-05-22 06:02:35,972 [main] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service BackgroundPipelineScrubber.
2024-05-22 06:02:35,972 [main] INFO  algorithms.LeaderChoosePolicyFactory (LeaderChoosePolicyFactory.java:getPolicy(57)) - Create leader choose policy of type org.apache.hadoop.hdds.scm.pipeline.leader.choose.algorithms.MinLeaderCountChoosePolicy
2024-05-22 06:02:35,973 [main] INFO  safemode.ContainerSafeModeRule (ContainerSafeModeRule.java:<init>(91)) - containers with one replica threshold count 0
2024-05-22 06:02:35,973 [main] INFO  safemode.HealthyPipelineSafeModeRule (HealthyPipelineSafeModeRule.java:initializeRule(176)) - Total pipeline count is 0, healthy pipeline threshold count is 0
2024-05-22 06:02:35,973 [main] INFO  safemode.OneReplicaPipelineSafeModeRule (OneReplicaPipelineSafeModeRule.java:initializeRule(193)) - Total pipeline count is 0, pipeline's with at least one datanode reported threshold count is 0
2024-05-22 06:02:35,973 [main] WARN  server.ServerUtils (ServerUtils.java:getScmDbDir(143)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2024-05-22 06:02:35,975 [main] WARN  server.ServerUtils (ServerUtils.java:getScmDbDir(143)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2024-05-22 06:02:35,975 [main] INFO  ha.SCMHANodeDetails (SCMHANodeDetails.java:loadSCMHAConfig(207)) - ServiceID for StorageContainerManager is null
2024-05-22 06:02:35,975 [main] INFO  ha.SCMHANodeDetails (SCMHANodeDetails.java:loadSCMHAConfig(212)) - ozone.scm.default.service.id is not defined, falling back to ozone.scm.service.ids to find serviceID for StorageContainerManager if it is HA enabled cluster
2024-05-22 06:02:35,976 [main] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchemaFromFile(129)) - Loading schema from [file:/home/runner/work/ozone/ozone/hadoop-hdds/common/target/classes/network-topology-default.xml]
2024-05-22 06:02:35,976 [main] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchema(176)) - Loading network topology layer schema file
2024-05-22 06:02:35,977 [main] INFO  upgrade.AbstractLayoutVersionManager (AbstractLayoutVersionManager.java:init(83)) - Initializing Layout version manager with metadata layout = HADOOP_PRC_PORTS_IN_DATANODEDETAILS (version = 7), software layout = HADOOP_PRC_PORTS_IN_DATANODEDETAILS (version = 7)
2024-05-22 06:02:35,979 [main] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:upgradeToSequenceId(370)) - upgrade localId to 113750153625600000
2024-05-22 06:02:35,979 [main] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:upgradeToSequenceId(380)) - upgrade delTxnId to 0
2024-05-22 06:02:35,980 [main] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:upgradeToSequenceId(397)) - upgrade containerId to 0
2024-05-22 06:02:35,980 [main] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:upgradeToCertificateSequenceId(444)) - upgrade CertificateId to 2
2024-05-22 06:02:35,980 [main] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:<init>(241)) - Init the HA SequenceIdGenerator.
2024-05-22 06:02:35,981 [main] INFO  algorithms.ContainerPlacementPolicyFactory (ContainerPlacementPolicyFactory.java:getPolicyInternal(86)) - Create container placement policy of type org.apache.hadoop.hdds.scm.container.placement.algorithms.SCMContainerPlacementRackAware
2024-05-22 06:02:35,981 [main] INFO  algorithms.ContainerPlacementPolicyFactory (ContainerPlacementPolicyFactory.java:getPolicyInternal(86)) - Create container placement policy of type org.apache.hadoop.hdds.scm.container.placement.algorithms.SCMContainerPlacementRackScatter
2024-05-22 06:02:35,981 [main] INFO  ExpiredContainerReplicaOpScrubber (BackgroundSCMService.java:start(65)) - Starting ExpiredContainerReplicaOpScrubber Service.
2024-05-22 06:02:35,981 [main] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service ExpiredContainerReplicaOpScrubber.
2024-05-22 06:02:35,981 [main] INFO  algorithms.PipelineChoosePolicyFactory (PipelineChoosePolicyFactory.java:createPipelineChoosePolicyFromClass(80)) - Create pipeline choose policy of type org.apache.hadoop.hdds.scm.pipeline.choose.algorithms.RandomPipelineChoosePolicy
2024-05-22 06:02:35,982 [main] INFO  algorithms.PipelineChoosePolicyFactory (PipelineChoosePolicyFactory.java:createPipelineChoosePolicyFromClass(80)) - Create pipeline choose policy of type org.apache.hadoop.hdds.scm.pipeline.choose.algorithms.RandomPipelineChoosePolicy
2024-05-22 06:02:35,983 [main] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service SCMBlockDeletingService.
2024-05-22 06:02:35,984 [main] INFO  replication.ReplicationManager (ReplicationManager.java:start(296)) - Starting Replication Monitor Thread.
2024-05-22 06:02:35,989 [main] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service ReplicationManager.
2024-05-22 06:02:35,989 [ReplicationMonitor] INFO  replication.ReplicationManager (ReplicationManager.java:processAll(373)) - Replication Manager is not ready to run until 300000ms after safemode exit
2024-05-22 06:02:35,994 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:<init>(440)) - SCM start with adminUsers: [runner]
2024-05-22 06:02:35,994 [main] INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(90)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 10000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false.
2024-05-22 06:02:35,994 [main] INFO  ipc.Server (Server.java:<init>(1287)) - Listener at 0.0.0.0:44035
2024-05-22 06:02:35,998 [Socket Reader #1 for port 0] INFO  ipc.Server (Server.java:run(1323)) - Starting Socket Reader #1 for port 0
2024-05-22 06:02:35,999 [main] INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(90)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 10000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false.
2024-05-22 06:02:35,999 [main] INFO  ipc.Server (Server.java:<init>(1287)) - Listener at 0.0.0.0:42895
2024-05-22 06:02:35,999 [Socket Reader #1 for port 0] INFO  ipc.Server (Server.java:run(1323)) - Starting Socket Reader #1 for port 0
2024-05-22 06:02:36,000 [main] INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(90)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 10000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false.
2024-05-22 06:02:36,001 [main] INFO  ipc.Server (Server.java:<init>(1287)) - Listener at 0.0.0.0:32895
2024-05-22 06:02:36,001 [Socket Reader #1 for port 0] INFO  ipc.Server (Server.java:run(1323)) - Starting Socket Reader #1 for port 0
2024-05-22 06:02:36,009 [main] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service ContainerBalancer.
2024-05-22 06:02:36,010 [main] INFO  ha.SCMContext (SCMContext.java:updateSafeModeStatus(225)) - Update SafeModeStatus from SafeModeStatus{safeModeStatus=false, preCheckPassed=true} to SafeModeStatus{safeModeStatus=false, preCheckPassed=true}.
2024-05-22 06:02:36,012 [main] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(205)) - Sending CreatePipelineCommand for pipeline:PipelineID=6ad622a7-956b-452e-a54b-da72c2c099d1 to datanode:17cd5d49-c104-4a85-a732-eed890bd2d21
2024-05-22 06:02:36,013 [main] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(205)) - Sending CreatePipelineCommand for pipeline:PipelineID=6ad622a7-956b-452e-a54b-da72c2c099d1 to datanode:0fa1aa8e-8255-462f-ac46-ae0af1a34ce4
2024-05-22 06:02:36,013 [main] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(205)) - Sending CreatePipelineCommand for pipeline:PipelineID=6ad622a7-956b-452e-a54b-da72c2c099d1 to datanode:f4598461-a21e-4819-8018-584d7a0b9338
2024-05-22 06:02:36,019 [pool-341-thread-1] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:getNextId(145)) - Allocate a batch for containerId, change lastId from 0 to 1000.
2024-05-22 06:02:36,020 [pool-341-thread-1] WARN  ha.SequenceIdGenerator (SequenceIdGenerator.java:allocateBatch(258)) - Failed to allocate a batch for localId, expected lastId is 0, actual lastId is 113750153625600000.
2024-05-22 06:02:36,021 [pool-341-thread-1] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:getNextId(145)) - Allocate a batch for localId, change lastId from 113750153625600000 to 113750153625601000.
2024-05-22 06:02:36,026 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1653)) - Container Balancer is not running.
2024-05-22 06:02:36,026 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stopReplicationManager(1786)) - Stopping Replication Manager Service.
2024-05-22 06:02:36,026 [main] INFO  replication.ReplicationManager (ReplicationManager.java:stop(329)) - Stopping Replication Monitor Thread.
2024-05-22 06:02:36,026 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1662)) - Stopping the Datanode Admin Monitor.
2024-05-22 06:02:36,026 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1669)) - Stopping datanode service RPC server
2024-05-22 06:02:36,026 [main] INFO  server.SCMDatanodeProtocolServer (SCMDatanodeProtocolServer.java:stop(425)) - Stopping the RPC server for DataNodes
2024-05-22 06:02:36,026 [main] INFO  ipc.Server (Server.java:stop(3523)) - Stopping server on 44035
2024-05-22 06:02:36,026 [OverReplicatedProcessor] WARN  replication.UnhealthyReplicationProcessor (UnhealthyReplicationProcessor.java:run(180)) - OverReplicatedProcessor interrupted. Exiting...
2024-05-22 06:02:36,026 [ReplicationMonitor] INFO  replication.ReplicationManager (ReplicationManager.java:run(938)) - Replication Monitor Thread is stopped
2024-05-22 06:02:36,026 [UnderReplicatedProcessor] WARN  replication.UnhealthyReplicationProcessor (UnhealthyReplicationProcessor.java:run(180)) - UnderReplicatedProcessor interrupted. Exiting...
2024-05-22 06:02:36,028 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1677)) - Stopping block service RPC server
2024-05-22 06:02:36,028 [main] INFO  server.SCMBlockProtocolServer (SCMBlockProtocolServer.java:stop(171)) - Stopping the RPC server for Block Protocol
2024-05-22 06:02:36,028 [main] INFO  ipc.Server (Server.java:stop(3523)) - Stopping server on 42895
2024-05-22 06:02:36,028 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1684)) - Stopping the StorageContainerLocationProtocol RPC server
2024-05-22 06:02:36,028 [main] INFO  server.SCMClientProtocolServer (SCMClientProtocolServer.java:stop(213)) - Stopping the RPC server for Client Protocol
2024-05-22 06:02:36,029 [main] INFO  ipc.Server (Server.java:stop(3523)) - Stopping server on 32895
2024-05-22 06:02:36,029 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1691)) - Stopping Storage Container Manager HTTP server.
2024-05-22 06:02:36,029 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1699)) - Stopping SCM LayoutVersionManager Service.
2024-05-22 06:02:36,029 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1711)) - Stopping Block Manager Service.
2024-05-22 06:02:36,029 [main] INFO  utils.BackgroundService (BackgroundService.java:shutdown(160)) - Shutting down service SCMBlockDeletingService
2024-05-22 06:02:36,029 [main] INFO  utils.BackgroundService (BackgroundService.java:shutdown(160)) - Shutting down service SCMBlockDeletingService
2024-05-22 06:02:36,029 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1731)) - Stopping SCM Event Queue.
2024-05-22 06:02:36,030 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1742)) - Stopping SCM HA services.
2024-05-22 06:02:36,030 [main] INFO  pipeline.BackgroundPipelineCreator (BackgroundPipelineCreator.java:stop(152)) - Stopping RatisPipelineUtilsThread.
2024-05-22 06:02:36,030 [RatisPipelineUtilsThread-0] WARN  pipeline.BackgroundPipelineCreator (BackgroundPipelineCreator.java:run(183)) - RatisPipelineUtilsThread is interrupted.
2024-05-22 06:02:36,030 [BackgroundPipelineScrubber] WARN  BackgroundPipelineScrubber (BackgroundSCMService.java:run(112)) - BackgroundPipelineScrubber is interrupted, exit
2024-05-22 06:02:36,031 [main] INFO  BackgroundPipelineScrubber (BackgroundSCMService.java:stop(128)) - Stopping BackgroundPipelineScrubber Service.
2024-05-22 06:02:36,031 [main] INFO  ExpiredContainerReplicaOpScrubber (BackgroundSCMService.java:stop(128)) - Stopping ExpiredContainerReplicaOpScrubber Service.
2024-05-22 06:02:36,031 [main] INFO  utils.BackgroundService (BackgroundService.java:shutdown(160)) - Shutting down service SCMBlockDeletingService
2024-05-22 06:02:36,031 [main] INFO  replication.ReplicationManager (ReplicationManager.java:stop(339)) - Replication Monitor Thread is not running.
2024-05-22 06:02:36,031 [ExpiredContainerReplicaOpScrubber] WARN  ExpiredContainerReplicaOpScrubber (BackgroundSCMService.java:run(112)) - ExpiredContainerReplicaOpScrubber is interrupted, exit
2024-05-22 06:02:36,031 [main] WARN  balancer.ContainerBalancer (ContainerBalancer.java:stop(327)) - Cannot stop Container Balancer because it's not running or stopping
2024-05-22 06:02:36,031 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1777)) - Stopping SCM MetadataStore.
2024-05-22 06:02:36,051 [main] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchemaFromFile(129)) - Loading schema from [file:/home/runner/work/ozone/ozone/hadoop-hdds/common/target/classes/network-topology-default.xml]
2024-05-22 06:02:36,051 [main] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchema(176)) - Loading network topology layer schema file
2024-05-22 06:02:36,060 [main] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchemaFromFile(129)) - Loading schema from [file:/home/runner/work/ozone/ozone/hadoop-hdds/common/target/classes/network-topology-default.xml]
2024-05-22 06:02:36,060 [main] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchema(176)) - Loading network topology layer schema file
2024-05-22 06:02:36,061 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(134)) - Added a new node: /default-rack/53799b4b-d2f5-4632-8252-17dfd66dd6be
2024-05-22 06:02:36,061 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(134)) - Added a new node: /default-rack/5fa73e92-062d-4592-9112-c9b4e6ec0e13
2024-05-22 06:02:36,062 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(134)) - Added a new node: /default-rack/a59316ec-53c7-4ef1-a043-d958e4479c28
2024-05-22 06:02:36,062 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(134)) - Added a new node: /default-rack/5809c3e5-0e76-4c50-8ee6-96101c4345bf
2024-05-22 06:02:36,062 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(134)) - Added a new node: /default-rack/a555f714-d199-472c-bcae-54443a4789f8
2024-05-22 06:02:36,062 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(134)) - Added a new node: /default-rack/0eaa8718-92b2-49f1-8c20-d11badeeac13
2024-05-22 06:02:36,063 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(134)) - Added a new node: /default-rack/089c000c-07e6-4b23-a377-c452cfaf64f6
2024-05-22 06:02:36,063 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(134)) - Added a new node: /default-rack/5bcf2b78-4353-42cb-b4db-a33a23b5b314
2024-05-22 06:02:36,063 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(134)) - Added a new node: /default-rack/941abada-aaf6-4c29-80f4-d37f1a8fc703
2024-05-22 06:02:36,063 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(134)) - Added a new node: /default-rack/7b2e0a89-936b-40e9-a6e8-adffe8c3b086
2024-05-22 06:02:36,063 [main] WARN  utils.HAUtils (HAUtils.java:getMetaDir(339)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2024-05-22 06:02:36,064 [main] WARN  db.DBStoreBuilder (DBStoreBuilder.java:applyDBDefinition(171)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2024-05-22 06:02:36,139 [main] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:<init>(241)) - Init the HA SequenceIdGenerator.
2024-05-22 06:02:36,139 [main] INFO  pipeline.PipelineStateManagerImpl (PipelineStateManagerImpl.java:initialize(78)) - No pipeline exists in current db
2024-05-22 06:02:36,139 [main] INFO  algorithms.LeaderChoosePolicyFactory (LeaderChoosePolicyFactory.java:getPolicy(57)) - Create leader choose policy of type org.apache.hadoop.hdds.scm.pipeline.leader.choose.algorithms.MinLeaderCountChoosePolicy
2024-05-22 06:02:36,139 [main] INFO  algorithms.ContainerPlacementPolicyFactory (ContainerPlacementPolicyFactory.java:getPolicyInternal(86)) - Create container placement policy of type org.apache.hadoop.hdds.scm.container.placement.algorithms.SCMContainerPlacementRackScatter
2024-05-22 06:02:36,140 [main] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service BackgroundPipelineCreator.
2024-05-22 06:02:36,140 [main] INFO  pipeline.BackgroundPipelineCreator (BackgroundPipelineCreator.java:start(127)) - Starting RatisPipelineUtilsThread.
2024-05-22 06:02:36,140 [main] INFO  BackgroundPipelineScrubber (BackgroundSCMService.java:start(65)) - Starting BackgroundPipelineScrubber Service.
2024-05-22 06:02:36,140 [main] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service BackgroundPipelineScrubber.
2024-05-22 06:02:36,141 [main] INFO  algorithms.LeaderChoosePolicyFactory (LeaderChoosePolicyFactory.java:getPolicy(57)) - Create leader choose policy of type org.apache.hadoop.hdds.scm.pipeline.leader.choose.algorithms.MinLeaderCountChoosePolicy
2024-05-22 06:02:36,142 [main] INFO  safemode.ContainerSafeModeRule (ContainerSafeModeRule.java:<init>(91)) - containers with one replica threshold count 0
2024-05-22 06:02:36,142 [main] INFO  safemode.HealthyPipelineSafeModeRule (HealthyPipelineSafeModeRule.java:initializeRule(176)) - Total pipeline count is 0, healthy pipeline threshold count is 0
2024-05-22 06:02:36,142 [main] INFO  safemode.OneReplicaPipelineSafeModeRule (OneReplicaPipelineSafeModeRule.java:initializeRule(193)) - Total pipeline count is 0, pipeline's with at least one datanode reported threshold count is 0
2024-05-22 06:02:36,142 [main] WARN  server.ServerUtils (ServerUtils.java:getScmDbDir(143)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2024-05-22 06:02:36,143 [main] WARN  server.ServerUtils (ServerUtils.java:getScmDbDir(143)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2024-05-22 06:02:36,144 [main] INFO  ha.SCMHANodeDetails (SCMHANodeDetails.java:loadSCMHAConfig(207)) - ServiceID for StorageContainerManager is null
2024-05-22 06:02:36,144 [main] INFO  ha.SCMHANodeDetails (SCMHANodeDetails.java:loadSCMHAConfig(212)) - ozone.scm.default.service.id is not defined, falling back to ozone.scm.service.ids to find serviceID for StorageContainerManager if it is HA enabled cluster
2024-05-22 06:02:36,145 [main] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchemaFromFile(129)) - Loading schema from [file:/home/runner/work/ozone/ozone/hadoop-hdds/common/target/classes/network-topology-default.xml]
2024-05-22 06:02:36,145 [main] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchema(176)) - Loading network topology layer schema file
2024-05-22 06:02:36,146 [main] INFO  upgrade.AbstractLayoutVersionManager (AbstractLayoutVersionManager.java:init(83)) - Initializing Layout version manager with metadata layout = HADOOP_PRC_PORTS_IN_DATANODEDETAILS (version = 7), software layout = HADOOP_PRC_PORTS_IN_DATANODEDETAILS (version = 7)
2024-05-22 06:02:36,148 [main] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:upgradeToSequenceId(370)) - upgrade localId to 113750153625600000
2024-05-22 06:02:36,148 [main] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:upgradeToSequenceId(380)) - upgrade delTxnId to 0
2024-05-22 06:02:36,149 [main] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:upgradeToSequenceId(397)) - upgrade containerId to 0
2024-05-22 06:02:36,150 [main] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:upgradeToCertificateSequenceId(444)) - upgrade CertificateId to 2
2024-05-22 06:02:36,150 [main] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:<init>(241)) - Init the HA SequenceIdGenerator.
2024-05-22 06:02:36,150 [main] INFO  algorithms.ContainerPlacementPolicyFactory (ContainerPlacementPolicyFactory.java:getPolicyInternal(86)) - Create container placement policy of type org.apache.hadoop.hdds.scm.container.placement.algorithms.SCMContainerPlacementRackAware
2024-05-22 06:02:36,150 [main] INFO  algorithms.ContainerPlacementPolicyFactory (ContainerPlacementPolicyFactory.java:getPolicyInternal(86)) - Create container placement policy of type org.apache.hadoop.hdds.scm.container.placement.algorithms.SCMContainerPlacementRackScatter
2024-05-22 06:02:36,150 [main] INFO  ExpiredContainerReplicaOpScrubber (BackgroundSCMService.java:start(65)) - Starting ExpiredContainerReplicaOpScrubber Service.
2024-05-22 06:02:36,153 [main] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service ExpiredContainerReplicaOpScrubber.
2024-05-22 06:02:36,154 [main] INFO  algorithms.PipelineChoosePolicyFactory (PipelineChoosePolicyFactory.java:createPipelineChoosePolicyFromClass(80)) - Create pipeline choose policy of type org.apache.hadoop.hdds.scm.pipeline.choose.algorithms.RandomPipelineChoosePolicy
2024-05-22 06:02:36,154 [main] INFO  algorithms.PipelineChoosePolicyFactory (PipelineChoosePolicyFactory.java:createPipelineChoosePolicyFromClass(80)) - Create pipeline choose policy of type org.apache.hadoop.hdds.scm.pipeline.choose.algorithms.RandomPipelineChoosePolicy
2024-05-22 06:02:36,155 [main] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service SCMBlockDeletingService.
2024-05-22 06:02:36,156 [main] INFO  replication.ReplicationManager (ReplicationManager.java:start(296)) - Starting Replication Monitor Thread.
2024-05-22 06:02:36,158 [main] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service ReplicationManager.
2024-05-22 06:02:36,158 [ReplicationMonitor] INFO  replication.ReplicationManager (ReplicationManager.java:processAll(373)) - Replication Manager is not ready to run until 300000ms after safemode exit
2024-05-22 06:02:36,159 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:<init>(440)) - SCM start with adminUsers: [runner]
2024-05-22 06:02:36,159 [main] INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(90)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 10000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false.
2024-05-22 06:02:36,159 [main] INFO  ipc.Server (Server.java:<init>(1287)) - Listener at 0.0.0.0:43611
2024-05-22 06:02:36,160 [Socket Reader #1 for port 0] INFO  ipc.Server (Server.java:run(1323)) - Starting Socket Reader #1 for port 0
2024-05-22 06:02:36,160 [main] INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(90)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 10000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false.
2024-05-22 06:02:36,161 [main] INFO  ipc.Server (Server.java:<init>(1287)) - Listener at 0.0.0.0:36809
2024-05-22 06:02:36,162 [main] INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(90)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 10000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false.
2024-05-22 06:02:36,162 [main] INFO  ipc.Server (Server.java:<init>(1287)) - Listener at 0.0.0.0:39885
2024-05-22 06:02:36,162 [Socket Reader #1 for port 0] INFO  ipc.Server (Server.java:run(1323)) - Starting Socket Reader #1 for port 0
2024-05-22 06:02:36,163 [Socket Reader #1 for port 0] INFO  ipc.Server (Server.java:run(1323)) - Starting Socket Reader #1 for port 0
2024-05-22 06:02:36,171 [main] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service ContainerBalancer.
2024-05-22 06:02:36,171 [main] INFO  ha.SCMContext (SCMContext.java:updateSafeModeStatus(225)) - Update SafeModeStatus from SafeModeStatus{safeModeStatus=false, preCheckPassed=true} to SafeModeStatus{safeModeStatus=false, preCheckPassed=true}.
2024-05-22 06:02:36,173 [main] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(205)) - Sending CreatePipelineCommand for pipeline:PipelineID=00f4fa96-a00e-4295-bf20-df4e8882d7af to datanode:a59316ec-53c7-4ef1-a043-d958e4479c28
2024-05-22 06:02:36,173 [main] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(205)) - Sending CreatePipelineCommand for pipeline:PipelineID=00f4fa96-a00e-4295-bf20-df4e8882d7af to datanode:5fa73e92-062d-4592-9112-c9b4e6ec0e13
2024-05-22 06:02:36,173 [main] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(205)) - Sending CreatePipelineCommand for pipeline:PipelineID=00f4fa96-a00e-4295-bf20-df4e8882d7af to datanode:5809c3e5-0e76-4c50-8ee6-96101c4345bf
2024-05-22 06:02:36,179 [pool-381-thread-1] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:getNextId(145)) - Allocate a batch for containerId, change lastId from 0 to 1000.
2024-05-22 06:02:36,182 [pool-382-thread-1] WARN  ha.SequenceIdGenerator (SequenceIdGenerator.java:allocateBatch(258)) - Failed to allocate a batch for localId, expected lastId is 0, actual lastId is 113750153625600000.
2024-05-22 06:02:36,182 [pool-382-thread-1] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:getNextId(145)) - Allocate a batch for localId, change lastId from 113750153625600000 to 113750153625601000.
2024-05-22 06:02:36,186 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1653)) - Container Balancer is not running.
2024-05-22 06:02:36,187 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stopReplicationManager(1786)) - Stopping Replication Manager Service.
2024-05-22 06:02:36,187 [main] INFO  replication.ReplicationManager (ReplicationManager.java:stop(329)) - Stopping Replication Monitor Thread.
2024-05-22 06:02:36,187 [UnderReplicatedProcessor] WARN  replication.UnhealthyReplicationProcessor (UnhealthyReplicationProcessor.java:run(180)) - UnderReplicatedProcessor interrupted. Exiting...
2024-05-22 06:02:36,187 [OverReplicatedProcessor] WARN  replication.UnhealthyReplicationProcessor (UnhealthyReplicationProcessor.java:run(180)) - OverReplicatedProcessor interrupted. Exiting...
2024-05-22 06:02:36,187 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1662)) - Stopping the Datanode Admin Monitor.
2024-05-22 06:02:36,188 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1669)) - Stopping datanode service RPC server
2024-05-22 06:02:36,188 [main] INFO  server.SCMDatanodeProtocolServer (SCMDatanodeProtocolServer.java:stop(425)) - Stopping the RPC server for DataNodes
2024-05-22 06:02:36,188 [main] INFO  ipc.Server (Server.java:stop(3523)) - Stopping server on 43611
2024-05-22 06:02:36,188 [ReplicationMonitor] INFO  replication.ReplicationManager (ReplicationManager.java:run(938)) - Replication Monitor Thread is stopped
2024-05-22 06:02:36,188 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1677)) - Stopping block service RPC server
2024-05-22 06:02:36,189 [main] INFO  server.SCMBlockProtocolServer (SCMBlockProtocolServer.java:stop(171)) - Stopping the RPC server for Block Protocol
2024-05-22 06:02:36,189 [main] INFO  ipc.Server (Server.java:stop(3523)) - Stopping server on 36809
2024-05-22 06:02:36,189 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1684)) - Stopping the StorageContainerLocationProtocol RPC server
2024-05-22 06:02:36,189 [main] INFO  server.SCMClientProtocolServer (SCMClientProtocolServer.java:stop(213)) - Stopping the RPC server for Client Protocol
2024-05-22 06:02:36,189 [main] INFO  ipc.Server (Server.java:stop(3523)) - Stopping server on 39885
2024-05-22 06:02:36,190 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1691)) - Stopping Storage Container Manager HTTP server.
2024-05-22 06:02:36,190 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1699)) - Stopping SCM LayoutVersionManager Service.
2024-05-22 06:02:36,190 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1711)) - Stopping Block Manager Service.
2024-05-22 06:02:36,190 [main] INFO  utils.BackgroundService (BackgroundService.java:shutdown(160)) - Shutting down service SCMBlockDeletingService
2024-05-22 06:02:36,190 [main] INFO  utils.BackgroundService (BackgroundService.java:shutdown(160)) - Shutting down service SCMBlockDeletingService
2024-05-22 06:02:36,191 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1731)) - Stopping SCM Event Queue.
2024-05-22 06:02:36,191 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1742)) - Stopping SCM HA services.
2024-05-22 06:02:36,191 [main] INFO  pipeline.BackgroundPipelineCreator (BackgroundPipelineCreator.java:stop(152)) - Stopping RatisPipelineUtilsThread.
2024-05-22 06:02:36,191 [RatisPipelineUtilsThread-0] WARN  pipeline.BackgroundPipelineCreator (BackgroundPipelineCreator.java:run(183)) - RatisPipelineUtilsThread is interrupted.
2024-05-22 06:02:36,192 [main] INFO  BackgroundPipelineScrubber (BackgroundSCMService.java:stop(128)) - Stopping BackgroundPipelineScrubber Service.
2024-05-22 06:02:36,192 [BackgroundPipelineScrubber] WARN  BackgroundPipelineScrubber (BackgroundSCMService.java:run(112)) - BackgroundPipelineScrubber is interrupted, exit
2024-05-22 06:02:36,192 [ExpiredContainerReplicaOpScrubber] WARN  ExpiredContainerReplicaOpScrubber (BackgroundSCMService.java:run(112)) - ExpiredContainerReplicaOpScrubber is interrupted, exit
2024-05-22 06:02:36,192 [main] INFO  ExpiredContainerReplicaOpScrubber (BackgroundSCMService.java:stop(128)) - Stopping ExpiredContainerReplicaOpScrubber Service.
2024-05-22 06:02:36,192 [main] INFO  utils.BackgroundService (BackgroundService.java:shutdown(160)) - Shutting down service SCMBlockDeletingService
2024-05-22 06:02:36,192 [main] INFO  replication.ReplicationManager (ReplicationManager.java:stop(339)) - Replication Monitor Thread is not running.
2024-05-22 06:02:36,193 [main] WARN  balancer.ContainerBalancer (ContainerBalancer.java:stop(327)) - Cannot stop Container Balancer because it's not running or stopping
2024-05-22 06:02:36,193 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1777)) - Stopping SCM MetadataStore.
2024-05-22 06:02:36,193 [test-leaseManagerLeaseManager#LeaseMonitor] WARN  lease.LeaseManager (LeaseManager.java:run(287)) - Lease manager is interrupted. Shutting down...
java.lang.InterruptedException
	at java.base/java.util.concurrent.locks.AbstractQueuedSynchronizer.tryAcquireSharedNanos(AbstractQueuedSynchronizer.java:1081)
	at java.base/java.util.concurrent.Semaphore.tryAcquire(Semaphore.java:415)
	at org.apache.hadoop.ozone.lease.LeaseManager$LeaseMonitor.run(LeaseManager.java:285)
	at java.base/java.lang.Thread.run(Thread.java:840)
2024-05-22 06:02:36,220 [main] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchemaFromFile(129)) - Loading schema from [file:/home/runner/work/ozone/ozone/hadoop-hdds/common/target/classes/network-topology-default.xml]
2024-05-22 06:02:36,220 [main] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchema(176)) - Loading network topology layer schema file
2024-05-22 06:02:36,229 [main] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchemaFromFile(129)) - Loading schema from [file:/home/runner/work/ozone/ozone/hadoop-hdds/common/target/classes/network-topology-default.xml]
2024-05-22 06:02:36,230 [main] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchema(176)) - Loading network topology layer schema file
2024-05-22 06:02:36,231 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(134)) - Added a new node: /default-rack/538fad18-9423-4923-af89-affeeeca326d
2024-05-22 06:02:36,231 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(134)) - Added a new node: /default-rack/e1341037-c75b-4919-8761-3d3905548126
2024-05-22 06:02:36,231 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(134)) - Added a new node: /default-rack/f1e8925e-4adf-4b06-bc19-773de55e1a00
2024-05-22 06:02:36,231 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(134)) - Added a new node: /default-rack/17b1feec-7ddb-48a3-b9a0-9f36ae3f6616
2024-05-22 06:02:36,231 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(134)) - Added a new node: /default-rack/82a7d5e1-112c-4002-a32c-e26f5e79cfea
2024-05-22 06:02:36,232 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(134)) - Added a new node: /default-rack/67ab7373-0db8-46a5-a8d5-0f2846728a25
2024-05-22 06:02:36,232 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(134)) - Added a new node: /default-rack/6bd3c7a7-089b-43b7-846a-882469e95d6b
2024-05-22 06:02:36,232 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(134)) - Added a new node: /default-rack/5e9e0448-fcff-4b51-9d3f-ba2850b3be8f
2024-05-22 06:02:36,232 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(134)) - Added a new node: /default-rack/fec21fe0-6184-4dbc-8dc1-e0cb393a463a
2024-05-22 06:02:36,232 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(134)) - Added a new node: /default-rack/30518b50-e9b2-4130-9933-e26799e80dd3
2024-05-22 06:02:36,232 [main] WARN  utils.HAUtils (HAUtils.java:getMetaDir(339)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2024-05-22 06:02:36,233 [main] WARN  db.DBStoreBuilder (DBStoreBuilder.java:applyDBDefinition(171)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2024-05-22 06:02:36,300 [main] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:<init>(241)) - Init the HA SequenceIdGenerator.
2024-05-22 06:02:36,300 [main] INFO  pipeline.PipelineStateManagerImpl (PipelineStateManagerImpl.java:initialize(78)) - No pipeline exists in current db
2024-05-22 06:02:36,300 [main] INFO  algorithms.LeaderChoosePolicyFactory (LeaderChoosePolicyFactory.java:getPolicy(57)) - Create leader choose policy of type org.apache.hadoop.hdds.scm.pipeline.leader.choose.algorithms.MinLeaderCountChoosePolicy
2024-05-22 06:02:36,301 [main] INFO  algorithms.ContainerPlacementPolicyFactory (ContainerPlacementPolicyFactory.java:getPolicyInternal(86)) - Create container placement policy of type org.apache.hadoop.hdds.scm.container.placement.algorithms.SCMContainerPlacementRackScatter
2024-05-22 06:02:36,301 [main] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service BackgroundPipelineCreator.
2024-05-22 06:02:36,301 [main] INFO  pipeline.BackgroundPipelineCreator (BackgroundPipelineCreator.java:start(127)) - Starting RatisPipelineUtilsThread.
2024-05-22 06:02:36,302 [main] INFO  BackgroundPipelineScrubber (BackgroundSCMService.java:start(65)) - Starting BackgroundPipelineScrubber Service.
2024-05-22 06:02:36,303 [main] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service BackgroundPipelineScrubber.
2024-05-22 06:02:36,303 [main] INFO  algorithms.LeaderChoosePolicyFactory (LeaderChoosePolicyFactory.java:getPolicy(57)) - Create leader choose policy of type org.apache.hadoop.hdds.scm.pipeline.leader.choose.algorithms.MinLeaderCountChoosePolicy
2024-05-22 06:02:36,304 [main] INFO  safemode.ContainerSafeModeRule (ContainerSafeModeRule.java:<init>(91)) - containers with one replica threshold count 0
2024-05-22 06:02:36,305 [main] INFO  safemode.HealthyPipelineSafeModeRule (HealthyPipelineSafeModeRule.java:initializeRule(176)) - Total pipeline count is 0, healthy pipeline threshold count is 0
2024-05-22 06:02:36,305 [main] INFO  safemode.OneReplicaPipelineSafeModeRule (OneReplicaPipelineSafeModeRule.java:initializeRule(193)) - Total pipeline count is 0, pipeline's with at least one datanode reported threshold count is 0
2024-05-22 06:02:36,305 [main] WARN  server.ServerUtils (ServerUtils.java:getScmDbDir(143)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2024-05-22 06:02:36,306 [main] WARN  server.ServerUtils (ServerUtils.java:getScmDbDir(143)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2024-05-22 06:02:36,307 [main] INFO  ha.SCMHANodeDetails (SCMHANodeDetails.java:loadSCMHAConfig(207)) - ServiceID for StorageContainerManager is null
2024-05-22 06:02:36,307 [main] INFO  ha.SCMHANodeDetails (SCMHANodeDetails.java:loadSCMHAConfig(212)) - ozone.scm.default.service.id is not defined, falling back to ozone.scm.service.ids to find serviceID for StorageContainerManager if it is HA enabled cluster
2024-05-22 06:02:36,308 [main] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchemaFromFile(129)) - Loading schema from [file:/home/runner/work/ozone/ozone/hadoop-hdds/common/target/classes/network-topology-default.xml]
2024-05-22 06:02:36,308 [main] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchema(176)) - Loading network topology layer schema file
2024-05-22 06:02:36,309 [main] INFO  upgrade.AbstractLayoutVersionManager (AbstractLayoutVersionManager.java:init(83)) - Initializing Layout version manager with metadata layout = HADOOP_PRC_PORTS_IN_DATANODEDETAILS (version = 7), software layout = HADOOP_PRC_PORTS_IN_DATANODEDETAILS (version = 7)
2024-05-22 06:02:36,310 [main] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:upgradeToSequenceId(370)) - upgrade localId to 113750153625600000
2024-05-22 06:02:36,311 [main] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:upgradeToSequenceId(380)) - upgrade delTxnId to 0
2024-05-22 06:02:36,311 [main] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:upgradeToSequenceId(397)) - upgrade containerId to 0
2024-05-22 06:02:36,312 [main] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:upgradeToCertificateSequenceId(444)) - upgrade CertificateId to 2
2024-05-22 06:02:36,312 [main] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:<init>(241)) - Init the HA SequenceIdGenerator.
2024-05-22 06:02:36,313 [main] INFO  algorithms.ContainerPlacementPolicyFactory (ContainerPlacementPolicyFactory.java:getPolicyInternal(86)) - Create container placement policy of type org.apache.hadoop.hdds.scm.container.placement.algorithms.SCMContainerPlacementRackAware
2024-05-22 06:02:36,313 [main] INFO  algorithms.ContainerPlacementPolicyFactory (ContainerPlacementPolicyFactory.java:getPolicyInternal(86)) - Create container placement policy of type org.apache.hadoop.hdds.scm.container.placement.algorithms.SCMContainerPlacementRackScatter
2024-05-22 06:02:36,313 [main] INFO  ExpiredContainerReplicaOpScrubber (BackgroundSCMService.java:start(65)) - Starting ExpiredContainerReplicaOpScrubber Service.
2024-05-22 06:02:36,313 [main] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service ExpiredContainerReplicaOpScrubber.
2024-05-22 06:02:36,314 [main] INFO  algorithms.PipelineChoosePolicyFactory (PipelineChoosePolicyFactory.java:createPipelineChoosePolicyFromClass(80)) - Create pipeline choose policy of type org.apache.hadoop.hdds.scm.pipeline.choose.algorithms.RandomPipelineChoosePolicy
2024-05-22 06:02:36,314 [main] INFO  algorithms.PipelineChoosePolicyFactory (PipelineChoosePolicyFactory.java:createPipelineChoosePolicyFromClass(80)) - Create pipeline choose policy of type org.apache.hadoop.hdds.scm.pipeline.choose.algorithms.RandomPipelineChoosePolicy
2024-05-22 06:02:36,315 [main] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service SCMBlockDeletingService.
2024-05-22 06:02:36,316 [main] INFO  replication.ReplicationManager (ReplicationManager.java:start(296)) - Starting Replication Monitor Thread.
2024-05-22 06:02:36,321 [main] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service ReplicationManager.
2024-05-22 06:02:36,321 [ReplicationMonitor] INFO  replication.ReplicationManager (ReplicationManager.java:processAll(373)) - Replication Manager is not ready to run until 300000ms after safemode exit
2024-05-22 06:02:36,321 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:<init>(440)) - SCM start with adminUsers: [runner]
2024-05-22 06:02:36,322 [main] INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(90)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 10000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false.
2024-05-22 06:02:36,322 [main] INFO  ipc.Server (Server.java:<init>(1287)) - Listener at 0.0.0.0:43851
2024-05-22 06:02:36,322 [Socket Reader #1 for port 0] INFO  ipc.Server (Server.java:run(1323)) - Starting Socket Reader #1 for port 0
2024-05-22 06:02:36,323 [main] INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(90)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 10000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false.
2024-05-22 06:02:36,324 [main] INFO  ipc.Server (Server.java:<init>(1287)) - Listener at 0.0.0.0:33095
2024-05-22 06:02:36,326 [Socket Reader #1 for port 0] INFO  ipc.Server (Server.java:run(1323)) - Starting Socket Reader #1 for port 0
2024-05-22 06:02:36,330 [main] INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(90)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 10000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false.
2024-05-22 06:02:36,330 [main] INFO  ipc.Server (Server.java:<init>(1287)) - Listener at 0.0.0.0:33991
2024-05-22 06:02:36,331 [Socket Reader #1 for port 0] INFO  ipc.Server (Server.java:run(1323)) - Starting Socket Reader #1 for port 0
2024-05-22 06:02:36,337 [main] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service ContainerBalancer.
2024-05-22 06:02:36,340 [main] INFO  ha.SCMContext (SCMContext.java:updateSafeModeStatus(225)) - Update SafeModeStatus from SafeModeStatus{safeModeStatus=false, preCheckPassed=true} to SafeModeStatus{safeModeStatus=false, preCheckPassed=true}.
2024-05-22 06:02:36,342 [main] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(205)) - Sending CreatePipelineCommand for pipeline:PipelineID=67f714a4-0385-48f8-8330-b7db4be65d79 to datanode:6bd3c7a7-089b-43b7-846a-882469e95d6b
2024-05-22 06:02:36,343 [main] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(205)) - Sending CreatePipelineCommand for pipeline:PipelineID=67f714a4-0385-48f8-8330-b7db4be65d79 to datanode:538fad18-9423-4923-af89-affeeeca326d
2024-05-22 06:02:36,343 [main] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(205)) - Sending CreatePipelineCommand for pipeline:PipelineID=67f714a4-0385-48f8-8330-b7db4be65d79 to datanode:5e9e0448-fcff-4b51-9d3f-ba2850b3be8f
2024-05-22 06:02:36,445 [main] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:getNextId(145)) - Allocate a batch for containerId, change lastId from 0 to 1000.
2024-05-22 06:02:36,446 [main] WARN  ha.SequenceIdGenerator (SequenceIdGenerator.java:allocateBatch(258)) - Failed to allocate a batch for localId, expected lastId is 0, actual lastId is 113750153625600000.
2024-05-22 06:02:36,447 [main] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:getNextId(145)) - Allocate a batch for localId, change lastId from 113750153625600000 to 113750153625601000.
2024-05-22 06:02:36,447 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1653)) - Container Balancer is not running.
2024-05-22 06:02:36,447 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stopReplicationManager(1786)) - Stopping Replication Manager Service.
2024-05-22 06:02:36,447 [main] INFO  replication.ReplicationManager (ReplicationManager.java:stop(329)) - Stopping Replication Monitor Thread.
2024-05-22 06:02:36,447 [UnderReplicatedProcessor] WARN  replication.UnhealthyReplicationProcessor (UnhealthyReplicationProcessor.java:run(180)) - UnderReplicatedProcessor interrupted. Exiting...
2024-05-22 06:02:36,447 [ReplicationMonitor] INFO  replication.ReplicationManager (ReplicationManager.java:run(938)) - Replication Monitor Thread is stopped
2024-05-22 06:02:36,447 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1662)) - Stopping the Datanode Admin Monitor.
2024-05-22 06:02:36,447 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1669)) - Stopping datanode service RPC server
2024-05-22 06:02:36,448 [main] INFO  server.SCMDatanodeProtocolServer (SCMDatanodeProtocolServer.java:stop(425)) - Stopping the RPC server for DataNodes
2024-05-22 06:02:36,448 [main] INFO  ipc.Server (Server.java:stop(3523)) - Stopping server on 43851
2024-05-22 06:02:36,448 [OverReplicatedProcessor] WARN  replication.UnhealthyReplicationProcessor (UnhealthyReplicationProcessor.java:run(180)) - OverReplicatedProcessor interrupted. Exiting...
2024-05-22 06:02:36,448 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1677)) - Stopping block service RPC server
2024-05-22 06:02:36,448 [main] INFO  server.SCMBlockProtocolServer (SCMBlockProtocolServer.java:stop(171)) - Stopping the RPC server for Block Protocol
2024-05-22 06:02:36,448 [main] INFO  ipc.Server (Server.java:stop(3523)) - Stopping server on 33095
2024-05-22 06:02:36,449 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1684)) - Stopping the StorageContainerLocationProtocol RPC server
2024-05-22 06:02:36,449 [main] INFO  server.SCMClientProtocolServer (SCMClientProtocolServer.java:stop(213)) - Stopping the RPC server for Client Protocol
2024-05-22 06:02:36,449 [main] INFO  ipc.Server (Server.java:stop(3523)) - Stopping server on 33991
2024-05-22 06:02:36,449 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1691)) - Stopping Storage Container Manager HTTP server.
2024-05-22 06:02:36,449 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1699)) - Stopping SCM LayoutVersionManager Service.
2024-05-22 06:02:36,449 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1711)) - Stopping Block Manager Service.
2024-05-22 06:02:36,449 [main] INFO  utils.BackgroundService (BackgroundService.java:shutdown(160)) - Shutting down service SCMBlockDeletingService
2024-05-22 06:02:36,449 [main] INFO  utils.BackgroundService (BackgroundService.java:shutdown(160)) - Shutting down service SCMBlockDeletingService
2024-05-22 06:02:36,449 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1731)) - Stopping SCM Event Queue.
2024-05-22 06:02:36,450 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1742)) - Stopping SCM HA services.
2024-05-22 06:02:36,450 [main] INFO  pipeline.BackgroundPipelineCreator (BackgroundPipelineCreator.java:stop(152)) - Stopping RatisPipelineUtilsThread.
2024-05-22 06:02:36,450 [RatisPipelineUtilsThread-0] WARN  pipeline.BackgroundPipelineCreator (BackgroundPipelineCreator.java:run(183)) - RatisPipelineUtilsThread is interrupted.
2024-05-22 06:02:36,450 [main] INFO  BackgroundPipelineScrubber (BackgroundSCMService.java:stop(128)) - Stopping BackgroundPipelineScrubber Service.
2024-05-22 06:02:36,450 [BackgroundPipelineScrubber] WARN  BackgroundPipelineScrubber (BackgroundSCMService.java:run(112)) - BackgroundPipelineScrubber is interrupted, exit
2024-05-22 06:02:36,450 [ExpiredContainerReplicaOpScrubber] WARN  ExpiredContainerReplicaOpScrubber (BackgroundSCMService.java:run(112)) - ExpiredContainerReplicaOpScrubber is interrupted, exit
2024-05-22 06:02:36,451 [main] INFO  ExpiredContainerReplicaOpScrubber (BackgroundSCMService.java:stop(128)) - Stopping ExpiredContainerReplicaOpScrubber Service.
2024-05-22 06:02:36,451 [main] INFO  utils.BackgroundService (BackgroundService.java:shutdown(160)) - Shutting down service SCMBlockDeletingService
2024-05-22 06:02:36,451 [main] INFO  replication.ReplicationManager (ReplicationManager.java:stop(339)) - Replication Monitor Thread is not running.
2024-05-22 06:02:36,451 [main] WARN  balancer.ContainerBalancer (ContainerBalancer.java:stop(327)) - Cannot stop Container Balancer because it's not running or stopping
2024-05-22 06:02:36,451 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1777)) - Stopping SCM MetadataStore.
2024-05-22 06:02:36,451 [test-leaseManagerLeaseManager#LeaseMonitor] WARN  lease.LeaseManager (LeaseManager.java:run(287)) - Lease manager is interrupted. Shutting down...
java.lang.InterruptedException
	at java.base/java.util.concurrent.locks.AbstractQueuedSynchronizer.tryAcquireSharedNanos(AbstractQueuedSynchronizer.java:1081)
	at java.base/java.util.concurrent.Semaphore.tryAcquire(Semaphore.java:415)
	at org.apache.hadoop.ozone.lease.LeaseManager$LeaseMonitor.run(LeaseManager.java:285)
	at java.base/java.lang.Thread.run(Thread.java:840)
