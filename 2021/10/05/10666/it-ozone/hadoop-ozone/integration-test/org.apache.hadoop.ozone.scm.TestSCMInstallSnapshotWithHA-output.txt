2021-10-05 13:23:27,702 [main] WARN  server.ServerUtils (ServerUtils.java:getScmDbDir(148)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2021-10-05 13:23:27,729 [main] INFO  ha.SCMHANodeDetails (SCMHANodeDetails.java:loadSCMHAConfig(157)) - ServiceID for StorageContainerManager is scm-service-test1
2021-10-05 13:23:27,730 [main] INFO  ha.SCMHANodeDetails (SCMHANodeDetails.java:loadSCMHAConfig(168)) - ServiceID for StorageContainerManager is scm-service-test1
2021-10-05 13:23:27,798 [main] WARN  scm.ScmUtils (ScmUtils.java:logWarn(179)) - ConfigKey ozone.scm.block.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.block.client.port appended with serviceId and nodeId. If want to configure same port configure ozone.scm.block.client.port
2021-10-05 13:23:27,799 [main] WARN  scm.ScmUtils (ScmUtils.java:logWarn(179)) - ConfigKey ozone.scm.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.client.port appended with serviceId and nodeId. If want to configure same port configure ozone.scm.client.port
2021-10-05 13:23:27,799 [main] WARN  scm.ScmUtils (ScmUtils.java:logWarn(179)) - ConfigKey ozone.scm.datanode.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.datanode.port appended with serviceId and nodeId. If want to configure same port configure ozone.scm.datanode.port
2021-10-05 13:23:27,801 [main] WARN  scm.ScmUtils (ScmUtils.java:logWarn(179)) - ConfigKey ozone.scm.block.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.block.client.port appended with serviceId and nodeId. If want to configure same port configure ozone.scm.block.client.port
2021-10-05 13:23:27,802 [main] WARN  scm.ScmUtils (ScmUtils.java:logWarn(179)) - ConfigKey ozone.scm.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.client.port appended with serviceId and nodeId. If want to configure same port configure ozone.scm.client.port
2021-10-05 13:23:27,802 [main] WARN  scm.ScmUtils (ScmUtils.java:logWarn(179)) - ConfigKey ozone.scm.datanode.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.datanode.port appended with serviceId and nodeId. If want to configure same port configure ozone.scm.datanode.port
2021-10-05 13:23:27,802 [main] INFO  ha.SCMHANodeDetails (SCMHANodeDetails.java:loadSCMHAConfig(250)) - Found matching SCM address with SCMServiceId: scm-service-test1, SCMNodeId: scmNode-1, RPC Address: localhost:15020 and Ratis port: 15020
2021-10-05 13:23:27,802 [main] INFO  ha.SCMHANodeDetails (ConfUtils.java:setNodeSpecificConfigs(108)) - Setting configuration key ozone.scm.datanode.address with value of key ozone.scm.datanode.address.scm-service-test1.scmNode-1: 127.0.0.1:15021
2021-10-05 13:23:27,803 [main] INFO  ha.SCMHANodeDetails (ConfUtils.java:setNodeSpecificConfigs(108)) - Setting configuration key ozone.scm.block.client.address with value of key ozone.scm.block.client.address.scm-service-test1.scmNode-1: 127.0.0.1:15022
2021-10-05 13:23:27,803 [main] INFO  ha.SCMHANodeDetails (ConfUtils.java:setNodeSpecificConfigs(108)) - Setting configuration key ozone.scm.client.address with value of key ozone.scm.client.address.scm-service-test1.scmNode-1: 127.0.0.1:15023
2021-10-05 13:23:27,803 [main] INFO  ha.SCMHANodeDetails (ConfUtils.java:setNodeSpecificConfigs(108)) - Setting configuration key ozone.scm.ratis.port with value of key ozone.scm.ratis.port.scm-service-test1.scmNode-1: 15020
2021-10-05 13:23:27,803 [main] INFO  ha.SCMHANodeDetails (ConfUtils.java:setNodeSpecificConfigs(108)) - Setting configuration key ozone.scm.grpc.port with value of key ozone.scm.grpc.port.scm-service-test1.scmNode-1: 15024
2021-10-05 13:23:27,804 [main] INFO  ha.SCMHANodeDetails (ConfUtils.java:setNodeSpecificConfigs(108)) - Setting configuration key ozone.scm.http-address with value of key ozone.scm.http-address.scm-service-test1.scmNode-1: 127.0.0.1:15018
2021-10-05 13:23:27,805 [main] INFO  ha.SCMHANodeDetails (ConfUtils.java:setNodeSpecificConfigs(108)) - Setting configuration key ozone.scm.https-address with value of key ozone.scm.https-address.scm-service-test1.scmNode-1: 127.0.0.1:15019
2021-10-05 13:23:27,805 [main] INFO  ha.SCMHANodeDetails (ConfUtils.java:setNodeSpecificConfigs(108)) - Setting configuration key ozone.scm.address with value of key ozone.scm.address.scm-service-test1.scmNode-1: 127.0.0.1
2021-10-05 13:23:27,805 [main] WARN  scm.ScmUtils (ScmUtils.java:logWarn(179)) - ConfigKey ozone.scm.block.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.block.client.port appended with serviceId and nodeId. If want to configure same port configure ozone.scm.block.client.port
2021-10-05 13:23:27,806 [main] WARN  scm.ScmUtils (ScmUtils.java:logWarn(179)) - ConfigKey ozone.scm.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.client.port appended with serviceId and nodeId. If want to configure same port configure ozone.scm.client.port
2021-10-05 13:23:27,806 [main] WARN  scm.ScmUtils (ScmUtils.java:logWarn(179)) - ConfigKey ozone.scm.datanode.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.datanode.port appended with serviceId and nodeId. If want to configure same port configure ozone.scm.datanode.port
2021-10-05 13:23:27,895 [main] INFO  server.RaftServer (ConfUtils.java:logGet(44)) - raft.rpc.type = GRPC (default)
2021-10-05 13:23:27,983 [main] INFO  grpc.GrpcFactory (GrpcFactory.java:checkPooledByteBufAllocatorUseCacheForAllThreads(48)) - PERFORMANCE WARNING: useCacheForAllThreads is true that may cause Netty to create a lot garbage objects and, as a result, trigger GC.
	It is recommended to disable useCacheForAllThreads by setting -Dorg.apache.ratis.thirdparty.io.netty.allocator.useCacheForAllThreads=false in command line.
2021-10-05 13:23:27,990 [main] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(44)) - raft.grpc.admin.port = -1 (default)
2021-10-05 13:23:27,991 [main] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(44)) - raft.grpc.server.port = 15020 (custom)
2021-10-05 13:23:27,992 [main] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(44)) - raft.grpc.client.port = -1 (default)
2021-10-05 13:23:27,993 [main] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(44)) - raft.grpc.server.port = 15020 (custom)
2021-10-05 13:23:27,994 [main] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(44)) - raft.grpc.server.port = 15020 (custom)
2021-10-05 13:23:27,995 [main] INFO  server.GrpcService (ConfUtils.java:logGet(44)) - raft.grpc.message.size.max = 32m (=33554432) (custom)
2021-10-05 13:23:27,998 [main] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2021-10-05 13:23:27,998 [main] INFO  server.GrpcService (ConfUtils.java:logGet(44)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2021-10-05 13:23:28,000 [main] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.request.timeout = 30000ms (custom)
2021-10-05 13:23:28,357 [main] INFO  impl.DataStreamServerImpl (ConfUtils.java:logGet(44)) - raft.datastream.type = DISABLED (default)
2021-10-05 13:23:28,359 [main] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.slowness.timeout = 120000ms (custom)
2021-10-05 13:23:28,360 [main] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.leaderelection.leader.step-down.wait-time = 10s (default)
2021-10-05 13:23:28,375 [main] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.storage.dir = [/home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-98f4f1fb-613f-4a4a-83a3-c748f4b4520d/scmNode-1/scm-ha] (custom)
2021-10-05 13:23:28,383 [main] INFO  server.RaftServer (RaftServerProxy.java:addNew(95)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0: addNew group-C748F4B4520D:[a4bffdee-6562-4179-bbcd-2dfbb5550fc0|rpc:localhost:15020|priority:0] returns group-C748F4B4520D:java.util.concurrent.CompletableFuture@4bee18dc[Not completed]
2021-10-05 13:23:28,399 [pool-1-thread-1] INFO  server.RaftServer$Division (RaftServerImpl.java:<init>(181)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0: new RaftServerImpl for group-C748F4B4520D:[a4bffdee-6562-4179-bbcd-2dfbb5550fc0|rpc:localhost:15020|priority:0] with SCMStateMachine:uninitialized
2021-10-05 13:23:28,401 [pool-1-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.timeout.min = 5000ms (custom)
2021-10-05 13:23:28,401 [pool-1-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.timeout.max = 5200ms (custom)
2021-10-05 13:23:28,401 [pool-1-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.sleep.time = 25ms (default)
2021-10-05 13:23:28,401 [pool-1-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.slowness.timeout = 120000ms (custom)
2021-10-05 13:23:28,402 [pool-1-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.leaderelection.leader.step-down.wait-time = 10s (default)
2021-10-05 13:23:28,402 [pool-1-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.sleep.deviation.threshold = 300ms (default)
2021-10-05 13:23:28,403 [pool-1-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.appender.install.snapshot.enabled = false (custom)
2021-10-05 13:23:28,408 [pool-1-thread-1] INFO  server.RaftServer$Division (ServerState.java:<init>(105)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D: ConfigurationManager, init=-1: [a4bffdee-6562-4179-bbcd-2dfbb5550fc0|rpc:localhost:15020|priority:0], old=null, confs=<EMPTY_MAP>
2021-10-05 13:23:28,408 [pool-1-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.storage.dir = [/home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-98f4f1fb-613f-4a4a-83a3-c748f4b4520d/scmNode-1/scm-ha] (custom)
2021-10-05 13:23:28,416 [pool-1-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.corruption.policy = EXCEPTION (default)
2021-10-05 13:23:28,418 [pool-1-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.storage.free-space.min = 0MB (=0) (default)
2021-10-05 13:23:28,419 [pool-1-thread-1] INFO  storage.RaftStorageDirectory (RaftStorageDirectoryImpl.java:analyzeStorage(135)) - The storage directory /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-98f4f1fb-613f-4a4a-83a3-c748f4b4520d/scmNode-1/scm-ha/98f4f1fb-613f-4a4a-83a3-c748f4b4520d does not exist. Creating ...
2021-10-05 13:23:28,435 [pool-1-thread-1] INFO  storage.RaftStorageDirectory (RaftStorageDirectoryImpl.java:tryLock(230)) - Lock on /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-98f4f1fb-613f-4a4a-83a3-c748f4b4520d/scmNode-1/scm-ha/98f4f1fb-613f-4a4a-83a3-c748f4b4520d/in_use.lock acquired by nodename 17451@fv-az270-324
2021-10-05 13:23:28,442 [pool-1-thread-1] INFO  storage.RaftStorage (RaftStorageImpl.java:format(89)) - Storage directory /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-98f4f1fb-613f-4a4a-83a3-c748f4b4520d/scmNode-1/scm-ha/98f4f1fb-613f-4a4a-83a3-c748f4b4520d has been successfully formatted.
2021-10-05 13:23:28,445 [pool-1-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.notification.no-leader.timeout = 60s (default)
2021-10-05 13:23:28,447 [pool-1-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.use.memory = false (default)
2021-10-05 13:23:28,454 [pool-1-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.purge.gap = 5 (custom)
2021-10-05 13:23:28,455 [pool-1-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2021-10-05 13:23:28,462 [pool-1-thread-1] INFO  metrics.MetricRegistries (MetricRegistriesLoader.java:load(64)) - Loaded MetricRegistries class org.apache.ratis.metrics.impl.MetricRegistriesImpl
2021-10-05 13:23:28,526 [pool-1-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.segment.size.max = 16384 (custom)
2021-10-05 13:23:28,533 [pool-1-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.segment.cache.num.max = 2 (custom)
2021-10-05 13:23:28,534 [pool-1-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.segment.cache.size.max = 200MB (=209715200) (default)
2021-10-05 13:23:28,539 [pool-1-thread-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:<init>(182)) - new a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-SegmentedRaftLogWorker for RaftStorageImpl:Storage Directory /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-98f4f1fb-613f-4a4a-83a3-c748f4b4520d/scmNode-1/scm-ha/98f4f1fb-613f-4a4a-83a3-c748f4b4520d
2021-10-05 13:23:28,539 [pool-1-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.queue.byte-limit = 64MB (=67108864) (default)
2021-10-05 13:23:28,540 [pool-1-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.queue.element-limit = 4096 (default)
2021-10-05 13:23:28,541 [pool-1-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.segment.size.max = 16384 (custom)
2021-10-05 13:23:28,541 [pool-1-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.preallocated.size = 16384 (custom)
2021-10-05 13:23:28,541 [pool-1-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.force.sync.num = 128 (default)
2021-10-05 13:23:28,542 [pool-1-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.statemachine.data.sync = true (default)
2021-10-05 13:23:28,542 [pool-1-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2021-10-05 13:23:28,543 [pool-1-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2021-10-05 13:23:28,549 [pool-1-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.write.buffer.size = 64KB (=65536) (default)
2021-10-05 13:23:28,550 [pool-1-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.statemachine.data.caching.enabled = false (default)
2021-10-05 13:23:28,555 [pool-1-thread-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:lambda$new$0(133)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-SegmentedRaftLogWorker: flushIndex: setUnconditionally 0 -> -1
2021-10-05 13:23:28,555 [pool-1-thread-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:lambda$new$0(133)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-SegmentedRaftLogWorker: safeCacheEvictIndex: setUnconditionally 0 -> -1
2021-10-05 13:23:28,559 [pool-1-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2021-10-05 13:23:28,559 [pool-1-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.snapshot.auto.trigger.threshold = 5 (custom)
2021-10-05 13:23:28,560 [pool-1-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.snapshot.retention.file.num = -1 (default)
2021-10-05 13:23:28,561 [pool-1-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.purge.upto.snapshot.index = true (custom)
2021-10-05 13:23:28,562 [pool-1-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.retrycache.expirytime = 60000ms (default)
2021-10-05 13:23:28,562 [pool-1-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.retrycache.statistics.expirytime = 100μs (default)
2021-10-05 13:23:28,599 [main] INFO  server.RaftServer$Division (RaftServerImpl.java:start(296)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D: start as a follower, conf=-1: [a4bffdee-6562-4179-bbcd-2dfbb5550fc0|rpc:localhost:15020|priority:0], old=null
2021-10-05 13:23:28,601 [main] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(285)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D: changes role from      null to FOLLOWER at term 0 for startAsFollower
2021-10-05 13:23:28,602 [main] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(130)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0: start a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-FollowerState
2021-10-05 13:23:28,604 [main] INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-C748F4B4520D,id=a4bffdee-6562-4179-bbcd-2dfbb5550fc0
2021-10-05 13:23:28,607 [main] INFO  server.RaftServer (RaftServerProxy.java:lambda$start$5(374)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0: start RPC server
2021-10-05 13:23:28,668 [main] INFO  server.GrpcService (GrpcService.java:startImpl(253)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0: GrpcService started, listening on 15020
2021-10-05 13:23:28,672 [org.apache.ratis.util.JvmPauseMonitor$$Lambda$499/1586779822@16a9a4f1] INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(103)) - JvmPauseMonitor-a4bffdee-6562-4179-bbcd-2dfbb5550fc0: Started
2021-10-05 13:23:33,739 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-FollowerState] INFO  impl.FollowerState (FollowerState.java:run(134)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-FollowerState: change to CANDIDATE, lastRpcElapsedTime:5136929582ns, electionTimeout:5130ms
2021-10-05 13:23:33,741 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-FollowerState] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(108)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0: shutdown a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-FollowerState
2021-10-05 13:23:33,741 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-FollowerState] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(285)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D: changes role from  FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2021-10-05 13:23:33,747 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-FollowerState] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.leaderelection.pre-vote = false (custom)
2021-10-05 13:23:33,747 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-FollowerState] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(130)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0: start a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-LeaderElection1
2021-10-05 13:23:33,756 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-LeaderElection1] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(306)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-LeaderElection1 ELECTION round 0: submit vote requests at term 1 for -1: [a4bffdee-6562-4179-bbcd-2dfbb5550fc0|rpc:localhost:15020|priority:0], old=null
2021-10-05 13:23:33,757 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-LeaderElection1] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(308)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-LeaderElection1 ELECTION round 0: result PASSED (term=1)
2021-10-05 13:23:33,758 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-LeaderElection1] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(121)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0: shutdown a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-LeaderElection1
2021-10-05 13:23:33,758 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-LeaderElection1] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(285)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D: changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2021-10-05 13:23:33,758 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-LeaderElection1] INFO  server.RaftServer$Division (ServerState.java:setLeader(285)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D: change Leader from null to a4bffdee-6562-4179-bbcd-2dfbb5550fc0 at term 1 for becomeLeader, leader elected after 5313ms
2021-10-05 13:23:33,764 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-LeaderElection1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.staging.catchup.gap = 1000 (default)
2021-10-05 13:23:33,769 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-LeaderElection1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.write.element-limit = 4096 (default)
2021-10-05 13:23:33,770 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-LeaderElection1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.write.byte-limit = 64MB (=67108864) (default)
2021-10-05 13:23:33,777 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-LeaderElection1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.watch.timeout = 10s (default)
2021-10-05 13:23:33,777 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-LeaderElection1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.watch.timeout.denomination = 1s (default)
2021-10-05 13:23:33,778 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-LeaderElection1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.watch.element-limit = 65536 (default)
2021-10-05 13:23:33,784 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-LeaderElection1] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(130)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0: start a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-LeaderStateImpl
2021-10-05 13:23:33,808 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-LeaderElection1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:startLogSegment(394)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-SegmentedRaftLogWorker: Starting segment from index:0
2021-10-05 13:23:33,877 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-LeaderElection1] INFO  server.RaftServer$Division (ServerState.java:setRaftConf(387)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D: set configuration 0: [a4bffdee-6562-4179-bbcd-2dfbb5550fc0|rpc:localhost:15020|admin:|client:|dataStream:|priority:0], old=null
2021-10-05 13:23:33,886 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(601)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-SegmentedRaftLogWorker: created new log segment /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-98f4f1fb-613f-4a4a-83a3-c748f4b4520d/scmNode-1/scm-ha/98f4f1fb-613f-4a4a-83a3-c748f4b4520d/current/log_inprogress_0
2021-10-05 13:23:34,674 [main] INFO  server.RaftServer (RaftServerProxy.java:lambda$close$6(391)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0: close
2021-10-05 13:23:34,676 [main] INFO  server.RaftServer$Division (RaftServerImpl.java:lambda$close$4(407)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D: shutdown
2021-10-05 13:23:34,676 [main] INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-C748F4B4520D,id=a4bffdee-6562-4179-bbcd-2dfbb5550fc0
2021-10-05 13:23:34,677 [main] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(91)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0: shutdown a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-LeaderStateImpl
2021-10-05 13:23:34,685 [main] INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(282)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-PendingRequests: sendNotLeaderResponses
2021-10-05 13:23:34,687 [main] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(149)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater: set stopIndex = 0
2021-10-05 13:23:34,688 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:takeSnapshot(281)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater: Took a snapshot at index 0
2021-10-05 13:23:34,688 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:lambda$new$0(89)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater: snapshotIndex: updateIncreasingly -1 -> 0
2021-10-05 13:23:34,688 [main] INFO  server.RaftServer$Division (ServerState.java:close(419)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D: closes. applyIndex: 0
2021-10-05 13:23:34,690 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:run(327)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-SegmentedRaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2021-10-05 13:23:34,690 [main] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:close(237)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-SegmentedRaftLogWorker close()
2021-10-05 13:23:34,692 [main] INFO  server.GrpcService (GrpcService.java:closeImpl(262)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0: shutdown server with port 15020 now
2021-10-05 13:23:34,700 [main] INFO  server.GrpcService (GrpcService.java:closeImpl(271)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0: shutdown server with port 15020 successfully
2021-10-05 13:23:34,700 [org.apache.ratis.util.JvmPauseMonitor$$Lambda$499/1586779822@16a9a4f1] INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(109)) - JvmPauseMonitor-a4bffdee-6562-4179-bbcd-2dfbb5550fc0: Stopped
2021-10-05 13:23:34,700 [main] WARN  server.ServerUtils (ServerUtils.java:getScmDbDir(148)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2021-10-05 13:23:34,703 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:scmInit(1083)) - SCM initialization succeeded. Current cluster id for sd=/home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-98f4f1fb-613f-4a4a-83a3-c748f4b4520d/scmNode-1/scm; cid=98f4f1fb-613f-4a4a-83a3-c748f4b4520d; layoutVersion=2; scmId=a4bffdee-6562-4179-bbcd-2dfbb5550fc0
2021-10-05 13:23:34,711 [main] INFO  ha.SCMHANodeDetails (SCMHANodeDetails.java:loadSCMHAConfig(157)) - ServiceID for StorageContainerManager is scm-service-test1
2021-10-05 13:23:34,712 [main] INFO  ha.SCMHANodeDetails (SCMHANodeDetails.java:loadSCMHAConfig(168)) - ServiceID for StorageContainerManager is scm-service-test1
2021-10-05 13:23:34,712 [main] WARN  scm.ScmUtils (ScmUtils.java:logWarn(179)) - ConfigKey ozone.scm.block.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.block.client.port appended with serviceId and nodeId. If want to configure same port configure ozone.scm.block.client.port
2021-10-05 13:23:34,712 [main] WARN  scm.ScmUtils (ScmUtils.java:logWarn(179)) - ConfigKey ozone.scm.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.client.port appended with serviceId and nodeId. If want to configure same port configure ozone.scm.client.port
2021-10-05 13:23:34,713 [main] WARN  scm.ScmUtils (ScmUtils.java:logWarn(179)) - ConfigKey ozone.scm.datanode.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.datanode.port appended with serviceId and nodeId. If want to configure same port configure ozone.scm.datanode.port
2021-10-05 13:23:34,713 [main] WARN  scm.ScmUtils (ScmUtils.java:logWarn(179)) - ConfigKey ozone.scm.block.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.block.client.port appended with serviceId and nodeId. If want to configure same port configure ozone.scm.block.client.port
2021-10-05 13:23:34,713 [main] WARN  scm.ScmUtils (ScmUtils.java:logWarn(179)) - ConfigKey ozone.scm.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.client.port appended with serviceId and nodeId. If want to configure same port configure ozone.scm.client.port
2021-10-05 13:23:34,714 [main] WARN  scm.ScmUtils (ScmUtils.java:logWarn(179)) - ConfigKey ozone.scm.datanode.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.datanode.port appended with serviceId and nodeId. If want to configure same port configure ozone.scm.datanode.port
2021-10-05 13:23:34,714 [main] INFO  ha.SCMHANodeDetails (SCMHANodeDetails.java:loadSCMHAConfig(250)) - Found matching SCM address with SCMServiceId: scm-service-test1, SCMNodeId: scmNode-1, RPC Address: localhost:15020 and Ratis port: 15020
2021-10-05 13:23:34,714 [main] INFO  ha.SCMHANodeDetails (ConfUtils.java:setNodeSpecificConfigs(108)) - Setting configuration key ozone.scm.datanode.address with value of key ozone.scm.datanode.address.scm-service-test1.scmNode-1: 127.0.0.1:15021
2021-10-05 13:23:34,714 [main] INFO  ha.SCMHANodeDetails (ConfUtils.java:setNodeSpecificConfigs(108)) - Setting configuration key ozone.scm.block.client.address with value of key ozone.scm.block.client.address.scm-service-test1.scmNode-1: 127.0.0.1:15022
2021-10-05 13:23:34,715 [main] INFO  ha.SCMHANodeDetails (ConfUtils.java:setNodeSpecificConfigs(108)) - Setting configuration key ozone.scm.client.address with value of key ozone.scm.client.address.scm-service-test1.scmNode-1: 127.0.0.1:15023
2021-10-05 13:23:34,715 [main] INFO  ha.SCMHANodeDetails (ConfUtils.java:setNodeSpecificConfigs(108)) - Setting configuration key ozone.scm.ratis.port with value of key ozone.scm.ratis.port.scm-service-test1.scmNode-1: 15020
2021-10-05 13:23:34,715 [main] INFO  ha.SCMHANodeDetails (ConfUtils.java:setNodeSpecificConfigs(108)) - Setting configuration key ozone.scm.grpc.port with value of key ozone.scm.grpc.port.scm-service-test1.scmNode-1: 15024
2021-10-05 13:23:34,715 [main] INFO  ha.SCMHANodeDetails (ConfUtils.java:setNodeSpecificConfigs(108)) - Setting configuration key ozone.scm.http-address with value of key ozone.scm.http-address.scm-service-test1.scmNode-1: 127.0.0.1:15018
2021-10-05 13:23:34,715 [main] INFO  ha.SCMHANodeDetails (ConfUtils.java:setNodeSpecificConfigs(108)) - Setting configuration key ozone.scm.https-address with value of key ozone.scm.https-address.scm-service-test1.scmNode-1: 127.0.0.1:15019
2021-10-05 13:23:34,715 [main] INFO  ha.SCMHANodeDetails (ConfUtils.java:setNodeSpecificConfigs(108)) - Setting configuration key ozone.scm.address with value of key ozone.scm.address.scm-service-test1.scmNode-1: 127.0.0.1
2021-10-05 13:23:34,716 [main] WARN  scm.ScmUtils (ScmUtils.java:logWarn(179)) - ConfigKey ozone.scm.block.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.block.client.port appended with serviceId and nodeId. If want to configure same port configure ozone.scm.block.client.port
2021-10-05 13:23:34,716 [main] WARN  scm.ScmUtils (ScmUtils.java:logWarn(179)) - ConfigKey ozone.scm.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.client.port appended with serviceId and nodeId. If want to configure same port configure ozone.scm.client.port
2021-10-05 13:23:34,716 [main] WARN  scm.ScmUtils (ScmUtils.java:logWarn(179)) - ConfigKey ozone.scm.datanode.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.datanode.port appended with serviceId and nodeId. If want to configure same port configure ozone.scm.datanode.port
2021-10-05 13:23:34,738 [main] WARN  server.ServerUtils (ServerUtils.java:getScmDbDir(148)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2021-10-05 13:23:34,740 [main] INFO  upgrade.AbstractLayoutVersionManager (AbstractLayoutVersionManager.java:init(79)) - Initializing Layout version manager with metadata layout = SCM_HA (version = 2), software layout = SCM_HA (version = 2)
2021-10-05 13:23:34,880 [main] INFO  reflections.Reflections (Reflections.java:scan(232)) - Reflections took 111 ms to scan 7 urls, producing 119 keys and 275 values 
2021-10-05 13:23:35,373 [main] WARN  utils.HAUtils (HAUtils.java:getMetaDir(342)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2021-10-05 13:23:35,495 [main] WARN  db.DBStoreBuilder (DBStoreBuilder.java:applyDBDefinition(145)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2021-10-05 13:23:35,631 [main] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchemaFromFile(129)) - Loading schema from [jar:file:/home/runner/.m2/repository/org/apache/ozone/hdds-common/1.2.0-SNAPSHOT/hdds-common-1.2.0-SNAPSHOT.jar!/network-topology-default.xml]
2021-10-05 13:23:35,632 [main] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchema(176)) - Loading network topology layer schema file
2021-10-05 13:23:35,671 [main] INFO  ha.SCMRatisServerImpl (SCMRatisServerImpl.java:<init>(87)) - starting Raft server for scm:a4bffdee-6562-4179-bbcd-2dfbb5550fc0
2021-10-05 13:23:35,675 [main] INFO  server.RaftServer (ConfUtils.java:logGet(44)) - raft.rpc.type = GRPC (default)
2021-10-05 13:23:35,675 [main] INFO  grpc.GrpcFactory (GrpcFactory.java:checkPooledByteBufAllocatorUseCacheForAllThreads(48)) - PERFORMANCE WARNING: useCacheForAllThreads is true that may cause Netty to create a lot garbage objects and, as a result, trigger GC.
	It is recommended to disable useCacheForAllThreads by setting -Dorg.apache.ratis.thirdparty.io.netty.allocator.useCacheForAllThreads=false in command line.
2021-10-05 13:23:35,676 [main] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(44)) - raft.grpc.admin.port = -1 (default)
2021-10-05 13:23:35,676 [main] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(44)) - raft.grpc.server.port = 15020 (custom)
2021-10-05 13:23:35,676 [main] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(44)) - raft.grpc.client.port = -1 (default)
2021-10-05 13:23:35,676 [main] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(44)) - raft.grpc.server.port = 15020 (custom)
2021-10-05 13:23:35,677 [main] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(44)) - raft.grpc.server.port = 15020 (custom)
2021-10-05 13:23:35,677 [main] INFO  server.GrpcService (ConfUtils.java:logGet(44)) - raft.grpc.message.size.max = 32m (=33554432) (custom)
2021-10-05 13:23:35,677 [main] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2021-10-05 13:23:35,677 [main] INFO  server.GrpcService (ConfUtils.java:logGet(44)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2021-10-05 13:23:35,678 [main] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.request.timeout = 30000ms (custom)
2021-10-05 13:23:35,679 [main] INFO  impl.DataStreamServerImpl (ConfUtils.java:logGet(44)) - raft.datastream.type = DISABLED (default)
2021-10-05 13:23:35,680 [main] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.slowness.timeout = 120000ms (custom)
2021-10-05 13:23:35,680 [main] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.leaderelection.leader.step-down.wait-time = 10s (default)
2021-10-05 13:23:35,680 [main] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.storage.dir = [/home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-98f4f1fb-613f-4a4a-83a3-c748f4b4520d/scmNode-1/scm-ha] (custom)
2021-10-05 13:23:35,680 [main] INFO  server.RaftServer (RaftServerProxy.java:lambda$null$1(235)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0: found a subdirectory /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-98f4f1fb-613f-4a4a-83a3-c748f4b4520d/scmNode-1/scm-ha/98f4f1fb-613f-4a4a-83a3-c748f4b4520d
2021-10-05 13:23:35,681 [main] INFO  server.RaftServer (RaftServerProxy.java:addNew(95)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0: addNew group-C748F4B4520D:[] returns group-C748F4B4520D:java.util.concurrent.CompletableFuture@6d6bff89[Not completed]
2021-10-05 13:23:35,684 [pool-16-thread-1] INFO  server.RaftServer$Division (RaftServerImpl.java:<init>(181)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0: new RaftServerImpl for group-C748F4B4520D:[] with SCMStateMachine:uninitialized
2021-10-05 13:23:35,684 [pool-16-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.timeout.min = 5000ms (custom)
2021-10-05 13:23:35,685 [pool-16-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.timeout.max = 5200ms (custom)
2021-10-05 13:23:35,685 [pool-16-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.sleep.time = 25ms (default)
2021-10-05 13:23:35,685 [pool-16-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.slowness.timeout = 120000ms (custom)
2021-10-05 13:23:35,685 [pool-16-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.leaderelection.leader.step-down.wait-time = 10s (default)
2021-10-05 13:23:35,685 [pool-16-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.sleep.deviation.threshold = 300ms (default)
2021-10-05 13:23:35,685 [pool-16-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.appender.install.snapshot.enabled = false (custom)
2021-10-05 13:23:35,685 [pool-16-thread-1] INFO  server.RaftServer$Division (ServerState.java:<init>(105)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D: ConfigurationManager, init=-1: [], old=null, confs=<EMPTY_MAP>
2021-10-05 13:23:35,686 [pool-16-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.storage.dir = [/home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-98f4f1fb-613f-4a4a-83a3-c748f4b4520d/scmNode-1/scm-ha] (custom)
2021-10-05 13:23:35,686 [pool-16-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.corruption.policy = EXCEPTION (default)
2021-10-05 13:23:35,686 [pool-16-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.storage.free-space.min = 0MB (=0) (default)
2021-10-05 13:23:35,687 [pool-16-thread-1] INFO  storage.RaftStorageDirectory (RaftStorageDirectoryImpl.java:tryLock(230)) - Lock on /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-98f4f1fb-613f-4a4a-83a3-c748f4b4520d/scmNode-1/scm-ha/98f4f1fb-613f-4a4a-83a3-c748f4b4520d/in_use.lock acquired by nodename 17451@fv-az270-324
2021-10-05 13:23:35,688 [pool-16-thread-1] INFO  storage.RaftStorage (RaftStorageImpl.java:analyzeAndRecoverStorage(110)) - Read RaftStorageMetadata{term=1, votedFor=a4bffdee-6562-4179-bbcd-2dfbb5550fc0} from /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-98f4f1fb-613f-4a4a-83a3-c748f4b4520d/scmNode-1/scm-ha/98f4f1fb-613f-4a4a-83a3-c748f4b4520d/current/raft-meta
2021-10-05 13:23:35,697 [pool-16-thread-1] INFO  server.RaftServer$Division (ServerState.java:setRaftConf(387)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D: set configuration 0: [a4bffdee-6562-4179-bbcd-2dfbb5550fc0|rpc:localhost:15020|admin:|client:|dataStream:|priority:0], old=null
2021-10-05 13:23:35,698 [pool-16-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.notification.no-leader.timeout = 60s (default)
2021-10-05 13:23:35,698 [pool-16-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.use.memory = false (default)
2021-10-05 13:23:35,698 [pool-16-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.purge.gap = 5 (custom)
2021-10-05 13:23:35,698 [pool-16-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2021-10-05 13:23:35,700 [pool-16-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.segment.size.max = 16384 (custom)
2021-10-05 13:23:35,701 [pool-16-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.segment.cache.num.max = 2 (custom)
2021-10-05 13:23:35,701 [pool-16-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.segment.cache.size.max = 200MB (=209715200) (default)
2021-10-05 13:23:35,701 [pool-16-thread-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:<init>(182)) - new a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-SegmentedRaftLogWorker for RaftStorageImpl:Storage Directory /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-98f4f1fb-613f-4a4a-83a3-c748f4b4520d/scmNode-1/scm-ha/98f4f1fb-613f-4a4a-83a3-c748f4b4520d
2021-10-05 13:23:35,701 [pool-16-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.queue.byte-limit = 64MB (=67108864) (default)
2021-10-05 13:23:35,701 [pool-16-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.queue.element-limit = 4096 (default)
2021-10-05 13:23:35,702 [pool-16-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.segment.size.max = 16384 (custom)
2021-10-05 13:23:35,702 [pool-16-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.preallocated.size = 16384 (custom)
2021-10-05 13:23:35,702 [pool-16-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.force.sync.num = 128 (default)
2021-10-05 13:23:35,702 [pool-16-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.statemachine.data.sync = true (default)
2021-10-05 13:23:35,702 [pool-16-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2021-10-05 13:23:35,702 [pool-16-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2021-10-05 13:23:35,703 [pool-16-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.write.buffer.size = 64KB (=65536) (default)
2021-10-05 13:23:35,703 [pool-16-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.statemachine.data.caching.enabled = false (default)
2021-10-05 13:23:35,708 [pool-16-thread-1] INFO  server.RaftServer$Division (ServerState.java:setRaftConf(387)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D: set configuration 0: [a4bffdee-6562-4179-bbcd-2dfbb5550fc0|rpc:localhost:15020|admin:|client:|dataStream:|priority:0], old=null
2021-10-05 13:23:35,709 [pool-16-thread-1] INFO  segmented.LogSegment (LogSegment.java:loadSegment(173)) - Successfully read 1 entries from segment file /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-98f4f1fb-613f-4a4a-83a3-c748f4b4520d/scmNode-1/scm-ha/98f4f1fb-613f-4a4a-83a3-c748f4b4520d/current/log_inprogress_0
2021-10-05 13:23:35,709 [pool-16-thread-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:lambda$new$0(133)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-SegmentedRaftLogWorker: flushIndex: setUnconditionally 0 -> 0
2021-10-05 13:23:35,709 [pool-16-thread-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:lambda$new$0(133)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-SegmentedRaftLogWorker: safeCacheEvictIndex: setUnconditionally 0 -> -1
2021-10-05 13:23:35,711 [pool-16-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2021-10-05 13:23:35,711 [pool-16-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.snapshot.auto.trigger.threshold = 5 (custom)
2021-10-05 13:23:35,711 [pool-16-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.snapshot.retention.file.num = -1 (default)
2021-10-05 13:23:35,711 [pool-16-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.purge.upto.snapshot.index = true (custom)
2021-10-05 13:23:35,711 [pool-16-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.retrycache.expirytime = 60000ms (default)
2021-10-05 13:23:35,712 [pool-16-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.retrycache.statistics.expirytime = 100μs (default)
2021-10-05 13:23:35,714 [main] INFO  ha.SCMSnapshotProvider (SCMSnapshotProvider.java:<init>(66)) - Initializing SCM Snapshot Provider
2021-10-05 13:23:35,714 [main] WARN  server.ServerUtils (ServerUtils.java:getDefaultRatisDirectory(237)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2021-10-05 13:23:35,714 [main] WARN  ha.SCMHAUtils (SCMHAUtils.java:getSCMRatisSnapshotDirectory(146)) - SCM snapshot dir is not configured. Falling back to ozone.metadata.dirs config
2021-10-05 13:23:35,832 [main] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:upgradeToSequenceId(347)) - upgrade localId to 107544261427200000
2021-10-05 13:23:35,833 [main] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:upgradeToSequenceId(357)) - upgrade delTxnId to 0
2021-10-05 13:23:35,840 [main] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:upgradeToSequenceId(371)) - upgrade containerId to 0
2021-10-05 13:23:35,842 [main] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:<init>(218)) - Init the HA SequenceIdGenerator.
2021-10-05 13:23:35,881 [main] INFO  node.SCMNodeManager (SCMNodeManager.java:<init>(144)) - Entering startup safe mode.
2021-10-05 13:23:35,925 [main] INFO  algorithms.ContainerPlacementPolicyFactory (ContainerPlacementPolicyFactory.java:getPolicy(60)) - Create container placement policy of type org.apache.hadoop.hdds.scm.container.placement.algorithms.SCMContainerPlacementRandom
2021-10-05 13:23:35,932 [main] INFO  pipeline.PipelineStateManagerImpl (PipelineStateManagerImpl.java:initialize(78)) - No pipeline exists in current db
2021-10-05 13:23:35,961 [main] INFO  algorithms.LeaderChoosePolicyFactory (LeaderChoosePolicyFactory.java:getPolicy(57)) - Create leader choose policy of type org.apache.hadoop.hdds.scm.pipeline.leader.choose.algorithms.MinLeaderCountChoosePolicy
2021-10-05 13:23:35,967 [main] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(43)) - Registering service BackgroundPipelineCreator.
2021-10-05 13:23:35,967 [main] INFO  pipeline.BackgroundPipelineCreator (BackgroundPipelineCreatorV2.java:start(130)) - Starting RatisPipelineUtilsThread.
2021-10-05 13:23:36,001 [main] INFO  algorithms.PipelineChoosePolicyFactory (PipelineChoosePolicyFactory.java:createPipelineChoosePolicyFromClass(73)) - Create pipeline choose policy of type org.apache.hadoop.hdds.scm.pipeline.choose.algorithms.RandomPipelineChoosePolicy
2021-10-05 13:23:36,018 [main] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(43)) - Registering service SCMBlockDeletingService.
2021-10-05 13:23:36,039 [main] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(43)) - Registering service ReplicationManager.
2021-10-05 13:23:36,041 [main] INFO  container.ReplicationManager (ReplicationManager.java:start(319)) - Starting Replication Monitor Thread.
2021-10-05 13:23:36,050 [ReplicationMonitor] INFO  container.ReplicationManager (ReplicationManager.java:processAll(371)) - Replication Monitor Thread took 1 milliseconds for processing 0 containers.
2021-10-05 13:23:36,052 [main] INFO  safemode.ContainerSafeModeRule (ContainerSafeModeRule.java:<init>(89)) - containers with one replica threshold count 0
2021-10-05 13:23:36,056 [main] INFO  safemode.HealthyPipelineSafeModeRule (HealthyPipelineSafeModeRule.java:initializeRule(156)) - Total pipeline count is 0, healthy pipeline threshold count is 1
2021-10-05 13:23:36,059 [main] INFO  safemode.OneReplicaPipelineSafeModeRule (OneReplicaPipelineSafeModeRule.java:initializeRule(180)) - Total pipeline count is 0, pipeline's with at least one datanode reported threshold count is 0
2021-10-05 13:23:36,389 [main] INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(90)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 10000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false.
2021-10-05 13:23:36,423 [Socket Reader #1 for port 15021] INFO  ipc.Server (Server.java:run(1265)) - Starting Socket Reader #1 for port 15021
2021-10-05 13:23:36,464 [Listener at 0.0.0.0/15021] INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(90)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 10000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false.
2021-10-05 13:23:36,466 [Socket Reader #1 for port 15022] INFO  ipc.Server (Server.java:run(1265)) - Starting Socket Reader #1 for port 15022
2021-10-05 13:23:36,485 [Listener at 0.0.0.0/15022] INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(90)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 10000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false.
2021-10-05 13:23:36,486 [Socket Reader #1 for port 15023] INFO  ipc.Server (Server.java:run(1265)) - Starting Socket Reader #1 for port 15023
2021-10-05 13:23:36,554 [Listener at 0.0.0.0/15023] INFO  algorithms.ContainerPlacementPolicyFactory (ContainerPlacementPolicyFactory.java:getPolicy(60)) - Create container placement policy of type org.apache.hadoop.hdds.scm.container.placement.algorithms.SCMContainerPlacementRandom
2021-10-05 13:23:36,560 [Listener at 0.0.0.0/15023] INFO  server.StorageContainerManager (StorageContainerManager.java:<init>(388)) - 
Container Balancer status:
Key                            Value
Running                        false
Container Balancer Configuration values:
Key                                                Value
Threshold                                          0.1
Max Datanodes to Involve per Iteration(ratio)      0.2
Max Size to Move per Iteration                     32212254720B

2021-10-05 13:23:36,560 [Listener at 0.0.0.0/15023] WARN  events.EventQueue (EventQueue.java:fireEvent(194)) - No event handler registered for event TypedEvent{payloadType=SafeModeStatus, name='Safe mode status'}
2021-10-05 13:23:36,561 [Listener at 0.0.0.0/15023] INFO  ha.SCMContext (SCMContext.java:updateSafeModeStatus(205)) - Update SafeModeStatus from SafeModeStatus{safeModeStatus=true, preCheckPassed=false} to SafeModeStatus{safeModeStatus=true, preCheckPassed=false}.
2021-10-05 13:23:36,565 [Listener at 0.0.0.0/15023] INFO  server.StorageContainerManager (StorageContainerManager.java:start(1303)) - StorageContainerLocationProtocol RPC server is listening at /0.0.0.0:15023
2021-10-05 13:23:36,566 [Listener at 0.0.0.0/15023] INFO  ha.SCMRatisServerImpl (SCMRatisServerImpl.java:start(177)) - starting ratis server 0.0.0.0:15020
2021-10-05 13:23:36,566 [Listener at 0.0.0.0/15023] INFO  server.RaftServer$Division (RaftServerImpl.java:start(296)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D: start as a follower, conf=0: [a4bffdee-6562-4179-bbcd-2dfbb5550fc0|rpc:localhost:15020|admin:|client:|dataStream:|priority:0], old=null
2021-10-05 13:23:36,567 [Listener at 0.0.0.0/15023] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(285)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D: changes role from      null to FOLLOWER at term 1 for startAsFollower
2021-10-05 13:23:36,567 [Listener at 0.0.0.0/15023] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(130)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0: start a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-FollowerState
2021-10-05 13:23:36,572 [Listener at 0.0.0.0/15023] INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-C748F4B4520D,id=a4bffdee-6562-4179-bbcd-2dfbb5550fc0
2021-10-05 13:23:36,574 [Listener at 0.0.0.0/15023] INFO  server.RaftServer (RaftServerProxy.java:lambda$start$5(374)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0: start RPC server
2021-10-05 13:23:36,575 [Listener at 0.0.0.0/15023] INFO  server.GrpcService (GrpcService.java:startImpl(253)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0: GrpcService started, listening on 15020
2021-10-05 13:23:36,579 [Listener at 0.0.0.0/15023] INFO  ha.SCMHAManagerImpl (SCMHAManagerImpl.java:start(120)) -  scm role is FOLLOWER peers [a4bffdee-6562-4179-bbcd-2dfbb5550fc0|rpc:localhost:15020|admin:|client:|dataStream:|priority:0]
2021-10-05 13:23:36,579 [Listener at 0.0.0.0/15023] INFO  ha.InterSCMGrpcService (InterSCMGrpcProtocolService.java:start(94)) - Starting SCM Grpc Service at port 15024
2021-10-05 13:23:36,587 [org.apache.ratis.util.JvmPauseMonitor$$Lambda$499/1586779822@48751d8a] INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(103)) - JvmPauseMonitor-a4bffdee-6562-4179-bbcd-2dfbb5550fc0: Started
2021-10-05 13:23:36,654 [Listener at 0.0.0.0/15023] WARN  impl.MetricsConfig (MetricsConfig.java:loadFirst(136)) - Cannot locate configuration: tried hadoop-metrics2-storagecontainermanager.properties,hadoop-metrics2.properties
2021-10-05 13:23:36,671 [Listener at 0.0.0.0/15023] INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:startTimer(378)) - Scheduled Metric snapshot period at 10 second(s).
2021-10-05 13:23:36,671 [Listener at 0.0.0.0/15023] INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:start(191)) - StorageContainerManager metrics system started
2021-10-05 13:23:36,934 [Listener at 0.0.0.0/15023] INFO  server.SCMClientProtocolServer (SCMClientProtocolServer.java:start(164)) - RPC server for Client  is listening at /0.0.0.0:15023
2021-10-05 13:23:36,936 [IPC Server Responder] INFO  ipc.Server (Server.java:run(1507)) - IPC Server Responder: starting
2021-10-05 13:23:36,956 [Listener at 0.0.0.0/15023] INFO  server.StorageContainerManager (StorageContainerManager.java:start(1318)) - ScmBlockLocationProtocol RPC server is listening at /0.0.0.0:15022
2021-10-05 13:23:36,956 [Listener at 0.0.0.0/15023] INFO  server.SCMBlockProtocolServer (SCMBlockProtocolServer.java:start(151)) - RPC server for Block Protocol is listening at /0.0.0.0:15022
2021-10-05 13:23:36,957 [IPC Server Responder] INFO  ipc.Server (Server.java:run(1507)) - IPC Server Responder: starting
2021-10-05 13:23:36,957 [IPC Server listener on 15022] INFO  ipc.Server (Server.java:run(1344)) - IPC Server listener on 15022: starting
2021-10-05 13:23:36,968 [IPC Server listener on 15023] INFO  ipc.Server (Server.java:run(1344)) - IPC Server listener on 15023: starting
2021-10-05 13:23:36,975 [Listener at 0.0.0.0/15023] INFO  server.StorageContainerManager (StorageContainerManager.java:start(1324)) - ScmDatanodeProtocl RPC server is listening at /0.0.0.0:15021
2021-10-05 13:23:36,995 [org.apache.hadoop.util.JvmPauseMonitor$Monitor@45017263] INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(188)) - Starting JVM pause monitor
2021-10-05 13:23:37,010 [Listener at 0.0.0.0/15023] INFO  http.BaseHttpServer (BaseHttpServer.java:newHttpServer2BuilderForOzone(209)) - Starting Web-server for scm at: http://0.0.0.0:15018
2021-10-05 13:23:37,011 [Listener at 0.0.0.0/15023] INFO  http.BaseHttpServer (BaseHttpServer.java:<init>(107)) - Hadoop Security Enabled: false Ozone Security Enabled: false Ozone HTTP Security Enabled: false 
2021-10-05 13:23:37,034 [Listener at 0.0.0.0/15023] INFO  util.log (Log.java:initialized(170)) - Logging initialized @10694ms to org.eclipse.jetty.util.log.Slf4jLog
2021-10-05 13:23:37,138 [Listener at 0.0.0.0/15023] INFO  server.AuthenticationFilter (AuthenticationFilter.java:constructSecretProvider(240)) - Unable to initialize FileSignerSecretProvider, falling back to use random secrets.
2021-10-05 13:23:37,153 [Listener at 0.0.0.0/15023] WARN  http.HttpRequestLog (HttpRequestLog.java:getRequestLog(103)) - Jetty request log can only be enabled using Log4j
2021-10-05 13:23:37,158 [Listener at 0.0.0.0/15023] INFO  http.HttpServer2 (HttpServer2.java:addGlobalFilter(1030)) - Added global filter 'safety' (class=org.apache.hadoop.hdds.server.http.HttpServer2$QuotingInputFilter)
2021-10-05 13:23:37,161 [Listener at 0.0.0.0/15023] INFO  http.HttpServer2 (HttpServer2.java:addFilter(1006)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context scm
2021-10-05 13:23:37,161 [Listener at 0.0.0.0/15023] INFO  http.HttpServer2 (HttpServer2.java:addFilter(1014)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context logs
2021-10-05 13:23:37,163 [Listener at 0.0.0.0/15023] INFO  http.HttpServer2 (HttpServer2.java:addFilter(1014)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context static
2021-10-05 13:23:37,202 [Listener at 0.0.0.0/15023] INFO  http.HttpServer2 (HttpServer2.java:bindListener(1249)) - Jetty bound to port 15018
2021-10-05 13:23:37,204 [Listener at 0.0.0.0/15023] INFO  server.Server (Server.java:doStart(375)) - jetty-9.4.43.v20210629; built: 2021-06-30T11:07:22.254Z; git: 526006ecfa3af7f1a27ef3a288e2bef7ea9dd7e8; jvm 1.8.0_292-b10
2021-10-05 13:23:37,233 [Listener at 0.0.0.0/15023] INFO  server.session (DefaultSessionIdManager.java:doStart(334)) - DefaultSessionIdManager workerName=node0
2021-10-05 13:23:37,233 [Listener at 0.0.0.0/15023] INFO  server.session (DefaultSessionIdManager.java:doStart(339)) - No SessionScavenger set, using defaults
2021-10-05 13:23:37,235 [Listener at 0.0.0.0/15023] INFO  server.session (HouseKeeper.java:startScavenging(132)) - node0 Scavenging every 660000ms
2021-10-05 13:23:37,246 [Listener at 0.0.0.0/15023] INFO  handler.ContextHandler (ContextHandler.java:doStart(915)) - Started o.e.j.s.ServletContextHandler@68f1b89{logs,/logs,file:///home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/log,AVAILABLE}
2021-10-05 13:23:37,246 [Listener at 0.0.0.0/15023] INFO  handler.ContextHandler (ContextHandler.java:doStart(915)) - Started o.e.j.s.ServletContextHandler@69356aca{static,/static,file:///home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-classes/webapps/static,AVAILABLE}
2021-10-05 13:23:37,290 [Listener at 0.0.0.0/15023] INFO  handler.ContextHandler (ContextHandler.java:doStart(915)) - Started o.e.j.w.WebAppContext@6d7772d3{scm,/,file:///home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-classes/webapps/scm/,AVAILABLE}{file:/home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-classes/webapps/scm}
2021-10-05 13:23:37,311 [Listener at 0.0.0.0/15023] INFO  server.AbstractConnector (AbstractConnector.java:doStart(331)) - Started ServerConnector@5c43cb12{HTTP/1.1, (http/1.1)}{0.0.0.0:15018}
2021-10-05 13:23:37,311 [Listener at 0.0.0.0/15023] INFO  server.Server (Server.java:doStart(415)) - Started @10970ms
2021-10-05 13:23:37,313 [Listener at 0.0.0.0/15023] INFO  impl.MetricsSinkAdapter (MetricsSinkAdapter.java:start(204)) - Sink prometheus started
2021-10-05 13:23:37,313 [Listener at 0.0.0.0/15023] INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:registerSink(305)) - Registered sink prometheus
2021-10-05 13:23:37,314 [Listener at 0.0.0.0/15023] INFO  http.BaseHttpServer (BaseHttpServer.java:updateConnectorAddress(329)) - HTTP server of scm listening at http://0.0.0.0:15018
2021-10-05 13:23:37,314 [Listener at 0.0.0.0/15023] INFO  ozone.MiniOzoneHAClusterImpl (MiniOzoneHAClusterImpl.java:createSCMService(564)) - Started SCM RPC server at org.apache.hadoop.hdds.scm.server.SCMClientProtocolServer@7fdf7359
2021-10-05 13:23:37,330 [Listener at 0.0.0.0/15023] INFO  ha.SCMHANodeDetails (SCMHANodeDetails.java:loadSCMHAConfig(157)) - ServiceID for StorageContainerManager is scm-service-test1
2021-10-05 13:23:37,330 [Listener at 0.0.0.0/15023] INFO  ha.SCMHANodeDetails (SCMHANodeDetails.java:loadSCMHAConfig(168)) - ServiceID for StorageContainerManager is scm-service-test1
2021-10-05 13:23:37,331 [Listener at 0.0.0.0/15023] WARN  scm.ScmUtils (ScmUtils.java:logWarn(179)) - ConfigKey ozone.scm.block.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.block.client.port appended with serviceId and nodeId. If want to configure same port configure ozone.scm.block.client.port
2021-10-05 13:23:37,331 [Listener at 0.0.0.0/15023] WARN  scm.ScmUtils (ScmUtils.java:logWarn(179)) - ConfigKey ozone.scm.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.client.port appended with serviceId and nodeId. If want to configure same port configure ozone.scm.client.port
2021-10-05 13:23:37,331 [Listener at 0.0.0.0/15023] WARN  scm.ScmUtils (ScmUtils.java:logWarn(179)) - ConfigKey ozone.scm.datanode.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.datanode.port appended with serviceId and nodeId. If want to configure same port configure ozone.scm.datanode.port
2021-10-05 13:23:37,332 [Listener at 0.0.0.0/15023] WARN  scm.ScmUtils (ScmUtils.java:logWarn(179)) - ConfigKey ozone.scm.block.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.block.client.port appended with serviceId and nodeId. If want to configure same port configure ozone.scm.block.client.port
2021-10-05 13:23:37,332 [Listener at 0.0.0.0/15023] WARN  scm.ScmUtils (ScmUtils.java:logWarn(179)) - ConfigKey ozone.scm.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.client.port appended with serviceId and nodeId. If want to configure same port configure ozone.scm.client.port
2021-10-05 13:23:37,332 [Listener at 0.0.0.0/15023] WARN  scm.ScmUtils (ScmUtils.java:logWarn(179)) - ConfigKey ozone.scm.datanode.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.datanode.port appended with serviceId and nodeId. If want to configure same port configure ozone.scm.datanode.port
2021-10-05 13:23:37,332 [Listener at 0.0.0.0/15023] INFO  ha.SCMHANodeDetails (SCMHANodeDetails.java:loadSCMHAConfig(250)) - Found matching SCM address with SCMServiceId: scm-service-test1, SCMNodeId: scmNode-2, RPC Address: localhost:15030 and Ratis port: 15030
2021-10-05 13:23:37,332 [Listener at 0.0.0.0/15023] INFO  ha.SCMHANodeDetails (ConfUtils.java:setNodeSpecificConfigs(108)) - Setting configuration key ozone.scm.datanode.address with value of key ozone.scm.datanode.address.scm-service-test1.scmNode-2: 127.0.0.1:15031
2021-10-05 13:23:37,333 [Listener at 0.0.0.0/15023] INFO  ha.SCMHANodeDetails (ConfUtils.java:setNodeSpecificConfigs(108)) - Setting configuration key ozone.scm.block.client.address with value of key ozone.scm.block.client.address.scm-service-test1.scmNode-2: 127.0.0.1:15032
2021-10-05 13:23:37,333 [Listener at 0.0.0.0/15023] INFO  ha.SCMHANodeDetails (ConfUtils.java:setNodeSpecificConfigs(108)) - Setting configuration key ozone.scm.client.address with value of key ozone.scm.client.address.scm-service-test1.scmNode-2: 127.0.0.1:15033
2021-10-05 13:23:37,333 [Listener at 0.0.0.0/15023] INFO  ha.SCMHANodeDetails (ConfUtils.java:setNodeSpecificConfigs(108)) - Setting configuration key ozone.scm.ratis.port with value of key ozone.scm.ratis.port.scm-service-test1.scmNode-2: 15030
2021-10-05 13:23:37,333 [Listener at 0.0.0.0/15023] INFO  ha.SCMHANodeDetails (ConfUtils.java:setNodeSpecificConfigs(108)) - Setting configuration key ozone.scm.grpc.port with value of key ozone.scm.grpc.port.scm-service-test1.scmNode-2: 15034
2021-10-05 13:23:37,333 [Listener at 0.0.0.0/15023] INFO  ha.SCMHANodeDetails (ConfUtils.java:setNodeSpecificConfigs(108)) - Setting configuration key ozone.scm.http-address with value of key ozone.scm.http-address.scm-service-test1.scmNode-2: 127.0.0.1:15028
2021-10-05 13:23:37,333 [Listener at 0.0.0.0/15023] INFO  ha.SCMHANodeDetails (ConfUtils.java:setNodeSpecificConfigs(108)) - Setting configuration key ozone.scm.https-address with value of key ozone.scm.https-address.scm-service-test1.scmNode-2: 127.0.0.1:15029
2021-10-05 13:23:37,333 [Listener at 0.0.0.0/15023] INFO  ha.SCMHANodeDetails (ConfUtils.java:setNodeSpecificConfigs(108)) - Setting configuration key ozone.scm.address with value of key ozone.scm.address.scm-service-test1.scmNode-2: 127.0.0.1
2021-10-05 13:23:37,334 [Listener at 0.0.0.0/15023] WARN  scm.ScmUtils (ScmUtils.java:logWarn(179)) - ConfigKey ozone.scm.block.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.block.client.port appended with serviceId and nodeId. If want to configure same port configure ozone.scm.block.client.port
2021-10-05 13:23:37,334 [Listener at 0.0.0.0/15023] WARN  scm.ScmUtils (ScmUtils.java:logWarn(179)) - ConfigKey ozone.scm.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.client.port appended with serviceId and nodeId. If want to configure same port configure ozone.scm.client.port
2021-10-05 13:23:37,334 [Listener at 0.0.0.0/15023] WARN  scm.ScmUtils (ScmUtils.java:logWarn(179)) - ConfigKey ozone.scm.datanode.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.datanode.port appended with serviceId and nodeId. If want to configure same port configure ozone.scm.datanode.port
2021-10-05 13:23:37,334 [Listener at 0.0.0.0/15023] WARN  server.ServerUtils (ServerUtils.java:getScmDbDir(148)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2021-10-05 13:23:37,342 [Listener at 0.0.0.0/15023] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.client.port appended with serviceId and nodeId
2021-10-05 13:23:37,342 [Listener at 0.0.0.0/15023] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.block.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.block.client.port appended with serviceId and nodeId
2021-10-05 13:23:37,342 [Listener at 0.0.0.0/15023] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.datanode.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.datanode.port appended with serviceId and nodeId
2021-10-05 13:23:37,342 [Listener at 0.0.0.0/15023] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.client.port appended with serviceId and nodeId
2021-10-05 13:23:37,342 [Listener at 0.0.0.0/15023] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.block.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.block.client.port appended with serviceId and nodeId
2021-10-05 13:23:37,343 [Listener at 0.0.0.0/15023] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.datanode.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.datanode.port appended with serviceId and nodeId
2021-10-05 13:23:37,343 [Listener at 0.0.0.0/15023] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.client.port appended with serviceId and nodeId
2021-10-05 13:23:37,343 [Listener at 0.0.0.0/15023] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.block.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.block.client.port appended with serviceId and nodeId
2021-10-05 13:23:37,343 [Listener at 0.0.0.0/15023] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.datanode.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.datanode.port appended with serviceId and nodeId
2021-10-05 13:23:39,583 [Listener at 0.0.0.0/15023] INFO  retry.RetryInvocationHandler (RetryInvocationHandler.java:log(411)) - com.google.protobuf.ServiceException: java.net.ConnectException: Call From fv-az270-324/10.1.0.10 to localhost:15032 failed on connection exception: java.net.ConnectException: Connection refused; For more details see:  http://wiki.apache.org/hadoop/ConnectionRefused, while invoking $Proxy39.send over nodeId=scmNode-2,nodeAddress=/127.0.0.1:15032 after 1 failover attempts. Trying to failover after sleeping for 2000ms.
2021-10-05 13:23:41,586 [Listener at 0.0.0.0/15023] INFO  retry.RetryInvocationHandler (RetryInvocationHandler.java:log(411)) - com.google.protobuf.ServiceException: java.net.ConnectException: Call From fv-az270-324/10.1.0.10 to localhost:15042 failed on connection exception: java.net.ConnectException: Connection refused; For more details see:  http://wiki.apache.org/hadoop/ConnectionRefused, while invoking $Proxy39.send over nodeId=scmNode-3,nodeAddress=/127.0.0.1:15042 after 2 failover attempts. Trying to failover after sleeping for 2000ms.
2021-10-05 13:23:41,760 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-FollowerState] INFO  impl.FollowerState (FollowerState.java:run(134)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-FollowerState: change to CANDIDATE, lastRpcElapsedTime:5193353842ns, electionTimeout:5185ms
2021-10-05 13:23:41,762 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-FollowerState] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(108)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0: shutdown a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-FollowerState
2021-10-05 13:23:41,764 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-FollowerState] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(285)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D: changes role from  FOLLOWER to CANDIDATE at term 1 for changeToCandidate
2021-10-05 13:23:41,764 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-FollowerState] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.leaderelection.pre-vote = false (custom)
2021-10-05 13:23:41,764 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-FollowerState] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(130)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0: start a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-LeaderElection2
2021-10-05 13:23:41,770 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-LeaderElection2] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(306)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-LeaderElection2 ELECTION round 0: submit vote requests at term 2 for 0: [a4bffdee-6562-4179-bbcd-2dfbb5550fc0|rpc:localhost:15020|admin:|client:|dataStream:|priority:0], old=null
2021-10-05 13:23:41,771 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-LeaderElection2] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(308)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-LeaderElection2 ELECTION round 0: result PASSED (term=2)
2021-10-05 13:23:41,771 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-LeaderElection2] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(121)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0: shutdown a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-LeaderElection2
2021-10-05 13:23:41,771 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-LeaderElection2] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(285)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D: changes role from CANDIDATE to LEADER at term 2 for changeToLeader
2021-10-05 13:23:41,771 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-LeaderElection2] INFO  ha.SCMStateMachine (SCMStateMachine.java:notifyLeaderChanged(252)) - current SCM becomes leader of term 2.
2021-10-05 13:23:41,771 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-LeaderElection2] INFO  ha.SCMContext (SCMContext.java:updateLeaderAndTerm(88)) - update <isLeader,term> from <false,0> to <true,2>
2021-10-05 13:23:41,774 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-LeaderElection2] INFO  server.RaftServer$Division (ServerState.java:setLeader(285)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D: change Leader from null to a4bffdee-6562-4179-bbcd-2dfbb5550fc0 at term 2 for becomeLeader, leader elected after 6074ms
2021-10-05 13:23:41,775 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-LeaderElection2] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.staging.catchup.gap = 1000 (default)
2021-10-05 13:23:41,775 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-LeaderElection2] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.write.element-limit = 4096 (default)
2021-10-05 13:23:41,775 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-LeaderElection2] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.write.byte-limit = 64MB (=67108864) (default)
2021-10-05 13:23:41,776 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-LeaderElection2] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.watch.timeout = 10s (default)
2021-10-05 13:23:41,776 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-LeaderElection2] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.watch.timeout.denomination = 1s (default)
2021-10-05 13:23:41,776 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-LeaderElection2] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.watch.element-limit = 65536 (default)
2021-10-05 13:23:41,776 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-LeaderElection2] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(130)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0: start a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-LeaderStateImpl
2021-10-05 13:23:41,777 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-LeaderElection2] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:rollLogSegment(399)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-SegmentedRaftLogWorker: Rolling segment log-0_0 to index:0
2021-10-05 13:23:41,784 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(558)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-SegmentedRaftLogWorker: Rolled log segment from /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-98f4f1fb-613f-4a4a-83a3-c748f4b4520d/scmNode-1/scm-ha/98f4f1fb-613f-4a4a-83a3-c748f4b4520d/current/log_inprogress_0 to /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-98f4f1fb-613f-4a4a-83a3-c748f4b4520d/scmNode-1/scm-ha/98f4f1fb-613f-4a4a-83a3-c748f4b4520d/current/log_0-0
2021-10-05 13:23:41,790 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-LeaderElection2] INFO  server.RaftServer$Division (ServerState.java:setRaftConf(387)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D: set configuration 1: [a4bffdee-6562-4179-bbcd-2dfbb5550fc0|rpc:localhost:15020|admin:|client:|dataStream:|priority:0], old=null
2021-10-05 13:23:41,793 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(601)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-SegmentedRaftLogWorker: created new log segment /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-98f4f1fb-613f-4a4a-83a3-c748f4b4520d/scmNode-1/scm-ha/98f4f1fb-613f-4a4a-83a3-c748f4b4520d/current/log_inprogress_1
2021-10-05 13:23:41,799 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  ha.SCMContext (SCMContext.java:setLeaderReady(115)) - update <isLeaderReady> from <false> to <true>
2021-10-05 13:23:41,800 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  pipeline.BackgroundPipelineCreator (BackgroundPipelineCreatorV2.java:notifyStatusChanged(264)) - Service BackgroundPipelineCreator transitions to RUNNING.
2021-10-05 13:23:41,801 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  safemode.HealthyPipelineSafeModeRule (HealthyPipelineSafeModeRule.java:initializeRule(152)) - Refreshed total pipeline count is 0, healthy pipeline threshold count is 1
2021-10-05 13:23:41,802 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  safemode.ContainerSafeModeRule (ContainerSafeModeRule.java:reInitializeRule(177)) - Refreshed one replica container threshold 0, currentThreshold 0
2021-10-05 13:23:41,802 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  safemode.OneReplicaPipelineSafeModeRule (OneReplicaPipelineSafeModeRule.java:initializeRule(176)) - Refreshed Total pipeline count is 0, pipeline's with at least one datanode reported threshold count is 0
2021-10-05 13:23:41,803 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  server.SCMDatanodeProtocolServer (SCMDatanodeProtocolServer.java:start(181)) - RPC server for DataNodes is listening at /0.0.0.0:15021
2021-10-05 13:23:41,809 [IPC Server listener on 15021] INFO  ipc.Server (Server.java:run(1344)) - IPC Server listener on 15021: starting
2021-10-05 13:23:41,809 [IPC Server Responder] INFO  ipc.Server (Server.java:run(1507)) - IPC Server Responder: starting
2021-10-05 13:23:43,629 [Listener at 0.0.0.0/15023] INFO  server.StorageContainerManager (StorageContainerManager.java:scmBootstrap(987)) - SCM BootStrap  is successful for ClusterID 98f4f1fb-613f-4a4a-83a3-c748f4b4520d, SCMID 86d8d056-6822-410c-8a18-8ea32f12a493
2021-10-05 13:23:43,629 [Listener at 0.0.0.0/15023] INFO  server.StorageContainerManager (StorageContainerManager.java:scmBootstrap(989)) - Primary SCM Node ID a4bffdee-6562-4179-bbcd-2dfbb5550fc0
2021-10-05 13:23:43,629 [Listener at 0.0.0.0/15023] INFO  ha.SCMHANodeDetails (SCMHANodeDetails.java:loadSCMHAConfig(157)) - ServiceID for StorageContainerManager is scm-service-test1
2021-10-05 13:23:43,630 [Listener at 0.0.0.0/15023] INFO  ha.SCMHANodeDetails (SCMHANodeDetails.java:loadSCMHAConfig(168)) - ServiceID for StorageContainerManager is scm-service-test1
2021-10-05 13:23:43,630 [Listener at 0.0.0.0/15023] WARN  scm.ScmUtils (ScmUtils.java:logWarn(179)) - ConfigKey ozone.scm.block.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.block.client.port appended with serviceId and nodeId. If want to configure same port configure ozone.scm.block.client.port
2021-10-05 13:23:43,630 [Listener at 0.0.0.0/15023] WARN  scm.ScmUtils (ScmUtils.java:logWarn(179)) - ConfigKey ozone.scm.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.client.port appended with serviceId and nodeId. If want to configure same port configure ozone.scm.client.port
2021-10-05 13:23:43,630 [Listener at 0.0.0.0/15023] WARN  scm.ScmUtils (ScmUtils.java:logWarn(179)) - ConfigKey ozone.scm.datanode.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.datanode.port appended with serviceId and nodeId. If want to configure same port configure ozone.scm.datanode.port
2021-10-05 13:23:43,630 [Listener at 0.0.0.0/15023] WARN  scm.ScmUtils (ScmUtils.java:logWarn(179)) - ConfigKey ozone.scm.block.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.block.client.port appended with serviceId and nodeId. If want to configure same port configure ozone.scm.block.client.port
2021-10-05 13:23:43,631 [Listener at 0.0.0.0/15023] WARN  scm.ScmUtils (ScmUtils.java:logWarn(179)) - ConfigKey ozone.scm.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.client.port appended with serviceId and nodeId. If want to configure same port configure ozone.scm.client.port
2021-10-05 13:23:43,631 [Listener at 0.0.0.0/15023] WARN  scm.ScmUtils (ScmUtils.java:logWarn(179)) - ConfigKey ozone.scm.datanode.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.datanode.port appended with serviceId and nodeId. If want to configure same port configure ozone.scm.datanode.port
2021-10-05 13:23:43,631 [Listener at 0.0.0.0/15023] INFO  ha.SCMHANodeDetails (SCMHANodeDetails.java:loadSCMHAConfig(250)) - Found matching SCM address with SCMServiceId: scm-service-test1, SCMNodeId: scmNode-2, RPC Address: localhost:15030 and Ratis port: 15030
2021-10-05 13:23:43,631 [Listener at 0.0.0.0/15023] INFO  ha.SCMHANodeDetails (ConfUtils.java:setNodeSpecificConfigs(108)) - Setting configuration key ozone.scm.datanode.address with value of key ozone.scm.datanode.address.scm-service-test1.scmNode-2: 127.0.0.1:15031
2021-10-05 13:23:43,631 [Listener at 0.0.0.0/15023] INFO  ha.SCMHANodeDetails (ConfUtils.java:setNodeSpecificConfigs(108)) - Setting configuration key ozone.scm.block.client.address with value of key ozone.scm.block.client.address.scm-service-test1.scmNode-2: 127.0.0.1:15032
2021-10-05 13:23:43,632 [Listener at 0.0.0.0/15023] INFO  ha.SCMHANodeDetails (ConfUtils.java:setNodeSpecificConfigs(108)) - Setting configuration key ozone.scm.client.address with value of key ozone.scm.client.address.scm-service-test1.scmNode-2: 127.0.0.1:15033
2021-10-05 13:23:43,632 [Listener at 0.0.0.0/15023] INFO  ha.SCMHANodeDetails (ConfUtils.java:setNodeSpecificConfigs(108)) - Setting configuration key ozone.scm.ratis.port with value of key ozone.scm.ratis.port.scm-service-test1.scmNode-2: 15030
2021-10-05 13:23:43,632 [Listener at 0.0.0.0/15023] INFO  ha.SCMHANodeDetails (ConfUtils.java:setNodeSpecificConfigs(108)) - Setting configuration key ozone.scm.grpc.port with value of key ozone.scm.grpc.port.scm-service-test1.scmNode-2: 15034
2021-10-05 13:23:43,633 [Listener at 0.0.0.0/15023] INFO  ha.SCMHANodeDetails (ConfUtils.java:setNodeSpecificConfigs(108)) - Setting configuration key ozone.scm.http-address with value of key ozone.scm.http-address.scm-service-test1.scmNode-2: 127.0.0.1:15028
2021-10-05 13:23:43,633 [Listener at 0.0.0.0/15023] INFO  ha.SCMHANodeDetails (ConfUtils.java:setNodeSpecificConfigs(108)) - Setting configuration key ozone.scm.https-address with value of key ozone.scm.https-address.scm-service-test1.scmNode-2: 127.0.0.1:15029
2021-10-05 13:23:43,633 [Listener at 0.0.0.0/15023] INFO  ha.SCMHANodeDetails (ConfUtils.java:setNodeSpecificConfigs(108)) - Setting configuration key ozone.scm.address with value of key ozone.scm.address.scm-service-test1.scmNode-2: 127.0.0.1
2021-10-05 13:23:43,633 [Listener at 0.0.0.0/15023] WARN  scm.ScmUtils (ScmUtils.java:logWarn(179)) - ConfigKey ozone.scm.block.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.block.client.port appended with serviceId and nodeId. If want to configure same port configure ozone.scm.block.client.port
2021-10-05 13:23:43,633 [Listener at 0.0.0.0/15023] WARN  scm.ScmUtils (ScmUtils.java:logWarn(179)) - ConfigKey ozone.scm.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.client.port appended with serviceId and nodeId. If want to configure same port configure ozone.scm.client.port
2021-10-05 13:23:43,633 [Listener at 0.0.0.0/15023] WARN  scm.ScmUtils (ScmUtils.java:logWarn(179)) - ConfigKey ozone.scm.datanode.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.datanode.port appended with serviceId and nodeId. If want to configure same port configure ozone.scm.datanode.port
2021-10-05 13:23:43,636 [Listener at 0.0.0.0/15023] WARN  server.ServerUtils (ServerUtils.java:getScmDbDir(148)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2021-10-05 13:23:43,638 [Listener at 0.0.0.0/15023] INFO  upgrade.AbstractLayoutVersionManager (AbstractLayoutVersionManager.java:init(79)) - Initializing Layout version manager with metadata layout = SCM_HA (version = 2), software layout = SCM_HA (version = 2)
2021-10-05 13:23:43,680 [Listener at 0.0.0.0/15023] INFO  reflections.Reflections (Reflections.java:scan(232)) - Reflections took 40 ms to scan 7 urls, producing 119 keys and 275 values 
2021-10-05 13:23:43,684 [Listener at 0.0.0.0/15023] WARN  utils.HAUtils (HAUtils.java:getMetaDir(342)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2021-10-05 13:23:43,685 [Listener at 0.0.0.0/15023] WARN  db.DBStoreBuilder (DBStoreBuilder.java:applyDBDefinition(145)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2021-10-05 13:23:43,754 [Listener at 0.0.0.0/15023] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchemaFromFile(129)) - Loading schema from [jar:file:/home/runner/.m2/repository/org/apache/ozone/hdds-common/1.2.0-SNAPSHOT/hdds-common-1.2.0-SNAPSHOT.jar!/network-topology-default.xml]
2021-10-05 13:23:43,754 [Listener at 0.0.0.0/15023] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchema(176)) - Loading network topology layer schema file
2021-10-05 13:23:43,758 [Listener at 0.0.0.0/15023] WARN  impl.MetricRegistriesImpl (MetricRegistriesImpl.java:addReporterRegistration(111)) - New reporters are added after registries were created. Some metrics will be missing from the reporter. Please add reporter before adding any new registry.
2021-10-05 13:23:43,758 [Listener at 0.0.0.0/15023] WARN  impl.MetricRegistriesImpl (MetricRegistriesImpl.java:addReporterRegistration(111)) - New reporters are added after registries were created. Some metrics will be missing from the reporter. Please add reporter before adding any new registry.
2021-10-05 13:23:43,760 [Listener at 0.0.0.0/15023] INFO  ha.SCMRatisServerImpl (SCMRatisServerImpl.java:<init>(87)) - starting Raft server for scm:86d8d056-6822-410c-8a18-8ea32f12a493
2021-10-05 13:23:43,764 [Listener at 0.0.0.0/15023] INFO  server.RaftServer (ConfUtils.java:logGet(44)) - raft.rpc.type = GRPC (default)
2021-10-05 13:23:43,764 [Listener at 0.0.0.0/15023] INFO  grpc.GrpcFactory (GrpcFactory.java:checkPooledByteBufAllocatorUseCacheForAllThreads(48)) - PERFORMANCE WARNING: useCacheForAllThreads is true that may cause Netty to create a lot garbage objects and, as a result, trigger GC.
	It is recommended to disable useCacheForAllThreads by setting -Dorg.apache.ratis.thirdparty.io.netty.allocator.useCacheForAllThreads=false in command line.
2021-10-05 13:23:43,769 [Listener at 0.0.0.0/15023] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(44)) - raft.grpc.admin.port = -1 (default)
2021-10-05 13:23:43,770 [Listener at 0.0.0.0/15023] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(44)) - raft.grpc.server.port = 15030 (custom)
2021-10-05 13:23:43,770 [Listener at 0.0.0.0/15023] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(44)) - raft.grpc.client.port = -1 (default)
2021-10-05 13:23:43,771 [Listener at 0.0.0.0/15023] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(44)) - raft.grpc.server.port = 15030 (custom)
2021-10-05 13:23:43,771 [Listener at 0.0.0.0/15023] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(44)) - raft.grpc.server.port = 15030 (custom)
2021-10-05 13:23:43,771 [Listener at 0.0.0.0/15023] INFO  server.GrpcService (ConfUtils.java:logGet(44)) - raft.grpc.message.size.max = 32m (=33554432) (custom)
2021-10-05 13:23:43,773 [Listener at 0.0.0.0/15023] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2021-10-05 13:23:43,773 [Listener at 0.0.0.0/15023] INFO  server.GrpcService (ConfUtils.java:logGet(44)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2021-10-05 13:23:43,773 [Listener at 0.0.0.0/15023] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.request.timeout = 30000ms (custom)
2021-10-05 13:23:43,774 [Listener at 0.0.0.0/15023] INFO  impl.DataStreamServerImpl (ConfUtils.java:logGet(44)) - raft.datastream.type = DISABLED (default)
2021-10-05 13:23:43,775 [Listener at 0.0.0.0/15023] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.slowness.timeout = 120000ms (custom)
2021-10-05 13:23:43,776 [Listener at 0.0.0.0/15023] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.leaderelection.leader.step-down.wait-time = 10s (default)
2021-10-05 13:23:43,776 [Listener at 0.0.0.0/15023] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.storage.dir = [/home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-98f4f1fb-613f-4a4a-83a3-c748f4b4520d/scmNode-2/scm-ha] (custom)
2021-10-05 13:23:43,779 [Listener at 0.0.0.0/15023] INFO  server.RaftServer (RaftServerProxy.java:addNew(95)) - 86d8d056-6822-410c-8a18-8ea32f12a493: addNew group-C748F4B4520D:[] returns group-C748F4B4520D:java.util.concurrent.CompletableFuture@72851503[Not completed]
2021-10-05 13:23:43,780 [pool-38-thread-1] INFO  server.RaftServer$Division (RaftServerImpl.java:<init>(181)) - 86d8d056-6822-410c-8a18-8ea32f12a493: new RaftServerImpl for group-C748F4B4520D:[] with SCMStateMachine:uninitialized
2021-10-05 13:23:43,780 [pool-38-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.timeout.min = 5000ms (custom)
2021-10-05 13:23:43,781 [pool-38-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.timeout.max = 5200ms (custom)
2021-10-05 13:23:43,781 [pool-38-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.sleep.time = 25ms (default)
2021-10-05 13:23:43,781 [pool-38-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.slowness.timeout = 120000ms (custom)
2021-10-05 13:23:43,781 [pool-38-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.leaderelection.leader.step-down.wait-time = 10s (default)
2021-10-05 13:23:43,781 [pool-38-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.sleep.deviation.threshold = 300ms (default)
2021-10-05 13:23:43,781 [pool-38-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.appender.install.snapshot.enabled = false (custom)
2021-10-05 13:23:43,781 [pool-38-thread-1] INFO  server.RaftServer$Division (ServerState.java:<init>(105)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D: ConfigurationManager, init=-1: [], old=null, confs=<EMPTY_MAP>
2021-10-05 13:23:43,782 [pool-38-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.storage.dir = [/home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-98f4f1fb-613f-4a4a-83a3-c748f4b4520d/scmNode-2/scm-ha] (custom)
2021-10-05 13:23:43,782 [pool-38-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.corruption.policy = EXCEPTION (default)
2021-10-05 13:23:43,782 [pool-38-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.storage.free-space.min = 0MB (=0) (default)
2021-10-05 13:23:43,782 [pool-38-thread-1] INFO  storage.RaftStorageDirectory (RaftStorageDirectoryImpl.java:analyzeStorage(135)) - The storage directory /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-98f4f1fb-613f-4a4a-83a3-c748f4b4520d/scmNode-2/scm-ha/98f4f1fb-613f-4a4a-83a3-c748f4b4520d does not exist. Creating ...
2021-10-05 13:23:43,783 [pool-38-thread-1] INFO  storage.RaftStorageDirectory (RaftStorageDirectoryImpl.java:tryLock(230)) - Lock on /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-98f4f1fb-613f-4a4a-83a3-c748f4b4520d/scmNode-2/scm-ha/98f4f1fb-613f-4a4a-83a3-c748f4b4520d/in_use.lock acquired by nodename 17451@fv-az270-324
2021-10-05 13:23:43,785 [pool-38-thread-1] INFO  storage.RaftStorage (RaftStorageImpl.java:format(89)) - Storage directory /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-98f4f1fb-613f-4a4a-83a3-c748f4b4520d/scmNode-2/scm-ha/98f4f1fb-613f-4a4a-83a3-c748f4b4520d has been successfully formatted.
2021-10-05 13:23:43,785 [pool-38-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.notification.no-leader.timeout = 60s (default)
2021-10-05 13:23:43,785 [pool-38-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.use.memory = false (default)
2021-10-05 13:23:43,786 [pool-38-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.purge.gap = 5 (custom)
2021-10-05 13:23:43,786 [pool-38-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2021-10-05 13:23:43,786 [pool-38-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.segment.size.max = 16384 (custom)
2021-10-05 13:23:43,790 [pool-38-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.segment.cache.num.max = 2 (custom)
2021-10-05 13:23:43,790 [pool-38-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.segment.cache.size.max = 200MB (=209715200) (default)
2021-10-05 13:23:43,791 [pool-38-thread-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:<init>(182)) - new 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-SegmentedRaftLogWorker for RaftStorageImpl:Storage Directory /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-98f4f1fb-613f-4a4a-83a3-c748f4b4520d/scmNode-2/scm-ha/98f4f1fb-613f-4a4a-83a3-c748f4b4520d
2021-10-05 13:23:43,791 [pool-38-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.queue.byte-limit = 64MB (=67108864) (default)
2021-10-05 13:23:43,791 [pool-38-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.queue.element-limit = 4096 (default)
2021-10-05 13:23:43,791 [pool-38-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.segment.size.max = 16384 (custom)
2021-10-05 13:23:43,791 [pool-38-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.preallocated.size = 16384 (custom)
2021-10-05 13:23:43,791 [pool-38-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.force.sync.num = 128 (default)
2021-10-05 13:23:43,791 [pool-38-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.statemachine.data.sync = true (default)
2021-10-05 13:23:43,791 [pool-38-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2021-10-05 13:23:43,791 [pool-38-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2021-10-05 13:23:43,793 [pool-38-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.write.buffer.size = 64KB (=65536) (default)
2021-10-05 13:23:43,794 [pool-38-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.statemachine.data.caching.enabled = false (default)
2021-10-05 13:23:43,794 [pool-38-thread-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:lambda$new$0(133)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-SegmentedRaftLogWorker: flushIndex: setUnconditionally 0 -> -1
2021-10-05 13:23:43,794 [pool-38-thread-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:lambda$new$0(133)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-SegmentedRaftLogWorker: safeCacheEvictIndex: setUnconditionally 0 -> -1
2021-10-05 13:23:43,795 [pool-38-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2021-10-05 13:23:43,795 [pool-38-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.snapshot.auto.trigger.threshold = 5 (custom)
2021-10-05 13:23:43,795 [pool-38-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.snapshot.retention.file.num = -1 (default)
2021-10-05 13:23:43,795 [pool-38-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.purge.upto.snapshot.index = true (custom)
2021-10-05 13:23:43,795 [pool-38-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.retrycache.expirytime = 60000ms (default)
2021-10-05 13:23:43,795 [pool-38-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.retrycache.statistics.expirytime = 100μs (default)
2021-10-05 13:23:43,797 [Listener at 0.0.0.0/15023] INFO  ha.SCMSnapshotProvider (SCMSnapshotProvider.java:<init>(66)) - Initializing SCM Snapshot Provider
2021-10-05 13:23:43,798 [Listener at 0.0.0.0/15023] WARN  server.ServerUtils (ServerUtils.java:getDefaultRatisDirectory(237)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2021-10-05 13:23:43,798 [Listener at 0.0.0.0/15023] WARN  ha.SCMHAUtils (SCMHAUtils.java:getSCMRatisSnapshotDirectory(146)) - SCM snapshot dir is not configured. Falling back to ozone.metadata.dirs config
2021-10-05 13:23:43,801 [Listener at 0.0.0.0/15023] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:upgradeToSequenceId(347)) - upgrade localId to 107544261427200000
2021-10-05 13:23:43,801 [Listener at 0.0.0.0/15023] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:upgradeToSequenceId(357)) - upgrade delTxnId to 0
2021-10-05 13:23:43,801 [Listener at 0.0.0.0/15023] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:upgradeToSequenceId(371)) - upgrade containerId to 0
2021-10-05 13:23:43,802 [Listener at 0.0.0.0/15023] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:<init>(218)) - Init the HA SequenceIdGenerator.
2021-10-05 13:23:43,802 [Listener at 0.0.0.0/15023] WARN  server.ServerUtils (ServerUtils.java:sanitizeUserArgs(73)) - ozone.scm.stale.node.interval value = 300000 is larger than max = 100000 based on the key value of ozone.scm.heartbeat.thread.interval, reset to the max value 100000.
2021-10-05 13:23:43,802 [Listener at 0.0.0.0/15023] WARN  server.ServerUtils (ServerUtils.java:sanitizeUserArgs(73)) - ozone.scm.stale.node.interval value = 300000 is larger than max = 100000 based on the key value of ozone.scm.heartbeat.thread.interval, reset to the max value 100000.
2021-10-05 13:23:43,803 [Listener at 0.0.0.0/15023] INFO  node.SCMNodeManager (SCMNodeManager.java:<init>(144)) - Entering startup safe mode.
2021-10-05 13:23:43,804 [Listener at 0.0.0.0/15023] INFO  algorithms.ContainerPlacementPolicyFactory (ContainerPlacementPolicyFactory.java:getPolicy(60)) - Create container placement policy of type org.apache.hadoop.hdds.scm.container.placement.algorithms.SCMContainerPlacementRandom
2021-10-05 13:23:43,805 [Listener at 0.0.0.0/15023] INFO  pipeline.PipelineStateManagerImpl (PipelineStateManagerImpl.java:initialize(78)) - No pipeline exists in current db
2021-10-05 13:23:43,805 [Listener at 0.0.0.0/15023] INFO  algorithms.LeaderChoosePolicyFactory (LeaderChoosePolicyFactory.java:getPolicy(57)) - Create leader choose policy of type org.apache.hadoop.hdds.scm.pipeline.leader.choose.algorithms.MinLeaderCountChoosePolicy
2021-10-05 13:23:43,805 [Listener at 0.0.0.0/15023] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(43)) - Registering service BackgroundPipelineCreator.
2021-10-05 13:23:43,805 [Listener at 0.0.0.0/15023] INFO  pipeline.BackgroundPipelineCreator (BackgroundPipelineCreatorV2.java:start(130)) - Starting RatisPipelineUtilsThread.
2021-10-05 13:23:43,809 [Listener at 0.0.0.0/15023] INFO  algorithms.PipelineChoosePolicyFactory (PipelineChoosePolicyFactory.java:createPipelineChoosePolicyFromClass(73)) - Create pipeline choose policy of type org.apache.hadoop.hdds.scm.pipeline.choose.algorithms.RandomPipelineChoosePolicy
2021-10-05 13:23:43,810 [Listener at 0.0.0.0/15023] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(43)) - Registering service SCMBlockDeletingService.
2021-10-05 13:23:43,810 [Listener at 0.0.0.0/15023] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(43)) - Registering service ReplicationManager.
2021-10-05 13:23:43,812 [Listener at 0.0.0.0/15023] INFO  container.ReplicationManager (ReplicationManager.java:start(319)) - Starting Replication Monitor Thread.
2021-10-05 13:23:43,816 [Listener at 0.0.0.0/15023] INFO  safemode.ContainerSafeModeRule (ContainerSafeModeRule.java:<init>(89)) - containers with one replica threshold count 0
2021-10-05 13:23:43,817 [Listener at 0.0.0.0/15023] INFO  safemode.HealthyPipelineSafeModeRule (HealthyPipelineSafeModeRule.java:initializeRule(156)) - Total pipeline count is 0, healthy pipeline threshold count is 1
2021-10-05 13:23:43,818 [Listener at 0.0.0.0/15023] INFO  safemode.OneReplicaPipelineSafeModeRule (OneReplicaPipelineSafeModeRule.java:initializeRule(180)) - Total pipeline count is 0, pipeline's with at least one datanode reported threshold count is 0
2021-10-05 13:23:43,820 [ReplicationMonitor] INFO  container.ReplicationManager (ReplicationManager.java:processAll(371)) - Replication Monitor Thread took 0 milliseconds for processing 0 containers.
2021-10-05 13:23:43,820 [Listener at 0.0.0.0/15023] INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(90)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 2000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false.
2021-10-05 13:23:43,823 [Socket Reader #1 for port 15031] INFO  ipc.Server (Server.java:run(1265)) - Starting Socket Reader #1 for port 15031
2021-10-05 13:23:43,831 [Listener at 0.0.0.0/15031] INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(90)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 2000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false.
2021-10-05 13:23:43,835 [Socket Reader #1 for port 15032] INFO  ipc.Server (Server.java:run(1265)) - Starting Socket Reader #1 for port 15032
2021-10-05 13:23:43,837 [Listener at 0.0.0.0/15032] INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(90)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 2000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false.
2021-10-05 13:23:43,838 [Socket Reader #1 for port 15033] INFO  ipc.Server (Server.java:run(1265)) - Starting Socket Reader #1 for port 15033
2021-10-05 13:23:43,873 [Listener at 0.0.0.0/15033] INFO  algorithms.ContainerPlacementPolicyFactory (ContainerPlacementPolicyFactory.java:getPolicy(60)) - Create container placement policy of type org.apache.hadoop.hdds.scm.container.placement.algorithms.SCMContainerPlacementRandom
2021-10-05 13:23:43,874 [Listener at 0.0.0.0/15033] INFO  server.StorageContainerManager (StorageContainerManager.java:<init>(388)) - 
Container Balancer status:
Key                            Value
Running                        false
Container Balancer Configuration values:
Key                                                Value
Threshold                                          0.1
Max Datanodes to Involve per Iteration(ratio)      0.2
Max Size to Move per Iteration                     32212254720B

2021-10-05 13:23:43,874 [Listener at 0.0.0.0/15033] WARN  events.EventQueue (EventQueue.java:fireEvent(194)) - No event handler registered for event TypedEvent{payloadType=SafeModeStatus, name='Safe mode status'}
2021-10-05 13:23:43,875 [Listener at 0.0.0.0/15033] INFO  ha.SCMContext (SCMContext.java:updateSafeModeStatus(205)) - Update SafeModeStatus from SafeModeStatus{safeModeStatus=true, preCheckPassed=false} to SafeModeStatus{safeModeStatus=true, preCheckPassed=false}.
2021-10-05 13:23:43,876 [Listener at 0.0.0.0/15033] INFO  server.StorageContainerManager (StorageContainerManager.java:start(1303)) - StorageContainerLocationProtocol RPC server is listening at /0.0.0.0:15033
2021-10-05 13:23:43,876 [Listener at 0.0.0.0/15033] INFO  ha.SCMRatisServerImpl (SCMRatisServerImpl.java:start(177)) - starting ratis server 0.0.0.0:15030
2021-10-05 13:23:43,877 [Listener at 0.0.0.0/15033] INFO  server.RaftServer$Division (RaftServerImpl.java:start(299)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D: start with initializing state, conf=-1: [], old=null
2021-10-05 13:23:43,877 [Listener at 0.0.0.0/15033] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(285)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D: changes role from      null to FOLLOWER at term 0 for startInitializing
2021-10-05 13:23:43,877 [Listener at 0.0.0.0/15033] INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-C748F4B4520D,id=86d8d056-6822-410c-8a18-8ea32f12a493
2021-10-05 13:23:43,880 [Listener at 0.0.0.0/15033] INFO  server.RaftServer (RaftServerProxy.java:lambda$start$5(374)) - 86d8d056-6822-410c-8a18-8ea32f12a493: start RPC server
2021-10-05 13:23:43,884 [Listener at 0.0.0.0/15033] INFO  server.GrpcService (GrpcService.java:startImpl(253)) - 86d8d056-6822-410c-8a18-8ea32f12a493: GrpcService started, listening on 15030
2021-10-05 13:23:43,884 [org.apache.ratis.util.JvmPauseMonitor$$Lambda$499/1586779822@753c7411] INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(103)) - JvmPauseMonitor-86d8d056-6822-410c-8a18-8ea32f12a493: Started
2021-10-05 13:23:43,886 [Listener at 0.0.0.0/15033] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.client.port appended with serviceId and nodeId
2021-10-05 13:23:43,886 [Listener at 0.0.0.0/15033] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.block.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.block.client.port appended with serviceId and nodeId
2021-10-05 13:23:43,886 [Listener at 0.0.0.0/15033] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.datanode.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.datanode.port appended with serviceId and nodeId
2021-10-05 13:23:43,886 [Listener at 0.0.0.0/15033] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.client.port appended with serviceId and nodeId
2021-10-05 13:23:43,886 [Listener at 0.0.0.0/15033] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.block.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.block.client.port appended with serviceId and nodeId
2021-10-05 13:23:43,887 [Listener at 0.0.0.0/15033] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.datanode.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.datanode.port appended with serviceId and nodeId
2021-10-05 13:23:43,887 [Listener at 0.0.0.0/15033] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.client.port appended with serviceId and nodeId
2021-10-05 13:23:43,887 [Listener at 0.0.0.0/15033] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.block.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.block.client.port appended with serviceId and nodeId
2021-10-05 13:23:43,887 [Listener at 0.0.0.0/15033] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.datanode.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.datanode.port appended with serviceId and nodeId
2021-10-05 13:23:43,893 [IPC Server handler 2 on default port 15022] INFO  ha.SCMRatisServerImpl (SCMRatisServerImpl.java:addSCM(291)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0: Submitting SetConfiguration request to Ratis server with new SCM peers list: [a4bffdee-6562-4179-bbcd-2dfbb5550fc0|rpc:localhost:15020|admin:|client:|dataStream:|priority:0, 86d8d056-6822-410c-8a18-8ea32f12a493|rpc:localhost:15030|priority:0]
2021-10-05 13:23:43,908 [IPC Server handler 2 on default port 15022] INFO  server.RaftServer$Division (RaftServerImpl.java:setConfigurationAsync(971)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D: receive setConfiguration SetConfigurationRequest:client-BBB1D7FEF41B->a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D, cid=0, seq=0, RW, null, peers:[a4bffdee-6562-4179-bbcd-2dfbb5550fc0|rpc:localhost:15020|admin:|client:|dataStream:|priority:0, 86d8d056-6822-410c-8a18-8ea32f12a493|rpc:localhost:15030|priority:0]
2021-10-05 13:23:43,909 [IPC Server handler 2 on default port 15022] INFO  server.RaftServer$Division (LeaderStateImpl.java:startSetConfiguration(345)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-LeaderStateImpl: startSetConfiguration SetConfigurationRequest:client-BBB1D7FEF41B->a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D, cid=0, seq=0, RW, null, peers:[a4bffdee-6562-4179-bbcd-2dfbb5550fc0|rpc:localhost:15020|admin:|client:|dataStream:|priority:0, 86d8d056-6822-410c-8a18-8ea32f12a493|rpc:localhost:15030|priority:0]
2021-10-05 13:23:43,915 [IPC Server handler 2 on default port 15022] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2021-10-05 13:23:43,916 [IPC Server handler 2 on default port 15022] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2021-10-05 13:23:43,916 [IPC Server handler 2 on default port 15022] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.appender.buffer.element-limit = 1024 (custom)
2021-10-05 13:23:43,920 [IPC Server handler 2 on default port 15022] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(44)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2021-10-05 13:23:43,921 [IPC Server handler 2 on default port 15022] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.request.timeout = 30000ms (custom)
2021-10-05 13:23:43,921 [IPC Server handler 2 on default port 15022] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.appender.install.snapshot.enabled = false (custom)
2021-10-05 13:23:44,374 [grpc-default-executor-0] INFO  ha.SCMStateMachine (SCMStateMachine.java:notifyLeaderChanged(248)) - leader changed, yet current SCM is still follower.
2021-10-05 13:23:44,374 [grpc-default-executor-0] INFO  server.RaftServer$Division (ServerState.java:setLeader(285)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D: change Leader from null to a4bffdee-6562-4179-bbcd-2dfbb5550fc0 at term 2 for appendEntries, leader elected after 588ms
2021-10-05 13:23:44,375 [grpc-default-executor-0] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(130)) - 86d8d056-6822-410c-8a18-8ea32f12a493: start 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-FollowerState
2021-10-05 13:23:44,392 [grpc-default-executor-0] INFO  server.RaftServer$Division (ServerState.java:setRaftConf(387)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D: set configuration 0: [a4bffdee-6562-4179-bbcd-2dfbb5550fc0|rpc:localhost:15020|admin:|client:|dataStream:|priority:0], old=null
2021-10-05 13:23:44,392 [grpc-default-executor-0] INFO  server.RaftServer$Division (ServerState.java:setRaftConf(387)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D: set configuration 1: [a4bffdee-6562-4179-bbcd-2dfbb5550fc0|rpc:localhost:15020|admin:|client:|dataStream:|priority:0], old=null
2021-10-05 13:23:44,392 [grpc-default-executor-0] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:startLogSegment(394)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-SegmentedRaftLogWorker: Starting segment from index:0
2021-10-05 13:23:44,393 [grpc-default-executor-0] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:rollLogSegment(399)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-SegmentedRaftLogWorker: Rolling segment log-0_0 to index:0
2021-10-05 13:23:44,394 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(601)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-SegmentedRaftLogWorker: created new log segment /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-98f4f1fb-613f-4a4a-83a3-c748f4b4520d/scmNode-2/scm-ha/98f4f1fb-613f-4a4a-83a3-c748f4b4520d/current/log_inprogress_0
2021-10-05 13:23:44,396 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(558)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-SegmentedRaftLogWorker: Rolled log segment from /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-98f4f1fb-613f-4a4a-83a3-c748f4b4520d/scmNode-2/scm-ha/98f4f1fb-613f-4a4a-83a3-c748f4b4520d/current/log_inprogress_0 to /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-98f4f1fb-613f-4a4a-83a3-c748f4b4520d/scmNode-2/scm-ha/98f4f1fb-613f-4a4a-83a3-c748f4b4520d/current/log_0-0
2021-10-05 13:23:44,398 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(601)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-SegmentedRaftLogWorker: created new log segment /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-98f4f1fb-613f-4a4a-83a3-c748f4b4520d/scmNode-2/scm-ha/98f4f1fb-613f-4a4a-83a3-c748f4b4520d/current/log_inprogress_1
2021-10-05 13:23:44,401 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  safemode.HealthyPipelineSafeModeRule (HealthyPipelineSafeModeRule.java:initializeRule(152)) - Refreshed total pipeline count is 0, healthy pipeline threshold count is 1
2021-10-05 13:23:44,404 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  safemode.ContainerSafeModeRule (ContainerSafeModeRule.java:reInitializeRule(177)) - Refreshed one replica container threshold 0, currentThreshold 0
2021-10-05 13:23:44,404 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  safemode.OneReplicaPipelineSafeModeRule (OneReplicaPipelineSafeModeRule.java:initializeRule(176)) - Refreshed Total pipeline count is 0, pipeline's with at least one datanode reported threshold count is 0
2021-10-05 13:23:44,404 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  server.SCMDatanodeProtocolServer (SCMDatanodeProtocolServer.java:start(181)) - RPC server for DataNodes is listening at /0.0.0.0:15031
2021-10-05 13:23:44,416 [IPC Server listener on 15031] INFO  ipc.Server (Server.java:run(1344)) - IPC Server listener on 15031: starting
2021-10-05 13:23:44,417 [IPC Server Responder] INFO  ipc.Server (Server.java:run(1507)) - IPC Server Responder: starting
2021-10-05 13:23:44,429 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-LeaderStateImpl] INFO  server.RaftServer$Division (ServerState.java:setRaftConf(387)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D: set configuration 3: [86d8d056-6822-410c-8a18-8ea32f12a493|rpc:localhost:15030|priority:0, a4bffdee-6562-4179-bbcd-2dfbb5550fc0|rpc:localhost:15020|admin:|client:|dataStream:|priority:0], old=[a4bffdee-6562-4179-bbcd-2dfbb5550fc0|rpc:localhost:15020|admin:|client:|dataStream:|priority:0]
2021-10-05 13:23:44,437 [grpc-default-executor-0] INFO  server.RaftServer$Division (ServerState.java:setRaftConf(387)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D: set configuration 3: [86d8d056-6822-410c-8a18-8ea32f12a493|rpc:localhost:15030|admin:|client:|dataStream:|priority:0, a4bffdee-6562-4179-bbcd-2dfbb5550fc0|rpc:localhost:15020|admin:|client:|dataStream:|priority:0], old=[a4bffdee-6562-4179-bbcd-2dfbb5550fc0|rpc:localhost:15020|admin:|client:|dataStream:|priority:0]
2021-10-05 13:23:44,442 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-LeaderStateImpl] INFO  server.RaftServer$Division (ServerState.java:setRaftConf(387)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D: set configuration 5: [86d8d056-6822-410c-8a18-8ea32f12a493|rpc:localhost:15030|priority:0, a4bffdee-6562-4179-bbcd-2dfbb5550fc0|rpc:localhost:15020|admin:|client:|dataStream:|priority:0], old=null
2021-10-05 13:23:44,444 [grpc-default-executor-0] INFO  server.RaftServer$Division (ServerState.java:setRaftConf(387)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D: set configuration 5: [86d8d056-6822-410c-8a18-8ea32f12a493|rpc:localhost:15030|admin:|client:|dataStream:|priority:0, a4bffdee-6562-4179-bbcd-2dfbb5550fc0|rpc:localhost:15020|admin:|client:|dataStream:|priority:0], old=null
2021-10-05 13:23:44,452 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  ha.SCMStateMachine (SCMStateMachine.java:takeSnapshot(290)) - Current Snapshot Index 5, takeSnapshot took 1 ms
2021-10-05 13:23:44,452 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:takeSnapshot(281)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater: Took a snapshot at index 5
2021-10-05 13:23:44,452 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:lambda$new$0(89)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater: snapshotIndex: updateIncreasingly -1 -> 5
2021-10-05 13:23:44,452 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:purge(306)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-SegmentedRaftLog: purge 5
2021-10-05 13:23:44,454 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-SegmentedRaftLog: snapshotIndex: updateIncreasingly -1 -> 5
2021-10-05 13:23:44,455 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-SegmentedRaftLogWorker] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-SegmentedRaftLog: purgeIndex: updateToMax old=-1, new=0, updated? true
2021-10-05 13:23:44,456 [IPC Server handler 2 on default port 15022] INFO  ha.SCMRatisServerImpl (SCMRatisServerImpl.java:addSCM(302)) - Successfully added new SCM: 86d8d056-6822-410c-8a18-8ea32f12a493.
2021-10-05 13:23:44,459 [Listener at 0.0.0.0/15033] INFO  ha.SCMHAManagerImpl (SCMHAManagerImpl.java:start(116)) - Successfully added SCM scmNode-2 to group group-C748F4B4520D:[86d8d056-6822-410c-8a18-8ea32f12a493|rpc:localhost:15030|admin:|client:|dataStream:|priority:0, a4bffdee-6562-4179-bbcd-2dfbb5550fc0|rpc:localhost:15020|admin:|client:|dataStream:|priority:0]
2021-10-05 13:23:44,459 [Listener at 0.0.0.0/15033] INFO  ha.InterSCMGrpcService (InterSCMGrpcProtocolService.java:start(94)) - Starting SCM Grpc Service at port 15034
2021-10-05 13:23:44,461 [Listener at 0.0.0.0/15033] INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:init(158)) - StorageContainerManager metrics system started (again)
2021-10-05 13:23:44,479 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  ha.SCMStateMachine (SCMStateMachine.java:takeSnapshot(290)) - Current Snapshot Index 5, takeSnapshot took 0 ms
2021-10-05 13:23:44,479 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:takeSnapshot(281)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater: Took a snapshot at index 5
2021-10-05 13:23:44,479 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:lambda$new$0(89)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater: snapshotIndex: updateIncreasingly -1 -> 5
2021-10-05 13:23:44,479 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:purge(306)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-SegmentedRaftLog: purge 5
2021-10-05 13:23:44,480 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-SegmentedRaftLog: snapshotIndex: updateIncreasingly -1 -> 5
2021-10-05 13:23:44,485 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-SegmentedRaftLogWorker] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-SegmentedRaftLog: purgeIndex: updateToMax old=-1, new=0, updated? true
2021-10-05 13:23:44,492 [Listener at 0.0.0.0/15033] INFO  server.SCMClientProtocolServer (SCMClientProtocolServer.java:start(164)) - RPC server for Client  is listening at /0.0.0.0:15033
2021-10-05 13:23:44,495 [IPC Server Responder] INFO  ipc.Server (Server.java:run(1507)) - IPC Server Responder: starting
2021-10-05 13:23:44,496 [IPC Server listener on 15033] INFO  ipc.Server (Server.java:run(1344)) - IPC Server listener on 15033: starting
2021-10-05 13:23:44,503 [Listener at 0.0.0.0/15033] INFO  server.StorageContainerManager (StorageContainerManager.java:start(1318)) - ScmBlockLocationProtocol RPC server is listening at /0.0.0.0:15032
2021-10-05 13:23:44,508 [Listener at 0.0.0.0/15033] INFO  server.SCMBlockProtocolServer (SCMBlockProtocolServer.java:start(151)) - RPC server for Block Protocol is listening at /0.0.0.0:15032
2021-10-05 13:23:44,509 [IPC Server Responder] INFO  ipc.Server (Server.java:run(1507)) - IPC Server Responder: starting
2021-10-05 13:23:44,509 [IPC Server listener on 15032] INFO  ipc.Server (Server.java:run(1344)) - IPC Server listener on 15032: starting
2021-10-05 13:23:44,512 [Listener at 0.0.0.0/15033] INFO  server.StorageContainerManager (StorageContainerManager.java:start(1324)) - ScmDatanodeProtocl RPC server is listening at /0.0.0.0:15031
2021-10-05 13:23:44,514 [Listener at 0.0.0.0/15033] INFO  http.BaseHttpServer (BaseHttpServer.java:newHttpServer2BuilderForOzone(209)) - Starting Web-server for scm at: http://0.0.0.0:15028
2021-10-05 13:23:44,514 [Listener at 0.0.0.0/15033] INFO  http.BaseHttpServer (BaseHttpServer.java:<init>(107)) - Hadoop Security Enabled: false Ozone Security Enabled: false Ozone HTTP Security Enabled: false 
2021-10-05 13:23:44,516 [Listener at 0.0.0.0/15033] INFO  server.AuthenticationFilter (AuthenticationFilter.java:constructSecretProvider(240)) - Unable to initialize FileSignerSecretProvider, falling back to use random secrets.
2021-10-05 13:23:44,516 [Listener at 0.0.0.0/15033] WARN  http.HttpRequestLog (HttpRequestLog.java:getRequestLog(103)) - Jetty request log can only be enabled using Log4j
2021-10-05 13:23:44,517 [Listener at 0.0.0.0/15033] INFO  http.HttpServer2 (HttpServer2.java:addGlobalFilter(1030)) - Added global filter 'safety' (class=org.apache.hadoop.hdds.server.http.HttpServer2$QuotingInputFilter)
2021-10-05 13:23:44,518 [Listener at 0.0.0.0/15033] INFO  http.HttpServer2 (HttpServer2.java:addFilter(1006)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context scm
2021-10-05 13:23:44,519 [Listener at 0.0.0.0/15033] INFO  http.HttpServer2 (HttpServer2.java:addFilter(1014)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context static
2021-10-05 13:23:44,519 [Listener at 0.0.0.0/15033] INFO  http.HttpServer2 (HttpServer2.java:addFilter(1014)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context logs
2021-10-05 13:23:44,520 [org.apache.hadoop.util.JvmPauseMonitor$Monitor@641255d1] INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(188)) - Starting JVM pause monitor
2021-10-05 13:23:44,521 [Listener at 0.0.0.0/15033] INFO  http.HttpServer2 (HttpServer2.java:bindListener(1249)) - Jetty bound to port 15028
2021-10-05 13:23:44,521 [Listener at 0.0.0.0/15033] INFO  server.Server (Server.java:doStart(375)) - jetty-9.4.43.v20210629; built: 2021-06-30T11:07:22.254Z; git: 526006ecfa3af7f1a27ef3a288e2bef7ea9dd7e8; jvm 1.8.0_292-b10
2021-10-05 13:23:44,524 [Listener at 0.0.0.0/15033] INFO  server.session (DefaultSessionIdManager.java:doStart(334)) - DefaultSessionIdManager workerName=node0
2021-10-05 13:23:44,524 [Listener at 0.0.0.0/15033] INFO  server.session (DefaultSessionIdManager.java:doStart(339)) - No SessionScavenger set, using defaults
2021-10-05 13:23:44,525 [Listener at 0.0.0.0/15033] INFO  server.session (HouseKeeper.java:startScavenging(132)) - node0 Scavenging every 660000ms
2021-10-05 13:23:44,525 [Listener at 0.0.0.0/15033] INFO  handler.ContextHandler (ContextHandler.java:doStart(915)) - Started o.e.j.s.ServletContextHandler@600a1270{logs,/logs,file:///home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/log,AVAILABLE}
2021-10-05 13:23:44,526 [Listener at 0.0.0.0/15033] INFO  handler.ContextHandler (ContextHandler.java:doStart(915)) - Started o.e.j.s.ServletContextHandler@28effa3f{static,/static,file:///home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-classes/webapps/static,AVAILABLE}
2021-10-05 13:23:44,531 [Listener at 0.0.0.0/15033] INFO  handler.ContextHandler (ContextHandler.java:doStart(915)) - Started o.e.j.w.WebAppContext@28f081ad{scm,/,file:///home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-classes/webapps/scm/,AVAILABLE}{file:/home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-classes/webapps/scm}
2021-10-05 13:23:44,532 [Listener at 0.0.0.0/15033] INFO  server.AbstractConnector (AbstractConnector.java:doStart(331)) - Started ServerConnector@73158d35{HTTP/1.1, (http/1.1)}{0.0.0.0:15028}
2021-10-05 13:23:44,532 [Listener at 0.0.0.0/15033] INFO  server.Server (Server.java:doStart(415)) - Started @18191ms
2021-10-05 13:23:44,532 [Listener at 0.0.0.0/15033] WARN  impl.MetricsSystemImpl (MetricsSystemImpl.java:register(279)) - Sink prometheus already exists!
2021-10-05 13:23:44,533 [Listener at 0.0.0.0/15033] INFO  http.BaseHttpServer (BaseHttpServer.java:updateConnectorAddress(329)) - HTTP server of scm listening at http://0.0.0.0:15028
2021-10-05 13:23:44,533 [Listener at 0.0.0.0/15033] INFO  ozone.MiniOzoneHAClusterImpl (MiniOzoneHAClusterImpl.java:createSCMService(564)) - Started SCM RPC server at org.apache.hadoop.hdds.scm.server.SCMClientProtocolServer@56fc2cea
2021-10-05 13:23:44,534 [Listener at 0.0.0.0/15033] INFO  ha.SCMHANodeDetails (SCMHANodeDetails.java:loadSCMHAConfig(157)) - ServiceID for StorageContainerManager is scm-service-test1
2021-10-05 13:23:44,534 [Listener at 0.0.0.0/15033] INFO  ha.SCMHANodeDetails (SCMHANodeDetails.java:loadSCMHAConfig(168)) - ServiceID for StorageContainerManager is scm-service-test1
2021-10-05 13:23:44,534 [Listener at 0.0.0.0/15033] WARN  scm.ScmUtils (ScmUtils.java:logWarn(179)) - ConfigKey ozone.scm.block.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.block.client.port appended with serviceId and nodeId. If want to configure same port configure ozone.scm.block.client.port
2021-10-05 13:23:44,534 [Listener at 0.0.0.0/15033] WARN  scm.ScmUtils (ScmUtils.java:logWarn(179)) - ConfigKey ozone.scm.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.client.port appended with serviceId and nodeId. If want to configure same port configure ozone.scm.client.port
2021-10-05 13:23:44,534 [Listener at 0.0.0.0/15033] WARN  scm.ScmUtils (ScmUtils.java:logWarn(179)) - ConfigKey ozone.scm.datanode.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.datanode.port appended with serviceId and nodeId. If want to configure same port configure ozone.scm.datanode.port
2021-10-05 13:23:44,534 [Listener at 0.0.0.0/15033] WARN  scm.ScmUtils (ScmUtils.java:logWarn(179)) - ConfigKey ozone.scm.block.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.block.client.port appended with serviceId and nodeId. If want to configure same port configure ozone.scm.block.client.port
2021-10-05 13:23:44,535 [Listener at 0.0.0.0/15033] WARN  scm.ScmUtils (ScmUtils.java:logWarn(179)) - ConfigKey ozone.scm.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.client.port appended with serviceId and nodeId. If want to configure same port configure ozone.scm.client.port
2021-10-05 13:23:44,535 [Listener at 0.0.0.0/15033] WARN  scm.ScmUtils (ScmUtils.java:logWarn(179)) - ConfigKey ozone.scm.datanode.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.datanode.port appended with serviceId and nodeId. If want to configure same port configure ozone.scm.datanode.port
2021-10-05 13:23:44,535 [Listener at 0.0.0.0/15033] INFO  ha.SCMHANodeDetails (SCMHANodeDetails.java:loadSCMHAConfig(250)) - Found matching SCM address with SCMServiceId: scm-service-test1, SCMNodeId: scmNode-3, RPC Address: localhost:15040 and Ratis port: 15040
2021-10-05 13:23:44,535 [Listener at 0.0.0.0/15033] INFO  ha.SCMHANodeDetails (ConfUtils.java:setNodeSpecificConfigs(108)) - Setting configuration key ozone.scm.datanode.address with value of key ozone.scm.datanode.address.scm-service-test1.scmNode-3: 127.0.0.1:15041
2021-10-05 13:23:44,535 [Listener at 0.0.0.0/15033] INFO  ha.SCMHANodeDetails (ConfUtils.java:setNodeSpecificConfigs(108)) - Setting configuration key ozone.scm.block.client.address with value of key ozone.scm.block.client.address.scm-service-test1.scmNode-3: 127.0.0.1:15042
2021-10-05 13:23:44,535 [Listener at 0.0.0.0/15033] INFO  ha.SCMHANodeDetails (ConfUtils.java:setNodeSpecificConfigs(108)) - Setting configuration key ozone.scm.client.address with value of key ozone.scm.client.address.scm-service-test1.scmNode-3: 127.0.0.1:15043
2021-10-05 13:23:44,535 [Listener at 0.0.0.0/15033] INFO  ha.SCMHANodeDetails (ConfUtils.java:setNodeSpecificConfigs(108)) - Setting configuration key ozone.scm.ratis.port with value of key ozone.scm.ratis.port.scm-service-test1.scmNode-3: 15040
2021-10-05 13:23:44,535 [Listener at 0.0.0.0/15033] INFO  ha.SCMHANodeDetails (ConfUtils.java:setNodeSpecificConfigs(108)) - Setting configuration key ozone.scm.grpc.port with value of key ozone.scm.grpc.port.scm-service-test1.scmNode-3: 15044
2021-10-05 13:23:44,535 [Listener at 0.0.0.0/15033] INFO  ha.SCMHANodeDetails (ConfUtils.java:setNodeSpecificConfigs(108)) - Setting configuration key ozone.scm.http-address with value of key ozone.scm.http-address.scm-service-test1.scmNode-3: 127.0.0.1:15038
2021-10-05 13:23:44,536 [Listener at 0.0.0.0/15033] INFO  ha.SCMHANodeDetails (ConfUtils.java:setNodeSpecificConfigs(108)) - Setting configuration key ozone.scm.https-address with value of key ozone.scm.https-address.scm-service-test1.scmNode-3: 127.0.0.1:15039
2021-10-05 13:23:44,536 [Listener at 0.0.0.0/15033] INFO  ha.SCMHANodeDetails (ConfUtils.java:setNodeSpecificConfigs(108)) - Setting configuration key ozone.scm.address with value of key ozone.scm.address.scm-service-test1.scmNode-3: 127.0.0.1
2021-10-05 13:23:44,536 [Listener at 0.0.0.0/15033] WARN  scm.ScmUtils (ScmUtils.java:logWarn(179)) - ConfigKey ozone.scm.block.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.block.client.port appended with serviceId and nodeId. If want to configure same port configure ozone.scm.block.client.port
2021-10-05 13:23:44,536 [Listener at 0.0.0.0/15033] WARN  scm.ScmUtils (ScmUtils.java:logWarn(179)) - ConfigKey ozone.scm.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.client.port appended with serviceId and nodeId. If want to configure same port configure ozone.scm.client.port
2021-10-05 13:23:44,536 [Listener at 0.0.0.0/15033] WARN  scm.ScmUtils (ScmUtils.java:logWarn(179)) - ConfigKey ozone.scm.datanode.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.datanode.port appended with serviceId and nodeId. If want to configure same port configure ozone.scm.datanode.port
2021-10-05 13:23:44,536 [Listener at 0.0.0.0/15033] WARN  server.ServerUtils (ServerUtils.java:getScmDbDir(148)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2021-10-05 13:23:44,538 [Listener at 0.0.0.0/15033] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.client.port appended with serviceId and nodeId
2021-10-05 13:23:44,538 [Listener at 0.0.0.0/15033] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.block.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.block.client.port appended with serviceId and nodeId
2021-10-05 13:23:44,538 [Listener at 0.0.0.0/15033] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.datanode.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.datanode.port appended with serviceId and nodeId
2021-10-05 13:23:44,538 [Listener at 0.0.0.0/15033] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.client.port appended with serviceId and nodeId
2021-10-05 13:23:44,538 [Listener at 0.0.0.0/15033] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.block.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.block.client.port appended with serviceId and nodeId
2021-10-05 13:23:44,538 [Listener at 0.0.0.0/15033] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.datanode.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.datanode.port appended with serviceId and nodeId
2021-10-05 13:23:44,538 [Listener at 0.0.0.0/15033] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.client.port appended with serviceId and nodeId
2021-10-05 13:23:44,539 [Listener at 0.0.0.0/15033] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.block.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.block.client.port appended with serviceId and nodeId
2021-10-05 13:23:44,539 [Listener at 0.0.0.0/15033] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.datanode.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.datanode.port appended with serviceId and nodeId
2021-10-05 13:23:44,553 [Listener at 0.0.0.0/15033] INFO  server.StorageContainerManager (StorageContainerManager.java:scmBootstrap(987)) - SCM BootStrap  is successful for ClusterID 98f4f1fb-613f-4a4a-83a3-c748f4b4520d, SCMID 34671d38-b53b-4109-b2ef-192b14535a6e
2021-10-05 13:23:44,553 [Listener at 0.0.0.0/15033] INFO  server.StorageContainerManager (StorageContainerManager.java:scmBootstrap(989)) - Primary SCM Node ID a4bffdee-6562-4179-bbcd-2dfbb5550fc0
2021-10-05 13:23:44,553 [Listener at 0.0.0.0/15033] INFO  ha.SCMHANodeDetails (SCMHANodeDetails.java:loadSCMHAConfig(157)) - ServiceID for StorageContainerManager is scm-service-test1
2021-10-05 13:23:44,553 [Listener at 0.0.0.0/15033] INFO  ha.SCMHANodeDetails (SCMHANodeDetails.java:loadSCMHAConfig(168)) - ServiceID for StorageContainerManager is scm-service-test1
2021-10-05 13:23:44,553 [Listener at 0.0.0.0/15033] WARN  scm.ScmUtils (ScmUtils.java:logWarn(179)) - ConfigKey ozone.scm.block.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.block.client.port appended with serviceId and nodeId. If want to configure same port configure ozone.scm.block.client.port
2021-10-05 13:23:44,554 [Listener at 0.0.0.0/15033] WARN  scm.ScmUtils (ScmUtils.java:logWarn(179)) - ConfigKey ozone.scm.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.client.port appended with serviceId and nodeId. If want to configure same port configure ozone.scm.client.port
2021-10-05 13:23:44,554 [Listener at 0.0.0.0/15033] WARN  scm.ScmUtils (ScmUtils.java:logWarn(179)) - ConfigKey ozone.scm.datanode.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.datanode.port appended with serviceId and nodeId. If want to configure same port configure ozone.scm.datanode.port
2021-10-05 13:23:44,554 [Listener at 0.0.0.0/15033] WARN  scm.ScmUtils (ScmUtils.java:logWarn(179)) - ConfigKey ozone.scm.block.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.block.client.port appended with serviceId and nodeId. If want to configure same port configure ozone.scm.block.client.port
2021-10-05 13:23:44,554 [Listener at 0.0.0.0/15033] WARN  scm.ScmUtils (ScmUtils.java:logWarn(179)) - ConfigKey ozone.scm.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.client.port appended with serviceId and nodeId. If want to configure same port configure ozone.scm.client.port
2021-10-05 13:23:44,554 [Listener at 0.0.0.0/15033] WARN  scm.ScmUtils (ScmUtils.java:logWarn(179)) - ConfigKey ozone.scm.datanode.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.datanode.port appended with serviceId and nodeId. If want to configure same port configure ozone.scm.datanode.port
2021-10-05 13:23:44,554 [Listener at 0.0.0.0/15033] INFO  ha.SCMHANodeDetails (SCMHANodeDetails.java:loadSCMHAConfig(250)) - Found matching SCM address with SCMServiceId: scm-service-test1, SCMNodeId: scmNode-3, RPC Address: localhost:15040 and Ratis port: 15040
2021-10-05 13:23:44,554 [Listener at 0.0.0.0/15033] INFO  ha.SCMHANodeDetails (ConfUtils.java:setNodeSpecificConfigs(108)) - Setting configuration key ozone.scm.datanode.address with value of key ozone.scm.datanode.address.scm-service-test1.scmNode-3: 127.0.0.1:15041
2021-10-05 13:23:44,555 [Listener at 0.0.0.0/15033] INFO  ha.SCMHANodeDetails (ConfUtils.java:setNodeSpecificConfigs(108)) - Setting configuration key ozone.scm.block.client.address with value of key ozone.scm.block.client.address.scm-service-test1.scmNode-3: 127.0.0.1:15042
2021-10-05 13:23:44,555 [Listener at 0.0.0.0/15033] INFO  ha.SCMHANodeDetails (ConfUtils.java:setNodeSpecificConfigs(108)) - Setting configuration key ozone.scm.client.address with value of key ozone.scm.client.address.scm-service-test1.scmNode-3: 127.0.0.1:15043
2021-10-05 13:23:44,555 [Listener at 0.0.0.0/15033] INFO  ha.SCMHANodeDetails (ConfUtils.java:setNodeSpecificConfigs(108)) - Setting configuration key ozone.scm.ratis.port with value of key ozone.scm.ratis.port.scm-service-test1.scmNode-3: 15040
2021-10-05 13:23:44,555 [Listener at 0.0.0.0/15033] INFO  ha.SCMHANodeDetails (ConfUtils.java:setNodeSpecificConfigs(108)) - Setting configuration key ozone.scm.grpc.port with value of key ozone.scm.grpc.port.scm-service-test1.scmNode-3: 15044
2021-10-05 13:23:44,555 [Listener at 0.0.0.0/15033] INFO  ha.SCMHANodeDetails (ConfUtils.java:setNodeSpecificConfigs(108)) - Setting configuration key ozone.scm.http-address with value of key ozone.scm.http-address.scm-service-test1.scmNode-3: 127.0.0.1:15038
2021-10-05 13:23:44,555 [Listener at 0.0.0.0/15033] INFO  ha.SCMHANodeDetails (ConfUtils.java:setNodeSpecificConfigs(108)) - Setting configuration key ozone.scm.https-address with value of key ozone.scm.https-address.scm-service-test1.scmNode-3: 127.0.0.1:15039
2021-10-05 13:23:44,555 [Listener at 0.0.0.0/15033] INFO  ha.SCMHANodeDetails (ConfUtils.java:setNodeSpecificConfigs(108)) - Setting configuration key ozone.scm.address with value of key ozone.scm.address.scm-service-test1.scmNode-3: 127.0.0.1
2021-10-05 13:23:44,555 [Listener at 0.0.0.0/15033] WARN  scm.ScmUtils (ScmUtils.java:logWarn(179)) - ConfigKey ozone.scm.block.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.block.client.port appended with serviceId and nodeId. If want to configure same port configure ozone.scm.block.client.port
2021-10-05 13:23:44,555 [Listener at 0.0.0.0/15033] WARN  scm.ScmUtils (ScmUtils.java:logWarn(179)) - ConfigKey ozone.scm.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.client.port appended with serviceId and nodeId. If want to configure same port configure ozone.scm.client.port
2021-10-05 13:23:44,556 [Listener at 0.0.0.0/15033] WARN  scm.ScmUtils (ScmUtils.java:logWarn(179)) - ConfigKey ozone.scm.datanode.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.datanode.port appended with serviceId and nodeId. If want to configure same port configure ozone.scm.datanode.port
2021-10-05 13:23:44,556 [Listener at 0.0.0.0/15033] WARN  server.ServerUtils (ServerUtils.java:getScmDbDir(148)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2021-10-05 13:23:44,557 [Listener at 0.0.0.0/15033] INFO  upgrade.AbstractLayoutVersionManager (AbstractLayoutVersionManager.java:init(79)) - Initializing Layout version manager with metadata layout = SCM_HA (version = 2), software layout = SCM_HA (version = 2)
2021-10-05 13:23:44,594 [Listener at 0.0.0.0/15033] INFO  reflections.Reflections (Reflections.java:scan(232)) - Reflections took 36 ms to scan 7 urls, producing 119 keys and 275 values 
2021-10-05 13:23:44,596 [Listener at 0.0.0.0/15033] WARN  utils.HAUtils (HAUtils.java:getMetaDir(342)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2021-10-05 13:23:44,596 [Listener at 0.0.0.0/15033] WARN  db.DBStoreBuilder (DBStoreBuilder.java:applyDBDefinition(145)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2021-10-05 13:23:44,672 [Listener at 0.0.0.0/15033] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchemaFromFile(129)) - Loading schema from [jar:file:/home/runner/.m2/repository/org/apache/ozone/hdds-common/1.2.0-SNAPSHOT/hdds-common-1.2.0-SNAPSHOT.jar!/network-topology-default.xml]
2021-10-05 13:23:44,673 [Listener at 0.0.0.0/15033] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchema(176)) - Loading network topology layer schema file
2021-10-05 13:23:44,675 [Listener at 0.0.0.0/15033] WARN  impl.MetricRegistriesImpl (MetricRegistriesImpl.java:addReporterRegistration(111)) - New reporters are added after registries were created. Some metrics will be missing from the reporter. Please add reporter before adding any new registry.
2021-10-05 13:23:44,675 [Listener at 0.0.0.0/15033] WARN  impl.MetricRegistriesImpl (MetricRegistriesImpl.java:addReporterRegistration(111)) - New reporters are added after registries were created. Some metrics will be missing from the reporter. Please add reporter before adding any new registry.
2021-10-05 13:23:44,676 [Listener at 0.0.0.0/15033] INFO  ha.SCMRatisServerImpl (SCMRatisServerImpl.java:<init>(87)) - starting Raft server for scm:34671d38-b53b-4109-b2ef-192b14535a6e
2021-10-05 13:23:44,677 [Listener at 0.0.0.0/15033] INFO  server.RaftServer (ConfUtils.java:logGet(44)) - raft.rpc.type = GRPC (default)
2021-10-05 13:23:44,677 [Listener at 0.0.0.0/15033] INFO  grpc.GrpcFactory (GrpcFactory.java:checkPooledByteBufAllocatorUseCacheForAllThreads(48)) - PERFORMANCE WARNING: useCacheForAllThreads is true that may cause Netty to create a lot garbage objects and, as a result, trigger GC.
	It is recommended to disable useCacheForAllThreads by setting -Dorg.apache.ratis.thirdparty.io.netty.allocator.useCacheForAllThreads=false in command line.
2021-10-05 13:23:44,677 [Listener at 0.0.0.0/15033] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(44)) - raft.grpc.admin.port = -1 (default)
2021-10-05 13:23:44,677 [Listener at 0.0.0.0/15033] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(44)) - raft.grpc.server.port = 15040 (custom)
2021-10-05 13:23:44,678 [Listener at 0.0.0.0/15033] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(44)) - raft.grpc.client.port = -1 (default)
2021-10-05 13:23:44,678 [Listener at 0.0.0.0/15033] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(44)) - raft.grpc.server.port = 15040 (custom)
2021-10-05 13:23:44,678 [Listener at 0.0.0.0/15033] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(44)) - raft.grpc.server.port = 15040 (custom)
2021-10-05 13:23:44,678 [Listener at 0.0.0.0/15033] INFO  server.GrpcService (ConfUtils.java:logGet(44)) - raft.grpc.message.size.max = 32m (=33554432) (custom)
2021-10-05 13:23:44,678 [Listener at 0.0.0.0/15033] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2021-10-05 13:23:44,678 [Listener at 0.0.0.0/15033] INFO  server.GrpcService (ConfUtils.java:logGet(44)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2021-10-05 13:23:44,678 [Listener at 0.0.0.0/15033] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.request.timeout = 30000ms (custom)
2021-10-05 13:23:44,679 [Listener at 0.0.0.0/15033] INFO  impl.DataStreamServerImpl (ConfUtils.java:logGet(44)) - raft.datastream.type = DISABLED (default)
2021-10-05 13:23:44,680 [Listener at 0.0.0.0/15033] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.slowness.timeout = 120000ms (custom)
2021-10-05 13:23:44,680 [Listener at 0.0.0.0/15033] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.leaderelection.leader.step-down.wait-time = 10s (default)
2021-10-05 13:23:44,680 [Listener at 0.0.0.0/15033] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.storage.dir = [/home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-98f4f1fb-613f-4a4a-83a3-c748f4b4520d/scmNode-3/scm-ha] (custom)
2021-10-05 13:23:44,681 [Listener at 0.0.0.0/15033] INFO  server.RaftServer (RaftServerProxy.java:addNew(95)) - 34671d38-b53b-4109-b2ef-192b14535a6e: addNew group-C748F4B4520D:[] returns group-C748F4B4520D:java.util.concurrent.CompletableFuture@2a5c115b[Not completed]
2021-10-05 13:23:44,681 [pool-57-thread-1] INFO  server.RaftServer$Division (RaftServerImpl.java:<init>(181)) - 34671d38-b53b-4109-b2ef-192b14535a6e: new RaftServerImpl for group-C748F4B4520D:[] with SCMStateMachine:uninitialized
2021-10-05 13:23:44,682 [pool-57-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.timeout.min = 5000ms (custom)
2021-10-05 13:23:44,682 [pool-57-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.timeout.max = 5200ms (custom)
2021-10-05 13:23:44,682 [pool-57-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.sleep.time = 25ms (default)
2021-10-05 13:23:44,683 [pool-57-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.slowness.timeout = 120000ms (custom)
2021-10-05 13:23:44,683 [pool-57-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.leaderelection.leader.step-down.wait-time = 10s (default)
2021-10-05 13:23:44,683 [pool-57-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.sleep.deviation.threshold = 300ms (default)
2021-10-05 13:23:44,683 [pool-57-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.appender.install.snapshot.enabled = false (custom)
2021-10-05 13:23:44,683 [pool-57-thread-1] INFO  server.RaftServer$Division (ServerState.java:<init>(105)) - 34671d38-b53b-4109-b2ef-192b14535a6e@group-C748F4B4520D: ConfigurationManager, init=-1: [], old=null, confs=<EMPTY_MAP>
2021-10-05 13:23:44,683 [pool-57-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.storage.dir = [/home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-98f4f1fb-613f-4a4a-83a3-c748f4b4520d/scmNode-3/scm-ha] (custom)
2021-10-05 13:23:44,683 [pool-57-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.corruption.policy = EXCEPTION (default)
2021-10-05 13:23:44,683 [pool-57-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.storage.free-space.min = 0MB (=0) (default)
2021-10-05 13:23:44,683 [pool-57-thread-1] INFO  storage.RaftStorageDirectory (RaftStorageDirectoryImpl.java:analyzeStorage(135)) - The storage directory /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-98f4f1fb-613f-4a4a-83a3-c748f4b4520d/scmNode-3/scm-ha/98f4f1fb-613f-4a4a-83a3-c748f4b4520d does not exist. Creating ...
2021-10-05 13:23:44,685 [pool-57-thread-1] INFO  storage.RaftStorageDirectory (RaftStorageDirectoryImpl.java:tryLock(230)) - Lock on /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-98f4f1fb-613f-4a4a-83a3-c748f4b4520d/scmNode-3/scm-ha/98f4f1fb-613f-4a4a-83a3-c748f4b4520d/in_use.lock acquired by nodename 17451@fv-az270-324
2021-10-05 13:23:44,686 [pool-57-thread-1] INFO  storage.RaftStorage (RaftStorageImpl.java:format(89)) - Storage directory /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-98f4f1fb-613f-4a4a-83a3-c748f4b4520d/scmNode-3/scm-ha/98f4f1fb-613f-4a4a-83a3-c748f4b4520d has been successfully formatted.
2021-10-05 13:23:44,686 [pool-57-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.notification.no-leader.timeout = 60s (default)
2021-10-05 13:23:44,686 [pool-57-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.use.memory = false (default)
2021-10-05 13:23:44,686 [pool-57-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.purge.gap = 5 (custom)
2021-10-05 13:23:44,686 [pool-57-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2021-10-05 13:23:44,687 [pool-57-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.segment.size.max = 16384 (custom)
2021-10-05 13:23:44,688 [pool-57-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.segment.cache.num.max = 2 (custom)
2021-10-05 13:23:44,689 [pool-57-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.segment.cache.size.max = 200MB (=209715200) (default)
2021-10-05 13:23:44,689 [pool-57-thread-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:<init>(182)) - new 34671d38-b53b-4109-b2ef-192b14535a6e@group-C748F4B4520D-SegmentedRaftLogWorker for RaftStorageImpl:Storage Directory /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-98f4f1fb-613f-4a4a-83a3-c748f4b4520d/scmNode-3/scm-ha/98f4f1fb-613f-4a4a-83a3-c748f4b4520d
2021-10-05 13:23:44,690 [pool-57-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.queue.byte-limit = 64MB (=67108864) (default)
2021-10-05 13:23:44,690 [pool-57-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.queue.element-limit = 4096 (default)
2021-10-05 13:23:44,690 [pool-57-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.segment.size.max = 16384 (custom)
2021-10-05 13:23:44,690 [pool-57-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.preallocated.size = 16384 (custom)
2021-10-05 13:23:44,690 [pool-57-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.force.sync.num = 128 (default)
2021-10-05 13:23:44,690 [pool-57-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.statemachine.data.sync = true (default)
2021-10-05 13:23:44,690 [pool-57-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2021-10-05 13:23:44,690 [pool-57-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2021-10-05 13:23:44,691 [pool-57-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.write.buffer.size = 64KB (=65536) (default)
2021-10-05 13:23:44,693 [pool-57-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.statemachine.data.caching.enabled = false (default)
2021-10-05 13:23:44,693 [pool-57-thread-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:lambda$new$0(133)) - 34671d38-b53b-4109-b2ef-192b14535a6e@group-C748F4B4520D-SegmentedRaftLogWorker: flushIndex: setUnconditionally 0 -> -1
2021-10-05 13:23:44,693 [pool-57-thread-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:lambda$new$0(133)) - 34671d38-b53b-4109-b2ef-192b14535a6e@group-C748F4B4520D-SegmentedRaftLogWorker: safeCacheEvictIndex: setUnconditionally 0 -> -1
2021-10-05 13:23:44,693 [pool-57-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2021-10-05 13:23:44,694 [pool-57-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.snapshot.auto.trigger.threshold = 5 (custom)
2021-10-05 13:23:44,694 [pool-57-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.snapshot.retention.file.num = -1 (default)
2021-10-05 13:23:44,694 [pool-57-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.purge.upto.snapshot.index = true (custom)
2021-10-05 13:23:44,694 [pool-57-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.retrycache.expirytime = 60000ms (default)
2021-10-05 13:23:44,694 [pool-57-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.retrycache.statistics.expirytime = 100μs (default)
2021-10-05 13:23:44,695 [Listener at 0.0.0.0/15033] INFO  ha.SCMSnapshotProvider (SCMSnapshotProvider.java:<init>(66)) - Initializing SCM Snapshot Provider
2021-10-05 13:23:44,695 [Listener at 0.0.0.0/15033] WARN  server.ServerUtils (ServerUtils.java:getDefaultRatisDirectory(237)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2021-10-05 13:23:44,695 [Listener at 0.0.0.0/15033] WARN  ha.SCMHAUtils (SCMHAUtils.java:getSCMRatisSnapshotDirectory(146)) - SCM snapshot dir is not configured. Falling back to ozone.metadata.dirs config
2021-10-05 13:23:44,700 [Listener at 0.0.0.0/15033] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:upgradeToSequenceId(347)) - upgrade localId to 107544261427200000
2021-10-05 13:23:44,700 [Listener at 0.0.0.0/15033] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:upgradeToSequenceId(357)) - upgrade delTxnId to 0
2021-10-05 13:23:44,700 [Listener at 0.0.0.0/15033] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:upgradeToSequenceId(371)) - upgrade containerId to 0
2021-10-05 13:23:44,700 [Listener at 0.0.0.0/15033] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:<init>(218)) - Init the HA SequenceIdGenerator.
2021-10-05 13:23:44,701 [Listener at 0.0.0.0/15033] WARN  server.ServerUtils (ServerUtils.java:sanitizeUserArgs(73)) - ozone.scm.stale.node.interval value = 300000 is larger than max = 100000 based on the key value of ozone.scm.heartbeat.thread.interval, reset to the max value 100000.
2021-10-05 13:23:44,701 [Listener at 0.0.0.0/15033] WARN  server.ServerUtils (ServerUtils.java:sanitizeUserArgs(73)) - ozone.scm.stale.node.interval value = 300000 is larger than max = 100000 based on the key value of ozone.scm.heartbeat.thread.interval, reset to the max value 100000.
2021-10-05 13:23:44,701 [Listener at 0.0.0.0/15033] INFO  node.SCMNodeManager (SCMNodeManager.java:<init>(144)) - Entering startup safe mode.
2021-10-05 13:23:44,702 [Listener at 0.0.0.0/15033] INFO  algorithms.ContainerPlacementPolicyFactory (ContainerPlacementPolicyFactory.java:getPolicy(60)) - Create container placement policy of type org.apache.hadoop.hdds.scm.container.placement.algorithms.SCMContainerPlacementRandom
2021-10-05 13:23:44,702 [Listener at 0.0.0.0/15033] INFO  pipeline.PipelineStateManagerImpl (PipelineStateManagerImpl.java:initialize(78)) - No pipeline exists in current db
2021-10-05 13:23:44,703 [Listener at 0.0.0.0/15033] INFO  algorithms.LeaderChoosePolicyFactory (LeaderChoosePolicyFactory.java:getPolicy(57)) - Create leader choose policy of type org.apache.hadoop.hdds.scm.pipeline.leader.choose.algorithms.MinLeaderCountChoosePolicy
2021-10-05 13:23:44,703 [Listener at 0.0.0.0/15033] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(43)) - Registering service BackgroundPipelineCreator.
2021-10-05 13:23:44,703 [Listener at 0.0.0.0/15033] INFO  pipeline.BackgroundPipelineCreator (BackgroundPipelineCreatorV2.java:start(130)) - Starting RatisPipelineUtilsThread.
2021-10-05 13:23:44,705 [Listener at 0.0.0.0/15033] INFO  algorithms.PipelineChoosePolicyFactory (PipelineChoosePolicyFactory.java:createPipelineChoosePolicyFromClass(73)) - Create pipeline choose policy of type org.apache.hadoop.hdds.scm.pipeline.choose.algorithms.RandomPipelineChoosePolicy
2021-10-05 13:23:44,705 [Listener at 0.0.0.0/15033] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(43)) - Registering service SCMBlockDeletingService.
2021-10-05 13:23:44,705 [Listener at 0.0.0.0/15033] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(43)) - Registering service ReplicationManager.
2021-10-05 13:23:44,706 [Listener at 0.0.0.0/15033] INFO  container.ReplicationManager (ReplicationManager.java:start(319)) - Starting Replication Monitor Thread.
2021-10-05 13:23:44,707 [Listener at 0.0.0.0/15033] INFO  safemode.ContainerSafeModeRule (ContainerSafeModeRule.java:<init>(89)) - containers with one replica threshold count 0
2021-10-05 13:23:44,708 [Listener at 0.0.0.0/15033] INFO  safemode.HealthyPipelineSafeModeRule (HealthyPipelineSafeModeRule.java:initializeRule(156)) - Total pipeline count is 0, healthy pipeline threshold count is 1
2021-10-05 13:23:44,708 [Listener at 0.0.0.0/15033] INFO  safemode.OneReplicaPipelineSafeModeRule (OneReplicaPipelineSafeModeRule.java:initializeRule(180)) - Total pipeline count is 0, pipeline's with at least one datanode reported threshold count is 0
2021-10-05 13:23:44,709 [Listener at 0.0.0.0/15033] INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(90)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 2000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false.
2021-10-05 13:23:44,720 [ReplicationMonitor] INFO  container.ReplicationManager (ReplicationManager.java:processAll(371)) - Replication Monitor Thread took 0 milliseconds for processing 0 containers.
2021-10-05 13:23:44,720 [Socket Reader #1 for port 15041] INFO  ipc.Server (Server.java:run(1265)) - Starting Socket Reader #1 for port 15041
2021-10-05 13:23:44,732 [Listener at 0.0.0.0/15041] INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(90)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 2000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false.
2021-10-05 13:23:44,732 [Socket Reader #1 for port 15042] INFO  ipc.Server (Server.java:run(1265)) - Starting Socket Reader #1 for port 15042
2021-10-05 13:23:44,734 [Listener at 0.0.0.0/15042] INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(90)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 2000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false.
2021-10-05 13:23:44,735 [Socket Reader #1 for port 15043] INFO  ipc.Server (Server.java:run(1265)) - Starting Socket Reader #1 for port 15043
2021-10-05 13:23:44,758 [Listener at 0.0.0.0/15043] INFO  algorithms.ContainerPlacementPolicyFactory (ContainerPlacementPolicyFactory.java:getPolicy(60)) - Create container placement policy of type org.apache.hadoop.hdds.scm.container.placement.algorithms.SCMContainerPlacementRandom
2021-10-05 13:23:44,758 [Listener at 0.0.0.0/15043] INFO  server.StorageContainerManager (StorageContainerManager.java:<init>(388)) - 
Container Balancer status:
Key                            Value
Running                        false
Container Balancer Configuration values:
Key                                                Value
Threshold                                          0.1
Max Datanodes to Involve per Iteration(ratio)      0.2
Max Size to Move per Iteration                     32212254720B

2021-10-05 13:23:44,759 [Listener at 0.0.0.0/15043] WARN  events.EventQueue (EventQueue.java:fireEvent(194)) - No event handler registered for event TypedEvent{payloadType=SafeModeStatus, name='Safe mode status'}
2021-10-05 13:23:44,759 [Listener at 0.0.0.0/15043] INFO  ha.SCMContext (SCMContext.java:updateSafeModeStatus(205)) - Update SafeModeStatus from SafeModeStatus{safeModeStatus=true, preCheckPassed=false} to SafeModeStatus{safeModeStatus=true, preCheckPassed=false}.
2021-10-05 13:23:44,759 [Listener at 0.0.0.0/15043] INFO  ozone.MiniOzoneHAClusterImpl (MiniOzoneHAClusterImpl.java:createSCMService(568)) - Intialized SCM at org.apache.hadoop.hdds.scm.server.SCMClientProtocolServer@9120cb5. This SCM is currently inactive (not running).
2021-10-05 13:23:44,855 [Listener at 0.0.0.0/15043] INFO  ha.OMHANodeDetails (OMHANodeDetails.java:loadOMHAConfig(118)) - ServiceID for OzoneManager is om-service-test1
2021-10-05 13:23:44,858 [Listener at 0.0.0.0/15043] INFO  ha.OMHANodeDetails (OMHANodeDetails.java:loadOMHAConfig(194)) - Found matching OM address with OMServiceId: om-service-test1, OMNodeId: omNode-1, RPC Address: localhost:10356 and Ratis port: 10360
2021-10-05 13:23:44,858 [Listener at 0.0.0.0/15043] INFO  ha.OMHANodeDetails (ConfUtils.java:setNodeSpecificConfigs(108)) - Setting configuration key ozone.om.http-address with value of key ozone.om.http-address.om-service-test1.omNode-1: 127.0.0.1:10358
2021-10-05 13:23:44,858 [Listener at 0.0.0.0/15043] INFO  ha.OMHANodeDetails (ConfUtils.java:setNodeSpecificConfigs(108)) - Setting configuration key ozone.om.https-address with value of key ozone.om.https-address.om-service-test1.omNode-1: 127.0.0.1:10359
2021-10-05 13:23:44,858 [Listener at 0.0.0.0/15043] INFO  ha.OMHANodeDetails (ConfUtils.java:setNodeSpecificConfigs(108)) - Setting configuration key ozone.om.address with value of key ozone.om.address.om-service-test1.omNode-1: 127.0.0.1:10356
2021-10-05 13:23:44,860 [Listener at 0.0.0.0/15043] WARN  server.ServerUtils (ServerUtils.java:getDBPath(225)) - ozone.om.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2021-10-05 13:23:44,864 [Listener at 0.0.0.0/15043] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.client.port appended with serviceId and nodeId
2021-10-05 13:23:44,864 [Listener at 0.0.0.0/15043] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.block.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.block.client.port appended with serviceId and nodeId
2021-10-05 13:23:44,864 [Listener at 0.0.0.0/15043] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.datanode.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.datanode.port appended with serviceId and nodeId
2021-10-05 13:23:44,865 [Listener at 0.0.0.0/15043] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.client.port appended with serviceId and nodeId
2021-10-05 13:23:44,865 [Listener at 0.0.0.0/15043] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.block.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.block.client.port appended with serviceId and nodeId
2021-10-05 13:23:44,865 [Listener at 0.0.0.0/15043] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.datanode.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.datanode.port appended with serviceId and nodeId
2021-10-05 13:23:44,865 [Listener at 0.0.0.0/15043] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.client.port appended with serviceId and nodeId
2021-10-05 13:23:44,865 [Listener at 0.0.0.0/15043] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.block.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.block.client.port appended with serviceId and nodeId
2021-10-05 13:23:44,865 [Listener at 0.0.0.0/15043] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.datanode.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.datanode.port appended with serviceId and nodeId
OM initialization succeeded.Current cluster id for sd=/home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-98f4f1fb-613f-4a4a-83a3-c748f4b4520d/omNode-1/om;cid=98f4f1fb-613f-4a4a-83a3-c748f4b4520d;layoutVersion=0
2021-10-05 13:23:44,879 [Listener at 0.0.0.0/15043] INFO  ha.OMHANodeDetails (OMHANodeDetails.java:loadOMHAConfig(118)) - ServiceID for OzoneManager is om-service-test1
2021-10-05 13:23:44,881 [Listener at 0.0.0.0/15043] INFO  ha.OMHANodeDetails (OMHANodeDetails.java:loadOMHAConfig(194)) - Found matching OM address with OMServiceId: om-service-test1, OMNodeId: omNode-1, RPC Address: localhost:10356 and Ratis port: 10360
2021-10-05 13:23:44,881 [Listener at 0.0.0.0/15043] INFO  ha.OMHANodeDetails (ConfUtils.java:setNodeSpecificConfigs(108)) - Setting configuration key ozone.om.http-address with value of key ozone.om.http-address.om-service-test1.omNode-1: 127.0.0.1:10358
2021-10-05 13:23:44,881 [Listener at 0.0.0.0/15043] INFO  ha.OMHANodeDetails (ConfUtils.java:setNodeSpecificConfigs(108)) - Setting configuration key ozone.om.https-address with value of key ozone.om.https-address.om-service-test1.omNode-1: 127.0.0.1:10359
2021-10-05 13:23:44,881 [Listener at 0.0.0.0/15043] INFO  ha.OMHANodeDetails (ConfUtils.java:setNodeSpecificConfigs(108)) - Setting configuration key ozone.om.address with value of key ozone.om.address.om-service-test1.omNode-1: 127.0.0.1:10356
2021-10-05 13:23:44,881 [Listener at 0.0.0.0/15043] WARN  server.ServerUtils (ServerUtils.java:getDBPath(225)) - ozone.om.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2021-10-05 13:23:44,883 [Listener at 0.0.0.0/15043] INFO  upgrade.AbstractLayoutVersionManager (AbstractLayoutVersionManager.java:init(79)) - Initializing Layout version manager with metadata layout = INITIAL_VERSION (version = 0), software layout = INITIAL_VERSION (version = 0)
2021-10-05 13:23:44,930 [Listener at 0.0.0.0/15043] INFO  reflections.Reflections (Reflections.java:scan(232)) - Reflections took 41 ms to scan 2 urls, producing 131 keys and 342 values [using 2 cores]
2021-10-05 13:23:44,933 [Listener at 0.0.0.0/15043] INFO  upgrade.OMLayoutVersionManager (OMLayoutVersionManager.java:lambda$0(115)) - Skipping Upgrade Action MockOmUpgradeAction since it has been finalized.
2021-10-05 13:23:44,934 [Listener at 0.0.0.0/15043] WARN  server.ServerUtils (ServerUtils.java:getDBPath(225)) - ozone.om.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2021-10-05 13:23:45,090 [Listener at 0.0.0.0/15043] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.client.port appended with serviceId and nodeId
2021-10-05 13:23:45,090 [Listener at 0.0.0.0/15043] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.block.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.block.client.port appended with serviceId and nodeId
2021-10-05 13:23:45,091 [Listener at 0.0.0.0/15043] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.datanode.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.datanode.port appended with serviceId and nodeId
2021-10-05 13:23:45,091 [Listener at 0.0.0.0/15043] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.client.port appended with serviceId and nodeId
2021-10-05 13:23:45,091 [Listener at 0.0.0.0/15043] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.block.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.block.client.port appended with serviceId and nodeId
2021-10-05 13:23:45,091 [Listener at 0.0.0.0/15043] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.datanode.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.datanode.port appended with serviceId and nodeId
2021-10-05 13:23:45,091 [Listener at 0.0.0.0/15043] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.client.port appended with serviceId and nodeId
2021-10-05 13:23:45,092 [Listener at 0.0.0.0/15043] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.block.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.block.client.port appended with serviceId and nodeId
2021-10-05 13:23:45,092 [Listener at 0.0.0.0/15043] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.datanode.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.datanode.port appended with serviceId and nodeId
2021-10-05 13:23:45,203 [Listener at 0.0.0.0/15043] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.client.port appended with serviceId and nodeId
2021-10-05 13:23:45,204 [Listener at 0.0.0.0/15043] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.block.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.block.client.port appended with serviceId and nodeId
2021-10-05 13:23:45,204 [Listener at 0.0.0.0/15043] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.datanode.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.datanode.port appended with serviceId and nodeId
2021-10-05 13:23:45,204 [Listener at 0.0.0.0/15043] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.client.port appended with serviceId and nodeId
2021-10-05 13:23:45,204 [Listener at 0.0.0.0/15043] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.block.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.block.client.port appended with serviceId and nodeId
2021-10-05 13:23:45,204 [Listener at 0.0.0.0/15043] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.datanode.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.datanode.port appended with serviceId and nodeId
2021-10-05 13:23:45,204 [Listener at 0.0.0.0/15043] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.client.port appended with serviceId and nodeId
2021-10-05 13:23:45,204 [Listener at 0.0.0.0/15043] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.block.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.block.client.port appended with serviceId and nodeId
2021-10-05 13:23:45,204 [Listener at 0.0.0.0/15043] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.datanode.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.datanode.port appended with serviceId and nodeId
2021-10-05 13:23:45,206 [Listener at 0.0.0.0/15043] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.client.port appended with serviceId and nodeId
2021-10-05 13:23:45,206 [Listener at 0.0.0.0/15043] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.block.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.block.client.port appended with serviceId and nodeId
2021-10-05 13:23:45,207 [Listener at 0.0.0.0/15043] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.datanode.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.datanode.port appended with serviceId and nodeId
2021-10-05 13:23:45,207 [Listener at 0.0.0.0/15043] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.client.port appended with serviceId and nodeId
2021-10-05 13:23:45,207 [Listener at 0.0.0.0/15043] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.block.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.block.client.port appended with serviceId and nodeId
2021-10-05 13:23:45,207 [Listener at 0.0.0.0/15043] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.datanode.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.datanode.port appended with serviceId and nodeId
2021-10-05 13:23:45,207 [Listener at 0.0.0.0/15043] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.client.port appended with serviceId and nodeId
2021-10-05 13:23:45,207 [Listener at 0.0.0.0/15043] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.block.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.block.client.port appended with serviceId and nodeId
2021-10-05 13:23:45,207 [Listener at 0.0.0.0/15043] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.datanode.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.datanode.port appended with serviceId and nodeId
2021-10-05 13:23:45,247 [Listener at 0.0.0.0/15043] WARN  server.ServerUtils (ServerUtils.java:getDBPath(225)) - ozone.om.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2021-10-05 13:23:45,253 [Listener at 0.0.0.0/15043] INFO  codec.OmKeyInfoCodec (OmKeyInfoCodec.java:<init>(51)) - OmKeyInfoCodec ignorePipeline = true
2021-10-05 13:23:45,259 [Listener at 0.0.0.0/15043] INFO  codec.RepeatedOmKeyInfoCodec (RepeatedOmKeyInfoCodec.java:<init>(42)) - RepeatedOmKeyInfoCodec ignorePipeline = true
2021-10-05 13:23:45,445 [Listener at 0.0.0.0/15043] INFO  om.OzoneManager (OzoneManager.java:addS3GVolumeToDB(4127)) - Created Volume s3v With Owner runner required for S3Gateway operations.
2021-10-05 13:23:45,508 [Listener at 0.0.0.0/15043] WARN  server.ServerUtils (ServerUtils.java:getDefaultRatisDirectory(237)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2021-10-05 13:23:45,508 [Listener at 0.0.0.0/15043] WARN  utils.OzoneManagerRatisUtils (OzoneManagerRatisUtils.java:getOMRatisSnapshotDirectory(435)) - ozone.om.ratis.snapshot.dir is not configured. Falling back to ozone.metadata.dirs config
2021-10-05 13:23:45,512 [Listener at 0.0.0.0/15043] WARN  impl.MetricRegistriesImpl (MetricRegistriesImpl.java:addReporterRegistration(111)) - New reporters are added after registries were created. Some metrics will be missing from the reporter. Please add reporter before adding any new registry.
2021-10-05 13:23:45,512 [Listener at 0.0.0.0/15043] WARN  impl.MetricRegistriesImpl (MetricRegistriesImpl.java:addReporterRegistration(111)) - New reporters are added after registries were created. Some metrics will be missing from the reporter. Please add reporter before adding any new registry.
2021-10-05 13:23:45,513 [Listener at 0.0.0.0/15043] WARN  server.ServerUtils (ServerUtils.java:getDefaultRatisDirectory(237)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2021-10-05 13:23:45,515 [Listener at 0.0.0.0/15043] INFO  ratis.OzoneManagerRatisServer (OzoneManagerRatisServer.java:<init>(158)) - Instantiating OM Ratis server with groupID: om-service-test1 and peers: localhost:10360
2021-10-05 13:23:45,518 [Listener at 0.0.0.0/15043] INFO  ratis.OzoneManagerStateMachine (OzoneManagerStateMachine.java:loadSnapshotInfoFromDB(605)) - LastAppliedIndex is set from TransactionInfo from OM DB as (t:0, i:~)
2021-10-05 13:23:45,527 [Listener at 0.0.0.0/15043] INFO  server.RaftServer (ConfUtils.java:logGet(44)) - raft.rpc.type = GRPC (default)
2021-10-05 13:23:45,527 [Listener at 0.0.0.0/15043] INFO  grpc.GrpcFactory (GrpcFactory.java:checkPooledByteBufAllocatorUseCacheForAllThreads(48)) - PERFORMANCE WARNING: useCacheForAllThreads is true that may cause Netty to create a lot garbage objects and, as a result, trigger GC.
	It is recommended to disable useCacheForAllThreads by setting -Dorg.apache.ratis.thirdparty.io.netty.allocator.useCacheForAllThreads=false in command line.
2021-10-05 13:23:45,528 [Listener at 0.0.0.0/15043] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(44)) - raft.grpc.admin.port = -1 (default)
2021-10-05 13:23:45,528 [Listener at 0.0.0.0/15043] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(44)) - raft.grpc.server.port = 10360 (custom)
2021-10-05 13:23:45,528 [Listener at 0.0.0.0/15043] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(44)) - raft.grpc.client.port = -1 (default)
2021-10-05 13:23:45,528 [Listener at 0.0.0.0/15043] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(44)) - raft.grpc.server.port = 10360 (custom)
2021-10-05 13:23:45,528 [Listener at 0.0.0.0/15043] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(44)) - raft.grpc.server.port = 10360 (custom)
2021-10-05 13:23:45,528 [Listener at 0.0.0.0/15043] INFO  server.GrpcService (ConfUtils.java:logGet(44)) - raft.grpc.message.size.max = 33554432 (custom)
2021-10-05 13:23:45,528 [Listener at 0.0.0.0/15043] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2021-10-05 13:23:45,529 [Listener at 0.0.0.0/15043] INFO  server.GrpcService (ConfUtils.java:logGet(44)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2021-10-05 13:23:45,529 [Listener at 0.0.0.0/15043] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.request.timeout = 3000ms (default)
2021-10-05 13:23:45,530 [Listener at 0.0.0.0/15043] INFO  impl.DataStreamServerImpl (ConfUtils.java:logGet(44)) - raft.datastream.type = DISABLED (default)
2021-10-05 13:23:45,530 [Listener at 0.0.0.0/15043] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.slowness.timeout = 2s (custom)
2021-10-05 13:23:45,530 [Listener at 0.0.0.0/15043] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.leaderelection.leader.step-down.wait-time = 10s (default)
2021-10-05 13:23:45,531 [Listener at 0.0.0.0/15043] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.storage.dir = [/home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-98f4f1fb-613f-4a4a-83a3-c748f4b4520d/omNode-1/ratis] (custom)
2021-10-05 13:23:45,531 [Listener at 0.0.0.0/15043] INFO  server.RaftServer (RaftServerProxy.java:addNew(95)) - omNode-1: addNew group-523986131536:[omNode-1|rpc:localhost:10360|priority:0] returns group-523986131536:java.util.concurrent.CompletableFuture@26ac8501[Not completed]
2021-10-05 13:23:45,531 [Listener at 0.0.0.0/15043] INFO  om.OzoneManager (OzoneManager.java:initializeRatisServer(1585)) - OzoneManager Ratis server initialized at port 10360
2021-10-05 13:23:45,539 [pool-81-thread-1] INFO  server.RaftServer$Division (RaftServerImpl.java:<init>(181)) - omNode-1: new RaftServerImpl for group-523986131536:[omNode-1|rpc:localhost:10360|priority:0] with OzoneManagerStateMachine:uninitialized
2021-10-05 13:23:45,540 [pool-81-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.timeout.min = 1s (custom)
2021-10-05 13:23:45,540 [pool-81-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.timeout.max = 1200ms (custom)
2021-10-05 13:23:45,540 [pool-81-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.sleep.time = 25ms (default)
2021-10-05 13:23:45,541 [pool-81-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.slowness.timeout = 2s (custom)
2021-10-05 13:23:45,541 [pool-81-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.leaderelection.leader.step-down.wait-time = 10s (default)
2021-10-05 13:23:45,541 [pool-81-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.sleep.deviation.threshold = 300ms (default)
2021-10-05 13:23:45,541 [pool-81-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.appender.install.snapshot.enabled = false (custom)
2021-10-05 13:23:45,541 [pool-81-thread-1] INFO  server.RaftServer$Division (ServerState.java:<init>(105)) - omNode-1@group-523986131536: ConfigurationManager, init=-1: [omNode-1|rpc:localhost:10360|priority:0], old=null, confs=<EMPTY_MAP>
2021-10-05 13:23:45,541 [pool-81-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.storage.dir = [/home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-98f4f1fb-613f-4a4a-83a3-c748f4b4520d/omNode-1/ratis] (custom)
2021-10-05 13:23:45,541 [pool-81-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.corruption.policy = EXCEPTION (default)
2021-10-05 13:23:45,541 [pool-81-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.storage.free-space.min = 0MB (=0) (default)
2021-10-05 13:23:45,541 [pool-81-thread-1] INFO  storage.RaftStorageDirectory (RaftStorageDirectoryImpl.java:analyzeStorage(135)) - The storage directory /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-98f4f1fb-613f-4a4a-83a3-c748f4b4520d/omNode-1/ratis/c9bc4cf4-3bc3-3c60-a66b-523986131536 does not exist. Creating ...
2021-10-05 13:23:45,544 [pool-81-thread-1] INFO  storage.RaftStorageDirectory (RaftStorageDirectoryImpl.java:tryLock(230)) - Lock on /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-98f4f1fb-613f-4a4a-83a3-c748f4b4520d/omNode-1/ratis/c9bc4cf4-3bc3-3c60-a66b-523986131536/in_use.lock acquired by nodename 17451@fv-az270-324
2021-10-05 13:23:45,546 [pool-81-thread-1] INFO  storage.RaftStorage (RaftStorageImpl.java:format(89)) - Storage directory /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-98f4f1fb-613f-4a4a-83a3-c748f4b4520d/omNode-1/ratis/c9bc4cf4-3bc3-3c60-a66b-523986131536 has been successfully formatted.
2021-10-05 13:23:45,546 [pool-81-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.notification.no-leader.timeout = 2s (custom)
2021-10-05 13:23:45,547 [pool-81-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.use.memory = false (default)
2021-10-05 13:23:45,547 [pool-81-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.purge.gap = 1000000 (custom)
2021-10-05 13:23:45,547 [pool-81-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2021-10-05 13:23:45,547 [pool-81-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.segment.size.max = 4194304 (custom)
2021-10-05 13:23:45,548 [pool-81-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.segment.cache.num.max = 2 (custom)
2021-10-05 13:23:45,548 [pool-81-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.segment.cache.size.max = 200MB (=209715200) (default)
2021-10-05 13:23:45,548 [pool-81-thread-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:<init>(182)) - new omNode-1@group-523986131536-SegmentedRaftLogWorker for RaftStorageImpl:Storage Directory /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-98f4f1fb-613f-4a4a-83a3-c748f4b4520d/omNode-1/ratis/c9bc4cf4-3bc3-3c60-a66b-523986131536
2021-10-05 13:23:45,548 [pool-81-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.queue.byte-limit = 64MB (=67108864) (default)
2021-10-05 13:23:45,548 [pool-81-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.queue.element-limit = 4096 (default)
2021-10-05 13:23:45,548 [pool-81-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.segment.size.max = 4194304 (custom)
2021-10-05 13:23:45,548 [pool-81-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.preallocated.size = 4194304 (custom)
2021-10-05 13:23:45,548 [pool-81-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.force.sync.num = 128 (default)
2021-10-05 13:23:45,548 [pool-81-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.statemachine.data.sync = true (default)
2021-10-05 13:23:45,548 [pool-81-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2021-10-05 13:23:45,548 [pool-81-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2021-10-05 13:23:45,549 [pool-81-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.write.buffer.size = 64KB (=65536) (default)
2021-10-05 13:23:45,549 [pool-81-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.statemachine.data.caching.enabled = false (default)
2021-10-05 13:23:45,550 [pool-81-thread-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:lambda$new$0(133)) - omNode-1@group-523986131536-SegmentedRaftLogWorker: flushIndex: setUnconditionally 0 -> -1
2021-10-05 13:23:45,550 [pool-81-thread-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:lambda$new$0(133)) - omNode-1@group-523986131536-SegmentedRaftLogWorker: safeCacheEvictIndex: setUnconditionally 0 -> -1
2021-10-05 13:23:45,550 [Listener at 0.0.0.0/15043] INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(90)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 2000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false.
2021-10-05 13:23:45,553 [pool-81-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2021-10-05 13:23:45,553 [pool-81-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.snapshot.auto.trigger.threshold = 400000 (default)
2021-10-05 13:23:45,553 [pool-81-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.snapshot.retention.file.num = -1 (default)
2021-10-05 13:23:45,553 [pool-81-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.purge.upto.snapshot.index = true (custom)
2021-10-05 13:23:45,553 [pool-81-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.retrycache.expirytime = 300s (custom)
2021-10-05 13:23:45,553 [pool-81-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.retrycache.statistics.expirytime = 100μs (default)
2021-10-05 13:23:45,554 [Socket Reader #1 for port 10356] INFO  ipc.Server (Server.java:run(1265)) - Starting Socket Reader #1 for port 10356
2021-10-05 13:23:45,579 [Listener at 127.0.0.1/10356] INFO  om.OzoneManager (OzoneManager.java:initFSOLayout(4333)) - Configured ozone.om.metadata.layout=SIMPLE and disabled optimized OM FS operations
2021-10-05 13:23:45,579 [Listener at 127.0.0.1/10356] INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:init(158)) - OzoneManager metrics system started (again)
2021-10-05 13:23:45,592 [Listener at 127.0.0.1/10356] INFO  om.OzoneManager (OzoneManager.java:start(1281)) - OzoneManager RPC server is listening at localhost/127.0.0.1:10356
2021-10-05 13:23:45,592 [Listener at 127.0.0.1/10356] INFO  ratis.OzoneManagerRatisServer (OzoneManagerRatisServer.java:start(516)) - Starting OzoneManagerRatisServer omNode-1 at port 10360
2021-10-05 13:23:45,592 [Listener at 127.0.0.1/10356] INFO  server.RaftServer$Division (RaftServerImpl.java:start(296)) - omNode-1@group-523986131536: start as a follower, conf=-1: [omNode-1|rpc:localhost:10360|priority:0], old=null
2021-10-05 13:23:45,593 [Listener at 127.0.0.1/10356] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(285)) - omNode-1@group-523986131536: changes role from      null to FOLLOWER at term 0 for startAsFollower
2021-10-05 13:23:45,593 [Listener at 127.0.0.1/10356] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(130)) - omNode-1: start omNode-1@group-523986131536-FollowerState
2021-10-05 13:23:45,599 [Listener at 127.0.0.1/10356] INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-523986131536,id=omNode-1
2021-10-05 13:23:45,601 [Listener at 127.0.0.1/10356] INFO  server.RaftServer (RaftServerProxy.java:lambda$start$5(374)) - omNode-1: start RPC server
2021-10-05 13:23:45,604 [Listener at 127.0.0.1/10356] INFO  server.GrpcService (GrpcService.java:startImpl(253)) - omNode-1: GrpcService started, listening on 10360
2021-10-05 13:23:45,605 [Listener at 127.0.0.1/10356] INFO  om.OzoneManager (OzoneManager.java:start(1299)) - Version File has different layout version (0) than OM DB (null). That is expected if this OM has never been finalized to a newer layout version.
2021-10-05 13:23:45,606 [org.apache.ratis.util.JvmPauseMonitor$$Lambda$499/1586779822@440e28fa] INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(103)) - JvmPauseMonitor-omNode-1: Started
2021-10-05 13:23:45,617 [Listener at 127.0.0.1/10356] INFO  http.BaseHttpServer (BaseHttpServer.java:newHttpServer2BuilderForOzone(209)) - Starting Web-server for ozoneManager at: http://0.0.0.0:10358
2021-10-05 13:23:45,617 [Listener at 127.0.0.1/10356] INFO  http.BaseHttpServer (BaseHttpServer.java:<init>(107)) - Hadoop Security Enabled: false Ozone Security Enabled: false Ozone HTTP Security Enabled: false 
2021-10-05 13:23:45,618 [Listener at 127.0.0.1/10356] INFO  server.AuthenticationFilter (AuthenticationFilter.java:constructSecretProvider(240)) - Unable to initialize FileSignerSecretProvider, falling back to use random secrets.
2021-10-05 13:23:45,622 [Listener at 127.0.0.1/10356] WARN  http.HttpRequestLog (HttpRequestLog.java:getRequestLog(103)) - Jetty request log can only be enabled using Log4j
2021-10-05 13:23:45,623 [Listener at 127.0.0.1/10356] INFO  http.HttpServer2 (HttpServer2.java:addGlobalFilter(1030)) - Added global filter 'safety' (class=org.apache.hadoop.hdds.server.http.HttpServer2$QuotingInputFilter)
2021-10-05 13:23:45,624 [Listener at 127.0.0.1/10356] INFO  http.HttpServer2 (HttpServer2.java:addFilter(1006)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context ozoneManager
2021-10-05 13:23:45,624 [Listener at 127.0.0.1/10356] INFO  http.HttpServer2 (HttpServer2.java:addFilter(1014)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context logs
2021-10-05 13:23:45,624 [Listener at 127.0.0.1/10356] INFO  http.HttpServer2 (HttpServer2.java:addFilter(1014)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context static
2021-10-05 13:23:45,626 [Listener at 127.0.0.1/10356] INFO  http.HttpServer2 (HttpServer2.java:bindListener(1249)) - Jetty bound to port 10358
2021-10-05 13:23:45,626 [Listener at 127.0.0.1/10356] INFO  server.Server (Server.java:doStart(375)) - jetty-9.4.43.v20210629; built: 2021-06-30T11:07:22.254Z; git: 526006ecfa3af7f1a27ef3a288e2bef7ea9dd7e8; jvm 1.8.0_292-b10
2021-10-05 13:23:45,632 [Listener at 127.0.0.1/10356] INFO  server.session (DefaultSessionIdManager.java:doStart(334)) - DefaultSessionIdManager workerName=node0
2021-10-05 13:23:45,632 [Listener at 127.0.0.1/10356] INFO  server.session (DefaultSessionIdManager.java:doStart(339)) - No SessionScavenger set, using defaults
2021-10-05 13:23:45,633 [Listener at 127.0.0.1/10356] INFO  server.session (HouseKeeper.java:startScavenging(132)) - node0 Scavenging every 660000ms
2021-10-05 13:23:45,633 [Listener at 127.0.0.1/10356] INFO  handler.ContextHandler (ContextHandler.java:doStart(915)) - Started o.e.j.s.ServletContextHandler@445eed0b{logs,/logs,file:///home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/log,AVAILABLE}
2021-10-05 13:23:45,634 [Listener at 127.0.0.1/10356] INFO  handler.ContextHandler (ContextHandler.java:doStart(915)) - Started o.e.j.s.ServletContextHandler@2a201aa9{static,/static,file:///home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-classes/webapps/static,AVAILABLE}
2021-10-05 13:23:45,637 [Listener at 127.0.0.1/10356] INFO  handler.ContextHandler (ContextHandler.java:doStart(915)) - Started o.e.j.w.WebAppContext@1427cc16{ozoneManager,/,file:///home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-classes/webapps/ozoneManager/,AVAILABLE}{file:/home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-classes/webapps/ozoneManager}
2021-10-05 13:23:45,639 [Listener at 127.0.0.1/10356] INFO  server.AbstractConnector (AbstractConnector.java:doStart(331)) - Started ServerConnector@63f38fb1{HTTP/1.1, (http/1.1)}{0.0.0.0:10358}
2021-10-05 13:23:45,639 [Listener at 127.0.0.1/10356] INFO  server.Server (Server.java:doStart(415)) - Started @19298ms
2021-10-05 13:23:45,639 [Listener at 127.0.0.1/10356] WARN  impl.MetricsSystemImpl (MetricsSystemImpl.java:register(279)) - Sink prometheus already exists!
2021-10-05 13:23:45,640 [Listener at 127.0.0.1/10356] INFO  http.BaseHttpServer (BaseHttpServer.java:updateConnectorAddress(329)) - HTTP server of ozoneManager listening at http://0.0.0.0:10358
2021-10-05 13:23:45,640 [IPC Server Responder] INFO  ipc.Server (Server.java:run(1507)) - IPC Server Responder: starting
2021-10-05 13:23:45,640 [IPC Server listener on 10356] INFO  ipc.Server (Server.java:run(1344)) - IPC Server listener on 10356: starting
2021-10-05 13:23:45,643 [Listener at 127.0.0.1/10356] INFO  om.OzoneManager (OzoneManager.java:startTrashEmptier(1543)) - Trash Interval set to 0. Files deleted will not move to trash
2021-10-05 13:23:45,644 [Listener at 127.0.0.1/10356] INFO  ozone.MiniOzoneHAClusterImpl (MiniOzoneHAClusterImpl.java:createOMService(485)) - Started OzoneManager omNode-1 RPC server at localhost/127.0.0.1:10356
2021-10-05 13:23:45,653 [org.apache.hadoop.util.JvmPauseMonitor$Monitor@23f41ce3] INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(188)) - Starting JVM pause monitor
2021-10-05 13:23:45,782 [Listener at 127.0.0.1/10356] WARN  impl.MetricRegistriesImpl (MetricRegistriesImpl.java:addReporterRegistration(111)) - New reporters are added after registries were created. Some metrics will be missing from the reporter. Please add reporter before adding any new registry.
2021-10-05 13:23:45,782 [Listener at 127.0.0.1/10356] WARN  impl.MetricRegistriesImpl (MetricRegistriesImpl.java:addReporterRegistration(111)) - New reporters are added after registries were created. Some metrics will be missing from the reporter. Please add reporter before adding any new registry.
2021-10-05 13:23:45,782 [Listener at 127.0.0.1/10356] INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:init(158)) - HddsDatanode metrics system started (again)
2021-10-05 13:23:45,800 [Listener at 127.0.0.1/10356] INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:start(234)) - HddsDatanodeService host:fv-az270-324.tacnzluakwdehk1hpragurqkma.bx.internal.cloudapp.net ip:10.1.0.10
2021-10-05 13:23:45,831 [Listener at 127.0.0.1/10356] INFO  upgrade.AbstractLayoutVersionManager (AbstractLayoutVersionManager.java:init(79)) - Initializing Layout version manager with metadata layout = SCM_HA (version = 2), software layout = SCM_HA (version = 2)
2021-10-05 13:23:45,868 [Listener at 127.0.0.1/10356] INFO  reflections.Reflections (Reflections.java:scan(232)) - Reflections took 36 ms to scan 7 urls, producing 119 keys and 275 values 
2021-10-05 13:23:45,872 [Listener at 127.0.0.1/10356] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.client.port appended with serviceId and nodeId
2021-10-05 13:23:45,872 [Listener at 127.0.0.1/10356] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.block.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.block.client.port appended with serviceId and nodeId
2021-10-05 13:23:45,873 [Listener at 127.0.0.1/10356] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.datanode.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.datanode.port appended with serviceId and nodeId
2021-10-05 13:23:45,873 [Listener at 127.0.0.1/10356] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.client.port appended with serviceId and nodeId
2021-10-05 13:23:45,873 [Listener at 127.0.0.1/10356] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.block.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.block.client.port appended with serviceId and nodeId
2021-10-05 13:23:45,873 [Listener at 127.0.0.1/10356] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.datanode.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.datanode.port appended with serviceId and nodeId
2021-10-05 13:23:45,873 [Listener at 127.0.0.1/10356] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.client.port appended with serviceId and nodeId
2021-10-05 13:23:45,873 [Listener at 127.0.0.1/10356] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.block.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.block.client.port appended with serviceId and nodeId
2021-10-05 13:23:45,873 [Listener at 127.0.0.1/10356] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.datanode.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.datanode.port appended with serviceId and nodeId
2021-10-05 13:23:45,927 [Listener at 127.0.0.1/10356] INFO  volume.HddsVolume (HddsVolume.java:<init>(120)) - Creating HddsVolume: /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-98f4f1fb-613f-4a4a-83a3-c748f4b4520d/datanode-0/data-0/containers/hdds of storage type : DISK capacity : 9223372036854775807
2021-10-05 13:23:45,929 [Listener at 127.0.0.1/10356] INFO  volume.MutableVolumeSet (MutableVolumeSet.java:initializeVolumeSet(168)) - Added Volume : /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-98f4f1fb-613f-4a4a-83a3-c748f4b4520d/datanode-0/data-0/containers/hdds to VolumeSet
2021-10-05 13:23:45,930 [Listener at 127.0.0.1/10356] INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(141)) - Scheduling a check for /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-98f4f1fb-613f-4a4a-83a3-c748f4b4520d/datanode-0/data-0/containers/hdds
2021-10-05 13:23:45,948 [Listener at 127.0.0.1/10356] INFO  volume.StorageVolumeChecker (StorageVolumeChecker.java:checkAllVolumes(202)) - Scheduled health check for volume /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-98f4f1fb-613f-4a4a-83a3-c748f4b4520d/datanode-0/data-0/containers/hdds
2021-10-05 13:23:45,967 [Listener at 127.0.0.1/10356] INFO  volume.MutableVolumeSet (MutableVolumeSet.java:initializeVolumeSet(168)) - Added Volume : /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-98f4f1fb-613f-4a4a-83a3-c748f4b4520d/datanode-0/data/ratis to VolumeSet
2021-10-05 13:23:45,967 [Listener at 127.0.0.1/10356] INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(141)) - Scheduling a check for /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-98f4f1fb-613f-4a4a-83a3-c748f4b4520d/datanode-0/data/ratis
2021-10-05 13:23:45,968 [Listener at 127.0.0.1/10356] INFO  volume.StorageVolumeChecker (StorageVolumeChecker.java:checkAllVolumes(202)) - Scheduled health check for volume /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-98f4f1fb-613f-4a4a-83a3-c748f4b4520d/datanode-0/data/ratis
2021-10-05 13:23:45,985 [Thread-487] INFO  ozoneimpl.ContainerReader (ContainerReader.java:readVolume(172)) - Finish verifying containers on volume /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-98f4f1fb-613f-4a4a-83a3-c748f4b4520d/datanode-0/data-0/containers/hdds
2021-10-05 13:23:45,985 [Listener at 127.0.0.1/10356] INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:buildContainerSet(236)) - Build ContainerSet costs 0s
2021-10-05 13:23:46,046 [Listener at 127.0.0.1/10356] INFO  server.RaftServer (ConfUtils.java:logGet(44)) - raft.rpc.type = GRPC (default)
2021-10-05 13:23:46,046 [Listener at 127.0.0.1/10356] INFO  grpc.GrpcFactory (GrpcFactory.java:checkPooledByteBufAllocatorUseCacheForAllThreads(48)) - PERFORMANCE WARNING: useCacheForAllThreads is true that may cause Netty to create a lot garbage objects and, as a result, trigger GC.
	It is recommended to disable useCacheForAllThreads by setting -Dorg.apache.ratis.thirdparty.io.netty.allocator.useCacheForAllThreads=false in command line.
2021-10-05 13:23:46,047 [Listener at 127.0.0.1/10356] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(44)) - raft.grpc.admin.port = 0 (custom)
2021-10-05 13:23:46,047 [Listener at 127.0.0.1/10356] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(44)) - raft.grpc.client.port = 0 (custom)
2021-10-05 13:23:46,047 [Listener at 127.0.0.1/10356] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(44)) - raft.grpc.server.port = 0 (default)
2021-10-05 13:23:46,047 [Listener at 127.0.0.1/10356] INFO  server.GrpcService (ConfUtils.java:logGet(44)) - raft.grpc.message.size.max = 32MB (=33554432) (custom)
2021-10-05 13:23:46,047 [Listener at 127.0.0.1/10356] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2021-10-05 13:23:46,048 [Listener at 127.0.0.1/10356] INFO  server.GrpcService (ConfUtils.java:logGet(44)) - raft.grpc.flow.control.window = 5MB (=5242880) (custom)
2021-10-05 13:23:46,048 [Listener at 127.0.0.1/10356] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.request.timeout = 60s (custom)
2021-10-05 13:23:46,049 [Listener at 127.0.0.1/10356] INFO  impl.DataStreamServerImpl (ConfUtils.java:logGet(44)) - raft.datastream.type = DISABLED (default)
2021-10-05 13:23:46,049 [Listener at 127.0.0.1/10356] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.slowness.timeout = 300s (custom)
2021-10-05 13:23:46,049 [Listener at 127.0.0.1/10356] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.leaderelection.leader.step-down.wait-time = 10s (default)
2021-10-05 13:23:46,050 [Listener at 127.0.0.1/10356] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.storage.dir = [/home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-98f4f1fb-613f-4a4a-83a3-c748f4b4520d/datanode-0/data/ratis] (custom)
2021-10-05 13:23:46,122 [Listener at 127.0.0.1/10356] INFO  http.BaseHttpServer (BaseHttpServer.java:newHttpServer2BuilderForOzone(209)) - Starting Web-server for hddsDatanode at: http://0.0.0.0:0
2021-10-05 13:23:46,122 [Listener at 127.0.0.1/10356] INFO  http.BaseHttpServer (BaseHttpServer.java:<init>(107)) - Hadoop Security Enabled: false Ozone Security Enabled: false Ozone HTTP Security Enabled: false 
2021-10-05 13:23:46,123 [Listener at 127.0.0.1/10356] INFO  server.AuthenticationFilter (AuthenticationFilter.java:constructSecretProvider(240)) - Unable to initialize FileSignerSecretProvider, falling back to use random secrets.
2021-10-05 13:23:46,127 [Listener at 127.0.0.1/10356] WARN  http.HttpRequestLog (HttpRequestLog.java:getRequestLog(103)) - Jetty request log can only be enabled using Log4j
2021-10-05 13:23:46,128 [Listener at 127.0.0.1/10356] INFO  http.HttpServer2 (HttpServer2.java:addGlobalFilter(1030)) - Added global filter 'safety' (class=org.apache.hadoop.hdds.server.http.HttpServer2$QuotingInputFilter)
2021-10-05 13:23:46,129 [Listener at 127.0.0.1/10356] INFO  http.HttpServer2 (HttpServer2.java:addFilter(1006)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context hddsDatanode
2021-10-05 13:23:46,129 [Listener at 127.0.0.1/10356] INFO  http.HttpServer2 (HttpServer2.java:addFilter(1014)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context logs
2021-10-05 13:23:46,129 [Listener at 127.0.0.1/10356] INFO  http.HttpServer2 (HttpServer2.java:addFilter(1014)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context static
2021-10-05 13:23:46,130 [Listener at 127.0.0.1/10356] INFO  http.HttpServer2 (HttpServer2.java:bindListener(1249)) - Jetty bound to port 40047
2021-10-05 13:23:46,130 [Listener at 127.0.0.1/10356] INFO  server.Server (Server.java:doStart(375)) - jetty-9.4.43.v20210629; built: 2021-06-30T11:07:22.254Z; git: 526006ecfa3af7f1a27ef3a288e2bef7ea9dd7e8; jvm 1.8.0_292-b10
2021-10-05 13:23:46,142 [Listener at 127.0.0.1/10356] INFO  server.session (DefaultSessionIdManager.java:doStart(334)) - DefaultSessionIdManager workerName=node0
2021-10-05 13:23:46,143 [Listener at 127.0.0.1/10356] INFO  server.session (DefaultSessionIdManager.java:doStart(339)) - No SessionScavenger set, using defaults
2021-10-05 13:23:46,143 [Listener at 127.0.0.1/10356] INFO  server.session (HouseKeeper.java:startScavenging(132)) - node0 Scavenging every 600000ms
2021-10-05 13:23:46,144 [Listener at 127.0.0.1/10356] INFO  handler.ContextHandler (ContextHandler.java:doStart(915)) - Started o.e.j.s.ServletContextHandler@15d0d8c{logs,/logs,file:///home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/log,AVAILABLE}
2021-10-05 13:23:46,144 [Listener at 127.0.0.1/10356] INFO  handler.ContextHandler (ContextHandler.java:doStart(915)) - Started o.e.j.s.ServletContextHandler@36db2ef8{static,/static,jar:file:/home/runner/.m2/repository/org/apache/ozone/hdds-container-service/1.2.0-SNAPSHOT/hdds-container-service-1.2.0-SNAPSHOT.jar!/webapps/static,AVAILABLE}
2021-10-05 13:23:46,193 [Listener at 127.0.0.1/10356] INFO  handler.ContextHandler (ContextHandler.java:doStart(915)) - Started o.e.j.w.WebAppContext@47af69bc{hddsDatanode,/,file:///tmp/jetty-0_0_0_0-40047-hdds-container-service-1_2_0-SNAPSHOT_jar-_-any-8280036758017444702/webapp/,AVAILABLE}{jar:file:/home/runner/.m2/repository/org/apache/ozone/hdds-container-service/1.2.0-SNAPSHOT/hdds-container-service-1.2.0-SNAPSHOT.jar!/webapps/hddsDatanode}
2021-10-05 13:23:46,195 [Listener at 127.0.0.1/10356] INFO  server.AbstractConnector (AbstractConnector.java:doStart(331)) - Started ServerConnector@2063d1c8{HTTP/1.1, (http/1.1)}{0.0.0.0:40047}
2021-10-05 13:23:46,196 [Listener at 127.0.0.1/10356] INFO  server.Server (Server.java:doStart(415)) - Started @19855ms
2021-10-05 13:23:46,196 [Listener at 127.0.0.1/10356] WARN  impl.MetricsSystemImpl (MetricsSystemImpl.java:register(279)) - Sink prometheus already exists!
2021-10-05 13:23:46,196 [Listener at 127.0.0.1/10356] INFO  http.BaseHttpServer (BaseHttpServer.java:updateConnectorAddress(329)) - HTTP server of hddsDatanode listening at http://0.0.0.0:40047
2021-10-05 13:23:46,198 [Listener at 127.0.0.1/10356] WARN  impl.MetricRegistriesImpl (MetricRegistriesImpl.java:addReporterRegistration(111)) - New reporters are added after registries were created. Some metrics will be missing from the reporter. Please add reporter before adding any new registry.
2021-10-05 13:23:46,198 [Listener at 127.0.0.1/10356] WARN  impl.MetricRegistriesImpl (MetricRegistriesImpl.java:addReporterRegistration(111)) - New reporters are added after registries were created. Some metrics will be missing from the reporter. Please add reporter before adding any new registry.
2021-10-05 13:23:46,198 [Listener at 127.0.0.1/10356] INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:init(158)) - HddsDatanode metrics system started (again)
2021-10-05 13:23:46,199 [Datanode State Machine Thread - 0] INFO  statemachine.DatanodeStateMachine (DatanodeStateMachine.java:lambda$startDaemon$0(456)) - Ozone container server started.
2021-10-05 13:23:46,211 [Listener at 127.0.0.1/10356] INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:start(234)) - HddsDatanodeService host:fv-az270-324.tacnzluakwdehk1hpragurqkma.bx.internal.cloudapp.net ip:10.1.0.10
2021-10-05 13:23:46,251 [org.apache.hadoop.util.JvmPauseMonitor$Monitor@29c2bcc1] INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(188)) - Starting JVM pause monitor
2021-10-05 13:23:46,251 [Datanode State Machine Task Thread - 0] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.client.port appended with serviceId and nodeId
2021-10-05 13:23:46,252 [Datanode State Machine Task Thread - 0] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.block.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.block.client.port appended with serviceId and nodeId
2021-10-05 13:23:46,252 [Datanode State Machine Task Thread - 0] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.datanode.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.datanode.port appended with serviceId and nodeId
2021-10-05 13:23:46,252 [Datanode State Machine Task Thread - 0] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.client.port appended with serviceId and nodeId
2021-10-05 13:23:46,252 [Datanode State Machine Task Thread - 0] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.block.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.block.client.port appended with serviceId and nodeId
2021-10-05 13:23:46,252 [Datanode State Machine Task Thread - 0] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.datanode.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.datanode.port appended with serviceId and nodeId
2021-10-05 13:23:46,252 [Datanode State Machine Task Thread - 0] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.client.port appended with serviceId and nodeId
2021-10-05 13:23:46,252 [Datanode State Machine Task Thread - 0] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.block.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.block.client.port appended with serviceId and nodeId
2021-10-05 13:23:46,252 [Datanode State Machine Task Thread - 0] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.datanode.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.datanode.port appended with serviceId and nodeId
2021-10-05 13:23:46,258 [Listener at 127.0.0.1/10356] INFO  upgrade.AbstractLayoutVersionManager (AbstractLayoutVersionManager.java:init(79)) - Initializing Layout version manager with metadata layout = SCM_HA (version = 2), software layout = SCM_HA (version = 2)
2021-10-05 13:23:46,333 [Listener at 127.0.0.1/10356] INFO  reflections.Reflections (Reflections.java:scan(232)) - Reflections took 74 ms to scan 7 urls, producing 119 keys and 275 values 
2021-10-05 13:23:46,334 [Listener at 127.0.0.1/10356] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.client.port appended with serviceId and nodeId
2021-10-05 13:23:46,335 [Listener at 127.0.0.1/10356] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.block.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.block.client.port appended with serviceId and nodeId
2021-10-05 13:23:46,335 [Listener at 127.0.0.1/10356] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.datanode.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.datanode.port appended with serviceId and nodeId
2021-10-05 13:23:46,335 [Listener at 127.0.0.1/10356] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.client.port appended with serviceId and nodeId
2021-10-05 13:23:46,335 [Listener at 127.0.0.1/10356] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.block.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.block.client.port appended with serviceId and nodeId
2021-10-05 13:23:46,335 [Listener at 127.0.0.1/10356] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.datanode.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.datanode.port appended with serviceId and nodeId
2021-10-05 13:23:46,335 [Listener at 127.0.0.1/10356] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.client.port appended with serviceId and nodeId
2021-10-05 13:23:46,335 [Listener at 127.0.0.1/10356] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.block.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.block.client.port appended with serviceId and nodeId
2021-10-05 13:23:46,336 [Listener at 127.0.0.1/10356] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.datanode.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.datanode.port appended with serviceId and nodeId
2021-10-05 13:23:46,337 [Listener at 127.0.0.1/10356] INFO  volume.HddsVolume (HddsVolume.java:<init>(120)) - Creating HddsVolume: /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-98f4f1fb-613f-4a4a-83a3-c748f4b4520d/datanode-1/data-0/containers/hdds of storage type : DISK capacity : 9223372036854775807
2021-10-05 13:23:46,337 [Listener at 127.0.0.1/10356] INFO  volume.MutableVolumeSet (MutableVolumeSet.java:initializeVolumeSet(168)) - Added Volume : /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-98f4f1fb-613f-4a4a-83a3-c748f4b4520d/datanode-1/data-0/containers/hdds to VolumeSet
2021-10-05 13:23:46,338 [Listener at 127.0.0.1/10356] INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(141)) - Scheduling a check for /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-98f4f1fb-613f-4a4a-83a3-c748f4b4520d/datanode-1/data-0/containers/hdds
2021-10-05 13:23:46,339 [Listener at 127.0.0.1/10356] INFO  volume.StorageVolumeChecker (StorageVolumeChecker.java:checkAllVolumes(202)) - Scheduled health check for volume /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-98f4f1fb-613f-4a4a-83a3-c748f4b4520d/datanode-1/data-0/containers/hdds
2021-10-05 13:23:46,364 [Listener at 127.0.0.1/10356] INFO  volume.MutableVolumeSet (MutableVolumeSet.java:initializeVolumeSet(168)) - Added Volume : /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-98f4f1fb-613f-4a4a-83a3-c748f4b4520d/datanode-1/data/ratis to VolumeSet
2021-10-05 13:23:46,364 [Listener at 127.0.0.1/10356] INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(141)) - Scheduling a check for /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-98f4f1fb-613f-4a4a-83a3-c748f4b4520d/datanode-1/data/ratis
2021-10-05 13:23:46,364 [Listener at 127.0.0.1/10356] INFO  volume.StorageVolumeChecker (StorageVolumeChecker.java:checkAllVolumes(202)) - Scheduled health check for volume /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-98f4f1fb-613f-4a4a-83a3-c748f4b4520d/datanode-1/data/ratis
2021-10-05 13:23:46,384 [Thread-499] INFO  ozoneimpl.ContainerReader (ContainerReader.java:readVolume(172)) - Finish verifying containers on volume /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-98f4f1fb-613f-4a4a-83a3-c748f4b4520d/datanode-1/data-0/containers/hdds
2021-10-05 13:23:46,385 [Listener at 127.0.0.1/10356] INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:buildContainerSet(236)) - Build ContainerSet costs 0s
2021-10-05 13:23:46,387 [Listener at 127.0.0.1/10356] INFO  server.RaftServer (ConfUtils.java:logGet(44)) - raft.rpc.type = GRPC (default)
2021-10-05 13:23:46,387 [Listener at 127.0.0.1/10356] INFO  grpc.GrpcFactory (GrpcFactory.java:checkPooledByteBufAllocatorUseCacheForAllThreads(48)) - PERFORMANCE WARNING: useCacheForAllThreads is true that may cause Netty to create a lot garbage objects and, as a result, trigger GC.
	It is recommended to disable useCacheForAllThreads by setting -Dorg.apache.ratis.thirdparty.io.netty.allocator.useCacheForAllThreads=false in command line.
2021-10-05 13:23:46,388 [Listener at 127.0.0.1/10356] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(44)) - raft.grpc.admin.port = 0 (custom)
2021-10-05 13:23:46,388 [Listener at 127.0.0.1/10356] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(44)) - raft.grpc.client.port = 0 (custom)
2021-10-05 13:23:46,388 [Listener at 127.0.0.1/10356] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(44)) - raft.grpc.server.port = 0 (default)
2021-10-05 13:23:46,388 [Listener at 127.0.0.1/10356] INFO  server.GrpcService (ConfUtils.java:logGet(44)) - raft.grpc.message.size.max = 32MB (=33554432) (custom)
2021-10-05 13:23:46,388 [Listener at 127.0.0.1/10356] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2021-10-05 13:23:46,388 [Listener at 127.0.0.1/10356] INFO  server.GrpcService (ConfUtils.java:logGet(44)) - raft.grpc.flow.control.window = 5MB (=5242880) (custom)
2021-10-05 13:23:46,389 [Listener at 127.0.0.1/10356] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.request.timeout = 60s (custom)
2021-10-05 13:23:46,390 [Listener at 127.0.0.1/10356] INFO  impl.DataStreamServerImpl (ConfUtils.java:logGet(44)) - raft.datastream.type = DISABLED (default)
2021-10-05 13:23:46,390 [Listener at 127.0.0.1/10356] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.slowness.timeout = 300s (custom)
2021-10-05 13:23:46,390 [Listener at 127.0.0.1/10356] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.leaderelection.leader.step-down.wait-time = 10s (default)
2021-10-05 13:23:46,390 [Listener at 127.0.0.1/10356] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.storage.dir = [/home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-98f4f1fb-613f-4a4a-83a3-c748f4b4520d/datanode-1/data/ratis] (custom)
2021-10-05 13:23:46,396 [Listener at 127.0.0.1/10356] INFO  http.BaseHttpServer (BaseHttpServer.java:newHttpServer2BuilderForOzone(209)) - Starting Web-server for hddsDatanode at: http://0.0.0.0:0
2021-10-05 13:23:46,397 [Listener at 127.0.0.1/10356] INFO  http.BaseHttpServer (BaseHttpServer.java:<init>(107)) - Hadoop Security Enabled: false Ozone Security Enabled: false Ozone HTTP Security Enabled: false 
2021-10-05 13:23:46,398 [Listener at 127.0.0.1/10356] INFO  server.AuthenticationFilter (AuthenticationFilter.java:constructSecretProvider(240)) - Unable to initialize FileSignerSecretProvider, falling back to use random secrets.
2021-10-05 13:23:46,398 [Listener at 127.0.0.1/10356] WARN  http.HttpRequestLog (HttpRequestLog.java:getRequestLog(103)) - Jetty request log can only be enabled using Log4j
2021-10-05 13:23:46,399 [Listener at 127.0.0.1/10356] INFO  http.HttpServer2 (HttpServer2.java:addGlobalFilter(1030)) - Added global filter 'safety' (class=org.apache.hadoop.hdds.server.http.HttpServer2$QuotingInputFilter)
2021-10-05 13:23:46,400 [Listener at 127.0.0.1/10356] INFO  http.HttpServer2 (HttpServer2.java:addFilter(1006)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context hddsDatanode
2021-10-05 13:23:46,400 [Listener at 127.0.0.1/10356] INFO  http.HttpServer2 (HttpServer2.java:addFilter(1014)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context logs
2021-10-05 13:23:46,400 [Listener at 127.0.0.1/10356] INFO  http.HttpServer2 (HttpServer2.java:addFilter(1014)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context static
2021-10-05 13:23:46,400 [Listener at 127.0.0.1/10356] INFO  http.HttpServer2 (HttpServer2.java:bindListener(1249)) - Jetty bound to port 37511
2021-10-05 13:23:46,401 [Listener at 127.0.0.1/10356] INFO  server.Server (Server.java:doStart(375)) - jetty-9.4.43.v20210629; built: 2021-06-30T11:07:22.254Z; git: 526006ecfa3af7f1a27ef3a288e2bef7ea9dd7e8; jvm 1.8.0_292-b10
2021-10-05 13:23:46,402 [Listener at 127.0.0.1/10356] INFO  server.session (DefaultSessionIdManager.java:doStart(334)) - DefaultSessionIdManager workerName=node0
2021-10-05 13:23:46,403 [Listener at 127.0.0.1/10356] INFO  server.session (DefaultSessionIdManager.java:doStart(339)) - No SessionScavenger set, using defaults
2021-10-05 13:23:46,403 [Listener at 127.0.0.1/10356] INFO  server.session (HouseKeeper.java:startScavenging(132)) - node0 Scavenging every 600000ms
2021-10-05 13:23:46,404 [Listener at 127.0.0.1/10356] INFO  handler.ContextHandler (ContextHandler.java:doStart(915)) - Started o.e.j.s.ServletContextHandler@51f779b2{logs,/logs,file:///home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/log,AVAILABLE}
2021-10-05 13:23:46,404 [Listener at 127.0.0.1/10356] INFO  handler.ContextHandler (ContextHandler.java:doStart(915)) - Started o.e.j.s.ServletContextHandler@e6f7638{static,/static,jar:file:/home/runner/.m2/repository/org/apache/ozone/hdds-container-service/1.2.0-SNAPSHOT/hdds-container-service-1.2.0-SNAPSHOT.jar!/webapps/static,AVAILABLE}
2021-10-05 13:23:46,416 [Datanode State Machine Task Thread - 0] INFO  datanode.InitDatanodeState (InitDatanodeState.java:persistContainerDatanodeDetails(145)) - DatanodeDetails is persisted to /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-98f4f1fb-613f-4a4a-83a3-c748f4b4520d/datanode-0/meta/datanode.id
2021-10-05 13:23:46,446 [Listener at 127.0.0.1/10356] INFO  handler.ContextHandler (ContextHandler.java:doStart(915)) - Started o.e.j.w.WebAppContext@463b7913{hddsDatanode,/,file:///tmp/jetty-0_0_0_0-37511-hdds-container-service-1_2_0-SNAPSHOT_jar-_-any-66253336760392310/webapp/,AVAILABLE}{jar:file:/home/runner/.m2/repository/org/apache/ozone/hdds-container-service/1.2.0-SNAPSHOT/hdds-container-service-1.2.0-SNAPSHOT.jar!/webapps/hddsDatanode}
2021-10-05 13:23:46,447 [Listener at 127.0.0.1/10356] INFO  server.AbstractConnector (AbstractConnector.java:doStart(331)) - Started ServerConnector@553011a9{HTTP/1.1, (http/1.1)}{0.0.0.0:37511}
2021-10-05 13:23:46,447 [Listener at 127.0.0.1/10356] INFO  server.Server (Server.java:doStart(415)) - Started @20106ms
2021-10-05 13:23:46,447 [Listener at 127.0.0.1/10356] WARN  impl.MetricsSystemImpl (MetricsSystemImpl.java:register(279)) - Sink prometheus already exists!
2021-10-05 13:23:46,448 [Listener at 127.0.0.1/10356] INFO  http.BaseHttpServer (BaseHttpServer.java:updateConnectorAddress(329)) - HTTP server of hddsDatanode listening at http://0.0.0.0:37511
2021-10-05 13:23:46,451 [Listener at 127.0.0.1/10356] WARN  impl.MetricRegistriesImpl (MetricRegistriesImpl.java:addReporterRegistration(111)) - New reporters are added after registries were created. Some metrics will be missing from the reporter. Please add reporter before adding any new registry.
2021-10-05 13:23:46,451 [Listener at 127.0.0.1/10356] WARN  impl.MetricRegistriesImpl (MetricRegistriesImpl.java:addReporterRegistration(111)) - New reporters are added after registries were created. Some metrics will be missing from the reporter. Please add reporter before adding any new registry.
2021-10-05 13:23:46,452 [Listener at 127.0.0.1/10356] INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:init(158)) - HddsDatanode metrics system started (again)
2021-10-05 13:23:46,456 [Datanode State Machine Thread - 0] INFO  statemachine.DatanodeStateMachine (DatanodeStateMachine.java:lambda$startDaemon$0(456)) - Ozone container server started.
2021-10-05 13:23:46,467 [org.apache.hadoop.util.JvmPauseMonitor$Monitor@3ee277a0] INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(188)) - Starting JVM pause monitor
2021-10-05 13:23:46,468 [Datanode State Machine Task Thread - 0] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.client.port appended with serviceId and nodeId
2021-10-05 13:23:46,468 [Datanode State Machine Task Thread - 0] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.block.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.block.client.port appended with serviceId and nodeId
2021-10-05 13:23:46,468 [Datanode State Machine Task Thread - 0] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.datanode.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.datanode.port appended with serviceId and nodeId
2021-10-05 13:23:46,468 [Datanode State Machine Task Thread - 0] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.client.port appended with serviceId and nodeId
2021-10-05 13:23:46,468 [Datanode State Machine Task Thread - 0] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.block.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.block.client.port appended with serviceId and nodeId
2021-10-05 13:23:46,468 [Datanode State Machine Task Thread - 0] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.datanode.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.datanode.port appended with serviceId and nodeId
2021-10-05 13:23:46,468 [Datanode State Machine Task Thread - 0] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.client.port appended with serviceId and nodeId
2021-10-05 13:23:46,468 [Datanode State Machine Task Thread - 0] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.block.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.block.client.port appended with serviceId and nodeId
2021-10-05 13:23:46,468 [Datanode State Machine Task Thread - 0] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.datanode.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.datanode.port appended with serviceId and nodeId
2021-10-05 13:23:46,476 [Listener at 127.0.0.1/10356] INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:start(234)) - HddsDatanodeService host:fv-az270-324.tacnzluakwdehk1hpragurqkma.bx.internal.cloudapp.net ip:10.1.0.10
2021-10-05 13:23:46,484 [Datanode State Machine Task Thread - 0] INFO  datanode.InitDatanodeState (InitDatanodeState.java:persistContainerDatanodeDetails(145)) - DatanodeDetails is persisted to /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-98f4f1fb-613f-4a4a-83a3-c748f4b4520d/datanode-1/meta/datanode.id
2021-10-05 13:23:46,496 [Listener at 127.0.0.1/10356] INFO  upgrade.AbstractLayoutVersionManager (AbstractLayoutVersionManager.java:init(79)) - Initializing Layout version manager with metadata layout = SCM_HA (version = 2), software layout = SCM_HA (version = 2)
2021-10-05 13:23:46,531 [Listener at 127.0.0.1/10356] INFO  reflections.Reflections (Reflections.java:scan(232)) - Reflections took 34 ms to scan 7 urls, producing 119 keys and 275 values 
2021-10-05 13:23:46,532 [Listener at 127.0.0.1/10356] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.client.port appended with serviceId and nodeId
2021-10-05 13:23:46,532 [Listener at 127.0.0.1/10356] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.block.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.block.client.port appended with serviceId and nodeId
2021-10-05 13:23:46,532 [Listener at 127.0.0.1/10356] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.datanode.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.datanode.port appended with serviceId and nodeId
2021-10-05 13:23:46,533 [Listener at 127.0.0.1/10356] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.client.port appended with serviceId and nodeId
2021-10-05 13:23:46,533 [Listener at 127.0.0.1/10356] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.block.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.block.client.port appended with serviceId and nodeId
2021-10-05 13:23:46,533 [Listener at 127.0.0.1/10356] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.datanode.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.datanode.port appended with serviceId and nodeId
2021-10-05 13:23:46,533 [Listener at 127.0.0.1/10356] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.client.port appended with serviceId and nodeId
2021-10-05 13:23:46,533 [Listener at 127.0.0.1/10356] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.block.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.block.client.port appended with serviceId and nodeId
2021-10-05 13:23:46,533 [Listener at 127.0.0.1/10356] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.datanode.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.datanode.port appended with serviceId and nodeId
2021-10-05 13:23:46,536 [Listener at 127.0.0.1/10356] INFO  volume.HddsVolume (HddsVolume.java:<init>(120)) - Creating HddsVolume: /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-98f4f1fb-613f-4a4a-83a3-c748f4b4520d/datanode-2/data-0/containers/hdds of storage type : DISK capacity : 9223372036854775807
2021-10-05 13:23:46,536 [Listener at 127.0.0.1/10356] INFO  volume.MutableVolumeSet (MutableVolumeSet.java:initializeVolumeSet(168)) - Added Volume : /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-98f4f1fb-613f-4a4a-83a3-c748f4b4520d/datanode-2/data-0/containers/hdds to VolumeSet
2021-10-05 13:23:46,536 [Listener at 127.0.0.1/10356] INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(141)) - Scheduling a check for /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-98f4f1fb-613f-4a4a-83a3-c748f4b4520d/datanode-2/data-0/containers/hdds
2021-10-05 13:23:46,539 [Listener at 127.0.0.1/10356] INFO  volume.StorageVolumeChecker (StorageVolumeChecker.java:checkAllVolumes(202)) - Scheduled health check for volume /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-98f4f1fb-613f-4a4a-83a3-c748f4b4520d/datanode-2/data-0/containers/hdds
2021-10-05 13:23:46,553 [Listener at 127.0.0.1/10356] INFO  volume.MutableVolumeSet (MutableVolumeSet.java:initializeVolumeSet(168)) - Added Volume : /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-98f4f1fb-613f-4a4a-83a3-c748f4b4520d/datanode-2/data/ratis to VolumeSet
2021-10-05 13:23:46,553 [Listener at 127.0.0.1/10356] INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(141)) - Scheduling a check for /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-98f4f1fb-613f-4a4a-83a3-c748f4b4520d/datanode-2/data/ratis
2021-10-05 13:23:46,554 [Listener at 127.0.0.1/10356] INFO  volume.StorageVolumeChecker (StorageVolumeChecker.java:checkAllVolumes(202)) - Scheduled health check for volume /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-98f4f1fb-613f-4a4a-83a3-c748f4b4520d/datanode-2/data/ratis
2021-10-05 13:23:46,567 [Thread-511] INFO  ozoneimpl.ContainerReader (ContainerReader.java:readVolume(172)) - Finish verifying containers on volume /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-98f4f1fb-613f-4a4a-83a3-c748f4b4520d/datanode-2/data-0/containers/hdds
2021-10-05 13:23:46,567 [Listener at 127.0.0.1/10356] INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:buildContainerSet(236)) - Build ContainerSet costs 0s
2021-10-05 13:23:46,570 [Listener at 127.0.0.1/10356] INFO  server.RaftServer (ConfUtils.java:logGet(44)) - raft.rpc.type = GRPC (default)
2021-10-05 13:23:46,570 [Listener at 127.0.0.1/10356] INFO  grpc.GrpcFactory (GrpcFactory.java:checkPooledByteBufAllocatorUseCacheForAllThreads(48)) - PERFORMANCE WARNING: useCacheForAllThreads is true that may cause Netty to create a lot garbage objects and, as a result, trigger GC.
	It is recommended to disable useCacheForAllThreads by setting -Dorg.apache.ratis.thirdparty.io.netty.allocator.useCacheForAllThreads=false in command line.
2021-10-05 13:23:46,570 [Listener at 127.0.0.1/10356] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(44)) - raft.grpc.admin.port = 0 (custom)
2021-10-05 13:23:46,570 [Listener at 127.0.0.1/10356] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(44)) - raft.grpc.client.port = 0 (custom)
2021-10-05 13:23:46,570 [Listener at 127.0.0.1/10356] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(44)) - raft.grpc.server.port = 0 (default)
2021-10-05 13:23:46,571 [Listener at 127.0.0.1/10356] INFO  server.GrpcService (ConfUtils.java:logGet(44)) - raft.grpc.message.size.max = 32MB (=33554432) (custom)
2021-10-05 13:23:46,571 [Listener at 127.0.0.1/10356] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2021-10-05 13:23:46,571 [Listener at 127.0.0.1/10356] INFO  server.GrpcService (ConfUtils.java:logGet(44)) - raft.grpc.flow.control.window = 5MB (=5242880) (custom)
2021-10-05 13:23:46,571 [Listener at 127.0.0.1/10356] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.request.timeout = 60s (custom)
2021-10-05 13:23:46,572 [Listener at 127.0.0.1/10356] INFO  impl.DataStreamServerImpl (ConfUtils.java:logGet(44)) - raft.datastream.type = DISABLED (default)
2021-10-05 13:23:46,573 [Listener at 127.0.0.1/10356] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.slowness.timeout = 300s (custom)
2021-10-05 13:23:46,573 [Listener at 127.0.0.1/10356] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.leaderelection.leader.step-down.wait-time = 10s (default)
2021-10-05 13:23:46,573 [Listener at 127.0.0.1/10356] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.storage.dir = [/home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-98f4f1fb-613f-4a4a-83a3-c748f4b4520d/datanode-2/data/ratis] (custom)
2021-10-05 13:23:46,580 [Listener at 127.0.0.1/10356] INFO  http.BaseHttpServer (BaseHttpServer.java:newHttpServer2BuilderForOzone(209)) - Starting Web-server for hddsDatanode at: http://0.0.0.0:0
2021-10-05 13:23:46,580 [Listener at 127.0.0.1/10356] INFO  http.BaseHttpServer (BaseHttpServer.java:<init>(107)) - Hadoop Security Enabled: false Ozone Security Enabled: false Ozone HTTP Security Enabled: false 
2021-10-05 13:23:46,581 [Listener at 127.0.0.1/10356] INFO  server.AuthenticationFilter (AuthenticationFilter.java:constructSecretProvider(240)) - Unable to initialize FileSignerSecretProvider, falling back to use random secrets.
2021-10-05 13:23:46,582 [Listener at 127.0.0.1/10356] WARN  http.HttpRequestLog (HttpRequestLog.java:getRequestLog(103)) - Jetty request log can only be enabled using Log4j
2021-10-05 13:23:46,583 [Listener at 127.0.0.1/10356] INFO  http.HttpServer2 (HttpServer2.java:addGlobalFilter(1030)) - Added global filter 'safety' (class=org.apache.hadoop.hdds.server.http.HttpServer2$QuotingInputFilter)
2021-10-05 13:23:46,584 [Listener at 127.0.0.1/10356] INFO  http.HttpServer2 (HttpServer2.java:addFilter(1006)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context hddsDatanode
2021-10-05 13:23:46,584 [Listener at 127.0.0.1/10356] INFO  http.HttpServer2 (HttpServer2.java:addFilter(1014)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context static
2021-10-05 13:23:46,584 [Listener at 127.0.0.1/10356] INFO  http.HttpServer2 (HttpServer2.java:addFilter(1014)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context logs
2021-10-05 13:23:46,584 [Listener at 127.0.0.1/10356] INFO  http.HttpServer2 (HttpServer2.java:bindListener(1249)) - Jetty bound to port 37607
2021-10-05 13:23:46,585 [Listener at 127.0.0.1/10356] INFO  server.Server (Server.java:doStart(375)) - jetty-9.4.43.v20210629; built: 2021-06-30T11:07:22.254Z; git: 526006ecfa3af7f1a27ef3a288e2bef7ea9dd7e8; jvm 1.8.0_292-b10
2021-10-05 13:23:46,588 [Listener at 127.0.0.1/10356] INFO  server.session (DefaultSessionIdManager.java:doStart(334)) - DefaultSessionIdManager workerName=node0
2021-10-05 13:23:46,589 [Listener at 127.0.0.1/10356] INFO  server.session (DefaultSessionIdManager.java:doStart(339)) - No SessionScavenger set, using defaults
2021-10-05 13:23:46,589 [Listener at 127.0.0.1/10356] INFO  server.session (HouseKeeper.java:startScavenging(132)) - node0 Scavenging every 600000ms
2021-10-05 13:23:46,590 [Listener at 127.0.0.1/10356] INFO  handler.ContextHandler (ContextHandler.java:doStart(915)) - Started o.e.j.s.ServletContextHandler@7d49efaf{logs,/logs,file:///home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/log,AVAILABLE}
2021-10-05 13:23:46,590 [Listener at 127.0.0.1/10356] INFO  handler.ContextHandler (ContextHandler.java:doStart(915)) - Started o.e.j.s.ServletContextHandler@12cd321d{static,/static,jar:file:/home/runner/.m2/repository/org/apache/ozone/hdds-container-service/1.2.0-SNAPSHOT/hdds-container-service-1.2.0-SNAPSHOT.jar!/webapps/static,AVAILABLE}
2021-10-05 13:23:46,607 [omNode-1@group-523986131536-FollowerState] INFO  impl.FollowerState (FollowerState.java:run(134)) - omNode-1@group-523986131536-FollowerState: change to CANDIDATE, lastRpcElapsedTime:1014324365ns, electionTimeout:1001ms
2021-10-05 13:23:46,607 [omNode-1@group-523986131536-FollowerState] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(108)) - omNode-1: shutdown omNode-1@group-523986131536-FollowerState
2021-10-05 13:23:46,607 [omNode-1@group-523986131536-FollowerState] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(285)) - omNode-1@group-523986131536: changes role from  FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2021-10-05 13:23:46,607 [omNode-1@group-523986131536-FollowerState] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.leaderelection.pre-vote = false (custom)
2021-10-05 13:23:46,608 [omNode-1@group-523986131536-FollowerState] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(130)) - omNode-1: start omNode-1@group-523986131536-LeaderElection3
2021-10-05 13:23:46,624 [omNode-1@group-523986131536-LeaderElection3] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(306)) - omNode-1@group-523986131536-LeaderElection3 ELECTION round 0: submit vote requests at term 1 for -1: [omNode-1|rpc:localhost:10360|priority:0], old=null
2021-10-05 13:23:46,625 [omNode-1@group-523986131536-LeaderElection3] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(308)) - omNode-1@group-523986131536-LeaderElection3 ELECTION round 0: result PASSED (term=1)
2021-10-05 13:23:46,625 [omNode-1@group-523986131536-LeaderElection3] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(121)) - omNode-1: shutdown omNode-1@group-523986131536-LeaderElection3
2021-10-05 13:23:46,625 [omNode-1@group-523986131536-LeaderElection3] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(285)) - omNode-1@group-523986131536: changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2021-10-05 13:23:46,625 [omNode-1@group-523986131536-LeaderElection3] INFO  server.RaftServer$Division (ServerState.java:setLeader(285)) - omNode-1@group-523986131536: change Leader from null to omNode-1 at term 1 for becomeLeader, leader elected after 1078ms
2021-10-05 13:23:46,625 [omNode-1@group-523986131536-LeaderElection3] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.staging.catchup.gap = 1000 (default)
2021-10-05 13:23:46,625 [omNode-1@group-523986131536-LeaderElection3] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.write.element-limit = 4096 (default)
2021-10-05 13:23:46,625 [omNode-1@group-523986131536-LeaderElection3] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.write.byte-limit = 64MB (=67108864) (default)
2021-10-05 13:23:46,626 [omNode-1@group-523986131536-LeaderElection3] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.watch.timeout = 10s (default)
2021-10-05 13:23:46,626 [omNode-1@group-523986131536-LeaderElection3] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.watch.timeout.denomination = 1s (default)
2021-10-05 13:23:46,626 [omNode-1@group-523986131536-LeaderElection3] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.watch.element-limit = 65536 (default)
2021-10-05 13:23:46,626 [omNode-1@group-523986131536-LeaderElection3] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(130)) - omNode-1: start omNode-1@group-523986131536-LeaderStateImpl
2021-10-05 13:23:46,626 [omNode-1@group-523986131536-LeaderElection3] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:startLogSegment(394)) - omNode-1@group-523986131536-SegmentedRaftLogWorker: Starting segment from index:0
2021-10-05 13:23:46,633 [omNode-1@group-523986131536-LeaderElection3] INFO  server.RaftServer$Division (ServerState.java:setRaftConf(387)) - omNode-1@group-523986131536: set configuration 0: [omNode-1|rpc:localhost:10360|admin:|client:|dataStream:|priority:0], old=null
2021-10-05 13:23:46,635 [omNode-1@group-523986131536-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(601)) - omNode-1@group-523986131536-SegmentedRaftLogWorker: created new log segment /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-98f4f1fb-613f-4a4a-83a3-c748f4b4520d/omNode-1/ratis/c9bc4cf4-3bc3-3c60-a66b-523986131536/current/log_inprogress_0
2021-10-05 13:23:46,669 [Listener at 127.0.0.1/10356] INFO  handler.ContextHandler (ContextHandler.java:doStart(915)) - Started o.e.j.w.WebAppContext@1bf1f019{hddsDatanode,/,file:///tmp/jetty-0_0_0_0-37607-hdds-container-service-1_2_0-SNAPSHOT_jar-_-any-2998883772735062556/webapp/,AVAILABLE}{jar:file:/home/runner/.m2/repository/org/apache/ozone/hdds-container-service/1.2.0-SNAPSHOT/hdds-container-service-1.2.0-SNAPSHOT.jar!/webapps/hddsDatanode}
2021-10-05 13:23:46,694 [Listener at 127.0.0.1/10356] INFO  server.AbstractConnector (AbstractConnector.java:doStart(331)) - Started ServerConnector@749bbb99{HTTP/1.1, (http/1.1)}{0.0.0.0:37607}
2021-10-05 13:23:46,694 [Listener at 127.0.0.1/10356] INFO  server.Server (Server.java:doStart(415)) - Started @20354ms
2021-10-05 13:23:46,795 [Listener at 127.0.0.1/10356] WARN  impl.MetricsSystemImpl (MetricsSystemImpl.java:register(279)) - Sink prometheus already exists!
2021-10-05 13:23:46,796 [Listener at 127.0.0.1/10356] INFO  http.BaseHttpServer (BaseHttpServer.java:updateConnectorAddress(329)) - HTTP server of hddsDatanode listening at http://0.0.0.0:37607
2021-10-05 13:23:46,798 [Listener at 127.0.0.1/10356] INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(235)) - Waiting for nodes to be ready. Got 0 of 3 DN Heartbeats.
2021-10-05 13:23:46,798 [Listener at 127.0.0.1/10356] INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(238)) - Waiting for cluster to exit safe mode
2021-10-05 13:23:46,798 [Listener at 127.0.0.1/10356] INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(240)) - SCM became leader
2021-10-05 13:23:46,802 [Datanode State Machine Thread - 0] INFO  statemachine.DatanodeStateMachine (DatanodeStateMachine.java:lambda$startDaemon$0(456)) - Ozone container server started.
2021-10-05 13:23:46,844 [org.apache.hadoop.util.JvmPauseMonitor$Monitor@13936aeb] INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(188)) - Starting JVM pause monitor
2021-10-05 13:23:46,810 [omNode-1@group-523986131536-StateMachineUpdater] INFO  ratis.OzoneManagerStateMachine (OzoneManagerStateMachine.java:notifyConfigurationChanged(188)) - Received Configuration change notification from Ratis. New Peer list:
[id: "omNode-1"
address: "localhost:10360"
]
2021-10-05 13:23:46,852 [Datanode State Machine Task Thread - 0] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.client.port appended with serviceId and nodeId
2021-10-05 13:23:46,852 [Datanode State Machine Task Thread - 0] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.block.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.block.client.port appended with serviceId and nodeId
2021-10-05 13:23:46,852 [Datanode State Machine Task Thread - 0] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.datanode.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.datanode.port appended with serviceId and nodeId
2021-10-05 13:23:46,852 [Datanode State Machine Task Thread - 0] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.client.port appended with serviceId and nodeId
2021-10-05 13:23:46,852 [Datanode State Machine Task Thread - 0] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.block.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.block.client.port appended with serviceId and nodeId
2021-10-05 13:23:46,852 [Datanode State Machine Task Thread - 0] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.datanode.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.datanode.port appended with serviceId and nodeId
2021-10-05 13:23:46,852 [Datanode State Machine Task Thread - 0] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.client.port appended with serviceId and nodeId
2021-10-05 13:23:46,853 [Datanode State Machine Task Thread - 0] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.block.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.block.client.port appended with serviceId and nodeId
2021-10-05 13:23:46,853 [Datanode State Machine Task Thread - 0] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.datanode.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.datanode.port appended with serviceId and nodeId
2021-10-05 13:23:46,855 [Datanode State Machine Task Thread - 0] INFO  datanode.InitDatanodeState (InitDatanodeState.java:persistContainerDatanodeDetails(145)) - DatanodeDetails is persisted to /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-98f4f1fb-613f-4a4a-83a3-c748f4b4520d/datanode-2/meta/datanode.id
2021-10-05 13:23:47,799 [Listener at 127.0.0.1/10356] INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(235)) - Waiting for nodes to be ready. Got 0 of 3 DN Heartbeats.
2021-10-05 13:23:47,800 [Listener at 127.0.0.1/10356] INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(238)) - Waiting for cluster to exit safe mode
2021-10-05 13:23:47,800 [Listener at 127.0.0.1/10356] INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(240)) - SCM became leader
2021-10-05 13:23:48,311 [EndpointStateMachine task thread for /127.0.0.1:15021 - 0 ] INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(304)) - Attempting to start container services.
2021-10-05 13:23:48,313 [EndpointStateMachine task thread for /127.0.0.1:15021 - 0 ] INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(249)) - Background container scanner has been disabled.
2021-10-05 13:23:48,314 [EndpointStateMachine task thread for /127.0.0.1:15021 - 0 ] INFO  replication.ReplicationServer (ReplicationServer.java:start(107)) - ReplicationServer is started using port 39769
2021-10-05 13:23:48,317 [EndpointStateMachine task thread for /127.0.0.1:15021 - 0 ] INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(482)) - Starting XceiverServerRatis f990c0ed-f7f2-4f8a-8ec9-db097d9c855e
2021-10-05 13:23:48,327 [EndpointStateMachine task thread for /127.0.0.1:15021 - 0 ] INFO  server.RaftServer (RaftServerProxy.java:lambda$start$5(374)) - f990c0ed-f7f2-4f8a-8ec9-db097d9c855e: start RPC server
2021-10-05 13:23:48,338 [EndpointStateMachine task thread for /127.0.0.1:15021 - 0 ] INFO  server.GrpcService (GrpcService.java:startImpl(253)) - f990c0ed-f7f2-4f8a-8ec9-db097d9c855e: GrpcService started, listening on 44595
2021-10-05 13:23:48,339 [EndpointStateMachine task thread for /127.0.0.1:15021 - 0 ] INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:getRealPort(503)) - XceiverServerRatis f990c0ed-f7f2-4f8a-8ec9-db097d9c855e is started using port 44595 for RATIS
2021-10-05 13:23:48,339 [EndpointStateMachine task thread for /127.0.0.1:15021 - 0 ] INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:getRealPort(503)) - XceiverServerRatis f990c0ed-f7f2-4f8a-8ec9-db097d9c855e is started using port 44595 for RATIS_ADMIN
2021-10-05 13:23:48,339 [EndpointStateMachine task thread for /127.0.0.1:15021 - 0 ] INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:getRealPort(503)) - XceiverServerRatis f990c0ed-f7f2-4f8a-8ec9-db097d9c855e is started using port 44595 for RATIS_SERVER
2021-10-05 13:23:48,344 [org.apache.ratis.util.JvmPauseMonitor$$Lambda$499/1586779822@227d0cd5] INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(103)) - JvmPauseMonitor-f990c0ed-f7f2-4f8a-8ec9-db097d9c855e: Started
2021-10-05 13:23:48,344 [EndpointStateMachine task thread for /127.0.0.1:15021 - 0 ] INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:start(135)) - XceiverServerGrpc f990c0ed-f7f2-4f8a-8ec9-db097d9c855e is started using port 39009
2021-10-05 13:23:48,347 [EndpointStateMachine task thread for /127.0.0.1:15031 - 0 ] INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(300)) - Ignore. OzoneContainer already started.
2021-10-05 13:23:48,480 [EndpointStateMachine task thread for /127.0.0.1:15031 - 0 ] INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(304)) - Attempting to start container services.
2021-10-05 13:23:48,480 [EndpointStateMachine task thread for /127.0.0.1:15031 - 0 ] INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(249)) - Background container scanner has been disabled.
2021-10-05 13:23:48,481 [EndpointStateMachine task thread for /127.0.0.1:15031 - 0 ] INFO  replication.ReplicationServer (ReplicationServer.java:start(107)) - ReplicationServer is started using port 46311
2021-10-05 13:23:48,482 [EndpointStateMachine task thread for /127.0.0.1:15031 - 0 ] INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(482)) - Starting XceiverServerRatis 0c34be74-1f5b-4b04-a6d4-fde6c3deb89a
2021-10-05 13:23:48,484 [EndpointStateMachine task thread for /127.0.0.1:15031 - 0 ] INFO  server.RaftServer (RaftServerProxy.java:lambda$start$5(374)) - 0c34be74-1f5b-4b04-a6d4-fde6c3deb89a: start RPC server
2021-10-05 13:23:48,485 [EndpointStateMachine task thread for /127.0.0.1:15031 - 0 ] INFO  server.GrpcService (GrpcService.java:startImpl(253)) - 0c34be74-1f5b-4b04-a6d4-fde6c3deb89a: GrpcService started, listening on 33359
2021-10-05 13:23:48,485 [EndpointStateMachine task thread for /127.0.0.1:15031 - 0 ] INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:getRealPort(503)) - XceiverServerRatis 0c34be74-1f5b-4b04-a6d4-fde6c3deb89a is started using port 33359 for RATIS
2021-10-05 13:23:48,485 [EndpointStateMachine task thread for /127.0.0.1:15031 - 0 ] INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:getRealPort(503)) - XceiverServerRatis 0c34be74-1f5b-4b04-a6d4-fde6c3deb89a is started using port 33359 for RATIS_ADMIN
2021-10-05 13:23:48,485 [EndpointStateMachine task thread for /127.0.0.1:15031 - 0 ] INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:getRealPort(503)) - XceiverServerRatis 0c34be74-1f5b-4b04-a6d4-fde6c3deb89a is started using port 33359 for RATIS_SERVER
2021-10-05 13:23:48,485 [org.apache.ratis.util.JvmPauseMonitor$$Lambda$499/1586779822@28f26e39] INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(103)) - JvmPauseMonitor-0c34be74-1f5b-4b04-a6d4-fde6c3deb89a: Started
2021-10-05 13:23:48,487 [EndpointStateMachine task thread for /127.0.0.1:15031 - 0 ] INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:start(135)) - XceiverServerGrpc 0c34be74-1f5b-4b04-a6d4-fde6c3deb89a is started using port 44513
2021-10-05 13:23:48,489 [EndpointStateMachine task thread for /127.0.0.1:15021 - 0 ] INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(300)) - Ignore. OzoneContainer already started.
2021-10-05 13:23:48,800 [Listener at 127.0.0.1/10356] INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(235)) - Waiting for nodes to be ready. Got 0 of 3 DN Heartbeats.
2021-10-05 13:23:48,801 [Listener at 127.0.0.1/10356] INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(238)) - Waiting for cluster to exit safe mode
2021-10-05 13:23:48,801 [Listener at 127.0.0.1/10356] INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(240)) - SCM became leader
2021-10-05 13:23:48,856 [EndpointStateMachine task thread for /127.0.0.1:15031 - 0 ] INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(304)) - Attempting to start container services.
2021-10-05 13:23:48,856 [EndpointStateMachine task thread for /127.0.0.1:15031 - 0 ] INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(249)) - Background container scanner has been disabled.
2021-10-05 13:23:48,859 [EndpointStateMachine task thread for /127.0.0.1:15031 - 0 ] INFO  replication.ReplicationServer (ReplicationServer.java:start(107)) - ReplicationServer is started using port 45095
2021-10-05 13:23:48,864 [EndpointStateMachine task thread for /127.0.0.1:15031 - 0 ] INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(482)) - Starting XceiverServerRatis a9b6c243-aad2-4cee-be19-871628539a81
2021-10-05 13:23:48,868 [EndpointStateMachine task thread for /127.0.0.1:15031 - 0 ] INFO  server.RaftServer (RaftServerProxy.java:lambda$start$5(374)) - a9b6c243-aad2-4cee-be19-871628539a81: start RPC server
2021-10-05 13:23:48,870 [EndpointStateMachine task thread for /127.0.0.1:15031 - 0 ] INFO  server.GrpcService (GrpcService.java:startImpl(253)) - a9b6c243-aad2-4cee-be19-871628539a81: GrpcService started, listening on 36351
2021-10-05 13:23:48,871 [EndpointStateMachine task thread for /127.0.0.1:15031 - 0 ] INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:getRealPort(503)) - XceiverServerRatis a9b6c243-aad2-4cee-be19-871628539a81 is started using port 36351 for RATIS
2021-10-05 13:23:48,871 [org.apache.ratis.util.JvmPauseMonitor$$Lambda$499/1586779822@41fe9138] INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(103)) - JvmPauseMonitor-a9b6c243-aad2-4cee-be19-871628539a81: Started
2021-10-05 13:23:48,871 [EndpointStateMachine task thread for /127.0.0.1:15031 - 0 ] INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:getRealPort(503)) - XceiverServerRatis a9b6c243-aad2-4cee-be19-871628539a81 is started using port 36351 for RATIS_ADMIN
2021-10-05 13:23:48,871 [EndpointStateMachine task thread for /127.0.0.1:15031 - 0 ] INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:getRealPort(503)) - XceiverServerRatis a9b6c243-aad2-4cee-be19-871628539a81 is started using port 36351 for RATIS_SERVER
2021-10-05 13:23:48,876 [EndpointStateMachine task thread for /127.0.0.1:15031 - 0 ] INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:start(135)) - XceiverServerGrpc a9b6c243-aad2-4cee-be19-871628539a81 is started using port 33273
2021-10-05 13:23:48,878 [EndpointStateMachine task thread for /127.0.0.1:15021 - 0 ] INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(300)) - Ignore. OzoneContainer already started.
2021-10-05 13:23:49,801 [Listener at 127.0.0.1/10356] INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(235)) - Waiting for nodes to be ready. Got 0 of 3 DN Heartbeats.
2021-10-05 13:23:49,802 [Listener at 127.0.0.1/10356] INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(238)) - Waiting for cluster to exit safe mode
2021-10-05 13:23:49,802 [Listener at 127.0.0.1/10356] INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(240)) - SCM became leader
2021-10-05 13:23:50,293 [IPC Server handler 4 on default port 15031] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/f990c0ed-f7f2-4f8a-8ec9-db097d9c855e
2021-10-05 13:23:50,295 [IPC Server handler 4 on default port 15031] INFO  node.SCMNodeManager (SCMNodeManager.java:register(389)) - Registered Data node : f990c0ed-f7f2-4f8a-8ec9-db097d9c855e{ip: 127.0.0.1, host: localhost, ports: [REPLICATION=39769, RATIS=44595, RATIS_ADMIN=44595, RATIS_SERVER=44595, STANDALONE=39009], networkLocation: /default-rack, certSerialId: null, persistedOpState: null, persistedOpStateExpiryEpochSec: 0}
2021-10-05 13:23:50,301 [IPC Server handler 9 on default port 15021] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/f990c0ed-f7f2-4f8a-8ec9-db097d9c855e
2021-10-05 13:23:50,301 [IPC Server handler 9 on default port 15021] INFO  node.SCMNodeManager (SCMNodeManager.java:register(389)) - Registered Data node : f990c0ed-f7f2-4f8a-8ec9-db097d9c855e{ip: 127.0.0.1, host: localhost, ports: [REPLICATION=39769, RATIS=44595, RATIS_ADMIN=44595, RATIS_SERVER=44595, STANDALONE=39009], networkLocation: /default-rack, certSerialId: null, persistedOpState: null, persistedOpStateExpiryEpochSec: 0}
2021-10-05 13:23:50,311 [EventQueue-NewNodeForNewNodeHandler] INFO  pipeline.BackgroundPipelineCreator (BackgroundPipelineCreatorV2.java:notifyEventTriggered(285)) - trigger a one-shot run on RatisPipelineUtilsThread.
2021-10-05 13:23:50,319 [EventQueue-NewNodeForNewNodeHandler] INFO  pipeline.BackgroundPipelineCreator (BackgroundPipelineCreatorV2.java:notifyEventTriggered(279)) - ignore, not leader SCM.
2021-10-05 13:23:50,321 [EventQueue-NodeRegistrationContainerReportForDataNodeSafeModeRule] INFO  safemode.SCMSafeModeManager (DataNodeSafeModeRule.java:process(71)) - SCM in safe mode. 1 DataNodes registered, 3 required.
2021-10-05 13:23:50,325 [RatisPipelineUtilsThread - 0] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(183)) - Sending CreatePipelineCommand for pipeline:PipelineID=4bafc9c3-fe1c-42b3-af40-1cd77ba4a78c to datanode:f990c0ed-f7f2-4f8a-8ec9-db097d9c855e
2021-10-05 13:23:50,333 [EventQueue-NodeRegistrationContainerReportForContainerSafeModeRule] INFO  safemode.SCMSafeModeManager (SCMSafeModeManager.java:validateSafeModeExitRules(204)) - ContainerSafeModeRule rule is successfully validated
2021-10-05 13:23:50,331 [EventQueue-NodeRegistrationContainerReportForDataNodeSafeModeRule] INFO  safemode.SCMSafeModeManager (DataNodeSafeModeRule.java:process(71)) - SCM in safe mode. 1 DataNodes registered, 3 required.
2021-10-05 13:23:50,333 [EventQueue-NodeRegistrationContainerReportForContainerSafeModeRule] INFO  safemode.SCMSafeModeManager (SCMSafeModeManager.java:validateSafeModeExitRules(204)) - ContainerSafeModeRule rule is successfully validated
2021-10-05 13:23:50,334 [EventQueue-PipelineReportForOneReplicaPipelineSafeModeRule] INFO  safemode.SCMSafeModeManager (SCMSafeModeManager.java:validateSafeModeExitRules(204)) - AtleastOneDatanodeReportedRule rule is successfully validated
2021-10-05 13:23:50,340 [EventQueue-PipelineReportForOneReplicaPipelineSafeModeRule] INFO  safemode.SCMSafeModeManager (SCMSafeModeManager.java:validateSafeModeExitRules(204)) - AtleastOneDatanodeReportedRule rule is successfully validated
2021-10-05 13:23:50,409 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  pipeline.PipelineStateManagerImpl (PipelineStateManagerImpl.java:addPipeline(101)) - Created pipeline Pipeline[ Id: 4bafc9c3-fe1c-42b3-af40-1cd77ba4a78c, Nodes: f990c0ed-f7f2-4f8a-8ec9-db097d9c855e{ip: 127.0.0.1, host: localhost, ports: [REPLICATION=39769, RATIS=44595, RATIS_ADMIN=44595, RATIS_SERVER=44595, STANDALONE=39009], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}, ReplicationConfig: RATIS/ONE, State:ALLOCATED, leaderId:, CreationTimestamp2021-10-05T13:23:50.320Z[Etc/UTC]].
2021-10-05 13:23:50,411 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  safemode.HealthyPipelineSafeModeRule (HealthyPipelineSafeModeRule.java:initializeRule(152)) - Refreshed total pipeline count is 0, healthy pipeline threshold count is 1
2021-10-05 13:23:50,416 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  pipeline.PipelineStateManagerImpl (PipelineStateManagerImpl.java:addPipeline(101)) - Created pipeline Pipeline[ Id: 4bafc9c3-fe1c-42b3-af40-1cd77ba4a78c, Nodes: f990c0ed-f7f2-4f8a-8ec9-db097d9c855e{ip: 127.0.0.1, host: localhost, ports: [REPLICATION=39769, RATIS=44595, RATIS_ADMIN=44595, RATIS_SERVER=44595, STANDALONE=39009], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}, ReplicationConfig: RATIS/ONE, State:ALLOCATED, leaderId:, CreationTimestamp2021-10-05T13:23:50.320Z[Etc/UTC]].
2021-10-05 13:23:50,418 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  safemode.HealthyPipelineSafeModeRule (HealthyPipelineSafeModeRule.java:initializeRule(152)) - Refreshed total pipeline count is 0, healthy pipeline threshold count is 1
2021-10-05 13:23:50,419 [RatisPipelineUtilsThread - 0] INFO  ha.SCMHAInvocationHandler (SCMHAInvocationHandler.java:invokeRatis(113)) - Invoking method public abstract void org.apache.hadoop.hdds.scm.pipeline.PipelineStateManager.addPipeline(org.apache.hadoop.hdds.protocol.proto.HddsProtos$Pipeline) throws java.io.IOException on target org.apache.hadoop.hdds.scm.ha.SCMRatisServerImpl@6344f74b, cost 77650.834us
2021-10-05 13:23:50,472 [IPC Server handler 1 on default port 15031] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/0c34be74-1f5b-4b04-a6d4-fde6c3deb89a
2021-10-05 13:23:50,473 [IPC Server handler 1 on default port 15031] INFO  node.SCMNodeManager (SCMNodeManager.java:register(389)) - Registered Data node : 0c34be74-1f5b-4b04-a6d4-fde6c3deb89a{ip: 127.0.0.1, host: localhost, ports: [REPLICATION=46311, RATIS=33359, RATIS_ADMIN=33359, RATIS_SERVER=33359, STANDALONE=44513], networkLocation: /default-rack, certSerialId: null, persistedOpState: null, persistedOpStateExpiryEpochSec: 0}
2021-10-05 13:23:50,473 [EventQueue-NewNodeForNewNodeHandler] INFO  pipeline.BackgroundPipelineCreator (BackgroundPipelineCreatorV2.java:notifyEventTriggered(279)) - ignore, not leader SCM.
2021-10-05 13:23:50,475 [EventQueue-NodeRegistrationContainerReportForDataNodeSafeModeRule] INFO  safemode.SCMSafeModeManager (DataNodeSafeModeRule.java:process(71)) - SCM in safe mode. 2 DataNodes registered, 3 required.
2021-10-05 13:23:50,475 [IPC Server handler 10 on default port 15021] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/0c34be74-1f5b-4b04-a6d4-fde6c3deb89a
2021-10-05 13:23:50,475 [IPC Server handler 10 on default port 15021] INFO  node.SCMNodeManager (SCMNodeManager.java:register(389)) - Registered Data node : 0c34be74-1f5b-4b04-a6d4-fde6c3deb89a{ip: 127.0.0.1, host: localhost, ports: [REPLICATION=46311, RATIS=33359, RATIS_ADMIN=33359, RATIS_SERVER=33359, STANDALONE=44513], networkLocation: /default-rack, certSerialId: null, persistedOpState: null, persistedOpStateExpiryEpochSec: 0}
2021-10-05 13:23:50,475 [EventQueue-NewNodeForNewNodeHandler] INFO  pipeline.BackgroundPipelineCreator (BackgroundPipelineCreatorV2.java:notifyEventTriggered(285)) - trigger a one-shot run on RatisPipelineUtilsThread.
2021-10-05 13:23:50,476 [EventQueue-NodeRegistrationContainerReportForDataNodeSafeModeRule] INFO  safemode.SCMSafeModeManager (DataNodeSafeModeRule.java:process(71)) - SCM in safe mode. 2 DataNodes registered, 3 required.
2021-10-05 13:23:50,477 [RatisPipelineUtilsThread - 0] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(183)) - Sending CreatePipelineCommand for pipeline:PipelineID=a2e217e3-801c-4062-af76-27b6d48b871b to datanode:0c34be74-1f5b-4b04-a6d4-fde6c3deb89a
2021-10-05 13:23:50,491 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  pipeline.PipelineStateManagerImpl (PipelineStateManagerImpl.java:addPipeline(101)) - Created pipeline Pipeline[ Id: a2e217e3-801c-4062-af76-27b6d48b871b, Nodes: 0c34be74-1f5b-4b04-a6d4-fde6c3deb89a{ip: 127.0.0.1, host: localhost, ports: [REPLICATION=46311, RATIS=33359, RATIS_ADMIN=33359, RATIS_SERVER=33359, STANDALONE=44513], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}, ReplicationConfig: RATIS/ONE, State:ALLOCATED, leaderId:, CreationTimestamp2021-10-05T13:23:50.477Z[Etc/UTC]].
2021-10-05 13:23:50,491 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  safemode.HealthyPipelineSafeModeRule (HealthyPipelineSafeModeRule.java:initializeRule(152)) - Refreshed total pipeline count is 0, healthy pipeline threshold count is 1
2021-10-05 13:23:50,492 [RatisPipelineUtilsThread - 0] INFO  ha.SCMHAInvocationHandler (SCMHAInvocationHandler.java:invokeRatis(113)) - Invoking method public abstract void org.apache.hadoop.hdds.scm.pipeline.PipelineStateManager.addPipeline(org.apache.hadoop.hdds.protocol.proto.HddsProtos$Pipeline) throws java.io.IOException on target org.apache.hadoop.hdds.scm.ha.SCMRatisServerImpl@6344f74b, cost 14917.824us
2021-10-05 13:23:50,497 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  pipeline.PipelineStateManagerImpl (PipelineStateManagerImpl.java:addPipeline(101)) - Created pipeline Pipeline[ Id: a2e217e3-801c-4062-af76-27b6d48b871b, Nodes: 0c34be74-1f5b-4b04-a6d4-fde6c3deb89a{ip: 127.0.0.1, host: localhost, ports: [REPLICATION=46311, RATIS=33359, RATIS_ADMIN=33359, RATIS_SERVER=33359, STANDALONE=44513], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}, ReplicationConfig: RATIS/ONE, State:ALLOCATED, leaderId:, CreationTimestamp2021-10-05T13:23:50.477Z[Etc/UTC]].
2021-10-05 13:23:50,497 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  safemode.HealthyPipelineSafeModeRule (HealthyPipelineSafeModeRule.java:initializeRule(152)) - Refreshed total pipeline count is 0, healthy pipeline threshold count is 1
2021-10-05 13:23:50,499 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  ha.SCMStateMachine (SCMStateMachine.java:takeSnapshot(290)) - Current Snapshot Index 10, takeSnapshot took 0 ms
2021-10-05 13:23:50,501 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:takeSnapshot(281)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater: Took a snapshot at index 10
2021-10-05 13:23:50,501 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:lambda$new$0(89)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater: snapshotIndex: updateIncreasingly 5 -> 10
2021-10-05 13:23:50,501 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:purge(306)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-SegmentedRaftLog: purge 10
2021-10-05 13:23:50,501 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-SegmentedRaftLog: snapshotIndex: updateIncreasingly 5 -> 10
2021-10-05 13:23:50,501 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-SegmentedRaftLog: purgeIndex: updateToMax old=0, new=10, updated? true
2021-10-05 13:23:50,803 [Listener at 127.0.0.1/10356] INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(235)) - Waiting for nodes to be ready. Got 2 of 3 DN Heartbeats.
2021-10-05 13:23:50,803 [Listener at 127.0.0.1/10356] INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(238)) - Waiting for cluster to exit safe mode
2021-10-05 13:23:50,803 [Listener at 127.0.0.1/10356] INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(240)) - SCM became leader
2021-10-05 13:23:50,853 [IPC Server handler 11 on default port 15021] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/a9b6c243-aad2-4cee-be19-871628539a81
2021-10-05 13:23:50,854 [IPC Server handler 11 on default port 15021] INFO  node.SCMNodeManager (SCMNodeManager.java:register(389)) - Registered Data node : a9b6c243-aad2-4cee-be19-871628539a81{ip: 127.0.0.1, host: localhost, ports: [REPLICATION=45095, RATIS=36351, RATIS_ADMIN=36351, RATIS_SERVER=36351, STANDALONE=33273], networkLocation: /default-rack, certSerialId: null, persistedOpState: null, persistedOpStateExpiryEpochSec: 0}
2021-10-05 13:23:50,855 [IPC Server handler 2 on default port 15031] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/a9b6c243-aad2-4cee-be19-871628539a81
2021-10-05 13:23:50,855 [IPC Server handler 2 on default port 15031] INFO  node.SCMNodeManager (SCMNodeManager.java:register(389)) - Registered Data node : a9b6c243-aad2-4cee-be19-871628539a81{ip: 127.0.0.1, host: localhost, ports: [REPLICATION=45095, RATIS=36351, RATIS_ADMIN=36351, RATIS_SERVER=36351, STANDALONE=33273], networkLocation: /default-rack, certSerialId: null, persistedOpState: null, persistedOpStateExpiryEpochSec: 0}
2021-10-05 13:23:50,855 [EventQueue-NewNodeForNewNodeHandler] INFO  pipeline.BackgroundPipelineCreator (BackgroundPipelineCreatorV2.java:notifyEventTriggered(279)) - ignore, not leader SCM.
2021-10-05 13:23:50,855 [EventQueue-NewNodeForNewNodeHandler] INFO  pipeline.BackgroundPipelineCreator (BackgroundPipelineCreatorV2.java:notifyEventTriggered(285)) - trigger a one-shot run on RatisPipelineUtilsThread.
2021-10-05 13:23:50,857 [EventQueue-NodeRegistrationContainerReportForDataNodeSafeModeRule] INFO  safemode.SCMSafeModeManager (DataNodeSafeModeRule.java:process(71)) - SCM in safe mode. 3 DataNodes registered, 3 required.
2021-10-05 13:23:50,858 [EventQueue-NodeRegistrationContainerReportForDataNodeSafeModeRule] INFO  safemode.SCMSafeModeManager (SCMSafeModeManager.java:validateSafeModeExitRules(204)) - DataNodeSafeModeRule rule is successfully validated
2021-10-05 13:23:50,858 [EventQueue-NodeRegistrationContainerReportForDataNodeSafeModeRule] INFO  safemode.SCMSafeModeManager (SCMSafeModeManager.java:completePreCheck(233)) - All SCM safe mode pre check rules have passed
2021-10-05 13:23:50,858 [EventQueue-NodeRegistrationContainerReportForDataNodeSafeModeRule] WARN  events.EventQueue (EventQueue.java:fireEvent(194)) - No event handler registered for event TypedEvent{payloadType=SafeModeStatus, name='Safe mode status'}
2021-10-05 13:23:50,858 [EventQueue-NodeRegistrationContainerReportForDataNodeSafeModeRule] INFO  ha.SCMContext (SCMContext.java:updateSafeModeStatus(205)) - Update SafeModeStatus from SafeModeStatus{safeModeStatus=true, preCheckPassed=false} to SafeModeStatus{safeModeStatus=true, preCheckPassed=true}.
2021-10-05 13:23:50,858 [EventQueue-NodeRegistrationContainerReportForDataNodeSafeModeRule] INFO  pipeline.BackgroundPipelineCreator (BackgroundPipelineCreatorV2.java:notifyEventTriggered(285)) - trigger a one-shot run on RatisPipelineUtilsThread.
2021-10-05 13:23:50,859 [RatisPipelineUtilsThread - 0] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(183)) - Sending CreatePipelineCommand for pipeline:PipelineID=422df7cd-075e-4b52-b513-dc372a106217 to datanode:a9b6c243-aad2-4cee-be19-871628539a81
2021-10-05 13:23:50,862 [EventQueue-NodeRegistrationContainerReportForDataNodeSafeModeRule] INFO  safemode.SCMSafeModeManager (DataNodeSafeModeRule.java:process(71)) - SCM in safe mode. 3 DataNodes registered, 3 required.
2021-10-05 13:23:50,862 [EventQueue-NodeRegistrationContainerReportForDataNodeSafeModeRule] INFO  safemode.SCMSafeModeManager (SCMSafeModeManager.java:validateSafeModeExitRules(204)) - DataNodeSafeModeRule rule is successfully validated
2021-10-05 13:23:50,862 [EventQueue-NodeRegistrationContainerReportForDataNodeSafeModeRule] INFO  safemode.SCMSafeModeManager (SCMSafeModeManager.java:completePreCheck(233)) - All SCM safe mode pre check rules have passed
2021-10-05 13:23:50,862 [EventQueue-NodeRegistrationContainerReportForDataNodeSafeModeRule] WARN  events.EventQueue (EventQueue.java:fireEvent(194)) - No event handler registered for event TypedEvent{payloadType=SafeModeStatus, name='Safe mode status'}
2021-10-05 13:23:50,867 [EventQueue-NodeRegistrationContainerReportForDataNodeSafeModeRule] INFO  ha.SCMContext (SCMContext.java:updateSafeModeStatus(205)) - Update SafeModeStatus from SafeModeStatus{safeModeStatus=true, preCheckPassed=false} to SafeModeStatus{safeModeStatus=true, preCheckPassed=true}.
2021-10-05 13:23:50,867 [EventQueue-NodeRegistrationContainerReportForDataNodeSafeModeRule] INFO  pipeline.BackgroundPipelineCreator (BackgroundPipelineCreatorV2.java:notifyEventTriggered(279)) - ignore, not leader SCM.
2021-10-05 13:23:50,868 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  ha.SCMStateMachine (SCMStateMachine.java:takeSnapshot(290)) - Current Snapshot Index 10, takeSnapshot took 0 ms
2021-10-05 13:23:50,868 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:takeSnapshot(281)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater: Took a snapshot at index 10
2021-10-05 13:23:50,868 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:lambda$new$0(89)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater: snapshotIndex: updateIncreasingly 5 -> 10
2021-10-05 13:23:50,868 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:purge(306)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-SegmentedRaftLog: purge 10
2021-10-05 13:23:50,868 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-SegmentedRaftLog: snapshotIndex: updateIncreasingly 5 -> 10
2021-10-05 13:23:50,868 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-SegmentedRaftLog: purgeIndex: updateToMax old=0, new=10, updated? true
2021-10-05 13:23:50,870 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  pipeline.PipelineStateManagerImpl (PipelineStateManagerImpl.java:addPipeline(101)) - Created pipeline Pipeline[ Id: 422df7cd-075e-4b52-b513-dc372a106217, Nodes: a9b6c243-aad2-4cee-be19-871628539a81{ip: 127.0.0.1, host: localhost, ports: [REPLICATION=45095, RATIS=36351, RATIS_ADMIN=36351, RATIS_SERVER=36351, STANDALONE=33273], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}, ReplicationConfig: RATIS/ONE, State:ALLOCATED, leaderId:, CreationTimestamp2021-10-05T13:23:50.859Z[Etc/UTC]].
2021-10-05 13:23:50,870 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  safemode.HealthyPipelineSafeModeRule (HealthyPipelineSafeModeRule.java:initializeRule(152)) - Refreshed total pipeline count is 0, healthy pipeline threshold count is 1
2021-10-05 13:23:50,870 [RatisPipelineUtilsThread - 0] INFO  ha.SCMHAInvocationHandler (SCMHAInvocationHandler.java:invokeRatis(113)) - Invoking method public abstract void org.apache.hadoop.hdds.scm.pipeline.PipelineStateManager.addPipeline(org.apache.hadoop.hdds.protocol.proto.HddsProtos$Pipeline) throws java.io.IOException on target org.apache.hadoop.hdds.scm.ha.SCMRatisServerImpl@6344f74b, cost 11359.061us
2021-10-05 13:23:50,875 [RatisPipelineUtilsThread - 0] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(183)) - Sending CreatePipelineCommand for pipeline:PipelineID=8c8a590d-1d11-430c-931a-52e96576a6db to datanode:f990c0ed-f7f2-4f8a-8ec9-db097d9c855e
2021-10-05 13:23:50,875 [RatisPipelineUtilsThread - 0] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(183)) - Sending CreatePipelineCommand for pipeline:PipelineID=8c8a590d-1d11-430c-931a-52e96576a6db to datanode:0c34be74-1f5b-4b04-a6d4-fde6c3deb89a
2021-10-05 13:23:50,875 [RatisPipelineUtilsThread - 0] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(183)) - Sending CreatePipelineCommand for pipeline:PipelineID=8c8a590d-1d11-430c-931a-52e96576a6db to datanode:a9b6c243-aad2-4cee-be19-871628539a81
2021-10-05 13:23:50,876 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  pipeline.PipelineStateManagerImpl (PipelineStateManagerImpl.java:addPipeline(101)) - Created pipeline Pipeline[ Id: 422df7cd-075e-4b52-b513-dc372a106217, Nodes: a9b6c243-aad2-4cee-be19-871628539a81{ip: 127.0.0.1, host: localhost, ports: [REPLICATION=45095, RATIS=36351, RATIS_ADMIN=36351, RATIS_SERVER=36351, STANDALONE=33273], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}, ReplicationConfig: RATIS/ONE, State:ALLOCATED, leaderId:, CreationTimestamp2021-10-05T13:23:50.859Z[Etc/UTC]].
2021-10-05 13:23:50,876 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  safemode.HealthyPipelineSafeModeRule (HealthyPipelineSafeModeRule.java:initializeRule(152)) - Refreshed total pipeline count is 0, healthy pipeline threshold count is 1
2021-10-05 13:23:50,883 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  pipeline.PipelineStateManagerImpl (PipelineStateManagerImpl.java:addPipeline(101)) - Created pipeline Pipeline[ Id: 8c8a590d-1d11-430c-931a-52e96576a6db, Nodes: f990c0ed-f7f2-4f8a-8ec9-db097d9c855e{ip: 127.0.0.1, host: localhost, ports: [REPLICATION=39769, RATIS=44595, RATIS_ADMIN=44595, RATIS_SERVER=44595, STANDALONE=39009], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}0c34be74-1f5b-4b04-a6d4-fde6c3deb89a{ip: 127.0.0.1, host: localhost, ports: [REPLICATION=46311, RATIS=33359, RATIS_ADMIN=33359, RATIS_SERVER=33359, STANDALONE=44513], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}a9b6c243-aad2-4cee-be19-871628539a81{ip: 127.0.0.1, host: localhost, ports: [REPLICATION=45095, RATIS=36351, RATIS_ADMIN=36351, RATIS_SERVER=36351, STANDALONE=33273], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}, ReplicationConfig: RATIS/THREE, State:ALLOCATED, leaderId:, CreationTimestamp2021-10-05T13:23:50.875Z[Etc/UTC]].
2021-10-05 13:23:50,884 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  safemode.HealthyPipelineSafeModeRule (HealthyPipelineSafeModeRule.java:initializeRule(152)) - Refreshed total pipeline count is 0, healthy pipeline threshold count is 1
2021-10-05 13:23:50,884 [RatisPipelineUtilsThread - 0] INFO  ha.SCMHAInvocationHandler (SCMHAInvocationHandler.java:invokeRatis(113)) - Invoking method public abstract void org.apache.hadoop.hdds.scm.pipeline.PipelineStateManager.addPipeline(org.apache.hadoop.hdds.protocol.proto.HddsProtos$Pipeline) throws java.io.IOException on target org.apache.hadoop.hdds.scm.ha.SCMRatisServerImpl@6344f74b, cost 6898.805us
2021-10-05 13:23:50,886 [RatisPipelineUtilsThread - 0] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(183)) - Sending CreatePipelineCommand for pipeline:PipelineID=90899f2e-5ed2-48cb-9677-d8e46993f0f1 to datanode:f990c0ed-f7f2-4f8a-8ec9-db097d9c855e
2021-10-05 13:23:50,886 [RatisPipelineUtilsThread - 0] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(183)) - Sending CreatePipelineCommand for pipeline:PipelineID=90899f2e-5ed2-48cb-9677-d8e46993f0f1 to datanode:a9b6c243-aad2-4cee-be19-871628539a81
2021-10-05 13:23:50,886 [RatisPipelineUtilsThread - 0] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(183)) - Sending CreatePipelineCommand for pipeline:PipelineID=90899f2e-5ed2-48cb-9677-d8e46993f0f1 to datanode:0c34be74-1f5b-4b04-a6d4-fde6c3deb89a
2021-10-05 13:23:50,890 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  pipeline.PipelineStateManagerImpl (PipelineStateManagerImpl.java:addPipeline(101)) - Created pipeline Pipeline[ Id: 8c8a590d-1d11-430c-931a-52e96576a6db, Nodes: f990c0ed-f7f2-4f8a-8ec9-db097d9c855e{ip: 127.0.0.1, host: localhost, ports: [REPLICATION=39769, RATIS=44595, RATIS_ADMIN=44595, RATIS_SERVER=44595, STANDALONE=39009], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}0c34be74-1f5b-4b04-a6d4-fde6c3deb89a{ip: 127.0.0.1, host: localhost, ports: [REPLICATION=46311, RATIS=33359, RATIS_ADMIN=33359, RATIS_SERVER=33359, STANDALONE=44513], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}a9b6c243-aad2-4cee-be19-871628539a81{ip: 127.0.0.1, host: localhost, ports: [REPLICATION=45095, RATIS=36351, RATIS_ADMIN=36351, RATIS_SERVER=36351, STANDALONE=33273], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}, ReplicationConfig: RATIS/THREE, State:ALLOCATED, leaderId:, CreationTimestamp2021-10-05T13:23:50.875Z[Etc/UTC]].
2021-10-05 13:23:50,890 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  safemode.HealthyPipelineSafeModeRule (HealthyPipelineSafeModeRule.java:initializeRule(152)) - Refreshed total pipeline count is 0, healthy pipeline threshold count is 1
2021-10-05 13:23:50,893 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  pipeline.PipelineStateManagerImpl (PipelineStateManagerImpl.java:addPipeline(101)) - Created pipeline Pipeline[ Id: 90899f2e-5ed2-48cb-9677-d8e46993f0f1, Nodes: f990c0ed-f7f2-4f8a-8ec9-db097d9c855e{ip: 127.0.0.1, host: localhost, ports: [REPLICATION=39769, RATIS=44595, RATIS_ADMIN=44595, RATIS_SERVER=44595, STANDALONE=39009], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}a9b6c243-aad2-4cee-be19-871628539a81{ip: 127.0.0.1, host: localhost, ports: [REPLICATION=45095, RATIS=36351, RATIS_ADMIN=36351, RATIS_SERVER=36351, STANDALONE=33273], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}0c34be74-1f5b-4b04-a6d4-fde6c3deb89a{ip: 127.0.0.1, host: localhost, ports: [REPLICATION=46311, RATIS=33359, RATIS_ADMIN=33359, RATIS_SERVER=33359, STANDALONE=44513], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}, ReplicationConfig: RATIS/THREE, State:ALLOCATED, leaderId:, CreationTimestamp2021-10-05T13:23:50.886Z[Etc/UTC]].
2021-10-05 13:23:50,895 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  safemode.HealthyPipelineSafeModeRule (HealthyPipelineSafeModeRule.java:initializeRule(152)) - Refreshed total pipeline count is 0, healthy pipeline threshold count is 1
2021-10-05 13:23:50,895 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  ha.SCMStateMachine (SCMStateMachine.java:takeSnapshot(290)) - Current Snapshot Index 15, takeSnapshot took 0 ms
2021-10-05 13:23:50,895 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:takeSnapshot(281)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater: Took a snapshot at index 15
2021-10-05 13:23:50,896 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:lambda$new$0(89)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater: snapshotIndex: updateIncreasingly 10 -> 15
2021-10-05 13:23:50,896 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:purge(306)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-SegmentedRaftLog: purge 15
2021-10-05 13:23:50,896 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-SegmentedRaftLog: snapshotIndex: updateIncreasingly 10 -> 15
2021-10-05 13:23:50,896 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-SegmentedRaftLog: purgeIndex: updateToMax old=10, new=15, updated? true
2021-10-05 13:23:50,896 [RatisPipelineUtilsThread - 0] INFO  ha.SCMHAInvocationHandler (SCMHAInvocationHandler.java:invokeRatis(113)) - Invoking method public abstract void org.apache.hadoop.hdds.scm.pipeline.PipelineStateManager.addPipeline(org.apache.hadoop.hdds.protocol.proto.HddsProtos$Pipeline) throws java.io.IOException on target org.apache.hadoop.hdds.scm.ha.SCMRatisServerImpl@6344f74b, cost 9711.393us
2021-10-05 13:23:50,897 [RatisPipelineUtilsThread - 0] INFO  pipeline.PipelineManagerImpl (PipelineManagerImpl.java:recordMetricsForPipeline(613)) - Pipeline: PipelineID=90899f2e-5ed2-48cb-9677-d8e46993f0f1 contains same datanodes as previous pipelines: PipelineID=8c8a590d-1d11-430c-931a-52e96576a6db nodeIds: f990c0ed-f7f2-4f8a-8ec9-db097d9c855e, a9b6c243-aad2-4cee-be19-871628539a81, 0c34be74-1f5b-4b04-a6d4-fde6c3deb89a
2021-10-05 13:23:50,901 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  pipeline.PipelineStateManagerImpl (PipelineStateManagerImpl.java:addPipeline(101)) - Created pipeline Pipeline[ Id: 90899f2e-5ed2-48cb-9677-d8e46993f0f1, Nodes: f990c0ed-f7f2-4f8a-8ec9-db097d9c855e{ip: 127.0.0.1, host: localhost, ports: [REPLICATION=39769, RATIS=44595, RATIS_ADMIN=44595, RATIS_SERVER=44595, STANDALONE=39009], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}a9b6c243-aad2-4cee-be19-871628539a81{ip: 127.0.0.1, host: localhost, ports: [REPLICATION=45095, RATIS=36351, RATIS_ADMIN=36351, RATIS_SERVER=36351, STANDALONE=33273], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}0c34be74-1f5b-4b04-a6d4-fde6c3deb89a{ip: 127.0.0.1, host: localhost, ports: [REPLICATION=46311, RATIS=33359, RATIS_ADMIN=33359, RATIS_SERVER=33359, STANDALONE=44513], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}, ReplicationConfig: RATIS/THREE, State:ALLOCATED, leaderId:, CreationTimestamp2021-10-05T13:23:50.886Z[Etc/UTC]].
2021-10-05 13:23:50,901 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  safemode.HealthyPipelineSafeModeRule (HealthyPipelineSafeModeRule.java:initializeRule(152)) - Refreshed total pipeline count is 0, healthy pipeline threshold count is 1
2021-10-05 13:23:50,901 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  ha.SCMStateMachine (SCMStateMachine.java:takeSnapshot(290)) - Current Snapshot Index 15, takeSnapshot took 0 ms
2021-10-05 13:23:50,901 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:takeSnapshot(281)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater: Took a snapshot at index 15
2021-10-05 13:23:50,902 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:lambda$new$0(89)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater: snapshotIndex: updateIncreasingly 10 -> 15
2021-10-05 13:23:50,902 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:purge(306)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-SegmentedRaftLog: purge 15
2021-10-05 13:23:50,902 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-SegmentedRaftLog: snapshotIndex: updateIncreasingly 10 -> 15
2021-10-05 13:23:50,902 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-SegmentedRaftLog: purgeIndex: updateToMax old=10, new=15, updated? true
2021-10-05 13:23:51,804 [Listener at 127.0.0.1/10356] INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(235)) - Nodes are ready. Got 3 of 3 DN Heartbeats.
2021-10-05 13:23:51,806 [Listener at 127.0.0.1/10356] INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(238)) - Waiting for cluster to exit safe mode
2021-10-05 13:23:51,807 [Listener at 127.0.0.1/10356] INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(240)) - SCM became leader
2021-10-05 13:23:52,263 [Datanode State Machine Thread - 0] ERROR datanode.RunningDatanodeState (RunningDatanodeState.java:computeNextContainerState(199)) - Error in executing end point task.
java.util.concurrent.ExecutionException: java.util.concurrent.TimeoutException
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.hadoop.ozone.container.common.states.datanode.RunningDatanodeState.computeNextContainerState(RunningDatanodeState.java:191)
	at org.apache.hadoop.ozone.container.common.states.datanode.RunningDatanodeState.await(RunningDatanodeState.java:231)
	at org.apache.hadoop.ozone.container.common.states.datanode.RunningDatanodeState.await(RunningDatanodeState.java:50)
	at org.apache.hadoop.ozone.container.common.statemachine.StateContext.execute(StateContext.java:629)
	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.start(DatanodeStateMachine.java:270)
	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.lambda$startDaemon$0(DatanodeStateMachine.java:457)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.util.concurrent.TimeoutException
	at java.util.concurrent.FutureTask.get(FutureTask.java:205)
	at org.apache.hadoop.ozone.container.common.states.datanode.RunningDatanodeState.lambda$execute$0(RunningDatanodeState.java:149)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
2021-10-05 13:23:52,811 [Listener at 127.0.0.1/10356] INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(235)) - Nodes are ready. Got 3 of 3 DN Heartbeats.
2021-10-05 13:23:52,811 [Listener at 127.0.0.1/10356] INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(238)) - Waiting for cluster to exit safe mode
2021-10-05 13:23:52,811 [Listener at 127.0.0.1/10356] INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(240)) - SCM became leader
2021-10-05 13:23:53,261 [Command processor thread] INFO  server.RaftServer (RaftServerProxy.java:addNew(95)) - f990c0ed-f7f2-4f8a-8ec9-db097d9c855e: addNew group-1CD77BA4A78C:[f990c0ed-f7f2-4f8a-8ec9-db097d9c855e|rpc:127.0.0.1:44595|priority:1] returns group-1CD77BA4A78C:java.util.concurrent.CompletableFuture@5a97c2d5[Not completed]
2021-10-05 13:23:53,277 [EndpointStateMachine task thread for /127.0.0.1:15041 - 0 ] WARN  statemachine.EndpointStateMachine (EndpointStateMachine.java:logIfNeeded(236)) - Unable to communicate to SCM server at 127.0.0.1:15041 for past 0 seconds.
java.net.SocketTimeoutException: Call From fv-az270-324/10.1.0.10 to localhost:15041 failed on socket timeout exception: java.net.SocketTimeoutException: 5000 millis timeout while waiting for channel to be ready for read. ch : java.nio.channels.SocketChannel[connected local=/127.0.0.1:39288 remote=/127.0.0.1:15041]; For more details see:  http://wiki.apache.org/hadoop/SocketTimeout
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.hadoop.net.NetUtils.wrapWithMessage(NetUtils.java:913)
	at org.apache.hadoop.net.NetUtils.wrapException(NetUtils.java:848)
	at org.apache.hadoop.ipc.Client.getRpcResponse(Client.java:1577)
	at org.apache.hadoop.ipc.Client.call(Client.java:1519)
	at org.apache.hadoop.ipc.Client.call(Client.java:1416)
	at org.apache.hadoop.ipc.ProtobufRpcEngine$Invoker.invoke(ProtobufRpcEngine.java:236)
	at org.apache.hadoop.ipc.ProtobufRpcEngine$Invoker.invoke(ProtobufRpcEngine.java:123)
	at com.sun.proxy.$Proxy48.submitRequest(Unknown Source)
	at org.apache.hadoop.ozone.protocolPB.StorageContainerDatanodeProtocolClientSideTranslatorPB.submitRequest(StorageContainerDatanodeProtocolClientSideTranslatorPB.java:117)
	at org.apache.hadoop.ozone.protocolPB.StorageContainerDatanodeProtocolClientSideTranslatorPB.getVersion(StorageContainerDatanodeProtocolClientSideTranslatorPB.java:133)
	at org.apache.hadoop.ozone.container.common.states.endpoint.VersionEndpointTask.call(VersionEndpointTask.java:71)
	at org.apache.hadoop.ozone.container.common.states.endpoint.VersionEndpointTask.call(VersionEndpointTask.java:42)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.net.SocketTimeoutException: 5000 millis timeout while waiting for channel to be ready for read. ch : java.nio.channels.SocketChannel[connected local=/127.0.0.1:39288 remote=/127.0.0.1:15041]
	at org.apache.hadoop.net.SocketIOWithTimeout.doIO(SocketIOWithTimeout.java:164)
	at org.apache.hadoop.net.SocketInputStream.read(SocketInputStream.java:161)
	at org.apache.hadoop.net.SocketInputStream.read(SocketInputStream.java:131)
	at java.io.FilterInputStream.read(FilterInputStream.java:133)
	at java.io.BufferedInputStream.fill(BufferedInputStream.java:246)
	at java.io.BufferedInputStream.read(BufferedInputStream.java:265)
	at java.io.FilterInputStream.read(FilterInputStream.java:83)
	at java.io.FilterInputStream.read(FilterInputStream.java:83)
	at org.apache.hadoop.ipc.Client$Connection$PingInputStream.read(Client.java:563)
	at java.io.DataInputStream.readInt(DataInputStream.java:387)
	at org.apache.hadoop.ipc.Client$IpcStreams.readResponse(Client.java:1892)
	at org.apache.hadoop.ipc.Client$Connection.receiveRpcResponse(Client.java:1202)
	at org.apache.hadoop.ipc.Client$Connection.run(Client.java:1098)
2021-10-05 13:23:53,277 [EndpointStateMachine task thread for /127.0.0.1:15041 - 0 ] WARN  statemachine.EndpointStateMachine (EndpointStateMachine.java:logIfNeeded(236)) - Unable to communicate to SCM server at localhost:15041 for past 0 seconds.
java.net.SocketTimeoutException: Call From fv-az270-324/10.1.0.10 to localhost:15041 failed on socket timeout exception: java.net.SocketTimeoutException: 5000 millis timeout while waiting for channel to be ready for read. ch : java.nio.channels.SocketChannel[connected local=/127.0.0.1:39288 remote=/127.0.0.1:15041]; For more details see:  http://wiki.apache.org/hadoop/SocketTimeout
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.hadoop.net.NetUtils.wrapWithMessage(NetUtils.java:913)
	at org.apache.hadoop.net.NetUtils.wrapException(NetUtils.java:848)
	at org.apache.hadoop.ipc.Client.getRpcResponse(Client.java:1577)
	at org.apache.hadoop.ipc.Client.call(Client.java:1519)
	at org.apache.hadoop.ipc.Client.call(Client.java:1416)
	at org.apache.hadoop.ipc.ProtobufRpcEngine$Invoker.invoke(ProtobufRpcEngine.java:236)
	at org.apache.hadoop.ipc.ProtobufRpcEngine$Invoker.invoke(ProtobufRpcEngine.java:123)
	at com.sun.proxy.$Proxy48.submitRequest(Unknown Source)
	at org.apache.hadoop.ozone.protocolPB.StorageContainerDatanodeProtocolClientSideTranslatorPB.submitRequest(StorageContainerDatanodeProtocolClientSideTranslatorPB.java:117)
	at org.apache.hadoop.ozone.protocolPB.StorageContainerDatanodeProtocolClientSideTranslatorPB.getVersion(StorageContainerDatanodeProtocolClientSideTranslatorPB.java:133)
	at org.apache.hadoop.ozone.container.common.states.endpoint.VersionEndpointTask.call(VersionEndpointTask.java:71)
	at org.apache.hadoop.ozone.container.common.states.endpoint.VersionEndpointTask.call(VersionEndpointTask.java:42)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.net.SocketTimeoutException: 5000 millis timeout while waiting for channel to be ready for read. ch : java.nio.channels.SocketChannel[connected local=/127.0.0.1:39288 remote=/127.0.0.1:15041]
	at org.apache.hadoop.net.SocketIOWithTimeout.doIO(SocketIOWithTimeout.java:164)
	at org.apache.hadoop.net.SocketInputStream.read(SocketInputStream.java:161)
	at org.apache.hadoop.net.SocketInputStream.read(SocketInputStream.java:131)
	at java.io.FilterInputStream.read(FilterInputStream.java:133)
	at java.io.BufferedInputStream.fill(BufferedInputStream.java:246)
	at java.io.BufferedInputStream.read(BufferedInputStream.java:265)
	at java.io.FilterInputStream.read(FilterInputStream.java:83)
	at java.io.FilterInputStream.read(FilterInputStream.java:83)
	at org.apache.hadoop.ipc.Client$Connection$PingInputStream.read(Client.java:563)
	at java.io.DataInputStream.readInt(DataInputStream.java:387)
	at org.apache.hadoop.ipc.Client$IpcStreams.readResponse(Client.java:1892)
	at org.apache.hadoop.ipc.Client$Connection.receiveRpcResponse(Client.java:1202)
	at org.apache.hadoop.ipc.Client$Connection.run(Client.java:1098)
2021-10-05 13:23:53,277 [EndpointStateMachine task thread for /127.0.0.1:15041 - 0 ] WARN  statemachine.EndpointStateMachine (EndpointStateMachine.java:logIfNeeded(236)) - Unable to communicate to SCM server at 127.0.0.1:15041 for past 0 seconds.
java.net.SocketTimeoutException: Call From fv-az270-324/10.1.0.10 to localhost:15041 failed on socket timeout exception: java.net.SocketTimeoutException: 5000 millis timeout while waiting for channel to be ready for read. ch : java.nio.channels.SocketChannel[connected local=/127.0.0.1:39288 remote=/127.0.0.1:15041]; For more details see:  http://wiki.apache.org/hadoop/SocketTimeout
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.hadoop.net.NetUtils.wrapWithMessage(NetUtils.java:913)
	at org.apache.hadoop.net.NetUtils.wrapException(NetUtils.java:848)
	at org.apache.hadoop.ipc.Client.getRpcResponse(Client.java:1577)
	at org.apache.hadoop.ipc.Client.call(Client.java:1519)
	at org.apache.hadoop.ipc.Client.call(Client.java:1416)
	at org.apache.hadoop.ipc.ProtobufRpcEngine$Invoker.invoke(ProtobufRpcEngine.java:236)
	at org.apache.hadoop.ipc.ProtobufRpcEngine$Invoker.invoke(ProtobufRpcEngine.java:123)
	at com.sun.proxy.$Proxy48.submitRequest(Unknown Source)
	at org.apache.hadoop.ozone.protocolPB.StorageContainerDatanodeProtocolClientSideTranslatorPB.submitRequest(StorageContainerDatanodeProtocolClientSideTranslatorPB.java:117)
	at org.apache.hadoop.ozone.protocolPB.StorageContainerDatanodeProtocolClientSideTranslatorPB.getVersion(StorageContainerDatanodeProtocolClientSideTranslatorPB.java:133)
	at org.apache.hadoop.ozone.container.common.states.endpoint.VersionEndpointTask.call(VersionEndpointTask.java:71)
	at org.apache.hadoop.ozone.container.common.states.endpoint.VersionEndpointTask.call(VersionEndpointTask.java:42)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.net.SocketTimeoutException: 5000 millis timeout while waiting for channel to be ready for read. ch : java.nio.channels.SocketChannel[connected local=/127.0.0.1:39288 remote=/127.0.0.1:15041]
	at org.apache.hadoop.net.SocketIOWithTimeout.doIO(SocketIOWithTimeout.java:164)
	at org.apache.hadoop.net.SocketInputStream.read(SocketInputStream.java:161)
	at org.apache.hadoop.net.SocketInputStream.read(SocketInputStream.java:131)
	at java.io.FilterInputStream.read(FilterInputStream.java:133)
	at java.io.BufferedInputStream.fill(BufferedInputStream.java:246)
	at java.io.BufferedInputStream.read(BufferedInputStream.java:265)
	at java.io.FilterInputStream.read(FilterInputStream.java:83)
	at java.io.FilterInputStream.read(FilterInputStream.java:83)
	at org.apache.hadoop.ipc.Client$Connection$PingInputStream.read(Client.java:563)
	at java.io.DataInputStream.readInt(DataInputStream.java:387)
	at org.apache.hadoop.ipc.Client$IpcStreams.readResponse(Client.java:1892)
	at org.apache.hadoop.ipc.Client$Connection.receiveRpcResponse(Client.java:1202)
	at org.apache.hadoop.ipc.Client$Connection.run(Client.java:1098)
2021-10-05 13:23:53,296 [pool-96-thread-1] INFO  server.RaftServer$Division (RaftServerImpl.java:<init>(181)) - f990c0ed-f7f2-4f8a-8ec9-db097d9c855e: new RaftServerImpl for group-1CD77BA4A78C:[f990c0ed-f7f2-4f8a-8ec9-db097d9c855e|rpc:127.0.0.1:44595|priority:1] with ContainerStateMachine:uninitialized
2021-10-05 13:23:53,300 [pool-96-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.timeout.min = 5s (custom)
2021-10-05 13:23:53,300 [pool-96-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.timeout.max = 5200ms (custom)
2021-10-05 13:23:53,300 [pool-96-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.sleep.time = 25ms (default)
2021-10-05 13:23:53,300 [pool-96-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.slowness.timeout = 300s (custom)
2021-10-05 13:23:53,300 [pool-96-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.leaderelection.leader.step-down.wait-time = 10s (default)
2021-10-05 13:23:53,300 [pool-96-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.sleep.deviation.threshold = 300ms (default)
2021-10-05 13:23:53,300 [pool-96-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.appender.install.snapshot.enabled = false (custom)
2021-10-05 13:23:53,300 [pool-96-thread-1] INFO  server.RaftServer$Division (ServerState.java:<init>(105)) - f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-1CD77BA4A78C: ConfigurationManager, init=-1: [f990c0ed-f7f2-4f8a-8ec9-db097d9c855e|rpc:127.0.0.1:44595|priority:1], old=null, confs=<EMPTY_MAP>
2021-10-05 13:23:53,301 [pool-96-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.storage.dir = [/home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-98f4f1fb-613f-4a4a-83a3-c748f4b4520d/datanode-0/data/ratis] (custom)
2021-10-05 13:23:53,301 [pool-96-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.corruption.policy = EXCEPTION (default)
2021-10-05 13:23:53,301 [pool-96-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.storage.free-space.min = 0MB (=0) (default)
2021-10-05 13:23:53,301 [pool-96-thread-1] INFO  storage.RaftStorageDirectory (RaftStorageDirectoryImpl.java:analyzeStorage(135)) - The storage directory /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-98f4f1fb-613f-4a4a-83a3-c748f4b4520d/datanode-0/data/ratis/4bafc9c3-fe1c-42b3-af40-1cd77ba4a78c does not exist. Creating ...
2021-10-05 13:23:53,303 [pool-96-thread-1] INFO  storage.RaftStorageDirectory (RaftStorageDirectoryImpl.java:tryLock(230)) - Lock on /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-98f4f1fb-613f-4a4a-83a3-c748f4b4520d/datanode-0/data/ratis/4bafc9c3-fe1c-42b3-af40-1cd77ba4a78c/in_use.lock acquired by nodename 17451@fv-az270-324
2021-10-05 13:23:53,304 [pool-96-thread-1] INFO  storage.RaftStorage (RaftStorageImpl.java:format(89)) - Storage directory /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-98f4f1fb-613f-4a4a-83a3-c748f4b4520d/datanode-0/data/ratis/4bafc9c3-fe1c-42b3-af40-1cd77ba4a78c has been successfully formatted.
2021-10-05 13:23:53,307 [pool-96-thread-1] INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(224)) - group-1CD77BA4A78C: The snapshot info is null. Setting the last applied indexto:(t:0, i:~)
2021-10-05 13:23:53,307 [pool-96-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.notification.no-leader.timeout = 300s (custom)
2021-10-05 13:23:53,307 [pool-96-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.use.memory = false (default)
2021-10-05 13:23:53,326 [pool-96-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.purge.gap = 1000000 (custom)
2021-10-05 13:23:53,326 [pool-96-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2021-10-05 13:23:53,326 [pool-96-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.segment.size.max = 1048576 (custom)
2021-10-05 13:23:53,327 [pool-96-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.segment.cache.num.max = 2 (custom)
2021-10-05 13:23:53,328 [pool-96-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.segment.cache.size.max = 200MB (=209715200) (default)
2021-10-05 13:23:53,329 [pool-96-thread-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:<init>(182)) - new f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-1CD77BA4A78C-SegmentedRaftLogWorker for RaftStorageImpl:Storage Directory /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-98f4f1fb-613f-4a4a-83a3-c748f4b4520d/datanode-0/data/ratis/4bafc9c3-fe1c-42b3-af40-1cd77ba4a78c
2021-10-05 13:23:53,329 [pool-96-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2021-10-05 13:23:53,329 [pool-96-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.queue.element-limit = 1024 (custom)
2021-10-05 13:23:53,329 [pool-96-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.segment.size.max = 1048576 (custom)
2021-10-05 13:23:53,329 [pool-96-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.preallocated.size = 16384 (custom)
2021-10-05 13:23:53,329 [pool-96-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.force.sync.num = 128 (default)
2021-10-05 13:23:53,329 [pool-96-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.statemachine.data.sync = true (default)
2021-10-05 13:23:53,329 [pool-96-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2021-10-05 13:23:53,329 [pool-96-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2021-10-05 13:23:53,331 [pool-96-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.write.buffer.size = 1048576 (custom)
2021-10-05 13:23:53,337 [EventQueue-PipelineReportForPipelineReportHandler] INFO  pipeline.PipelineManagerImpl (PipelineManagerImpl.java:openPipeline(282)) - Pipeline Pipeline[ Id: 4bafc9c3-fe1c-42b3-af40-1cd77ba4a78c, Nodes: f990c0ed-f7f2-4f8a-8ec9-db097d9c855e{ip: 127.0.0.1, host: localhost, ports: [REPLICATION=39769, RATIS=44595, RATIS_ADMIN=44595, RATIS_SERVER=44595, STANDALONE=39009], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}, ReplicationConfig: RATIS/ONE, State:ALLOCATED, leaderId:f990c0ed-f7f2-4f8a-8ec9-db097d9c855e, CreationTimestamp2021-10-05T13:23:50.320Z[Etc/UTC]] moved to OPEN state
2021-10-05 13:23:53,338 [pool-96-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2021-10-05 13:23:53,338 [pool-96-thread-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:lambda$new$0(133)) - f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-1CD77BA4A78C-SegmentedRaftLogWorker: flushIndex: setUnconditionally 0 -> -1
2021-10-05 13:23:53,337 [EventQueue-PipelineReportForPipelineReportHandler] INFO  pipeline.PipelineManagerImpl (PipelineManagerImpl.java:openPipeline(282)) - Pipeline Pipeline[ Id: 4bafc9c3-fe1c-42b3-af40-1cd77ba4a78c, Nodes: f990c0ed-f7f2-4f8a-8ec9-db097d9c855e{ip: 127.0.0.1, host: localhost, ports: [REPLICATION=39769, RATIS=44595, RATIS_ADMIN=44595, RATIS_SERVER=44595, STANDALONE=39009], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}, ReplicationConfig: RATIS/ONE, State:ALLOCATED, leaderId:f990c0ed-f7f2-4f8a-8ec9-db097d9c855e, CreationTimestamp2021-10-05T13:23:50.320Z[Etc/UTC]] moved to OPEN state
2021-10-05 13:23:53,358 [pool-96-thread-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:lambda$new$0(133)) - f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-1CD77BA4A78C-SegmentedRaftLogWorker: safeCacheEvictIndex: setUnconditionally 0 -> -1
2021-10-05 13:23:53,359 [pool-96-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2021-10-05 13:23:53,359 [pool-96-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2021-10-05 13:23:53,359 [pool-96-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.snapshot.retention.file.num = 5 (custom)
2021-10-05 13:23:53,359 [pool-96-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.purge.upto.snapshot.index = false (default)
2021-10-05 13:23:53,359 [pool-96-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.retrycache.expirytime = 600000ms (custom)
2021-10-05 13:23:53,359 [pool-96-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.retrycache.statistics.expirytime = 100μs (default)
2021-10-05 13:23:53,360 [pool-96-thread-1] INFO  server.RaftServer$Division (RaftServerImpl.java:start(296)) - f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-1CD77BA4A78C: start as a follower, conf=-1: [f990c0ed-f7f2-4f8a-8ec9-db097d9c855e|rpc:127.0.0.1:44595|priority:1], old=null
2021-10-05 13:23:53,361 [pool-96-thread-1] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(285)) - f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-1CD77BA4A78C: changes role from      null to FOLLOWER at term 0 for startAsFollower
2021-10-05 13:23:53,361 [pool-96-thread-1] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(130)) - f990c0ed-f7f2-4f8a-8ec9-db097d9c855e: start f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-1CD77BA4A78C-FollowerState
2021-10-05 13:23:53,369 [pool-96-thread-1] INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-1CD77BA4A78C,id=f990c0ed-f7f2-4f8a-8ec9-db097d9c855e
2021-10-05 13:23:53,373 [Command processor thread] INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:addGroup(763)) - Created group PipelineID=4bafc9c3-fe1c-42b3-af40-1cd77ba4a78c
2021-10-05 13:23:53,380 [Command processor thread] INFO  commandhandler.CreatePipelineCommandHandler (CreatePipelineCommandHandler.java:handle(106)) - Created Pipeline RATIS ONE PipelineID=4bafc9c3-fe1c-42b3-af40-1cd77ba4a78c.
2021-10-05 13:23:53,380 [Command processor thread] INFO  server.RaftServer (RaftServerProxy.java:addNew(95)) - f990c0ed-f7f2-4f8a-8ec9-db097d9c855e: addNew group-52E96576A6DB:[0c34be74-1f5b-4b04-a6d4-fde6c3deb89a|rpc:127.0.0.1:33359|priority:0, f990c0ed-f7f2-4f8a-8ec9-db097d9c855e|rpc:127.0.0.1:44595|priority:0, a9b6c243-aad2-4cee-be19-871628539a81|rpc:127.0.0.1:36351|priority:1] returns group-52E96576A6DB:java.util.concurrent.CompletableFuture@49886090[Not completed]
2021-10-05 13:23:53,382 [pool-96-thread-1] INFO  server.RaftServer$Division (RaftServerImpl.java:<init>(181)) - f990c0ed-f7f2-4f8a-8ec9-db097d9c855e: new RaftServerImpl for group-52E96576A6DB:[0c34be74-1f5b-4b04-a6d4-fde6c3deb89a|rpc:127.0.0.1:33359|priority:0, f990c0ed-f7f2-4f8a-8ec9-db097d9c855e|rpc:127.0.0.1:44595|priority:0, a9b6c243-aad2-4cee-be19-871628539a81|rpc:127.0.0.1:36351|priority:1] with ContainerStateMachine:uninitialized
2021-10-05 13:23:53,382 [pool-96-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.timeout.min = 5s (custom)
2021-10-05 13:23:53,382 [pool-96-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.timeout.max = 5200ms (custom)
2021-10-05 13:23:53,382 [pool-96-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.sleep.time = 25ms (default)
2021-10-05 13:23:53,382 [pool-96-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.slowness.timeout = 300s (custom)
2021-10-05 13:23:53,382 [pool-96-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.leaderelection.leader.step-down.wait-time = 10s (default)
2021-10-05 13:23:53,382 [pool-96-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.sleep.deviation.threshold = 300ms (default)
2021-10-05 13:23:53,382 [pool-96-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.appender.install.snapshot.enabled = false (custom)
2021-10-05 13:23:53,382 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  safemode.HealthyPipelineSafeModeRule (HealthyPipelineSafeModeRule.java:initializeRule(152)) - Refreshed total pipeline count is 0, healthy pipeline threshold count is 1
2021-10-05 13:23:53,383 [EventQueue-PipelineReportForPipelineReportHandler] INFO  ha.SCMHAInvocationHandler (SCMHAInvocationHandler.java:invokeRatis(113)) - Invoking method public abstract void org.apache.hadoop.hdds.scm.pipeline.PipelineStateManager.updatePipelineState(org.apache.hadoop.hdds.protocol.proto.HddsProtos$PipelineID,org.apache.hadoop.hdds.protocol.proto.HddsProtos$PipelineState) throws java.io.IOException on target org.apache.hadoop.hdds.scm.ha.SCMRatisServerImpl@6344f74b, cost 44716.063us
2021-10-05 13:23:53,382 [pool-96-thread-1] INFO  server.RaftServer$Division (ServerState.java:<init>(105)) - f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-52E96576A6DB: ConfigurationManager, init=-1: [0c34be74-1f5b-4b04-a6d4-fde6c3deb89a|rpc:127.0.0.1:33359|priority:0, f990c0ed-f7f2-4f8a-8ec9-db097d9c855e|rpc:127.0.0.1:44595|priority:0, a9b6c243-aad2-4cee-be19-871628539a81|rpc:127.0.0.1:36351|priority:1], old=null, confs=<EMPTY_MAP>
2021-10-05 13:23:53,384 [pool-96-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.storage.dir = [/home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-98f4f1fb-613f-4a4a-83a3-c748f4b4520d/datanode-0/data/ratis] (custom)
2021-10-05 13:23:53,384 [pool-96-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.corruption.policy = EXCEPTION (default)
2021-10-05 13:23:53,384 [pool-96-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.storage.free-space.min = 0MB (=0) (default)
2021-10-05 13:23:53,384 [pool-96-thread-1] INFO  storage.RaftStorageDirectory (RaftStorageDirectoryImpl.java:analyzeStorage(135)) - The storage directory /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-98f4f1fb-613f-4a4a-83a3-c748f4b4520d/datanode-0/data/ratis/8c8a590d-1d11-430c-931a-52e96576a6db does not exist. Creating ...
2021-10-05 13:23:53,378 [EventQueue-PipelineReportForPipelineReportHandler] INFO  ha.SCMHAInvocationHandler (SCMHAInvocationHandler.java:invokeRatis(113)) - Invoking method public abstract void org.apache.hadoop.hdds.scm.pipeline.PipelineStateManager.updatePipelineState(org.apache.hadoop.hdds.protocol.proto.HddsProtos$PipelineID,org.apache.hadoop.hdds.protocol.proto.HddsProtos$PipelineState) throws java.io.IOException on target org.apache.hadoop.hdds.scm.ha.SCMRatisServerImpl@4caa9da2, cost 22655.011us
2021-10-05 13:23:53,387 [pool-96-thread-1] INFO  storage.RaftStorageDirectory (RaftStorageDirectoryImpl.java:tryLock(230)) - Lock on /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-98f4f1fb-613f-4a4a-83a3-c748f4b4520d/datanode-0/data/ratis/8c8a590d-1d11-430c-931a-52e96576a6db/in_use.lock acquired by nodename 17451@fv-az270-324
2021-10-05 13:23:53,400 [EventQueue-OpenPipelineForHealthyPipelineSafeModeRule] INFO  safemode.SCMSafeModeManager (HealthyPipelineSafeModeRule.java:process(124)) - SCM in safe mode. Healthy pipelines reported count is 0, required healthy pipeline reported count is 1
2021-10-05 13:23:53,403 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  safemode.HealthyPipelineSafeModeRule (HealthyPipelineSafeModeRule.java:initializeRule(152)) - Refreshed total pipeline count is 0, healthy pipeline threshold count is 1
2021-10-05 13:23:53,403 [pool-96-thread-1] INFO  storage.RaftStorage (RaftStorageImpl.java:format(89)) - Storage directory /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-98f4f1fb-613f-4a4a-83a3-c748f4b4520d/datanode-0/data/ratis/8c8a590d-1d11-430c-931a-52e96576a6db has been successfully formatted.
2021-10-05 13:23:53,404 [pool-96-thread-1] INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(224)) - group-52E96576A6DB: The snapshot info is null. Setting the last applied indexto:(t:0, i:~)
2021-10-05 13:23:53,404 [pool-96-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.notification.no-leader.timeout = 300s (custom)
2021-10-05 13:23:53,404 [pool-96-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.use.memory = false (default)
2021-10-05 13:23:53,404 [pool-96-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.purge.gap = 1000000 (custom)
2021-10-05 13:23:53,404 [pool-96-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2021-10-05 13:23:53,404 [pool-96-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.segment.size.max = 1048576 (custom)
2021-10-05 13:23:53,405 [pool-96-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.segment.cache.num.max = 2 (custom)
2021-10-05 13:23:53,405 [pool-96-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.segment.cache.size.max = 200MB (=209715200) (default)
2021-10-05 13:23:53,405 [pool-96-thread-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:<init>(182)) - new f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-52E96576A6DB-SegmentedRaftLogWorker for RaftStorageImpl:Storage Directory /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-98f4f1fb-613f-4a4a-83a3-c748f4b4520d/datanode-0/data/ratis/8c8a590d-1d11-430c-931a-52e96576a6db
2021-10-05 13:23:53,405 [pool-96-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2021-10-05 13:23:53,405 [pool-96-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.queue.element-limit = 1024 (custom)
2021-10-05 13:23:53,405 [pool-96-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.segment.size.max = 1048576 (custom)
2021-10-05 13:23:53,405 [pool-96-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.preallocated.size = 16384 (custom)
2021-10-05 13:23:53,405 [pool-96-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.force.sync.num = 128 (default)
2021-10-05 13:23:53,405 [pool-96-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.statemachine.data.sync = true (default)
2021-10-05 13:23:53,405 [pool-96-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2021-10-05 13:23:53,405 [pool-96-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2021-10-05 13:23:53,407 [pool-96-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.write.buffer.size = 1048576 (custom)
2021-10-05 13:23:53,408 [pool-96-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2021-10-05 13:23:53,408 [pool-96-thread-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:lambda$new$0(133)) - f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-52E96576A6DB-SegmentedRaftLogWorker: flushIndex: setUnconditionally 0 -> -1
2021-10-05 13:23:53,408 [pool-96-thread-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:lambda$new$0(133)) - f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-52E96576A6DB-SegmentedRaftLogWorker: safeCacheEvictIndex: setUnconditionally 0 -> -1
2021-10-05 13:23:53,408 [pool-96-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2021-10-05 13:23:53,408 [pool-96-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2021-10-05 13:23:53,409 [pool-96-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.snapshot.retention.file.num = 5 (custom)
2021-10-05 13:23:53,409 [pool-96-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.purge.upto.snapshot.index = false (default)
2021-10-05 13:23:53,409 [pool-96-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.retrycache.expirytime = 600000ms (custom)
2021-10-05 13:23:53,409 [pool-96-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.retrycache.statistics.expirytime = 100μs (default)
2021-10-05 13:23:53,410 [pool-96-thread-1] INFO  server.RaftServer$Division (RaftServerImpl.java:start(296)) - f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-52E96576A6DB: start as a follower, conf=-1: [0c34be74-1f5b-4b04-a6d4-fde6c3deb89a|rpc:127.0.0.1:33359|priority:0, f990c0ed-f7f2-4f8a-8ec9-db097d9c855e|rpc:127.0.0.1:44595|priority:0, a9b6c243-aad2-4cee-be19-871628539a81|rpc:127.0.0.1:36351|priority:1], old=null
2021-10-05 13:23:53,410 [pool-96-thread-1] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(285)) - f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-52E96576A6DB: changes role from      null to FOLLOWER at term 0 for startAsFollower
2021-10-05 13:23:53,410 [pool-96-thread-1] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(130)) - f990c0ed-f7f2-4f8a-8ec9-db097d9c855e: start f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-52E96576A6DB-FollowerState
2021-10-05 13:23:53,410 [pool-96-thread-1] INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-52E96576A6DB,id=f990c0ed-f7f2-4f8a-8ec9-db097d9c855e
2021-10-05 13:23:53,416 [Command processor thread] INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:addGroup(763)) - Created group PipelineID=8c8a590d-1d11-430c-931a-52e96576a6db
2021-10-05 13:23:53,433 [EventQueue-OpenPipelineForHealthyPipelineSafeModeRule] INFO  safemode.SCMSafeModeManager (HealthyPipelineSafeModeRule.java:process(124)) - SCM in safe mode. Healthy pipelines reported count is 0, required healthy pipeline reported count is 1
2021-10-05 13:23:53,435 [EventQueue-OpenPipelineForHealthyPipelineSafeModeRule] INFO  safemode.SCMSafeModeManager (HealthyPipelineSafeModeRule.java:process(124)) - SCM in safe mode. Healthy pipelines reported count is 0, required healthy pipeline reported count is 1
2021-10-05 13:23:53,469 [Command processor thread] INFO  server.RaftServer (RaftServerProxy.java:addNew(95)) - 0c34be74-1f5b-4b04-a6d4-fde6c3deb89a: addNew group-27B6D48B871B:[0c34be74-1f5b-4b04-a6d4-fde6c3deb89a|rpc:127.0.0.1:33359|priority:1] returns group-27B6D48B871B:java.util.concurrent.CompletableFuture@59973b6d[Not completed]
2021-10-05 13:23:53,469 [Datanode State Machine Thread - 0] ERROR datanode.RunningDatanodeState (RunningDatanodeState.java:computeNextContainerState(199)) - Error in executing end point task.
java.util.concurrent.ExecutionException: java.util.concurrent.TimeoutException
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.hadoop.ozone.container.common.states.datanode.RunningDatanodeState.computeNextContainerState(RunningDatanodeState.java:191)
	at org.apache.hadoop.ozone.container.common.states.datanode.RunningDatanodeState.await(RunningDatanodeState.java:231)
	at org.apache.hadoop.ozone.container.common.states.datanode.RunningDatanodeState.await(RunningDatanodeState.java:50)
	at org.apache.hadoop.ozone.container.common.statemachine.StateContext.execute(StateContext.java:629)
	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.start(DatanodeStateMachine.java:270)
	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.lambda$startDaemon$0(DatanodeStateMachine.java:457)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.util.concurrent.TimeoutException
	at java.util.concurrent.FutureTask.get(FutureTask.java:205)
	at org.apache.hadoop.ozone.container.common.states.datanode.RunningDatanodeState.lambda$execute$0(RunningDatanodeState.java:149)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
2021-10-05 13:23:53,485 [pool-117-thread-1] INFO  server.RaftServer$Division (RaftServerImpl.java:<init>(181)) - 0c34be74-1f5b-4b04-a6d4-fde6c3deb89a: new RaftServerImpl for group-27B6D48B871B:[0c34be74-1f5b-4b04-a6d4-fde6c3deb89a|rpc:127.0.0.1:33359|priority:1] with ContainerStateMachine:uninitialized
2021-10-05 13:23:53,489 [pool-117-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.timeout.min = 5s (custom)
2021-10-05 13:23:53,489 [grpc-default-executor-0] INFO  server.RaftServer (RaftServerProxy.java:addNew(95)) - 0c34be74-1f5b-4b04-a6d4-fde6c3deb89a: addNew group-52E96576A6DB:[0c34be74-1f5b-4b04-a6d4-fde6c3deb89a|rpc:127.0.0.1:33359|dataStream:|priority:0, f990c0ed-f7f2-4f8a-8ec9-db097d9c855e|rpc:127.0.0.1:44595|dataStream:|priority:0, a9b6c243-aad2-4cee-be19-871628539a81|rpc:127.0.0.1:36351|dataStream:|priority:1] returns group-52E96576A6DB:java.util.concurrent.CompletableFuture@6af6ec4e[Not completed]
2021-10-05 13:23:53,489 [pool-117-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.timeout.max = 5200ms (custom)
2021-10-05 13:23:53,489 [pool-117-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.sleep.time = 25ms (default)
2021-10-05 13:23:53,491 [pool-117-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.slowness.timeout = 300s (custom)
2021-10-05 13:23:53,491 [pool-117-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.leaderelection.leader.step-down.wait-time = 10s (default)
2021-10-05 13:23:53,491 [pool-117-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.sleep.deviation.threshold = 300ms (default)
2021-10-05 13:23:53,491 [pool-117-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.appender.install.snapshot.enabled = false (custom)
2021-10-05 13:23:53,491 [pool-117-thread-1] INFO  server.RaftServer$Division (ServerState.java:<init>(105)) - 0c34be74-1f5b-4b04-a6d4-fde6c3deb89a@group-27B6D48B871B: ConfigurationManager, init=-1: [0c34be74-1f5b-4b04-a6d4-fde6c3deb89a|rpc:127.0.0.1:33359|priority:1], old=null, confs=<EMPTY_MAP>
2021-10-05 13:23:53,491 [pool-117-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.storage.dir = [/home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-98f4f1fb-613f-4a4a-83a3-c748f4b4520d/datanode-1/data/ratis] (custom)
2021-10-05 13:23:53,492 [pool-117-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.corruption.policy = EXCEPTION (default)
2021-10-05 13:23:53,492 [pool-117-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.storage.free-space.min = 0MB (=0) (default)
2021-10-05 13:23:53,492 [pool-117-thread-1] INFO  storage.RaftStorageDirectory (RaftStorageDirectoryImpl.java:analyzeStorage(135)) - The storage directory /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-98f4f1fb-613f-4a4a-83a3-c748f4b4520d/datanode-1/data/ratis/a2e217e3-801c-4062-af76-27b6d48b871b does not exist. Creating ...
2021-10-05 13:23:53,494 [pool-117-thread-1] INFO  storage.RaftStorageDirectory (RaftStorageDirectoryImpl.java:tryLock(230)) - Lock on /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-98f4f1fb-613f-4a4a-83a3-c748f4b4520d/datanode-1/data/ratis/a2e217e3-801c-4062-af76-27b6d48b871b/in_use.lock acquired by nodename 17451@fv-az270-324
2021-10-05 13:23:53,495 [pool-117-thread-1] INFO  storage.RaftStorage (RaftStorageImpl.java:format(89)) - Storage directory /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-98f4f1fb-613f-4a4a-83a3-c748f4b4520d/datanode-1/data/ratis/a2e217e3-801c-4062-af76-27b6d48b871b has been successfully formatted.
2021-10-05 13:23:53,498 [EventQueue-PipelineReportForPipelineReportHandler] INFO  pipeline.PipelineManagerImpl (PipelineManagerImpl.java:openPipeline(282)) - Pipeline Pipeline[ Id: a2e217e3-801c-4062-af76-27b6d48b871b, Nodes: 0c34be74-1f5b-4b04-a6d4-fde6c3deb89a{ip: 127.0.0.1, host: localhost, ports: [REPLICATION=46311, RATIS=33359, RATIS_ADMIN=33359, RATIS_SERVER=33359, STANDALONE=44513], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}, ReplicationConfig: RATIS/ONE, State:ALLOCATED, leaderId:0c34be74-1f5b-4b04-a6d4-fde6c3deb89a, CreationTimestamp2021-10-05T13:23:50.477Z[Etc/UTC]] moved to OPEN state
2021-10-05 13:23:53,498 [EventQueue-PipelineReportForPipelineReportHandler] INFO  ha.SCMHAInvocationHandler (SCMHAInvocationHandler.java:invokeRatis(113)) - Invoking method public abstract void org.apache.hadoop.hdds.scm.pipeline.PipelineStateManager.updatePipelineState(org.apache.hadoop.hdds.protocol.proto.HddsProtos$PipelineID,org.apache.hadoop.hdds.protocol.proto.HddsProtos$PipelineState) throws java.io.IOException on target org.apache.hadoop.hdds.scm.ha.SCMRatisServerImpl@4caa9da2, cost 224.823us
2021-10-05 13:23:53,499 [EventQueue-PipelineReportForPipelineReportHandler] INFO  pipeline.PipelineManagerImpl (PipelineManagerImpl.java:openPipeline(282)) - Pipeline Pipeline[ Id: a2e217e3-801c-4062-af76-27b6d48b871b, Nodes: 0c34be74-1f5b-4b04-a6d4-fde6c3deb89a{ip: 127.0.0.1, host: localhost, ports: [REPLICATION=46311, RATIS=33359, RATIS_ADMIN=33359, RATIS_SERVER=33359, STANDALONE=44513], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}, ReplicationConfig: RATIS/ONE, State:ALLOCATED, leaderId:0c34be74-1f5b-4b04-a6d4-fde6c3deb89a, CreationTimestamp2021-10-05T13:23:50.477Z[Etc/UTC]] moved to OPEN state
2021-10-05 13:23:53,498 [pool-117-thread-1] INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(224)) - group-27B6D48B871B: The snapshot info is null. Setting the last applied indexto:(t:0, i:~)
2021-10-05 13:23:53,500 [pool-117-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.notification.no-leader.timeout = 300s (custom)
2021-10-05 13:23:53,501 [pool-117-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.use.memory = false (default)
2021-10-05 13:23:53,501 [pool-117-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.purge.gap = 1000000 (custom)
2021-10-05 13:23:53,501 [pool-117-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2021-10-05 13:23:53,503 [pool-117-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.segment.size.max = 1048576 (custom)
2021-10-05 13:23:53,504 [pool-117-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.segment.cache.num.max = 2 (custom)
2021-10-05 13:23:53,504 [pool-117-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.segment.cache.size.max = 200MB (=209715200) (default)
2021-10-05 13:23:53,504 [pool-117-thread-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:<init>(182)) - new 0c34be74-1f5b-4b04-a6d4-fde6c3deb89a@group-27B6D48B871B-SegmentedRaftLogWorker for RaftStorageImpl:Storage Directory /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-98f4f1fb-613f-4a4a-83a3-c748f4b4520d/datanode-1/data/ratis/a2e217e3-801c-4062-af76-27b6d48b871b
2021-10-05 13:23:53,504 [pool-117-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2021-10-05 13:23:53,504 [pool-117-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.queue.element-limit = 1024 (custom)
2021-10-05 13:23:53,504 [pool-117-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.segment.size.max = 1048576 (custom)
2021-10-05 13:23:53,504 [pool-117-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.preallocated.size = 16384 (custom)
2021-10-05 13:23:53,504 [pool-117-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.force.sync.num = 128 (default)
2021-10-05 13:23:53,504 [pool-117-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.statemachine.data.sync = true (default)
2021-10-05 13:23:53,504 [pool-117-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2021-10-05 13:23:53,504 [pool-117-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2021-10-05 13:23:53,507 [pool-117-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.write.buffer.size = 1048576 (custom)
2021-10-05 13:23:53,507 [pool-117-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2021-10-05 13:23:53,508 [pool-117-thread-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:lambda$new$0(133)) - 0c34be74-1f5b-4b04-a6d4-fde6c3deb89a@group-27B6D48B871B-SegmentedRaftLogWorker: flushIndex: setUnconditionally 0 -> -1
2021-10-05 13:23:53,508 [pool-117-thread-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:lambda$new$0(133)) - 0c34be74-1f5b-4b04-a6d4-fde6c3deb89a@group-27B6D48B871B-SegmentedRaftLogWorker: safeCacheEvictIndex: setUnconditionally 0 -> -1
2021-10-05 13:23:53,512 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  safemode.HealthyPipelineSafeModeRule (HealthyPipelineSafeModeRule.java:initializeRule(152)) - Refreshed total pipeline count is 0, healthy pipeline threshold count is 1
2021-10-05 13:23:53,513 [pool-117-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2021-10-05 13:23:53,525 [EventQueue-PipelineReportForPipelineReportHandler] INFO  ha.SCMHAInvocationHandler (SCMHAInvocationHandler.java:invokeRatis(113)) - Invoking method public abstract void org.apache.hadoop.hdds.scm.pipeline.PipelineStateManager.updatePipelineState(org.apache.hadoop.hdds.protocol.proto.HddsProtos$PipelineID,org.apache.hadoop.hdds.protocol.proto.HddsProtos$PipelineState) throws java.io.IOException on target org.apache.hadoop.hdds.scm.ha.SCMRatisServerImpl@6344f74b, cost 25184.569us
2021-10-05 13:23:53,526 [pool-117-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2021-10-05 13:23:53,526 [pool-117-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.snapshot.retention.file.num = 5 (custom)
2021-10-05 13:23:53,526 [pool-117-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.purge.upto.snapshot.index = false (default)
2021-10-05 13:23:53,526 [pool-117-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.retrycache.expirytime = 600000ms (custom)
2021-10-05 13:23:53,526 [pool-117-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.retrycache.statistics.expirytime = 100μs (default)
2021-10-05 13:23:53,527 [pool-117-thread-1] INFO  server.RaftServer$Division (RaftServerImpl.java:<init>(181)) - 0c34be74-1f5b-4b04-a6d4-fde6c3deb89a: new RaftServerImpl for group-52E96576A6DB:[0c34be74-1f5b-4b04-a6d4-fde6c3deb89a|rpc:127.0.0.1:33359|dataStream:|priority:0, f990c0ed-f7f2-4f8a-8ec9-db097d9c855e|rpc:127.0.0.1:44595|dataStream:|priority:0, a9b6c243-aad2-4cee-be19-871628539a81|rpc:127.0.0.1:36351|dataStream:|priority:1] with ContainerStateMachine:uninitialized
2021-10-05 13:23:53,528 [EventQueue-OpenPipelineForHealthyPipelineSafeModeRule] INFO  safemode.SCMSafeModeManager (HealthyPipelineSafeModeRule.java:process(124)) - SCM in safe mode. Healthy pipelines reported count is 0, required healthy pipeline reported count is 1
2021-10-05 13:23:53,528 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  safemode.HealthyPipelineSafeModeRule (HealthyPipelineSafeModeRule.java:initializeRule(152)) - Refreshed total pipeline count is 0, healthy pipeline threshold count is 1
2021-10-05 13:23:53,529 [pool-117-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.timeout.min = 5s (custom)
2021-10-05 13:23:53,529 [pool-117-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.timeout.max = 5200ms (custom)
2021-10-05 13:23:53,529 [pool-117-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.sleep.time = 25ms (default)
2021-10-05 13:23:53,529 [pool-117-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.slowness.timeout = 300s (custom)
2021-10-05 13:23:53,529 [pool-117-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.leaderelection.leader.step-down.wait-time = 10s (default)
2021-10-05 13:23:53,529 [pool-117-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.sleep.deviation.threshold = 300ms (default)
2021-10-05 13:23:53,529 [pool-117-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.appender.install.snapshot.enabled = false (custom)
2021-10-05 13:23:53,529 [pool-117-thread-1] INFO  server.RaftServer$Division (ServerState.java:<init>(105)) - 0c34be74-1f5b-4b04-a6d4-fde6c3deb89a@group-52E96576A6DB: ConfigurationManager, init=-1: [0c34be74-1f5b-4b04-a6d4-fde6c3deb89a|rpc:127.0.0.1:33359|dataStream:|priority:0, f990c0ed-f7f2-4f8a-8ec9-db097d9c855e|rpc:127.0.0.1:44595|dataStream:|priority:0, a9b6c243-aad2-4cee-be19-871628539a81|rpc:127.0.0.1:36351|dataStream:|priority:1], old=null, confs=<EMPTY_MAP>
2021-10-05 13:23:53,529 [pool-117-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.storage.dir = [/home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-98f4f1fb-613f-4a4a-83a3-c748f4b4520d/datanode-1/data/ratis] (custom)
2021-10-05 13:23:53,529 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  ha.SCMStateMachine (SCMStateMachine.java:takeSnapshot(290)) - Current Snapshot Index 20, takeSnapshot took 1 ms
2021-10-05 13:23:53,529 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:takeSnapshot(281)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater: Took a snapshot at index 20
2021-10-05 13:23:53,529 [pool-117-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.corruption.policy = EXCEPTION (default)
2021-10-05 13:23:53,529 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:lambda$new$0(89)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater: snapshotIndex: updateIncreasingly 15 -> 20
2021-10-05 13:23:53,529 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:purge(306)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-SegmentedRaftLog: purge 20
2021-10-05 13:23:53,529 [pool-117-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.storage.free-space.min = 0MB (=0) (default)
2021-10-05 13:23:53,529 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-SegmentedRaftLog: snapshotIndex: updateIncreasingly 15 -> 20
2021-10-05 13:23:53,529 [pool-117-thread-1] INFO  storage.RaftStorageDirectory (RaftStorageDirectoryImpl.java:analyzeStorage(135)) - The storage directory /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-98f4f1fb-613f-4a4a-83a3-c748f4b4520d/datanode-1/data/ratis/8c8a590d-1d11-430c-931a-52e96576a6db does not exist. Creating ...
2021-10-05 13:23:53,529 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-SegmentedRaftLog: purgeIndex: updateToMax old=15, new=20, updated? true
2021-10-05 13:23:53,530 [pool-117-thread-1] INFO  storage.RaftStorageDirectory (RaftStorageDirectoryImpl.java:tryLock(230)) - Lock on /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-98f4f1fb-613f-4a4a-83a3-c748f4b4520d/datanode-1/data/ratis/8c8a590d-1d11-430c-931a-52e96576a6db/in_use.lock acquired by nodename 17451@fv-az270-324
2021-10-05 13:23:53,532 [pool-117-thread-1] INFO  storage.RaftStorage (RaftStorageImpl.java:format(89)) - Storage directory /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-98f4f1fb-613f-4a4a-83a3-c748f4b4520d/datanode-1/data/ratis/8c8a590d-1d11-430c-931a-52e96576a6db has been successfully formatted.
2021-10-05 13:23:53,533 [pool-117-thread-1] INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(224)) - group-52E96576A6DB: The snapshot info is null. Setting the last applied indexto:(t:0, i:~)
2021-10-05 13:23:53,533 [pool-117-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.notification.no-leader.timeout = 300s (custom)
2021-10-05 13:23:53,533 [pool-117-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.use.memory = false (default)
2021-10-05 13:23:53,533 [pool-117-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.purge.gap = 1000000 (custom)
2021-10-05 13:23:53,533 [pool-117-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2021-10-05 13:23:53,534 [pool-117-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.segment.size.max = 1048576 (custom)
2021-10-05 13:23:53,536 [pool-117-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.segment.cache.num.max = 2 (custom)
2021-10-05 13:23:53,536 [pool-117-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.segment.cache.size.max = 200MB (=209715200) (default)
2021-10-05 13:23:53,536 [pool-117-thread-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:<init>(182)) - new 0c34be74-1f5b-4b04-a6d4-fde6c3deb89a@group-52E96576A6DB-SegmentedRaftLogWorker for RaftStorageImpl:Storage Directory /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-98f4f1fb-613f-4a4a-83a3-c748f4b4520d/datanode-1/data/ratis/8c8a590d-1d11-430c-931a-52e96576a6db
2021-10-05 13:23:53,536 [pool-117-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2021-10-05 13:23:53,536 [pool-117-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.queue.element-limit = 1024 (custom)
2021-10-05 13:23:53,537 [EventQueue-OpenPipelineForHealthyPipelineSafeModeRule] INFO  safemode.SCMSafeModeManager (HealthyPipelineSafeModeRule.java:process(124)) - SCM in safe mode. Healthy pipelines reported count is 0, required healthy pipeline reported count is 1
2021-10-05 13:23:53,537 [pool-117-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.segment.size.max = 1048576 (custom)
2021-10-05 13:23:53,537 [pool-117-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.preallocated.size = 16384 (custom)
2021-10-05 13:23:53,538 [EventQueue-OpenPipelineForHealthyPipelineSafeModeRule] INFO  safemode.SCMSafeModeManager (HealthyPipelineSafeModeRule.java:process(124)) - SCM in safe mode. Healthy pipelines reported count is 0, required healthy pipeline reported count is 1
2021-10-05 13:23:53,538 [pool-117-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.force.sync.num = 128 (default)
2021-10-05 13:23:53,538 [pool-117-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.statemachine.data.sync = true (default)
2021-10-05 13:23:53,538 [pool-117-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2021-10-05 13:23:53,538 [pool-117-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2021-10-05 13:23:53,538 [pool-117-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.write.buffer.size = 1048576 (custom)
2021-10-05 13:23:53,539 [pool-117-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2021-10-05 13:23:53,539 [pool-117-thread-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:lambda$new$0(133)) - 0c34be74-1f5b-4b04-a6d4-fde6c3deb89a@group-52E96576A6DB-SegmentedRaftLogWorker: flushIndex: setUnconditionally 0 -> -1
2021-10-05 13:23:53,539 [pool-117-thread-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:lambda$new$0(133)) - 0c34be74-1f5b-4b04-a6d4-fde6c3deb89a@group-52E96576A6DB-SegmentedRaftLogWorker: safeCacheEvictIndex: setUnconditionally 0 -> -1
2021-10-05 13:23:53,539 [pool-117-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2021-10-05 13:23:53,540 [pool-117-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2021-10-05 13:23:53,540 [pool-117-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.snapshot.retention.file.num = 5 (custom)
2021-10-05 13:23:53,540 [pool-117-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.purge.upto.snapshot.index = false (default)
2021-10-05 13:23:53,540 [pool-117-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.retrycache.expirytime = 600000ms (custom)
2021-10-05 13:23:53,540 [pool-117-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.retrycache.statistics.expirytime = 100μs (default)
2021-10-05 13:23:53,541 [pool-117-thread-1] INFO  server.RaftServer$Division (RaftServerImpl.java:start(296)) - 0c34be74-1f5b-4b04-a6d4-fde6c3deb89a@group-27B6D48B871B: start as a follower, conf=-1: [0c34be74-1f5b-4b04-a6d4-fde6c3deb89a|rpc:127.0.0.1:33359|priority:1], old=null
2021-10-05 13:23:53,541 [pool-117-thread-1] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(285)) - 0c34be74-1f5b-4b04-a6d4-fde6c3deb89a@group-27B6D48B871B: changes role from      null to FOLLOWER at term 0 for startAsFollower
2021-10-05 13:23:53,541 [pool-117-thread-1] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(130)) - 0c34be74-1f5b-4b04-a6d4-fde6c3deb89a: start 0c34be74-1f5b-4b04-a6d4-fde6c3deb89a@group-27B6D48B871B-FollowerState
2021-10-05 13:23:53,541 [pool-117-thread-1] INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-27B6D48B871B,id=0c34be74-1f5b-4b04-a6d4-fde6c3deb89a
2021-10-05 13:23:53,542 [pool-117-thread-1] INFO  server.RaftServer$Division (RaftServerImpl.java:start(296)) - 0c34be74-1f5b-4b04-a6d4-fde6c3deb89a@group-52E96576A6DB: start as a follower, conf=-1: [0c34be74-1f5b-4b04-a6d4-fde6c3deb89a|rpc:127.0.0.1:33359|dataStream:|priority:0, f990c0ed-f7f2-4f8a-8ec9-db097d9c855e|rpc:127.0.0.1:44595|dataStream:|priority:0, a9b6c243-aad2-4cee-be19-871628539a81|rpc:127.0.0.1:36351|dataStream:|priority:1], old=null
2021-10-05 13:23:53,542 [pool-117-thread-1] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(285)) - 0c34be74-1f5b-4b04-a6d4-fde6c3deb89a@group-52E96576A6DB: changes role from      null to FOLLOWER at term 0 for startAsFollower
2021-10-05 13:23:53,542 [pool-117-thread-1] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(130)) - 0c34be74-1f5b-4b04-a6d4-fde6c3deb89a: start 0c34be74-1f5b-4b04-a6d4-fde6c3deb89a@group-52E96576A6DB-FollowerState
2021-10-05 13:23:53,542 [Command processor thread] INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:addGroup(763)) - Created group PipelineID=a2e217e3-801c-4062-af76-27b6d48b871b
2021-10-05 13:23:53,547 [pool-117-thread-1] INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-52E96576A6DB,id=0c34be74-1f5b-4b04-a6d4-fde6c3deb89a
2021-10-05 13:23:53,542 [Command processor thread] INFO  commandhandler.CreatePipelineCommandHandler (CreatePipelineCommandHandler.java:handle(106)) - Created Pipeline RATIS ONE PipelineID=a2e217e3-801c-4062-af76-27b6d48b871b.
2021-10-05 13:23:53,550 [Command processor thread] INFO  server.RaftServer (RaftServerProxy.java:addNew(95)) - 0c34be74-1f5b-4b04-a6d4-fde6c3deb89a: addNew group-D8E46993F0F1:[0c34be74-1f5b-4b04-a6d4-fde6c3deb89a|rpc:127.0.0.1:33359|priority:0, f990c0ed-f7f2-4f8a-8ec9-db097d9c855e|rpc:127.0.0.1:44595|priority:1, a9b6c243-aad2-4cee-be19-871628539a81|rpc:127.0.0.1:36351|priority:0] returns group-D8E46993F0F1:java.util.concurrent.CompletableFuture@5da8b487[Not completed]
2021-10-05 13:23:53,551 [pool-117-thread-1] INFO  server.RaftServer$Division (RaftServerImpl.java:<init>(181)) - 0c34be74-1f5b-4b04-a6d4-fde6c3deb89a: new RaftServerImpl for group-D8E46993F0F1:[0c34be74-1f5b-4b04-a6d4-fde6c3deb89a|rpc:127.0.0.1:33359|priority:0, f990c0ed-f7f2-4f8a-8ec9-db097d9c855e|rpc:127.0.0.1:44595|priority:1, a9b6c243-aad2-4cee-be19-871628539a81|rpc:127.0.0.1:36351|priority:0] with ContainerStateMachine:uninitialized
2021-10-05 13:23:53,551 [pool-117-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.timeout.min = 5s (custom)
2021-10-05 13:23:53,551 [pool-117-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.timeout.max = 5200ms (custom)
2021-10-05 13:23:53,551 [pool-117-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.sleep.time = 25ms (default)
2021-10-05 13:23:53,551 [pool-117-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.slowness.timeout = 300s (custom)
2021-10-05 13:23:53,551 [pool-117-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.leaderelection.leader.step-down.wait-time = 10s (default)
2021-10-05 13:23:53,551 [pool-117-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.sleep.deviation.threshold = 300ms (default)
2021-10-05 13:23:53,551 [pool-117-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.appender.install.snapshot.enabled = false (custom)
2021-10-05 13:23:53,551 [pool-117-thread-1] INFO  server.RaftServer$Division (ServerState.java:<init>(105)) - 0c34be74-1f5b-4b04-a6d4-fde6c3deb89a@group-D8E46993F0F1: ConfigurationManager, init=-1: [0c34be74-1f5b-4b04-a6d4-fde6c3deb89a|rpc:127.0.0.1:33359|priority:0, f990c0ed-f7f2-4f8a-8ec9-db097d9c855e|rpc:127.0.0.1:44595|priority:1, a9b6c243-aad2-4cee-be19-871628539a81|rpc:127.0.0.1:36351|priority:0], old=null, confs=<EMPTY_MAP>
2021-10-05 13:23:53,551 [pool-117-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.storage.dir = [/home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-98f4f1fb-613f-4a4a-83a3-c748f4b4520d/datanode-1/data/ratis] (custom)
2021-10-05 13:23:53,551 [pool-117-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.corruption.policy = EXCEPTION (default)
2021-10-05 13:23:53,552 [pool-117-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.storage.free-space.min = 0MB (=0) (default)
2021-10-05 13:23:53,552 [pool-117-thread-1] INFO  storage.RaftStorageDirectory (RaftStorageDirectoryImpl.java:analyzeStorage(135)) - The storage directory /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-98f4f1fb-613f-4a4a-83a3-c748f4b4520d/datanode-1/data/ratis/90899f2e-5ed2-48cb-9677-d8e46993f0f1 does not exist. Creating ...
2021-10-05 13:23:53,553 [pool-117-thread-1] INFO  storage.RaftStorageDirectory (RaftStorageDirectoryImpl.java:tryLock(230)) - Lock on /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-98f4f1fb-613f-4a4a-83a3-c748f4b4520d/datanode-1/data/ratis/90899f2e-5ed2-48cb-9677-d8e46993f0f1/in_use.lock acquired by nodename 17451@fv-az270-324
2021-10-05 13:23:53,554 [pool-117-thread-1] INFO  storage.RaftStorage (RaftStorageImpl.java:format(89)) - Storage directory /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-98f4f1fb-613f-4a4a-83a3-c748f4b4520d/datanode-1/data/ratis/90899f2e-5ed2-48cb-9677-d8e46993f0f1 has been successfully formatted.
2021-10-05 13:23:53,554 [pool-117-thread-1] INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(224)) - group-D8E46993F0F1: The snapshot info is null. Setting the last applied indexto:(t:0, i:~)
2021-10-05 13:23:53,554 [pool-117-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.notification.no-leader.timeout = 300s (custom)
2021-10-05 13:23:53,554 [pool-117-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.use.memory = false (default)
2021-10-05 13:23:53,554 [pool-117-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.purge.gap = 1000000 (custom)
2021-10-05 13:23:53,554 [pool-117-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2021-10-05 13:23:53,555 [pool-117-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.segment.size.max = 1048576 (custom)
2021-10-05 13:23:53,555 [pool-117-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.segment.cache.num.max = 2 (custom)
2021-10-05 13:23:53,555 [pool-117-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.segment.cache.size.max = 200MB (=209715200) (default)
2021-10-05 13:23:53,555 [pool-117-thread-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:<init>(182)) - new 0c34be74-1f5b-4b04-a6d4-fde6c3deb89a@group-D8E46993F0F1-SegmentedRaftLogWorker for RaftStorageImpl:Storage Directory /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-98f4f1fb-613f-4a4a-83a3-c748f4b4520d/datanode-1/data/ratis/90899f2e-5ed2-48cb-9677-d8e46993f0f1
2021-10-05 13:23:53,555 [pool-117-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2021-10-05 13:23:53,555 [pool-117-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.queue.element-limit = 1024 (custom)
2021-10-05 13:23:53,555 [pool-117-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.segment.size.max = 1048576 (custom)
2021-10-05 13:23:53,555 [pool-117-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.preallocated.size = 16384 (custom)
2021-10-05 13:23:53,555 [pool-117-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.force.sync.num = 128 (default)
2021-10-05 13:23:53,555 [pool-117-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.statemachine.data.sync = true (default)
2021-10-05 13:23:53,555 [pool-117-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2021-10-05 13:23:53,555 [pool-117-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2021-10-05 13:23:53,556 [pool-117-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.write.buffer.size = 1048576 (custom)
2021-10-05 13:23:53,557 [pool-117-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2021-10-05 13:23:53,557 [pool-117-thread-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:lambda$new$0(133)) - 0c34be74-1f5b-4b04-a6d4-fde6c3deb89a@group-D8E46993F0F1-SegmentedRaftLogWorker: flushIndex: setUnconditionally 0 -> -1
2021-10-05 13:23:53,557 [pool-117-thread-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:lambda$new$0(133)) - 0c34be74-1f5b-4b04-a6d4-fde6c3deb89a@group-D8E46993F0F1-SegmentedRaftLogWorker: safeCacheEvictIndex: setUnconditionally 0 -> -1
2021-10-05 13:23:53,557 [pool-117-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2021-10-05 13:23:53,557 [pool-117-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2021-10-05 13:23:53,557 [pool-117-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.snapshot.retention.file.num = 5 (custom)
2021-10-05 13:23:53,557 [pool-117-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.purge.upto.snapshot.index = false (default)
2021-10-05 13:23:53,558 [pool-117-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.retrycache.expirytime = 600000ms (custom)
2021-10-05 13:23:53,558 [pool-117-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.retrycache.statistics.expirytime = 100μs (default)
2021-10-05 13:23:53,559 [pool-117-thread-1] INFO  server.RaftServer$Division (RaftServerImpl.java:start(296)) - 0c34be74-1f5b-4b04-a6d4-fde6c3deb89a@group-D8E46993F0F1: start as a follower, conf=-1: [0c34be74-1f5b-4b04-a6d4-fde6c3deb89a|rpc:127.0.0.1:33359|priority:0, f990c0ed-f7f2-4f8a-8ec9-db097d9c855e|rpc:127.0.0.1:44595|priority:1, a9b6c243-aad2-4cee-be19-871628539a81|rpc:127.0.0.1:36351|priority:0], old=null
2021-10-05 13:23:53,559 [pool-117-thread-1] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(285)) - 0c34be74-1f5b-4b04-a6d4-fde6c3deb89a@group-D8E46993F0F1: changes role from      null to FOLLOWER at term 0 for startAsFollower
2021-10-05 13:23:53,559 [pool-117-thread-1] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(130)) - 0c34be74-1f5b-4b04-a6d4-fde6c3deb89a: start 0c34be74-1f5b-4b04-a6d4-fde6c3deb89a@group-D8E46993F0F1-FollowerState
2021-10-05 13:23:53,559 [pool-117-thread-1] INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-D8E46993F0F1,id=0c34be74-1f5b-4b04-a6d4-fde6c3deb89a
2021-10-05 13:23:53,560 [Command processor thread] INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:addGroup(763)) - Created group PipelineID=90899f2e-5ed2-48cb-9677-d8e46993f0f1
2021-10-05 13:23:53,572 [grpc-default-executor-0] INFO  server.RaftServer (RaftServerProxy.java:addNew(95)) - f990c0ed-f7f2-4f8a-8ec9-db097d9c855e: addNew group-D8E46993F0F1:[0c34be74-1f5b-4b04-a6d4-fde6c3deb89a|rpc:127.0.0.1:33359|dataStream:|priority:0, f990c0ed-f7f2-4f8a-8ec9-db097d9c855e|rpc:127.0.0.1:44595|dataStream:|priority:1, a9b6c243-aad2-4cee-be19-871628539a81|rpc:127.0.0.1:36351|dataStream:|priority:0] returns group-D8E46993F0F1:java.util.concurrent.CompletableFuture@7d5b3071[Not completed]
2021-10-05 13:23:53,573 [pool-96-thread-1] INFO  server.RaftServer$Division (RaftServerImpl.java:<init>(181)) - f990c0ed-f7f2-4f8a-8ec9-db097d9c855e: new RaftServerImpl for group-D8E46993F0F1:[0c34be74-1f5b-4b04-a6d4-fde6c3deb89a|rpc:127.0.0.1:33359|dataStream:|priority:0, f990c0ed-f7f2-4f8a-8ec9-db097d9c855e|rpc:127.0.0.1:44595|dataStream:|priority:1, a9b6c243-aad2-4cee-be19-871628539a81|rpc:127.0.0.1:36351|dataStream:|priority:0] with ContainerStateMachine:uninitialized
2021-10-05 13:23:53,573 [pool-96-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.timeout.min = 5s (custom)
2021-10-05 13:23:53,573 [pool-96-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.timeout.max = 5200ms (custom)
2021-10-05 13:23:53,573 [pool-96-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.sleep.time = 25ms (default)
2021-10-05 13:23:53,573 [pool-96-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.slowness.timeout = 300s (custom)
2021-10-05 13:23:53,573 [pool-96-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.leaderelection.leader.step-down.wait-time = 10s (default)
2021-10-05 13:23:53,573 [pool-96-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.sleep.deviation.threshold = 300ms (default)
2021-10-05 13:23:53,573 [pool-96-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.appender.install.snapshot.enabled = false (custom)
2021-10-05 13:23:53,573 [pool-96-thread-1] INFO  server.RaftServer$Division (ServerState.java:<init>(105)) - f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-D8E46993F0F1: ConfigurationManager, init=-1: [0c34be74-1f5b-4b04-a6d4-fde6c3deb89a|rpc:127.0.0.1:33359|dataStream:|priority:0, f990c0ed-f7f2-4f8a-8ec9-db097d9c855e|rpc:127.0.0.1:44595|dataStream:|priority:1, a9b6c243-aad2-4cee-be19-871628539a81|rpc:127.0.0.1:36351|dataStream:|priority:0], old=null, confs=<EMPTY_MAP>
2021-10-05 13:23:53,573 [pool-96-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.storage.dir = [/home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-98f4f1fb-613f-4a4a-83a3-c748f4b4520d/datanode-0/data/ratis] (custom)
2021-10-05 13:23:53,573 [pool-96-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.corruption.policy = EXCEPTION (default)
2021-10-05 13:23:53,573 [pool-96-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.storage.free-space.min = 0MB (=0) (default)
2021-10-05 13:23:53,573 [pool-96-thread-1] INFO  storage.RaftStorageDirectory (RaftStorageDirectoryImpl.java:analyzeStorage(135)) - The storage directory /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-98f4f1fb-613f-4a4a-83a3-c748f4b4520d/datanode-0/data/ratis/90899f2e-5ed2-48cb-9677-d8e46993f0f1 does not exist. Creating ...
2021-10-05 13:23:53,576 [pool-96-thread-1] INFO  storage.RaftStorageDirectory (RaftStorageDirectoryImpl.java:tryLock(230)) - Lock on /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-98f4f1fb-613f-4a4a-83a3-c748f4b4520d/datanode-0/data/ratis/90899f2e-5ed2-48cb-9677-d8e46993f0f1/in_use.lock acquired by nodename 17451@fv-az270-324
2021-10-05 13:23:53,578 [pool-96-thread-1] INFO  storage.RaftStorage (RaftStorageImpl.java:format(89)) - Storage directory /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-98f4f1fb-613f-4a4a-83a3-c748f4b4520d/datanode-0/data/ratis/90899f2e-5ed2-48cb-9677-d8e46993f0f1 has been successfully formatted.
2021-10-05 13:23:53,578 [pool-96-thread-1] INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(224)) - group-D8E46993F0F1: The snapshot info is null. Setting the last applied indexto:(t:0, i:~)
2021-10-05 13:23:53,578 [pool-96-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.notification.no-leader.timeout = 300s (custom)
2021-10-05 13:23:53,578 [pool-96-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.use.memory = false (default)
2021-10-05 13:23:53,578 [pool-96-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.purge.gap = 1000000 (custom)
2021-10-05 13:23:53,578 [pool-96-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2021-10-05 13:23:53,579 [pool-96-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.segment.size.max = 1048576 (custom)
2021-10-05 13:23:53,579 [pool-96-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.segment.cache.num.max = 2 (custom)
2021-10-05 13:23:53,579 [pool-96-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.segment.cache.size.max = 200MB (=209715200) (default)
2021-10-05 13:23:53,579 [pool-96-thread-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:<init>(182)) - new f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-D8E46993F0F1-SegmentedRaftLogWorker for RaftStorageImpl:Storage Directory /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-98f4f1fb-613f-4a4a-83a3-c748f4b4520d/datanode-0/data/ratis/90899f2e-5ed2-48cb-9677-d8e46993f0f1
2021-10-05 13:23:53,579 [pool-96-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2021-10-05 13:23:53,579 [pool-96-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.queue.element-limit = 1024 (custom)
2021-10-05 13:23:53,579 [pool-96-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.segment.size.max = 1048576 (custom)
2021-10-05 13:23:53,579 [pool-96-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.preallocated.size = 16384 (custom)
2021-10-05 13:23:53,579 [pool-96-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.force.sync.num = 128 (default)
2021-10-05 13:23:53,579 [pool-96-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.statemachine.data.sync = true (default)
2021-10-05 13:23:53,579 [pool-96-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2021-10-05 13:23:53,579 [pool-96-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2021-10-05 13:23:53,580 [pool-96-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.write.buffer.size = 1048576 (custom)
2021-10-05 13:23:53,581 [pool-96-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2021-10-05 13:23:53,581 [pool-96-thread-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:lambda$new$0(133)) - f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-D8E46993F0F1-SegmentedRaftLogWorker: flushIndex: setUnconditionally 0 -> -1
2021-10-05 13:23:53,581 [pool-96-thread-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:lambda$new$0(133)) - f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-D8E46993F0F1-SegmentedRaftLogWorker: safeCacheEvictIndex: setUnconditionally 0 -> -1
2021-10-05 13:23:53,587 [pool-96-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2021-10-05 13:23:53,587 [pool-96-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2021-10-05 13:23:53,587 [pool-96-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.snapshot.retention.file.num = 5 (custom)
2021-10-05 13:23:53,587 [pool-96-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.purge.upto.snapshot.index = false (default)
2021-10-05 13:23:53,587 [pool-96-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.retrycache.expirytime = 600000ms (custom)
2021-10-05 13:23:53,587 [pool-96-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.retrycache.statistics.expirytime = 100μs (default)
2021-10-05 13:23:53,588 [pool-96-thread-1] INFO  server.RaftServer$Division (RaftServerImpl.java:start(296)) - f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-D8E46993F0F1: start as a follower, conf=-1: [0c34be74-1f5b-4b04-a6d4-fde6c3deb89a|rpc:127.0.0.1:33359|dataStream:|priority:0, f990c0ed-f7f2-4f8a-8ec9-db097d9c855e|rpc:127.0.0.1:44595|dataStream:|priority:1, a9b6c243-aad2-4cee-be19-871628539a81|rpc:127.0.0.1:36351|dataStream:|priority:0], old=null
2021-10-05 13:23:53,589 [pool-96-thread-1] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(285)) - f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-D8E46993F0F1: changes role from      null to FOLLOWER at term 0 for startAsFollower
2021-10-05 13:23:53,589 [pool-96-thread-1] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(130)) - f990c0ed-f7f2-4f8a-8ec9-db097d9c855e: start f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-D8E46993F0F1-FollowerState
2021-10-05 13:23:53,589 [pool-96-thread-1] INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-D8E46993F0F1,id=f990c0ed-f7f2-4f8a-8ec9-db097d9c855e
2021-10-05 13:23:53,635 [grpc-default-executor-0] INFO  server.RaftServer (RaftServerProxy.java:addNew(95)) - a9b6c243-aad2-4cee-be19-871628539a81: addNew group-52E96576A6DB:[0c34be74-1f5b-4b04-a6d4-fde6c3deb89a|rpc:127.0.0.1:33359|dataStream:|priority:0, f990c0ed-f7f2-4f8a-8ec9-db097d9c855e|rpc:127.0.0.1:44595|dataStream:|priority:0, a9b6c243-aad2-4cee-be19-871628539a81|rpc:127.0.0.1:36351|dataStream:|priority:1] returns group-52E96576A6DB:java.util.concurrent.CompletableFuture@5dc8414[Not completed]
2021-10-05 13:23:53,640 [pool-138-thread-1] INFO  server.RaftServer$Division (RaftServerImpl.java:<init>(181)) - a9b6c243-aad2-4cee-be19-871628539a81: new RaftServerImpl for group-52E96576A6DB:[0c34be74-1f5b-4b04-a6d4-fde6c3deb89a|rpc:127.0.0.1:33359|dataStream:|priority:0, f990c0ed-f7f2-4f8a-8ec9-db097d9c855e|rpc:127.0.0.1:44595|dataStream:|priority:0, a9b6c243-aad2-4cee-be19-871628539a81|rpc:127.0.0.1:36351|dataStream:|priority:1] with ContainerStateMachine:uninitialized
2021-10-05 13:23:53,641 [pool-138-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.timeout.min = 5s (custom)
2021-10-05 13:23:53,641 [pool-138-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.timeout.max = 5200ms (custom)
2021-10-05 13:23:53,641 [pool-138-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.sleep.time = 25ms (default)
2021-10-05 13:23:53,641 [pool-138-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.slowness.timeout = 300s (custom)
2021-10-05 13:23:53,641 [pool-138-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.leaderelection.leader.step-down.wait-time = 10s (default)
2021-10-05 13:23:53,641 [pool-138-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.sleep.deviation.threshold = 300ms (default)
2021-10-05 13:23:53,641 [pool-138-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.appender.install.snapshot.enabled = false (custom)
2021-10-05 13:23:53,641 [pool-138-thread-1] INFO  server.RaftServer$Division (ServerState.java:<init>(105)) - a9b6c243-aad2-4cee-be19-871628539a81@group-52E96576A6DB: ConfigurationManager, init=-1: [0c34be74-1f5b-4b04-a6d4-fde6c3deb89a|rpc:127.0.0.1:33359|dataStream:|priority:0, f990c0ed-f7f2-4f8a-8ec9-db097d9c855e|rpc:127.0.0.1:44595|dataStream:|priority:0, a9b6c243-aad2-4cee-be19-871628539a81|rpc:127.0.0.1:36351|dataStream:|priority:1], old=null, confs=<EMPTY_MAP>
2021-10-05 13:23:53,643 [pool-138-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.storage.dir = [/home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-98f4f1fb-613f-4a4a-83a3-c748f4b4520d/datanode-2/data/ratis] (custom)
2021-10-05 13:23:53,644 [pool-138-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.corruption.policy = EXCEPTION (default)
2021-10-05 13:23:53,644 [pool-138-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.storage.free-space.min = 0MB (=0) (default)
2021-10-05 13:23:53,644 [pool-138-thread-1] INFO  storage.RaftStorageDirectory (RaftStorageDirectoryImpl.java:analyzeStorage(135)) - The storage directory /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-98f4f1fb-613f-4a4a-83a3-c748f4b4520d/datanode-2/data/ratis/8c8a590d-1d11-430c-931a-52e96576a6db does not exist. Creating ...
2021-10-05 13:23:53,645 [grpc-default-executor-0] INFO  server.RaftServer (RaftServerProxy.java:addNew(95)) - a9b6c243-aad2-4cee-be19-871628539a81: addNew group-D8E46993F0F1:[0c34be74-1f5b-4b04-a6d4-fde6c3deb89a|rpc:127.0.0.1:33359|dataStream:|priority:0, f990c0ed-f7f2-4f8a-8ec9-db097d9c855e|rpc:127.0.0.1:44595|dataStream:|priority:1, a9b6c243-aad2-4cee-be19-871628539a81|rpc:127.0.0.1:36351|dataStream:|priority:0] returns group-D8E46993F0F1:java.util.concurrent.CompletableFuture@720b9644[Not completed]
2021-10-05 13:23:53,646 [pool-138-thread-1] INFO  storage.RaftStorageDirectory (RaftStorageDirectoryImpl.java:tryLock(230)) - Lock on /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-98f4f1fb-613f-4a4a-83a3-c748f4b4520d/datanode-2/data/ratis/8c8a590d-1d11-430c-931a-52e96576a6db/in_use.lock acquired by nodename 17451@fv-az270-324
2021-10-05 13:23:53,647 [pool-138-thread-1] INFO  storage.RaftStorage (RaftStorageImpl.java:format(89)) - Storage directory /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-98f4f1fb-613f-4a4a-83a3-c748f4b4520d/datanode-2/data/ratis/8c8a590d-1d11-430c-931a-52e96576a6db has been successfully formatted.
2021-10-05 13:23:53,648 [pool-138-thread-1] INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(224)) - group-52E96576A6DB: The snapshot info is null. Setting the last applied indexto:(t:0, i:~)
2021-10-05 13:23:53,650 [pool-138-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.notification.no-leader.timeout = 300s (custom)
2021-10-05 13:23:53,650 [pool-138-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.use.memory = false (default)
2021-10-05 13:23:53,650 [pool-138-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.purge.gap = 1000000 (custom)
2021-10-05 13:23:53,650 [pool-138-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2021-10-05 13:23:53,651 [pool-138-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.segment.size.max = 1048576 (custom)
2021-10-05 13:23:53,651 [pool-138-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.segment.cache.num.max = 2 (custom)
2021-10-05 13:23:53,651 [pool-138-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.segment.cache.size.max = 200MB (=209715200) (default)
2021-10-05 13:23:53,651 [pool-138-thread-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:<init>(182)) - new a9b6c243-aad2-4cee-be19-871628539a81@group-52E96576A6DB-SegmentedRaftLogWorker for RaftStorageImpl:Storage Directory /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-98f4f1fb-613f-4a4a-83a3-c748f4b4520d/datanode-2/data/ratis/8c8a590d-1d11-430c-931a-52e96576a6db
2021-10-05 13:23:53,651 [pool-138-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2021-10-05 13:23:53,651 [pool-138-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.queue.element-limit = 1024 (custom)
2021-10-05 13:23:53,651 [pool-138-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.segment.size.max = 1048576 (custom)
2021-10-05 13:23:53,651 [pool-138-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.preallocated.size = 16384 (custom)
2021-10-05 13:23:53,651 [pool-138-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.force.sync.num = 128 (default)
2021-10-05 13:23:53,651 [pool-138-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.statemachine.data.sync = true (default)
2021-10-05 13:23:53,651 [pool-138-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2021-10-05 13:23:53,652 [pool-138-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2021-10-05 13:23:53,652 [pool-138-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.write.buffer.size = 1048576 (custom)
2021-10-05 13:23:53,653 [pool-138-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2021-10-05 13:23:53,653 [pool-138-thread-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:lambda$new$0(133)) - a9b6c243-aad2-4cee-be19-871628539a81@group-52E96576A6DB-SegmentedRaftLogWorker: flushIndex: setUnconditionally 0 -> -1
2021-10-05 13:23:53,653 [pool-138-thread-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:lambda$new$0(133)) - a9b6c243-aad2-4cee-be19-871628539a81@group-52E96576A6DB-SegmentedRaftLogWorker: safeCacheEvictIndex: setUnconditionally 0 -> -1
2021-10-05 13:23:53,653 [pool-138-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2021-10-05 13:23:53,653 [pool-138-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2021-10-05 13:23:53,653 [pool-138-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.snapshot.retention.file.num = 5 (custom)
2021-10-05 13:23:53,653 [pool-138-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.purge.upto.snapshot.index = false (default)
2021-10-05 13:23:53,653 [pool-138-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.retrycache.expirytime = 600000ms (custom)
2021-10-05 13:23:53,654 [pool-138-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.retrycache.statistics.expirytime = 100μs (default)
2021-10-05 13:23:53,656 [pool-138-thread-1] INFO  server.RaftServer$Division (RaftServerImpl.java:<init>(181)) - a9b6c243-aad2-4cee-be19-871628539a81: new RaftServerImpl for group-D8E46993F0F1:[0c34be74-1f5b-4b04-a6d4-fde6c3deb89a|rpc:127.0.0.1:33359|dataStream:|priority:0, f990c0ed-f7f2-4f8a-8ec9-db097d9c855e|rpc:127.0.0.1:44595|dataStream:|priority:1, a9b6c243-aad2-4cee-be19-871628539a81|rpc:127.0.0.1:36351|dataStream:|priority:0] with ContainerStateMachine:uninitialized
2021-10-05 13:23:53,656 [pool-138-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.timeout.min = 5s (custom)
2021-10-05 13:23:53,656 [pool-138-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.timeout.max = 5200ms (custom)
2021-10-05 13:23:53,656 [pool-138-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.sleep.time = 25ms (default)
2021-10-05 13:23:53,656 [pool-138-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.slowness.timeout = 300s (custom)
2021-10-05 13:23:53,656 [pool-138-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.leaderelection.leader.step-down.wait-time = 10s (default)
2021-10-05 13:23:53,656 [pool-138-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.sleep.deviation.threshold = 300ms (default)
2021-10-05 13:23:53,656 [pool-138-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.appender.install.snapshot.enabled = false (custom)
2021-10-05 13:23:53,656 [pool-138-thread-1] INFO  server.RaftServer$Division (ServerState.java:<init>(105)) - a9b6c243-aad2-4cee-be19-871628539a81@group-D8E46993F0F1: ConfigurationManager, init=-1: [0c34be74-1f5b-4b04-a6d4-fde6c3deb89a|rpc:127.0.0.1:33359|dataStream:|priority:0, f990c0ed-f7f2-4f8a-8ec9-db097d9c855e|rpc:127.0.0.1:44595|dataStream:|priority:1, a9b6c243-aad2-4cee-be19-871628539a81|rpc:127.0.0.1:36351|dataStream:|priority:0], old=null, confs=<EMPTY_MAP>
2021-10-05 13:23:53,656 [pool-138-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.storage.dir = [/home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-98f4f1fb-613f-4a4a-83a3-c748f4b4520d/datanode-2/data/ratis] (custom)
2021-10-05 13:23:53,656 [pool-138-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.corruption.policy = EXCEPTION (default)
2021-10-05 13:23:53,656 [pool-138-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.storage.free-space.min = 0MB (=0) (default)
2021-10-05 13:23:53,656 [pool-138-thread-1] INFO  storage.RaftStorageDirectory (RaftStorageDirectoryImpl.java:analyzeStorage(135)) - The storage directory /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-98f4f1fb-613f-4a4a-83a3-c748f4b4520d/datanode-2/data/ratis/90899f2e-5ed2-48cb-9677-d8e46993f0f1 does not exist. Creating ...
2021-10-05 13:23:53,657 [pool-138-thread-1] INFO  storage.RaftStorageDirectory (RaftStorageDirectoryImpl.java:tryLock(230)) - Lock on /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-98f4f1fb-613f-4a4a-83a3-c748f4b4520d/datanode-2/data/ratis/90899f2e-5ed2-48cb-9677-d8e46993f0f1/in_use.lock acquired by nodename 17451@fv-az270-324
2021-10-05 13:23:53,658 [pool-138-thread-1] INFO  storage.RaftStorage (RaftStorageImpl.java:format(89)) - Storage directory /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-98f4f1fb-613f-4a4a-83a3-c748f4b4520d/datanode-2/data/ratis/90899f2e-5ed2-48cb-9677-d8e46993f0f1 has been successfully formatted.
2021-10-05 13:23:53,659 [pool-138-thread-1] INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(224)) - group-D8E46993F0F1: The snapshot info is null. Setting the last applied indexto:(t:0, i:~)
2021-10-05 13:23:53,659 [pool-138-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.notification.no-leader.timeout = 300s (custom)
2021-10-05 13:23:53,659 [pool-138-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.use.memory = false (default)
2021-10-05 13:23:53,659 [pool-138-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.purge.gap = 1000000 (custom)
2021-10-05 13:23:53,659 [pool-138-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2021-10-05 13:23:53,661 [pool-138-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.segment.size.max = 1048576 (custom)
2021-10-05 13:23:53,661 [pool-138-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.segment.cache.num.max = 2 (custom)
2021-10-05 13:23:53,662 [pool-138-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.segment.cache.size.max = 200MB (=209715200) (default)
2021-10-05 13:23:53,662 [pool-138-thread-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:<init>(182)) - new a9b6c243-aad2-4cee-be19-871628539a81@group-D8E46993F0F1-SegmentedRaftLogWorker for RaftStorageImpl:Storage Directory /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-98f4f1fb-613f-4a4a-83a3-c748f4b4520d/datanode-2/data/ratis/90899f2e-5ed2-48cb-9677-d8e46993f0f1
2021-10-05 13:23:53,662 [pool-138-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2021-10-05 13:23:53,662 [pool-138-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.queue.element-limit = 1024 (custom)
2021-10-05 13:23:53,662 [pool-138-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.segment.size.max = 1048576 (custom)
2021-10-05 13:23:53,662 [pool-138-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.preallocated.size = 16384 (custom)
2021-10-05 13:23:53,662 [pool-138-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.force.sync.num = 128 (default)
2021-10-05 13:23:53,662 [pool-138-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.statemachine.data.sync = true (default)
2021-10-05 13:23:53,662 [pool-138-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2021-10-05 13:23:53,662 [pool-138-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2021-10-05 13:23:53,663 [pool-138-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.write.buffer.size = 1048576 (custom)
2021-10-05 13:23:53,663 [pool-138-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2021-10-05 13:23:53,664 [pool-138-thread-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:lambda$new$0(133)) - a9b6c243-aad2-4cee-be19-871628539a81@group-D8E46993F0F1-SegmentedRaftLogWorker: flushIndex: setUnconditionally 0 -> -1
2021-10-05 13:23:53,664 [pool-138-thread-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:lambda$new$0(133)) - a9b6c243-aad2-4cee-be19-871628539a81@group-D8E46993F0F1-SegmentedRaftLogWorker: safeCacheEvictIndex: setUnconditionally 0 -> -1
2021-10-05 13:23:53,664 [pool-138-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2021-10-05 13:23:53,664 [pool-138-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2021-10-05 13:23:53,664 [pool-138-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.snapshot.retention.file.num = 5 (custom)
2021-10-05 13:23:53,664 [pool-138-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.purge.upto.snapshot.index = false (default)
2021-10-05 13:23:53,664 [pool-138-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.retrycache.expirytime = 600000ms (custom)
2021-10-05 13:23:53,664 [pool-138-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.retrycache.statistics.expirytime = 100μs (default)
2021-10-05 13:23:53,665 [pool-138-thread-1] INFO  server.RaftServer$Division (RaftServerImpl.java:start(296)) - a9b6c243-aad2-4cee-be19-871628539a81@group-52E96576A6DB: start as a follower, conf=-1: [0c34be74-1f5b-4b04-a6d4-fde6c3deb89a|rpc:127.0.0.1:33359|dataStream:|priority:0, f990c0ed-f7f2-4f8a-8ec9-db097d9c855e|rpc:127.0.0.1:44595|dataStream:|priority:0, a9b6c243-aad2-4cee-be19-871628539a81|rpc:127.0.0.1:36351|dataStream:|priority:1], old=null
2021-10-05 13:23:53,665 [pool-138-thread-1] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(285)) - a9b6c243-aad2-4cee-be19-871628539a81@group-52E96576A6DB: changes role from      null to FOLLOWER at term 0 for startAsFollower
2021-10-05 13:23:53,665 [pool-138-thread-1] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(130)) - a9b6c243-aad2-4cee-be19-871628539a81: start a9b6c243-aad2-4cee-be19-871628539a81@group-52E96576A6DB-FollowerState
2021-10-05 13:23:53,667 [pool-138-thread-1] INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-52E96576A6DB,id=a9b6c243-aad2-4cee-be19-871628539a81
2021-10-05 13:23:53,670 [pool-138-thread-1] INFO  server.RaftServer$Division (RaftServerImpl.java:start(296)) - a9b6c243-aad2-4cee-be19-871628539a81@group-D8E46993F0F1: start as a follower, conf=-1: [0c34be74-1f5b-4b04-a6d4-fde6c3deb89a|rpc:127.0.0.1:33359|dataStream:|priority:0, f990c0ed-f7f2-4f8a-8ec9-db097d9c855e|rpc:127.0.0.1:44595|dataStream:|priority:1, a9b6c243-aad2-4cee-be19-871628539a81|rpc:127.0.0.1:36351|dataStream:|priority:0], old=null
2021-10-05 13:23:53,670 [pool-138-thread-1] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(285)) - a9b6c243-aad2-4cee-be19-871628539a81@group-D8E46993F0F1: changes role from      null to FOLLOWER at term 0 for startAsFollower
2021-10-05 13:23:53,670 [pool-138-thread-1] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(130)) - a9b6c243-aad2-4cee-be19-871628539a81: start a9b6c243-aad2-4cee-be19-871628539a81@group-D8E46993F0F1-FollowerState
2021-10-05 13:23:53,670 [pool-138-thread-1] INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-D8E46993F0F1,id=a9b6c243-aad2-4cee-be19-871628539a81
2021-10-05 13:23:53,688 [Command processor thread] INFO  commandhandler.CreatePipelineCommandHandler (CreatePipelineCommandHandler.java:handle(106)) - Created Pipeline RATIS THREE PipelineID=8c8a590d-1d11-430c-931a-52e96576a6db.
2021-10-05 13:23:53,688 [Command processor thread] INFO  commandhandler.CreatePipelineCommandHandler (CreatePipelineCommandHandler.java:handle(106)) - Created Pipeline RATIS THREE PipelineID=90899f2e-5ed2-48cb-9677-d8e46993f0f1.
2021-10-05 13:23:53,812 [Listener at 127.0.0.1/10356] INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(235)) - Nodes are ready. Got 3 of 3 DN Heartbeats.
2021-10-05 13:23:53,812 [Listener at 127.0.0.1/10356] INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(238)) - Waiting for cluster to exit safe mode
2021-10-05 13:23:53,814 [Listener at 127.0.0.1/10356] INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(240)) - SCM became leader
2021-10-05 13:23:53,846 [Command processor thread] INFO  server.RaftServer (RaftServerProxy.java:addNew(95)) - a9b6c243-aad2-4cee-be19-871628539a81: addNew group-DC372A106217:[a9b6c243-aad2-4cee-be19-871628539a81|rpc:127.0.0.1:36351|priority:1] returns group-DC372A106217:java.util.concurrent.CompletableFuture@10e8a98a[Not completed]
2021-10-05 13:23:53,848 [pool-138-thread-1] INFO  server.RaftServer$Division (RaftServerImpl.java:<init>(181)) - a9b6c243-aad2-4cee-be19-871628539a81: new RaftServerImpl for group-DC372A106217:[a9b6c243-aad2-4cee-be19-871628539a81|rpc:127.0.0.1:36351|priority:1] with ContainerStateMachine:uninitialized
2021-10-05 13:23:53,848 [pool-138-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.timeout.min = 5s (custom)
2021-10-05 13:23:53,848 [pool-138-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.timeout.max = 5200ms (custom)
2021-10-05 13:23:53,848 [pool-138-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.sleep.time = 25ms (default)
2021-10-05 13:23:53,848 [pool-138-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.slowness.timeout = 300s (custom)
2021-10-05 13:23:53,848 [pool-138-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.leaderelection.leader.step-down.wait-time = 10s (default)
2021-10-05 13:23:53,849 [pool-138-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.sleep.deviation.threshold = 300ms (default)
2021-10-05 13:23:53,849 [pool-138-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.appender.install.snapshot.enabled = false (custom)
2021-10-05 13:23:53,849 [pool-138-thread-1] INFO  server.RaftServer$Division (ServerState.java:<init>(105)) - a9b6c243-aad2-4cee-be19-871628539a81@group-DC372A106217: ConfigurationManager, init=-1: [a9b6c243-aad2-4cee-be19-871628539a81|rpc:127.0.0.1:36351|priority:1], old=null, confs=<EMPTY_MAP>
2021-10-05 13:23:53,849 [pool-138-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.storage.dir = [/home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-98f4f1fb-613f-4a4a-83a3-c748f4b4520d/datanode-2/data/ratis] (custom)
2021-10-05 13:23:53,849 [pool-138-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.corruption.policy = EXCEPTION (default)
2021-10-05 13:23:53,849 [pool-138-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.storage.free-space.min = 0MB (=0) (default)
2021-10-05 13:23:53,849 [pool-138-thread-1] INFO  storage.RaftStorageDirectory (RaftStorageDirectoryImpl.java:analyzeStorage(135)) - The storage directory /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-98f4f1fb-613f-4a4a-83a3-c748f4b4520d/datanode-2/data/ratis/422df7cd-075e-4b52-b513-dc372a106217 does not exist. Creating ...
2021-10-05 13:23:53,850 [pool-138-thread-1] INFO  storage.RaftStorageDirectory (RaftStorageDirectoryImpl.java:tryLock(230)) - Lock on /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-98f4f1fb-613f-4a4a-83a3-c748f4b4520d/datanode-2/data/ratis/422df7cd-075e-4b52-b513-dc372a106217/in_use.lock acquired by nodename 17451@fv-az270-324
2021-10-05 13:23:53,851 [pool-138-thread-1] INFO  storage.RaftStorage (RaftStorageImpl.java:format(89)) - Storage directory /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-98f4f1fb-613f-4a4a-83a3-c748f4b4520d/datanode-2/data/ratis/422df7cd-075e-4b52-b513-dc372a106217 has been successfully formatted.
2021-10-05 13:23:53,852 [pool-138-thread-1] INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(224)) - group-DC372A106217: The snapshot info is null. Setting the last applied indexto:(t:0, i:~)
2021-10-05 13:23:53,852 [pool-138-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.notification.no-leader.timeout = 300s (custom)
2021-10-05 13:23:53,852 [pool-138-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.use.memory = false (default)
2021-10-05 13:23:53,854 [EventQueue-PipelineReportForPipelineReportHandler] INFO  pipeline.PipelineManagerImpl (PipelineManagerImpl.java:openPipeline(282)) - Pipeline Pipeline[ Id: 422df7cd-075e-4b52-b513-dc372a106217, Nodes: a9b6c243-aad2-4cee-be19-871628539a81{ip: 127.0.0.1, host: localhost, ports: [REPLICATION=45095, RATIS=36351, RATIS_ADMIN=36351, RATIS_SERVER=36351, STANDALONE=33273], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}, ReplicationConfig: RATIS/ONE, State:ALLOCATED, leaderId:a9b6c243-aad2-4cee-be19-871628539a81, CreationTimestamp2021-10-05T13:23:50.859Z[Etc/UTC]] moved to OPEN state
2021-10-05 13:23:53,854 [EventQueue-PipelineReportForPipelineReportHandler] INFO  ha.SCMHAInvocationHandler (SCMHAInvocationHandler.java:invokeRatis(113)) - Invoking method public abstract void org.apache.hadoop.hdds.scm.pipeline.PipelineStateManager.updatePipelineState(org.apache.hadoop.hdds.protocol.proto.HddsProtos$PipelineID,org.apache.hadoop.hdds.protocol.proto.HddsProtos$PipelineState) throws java.io.IOException on target org.apache.hadoop.hdds.scm.ha.SCMRatisServerImpl@4caa9da2, cost 276.928us
2021-10-05 13:23:53,854 [pool-138-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.purge.gap = 1000000 (custom)
2021-10-05 13:23:53,857 [pool-138-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2021-10-05 13:23:53,856 [EventQueue-PipelineReportForPipelineReportHandler] INFO  pipeline.PipelineManagerImpl (PipelineManagerImpl.java:openPipeline(282)) - Pipeline Pipeline[ Id: 422df7cd-075e-4b52-b513-dc372a106217, Nodes: a9b6c243-aad2-4cee-be19-871628539a81{ip: 127.0.0.1, host: localhost, ports: [REPLICATION=45095, RATIS=36351, RATIS_ADMIN=36351, RATIS_SERVER=36351, STANDALONE=33273], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}, ReplicationConfig: RATIS/ONE, State:ALLOCATED, leaderId:a9b6c243-aad2-4cee-be19-871628539a81, CreationTimestamp2021-10-05T13:23:50.859Z[Etc/UTC]] moved to OPEN state
2021-10-05 13:23:53,858 [pool-138-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.segment.size.max = 1048576 (custom)
2021-10-05 13:23:53,859 [pool-138-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.segment.cache.num.max = 2 (custom)
2021-10-05 13:23:53,860 [pool-138-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.segment.cache.size.max = 200MB (=209715200) (default)
2021-10-05 13:23:53,860 [pool-138-thread-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:<init>(182)) - new a9b6c243-aad2-4cee-be19-871628539a81@group-DC372A106217-SegmentedRaftLogWorker for RaftStorageImpl:Storage Directory /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-98f4f1fb-613f-4a4a-83a3-c748f4b4520d/datanode-2/data/ratis/422df7cd-075e-4b52-b513-dc372a106217
2021-10-05 13:23:53,860 [pool-138-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2021-10-05 13:23:53,860 [pool-138-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.queue.element-limit = 1024 (custom)
2021-10-05 13:23:53,860 [pool-138-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.segment.size.max = 1048576 (custom)
2021-10-05 13:23:53,860 [pool-138-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.preallocated.size = 16384 (custom)
2021-10-05 13:23:53,860 [pool-138-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.force.sync.num = 128 (default)
2021-10-05 13:23:53,860 [pool-138-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.statemachine.data.sync = true (default)
2021-10-05 13:23:53,860 [pool-138-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2021-10-05 13:23:53,860 [pool-138-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2021-10-05 13:23:53,863 [pool-138-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.write.buffer.size = 1048576 (custom)
2021-10-05 13:23:53,863 [pool-138-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2021-10-05 13:23:53,863 [pool-138-thread-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:lambda$new$0(133)) - a9b6c243-aad2-4cee-be19-871628539a81@group-DC372A106217-SegmentedRaftLogWorker: flushIndex: setUnconditionally 0 -> -1
2021-10-05 13:23:53,863 [pool-138-thread-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:lambda$new$0(133)) - a9b6c243-aad2-4cee-be19-871628539a81@group-DC372A106217-SegmentedRaftLogWorker: safeCacheEvictIndex: setUnconditionally 0 -> -1
2021-10-05 13:23:53,864 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  ha.SCMStateMachine (SCMStateMachine.java:takeSnapshot(290)) - Current Snapshot Index 20, takeSnapshot took 0 ms
2021-10-05 13:23:53,869 [pool-138-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2021-10-05 13:23:53,871 [pool-138-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2021-10-05 13:23:53,871 [pool-138-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.snapshot.retention.file.num = 5 (custom)
2021-10-05 13:23:53,872 [pool-138-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.purge.upto.snapshot.index = false (default)
2021-10-05 13:23:53,872 [pool-138-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.retrycache.expirytime = 600000ms (custom)
2021-10-05 13:23:53,872 [pool-138-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.retrycache.statistics.expirytime = 100μs (default)
2021-10-05 13:23:53,873 [pool-138-thread-1] INFO  server.RaftServer$Division (RaftServerImpl.java:start(296)) - a9b6c243-aad2-4cee-be19-871628539a81@group-DC372A106217: start as a follower, conf=-1: [a9b6c243-aad2-4cee-be19-871628539a81|rpc:127.0.0.1:36351|priority:1], old=null
2021-10-05 13:23:53,873 [pool-138-thread-1] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(285)) - a9b6c243-aad2-4cee-be19-871628539a81@group-DC372A106217: changes role from      null to FOLLOWER at term 0 for startAsFollower
2021-10-05 13:23:53,873 [pool-138-thread-1] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(130)) - a9b6c243-aad2-4cee-be19-871628539a81: start a9b6c243-aad2-4cee-be19-871628539a81@group-DC372A106217-FollowerState
2021-10-05 13:23:53,874 [pool-138-thread-1] INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-DC372A106217,id=a9b6c243-aad2-4cee-be19-871628539a81
2021-10-05 13:23:53,875 [Command processor thread] INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:addGroup(763)) - Created group PipelineID=422df7cd-075e-4b52-b513-dc372a106217
2021-10-05 13:23:53,875 [Command processor thread] INFO  commandhandler.CreatePipelineCommandHandler (CreatePipelineCommandHandler.java:handle(106)) - Created Pipeline RATIS ONE PipelineID=422df7cd-075e-4b52-b513-dc372a106217.
2021-10-05 13:23:53,865 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  safemode.HealthyPipelineSafeModeRule (HealthyPipelineSafeModeRule.java:initializeRule(152)) - Refreshed total pipeline count is 0, healthy pipeline threshold count is 1
2021-10-05 13:23:53,871 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:takeSnapshot(281)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater: Took a snapshot at index 20
2021-10-05 13:23:53,875 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:lambda$new$0(89)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater: snapshotIndex: updateIncreasingly 15 -> 20
2021-10-05 13:23:53,875 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:purge(306)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-SegmentedRaftLog: purge 20
2021-10-05 13:23:53,875 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-SegmentedRaftLog: snapshotIndex: updateIncreasingly 15 -> 20
2021-10-05 13:23:53,875 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-SegmentedRaftLog: purgeIndex: updateToMax old=15, new=20, updated? true
2021-10-05 13:23:53,876 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  safemode.HealthyPipelineSafeModeRule (HealthyPipelineSafeModeRule.java:initializeRule(152)) - Refreshed total pipeline count is 0, healthy pipeline threshold count is 1
2021-10-05 13:23:53,876 [EventQueue-PipelineReportForPipelineReportHandler] INFO  ha.SCMHAInvocationHandler (SCMHAInvocationHandler.java:invokeRatis(113)) - Invoking method public abstract void org.apache.hadoop.hdds.scm.pipeline.PipelineStateManager.updatePipelineState(org.apache.hadoop.hdds.protocol.proto.HddsProtos$PipelineID,org.apache.hadoop.hdds.protocol.proto.HddsProtos$PipelineState) throws java.io.IOException on target org.apache.hadoop.hdds.scm.ha.SCMRatisServerImpl@6344f74b, cost 19015.64us
2021-10-05 13:23:53,876 [EventQueue-OpenPipelineForHealthyPipelineSafeModeRule] INFO  safemode.SCMSafeModeManager (HealthyPipelineSafeModeRule.java:process(124)) - SCM in safe mode. Healthy pipelines reported count is 0, required healthy pipeline reported count is 1
2021-10-05 13:23:54,270 [EventQueue-OpenPipelineForHealthyPipelineSafeModeRule] INFO  safemode.SCMSafeModeManager (HealthyPipelineSafeModeRule.java:process(124)) - SCM in safe mode. Healthy pipelines reported count is 0, required healthy pipeline reported count is 1
2021-10-05 13:23:54,272 [EventQueue-OpenPipelineForHealthyPipelineSafeModeRule] INFO  safemode.SCMSafeModeManager (HealthyPipelineSafeModeRule.java:process(124)) - SCM in safe mode. Healthy pipelines reported count is 0, required healthy pipeline reported count is 1
2021-10-05 13:23:54,480 [EventQueue-OpenPipelineForHealthyPipelineSafeModeRule] INFO  safemode.SCMSafeModeManager (HealthyPipelineSafeModeRule.java:process(124)) - SCM in safe mode. Healthy pipelines reported count is 0, required healthy pipeline reported count is 1
2021-10-05 13:23:54,483 [EventQueue-OpenPipelineForHealthyPipelineSafeModeRule] INFO  safemode.SCMSafeModeManager (HealthyPipelineSafeModeRule.java:process(124)) - SCM in safe mode. Healthy pipelines reported count is 0, required healthy pipeline reported count is 1
2021-10-05 13:23:54,581 [Datanode State Machine Thread - 0] ERROR datanode.RunningDatanodeState (RunningDatanodeState.java:computeNextContainerState(199)) - Error in executing end point task.
java.util.concurrent.ExecutionException: java.util.concurrent.TimeoutException
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.hadoop.ozone.container.common.states.datanode.RunningDatanodeState.computeNextContainerState(RunningDatanodeState.java:191)
	at org.apache.hadoop.ozone.container.common.states.datanode.RunningDatanodeState.await(RunningDatanodeState.java:231)
	at org.apache.hadoop.ozone.container.common.states.datanode.RunningDatanodeState.await(RunningDatanodeState.java:50)
	at org.apache.hadoop.ozone.container.common.statemachine.StateContext.execute(StateContext.java:629)
	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.start(DatanodeStateMachine.java:270)
	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.lambda$startDaemon$0(DatanodeStateMachine.java:457)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.util.concurrent.TimeoutException
	at java.util.concurrent.FutureTask.get(FutureTask.java:205)
	at org.apache.hadoop.ozone.container.common.states.datanode.RunningDatanodeState.lambda$execute$0(RunningDatanodeState.java:149)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
2021-10-05 13:23:54,814 [Listener at 127.0.0.1/10356] INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(235)) - Nodes are ready. Got 3 of 3 DN Heartbeats.
2021-10-05 13:23:54,815 [Listener at 127.0.0.1/10356] INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(238)) - Waiting for cluster to exit safe mode
2021-10-05 13:23:54,815 [Listener at 127.0.0.1/10356] INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(240)) - SCM became leader
2021-10-05 13:23:55,816 [Listener at 127.0.0.1/10356] INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(235)) - Nodes are ready. Got 3 of 3 DN Heartbeats.
2021-10-05 13:23:55,816 [Listener at 127.0.0.1/10356] INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(238)) - Waiting for cluster to exit safe mode
2021-10-05 13:23:55,817 [Listener at 127.0.0.1/10356] INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(240)) - SCM became leader
2021-10-05 13:23:56,558 [Datanode State Machine Thread - 0] ERROR datanode.RunningDatanodeState (RunningDatanodeState.java:computeNextContainerState(199)) - Error in executing end point task.
java.util.concurrent.ExecutionException: java.util.concurrent.TimeoutException
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.hadoop.ozone.container.common.states.datanode.RunningDatanodeState.computeNextContainerState(RunningDatanodeState.java:191)
	at org.apache.hadoop.ozone.container.common.states.datanode.RunningDatanodeState.await(RunningDatanodeState.java:231)
	at org.apache.hadoop.ozone.container.common.states.datanode.RunningDatanodeState.await(RunningDatanodeState.java:50)
	at org.apache.hadoop.ozone.container.common.statemachine.StateContext.execute(StateContext.java:629)
	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.start(DatanodeStateMachine.java:270)
	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.lambda$startDaemon$0(DatanodeStateMachine.java:457)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.util.concurrent.TimeoutException
	at java.util.concurrent.FutureTask.get(FutureTask.java:205)
	at org.apache.hadoop.ozone.container.common.states.datanode.RunningDatanodeState.lambda$execute$0(RunningDatanodeState.java:149)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
2021-10-05 13:23:56,817 [Listener at 127.0.0.1/10356] INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(235)) - Nodes are ready. Got 3 of 3 DN Heartbeats.
2021-10-05 13:23:56,818 [Listener at 127.0.0.1/10356] INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(238)) - Waiting for cluster to exit safe mode
2021-10-05 13:23:56,818 [Listener at 127.0.0.1/10356] INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(240)) - SCM became leader
2021-10-05 13:23:56,854 [Datanode State Machine Thread - 0] ERROR datanode.RunningDatanodeState (RunningDatanodeState.java:computeNextContainerState(199)) - Error in executing end point task.
java.util.concurrent.ExecutionException: java.util.concurrent.TimeoutException
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.hadoop.ozone.container.common.states.datanode.RunningDatanodeState.computeNextContainerState(RunningDatanodeState.java:191)
	at org.apache.hadoop.ozone.container.common.states.datanode.RunningDatanodeState.await(RunningDatanodeState.java:231)
	at org.apache.hadoop.ozone.container.common.states.datanode.RunningDatanodeState.await(RunningDatanodeState.java:50)
	at org.apache.hadoop.ozone.container.common.statemachine.StateContext.execute(StateContext.java:629)
	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.start(DatanodeStateMachine.java:270)
	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.lambda$startDaemon$0(DatanodeStateMachine.java:457)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.util.concurrent.TimeoutException
	at java.util.concurrent.FutureTask.get(FutureTask.java:205)
	at org.apache.hadoop.ozone.container.common.states.datanode.RunningDatanodeState.lambda$execute$0(RunningDatanodeState.java:149)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
2021-10-05 13:23:57,818 [Listener at 127.0.0.1/10356] INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(235)) - Nodes are ready. Got 3 of 3 DN Heartbeats.
2021-10-05 13:23:57,819 [Listener at 127.0.0.1/10356] INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(238)) - Waiting for cluster to exit safe mode
2021-10-05 13:23:57,819 [Listener at 127.0.0.1/10356] INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(240)) - SCM became leader
2021-10-05 13:23:57,856 [Datanode State Machine Thread - 0] ERROR datanode.RunningDatanodeState (RunningDatanodeState.java:computeNextContainerState(199)) - Error in executing end point task.
java.util.concurrent.ExecutionException: java.util.concurrent.TimeoutException
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.hadoop.ozone.container.common.states.datanode.RunningDatanodeState.computeNextContainerState(RunningDatanodeState.java:191)
	at org.apache.hadoop.ozone.container.common.states.datanode.RunningDatanodeState.await(RunningDatanodeState.java:231)
	at org.apache.hadoop.ozone.container.common.states.datanode.RunningDatanodeState.await(RunningDatanodeState.java:50)
	at org.apache.hadoop.ozone.container.common.statemachine.StateContext.execute(StateContext.java:629)
	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.start(DatanodeStateMachine.java:270)
	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.lambda$startDaemon$0(DatanodeStateMachine.java:457)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.util.concurrent.TimeoutException
	at java.util.concurrent.FutureTask.get(FutureTask.java:205)
	at org.apache.hadoop.ozone.container.common.states.datanode.RunningDatanodeState.lambda$execute$0(RunningDatanodeState.java:149)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
2021-10-05 13:23:58,492 [f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-52E96576A6DB-FollowerState] INFO  impl.FollowerState (FollowerState.java:run(134)) - f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-52E96576A6DB-FollowerState: change to CANDIDATE, lastRpcElapsedTime:5081798743ns, electionTimeout:5081ms
2021-10-05 13:23:58,492 [f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-52E96576A6DB-FollowerState] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(108)) - f990c0ed-f7f2-4f8a-8ec9-db097d9c855e: shutdown f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-52E96576A6DB-FollowerState
2021-10-05 13:23:58,492 [f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-52E96576A6DB-FollowerState] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(285)) - f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-52E96576A6DB: changes role from  FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2021-10-05 13:23:58,492 [f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-52E96576A6DB-FollowerState] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.leaderelection.pre-vote = false (custom)
2021-10-05 13:23:58,492 [f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-52E96576A6DB-FollowerState] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(130)) - f990c0ed-f7f2-4f8a-8ec9-db097d9c855e: start f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-52E96576A6DB-LeaderElection4
2021-10-05 13:23:58,503 [f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-52E96576A6DB-LeaderElection4] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(306)) - f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-52E96576A6DB-LeaderElection4 ELECTION round 0: submit vote requests at term 1 for -1: [0c34be74-1f5b-4b04-a6d4-fde6c3deb89a|rpc:127.0.0.1:33359|priority:0, f990c0ed-f7f2-4f8a-8ec9-db097d9c855e|rpc:127.0.0.1:44595|priority:0, a9b6c243-aad2-4cee-be19-871628539a81|rpc:127.0.0.1:36351|priority:1], old=null
2021-10-05 13:23:58,528 [grpc-default-executor-1] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1043)) - 0c34be74-1f5b-4b04-a6d4-fde6c3deb89a@group-52E96576A6DB: receive requestVote(ELECTION, f990c0ed-f7f2-4f8a-8ec9-db097d9c855e, group-52E96576A6DB, 1, (t:0, i:0))
2021-10-05 13:23:58,529 [grpc-default-executor-1] INFO  impl.VoteContext (VoteContext.java:log(48)) - 0c34be74-1f5b-4b04-a6d4-fde6c3deb89a@group-52E96576A6DB-FOLLOWER: accept ELECTION from f990c0ed-f7f2-4f8a-8ec9-db097d9c855e: our priority 0 <= candidate's priority 0
2021-10-05 13:23:58,529 [grpc-default-executor-1] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(285)) - 0c34be74-1f5b-4b04-a6d4-fde6c3deb89a@group-52E96576A6DB: changes role from  FOLLOWER to FOLLOWER at term 1 for candidate:f990c0ed-f7f2-4f8a-8ec9-db097d9c855e
2021-10-05 13:23:58,529 [grpc-default-executor-1] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(108)) - 0c34be74-1f5b-4b04-a6d4-fde6c3deb89a: shutdown 0c34be74-1f5b-4b04-a6d4-fde6c3deb89a@group-52E96576A6DB-FollowerState
2021-10-05 13:23:58,530 [0c34be74-1f5b-4b04-a6d4-fde6c3deb89a@group-52E96576A6DB-FollowerState] INFO  impl.FollowerState (FollowerState.java:run(143)) - 0c34be74-1f5b-4b04-a6d4-fde6c3deb89a@group-52E96576A6DB-FollowerState was interrupted: {}
java.lang.InterruptedException: sleep interrupted
	at java.lang.Thread.sleep(Native Method)
	at java.lang.Thread.sleep(Thread.java:340)
	at java.util.concurrent.TimeUnit.sleep(TimeUnit.java:386)
	at org.apache.ratis.util.TimeDuration.sleep(TimeDuration.java:324)
	at org.apache.ratis.util.TimeDuration.sleep(TimeDuration.java:309)
	at org.apache.ratis.server.impl.FollowerState.run(FollowerState.java:118)
2021-10-05 13:23:58,530 [grpc-default-executor-1] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(130)) - 0c34be74-1f5b-4b04-a6d4-fde6c3deb89a: start 0c34be74-1f5b-4b04-a6d4-fde6c3deb89a@group-52E96576A6DB-FollowerState
2021-10-05 13:23:58,533 [f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-1CD77BA4A78C-FollowerState] INFO  impl.FollowerState (FollowerState.java:run(134)) - f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-1CD77BA4A78C-FollowerState: change to CANDIDATE, lastRpcElapsedTime:5172273863ns, electionTimeout:5161ms
2021-10-05 13:23:58,533 [f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-1CD77BA4A78C-FollowerState] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(108)) - f990c0ed-f7f2-4f8a-8ec9-db097d9c855e: shutdown f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-1CD77BA4A78C-FollowerState
2021-10-05 13:23:58,533 [f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-1CD77BA4A78C-FollowerState] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(285)) - f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-1CD77BA4A78C: changes role from  FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2021-10-05 13:23:58,533 [f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-1CD77BA4A78C-FollowerState] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.leaderelection.pre-vote = false (custom)
2021-10-05 13:23:58,533 [f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-1CD77BA4A78C-FollowerState] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(130)) - f990c0ed-f7f2-4f8a-8ec9-db097d9c855e: start f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-1CD77BA4A78C-LeaderElection5
2021-10-05 13:23:58,538 [grpc-default-executor-1] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1075)) - 0c34be74-1f5b-4b04-a6d4-fde6c3deb89a@group-52E96576A6DB replies to ELECTION vote request: f990c0ed-f7f2-4f8a-8ec9-db097d9c855e<-0c34be74-1f5b-4b04-a6d4-fde6c3deb89a#0:OK-t1. Peer's state: 0c34be74-1f5b-4b04-a6d4-fde6c3deb89a@group-52E96576A6DB:t1, leader=null, voted=f990c0ed-f7f2-4f8a-8ec9-db097d9c855e, raftlog=0c34be74-1f5b-4b04-a6d4-fde6c3deb89a@group-52E96576A6DB-SegmentedRaftLog:OPENED:c-1,f-1,i0, conf=-1: [0c34be74-1f5b-4b04-a6d4-fde6c3deb89a|rpc:127.0.0.1:33359|dataStream:|priority:0, f990c0ed-f7f2-4f8a-8ec9-db097d9c855e|rpc:127.0.0.1:44595|dataStream:|priority:0, a9b6c243-aad2-4cee-be19-871628539a81|rpc:127.0.0.1:36351|dataStream:|priority:1], old=null
2021-10-05 13:23:58,543 [f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-1CD77BA4A78C-LeaderElection5] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(306)) - f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-1CD77BA4A78C-LeaderElection5 ELECTION round 0: submit vote requests at term 1 for -1: [f990c0ed-f7f2-4f8a-8ec9-db097d9c855e|rpc:127.0.0.1:44595|priority:1], old=null
2021-10-05 13:23:58,543 [f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-1CD77BA4A78C-LeaderElection5] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(308)) - f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-1CD77BA4A78C-LeaderElection5 ELECTION round 0: result PASSED (term=1)
2021-10-05 13:23:58,543 [grpc-default-executor-1] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1043)) - a9b6c243-aad2-4cee-be19-871628539a81@group-52E96576A6DB: receive requestVote(ELECTION, f990c0ed-f7f2-4f8a-8ec9-db097d9c855e, group-52E96576A6DB, 1, (t:0, i:0))
2021-10-05 13:23:58,544 [grpc-default-executor-1] INFO  impl.VoteContext (VoteContext.java:log(48)) - a9b6c243-aad2-4cee-be19-871628539a81@group-52E96576A6DB-FOLLOWER: reject ELECTION from f990c0ed-f7f2-4f8a-8ec9-db097d9c855e: our priority 1 > candidate's priority 0
2021-10-05 13:23:58,544 [grpc-default-executor-1] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(285)) - a9b6c243-aad2-4cee-be19-871628539a81@group-52E96576A6DB: changes role from  FOLLOWER to FOLLOWER at term 1 for candidate:f990c0ed-f7f2-4f8a-8ec9-db097d9c855e
2021-10-05 13:23:58,545 [grpc-default-executor-1] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(108)) - a9b6c243-aad2-4cee-be19-871628539a81: shutdown a9b6c243-aad2-4cee-be19-871628539a81@group-52E96576A6DB-FollowerState
2021-10-05 13:23:58,545 [a9b6c243-aad2-4cee-be19-871628539a81@group-52E96576A6DB-FollowerState] INFO  impl.FollowerState (FollowerState.java:run(143)) - a9b6c243-aad2-4cee-be19-871628539a81@group-52E96576A6DB-FollowerState was interrupted: {}
java.lang.InterruptedException: sleep interrupted
	at java.lang.Thread.sleep(Native Method)
	at java.lang.Thread.sleep(Thread.java:340)
	at java.util.concurrent.TimeUnit.sleep(TimeUnit.java:386)
	at org.apache.ratis.util.TimeDuration.sleep(TimeDuration.java:324)
	at org.apache.ratis.util.TimeDuration.sleep(TimeDuration.java:309)
	at org.apache.ratis.server.impl.FollowerState.run(FollowerState.java:118)
2021-10-05 13:23:58,545 [grpc-default-executor-1] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(130)) - a9b6c243-aad2-4cee-be19-871628539a81: start a9b6c243-aad2-4cee-be19-871628539a81@group-52E96576A6DB-FollowerState
2021-10-05 13:23:58,543 [f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-1CD77BA4A78C-LeaderElection5] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(121)) - f990c0ed-f7f2-4f8a-8ec9-db097d9c855e: shutdown f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-1CD77BA4A78C-LeaderElection5
2021-10-05 13:23:58,546 [f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-1CD77BA4A78C-LeaderElection5] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(285)) - f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-1CD77BA4A78C: changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2021-10-05 13:23:58,546 [f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-1CD77BA4A78C-LeaderElection5] INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:handleLeaderChangedNotification(861)) - Leader change notification received for group: group-1CD77BA4A78C with new leaderId: f990c0ed-f7f2-4f8a-8ec9-db097d9c855e
2021-10-05 13:23:58,547 [f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-1CD77BA4A78C-LeaderElection5] INFO  server.RaftServer$Division (ServerState.java:setLeader(285)) - f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-1CD77BA4A78C: change Leader from null to f990c0ed-f7f2-4f8a-8ec9-db097d9c855e at term 1 for becomeLeader, leader elected after 5238ms
2021-10-05 13:23:58,547 [f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-1CD77BA4A78C-LeaderElection5] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.staging.catchup.gap = 1000 (default)
2021-10-05 13:23:58,549 [EventQueue-OpenPipelineForHealthyPipelineSafeModeRule] INFO  safemode.SCMSafeModeManager (HealthyPipelineSafeModeRule.java:process(124)) - SCM in safe mode. Healthy pipelines reported count is 0, required healthy pipeline reported count is 1
2021-10-05 13:23:58,549 [EventQueue-OpenPipelineForHealthyPipelineSafeModeRule] INFO  safemode.SCMSafeModeManager (HealthyPipelineSafeModeRule.java:process(124)) - SCM in safe mode. Healthy pipelines reported count is 0, required healthy pipeline reported count is 1
2021-10-05 13:23:58,550 [grpc-default-executor-1] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1075)) - a9b6c243-aad2-4cee-be19-871628539a81@group-52E96576A6DB replies to ELECTION vote request: f990c0ed-f7f2-4f8a-8ec9-db097d9c855e<-a9b6c243-aad2-4cee-be19-871628539a81#0:FAIL-t1. Peer's state: a9b6c243-aad2-4cee-be19-871628539a81@group-52E96576A6DB:t1, leader=null, voted=null, raftlog=a9b6c243-aad2-4cee-be19-871628539a81@group-52E96576A6DB-SegmentedRaftLog:OPENED:c-1,f-1,i0, conf=-1: [0c34be74-1f5b-4b04-a6d4-fde6c3deb89a|rpc:127.0.0.1:33359|dataStream:|priority:0, f990c0ed-f7f2-4f8a-8ec9-db097d9c855e|rpc:127.0.0.1:44595|dataStream:|priority:0, a9b6c243-aad2-4cee-be19-871628539a81|rpc:127.0.0.1:36351|dataStream:|priority:1], old=null
2021-10-05 13:23:58,550 [f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-1CD77BA4A78C-LeaderElection5] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.write.element-limit = 1024 (custom)
2021-10-05 13:23:58,553 [f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-1CD77BA4A78C-LeaderElection5] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.write.byte-limit = 1024 M (=1073741824) (custom)
2021-10-05 13:23:58,553 [f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-1CD77BA4A78C-LeaderElection5] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.watch.timeout = 180s (custom)
2021-10-05 13:23:58,553 [f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-1CD77BA4A78C-LeaderElection5] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.watch.timeout.denomination = 1s (default)
2021-10-05 13:23:58,554 [f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-1CD77BA4A78C-LeaderElection5] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.watch.element-limit = 65536 (default)
2021-10-05 13:23:58,554 [f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-1CD77BA4A78C-LeaderElection5] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(130)) - f990c0ed-f7f2-4f8a-8ec9-db097d9c855e: start f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-1CD77BA4A78C-LeaderStateImpl
2021-10-05 13:23:58,554 [f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-1CD77BA4A78C-LeaderElection5] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:startLogSegment(394)) - f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-1CD77BA4A78C-SegmentedRaftLogWorker: Starting segment from index:0
2021-10-05 13:23:58,555 [f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-1CD77BA4A78C-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(601)) - f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-1CD77BA4A78C-SegmentedRaftLogWorker: created new log segment /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-98f4f1fb-613f-4a4a-83a3-c748f4b4520d/datanode-0/data/ratis/4bafc9c3-fe1c-42b3-af40-1cd77ba4a78c/current/log_inprogress_0
2021-10-05 13:23:58,560 [f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-52E96576A6DB-LeaderElection4] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(89)) - f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-52E96576A6DB-LeaderElection4: ELECTION REJECTED received 2 response(s) and 0 exception(s):
2021-10-05 13:23:58,560 [f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-52E96576A6DB-LeaderElection4] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(93)) -   Response 0: f990c0ed-f7f2-4f8a-8ec9-db097d9c855e<-0c34be74-1f5b-4b04-a6d4-fde6c3deb89a#0:OK-t1
2021-10-05 13:23:58,560 [f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-52E96576A6DB-LeaderElection4] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(93)) -   Response 1: f990c0ed-f7f2-4f8a-8ec9-db097d9c855e<-a9b6c243-aad2-4cee-be19-871628539a81#0:FAIL-t1
2021-10-05 13:23:58,561 [f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-52E96576A6DB-LeaderElection4] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(308)) - f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-52E96576A6DB-LeaderElection4 ELECTION round 0: result REJECTED
2021-10-05 13:23:58,561 [f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-52E96576A6DB-LeaderElection4] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(285)) - f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-52E96576A6DB: changes role from CANDIDATE to FOLLOWER at term 1 for REJECTED
2021-10-05 13:23:58,561 [f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-52E96576A6DB-LeaderElection4] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(121)) - f990c0ed-f7f2-4f8a-8ec9-db097d9c855e: shutdown f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-52E96576A6DB-LeaderElection4
2021-10-05 13:23:58,561 [f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-52E96576A6DB-LeaderElection4] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(130)) - f990c0ed-f7f2-4f8a-8ec9-db097d9c855e: start f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-52E96576A6DB-FollowerState
2021-10-05 13:23:58,562 [Datanode State Machine Thread - 0] ERROR datanode.RunningDatanodeState (RunningDatanodeState.java:computeNextContainerState(199)) - Error in executing end point task.
java.util.concurrent.ExecutionException: java.util.concurrent.TimeoutException
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.hadoop.ozone.container.common.states.datanode.RunningDatanodeState.computeNextContainerState(RunningDatanodeState.java:191)
	at org.apache.hadoop.ozone.container.common.states.datanode.RunningDatanodeState.await(RunningDatanodeState.java:231)
	at org.apache.hadoop.ozone.container.common.states.datanode.RunningDatanodeState.await(RunningDatanodeState.java:50)
	at org.apache.hadoop.ozone.container.common.statemachine.StateContext.execute(StateContext.java:629)
	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.start(DatanodeStateMachine.java:270)
	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.lambda$startDaemon$0(DatanodeStateMachine.java:457)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.util.concurrent.TimeoutException
	at java.util.concurrent.FutureTask.get(FutureTask.java:205)
	at org.apache.hadoop.ozone.container.common.states.datanode.RunningDatanodeState.lambda$execute$0(RunningDatanodeState.java:149)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
2021-10-05 13:23:58,571 [f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-1CD77BA4A78C-LeaderElection5] INFO  server.RaftServer$Division (ServerState.java:setRaftConf(387)) - f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-1CD77BA4A78C: set configuration 0: [f990c0ed-f7f2-4f8a-8ec9-db097d9c855e|rpc:127.0.0.1:44595|dataStream:|priority:1], old=null
2021-10-05 13:23:58,584 [0c34be74-1f5b-4b04-a6d4-fde6c3deb89a@group-D8E46993F0F1-FollowerState] INFO  impl.FollowerState (FollowerState.java:run(134)) - 0c34be74-1f5b-4b04-a6d4-fde6c3deb89a@group-D8E46993F0F1-FollowerState: change to CANDIDATE, lastRpcElapsedTime:5024843109ns, electionTimeout:5024ms
2021-10-05 13:23:58,584 [0c34be74-1f5b-4b04-a6d4-fde6c3deb89a@group-D8E46993F0F1-FollowerState] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(108)) - 0c34be74-1f5b-4b04-a6d4-fde6c3deb89a: shutdown 0c34be74-1f5b-4b04-a6d4-fde6c3deb89a@group-D8E46993F0F1-FollowerState
2021-10-05 13:23:58,584 [0c34be74-1f5b-4b04-a6d4-fde6c3deb89a@group-D8E46993F0F1-FollowerState] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(285)) - 0c34be74-1f5b-4b04-a6d4-fde6c3deb89a@group-D8E46993F0F1: changes role from  FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2021-10-05 13:23:58,584 [0c34be74-1f5b-4b04-a6d4-fde6c3deb89a@group-D8E46993F0F1-FollowerState] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.leaderelection.pre-vote = false (custom)
2021-10-05 13:23:58,584 [0c34be74-1f5b-4b04-a6d4-fde6c3deb89a@group-D8E46993F0F1-FollowerState] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(130)) - 0c34be74-1f5b-4b04-a6d4-fde6c3deb89a: start 0c34be74-1f5b-4b04-a6d4-fde6c3deb89a@group-D8E46993F0F1-LeaderElection6
2021-10-05 13:23:58,587 [0c34be74-1f5b-4b04-a6d4-fde6c3deb89a@group-D8E46993F0F1-LeaderElection6] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(306)) - 0c34be74-1f5b-4b04-a6d4-fde6c3deb89a@group-D8E46993F0F1-LeaderElection6 ELECTION round 0: submit vote requests at term 1 for -1: [0c34be74-1f5b-4b04-a6d4-fde6c3deb89a|rpc:127.0.0.1:33359|priority:0, f990c0ed-f7f2-4f8a-8ec9-db097d9c855e|rpc:127.0.0.1:44595|priority:1, a9b6c243-aad2-4cee-be19-871628539a81|rpc:127.0.0.1:36351|priority:0], old=null
2021-10-05 13:23:58,603 [grpc-default-executor-1] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1043)) - f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-D8E46993F0F1: receive requestVote(ELECTION, 0c34be74-1f5b-4b04-a6d4-fde6c3deb89a, group-D8E46993F0F1, 1, (t:0, i:0))
2021-10-05 13:23:58,603 [grpc-default-executor-1] INFO  impl.VoteContext (VoteContext.java:log(48)) - f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-D8E46993F0F1-FOLLOWER: reject ELECTION from 0c34be74-1f5b-4b04-a6d4-fde6c3deb89a: our priority 1 > candidate's priority 0
2021-10-05 13:23:58,603 [grpc-default-executor-1] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(285)) - f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-D8E46993F0F1: changes role from  FOLLOWER to FOLLOWER at term 1 for candidate:0c34be74-1f5b-4b04-a6d4-fde6c3deb89a
2021-10-05 13:23:58,603 [grpc-default-executor-1] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(108)) - f990c0ed-f7f2-4f8a-8ec9-db097d9c855e: shutdown f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-D8E46993F0F1-FollowerState
2021-10-05 13:23:58,604 [f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-D8E46993F0F1-FollowerState] INFO  impl.FollowerState (FollowerState.java:run(143)) - f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-D8E46993F0F1-FollowerState was interrupted: {}
java.lang.InterruptedException: sleep interrupted
	at java.lang.Thread.sleep(Native Method)
	at java.lang.Thread.sleep(Thread.java:340)
	at java.util.concurrent.TimeUnit.sleep(TimeUnit.java:386)
	at org.apache.ratis.util.TimeDuration.sleep(TimeDuration.java:324)
	at org.apache.ratis.util.TimeDuration.sleep(TimeDuration.java:309)
	at org.apache.ratis.server.impl.FollowerState.run(FollowerState.java:118)
2021-10-05 13:23:58,604 [grpc-default-executor-1] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(130)) - f990c0ed-f7f2-4f8a-8ec9-db097d9c855e: start f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-D8E46993F0F1-FollowerState
2021-10-05 13:23:58,608 [grpc-default-executor-1] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1075)) - f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-D8E46993F0F1 replies to ELECTION vote request: 0c34be74-1f5b-4b04-a6d4-fde6c3deb89a<-f990c0ed-f7f2-4f8a-8ec9-db097d9c855e#0:FAIL-t1. Peer's state: f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-D8E46993F0F1:t1, leader=null, voted=null, raftlog=f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-D8E46993F0F1-SegmentedRaftLog:OPENED:c-1,f-1,i0, conf=-1: [0c34be74-1f5b-4b04-a6d4-fde6c3deb89a|rpc:127.0.0.1:33359|dataStream:|priority:0, f990c0ed-f7f2-4f8a-8ec9-db097d9c855e|rpc:127.0.0.1:44595|dataStream:|priority:1, a9b6c243-aad2-4cee-be19-871628539a81|rpc:127.0.0.1:36351|dataStream:|priority:0], old=null
2021-10-05 13:23:58,612 [0c34be74-1f5b-4b04-a6d4-fde6c3deb89a@group-D8E46993F0F1-LeaderElection6] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(89)) - 0c34be74-1f5b-4b04-a6d4-fde6c3deb89a@group-D8E46993F0F1-LeaderElection6: ELECTION REJECTED received 1 response(s) and 0 exception(s):
2021-10-05 13:23:58,612 [0c34be74-1f5b-4b04-a6d4-fde6c3deb89a@group-D8E46993F0F1-LeaderElection6] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(93)) -   Response 0: 0c34be74-1f5b-4b04-a6d4-fde6c3deb89a<-f990c0ed-f7f2-4f8a-8ec9-db097d9c855e#0:FAIL-t1
2021-10-05 13:23:58,612 [0c34be74-1f5b-4b04-a6d4-fde6c3deb89a@group-D8E46993F0F1-LeaderElection6] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(308)) - 0c34be74-1f5b-4b04-a6d4-fde6c3deb89a@group-D8E46993F0F1-LeaderElection6 ELECTION round 0: result REJECTED
2021-10-05 13:23:58,612 [0c34be74-1f5b-4b04-a6d4-fde6c3deb89a@group-D8E46993F0F1-LeaderElection6] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(285)) - 0c34be74-1f5b-4b04-a6d4-fde6c3deb89a@group-D8E46993F0F1: changes role from CANDIDATE to FOLLOWER at term 1 for REJECTED
2021-10-05 13:23:58,612 [0c34be74-1f5b-4b04-a6d4-fde6c3deb89a@group-D8E46993F0F1-LeaderElection6] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(121)) - 0c34be74-1f5b-4b04-a6d4-fde6c3deb89a: shutdown 0c34be74-1f5b-4b04-a6d4-fde6c3deb89a@group-D8E46993F0F1-LeaderElection6
2021-10-05 13:23:58,612 [0c34be74-1f5b-4b04-a6d4-fde6c3deb89a@group-D8E46993F0F1-LeaderElection6] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(130)) - 0c34be74-1f5b-4b04-a6d4-fde6c3deb89a: start 0c34be74-1f5b-4b04-a6d4-fde6c3deb89a@group-D8E46993F0F1-FollowerState
2021-10-05 13:23:58,627 [grpc-default-executor-1] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1043)) - a9b6c243-aad2-4cee-be19-871628539a81@group-D8E46993F0F1: receive requestVote(ELECTION, 0c34be74-1f5b-4b04-a6d4-fde6c3deb89a, group-D8E46993F0F1, 1, (t:0, i:0))
2021-10-05 13:23:58,627 [grpc-default-executor-1] INFO  impl.VoteContext (VoteContext.java:log(48)) - a9b6c243-aad2-4cee-be19-871628539a81@group-D8E46993F0F1-FOLLOWER: accept ELECTION from 0c34be74-1f5b-4b04-a6d4-fde6c3deb89a: our priority 0 <= candidate's priority 0
2021-10-05 13:23:58,627 [grpc-default-executor-1] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(285)) - a9b6c243-aad2-4cee-be19-871628539a81@group-D8E46993F0F1: changes role from  FOLLOWER to FOLLOWER at term 1 for candidate:0c34be74-1f5b-4b04-a6d4-fde6c3deb89a
2021-10-05 13:23:58,627 [grpc-default-executor-1] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(108)) - a9b6c243-aad2-4cee-be19-871628539a81: shutdown a9b6c243-aad2-4cee-be19-871628539a81@group-D8E46993F0F1-FollowerState
2021-10-05 13:23:58,627 [a9b6c243-aad2-4cee-be19-871628539a81@group-D8E46993F0F1-FollowerState] INFO  impl.FollowerState (FollowerState.java:run(143)) - a9b6c243-aad2-4cee-be19-871628539a81@group-D8E46993F0F1-FollowerState was interrupted: {}
java.lang.InterruptedException: sleep interrupted
	at java.lang.Thread.sleep(Native Method)
	at java.lang.Thread.sleep(Thread.java:340)
	at java.util.concurrent.TimeUnit.sleep(TimeUnit.java:386)
	at org.apache.ratis.util.TimeDuration.sleep(TimeDuration.java:324)
	at org.apache.ratis.util.TimeDuration.sleep(TimeDuration.java:309)
	at org.apache.ratis.server.impl.FollowerState.run(FollowerState.java:118)
2021-10-05 13:23:58,627 [grpc-default-executor-1] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(130)) - a9b6c243-aad2-4cee-be19-871628539a81: start a9b6c243-aad2-4cee-be19-871628539a81@group-D8E46993F0F1-FollowerState
2021-10-05 13:23:58,629 [grpc-default-executor-1] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1075)) - a9b6c243-aad2-4cee-be19-871628539a81@group-D8E46993F0F1 replies to ELECTION vote request: 0c34be74-1f5b-4b04-a6d4-fde6c3deb89a<-a9b6c243-aad2-4cee-be19-871628539a81#0:OK-t1. Peer's state: a9b6c243-aad2-4cee-be19-871628539a81@group-D8E46993F0F1:t1, leader=null, voted=0c34be74-1f5b-4b04-a6d4-fde6c3deb89a, raftlog=a9b6c243-aad2-4cee-be19-871628539a81@group-D8E46993F0F1-SegmentedRaftLog:OPENED:c-1,f-1,i0, conf=-1: [0c34be74-1f5b-4b04-a6d4-fde6c3deb89a|rpc:127.0.0.1:33359|dataStream:|priority:0, f990c0ed-f7f2-4f8a-8ec9-db097d9c855e|rpc:127.0.0.1:44595|dataStream:|priority:1, a9b6c243-aad2-4cee-be19-871628539a81|rpc:127.0.0.1:36351|dataStream:|priority:0], old=null
2021-10-05 13:23:58,702 [0c34be74-1f5b-4b04-a6d4-fde6c3deb89a@group-27B6D48B871B-FollowerState] INFO  impl.FollowerState (FollowerState.java:run(134)) - 0c34be74-1f5b-4b04-a6d4-fde6c3deb89a@group-27B6D48B871B-FollowerState: change to CANDIDATE, lastRpcElapsedTime:5160918462ns, electionTimeout:5160ms
2021-10-05 13:23:58,702 [0c34be74-1f5b-4b04-a6d4-fde6c3deb89a@group-27B6D48B871B-FollowerState] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(108)) - 0c34be74-1f5b-4b04-a6d4-fde6c3deb89a: shutdown 0c34be74-1f5b-4b04-a6d4-fde6c3deb89a@group-27B6D48B871B-FollowerState
2021-10-05 13:23:58,702 [0c34be74-1f5b-4b04-a6d4-fde6c3deb89a@group-27B6D48B871B-FollowerState] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(285)) - 0c34be74-1f5b-4b04-a6d4-fde6c3deb89a@group-27B6D48B871B: changes role from  FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2021-10-05 13:23:58,702 [0c34be74-1f5b-4b04-a6d4-fde6c3deb89a@group-27B6D48B871B-FollowerState] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.leaderelection.pre-vote = false (custom)
2021-10-05 13:23:58,703 [0c34be74-1f5b-4b04-a6d4-fde6c3deb89a@group-27B6D48B871B-FollowerState] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(130)) - 0c34be74-1f5b-4b04-a6d4-fde6c3deb89a: start 0c34be74-1f5b-4b04-a6d4-fde6c3deb89a@group-27B6D48B871B-LeaderElection7
2021-10-05 13:23:58,712 [0c34be74-1f5b-4b04-a6d4-fde6c3deb89a@group-27B6D48B871B-LeaderElection7] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(306)) - 0c34be74-1f5b-4b04-a6d4-fde6c3deb89a@group-27B6D48B871B-LeaderElection7 ELECTION round 0: submit vote requests at term 1 for -1: [0c34be74-1f5b-4b04-a6d4-fde6c3deb89a|rpc:127.0.0.1:33359|priority:1], old=null
2021-10-05 13:23:58,713 [0c34be74-1f5b-4b04-a6d4-fde6c3deb89a@group-27B6D48B871B-LeaderElection7] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(308)) - 0c34be74-1f5b-4b04-a6d4-fde6c3deb89a@group-27B6D48B871B-LeaderElection7 ELECTION round 0: result PASSED (term=1)
2021-10-05 13:23:58,713 [0c34be74-1f5b-4b04-a6d4-fde6c3deb89a@group-27B6D48B871B-LeaderElection7] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(121)) - 0c34be74-1f5b-4b04-a6d4-fde6c3deb89a: shutdown 0c34be74-1f5b-4b04-a6d4-fde6c3deb89a@group-27B6D48B871B-LeaderElection7
2021-10-05 13:23:58,713 [0c34be74-1f5b-4b04-a6d4-fde6c3deb89a@group-27B6D48B871B-LeaderElection7] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(285)) - 0c34be74-1f5b-4b04-a6d4-fde6c3deb89a@group-27B6D48B871B: changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2021-10-05 13:23:58,713 [0c34be74-1f5b-4b04-a6d4-fde6c3deb89a@group-27B6D48B871B-LeaderElection7] INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:handleLeaderChangedNotification(861)) - Leader change notification received for group: group-27B6D48B871B with new leaderId: 0c34be74-1f5b-4b04-a6d4-fde6c3deb89a
2021-10-05 13:23:58,713 [0c34be74-1f5b-4b04-a6d4-fde6c3deb89a@group-27B6D48B871B-LeaderElection7] INFO  server.RaftServer$Division (ServerState.java:setLeader(285)) - 0c34be74-1f5b-4b04-a6d4-fde6c3deb89a@group-27B6D48B871B: change Leader from null to 0c34be74-1f5b-4b04-a6d4-fde6c3deb89a at term 1 for becomeLeader, leader elected after 5212ms
2021-10-05 13:23:58,713 [0c34be74-1f5b-4b04-a6d4-fde6c3deb89a@group-27B6D48B871B-LeaderElection7] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.staging.catchup.gap = 1000 (default)
2021-10-05 13:23:58,715 [0c34be74-1f5b-4b04-a6d4-fde6c3deb89a@group-27B6D48B871B-LeaderElection7] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.write.element-limit = 1024 (custom)
2021-10-05 13:23:58,715 [0c34be74-1f5b-4b04-a6d4-fde6c3deb89a@group-27B6D48B871B-LeaderElection7] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.write.byte-limit = 1024 M (=1073741824) (custom)
2021-10-05 13:23:58,715 [EventQueue-OpenPipelineForHealthyPipelineSafeModeRule] INFO  safemode.SCMSafeModeManager (HealthyPipelineSafeModeRule.java:process(124)) - SCM in safe mode. Healthy pipelines reported count is 0, required healthy pipeline reported count is 1
2021-10-05 13:23:58,716 [EventQueue-OpenPipelineForHealthyPipelineSafeModeRule] INFO  safemode.SCMSafeModeManager (HealthyPipelineSafeModeRule.java:process(124)) - SCM in safe mode. Healthy pipelines reported count is 0, required healthy pipeline reported count is 1
2021-10-05 13:23:58,718 [0c34be74-1f5b-4b04-a6d4-fde6c3deb89a@group-27B6D48B871B-LeaderElection7] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.watch.timeout = 180s (custom)
2021-10-05 13:23:58,718 [0c34be74-1f5b-4b04-a6d4-fde6c3deb89a@group-27B6D48B871B-LeaderElection7] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.watch.timeout.denomination = 1s (default)
2021-10-05 13:23:58,718 [0c34be74-1f5b-4b04-a6d4-fde6c3deb89a@group-27B6D48B871B-LeaderElection7] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.watch.element-limit = 65536 (default)
2021-10-05 13:23:58,718 [0c34be74-1f5b-4b04-a6d4-fde6c3deb89a@group-27B6D48B871B-LeaderElection7] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(130)) - 0c34be74-1f5b-4b04-a6d4-fde6c3deb89a: start 0c34be74-1f5b-4b04-a6d4-fde6c3deb89a@group-27B6D48B871B-LeaderStateImpl
2021-10-05 13:23:58,718 [0c34be74-1f5b-4b04-a6d4-fde6c3deb89a@group-27B6D48B871B-LeaderElection7] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:startLogSegment(394)) - 0c34be74-1f5b-4b04-a6d4-fde6c3deb89a@group-27B6D48B871B-SegmentedRaftLogWorker: Starting segment from index:0
2021-10-05 13:23:58,720 [0c34be74-1f5b-4b04-a6d4-fde6c3deb89a@group-27B6D48B871B-LeaderElection7] INFO  server.RaftServer$Division (ServerState.java:setRaftConf(387)) - 0c34be74-1f5b-4b04-a6d4-fde6c3deb89a@group-27B6D48B871B: set configuration 0: [0c34be74-1f5b-4b04-a6d4-fde6c3deb89a|rpc:127.0.0.1:33359|dataStream:|priority:1], old=null
2021-10-05 13:23:58,721 [0c34be74-1f5b-4b04-a6d4-fde6c3deb89a@group-27B6D48B871B-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(601)) - 0c34be74-1f5b-4b04-a6d4-fde6c3deb89a@group-27B6D48B871B-SegmentedRaftLogWorker: created new log segment /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-98f4f1fb-613f-4a4a-83a3-c748f4b4520d/datanode-1/data/ratis/a2e217e3-801c-4062-af76-27b6d48b871b/current/log_inprogress_0
2021-10-05 13:23:58,820 [Listener at 127.0.0.1/10356] INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(235)) - Nodes are ready. Got 3 of 3 DN Heartbeats.
2021-10-05 13:23:58,820 [Listener at 127.0.0.1/10356] INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(238)) - Waiting for cluster to exit safe mode
2021-10-05 13:23:58,820 [Listener at 127.0.0.1/10356] INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(240)) - SCM became leader
2021-10-05 13:23:58,971 [a9b6c243-aad2-4cee-be19-871628539a81@group-DC372A106217-FollowerState] INFO  impl.FollowerState (FollowerState.java:run(134)) - a9b6c243-aad2-4cee-be19-871628539a81@group-DC372A106217-FollowerState: change to CANDIDATE, lastRpcElapsedTime:5097994676ns, electionTimeout:5096ms
2021-10-05 13:23:58,971 [a9b6c243-aad2-4cee-be19-871628539a81@group-DC372A106217-FollowerState] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(108)) - a9b6c243-aad2-4cee-be19-871628539a81: shutdown a9b6c243-aad2-4cee-be19-871628539a81@group-DC372A106217-FollowerState
2021-10-05 13:23:58,971 [a9b6c243-aad2-4cee-be19-871628539a81@group-DC372A106217-FollowerState] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(285)) - a9b6c243-aad2-4cee-be19-871628539a81@group-DC372A106217: changes role from  FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2021-10-05 13:23:58,972 [a9b6c243-aad2-4cee-be19-871628539a81@group-DC372A106217-FollowerState] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.leaderelection.pre-vote = false (custom)
2021-10-05 13:23:58,972 [a9b6c243-aad2-4cee-be19-871628539a81@group-DC372A106217-FollowerState] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(130)) - a9b6c243-aad2-4cee-be19-871628539a81: start a9b6c243-aad2-4cee-be19-871628539a81@group-DC372A106217-LeaderElection8
2021-10-05 13:23:58,977 [a9b6c243-aad2-4cee-be19-871628539a81@group-DC372A106217-LeaderElection8] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(306)) - a9b6c243-aad2-4cee-be19-871628539a81@group-DC372A106217-LeaderElection8 ELECTION round 0: submit vote requests at term 1 for -1: [a9b6c243-aad2-4cee-be19-871628539a81|rpc:127.0.0.1:36351|priority:1], old=null
2021-10-05 13:23:58,977 [a9b6c243-aad2-4cee-be19-871628539a81@group-DC372A106217-LeaderElection8] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(308)) - a9b6c243-aad2-4cee-be19-871628539a81@group-DC372A106217-LeaderElection8 ELECTION round 0: result PASSED (term=1)
2021-10-05 13:23:58,977 [a9b6c243-aad2-4cee-be19-871628539a81@group-DC372A106217-LeaderElection8] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(121)) - a9b6c243-aad2-4cee-be19-871628539a81: shutdown a9b6c243-aad2-4cee-be19-871628539a81@group-DC372A106217-LeaderElection8
2021-10-05 13:23:58,977 [a9b6c243-aad2-4cee-be19-871628539a81@group-DC372A106217-LeaderElection8] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(285)) - a9b6c243-aad2-4cee-be19-871628539a81@group-DC372A106217: changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2021-10-05 13:23:58,977 [a9b6c243-aad2-4cee-be19-871628539a81@group-DC372A106217-LeaderElection8] INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:handleLeaderChangedNotification(861)) - Leader change notification received for group: group-DC372A106217 with new leaderId: a9b6c243-aad2-4cee-be19-871628539a81
2021-10-05 13:23:58,978 [a9b6c243-aad2-4cee-be19-871628539a81@group-DC372A106217-LeaderElection8] INFO  server.RaftServer$Division (ServerState.java:setLeader(285)) - a9b6c243-aad2-4cee-be19-871628539a81@group-DC372A106217: change Leader from null to a9b6c243-aad2-4cee-be19-871628539a81 at term 1 for becomeLeader, leader elected after 5125ms
2021-10-05 13:23:58,978 [a9b6c243-aad2-4cee-be19-871628539a81@group-DC372A106217-LeaderElection8] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.staging.catchup.gap = 1000 (default)
2021-10-05 13:23:58,978 [a9b6c243-aad2-4cee-be19-871628539a81@group-DC372A106217-LeaderElection8] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.write.element-limit = 1024 (custom)
2021-10-05 13:23:58,980 [EventQueue-OpenPipelineForHealthyPipelineSafeModeRule] INFO  safemode.SCMSafeModeManager (HealthyPipelineSafeModeRule.java:process(124)) - SCM in safe mode. Healthy pipelines reported count is 0, required healthy pipeline reported count is 1
2021-10-05 13:23:58,982 [EventQueue-OpenPipelineForHealthyPipelineSafeModeRule] INFO  safemode.SCMSafeModeManager (HealthyPipelineSafeModeRule.java:process(124)) - SCM in safe mode. Healthy pipelines reported count is 0, required healthy pipeline reported count is 1
2021-10-05 13:23:58,982 [a9b6c243-aad2-4cee-be19-871628539a81@group-DC372A106217-LeaderElection8] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.write.byte-limit = 1024 M (=1073741824) (custom)
2021-10-05 13:23:58,983 [a9b6c243-aad2-4cee-be19-871628539a81@group-DC372A106217-LeaderElection8] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.watch.timeout = 180s (custom)
2021-10-05 13:23:58,983 [a9b6c243-aad2-4cee-be19-871628539a81@group-DC372A106217-LeaderElection8] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.watch.timeout.denomination = 1s (default)
2021-10-05 13:23:58,983 [a9b6c243-aad2-4cee-be19-871628539a81@group-DC372A106217-LeaderElection8] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.watch.element-limit = 65536 (default)
2021-10-05 13:23:58,983 [a9b6c243-aad2-4cee-be19-871628539a81@group-DC372A106217-LeaderElection8] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(130)) - a9b6c243-aad2-4cee-be19-871628539a81: start a9b6c243-aad2-4cee-be19-871628539a81@group-DC372A106217-LeaderStateImpl
2021-10-05 13:23:58,983 [a9b6c243-aad2-4cee-be19-871628539a81@group-DC372A106217-LeaderElection8] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:startLogSegment(394)) - a9b6c243-aad2-4cee-be19-871628539a81@group-DC372A106217-SegmentedRaftLogWorker: Starting segment from index:0
2021-10-05 13:23:58,984 [a9b6c243-aad2-4cee-be19-871628539a81@group-DC372A106217-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(601)) - a9b6c243-aad2-4cee-be19-871628539a81@group-DC372A106217-SegmentedRaftLogWorker: created new log segment /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-98f4f1fb-613f-4a4a-83a3-c748f4b4520d/datanode-2/data/ratis/422df7cd-075e-4b52-b513-dc372a106217/current/log_inprogress_0
2021-10-05 13:23:58,984 [a9b6c243-aad2-4cee-be19-871628539a81@group-DC372A106217-LeaderElection8] INFO  server.RaftServer$Division (ServerState.java:setRaftConf(387)) - a9b6c243-aad2-4cee-be19-871628539a81@group-DC372A106217: set configuration 0: [a9b6c243-aad2-4cee-be19-871628539a81|rpc:127.0.0.1:36351|dataStream:|priority:1], old=null
2021-10-05 13:23:59,714 [Datanode State Machine Thread - 0] ERROR datanode.RunningDatanodeState (RunningDatanodeState.java:computeNextContainerState(199)) - Error in executing end point task.
java.util.concurrent.ExecutionException: java.util.concurrent.TimeoutException
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.hadoop.ozone.container.common.states.datanode.RunningDatanodeState.computeNextContainerState(RunningDatanodeState.java:191)
	at org.apache.hadoop.ozone.container.common.states.datanode.RunningDatanodeState.await(RunningDatanodeState.java:231)
	at org.apache.hadoop.ozone.container.common.states.datanode.RunningDatanodeState.await(RunningDatanodeState.java:50)
	at org.apache.hadoop.ozone.container.common.statemachine.StateContext.execute(StateContext.java:629)
	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.start(DatanodeStateMachine.java:270)
	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.lambda$startDaemon$0(DatanodeStateMachine.java:457)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.util.concurrent.TimeoutException
	at java.util.concurrent.FutureTask.get(FutureTask.java:205)
	at org.apache.hadoop.ozone.container.common.states.datanode.RunningDatanodeState.lambda$execute$0(RunningDatanodeState.java:149)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
2021-10-05 13:23:59,821 [Listener at 127.0.0.1/10356] INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(235)) - Nodes are ready. Got 3 of 3 DN Heartbeats.
2021-10-05 13:23:59,821 [Listener at 127.0.0.1/10356] INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(238)) - Waiting for cluster to exit safe mode
2021-10-05 13:23:59,821 [Listener at 127.0.0.1/10356] INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(240)) - SCM became leader
2021-10-05 13:24:00,822 [Listener at 127.0.0.1/10356] INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(235)) - Nodes are ready. Got 3 of 3 DN Heartbeats.
2021-10-05 13:24:00,822 [Listener at 127.0.0.1/10356] INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(238)) - Waiting for cluster to exit safe mode
2021-10-05 13:24:00,822 [Listener at 127.0.0.1/10356] INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(240)) - SCM became leader
2021-10-05 13:24:01,717 [Datanode State Machine Thread - 0] ERROR datanode.RunningDatanodeState (RunningDatanodeState.java:computeNextContainerState(199)) - Error in executing end point task.
java.util.concurrent.ExecutionException: java.util.concurrent.TimeoutException
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.hadoop.ozone.container.common.states.datanode.RunningDatanodeState.computeNextContainerState(RunningDatanodeState.java:191)
	at org.apache.hadoop.ozone.container.common.states.datanode.RunningDatanodeState.await(RunningDatanodeState.java:231)
	at org.apache.hadoop.ozone.container.common.states.datanode.RunningDatanodeState.await(RunningDatanodeState.java:50)
	at org.apache.hadoop.ozone.container.common.statemachine.StateContext.execute(StateContext.java:629)
	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.start(DatanodeStateMachine.java:270)
	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.lambda$startDaemon$0(DatanodeStateMachine.java:457)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.util.concurrent.TimeoutException
	at java.util.concurrent.FutureTask.get(FutureTask.java:205)
	at org.apache.hadoop.ozone.container.common.states.datanode.RunningDatanodeState.lambda$execute$0(RunningDatanodeState.java:149)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
2021-10-05 13:24:01,823 [Listener at 127.0.0.1/10356] INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(235)) - Nodes are ready. Got 3 of 3 DN Heartbeats.
2021-10-05 13:24:01,823 [Listener at 127.0.0.1/10356] INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(238)) - Waiting for cluster to exit safe mode
2021-10-05 13:24:01,823 [Listener at 127.0.0.1/10356] INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(240)) - SCM became leader
2021-10-05 13:24:02,824 [Listener at 127.0.0.1/10356] INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(235)) - Nodes are ready. Got 3 of 3 DN Heartbeats.
2021-10-05 13:24:02,824 [Listener at 127.0.0.1/10356] INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(238)) - Waiting for cluster to exit safe mode
2021-10-05 13:24:02,825 [Listener at 127.0.0.1/10356] INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(240)) - SCM became leader
2021-10-05 13:24:02,979 [Datanode State Machine Thread - 0] ERROR datanode.RunningDatanodeState (RunningDatanodeState.java:computeNextContainerState(199)) - Error in executing end point task.
java.util.concurrent.ExecutionException: java.util.concurrent.TimeoutException
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.hadoop.ozone.container.common.states.datanode.RunningDatanodeState.computeNextContainerState(RunningDatanodeState.java:191)
	at org.apache.hadoop.ozone.container.common.states.datanode.RunningDatanodeState.await(RunningDatanodeState.java:231)
	at org.apache.hadoop.ozone.container.common.states.datanode.RunningDatanodeState.await(RunningDatanodeState.java:50)
	at org.apache.hadoop.ozone.container.common.statemachine.StateContext.execute(StateContext.java:629)
	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.start(DatanodeStateMachine.java:270)
	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.lambda$startDaemon$0(DatanodeStateMachine.java:457)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.util.concurrent.TimeoutException
	at java.util.concurrent.FutureTask.get(FutureTask.java:205)
	at org.apache.hadoop.ozone.container.common.states.datanode.RunningDatanodeState.lambda$execute$0(RunningDatanodeState.java:149)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
2021-10-05 13:24:03,624 [f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-52E96576A6DB-FollowerState] INFO  impl.FollowerState (FollowerState.java:run(134)) - f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-52E96576A6DB-FollowerState: change to CANDIDATE, lastRpcElapsedTime:5063171950ns, electionTimeout:5060ms
2021-10-05 13:24:03,625 [f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-52E96576A6DB-FollowerState] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(108)) - f990c0ed-f7f2-4f8a-8ec9-db097d9c855e: shutdown f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-52E96576A6DB-FollowerState
2021-10-05 13:24:03,625 [f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-52E96576A6DB-FollowerState] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(285)) - f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-52E96576A6DB: changes role from  FOLLOWER to CANDIDATE at term 1 for changeToCandidate
2021-10-05 13:24:03,625 [f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-52E96576A6DB-FollowerState] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.leaderelection.pre-vote = false (custom)
2021-10-05 13:24:03,625 [f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-52E96576A6DB-FollowerState] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(130)) - f990c0ed-f7f2-4f8a-8ec9-db097d9c855e: start f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-52E96576A6DB-LeaderElection9
2021-10-05 13:24:03,628 [f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-52E96576A6DB-LeaderElection9] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(306)) - f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-52E96576A6DB-LeaderElection9 ELECTION round 0: submit vote requests at term 2 for -1: [0c34be74-1f5b-4b04-a6d4-fde6c3deb89a|rpc:127.0.0.1:33359|priority:0, f990c0ed-f7f2-4f8a-8ec9-db097d9c855e|rpc:127.0.0.1:44595|priority:0, a9b6c243-aad2-4cee-be19-871628539a81|rpc:127.0.0.1:36351|priority:1], old=null
2021-10-05 13:24:03,636 [grpc-default-executor-1] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1043)) - 0c34be74-1f5b-4b04-a6d4-fde6c3deb89a@group-52E96576A6DB: receive requestVote(ELECTION, f990c0ed-f7f2-4f8a-8ec9-db097d9c855e, group-52E96576A6DB, 2, (t:0, i:0))
2021-10-05 13:24:03,636 [grpc-default-executor-1] INFO  impl.VoteContext (VoteContext.java:log(48)) - 0c34be74-1f5b-4b04-a6d4-fde6c3deb89a@group-52E96576A6DB-FOLLOWER: accept ELECTION from f990c0ed-f7f2-4f8a-8ec9-db097d9c855e: our priority 0 <= candidate's priority 0
2021-10-05 13:24:03,636 [grpc-default-executor-1] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(285)) - 0c34be74-1f5b-4b04-a6d4-fde6c3deb89a@group-52E96576A6DB: changes role from  FOLLOWER to FOLLOWER at term 2 for candidate:f990c0ed-f7f2-4f8a-8ec9-db097d9c855e
2021-10-05 13:24:03,636 [grpc-default-executor-1] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(108)) - 0c34be74-1f5b-4b04-a6d4-fde6c3deb89a: shutdown 0c34be74-1f5b-4b04-a6d4-fde6c3deb89a@group-52E96576A6DB-FollowerState
2021-10-05 13:24:03,636 [grpc-default-executor-1] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(130)) - 0c34be74-1f5b-4b04-a6d4-fde6c3deb89a: start 0c34be74-1f5b-4b04-a6d4-fde6c3deb89a@group-52E96576A6DB-FollowerState
2021-10-05 13:24:03,637 [grpc-default-executor-0] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1043)) - a9b6c243-aad2-4cee-be19-871628539a81@group-52E96576A6DB: receive requestVote(ELECTION, f990c0ed-f7f2-4f8a-8ec9-db097d9c855e, group-52E96576A6DB, 2, (t:0, i:0))
2021-10-05 13:24:03,637 [0c34be74-1f5b-4b04-a6d4-fde6c3deb89a@group-52E96576A6DB-FollowerState] INFO  impl.FollowerState (FollowerState.java:run(143)) - 0c34be74-1f5b-4b04-a6d4-fde6c3deb89a@group-52E96576A6DB-FollowerState was interrupted: {}
java.lang.InterruptedException: sleep interrupted
	at java.lang.Thread.sleep(Native Method)
	at java.lang.Thread.sleep(Thread.java:340)
	at java.util.concurrent.TimeUnit.sleep(TimeUnit.java:386)
	at org.apache.ratis.util.TimeDuration.sleep(TimeDuration.java:324)
	at org.apache.ratis.util.TimeDuration.sleep(TimeDuration.java:309)
	at org.apache.ratis.server.impl.FollowerState.run(FollowerState.java:118)
2021-10-05 13:24:03,647 [grpc-default-executor-0] INFO  impl.VoteContext (VoteContext.java:log(48)) - a9b6c243-aad2-4cee-be19-871628539a81@group-52E96576A6DB-FOLLOWER: reject ELECTION from f990c0ed-f7f2-4f8a-8ec9-db097d9c855e: our priority 1 > candidate's priority 0
2021-10-05 13:24:03,648 [grpc-default-executor-0] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(285)) - a9b6c243-aad2-4cee-be19-871628539a81@group-52E96576A6DB: changes role from  FOLLOWER to FOLLOWER at term 2 for candidate:f990c0ed-f7f2-4f8a-8ec9-db097d9c855e
2021-10-05 13:24:03,648 [grpc-default-executor-0] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(108)) - a9b6c243-aad2-4cee-be19-871628539a81: shutdown a9b6c243-aad2-4cee-be19-871628539a81@group-52E96576A6DB-FollowerState
2021-10-05 13:24:03,648 [grpc-default-executor-0] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(130)) - a9b6c243-aad2-4cee-be19-871628539a81: start a9b6c243-aad2-4cee-be19-871628539a81@group-52E96576A6DB-FollowerState
2021-10-05 13:24:03,648 [grpc-default-executor-1] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1075)) - 0c34be74-1f5b-4b04-a6d4-fde6c3deb89a@group-52E96576A6DB replies to ELECTION vote request: f990c0ed-f7f2-4f8a-8ec9-db097d9c855e<-0c34be74-1f5b-4b04-a6d4-fde6c3deb89a#0:OK-t2. Peer's state: 0c34be74-1f5b-4b04-a6d4-fde6c3deb89a@group-52E96576A6DB:t2, leader=null, voted=f990c0ed-f7f2-4f8a-8ec9-db097d9c855e, raftlog=0c34be74-1f5b-4b04-a6d4-fde6c3deb89a@group-52E96576A6DB-SegmentedRaftLog:OPENED:c-1,f-1,i0, conf=-1: [0c34be74-1f5b-4b04-a6d4-fde6c3deb89a|rpc:127.0.0.1:33359|dataStream:|priority:0, f990c0ed-f7f2-4f8a-8ec9-db097d9c855e|rpc:127.0.0.1:44595|dataStream:|priority:0, a9b6c243-aad2-4cee-be19-871628539a81|rpc:127.0.0.1:36351|dataStream:|priority:1], old=null
2021-10-05 13:24:03,649 [a9b6c243-aad2-4cee-be19-871628539a81@group-52E96576A6DB-FollowerState] INFO  impl.FollowerState (FollowerState.java:run(143)) - a9b6c243-aad2-4cee-be19-871628539a81@group-52E96576A6DB-FollowerState was interrupted: {}
java.lang.InterruptedException: sleep interrupted
	at java.lang.Thread.sleep(Native Method)
	at java.lang.Thread.sleep(Thread.java:340)
	at java.util.concurrent.TimeUnit.sleep(TimeUnit.java:386)
	at org.apache.ratis.util.TimeDuration.sleep(TimeDuration.java:324)
	at org.apache.ratis.util.TimeDuration.sleep(TimeDuration.java:309)
	at org.apache.ratis.server.impl.FollowerState.run(FollowerState.java:118)
2021-10-05 13:24:03,651 [grpc-default-executor-0] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1075)) - a9b6c243-aad2-4cee-be19-871628539a81@group-52E96576A6DB replies to ELECTION vote request: f990c0ed-f7f2-4f8a-8ec9-db097d9c855e<-a9b6c243-aad2-4cee-be19-871628539a81#0:FAIL-t2. Peer's state: a9b6c243-aad2-4cee-be19-871628539a81@group-52E96576A6DB:t2, leader=null, voted=null, raftlog=a9b6c243-aad2-4cee-be19-871628539a81@group-52E96576A6DB-SegmentedRaftLog:OPENED:c-1,f-1,i0, conf=-1: [0c34be74-1f5b-4b04-a6d4-fde6c3deb89a|rpc:127.0.0.1:33359|dataStream:|priority:0, f990c0ed-f7f2-4f8a-8ec9-db097d9c855e|rpc:127.0.0.1:44595|dataStream:|priority:0, a9b6c243-aad2-4cee-be19-871628539a81|rpc:127.0.0.1:36351|dataStream:|priority:1], old=null
2021-10-05 13:24:03,657 [f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-52E96576A6DB-LeaderElection9] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(89)) - f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-52E96576A6DB-LeaderElection9: ELECTION REJECTED received 2 response(s) and 0 exception(s):
2021-10-05 13:24:03,657 [f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-52E96576A6DB-LeaderElection9] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(93)) -   Response 0: f990c0ed-f7f2-4f8a-8ec9-db097d9c855e<-0c34be74-1f5b-4b04-a6d4-fde6c3deb89a#0:OK-t2
2021-10-05 13:24:03,657 [f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-52E96576A6DB-LeaderElection9] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(93)) -   Response 1: f990c0ed-f7f2-4f8a-8ec9-db097d9c855e<-a9b6c243-aad2-4cee-be19-871628539a81#0:FAIL-t2
2021-10-05 13:24:03,657 [f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-52E96576A6DB-LeaderElection9] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(308)) - f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-52E96576A6DB-LeaderElection9 ELECTION round 0: result REJECTED
2021-10-05 13:24:03,657 [f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-52E96576A6DB-LeaderElection9] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(285)) - f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-52E96576A6DB: changes role from CANDIDATE to FOLLOWER at term 2 for REJECTED
2021-10-05 13:24:03,657 [f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-52E96576A6DB-LeaderElection9] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(121)) - f990c0ed-f7f2-4f8a-8ec9-db097d9c855e: shutdown f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-52E96576A6DB-LeaderElection9
2021-10-05 13:24:03,658 [f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-52E96576A6DB-LeaderElection9] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(130)) - f990c0ed-f7f2-4f8a-8ec9-db097d9c855e: start f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-52E96576A6DB-FollowerState
2021-10-05 13:24:03,725 [Datanode State Machine Thread - 0] ERROR datanode.RunningDatanodeState (RunningDatanodeState.java:computeNextContainerState(199)) - Error in executing end point task.
java.util.concurrent.ExecutionException: java.util.concurrent.TimeoutException
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.hadoop.ozone.container.common.states.datanode.RunningDatanodeState.computeNextContainerState(RunningDatanodeState.java:191)
	at org.apache.hadoop.ozone.container.common.states.datanode.RunningDatanodeState.await(RunningDatanodeState.java:231)
	at org.apache.hadoop.ozone.container.common.states.datanode.RunningDatanodeState.await(RunningDatanodeState.java:50)
	at org.apache.hadoop.ozone.container.common.statemachine.StateContext.execute(StateContext.java:629)
	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.start(DatanodeStateMachine.java:270)
	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.lambda$startDaemon$0(DatanodeStateMachine.java:457)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.util.concurrent.TimeoutException
	at java.util.concurrent.FutureTask.get(FutureTask.java:205)
	at org.apache.hadoop.ozone.container.common.states.datanode.RunningDatanodeState.lambda$execute$0(RunningDatanodeState.java:149)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
2021-10-05 13:24:03,740 [f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-D8E46993F0F1-FollowerState] INFO  impl.FollowerState (FollowerState.java:run(134)) - f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-D8E46993F0F1-FollowerState: change to CANDIDATE, lastRpcElapsedTime:5136879424ns, electionTimeout:5132ms
2021-10-05 13:24:03,741 [f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-D8E46993F0F1-FollowerState] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(108)) - f990c0ed-f7f2-4f8a-8ec9-db097d9c855e: shutdown f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-D8E46993F0F1-FollowerState
2021-10-05 13:24:03,741 [f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-D8E46993F0F1-FollowerState] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(285)) - f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-D8E46993F0F1: changes role from  FOLLOWER to CANDIDATE at term 1 for changeToCandidate
2021-10-05 13:24:03,741 [f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-D8E46993F0F1-FollowerState] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.leaderelection.pre-vote = false (custom)
2021-10-05 13:24:03,741 [f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-D8E46993F0F1-FollowerState] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(130)) - f990c0ed-f7f2-4f8a-8ec9-db097d9c855e: start f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-D8E46993F0F1-LeaderElection10
2021-10-05 13:24:03,743 [f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-D8E46993F0F1-LeaderElection10] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(306)) - f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-D8E46993F0F1-LeaderElection10 ELECTION round 0: submit vote requests at term 2 for -1: [0c34be74-1f5b-4b04-a6d4-fde6c3deb89a|rpc:127.0.0.1:33359|dataStream:|priority:0, f990c0ed-f7f2-4f8a-8ec9-db097d9c855e|rpc:127.0.0.1:44595|dataStream:|priority:1, a9b6c243-aad2-4cee-be19-871628539a81|rpc:127.0.0.1:36351|dataStream:|priority:0], old=null
2021-10-05 13:24:03,754 [grpc-default-executor-0] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1043)) - 0c34be74-1f5b-4b04-a6d4-fde6c3deb89a@group-D8E46993F0F1: receive requestVote(ELECTION, f990c0ed-f7f2-4f8a-8ec9-db097d9c855e, group-D8E46993F0F1, 2, (t:0, i:0))
2021-10-05 13:24:03,754 [grpc-default-executor-0] INFO  impl.VoteContext (VoteContext.java:log(48)) - 0c34be74-1f5b-4b04-a6d4-fde6c3deb89a@group-D8E46993F0F1-FOLLOWER: accept ELECTION from f990c0ed-f7f2-4f8a-8ec9-db097d9c855e: our priority 0 <= candidate's priority 1
2021-10-05 13:24:03,754 [grpc-default-executor-0] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(285)) - 0c34be74-1f5b-4b04-a6d4-fde6c3deb89a@group-D8E46993F0F1: changes role from  FOLLOWER to FOLLOWER at term 2 for candidate:f990c0ed-f7f2-4f8a-8ec9-db097d9c855e
2021-10-05 13:24:03,754 [grpc-default-executor-0] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(108)) - 0c34be74-1f5b-4b04-a6d4-fde6c3deb89a: shutdown 0c34be74-1f5b-4b04-a6d4-fde6c3deb89a@group-D8E46993F0F1-FollowerState
2021-10-05 13:24:03,754 [grpc-default-executor-0] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(130)) - 0c34be74-1f5b-4b04-a6d4-fde6c3deb89a: start 0c34be74-1f5b-4b04-a6d4-fde6c3deb89a@group-D8E46993F0F1-FollowerState
2021-10-05 13:24:03,754 [0c34be74-1f5b-4b04-a6d4-fde6c3deb89a@group-D8E46993F0F1-FollowerState] INFO  impl.FollowerState (FollowerState.java:run(143)) - 0c34be74-1f5b-4b04-a6d4-fde6c3deb89a@group-D8E46993F0F1-FollowerState was interrupted: {}
java.lang.InterruptedException: sleep interrupted
	at java.lang.Thread.sleep(Native Method)
	at java.lang.Thread.sleep(Thread.java:340)
	at java.util.concurrent.TimeUnit.sleep(TimeUnit.java:386)
	at org.apache.ratis.util.TimeDuration.sleep(TimeDuration.java:324)
	at org.apache.ratis.util.TimeDuration.sleep(TimeDuration.java:309)
	at org.apache.ratis.server.impl.FollowerState.run(FollowerState.java:118)
2021-10-05 13:24:03,756 [grpc-default-executor-0] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1075)) - 0c34be74-1f5b-4b04-a6d4-fde6c3deb89a@group-D8E46993F0F1 replies to ELECTION vote request: f990c0ed-f7f2-4f8a-8ec9-db097d9c855e<-0c34be74-1f5b-4b04-a6d4-fde6c3deb89a#0:OK-t2. Peer's state: 0c34be74-1f5b-4b04-a6d4-fde6c3deb89a@group-D8E46993F0F1:t2, leader=null, voted=f990c0ed-f7f2-4f8a-8ec9-db097d9c855e, raftlog=0c34be74-1f5b-4b04-a6d4-fde6c3deb89a@group-D8E46993F0F1-SegmentedRaftLog:OPENED:c-1,f-1,i0, conf=-1: [0c34be74-1f5b-4b04-a6d4-fde6c3deb89a|rpc:127.0.0.1:33359|priority:0, f990c0ed-f7f2-4f8a-8ec9-db097d9c855e|rpc:127.0.0.1:44595|priority:1, a9b6c243-aad2-4cee-be19-871628539a81|rpc:127.0.0.1:36351|priority:0], old=null
2021-10-05 13:24:03,760 [grpc-default-executor-0] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1043)) - a9b6c243-aad2-4cee-be19-871628539a81@group-D8E46993F0F1: receive requestVote(ELECTION, f990c0ed-f7f2-4f8a-8ec9-db097d9c855e, group-D8E46993F0F1, 2, (t:0, i:0))
2021-10-05 13:24:03,760 [f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-D8E46993F0F1-LeaderElection10] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(89)) - f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-D8E46993F0F1-LeaderElection10: ELECTION PASSED received 1 response(s) and 0 exception(s):
2021-10-05 13:24:03,760 [f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-D8E46993F0F1-LeaderElection10] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(93)) -   Response 0: f990c0ed-f7f2-4f8a-8ec9-db097d9c855e<-0c34be74-1f5b-4b04-a6d4-fde6c3deb89a#0:OK-t2
2021-10-05 13:24:03,760 [grpc-default-executor-0] INFO  impl.VoteContext (VoteContext.java:log(48)) - a9b6c243-aad2-4cee-be19-871628539a81@group-D8E46993F0F1-FOLLOWER: accept ELECTION from f990c0ed-f7f2-4f8a-8ec9-db097d9c855e: our priority 0 <= candidate's priority 1
2021-10-05 13:24:03,761 [grpc-default-executor-0] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(285)) - a9b6c243-aad2-4cee-be19-871628539a81@group-D8E46993F0F1: changes role from  FOLLOWER to FOLLOWER at term 2 for candidate:f990c0ed-f7f2-4f8a-8ec9-db097d9c855e
2021-10-05 13:24:03,761 [grpc-default-executor-0] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(108)) - a9b6c243-aad2-4cee-be19-871628539a81: shutdown a9b6c243-aad2-4cee-be19-871628539a81@group-D8E46993F0F1-FollowerState
2021-10-05 13:24:03,761 [f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-D8E46993F0F1-LeaderElection10] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(308)) - f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-D8E46993F0F1-LeaderElection10 ELECTION round 0: result PASSED
2021-10-05 13:24:03,761 [grpc-default-executor-0] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(130)) - a9b6c243-aad2-4cee-be19-871628539a81: start a9b6c243-aad2-4cee-be19-871628539a81@group-D8E46993F0F1-FollowerState
2021-10-05 13:24:03,761 [f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-D8E46993F0F1-LeaderElection10] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(121)) - f990c0ed-f7f2-4f8a-8ec9-db097d9c855e: shutdown f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-D8E46993F0F1-LeaderElection10
2021-10-05 13:24:03,761 [a9b6c243-aad2-4cee-be19-871628539a81@group-D8E46993F0F1-FollowerState] INFO  impl.FollowerState (FollowerState.java:run(143)) - a9b6c243-aad2-4cee-be19-871628539a81@group-D8E46993F0F1-FollowerState was interrupted: {}
java.lang.InterruptedException: sleep interrupted
	at java.lang.Thread.sleep(Native Method)
	at java.lang.Thread.sleep(Thread.java:340)
	at java.util.concurrent.TimeUnit.sleep(TimeUnit.java:386)
	at org.apache.ratis.util.TimeDuration.sleep(TimeDuration.java:324)
	at org.apache.ratis.util.TimeDuration.sleep(TimeDuration.java:309)
	at org.apache.ratis.server.impl.FollowerState.run(FollowerState.java:118)
2021-10-05 13:24:03,761 [f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-D8E46993F0F1-LeaderElection10] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(285)) - f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-D8E46993F0F1: changes role from CANDIDATE to LEADER at term 2 for changeToLeader
2021-10-05 13:24:03,761 [f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-D8E46993F0F1-LeaderElection10] INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:handleLeaderChangedNotification(861)) - Leader change notification received for group: group-D8E46993F0F1 with new leaderId: f990c0ed-f7f2-4f8a-8ec9-db097d9c855e
2021-10-05 13:24:03,761 [f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-D8E46993F0F1-LeaderElection10] INFO  server.RaftServer$Division (ServerState.java:setLeader(285)) - f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-D8E46993F0F1: change Leader from null to f990c0ed-f7f2-4f8a-8ec9-db097d9c855e at term 2 for becomeLeader, leader elected after 10183ms
2021-10-05 13:24:03,761 [f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-D8E46993F0F1-LeaderElection10] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.staging.catchup.gap = 1000 (default)
2021-10-05 13:24:03,763 [f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-D8E46993F0F1-LeaderElection10] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.write.element-limit = 1024 (custom)
2021-10-05 13:24:03,763 [f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-D8E46993F0F1-LeaderElection10] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.write.byte-limit = 1024 M (=1073741824) (custom)
2021-10-05 13:24:03,763 [f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-D8E46993F0F1-LeaderElection10] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.watch.timeout = 180s (custom)
2021-10-05 13:24:03,764 [f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-D8E46993F0F1-LeaderElection10] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.watch.timeout.denomination = 1s (default)
2021-10-05 13:24:03,764 [f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-D8E46993F0F1-LeaderElection10] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.watch.element-limit = 65536 (default)
2021-10-05 13:24:03,764 [f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-D8E46993F0F1-LeaderElection10] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2021-10-05 13:24:03,764 [f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-D8E46993F0F1-LeaderElection10] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2021-10-05 13:24:03,764 [f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-D8E46993F0F1-LeaderElection10] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.appender.buffer.element-limit = 1 (custom)
2021-10-05 13:24:03,764 [f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-D8E46993F0F1-LeaderElection10] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(44)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2021-10-05 13:24:03,764 [f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-D8E46993F0F1-LeaderElection10] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.request.timeout = 60s (custom)
2021-10-05 13:24:03,766 [f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-D8E46993F0F1-LeaderElection10] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.appender.install.snapshot.enabled = false (custom)
2021-10-05 13:24:03,767 [f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-D8E46993F0F1-LeaderElection10] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2021-10-05 13:24:03,767 [f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-D8E46993F0F1-LeaderElection10] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2021-10-05 13:24:03,767 [f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-D8E46993F0F1-LeaderElection10] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.appender.buffer.element-limit = 1 (custom)
2021-10-05 13:24:03,767 [f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-D8E46993F0F1-LeaderElection10] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(44)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2021-10-05 13:24:03,767 [f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-D8E46993F0F1-LeaderElection10] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.request.timeout = 60s (custom)
2021-10-05 13:24:03,767 [f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-D8E46993F0F1-LeaderElection10] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.appender.install.snapshot.enabled = false (custom)
2021-10-05 13:24:03,768 [f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-D8E46993F0F1-LeaderElection10] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(130)) - f990c0ed-f7f2-4f8a-8ec9-db097d9c855e: start f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-D8E46993F0F1-LeaderStateImpl
2021-10-05 13:24:03,768 [f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-D8E46993F0F1-LeaderElection10] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:startLogSegment(394)) - f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-D8E46993F0F1-SegmentedRaftLogWorker: Starting segment from index:0
2021-10-05 13:24:03,765 [EventQueue-PipelineReportForPipelineReportHandler] INFO  pipeline.PipelineManagerImpl (PipelineManagerImpl.java:openPipeline(282)) - Pipeline Pipeline[ Id: 90899f2e-5ed2-48cb-9677-d8e46993f0f1, Nodes: f990c0ed-f7f2-4f8a-8ec9-db097d9c855e{ip: 127.0.0.1, host: localhost, ports: [REPLICATION=39769, RATIS=44595, RATIS_ADMIN=44595, RATIS_SERVER=44595, STANDALONE=39009], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}a9b6c243-aad2-4cee-be19-871628539a81{ip: 127.0.0.1, host: localhost, ports: [REPLICATION=45095, RATIS=36351, RATIS_ADMIN=36351, RATIS_SERVER=36351, STANDALONE=33273], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}0c34be74-1f5b-4b04-a6d4-fde6c3deb89a{ip: 127.0.0.1, host: localhost, ports: [REPLICATION=46311, RATIS=33359, RATIS_ADMIN=33359, RATIS_SERVER=33359, STANDALONE=44513], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}, ReplicationConfig: RATIS/THREE, State:ALLOCATED, leaderId:f990c0ed-f7f2-4f8a-8ec9-db097d9c855e, CreationTimestamp2021-10-05T13:23:50.886Z[Etc/UTC]] moved to OPEN state
2021-10-05 13:24:03,765 [EventQueue-OpenPipelineForHealthyPipelineSafeModeRule] INFO  safemode.SCMSafeModeManager (HealthyPipelineSafeModeRule.java:process(124)) - SCM in safe mode. Healthy pipelines reported count is 0, required healthy pipeline reported count is 1
2021-10-05 13:24:03,764 [EventQueue-OpenPipelineForHealthyPipelineSafeModeRule] INFO  safemode.SCMSafeModeManager (HealthyPipelineSafeModeRule.java:process(124)) - SCM in safe mode. Healthy pipelines reported count is 0, required healthy pipeline reported count is 1
2021-10-05 13:24:03,764 [EventQueue-PipelineReportForPipelineReportHandler] INFO  pipeline.PipelineManagerImpl (PipelineManagerImpl.java:openPipeline(282)) - Pipeline Pipeline[ Id: 90899f2e-5ed2-48cb-9677-d8e46993f0f1, Nodes: f990c0ed-f7f2-4f8a-8ec9-db097d9c855e{ip: 127.0.0.1, host: localhost, ports: [REPLICATION=39769, RATIS=44595, RATIS_ADMIN=44595, RATIS_SERVER=44595, STANDALONE=39009], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}a9b6c243-aad2-4cee-be19-871628539a81{ip: 127.0.0.1, host: localhost, ports: [REPLICATION=45095, RATIS=36351, RATIS_ADMIN=36351, RATIS_SERVER=36351, STANDALONE=33273], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}0c34be74-1f5b-4b04-a6d4-fde6c3deb89a{ip: 127.0.0.1, host: localhost, ports: [REPLICATION=46311, RATIS=33359, RATIS_ADMIN=33359, RATIS_SERVER=33359, STANDALONE=44513], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}, ReplicationConfig: RATIS/THREE, State:ALLOCATED, leaderId:f990c0ed-f7f2-4f8a-8ec9-db097d9c855e, CreationTimestamp2021-10-05T13:23:50.886Z[Etc/UTC]] moved to OPEN state
2021-10-05 13:24:03,785 [EventQueue-PipelineReportForPipelineReportHandler] INFO  ha.SCMHAInvocationHandler (SCMHAInvocationHandler.java:invokeRatis(113)) - Invoking method public abstract void org.apache.hadoop.hdds.scm.pipeline.PipelineStateManager.updatePipelineState(org.apache.hadoop.hdds.protocol.proto.HddsProtos$PipelineID,org.apache.hadoop.hdds.protocol.proto.HddsProtos$PipelineState) throws java.io.IOException on target org.apache.hadoop.hdds.scm.ha.SCMRatisServerImpl@4caa9da2, cost 272.128us
2021-10-05 13:24:03,773 [f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-D8E46993F0F1-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(601)) - f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-D8E46993F0F1-SegmentedRaftLogWorker: created new log segment /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-98f4f1fb-613f-4a4a-83a3-c748f4b4520d/datanode-0/data/ratis/90899f2e-5ed2-48cb-9677-d8e46993f0f1/current/log_inprogress_0
2021-10-05 13:24:03,765 [grpc-default-executor-0] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1075)) - a9b6c243-aad2-4cee-be19-871628539a81@group-D8E46993F0F1 replies to ELECTION vote request: f990c0ed-f7f2-4f8a-8ec9-db097d9c855e<-a9b6c243-aad2-4cee-be19-871628539a81#0:OK-t2. Peer's state: a9b6c243-aad2-4cee-be19-871628539a81@group-D8E46993F0F1:t2, leader=null, voted=f990c0ed-f7f2-4f8a-8ec9-db097d9c855e, raftlog=a9b6c243-aad2-4cee-be19-871628539a81@group-D8E46993F0F1-SegmentedRaftLog:OPENED:c-1,f-1,i0, conf=-1: [0c34be74-1f5b-4b04-a6d4-fde6c3deb89a|rpc:127.0.0.1:33359|dataStream:|priority:0, f990c0ed-f7f2-4f8a-8ec9-db097d9c855e|rpc:127.0.0.1:44595|dataStream:|priority:1, a9b6c243-aad2-4cee-be19-871628539a81|rpc:127.0.0.1:36351|dataStream:|priority:0], old=null
2021-10-05 13:24:03,791 [f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-D8E46993F0F1-LeaderElection10] INFO  server.RaftServer$Division (ServerState.java:setRaftConf(387)) - f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-D8E46993F0F1: set configuration 0: [0c34be74-1f5b-4b04-a6d4-fde6c3deb89a|rpc:127.0.0.1:33359|dataStream:|priority:0, f990c0ed-f7f2-4f8a-8ec9-db097d9c855e|rpc:127.0.0.1:44595|dataStream:|priority:1, a9b6c243-aad2-4cee-be19-871628539a81|rpc:127.0.0.1:36351|dataStream:|priority:0], old=null
2021-10-05 13:24:03,789 [grpc-default-executor-1] INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:handleLeaderChangedNotification(861)) - Leader change notification received for group: group-D8E46993F0F1 with new leaderId: f990c0ed-f7f2-4f8a-8ec9-db097d9c855e
2021-10-05 13:24:03,798 [grpc-default-executor-1] INFO  server.RaftServer$Division (ServerState.java:setLeader(285)) - 0c34be74-1f5b-4b04-a6d4-fde6c3deb89a@group-D8E46993F0F1: change Leader from null to f990c0ed-f7f2-4f8a-8ec9-db097d9c855e at term 2 for appendEntries, leader elected after 10234ms
2021-10-05 13:24:03,786 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  safemode.HealthyPipelineSafeModeRule (HealthyPipelineSafeModeRule.java:initializeRule(152)) - Refreshed total pipeline count is 1, healthy pipeline threshold count is 1
2021-10-05 13:24:03,798 [EventQueue-PipelineReportForPipelineReportHandler] INFO  ha.SCMHAInvocationHandler (SCMHAInvocationHandler.java:invokeRatis(113)) - Invoking method public abstract void org.apache.hadoop.hdds.scm.pipeline.PipelineStateManager.updatePipelineState(org.apache.hadoop.hdds.protocol.proto.HddsProtos$PipelineID,org.apache.hadoop.hdds.protocol.proto.HddsProtos$PipelineState) throws java.io.IOException on target org.apache.hadoop.hdds.scm.ha.SCMRatisServerImpl@6344f74b, cost 30015.247us
2021-10-05 13:24:03,799 [EventQueue-OpenPipelineForHealthyPipelineSafeModeRule] INFO  safemode.SCMSafeModeManager (HealthyPipelineSafeModeRule.java:process(124)) - SCM in safe mode. Healthy pipelines reported count is 1, required healthy pipeline reported count is 1
2021-10-05 13:24:03,799 [EventQueue-OpenPipelineForHealthyPipelineSafeModeRule] INFO  safemode.SCMSafeModeManager (SCMSafeModeManager.java:validateSafeModeExitRules(204)) - HealthyPipelineSafeModeRule rule is successfully validated
2021-10-05 13:24:03,799 [EventQueue-OpenPipelineForHealthyPipelineSafeModeRule] INFO  safemode.SCMSafeModeManager (SCMSafeModeManager.java:validateSafeModeExitRules(219)) - ScmSafeModeManager, all rules are successfully validated
2021-10-05 13:24:03,799 [EventQueue-OpenPipelineForHealthyPipelineSafeModeRule] INFO  safemode.SCMSafeModeManager (SCMSafeModeManager.java:exitSafeMode(248)) - SCM exiting safe mode.
2021-10-05 13:24:03,799 [EventQueue-OpenPipelineForHealthyPipelineSafeModeRule] WARN  events.EventQueue (EventQueue.java:fireEvent(194)) - No event handler registered for event TypedEvent{payloadType=SafeModeStatus, name='Safe mode status'}
2021-10-05 13:24:03,799 [EventQueue-OpenPipelineForHealthyPipelineSafeModeRule] INFO  ha.SCMContext (SCMContext.java:updateSafeModeStatus(205)) - Update SafeModeStatus from SafeModeStatus{safeModeStatus=true, preCheckPassed=true} to SafeModeStatus{safeModeStatus=false, preCheckPassed=true}.
2021-10-05 13:24:03,799 [EventQueue-OpenPipelineForHealthyPipelineSafeModeRule] INFO  container.ReplicationManager (ReplicationManager.java:notifyStatusChanged(1743)) - Service ReplicationManager transitions to RUNNING.
2021-10-05 13:24:03,802 [grpc-default-executor-0] INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:handleLeaderChangedNotification(861)) - Leader change notification received for group: group-D8E46993F0F1 with new leaderId: f990c0ed-f7f2-4f8a-8ec9-db097d9c855e
2021-10-05 13:24:03,802 [grpc-default-executor-0] INFO  server.RaftServer$Division (ServerState.java:setLeader(285)) - a9b6c243-aad2-4cee-be19-871628539a81@group-D8E46993F0F1: change Leader from null to f990c0ed-f7f2-4f8a-8ec9-db097d9c855e at term 2 for appendEntries, leader elected after 10142ms
2021-10-05 13:24:03,804 [grpc-default-executor-1] INFO  server.RaftServer$Division (ServerState.java:setRaftConf(387)) - 0c34be74-1f5b-4b04-a6d4-fde6c3deb89a@group-D8E46993F0F1: set configuration 0: [0c34be74-1f5b-4b04-a6d4-fde6c3deb89a|rpc:127.0.0.1:33359|dataStream:|priority:0, f990c0ed-f7f2-4f8a-8ec9-db097d9c855e|rpc:127.0.0.1:44595|dataStream:|priority:1, a9b6c243-aad2-4cee-be19-871628539a81|rpc:127.0.0.1:36351|dataStream:|priority:0], old=null
2021-10-05 13:24:03,804 [grpc-default-executor-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:startLogSegment(394)) - 0c34be74-1f5b-4b04-a6d4-fde6c3deb89a@group-D8E46993F0F1-SegmentedRaftLogWorker: Starting segment from index:0
2021-10-05 13:24:03,804 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  safemode.HealthyPipelineSafeModeRule (HealthyPipelineSafeModeRule.java:initializeRule(152)) - Refreshed total pipeline count is 1, healthy pipeline threshold count is 1
2021-10-05 13:24:03,807 [0c34be74-1f5b-4b04-a6d4-fde6c3deb89a@group-D8E46993F0F1-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(601)) - 0c34be74-1f5b-4b04-a6d4-fde6c3deb89a@group-D8E46993F0F1-SegmentedRaftLogWorker: created new log segment /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-98f4f1fb-613f-4a4a-83a3-c748f4b4520d/datanode-1/data/ratis/90899f2e-5ed2-48cb-9677-d8e46993f0f1/current/log_inprogress_0
2021-10-05 13:24:03,809 [grpc-default-executor-1] INFO  server.RaftServer$Division (ServerState.java:setRaftConf(387)) - a9b6c243-aad2-4cee-be19-871628539a81@group-D8E46993F0F1: set configuration 0: [0c34be74-1f5b-4b04-a6d4-fde6c3deb89a|rpc:127.0.0.1:33359|dataStream:|priority:0, f990c0ed-f7f2-4f8a-8ec9-db097d9c855e|rpc:127.0.0.1:44595|dataStream:|priority:1, a9b6c243-aad2-4cee-be19-871628539a81|rpc:127.0.0.1:36351|dataStream:|priority:0], old=null
2021-10-05 13:24:03,810 [grpc-default-executor-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:startLogSegment(394)) - a9b6c243-aad2-4cee-be19-871628539a81@group-D8E46993F0F1-SegmentedRaftLogWorker: Starting segment from index:0
2021-10-05 13:24:03,812 [a9b6c243-aad2-4cee-be19-871628539a81@group-D8E46993F0F1-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(601)) - a9b6c243-aad2-4cee-be19-871628539a81@group-D8E46993F0F1-SegmentedRaftLogWorker: created new log segment /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-98f4f1fb-613f-4a4a-83a3-c748f4b4520d/datanode-2/data/ratis/90899f2e-5ed2-48cb-9677-d8e46993f0f1/current/log_inprogress_0
2021-10-05 13:24:03,825 [Listener at 127.0.0.1/10356] INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(235)) - Nodes are ready. Got 3 of 3 DN Heartbeats.
2021-10-05 13:24:03,825 [Listener at 127.0.0.1/10356] INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(238)) - Cluster exits safe mode
2021-10-05 13:24:03,826 [Listener at 127.0.0.1/10356] INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(240)) - SCM became leader
2021-10-05 13:24:03,842 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  ha.SCMStateMachine (SCMStateMachine.java:takeSnapshot(290)) - Current Snapshot Index 25, takeSnapshot took 0 ms
2021-10-05 13:24:03,842 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:takeSnapshot(281)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater: Took a snapshot at index 25
2021-10-05 13:24:03,842 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:lambda$new$0(89)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater: snapshotIndex: updateIncreasingly 20 -> 25
2021-10-05 13:24:03,842 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  safemode.HealthyPipelineSafeModeRule (HealthyPipelineSafeModeRule.java:initializeRule(152)) - Refreshed total pipeline count is 1, healthy pipeline threshold count is 1
2021-10-05 13:24:03,842 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:purge(306)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-SegmentedRaftLog: purge 25
2021-10-05 13:24:03,843 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  ha.SCMStateMachine (SCMStateMachine.java:takeSnapshot(290)) - Current Snapshot Index 25, takeSnapshot took 0 ms
2021-10-05 13:24:03,843 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:takeSnapshot(281)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater: Took a snapshot at index 25
2021-10-05 13:24:03,843 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:lambda$new$0(89)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater: snapshotIndex: updateIncreasingly 20 -> 25
2021-10-05 13:24:03,843 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:purge(306)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-SegmentedRaftLog: purge 25
2021-10-05 13:24:03,843 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-SegmentedRaftLog: snapshotIndex: updateIncreasingly 20 -> 25
2021-10-05 13:24:03,843 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-SegmentedRaftLog: purgeIndex: updateToMax old=20, new=25, updated? true
2021-10-05 13:24:03,844 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-SegmentedRaftLog: snapshotIndex: updateIncreasingly 20 -> 25
2021-10-05 13:24:03,844 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-SegmentedRaftLog: purgeIndex: updateToMax old=20, new=25, updated? true
2021-10-05 13:24:03,844 [Listener at 127.0.0.1/10356] INFO  ha.SCMHAInvocationHandler (SCMHAInvocationHandler.java:invokeRatis(113)) - Invoking method public abstract java.lang.Boolean org.apache.hadoop.hdds.scm.ha.SequenceIdGenerator$StateManager.allocateBatch(java.lang.String,java.lang.Long,java.lang.Long) on target org.apache.hadoop.hdds.scm.ha.SCMRatisServerImpl@6344f74b, cost 10633.88us
2021-10-05 13:24:03,844 [Listener at 127.0.0.1/10356] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:getNextId(127)) - Allocate a batch for containerId, change lastId from 0 to 1000.
2021-10-05 13:24:03,858 [Listener at 127.0.0.1/10356] INFO  ha.SCMHAInvocationHandler (SCMHAInvocationHandler.java:invokeRatis(113)) - Invoking method public abstract void org.apache.hadoop.hdds.scm.container.ContainerStateManagerV2.addContainer(org.apache.hadoop.hdds.protocol.proto.HddsProtos$ContainerInfoProto) throws java.io.IOException on target org.apache.hadoop.hdds.scm.ha.SCMRatisServerImpl@6344f74b, cost 11470.865us
2021-10-05 13:24:03,860 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  safemode.HealthyPipelineSafeModeRule (HealthyPipelineSafeModeRule.java:initializeRule(152)) - Refreshed total pipeline count is 1, healthy pipeline threshold count is 1
2021-10-05 13:24:03,966 [Listener at 127.0.0.1/10356] INFO  ha.SCMHAInvocationHandler (SCMHAInvocationHandler.java:invokeRatis(113)) - Invoking method public abstract void org.apache.hadoop.hdds.scm.container.ContainerStateManagerV2.addContainer(org.apache.hadoop.hdds.protocol.proto.HddsProtos$ContainerInfoProto) throws java.io.IOException on target org.apache.hadoop.hdds.scm.ha.SCMRatisServerImpl@6344f74b, cost 6091.918us
2021-10-05 13:24:03,969 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  safemode.HealthyPipelineSafeModeRule (HealthyPipelineSafeModeRule.java:initializeRule(152)) - Refreshed total pipeline count is 1, healthy pipeline threshold count is 1
2021-10-05 13:24:03,970 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  ha.SCMStateMachine (SCMStateMachine.java:takeSnapshot(290)) - Current Snapshot Index 30, takeSnapshot took 0 ms
2021-10-05 13:24:03,970 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:takeSnapshot(281)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater: Took a snapshot at index 30
2021-10-05 13:24:03,970 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:lambda$new$0(89)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater: snapshotIndex: updateIncreasingly 25 -> 30
2021-10-05 13:24:03,970 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:purge(306)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-SegmentedRaftLog: purge 30
2021-10-05 13:24:03,970 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-SegmentedRaftLog: snapshotIndex: updateIncreasingly 25 -> 30
2021-10-05 13:24:03,970 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-SegmentedRaftLog: purgeIndex: updateToMax old=25, new=30, updated? true
2021-10-05 13:24:03,981 [Datanode State Machine Thread - 0] ERROR datanode.RunningDatanodeState (RunningDatanodeState.java:computeNextContainerState(199)) - Error in executing end point task.
java.util.concurrent.ExecutionException: java.util.concurrent.TimeoutException
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.hadoop.ozone.container.common.states.datanode.RunningDatanodeState.computeNextContainerState(RunningDatanodeState.java:191)
	at org.apache.hadoop.ozone.container.common.states.datanode.RunningDatanodeState.await(RunningDatanodeState.java:231)
	at org.apache.hadoop.ozone.container.common.states.datanode.RunningDatanodeState.await(RunningDatanodeState.java:50)
	at org.apache.hadoop.ozone.container.common.statemachine.StateContext.execute(StateContext.java:629)
	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.start(DatanodeStateMachine.java:270)
	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.lambda$startDaemon$0(DatanodeStateMachine.java:457)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.util.concurrent.TimeoutException
	at java.util.concurrent.FutureTask.get(FutureTask.java:205)
	at org.apache.hadoop.ozone.container.common.states.datanode.RunningDatanodeState.lambda$execute$0(RunningDatanodeState.java:149)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
2021-10-05 13:24:04,070 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  ha.SCMStateMachine (SCMStateMachine.java:takeSnapshot(290)) - Current Snapshot Index 30, takeSnapshot took 0 ms
2021-10-05 13:24:04,071 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:takeSnapshot(281)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater: Took a snapshot at index 30
2021-10-05 13:24:04,071 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:lambda$new$0(89)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater: snapshotIndex: updateIncreasingly 25 -> 30
2021-10-05 13:24:04,071 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:purge(306)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-SegmentedRaftLog: purge 30
2021-10-05 13:24:04,071 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-SegmentedRaftLog: snapshotIndex: updateIncreasingly 25 -> 30
2021-10-05 13:24:04,071 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-SegmentedRaftLog: purgeIndex: updateToMax old=25, new=30, updated? true
2021-10-05 13:24:04,074 [Listener at 127.0.0.1/10356] INFO  ha.SCMHAInvocationHandler (SCMHAInvocationHandler.java:invokeRatis(113)) - Invoking method public abstract void org.apache.hadoop.hdds.scm.container.ContainerStateManagerV2.addContainer(org.apache.hadoop.hdds.protocol.proto.HddsProtos$ContainerInfoProto) throws java.io.IOException on target org.apache.hadoop.hdds.scm.ha.SCMRatisServerImpl@6344f74b, cost 6917.902us
2021-10-05 13:24:04,077 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  safemode.HealthyPipelineSafeModeRule (HealthyPipelineSafeModeRule.java:initializeRule(152)) - Refreshed total pipeline count is 1, healthy pipeline threshold count is 1
2021-10-05 13:24:04,180 [Listener at 127.0.0.1/10356] INFO  ha.SCMHAInvocationHandler (SCMHAInvocationHandler.java:invokeRatis(113)) - Invoking method public abstract void org.apache.hadoop.hdds.scm.container.ContainerStateManagerV2.addContainer(org.apache.hadoop.hdds.protocol.proto.HddsProtos$ContainerInfoProto) throws java.io.IOException on target org.apache.hadoop.hdds.scm.ha.SCMRatisServerImpl@6344f74b, cost 5501.959us
2021-10-05 13:24:04,181 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  safemode.HealthyPipelineSafeModeRule (HealthyPipelineSafeModeRule.java:initializeRule(152)) - Refreshed total pipeline count is 1, healthy pipeline threshold count is 1
2021-10-05 13:24:04,286 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  ha.SCMStateMachine (SCMStateMachine.java:takeSnapshot(290)) - Current Snapshot Index 35, takeSnapshot took 0 ms
2021-10-05 13:24:04,286 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:takeSnapshot(281)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater: Took a snapshot at index 35
2021-10-05 13:24:04,287 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:lambda$new$0(89)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater: snapshotIndex: updateIncreasingly 30 -> 35
2021-10-05 13:24:04,287 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:purge(306)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-SegmentedRaftLog: purge 35
2021-10-05 13:24:04,287 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-SegmentedRaftLog: snapshotIndex: updateIncreasingly 30 -> 35
2021-10-05 13:24:04,287 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-SegmentedRaftLog: purgeIndex: updateToMax old=30, new=35, updated? true
2021-10-05 13:24:04,287 [Listener at 127.0.0.1/10356] INFO  ha.SCMHAInvocationHandler (SCMHAInvocationHandler.java:invokeRatis(113)) - Invoking method public abstract void org.apache.hadoop.hdds.scm.container.ContainerStateManagerV2.addContainer(org.apache.hadoop.hdds.protocol.proto.HddsProtos$ContainerInfoProto) throws java.io.IOException on target org.apache.hadoop.hdds.scm.ha.SCMRatisServerImpl@6344f74b, cost 6432.953us
2021-10-05 13:24:04,292 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  safemode.HealthyPipelineSafeModeRule (HealthyPipelineSafeModeRule.java:initializeRule(152)) - Refreshed total pipeline count is 1, healthy pipeline threshold count is 1
2021-10-05 13:24:04,292 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  ha.SCMStateMachine (SCMStateMachine.java:takeSnapshot(290)) - Current Snapshot Index 35, takeSnapshot took 1 ms
2021-10-05 13:24:04,292 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:takeSnapshot(281)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater: Took a snapshot at index 35
2021-10-05 13:24:04,292 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:lambda$new$0(89)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater: snapshotIndex: updateIncreasingly 30 -> 35
2021-10-05 13:24:04,292 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:purge(306)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-SegmentedRaftLog: purge 35
2021-10-05 13:24:04,292 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-SegmentedRaftLog: snapshotIndex: updateIncreasingly 30 -> 35
2021-10-05 13:24:04,292 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-SegmentedRaftLog: purgeIndex: updateToMax old=30, new=35, updated? true
2021-10-05 13:24:04,395 [Listener at 127.0.0.1/10356] INFO  ha.SCMHAInvocationHandler (SCMHAInvocationHandler.java:invokeRatis(113)) - Invoking method public abstract void org.apache.hadoop.hdds.scm.container.ContainerStateManagerV2.addContainer(org.apache.hadoop.hdds.protocol.proto.HddsProtos$ContainerInfoProto) throws java.io.IOException on target org.apache.hadoop.hdds.scm.ha.SCMRatisServerImpl@6344f74b, cost 6712.482us
2021-10-05 13:24:04,397 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  safemode.HealthyPipelineSafeModeRule (HealthyPipelineSafeModeRule.java:initializeRule(152)) - Refreshed total pipeline count is 1, healthy pipeline threshold count is 1
2021-10-05 13:24:04,507 [Listener at 127.0.0.1/10356] INFO  ha.SCMHAInvocationHandler (SCMHAInvocationHandler.java:invokeRatis(113)) - Invoking method public abstract void org.apache.hadoop.hdds.scm.container.ContainerStateManagerV2.addContainer(org.apache.hadoop.hdds.protocol.proto.HddsProtos$ContainerInfoProto) throws java.io.IOException on target org.apache.hadoop.hdds.scm.ha.SCMRatisServerImpl@6344f74b, cost 10661.782us
2021-10-05 13:24:04,510 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  safemode.HealthyPipelineSafeModeRule (HealthyPipelineSafeModeRule.java:initializeRule(152)) - Refreshed total pipeline count is 1, healthy pipeline threshold count is 1
2021-10-05 13:24:04,512 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  ha.SCMStateMachine (SCMStateMachine.java:takeSnapshot(290)) - Current Snapshot Index 40, takeSnapshot took 0 ms
2021-10-05 13:24:04,512 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:takeSnapshot(281)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater: Took a snapshot at index 40
2021-10-05 13:24:04,512 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:lambda$new$0(89)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater: snapshotIndex: updateIncreasingly 35 -> 40
2021-10-05 13:24:04,512 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:purge(306)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-SegmentedRaftLog: purge 40
2021-10-05 13:24:04,512 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-SegmentedRaftLog: snapshotIndex: updateIncreasingly 35 -> 40
2021-10-05 13:24:04,512 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-SegmentedRaftLog: purgeIndex: updateToMax old=35, new=40, updated? true
2021-10-05 13:24:04,612 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  ha.SCMStateMachine (SCMStateMachine.java:takeSnapshot(290)) - Current Snapshot Index 40, takeSnapshot took 1 ms
2021-10-05 13:24:04,612 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:takeSnapshot(281)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater: Took a snapshot at index 40
2021-10-05 13:24:04,612 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:lambda$new$0(89)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater: snapshotIndex: updateIncreasingly 35 -> 40
2021-10-05 13:24:04,613 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:purge(306)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-SegmentedRaftLog: purge 40
2021-10-05 13:24:04,613 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-SegmentedRaftLog: snapshotIndex: updateIncreasingly 35 -> 40
2021-10-05 13:24:04,613 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-SegmentedRaftLog: purgeIndex: updateToMax old=35, new=40, updated? true
2021-10-05 13:24:04,615 [Listener at 127.0.0.1/10356] INFO  ha.SCMHAInvocationHandler (SCMHAInvocationHandler.java:invokeRatis(113)) - Invoking method public abstract void org.apache.hadoop.hdds.scm.container.ContainerStateManagerV2.addContainer(org.apache.hadoop.hdds.protocol.proto.HddsProtos$ContainerInfoProto) throws java.io.IOException on target org.apache.hadoop.hdds.scm.ha.SCMRatisServerImpl@6344f74b, cost 7826.994us
2021-10-05 13:24:04,618 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  safemode.HealthyPipelineSafeModeRule (HealthyPipelineSafeModeRule.java:initializeRule(152)) - Refreshed total pipeline count is 1, healthy pipeline threshold count is 1
2021-10-05 13:24:04,721 [Listener at 127.0.0.1/10356] INFO  ha.SCMHAInvocationHandler (SCMHAInvocationHandler.java:invokeRatis(113)) - Invoking method public abstract void org.apache.hadoop.hdds.scm.container.ContainerStateManagerV2.addContainer(org.apache.hadoop.hdds.protocol.proto.HddsProtos$ContainerInfoProto) throws java.io.IOException on target org.apache.hadoop.hdds.scm.ha.SCMRatisServerImpl@6344f74b, cost 4587.266us
2021-10-05 13:24:04,724 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  safemode.HealthyPipelineSafeModeRule (HealthyPipelineSafeModeRule.java:initializeRule(152)) - Refreshed total pipeline count is 1, healthy pipeline threshold count is 1
2021-10-05 13:24:04,763 [Datanode State Machine Thread - 0] ERROR datanode.RunningDatanodeState (RunningDatanodeState.java:computeNextContainerState(199)) - Error in executing end point task.
java.util.concurrent.ExecutionException: java.util.concurrent.TimeoutException
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.hadoop.ozone.container.common.states.datanode.RunningDatanodeState.computeNextContainerState(RunningDatanodeState.java:191)
	at org.apache.hadoop.ozone.container.common.states.datanode.RunningDatanodeState.await(RunningDatanodeState.java:231)
	at org.apache.hadoop.ozone.container.common.states.datanode.RunningDatanodeState.await(RunningDatanodeState.java:50)
	at org.apache.hadoop.ozone.container.common.statemachine.StateContext.execute(StateContext.java:629)
	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.start(DatanodeStateMachine.java:270)
	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.lambda$startDaemon$0(DatanodeStateMachine.java:457)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.util.concurrent.TimeoutException
	at java.util.concurrent.FutureTask.get(FutureTask.java:205)
	at org.apache.hadoop.ozone.container.common.states.datanode.RunningDatanodeState.lambda$execute$0(RunningDatanodeState.java:149)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
2021-10-05 13:24:04,828 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  ha.SCMStateMachine (SCMStateMachine.java:takeSnapshot(290)) - Current Snapshot Index 45, takeSnapshot took 0 ms
2021-10-05 13:24:04,828 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:takeSnapshot(281)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater: Took a snapshot at index 45
2021-10-05 13:24:04,828 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:lambda$new$0(89)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater: snapshotIndex: updateIncreasingly 40 -> 45
2021-10-05 13:24:04,828 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:purge(306)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-SegmentedRaftLog: purge 45
2021-10-05 13:24:04,828 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-SegmentedRaftLog: snapshotIndex: updateIncreasingly 40 -> 45
2021-10-05 13:24:04,828 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-SegmentedRaftLog: purgeIndex: updateToMax old=40, new=45, updated? true
2021-10-05 13:24:04,829 [Listener at 127.0.0.1/10356] INFO  ha.SCMHAInvocationHandler (SCMHAInvocationHandler.java:invokeRatis(113)) - Invoking method public abstract void org.apache.hadoop.hdds.scm.container.ContainerStateManagerV2.addContainer(org.apache.hadoop.hdds.protocol.proto.HddsProtos$ContainerInfoProto) throws java.io.IOException on target org.apache.hadoop.hdds.scm.ha.SCMRatisServerImpl@6344f74b, cost 7503.162us
2021-10-05 13:24:04,832 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  safemode.HealthyPipelineSafeModeRule (HealthyPipelineSafeModeRule.java:initializeRule(152)) - Refreshed total pipeline count is 1, healthy pipeline threshold count is 1
2021-10-05 13:24:04,832 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  ha.SCMStateMachine (SCMStateMachine.java:takeSnapshot(290)) - Current Snapshot Index 45, takeSnapshot took 1 ms
2021-10-05 13:24:04,832 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:takeSnapshot(281)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater: Took a snapshot at index 45
2021-10-05 13:24:04,832 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:lambda$new$0(89)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater: snapshotIndex: updateIncreasingly 40 -> 45
2021-10-05 13:24:04,832 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:purge(306)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-SegmentedRaftLog: purge 45
2021-10-05 13:24:04,832 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-SegmentedRaftLog: snapshotIndex: updateIncreasingly 40 -> 45
2021-10-05 13:24:04,832 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-SegmentedRaftLog: purgeIndex: updateToMax old=40, new=45, updated? true
2021-10-05 13:24:04,935 [Listener at 127.0.0.1/10356] INFO  ha.SCMHAInvocationHandler (SCMHAInvocationHandler.java:invokeRatis(113)) - Invoking method public abstract void org.apache.hadoop.hdds.scm.container.ContainerStateManagerV2.addContainer(org.apache.hadoop.hdds.protocol.proto.HddsProtos$ContainerInfoProto) throws java.io.IOException on target org.apache.hadoop.hdds.scm.ha.SCMRatisServerImpl@6344f74b, cost 5416.149us
2021-10-05 13:24:04,937 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  safemode.HealthyPipelineSafeModeRule (HealthyPipelineSafeModeRule.java:initializeRule(152)) - Refreshed total pipeline count is 1, healthy pipeline threshold count is 1
2021-10-05 13:24:05,043 [Listener at 127.0.0.1/10356] INFO  ha.SCMHAInvocationHandler (SCMHAInvocationHandler.java:invokeRatis(113)) - Invoking method public abstract void org.apache.hadoop.hdds.scm.container.ContainerStateManagerV2.addContainer(org.apache.hadoop.hdds.protocol.proto.HddsProtos$ContainerInfoProto) throws java.io.IOException on target org.apache.hadoop.hdds.scm.ha.SCMRatisServerImpl@6344f74b, cost 7438.554us
2021-10-05 13:24:05,046 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  safemode.HealthyPipelineSafeModeRule (HealthyPipelineSafeModeRule.java:initializeRule(152)) - Refreshed total pipeline count is 1, healthy pipeline threshold count is 1
2021-10-05 13:24:05,048 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  ha.SCMStateMachine (SCMStateMachine.java:takeSnapshot(290)) - Current Snapshot Index 50, takeSnapshot took 1 ms
2021-10-05 13:24:05,048 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:takeSnapshot(281)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater: Took a snapshot at index 50
2021-10-05 13:24:05,048 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:lambda$new$0(89)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater: snapshotIndex: updateIncreasingly 45 -> 50
2021-10-05 13:24:05,048 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:purge(306)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-SegmentedRaftLog: purge 50
2021-10-05 13:24:05,048 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-SegmentedRaftLog: snapshotIndex: updateIncreasingly 45 -> 50
2021-10-05 13:24:05,048 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-SegmentedRaftLog: purgeIndex: updateToMax old=45, new=50, updated? true
2021-10-05 13:24:05,147 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  ha.SCMStateMachine (SCMStateMachine.java:takeSnapshot(290)) - Current Snapshot Index 50, takeSnapshot took 0 ms
2021-10-05 13:24:05,148 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:takeSnapshot(281)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater: Took a snapshot at index 50
2021-10-05 13:24:05,148 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:lambda$new$0(89)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater: snapshotIndex: updateIncreasingly 45 -> 50
2021-10-05 13:24:05,148 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:purge(306)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-SegmentedRaftLog: purge 50
2021-10-05 13:24:05,148 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-SegmentedRaftLog: snapshotIndex: updateIncreasingly 45 -> 50
2021-10-05 13:24:05,148 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-SegmentedRaftLog: purgeIndex: updateToMax old=45, new=50, updated? true
2021-10-05 13:24:05,149 [Listener at 127.0.0.1/10356] INFO  ha.SCMHAInvocationHandler (SCMHAInvocationHandler.java:invokeRatis(113)) - Invoking method public abstract void org.apache.hadoop.hdds.scm.container.ContainerStateManagerV2.addContainer(org.apache.hadoop.hdds.protocol.proto.HddsProtos$ContainerInfoProto) throws java.io.IOException on target org.apache.hadoop.hdds.scm.ha.SCMRatisServerImpl@6344f74b, cost 5149.922us
2021-10-05 13:24:05,152 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  safemode.HealthyPipelineSafeModeRule (HealthyPipelineSafeModeRule.java:initializeRule(152)) - Refreshed total pipeline count is 1, healthy pipeline threshold count is 1
2021-10-05 13:24:05,257 [Listener at 127.0.0.1/10356] INFO  ha.SCMHAInvocationHandler (SCMHAInvocationHandler.java:invokeRatis(113)) - Invoking method public abstract void org.apache.hadoop.hdds.scm.container.ContainerStateManagerV2.addContainer(org.apache.hadoop.hdds.protocol.proto.HddsProtos$ContainerInfoProto) throws java.io.IOException on target org.apache.hadoop.hdds.scm.ha.SCMRatisServerImpl@6344f74b, cost 7109.321us
2021-10-05 13:24:05,259 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  safemode.HealthyPipelineSafeModeRule (HealthyPipelineSafeModeRule.java:initializeRule(152)) - Refreshed total pipeline count is 1, healthy pipeline threshold count is 1
2021-10-05 13:24:05,363 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  ha.SCMStateMachine (SCMStateMachine.java:takeSnapshot(290)) - Current Snapshot Index 55, takeSnapshot took 0 ms
2021-10-05 13:24:05,363 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:takeSnapshot(281)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater: Took a snapshot at index 55
2021-10-05 13:24:05,363 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:lambda$new$0(89)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater: snapshotIndex: updateIncreasingly 50 -> 55
2021-10-05 13:24:05,363 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:purge(306)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-SegmentedRaftLog: purge 55
2021-10-05 13:24:05,363 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-SegmentedRaftLog: snapshotIndex: updateIncreasingly 50 -> 55
2021-10-05 13:24:05,363 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-SegmentedRaftLog: purgeIndex: updateToMax old=50, new=55, updated? true
2021-10-05 13:24:05,363 [Listener at 127.0.0.1/10356] INFO  ha.SCMHAInvocationHandler (SCMHAInvocationHandler.java:invokeRatis(113)) - Invoking method public abstract void org.apache.hadoop.hdds.scm.container.ContainerStateManagerV2.addContainer(org.apache.hadoop.hdds.protocol.proto.HddsProtos$ContainerInfoProto) throws java.io.IOException on target org.apache.hadoop.hdds.scm.ha.SCMRatisServerImpl@6344f74b, cost 5206.828us
2021-10-05 13:24:05,367 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  safemode.HealthyPipelineSafeModeRule (HealthyPipelineSafeModeRule.java:initializeRule(152)) - Refreshed total pipeline count is 1, healthy pipeline threshold count is 1
2021-10-05 13:24:05,369 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  ha.SCMStateMachine (SCMStateMachine.java:takeSnapshot(290)) - Current Snapshot Index 55, takeSnapshot took 0 ms
2021-10-05 13:24:05,369 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:takeSnapshot(281)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater: Took a snapshot at index 55
2021-10-05 13:24:05,369 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:lambda$new$0(89)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater: snapshotIndex: updateIncreasingly 50 -> 55
2021-10-05 13:24:05,369 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:purge(306)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-SegmentedRaftLog: purge 55
2021-10-05 13:24:05,369 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-SegmentedRaftLog: snapshotIndex: updateIncreasingly 50 -> 55
2021-10-05 13:24:05,369 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-SegmentedRaftLog: purgeIndex: updateToMax old=50, new=55, updated? true
2021-10-05 13:24:05,471 [Listener at 127.0.0.1/10356] INFO  ha.SCMHAInvocationHandler (SCMHAInvocationHandler.java:invokeRatis(113)) - Invoking method public abstract void org.apache.hadoop.hdds.scm.container.ContainerStateManagerV2.addContainer(org.apache.hadoop.hdds.protocol.proto.HddsProtos$ContainerInfoProto) throws java.io.IOException on target org.apache.hadoop.hdds.scm.ha.SCMRatisServerImpl@6344f74b, cost 7580.469us
2021-10-05 13:24:05,474 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  safemode.HealthyPipelineSafeModeRule (HealthyPipelineSafeModeRule.java:initializeRule(152)) - Refreshed total pipeline count is 1, healthy pipeline threshold count is 1
2021-10-05 13:24:05,584 [Listener at 127.0.0.1/10356] INFO  ha.SCMHAInvocationHandler (SCMHAInvocationHandler.java:invokeRatis(113)) - Invoking method public abstract void org.apache.hadoop.hdds.scm.container.ContainerStateManagerV2.addContainer(org.apache.hadoop.hdds.protocol.proto.HddsProtos$ContainerInfoProto) throws java.io.IOException on target org.apache.hadoop.hdds.scm.ha.SCMRatisServerImpl@6344f74b, cost 6326.542us
2021-10-05 13:24:05,585 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  safemode.HealthyPipelineSafeModeRule (HealthyPipelineSafeModeRule.java:initializeRule(152)) - Refreshed total pipeline count is 1, healthy pipeline threshold count is 1
2021-10-05 13:24:05,586 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  ha.SCMStateMachine (SCMStateMachine.java:takeSnapshot(290)) - Current Snapshot Index 60, takeSnapshot took 0 ms
2021-10-05 13:24:05,586 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:takeSnapshot(281)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater: Took a snapshot at index 60
2021-10-05 13:24:05,586 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:lambda$new$0(89)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater: snapshotIndex: updateIncreasingly 55 -> 60
2021-10-05 13:24:05,586 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:purge(306)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-SegmentedRaftLog: purge 60
2021-10-05 13:24:05,586 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-SegmentedRaftLog: snapshotIndex: updateIncreasingly 55 -> 60
2021-10-05 13:24:05,586 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-SegmentedRaftLog: purgeIndex: updateToMax old=55, new=60, updated? true
2021-10-05 13:24:05,689 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  ha.SCMStateMachine (SCMStateMachine.java:takeSnapshot(290)) - Current Snapshot Index 60, takeSnapshot took 1 ms
2021-10-05 13:24:05,689 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:takeSnapshot(281)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater: Took a snapshot at index 60
2021-10-05 13:24:05,689 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:lambda$new$0(89)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater: snapshotIndex: updateIncreasingly 55 -> 60
2021-10-05 13:24:05,689 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:purge(306)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-SegmentedRaftLog: purge 60
2021-10-05 13:24:05,689 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-SegmentedRaftLog: snapshotIndex: updateIncreasingly 55 -> 60
2021-10-05 13:24:05,690 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-SegmentedRaftLog: purgeIndex: updateToMax old=55, new=60, updated? true
2021-10-05 13:24:05,694 [Listener at 127.0.0.1/10356] INFO  ha.SCMHAInvocationHandler (SCMHAInvocationHandler.java:invokeRatis(113)) - Invoking method public abstract void org.apache.hadoop.hdds.scm.container.ContainerStateManagerV2.addContainer(org.apache.hadoop.hdds.protocol.proto.HddsProtos$ContainerInfoProto) throws java.io.IOException on target org.apache.hadoop.hdds.scm.ha.SCMRatisServerImpl@6344f74b, cost 8931.506us
2021-10-05 13:24:05,695 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  safemode.HealthyPipelineSafeModeRule (HealthyPipelineSafeModeRule.java:initializeRule(152)) - Refreshed total pipeline count is 1, healthy pipeline threshold count is 1
2021-10-05 13:24:05,766 [Datanode State Machine Thread - 0] ERROR datanode.RunningDatanodeState (RunningDatanodeState.java:computeNextContainerState(199)) - Error in executing end point task.
java.util.concurrent.ExecutionException: java.util.concurrent.TimeoutException
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.hadoop.ozone.container.common.states.datanode.RunningDatanodeState.computeNextContainerState(RunningDatanodeState.java:191)
	at org.apache.hadoop.ozone.container.common.states.datanode.RunningDatanodeState.await(RunningDatanodeState.java:231)
	at org.apache.hadoop.ozone.container.common.states.datanode.RunningDatanodeState.await(RunningDatanodeState.java:50)
	at org.apache.hadoop.ozone.container.common.statemachine.StateContext.execute(StateContext.java:629)
	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.start(DatanodeStateMachine.java:270)
	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.lambda$startDaemon$0(DatanodeStateMachine.java:457)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.util.concurrent.TimeoutException
	at java.util.concurrent.FutureTask.get(FutureTask.java:205)
	at org.apache.hadoop.ozone.container.common.states.datanode.RunningDatanodeState.lambda$execute$0(RunningDatanodeState.java:149)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
2021-10-05 13:24:05,804 [Listener at 127.0.0.1/10356] INFO  ha.SCMHAInvocationHandler (SCMHAInvocationHandler.java:invokeRatis(113)) - Invoking method public abstract void org.apache.hadoop.hdds.scm.container.ContainerStateManagerV2.addContainer(org.apache.hadoop.hdds.protocol.proto.HddsProtos$ContainerInfoProto) throws java.io.IOException on target org.apache.hadoop.hdds.scm.ha.SCMRatisServerImpl@6344f74b, cost 9355.049us
2021-10-05 13:24:05,805 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  safemode.HealthyPipelineSafeModeRule (HealthyPipelineSafeModeRule.java:initializeRule(152)) - Refreshed total pipeline count is 1, healthy pipeline threshold count is 1
2021-10-05 13:24:05,910 [Listener at 127.0.0.1/10356] INFO  ha.SCMHAInvocationHandler (SCMHAInvocationHandler.java:invokeRatis(113)) - Invoking method public abstract void org.apache.hadoop.hdds.scm.container.ContainerStateManagerV2.addContainer(org.apache.hadoop.hdds.protocol.proto.HddsProtos$ContainerInfoProto) throws java.io.IOException on target org.apache.hadoop.hdds.scm.ha.SCMRatisServerImpl@6344f74b, cost 5187.426us
2021-10-05 13:24:05,910 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  ha.SCMStateMachine (SCMStateMachine.java:takeSnapshot(290)) - Current Snapshot Index 65, takeSnapshot took 0 ms
2021-10-05 13:24:05,910 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:takeSnapshot(281)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater: Took a snapshot at index 65
2021-10-05 13:24:05,910 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:lambda$new$0(89)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater: snapshotIndex: updateIncreasingly 60 -> 65
2021-10-05 13:24:05,910 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:purge(306)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-SegmentedRaftLog: purge 65
2021-10-05 13:24:05,910 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-SegmentedRaftLog: snapshotIndex: updateIncreasingly 60 -> 65
2021-10-05 13:24:05,910 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-SegmentedRaftLog: purgeIndex: updateToMax old=60, new=65, updated? true
2021-10-05 13:24:05,912 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  safemode.HealthyPipelineSafeModeRule (HealthyPipelineSafeModeRule.java:initializeRule(152)) - Refreshed total pipeline count is 1, healthy pipeline threshold count is 1
2021-10-05 13:24:05,912 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  ha.SCMStateMachine (SCMStateMachine.java:takeSnapshot(290)) - Current Snapshot Index 65, takeSnapshot took 0 ms
2021-10-05 13:24:05,913 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:takeSnapshot(281)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater: Took a snapshot at index 65
2021-10-05 13:24:05,913 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:lambda$new$0(89)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater: snapshotIndex: updateIncreasingly 60 -> 65
2021-10-05 13:24:05,913 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:purge(306)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-SegmentedRaftLog: purge 65
2021-10-05 13:24:05,913 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-SegmentedRaftLog: snapshotIndex: updateIncreasingly 60 -> 65
2021-10-05 13:24:05,913 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-SegmentedRaftLog: purgeIndex: updateToMax old=60, new=65, updated? true
2021-10-05 13:24:06,017 [Listener at 127.0.0.1/10356] INFO  ha.SCMHAInvocationHandler (SCMHAInvocationHandler.java:invokeRatis(113)) - Invoking method public abstract void org.apache.hadoop.hdds.scm.container.ContainerStateManagerV2.addContainer(org.apache.hadoop.hdds.protocol.proto.HddsProtos$ContainerInfoProto) throws java.io.IOException on target org.apache.hadoop.hdds.scm.ha.SCMRatisServerImpl@6344f74b, cost 6680.177us
2021-10-05 13:24:06,019 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  safemode.HealthyPipelineSafeModeRule (HealthyPipelineSafeModeRule.java:initializeRule(152)) - Refreshed total pipeline count is 1, healthy pipeline threshold count is 1
2021-10-05 13:24:06,124 [Listener at 127.0.0.1/10356] INFO  ha.SCMHAInvocationHandler (SCMHAInvocationHandler.java:invokeRatis(113)) - Invoking method public abstract void org.apache.hadoop.hdds.scm.container.ContainerStateManagerV2.addContainer(org.apache.hadoop.hdds.protocol.proto.HddsProtos$ContainerInfoProto) throws java.io.IOException on target org.apache.hadoop.hdds.scm.ha.SCMRatisServerImpl@6344f74b, cost 5904.698us
2021-10-05 13:24:06,125 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  safemode.HealthyPipelineSafeModeRule (HealthyPipelineSafeModeRule.java:initializeRule(152)) - Refreshed total pipeline count is 1, healthy pipeline threshold count is 1
2021-10-05 13:24:06,126 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  ha.SCMStateMachine (SCMStateMachine.java:takeSnapshot(290)) - Current Snapshot Index 70, takeSnapshot took 0 ms
2021-10-05 13:24:06,126 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:takeSnapshot(281)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater: Took a snapshot at index 70
2021-10-05 13:24:06,126 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:lambda$new$0(89)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater: snapshotIndex: updateIncreasingly 65 -> 70
2021-10-05 13:24:06,126 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:purge(306)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-SegmentedRaftLog: purge 70
2021-10-05 13:24:06,126 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-SegmentedRaftLog: snapshotIndex: updateIncreasingly 65 -> 70
2021-10-05 13:24:06,126 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-SegmentedRaftLog: purgeIndex: updateToMax old=65, new=70, updated? true
2021-10-05 13:24:06,228 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  ha.SCMStateMachine (SCMStateMachine.java:takeSnapshot(290)) - Current Snapshot Index 70, takeSnapshot took 0 ms
2021-10-05 13:24:06,228 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:takeSnapshot(281)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater: Took a snapshot at index 70
2021-10-05 13:24:06,228 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:lambda$new$0(89)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater: snapshotIndex: updateIncreasingly 65 -> 70
2021-10-05 13:24:06,228 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:purge(306)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-SegmentedRaftLog: purge 70
2021-10-05 13:24:06,228 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-SegmentedRaftLog: snapshotIndex: updateIncreasingly 65 -> 70
2021-10-05 13:24:06,228 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-SegmentedRaftLog: purgeIndex: updateToMax old=65, new=70, updated? true
2021-10-05 13:24:06,231 [Listener at 127.0.0.1/10356] INFO  ha.SCMHAInvocationHandler (SCMHAInvocationHandler.java:invokeRatis(113)) - Invoking method public abstract void org.apache.hadoop.hdds.scm.container.ContainerStateManagerV2.addContainer(org.apache.hadoop.hdds.protocol.proto.HddsProtos$ContainerInfoProto) throws java.io.IOException on target org.apache.hadoop.hdds.scm.ha.SCMRatisServerImpl@6344f74b, cost 6440.153us
2021-10-05 13:24:06,233 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  safemode.HealthyPipelineSafeModeRule (HealthyPipelineSafeModeRule.java:initializeRule(152)) - Refreshed total pipeline count is 1, healthy pipeline threshold count is 1
2021-10-05 13:24:06,335 [Listener at 127.0.0.1/10356] INFO  ha.SCMHAInvocationHandler (SCMHAInvocationHandler.java:invokeRatis(113)) - Invoking method public abstract void org.apache.hadoop.hdds.scm.container.ContainerStateManagerV2.addContainer(org.apache.hadoop.hdds.protocol.proto.HddsProtos$ContainerInfoProto) throws java.io.IOException on target org.apache.hadoop.hdds.scm.ha.SCMRatisServerImpl@6344f74b, cost 3621.667us
2021-10-05 13:24:06,337 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  safemode.HealthyPipelineSafeModeRule (HealthyPipelineSafeModeRule.java:initializeRule(152)) - Refreshed total pipeline count is 1, healthy pipeline threshold count is 1
2021-10-05 13:24:06,442 [Listener at 127.0.0.1/10356] INFO  ha.SCMHAInvocationHandler (SCMHAInvocationHandler.java:invokeRatis(113)) - Invoking method public abstract void org.apache.hadoop.hdds.scm.container.ContainerStateManagerV2.addContainer(org.apache.hadoop.hdds.protocol.proto.HddsProtos$ContainerInfoProto) throws java.io.IOException on target org.apache.hadoop.hdds.scm.ha.SCMRatisServerImpl@6344f74b, cost 6310.14us
2021-10-05 13:24:06,442 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  ha.SCMStateMachine (SCMStateMachine.java:takeSnapshot(290)) - Current Snapshot Index 75, takeSnapshot took 0 ms
2021-10-05 13:24:06,443 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:takeSnapshot(281)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater: Took a snapshot at index 75
2021-10-05 13:24:06,443 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:lambda$new$0(89)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater: snapshotIndex: updateIncreasingly 70 -> 75
2021-10-05 13:24:06,443 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:purge(306)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-SegmentedRaftLog: purge 75
2021-10-05 13:24:06,443 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-SegmentedRaftLog: snapshotIndex: updateIncreasingly 70 -> 75
2021-10-05 13:24:06,443 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-SegmentedRaftLog: purgeIndex: updateToMax old=70, new=75, updated? true
2021-10-05 13:24:06,445 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  safemode.HealthyPipelineSafeModeRule (HealthyPipelineSafeModeRule.java:initializeRule(152)) - Refreshed total pipeline count is 1, healthy pipeline threshold count is 1
2021-10-05 13:24:06,445 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  ha.SCMStateMachine (SCMStateMachine.java:takeSnapshot(290)) - Current Snapshot Index 75, takeSnapshot took 0 ms
2021-10-05 13:24:06,445 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:takeSnapshot(281)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater: Took a snapshot at index 75
2021-10-05 13:24:06,445 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:lambda$new$0(89)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater: snapshotIndex: updateIncreasingly 70 -> 75
2021-10-05 13:24:06,445 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:purge(306)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-SegmentedRaftLog: purge 75
2021-10-05 13:24:06,445 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-SegmentedRaftLog: snapshotIndex: updateIncreasingly 70 -> 75
2021-10-05 13:24:06,445 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-SegmentedRaftLog: purgeIndex: updateToMax old=70, new=75, updated? true
2021-10-05 13:24:06,548 [Listener at 127.0.0.1/10356] INFO  ha.SCMHAInvocationHandler (SCMHAInvocationHandler.java:invokeRatis(113)) - Invoking method public abstract void org.apache.hadoop.hdds.scm.container.ContainerStateManagerV2.addContainer(org.apache.hadoop.hdds.protocol.proto.HddsProtos$ContainerInfoProto) throws java.io.IOException on target org.apache.hadoop.hdds.scm.ha.SCMRatisServerImpl@6344f74b, cost 4686.475us
2021-10-05 13:24:06,550 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  safemode.HealthyPipelineSafeModeRule (HealthyPipelineSafeModeRule.java:initializeRule(152)) - Refreshed total pipeline count is 1, healthy pipeline threshold count is 1
2021-10-05 13:24:06,654 [Listener at 127.0.0.1/10356] INFO  ha.SCMHAInvocationHandler (SCMHAInvocationHandler.java:invokeRatis(113)) - Invoking method public abstract void org.apache.hadoop.hdds.scm.container.ContainerStateManagerV2.addContainer(org.apache.hadoop.hdds.protocol.proto.HddsProtos$ContainerInfoProto) throws java.io.IOException on target org.apache.hadoop.hdds.scm.ha.SCMRatisServerImpl@6344f74b, cost 5786.787us
2021-10-05 13:24:06,658 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  safemode.HealthyPipelineSafeModeRule (HealthyPipelineSafeModeRule.java:initializeRule(152)) - Refreshed total pipeline count is 1, healthy pipeline threshold count is 1
2021-10-05 13:24:06,658 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  ha.SCMStateMachine (SCMStateMachine.java:takeSnapshot(290)) - Current Snapshot Index 80, takeSnapshot took 0 ms
2021-10-05 13:24:06,659 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:takeSnapshot(281)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater: Took a snapshot at index 80
2021-10-05 13:24:06,659 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:lambda$new$0(89)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater: snapshotIndex: updateIncreasingly 75 -> 80
2021-10-05 13:24:06,659 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:purge(306)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-SegmentedRaftLog: purge 80
2021-10-05 13:24:06,659 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-SegmentedRaftLog: snapshotIndex: updateIncreasingly 75 -> 80
2021-10-05 13:24:06,659 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-SegmentedRaftLog: purgeIndex: updateToMax old=75, new=80, updated? true
2021-10-05 13:24:06,758 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  ha.SCMStateMachine (SCMStateMachine.java:takeSnapshot(290)) - Current Snapshot Index 80, takeSnapshot took 1 ms
2021-10-05 13:24:06,758 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:takeSnapshot(281)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater: Took a snapshot at index 80
2021-10-05 13:24:06,758 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:lambda$new$0(89)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater: snapshotIndex: updateIncreasingly 75 -> 80
2021-10-05 13:24:06,758 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:purge(306)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-SegmentedRaftLog: purge 80
2021-10-05 13:24:06,758 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-SegmentedRaftLog: snapshotIndex: updateIncreasingly 75 -> 80
2021-10-05 13:24:06,758 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-SegmentedRaftLog: purgeIndex: updateToMax old=75, new=80, updated? true
2021-10-05 13:24:06,761 [Listener at 127.0.0.1/10356] INFO  ha.SCMHAInvocationHandler (SCMHAInvocationHandler.java:invokeRatis(113)) - Invoking method public abstract void org.apache.hadoop.hdds.scm.container.ContainerStateManagerV2.addContainer(org.apache.hadoop.hdds.protocol.proto.HddsProtos$ContainerInfoProto) throws java.io.IOException on target org.apache.hadoop.hdds.scm.ha.SCMRatisServerImpl@6344f74b, cost 5700.578us
2021-10-05 13:24:06,763 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  safemode.HealthyPipelineSafeModeRule (HealthyPipelineSafeModeRule.java:initializeRule(152)) - Refreshed total pipeline count is 1, healthy pipeline threshold count is 1
2021-10-05 13:24:06,768 [Datanode State Machine Thread - 0] ERROR datanode.RunningDatanodeState (RunningDatanodeState.java:computeNextContainerState(199)) - Error in executing end point task.
java.util.concurrent.ExecutionException: java.util.concurrent.TimeoutException
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.hadoop.ozone.container.common.states.datanode.RunningDatanodeState.computeNextContainerState(RunningDatanodeState.java:191)
	at org.apache.hadoop.ozone.container.common.states.datanode.RunningDatanodeState.await(RunningDatanodeState.java:231)
	at org.apache.hadoop.ozone.container.common.states.datanode.RunningDatanodeState.await(RunningDatanodeState.java:50)
	at org.apache.hadoop.ozone.container.common.statemachine.StateContext.execute(StateContext.java:629)
	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.start(DatanodeStateMachine.java:270)
	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.lambda$startDaemon$0(DatanodeStateMachine.java:457)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.util.concurrent.TimeoutException
	at java.util.concurrent.FutureTask.get(FutureTask.java:205)
	at org.apache.hadoop.ozone.container.common.states.datanode.RunningDatanodeState.lambda$execute$0(RunningDatanodeState.java:149)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
2021-10-05 13:24:06,867 [Listener at 127.0.0.1/10356] INFO  ha.SCMHAInvocationHandler (SCMHAInvocationHandler.java:invokeRatis(113)) - Invoking method public abstract void org.apache.hadoop.hdds.scm.container.ContainerStateManagerV2.addContainer(org.apache.hadoop.hdds.protocol.proto.HddsProtos$ContainerInfoProto) throws java.io.IOException on target org.apache.hadoop.hdds.scm.ha.SCMRatisServerImpl@6344f74b, cost 6171.026us
2021-10-05 13:24:06,871 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  safemode.HealthyPipelineSafeModeRule (HealthyPipelineSafeModeRule.java:initializeRule(152)) - Refreshed total pipeline count is 1, healthy pipeline threshold count is 1
2021-10-05 13:24:06,973 [Listener at 127.0.0.1/10356] INFO  ha.SCMHAInvocationHandler (SCMHAInvocationHandler.java:invokeRatis(113)) - Invoking method public abstract void org.apache.hadoop.hdds.scm.container.ContainerStateManagerV2.addContainer(org.apache.hadoop.hdds.protocol.proto.HddsProtos$ContainerInfoProto) throws java.io.IOException on target org.apache.hadoop.hdds.scm.ha.SCMRatisServerImpl@6344f74b, cost 5372.244us
2021-10-05 13:24:06,974 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  ha.SCMStateMachine (SCMStateMachine.java:takeSnapshot(290)) - Current Snapshot Index 85, takeSnapshot took 0 ms
2021-10-05 13:24:06,974 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:takeSnapshot(281)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater: Took a snapshot at index 85
2021-10-05 13:24:06,974 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:lambda$new$0(89)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater: snapshotIndex: updateIncreasingly 80 -> 85
2021-10-05 13:24:06,974 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:purge(306)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-SegmentedRaftLog: purge 85
2021-10-05 13:24:06,974 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-SegmentedRaftLog: snapshotIndex: updateIncreasingly 80 -> 85
2021-10-05 13:24:06,974 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-SegmentedRaftLog: purgeIndex: updateToMax old=80, new=85, updated? true
2021-10-05 13:24:06,975 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  safemode.HealthyPipelineSafeModeRule (HealthyPipelineSafeModeRule.java:initializeRule(152)) - Refreshed total pipeline count is 1, healthy pipeline threshold count is 1
2021-10-05 13:24:06,976 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  ha.SCMStateMachine (SCMStateMachine.java:takeSnapshot(290)) - Current Snapshot Index 85, takeSnapshot took 0 ms
2021-10-05 13:24:06,976 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:takeSnapshot(281)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater: Took a snapshot at index 85
2021-10-05 13:24:06,976 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:lambda$new$0(89)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater: snapshotIndex: updateIncreasingly 80 -> 85
2021-10-05 13:24:06,976 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:purge(306)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-SegmentedRaftLog: purge 85
2021-10-05 13:24:06,976 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-SegmentedRaftLog: snapshotIndex: updateIncreasingly 80 -> 85
2021-10-05 13:24:06,976 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-SegmentedRaftLog: purgeIndex: updateToMax old=80, new=85, updated? true
2021-10-05 13:24:07,080 [Listener at 127.0.0.1/10356] INFO  ha.SCMHAInvocationHandler (SCMHAInvocationHandler.java:invokeRatis(113)) - Invoking method public abstract void org.apache.hadoop.hdds.scm.container.ContainerStateManagerV2.addContainer(org.apache.hadoop.hdds.protocol.proto.HddsProtos$ContainerInfoProto) throws java.io.IOException on target org.apache.hadoop.hdds.scm.ha.SCMRatisServerImpl@6344f74b, cost 5447.652us
2021-10-05 13:24:07,083 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  safemode.HealthyPipelineSafeModeRule (HealthyPipelineSafeModeRule.java:initializeRule(152)) - Refreshed total pipeline count is 1, healthy pipeline threshold count is 1
2021-10-05 13:24:07,187 [Listener at 127.0.0.1/10356] INFO  ha.SCMHAInvocationHandler (SCMHAInvocationHandler.java:invokeRatis(113)) - Invoking method public abstract void org.apache.hadoop.hdds.scm.container.ContainerStateManagerV2.addContainer(org.apache.hadoop.hdds.protocol.proto.HddsProtos$ContainerInfoProto) throws java.io.IOException on target org.apache.hadoop.hdds.scm.ha.SCMRatisServerImpl@6344f74b, cost 6304.538us
2021-10-05 13:24:07,189 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  safemode.HealthyPipelineSafeModeRule (HealthyPipelineSafeModeRule.java:initializeRule(152)) - Refreshed total pipeline count is 1, healthy pipeline threshold count is 1
2021-10-05 13:24:07,189 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  ha.SCMStateMachine (SCMStateMachine.java:takeSnapshot(290)) - Current Snapshot Index 90, takeSnapshot took 0 ms
2021-10-05 13:24:07,189 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:takeSnapshot(281)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater: Took a snapshot at index 90
2021-10-05 13:24:07,189 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:lambda$new$0(89)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater: snapshotIndex: updateIncreasingly 85 -> 90
2021-10-05 13:24:07,189 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:purge(306)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-SegmentedRaftLog: purge 90
2021-10-05 13:24:07,189 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-SegmentedRaftLog: snapshotIndex: updateIncreasingly 85 -> 90
2021-10-05 13:24:07,189 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-SegmentedRaftLog: purgeIndex: updateToMax old=85, new=90, updated? true
2021-10-05 13:24:07,291 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  ha.SCMStateMachine (SCMStateMachine.java:takeSnapshot(290)) - Current Snapshot Index 90, takeSnapshot took 0 ms
2021-10-05 13:24:07,291 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:takeSnapshot(281)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater: Took a snapshot at index 90
2021-10-05 13:24:07,291 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:lambda$new$0(89)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater: snapshotIndex: updateIncreasingly 85 -> 90
2021-10-05 13:24:07,291 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:purge(306)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-SegmentedRaftLog: purge 90
2021-10-05 13:24:07,291 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-SegmentedRaftLog: snapshotIndex: updateIncreasingly 85 -> 90
2021-10-05 13:24:07,291 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-SegmentedRaftLog: purgeIndex: updateToMax old=85, new=90, updated? true
2021-10-05 13:24:07,293 [Listener at 127.0.0.1/10356] INFO  ha.SCMHAInvocationHandler (SCMHAInvocationHandler.java:invokeRatis(113)) - Invoking method public abstract void org.apache.hadoop.hdds.scm.container.ContainerStateManagerV2.addContainer(org.apache.hadoop.hdds.protocol.proto.HddsProtos$ContainerInfoProto) throws java.io.IOException on target org.apache.hadoop.hdds.scm.ha.SCMRatisServerImpl@6344f74b, cost 5572.064us
2021-10-05 13:24:07,297 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  safemode.HealthyPipelineSafeModeRule (HealthyPipelineSafeModeRule.java:initializeRule(152)) - Refreshed total pipeline count is 1, healthy pipeline threshold count is 1
2021-10-05 13:24:07,398 [Listener at 127.0.0.1/10356] INFO  ha.SCMHAInvocationHandler (SCMHAInvocationHandler.java:invokeRatis(113)) - Invoking method public abstract void org.apache.hadoop.hdds.scm.container.ContainerStateManagerV2.addContainer(org.apache.hadoop.hdds.protocol.proto.HddsProtos$ContainerInfoProto) throws java.io.IOException on target org.apache.hadoop.hdds.scm.ha.SCMRatisServerImpl@6344f74b, cost 4106.316us
2021-10-05 13:24:07,400 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  safemode.HealthyPipelineSafeModeRule (HealthyPipelineSafeModeRule.java:initializeRule(152)) - Refreshed total pipeline count is 1, healthy pipeline threshold count is 1
2021-10-05 13:24:07,505 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  ha.SCMStateMachine (SCMStateMachine.java:takeSnapshot(290)) - Current Snapshot Index 95, takeSnapshot took 0 ms
2021-10-05 13:24:07,505 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:takeSnapshot(281)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater: Took a snapshot at index 95
2021-10-05 13:24:07,505 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:lambda$new$0(89)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater: snapshotIndex: updateIncreasingly 90 -> 95
2021-10-05 13:24:07,505 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:purge(306)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-SegmentedRaftLog: purge 95
2021-10-05 13:24:07,505 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-SegmentedRaftLog: snapshotIndex: updateIncreasingly 90 -> 95
2021-10-05 13:24:07,505 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-SegmentedRaftLog: purgeIndex: updateToMax old=90, new=95, updated? true
2021-10-05 13:24:07,506 [Listener at 127.0.0.1/10356] INFO  ha.SCMHAInvocationHandler (SCMHAInvocationHandler.java:invokeRatis(113)) - Invoking method public abstract void org.apache.hadoop.hdds.scm.container.ContainerStateManagerV2.addContainer(org.apache.hadoop.hdds.protocol.proto.HddsProtos$ContainerInfoProto) throws java.io.IOException on target org.apache.hadoop.hdds.scm.ha.SCMRatisServerImpl@6344f74b, cost 7535.963us
2021-10-05 13:24:07,511 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  safemode.HealthyPipelineSafeModeRule (HealthyPipelineSafeModeRule.java:initializeRule(152)) - Refreshed total pipeline count is 1, healthy pipeline threshold count is 1
2021-10-05 13:24:07,512 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  ha.SCMStateMachine (SCMStateMachine.java:takeSnapshot(290)) - Current Snapshot Index 95, takeSnapshot took 0 ms
2021-10-05 13:24:07,512 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:takeSnapshot(281)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater: Took a snapshot at index 95
2021-10-05 13:24:07,512 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:lambda$new$0(89)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater: snapshotIndex: updateIncreasingly 90 -> 95
2021-10-05 13:24:07,512 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:purge(306)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-SegmentedRaftLog: purge 95
2021-10-05 13:24:07,512 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-SegmentedRaftLog: snapshotIndex: updateIncreasingly 90 -> 95
2021-10-05 13:24:07,512 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-SegmentedRaftLog: purgeIndex: updateToMax old=90, new=95, updated? true
2021-10-05 13:24:07,612 [Listener at 127.0.0.1/10356] INFO  ha.SCMHAInvocationHandler (SCMHAInvocationHandler.java:invokeRatis(113)) - Invoking method public abstract void org.apache.hadoop.hdds.scm.container.ContainerStateManagerV2.addContainer(org.apache.hadoop.hdds.protocol.proto.HddsProtos$ContainerInfoProto) throws java.io.IOException on target org.apache.hadoop.hdds.scm.ha.SCMRatisServerImpl@6344f74b, cost 5304.437us
2021-10-05 13:24:07,615 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  safemode.HealthyPipelineSafeModeRule (HealthyPipelineSafeModeRule.java:initializeRule(152)) - Refreshed total pipeline count is 1, healthy pipeline threshold count is 1
2021-10-05 13:24:07,755 [Datanode State Machine Thread - 0] ERROR datanode.RunningDatanodeState (RunningDatanodeState.java:computeNextContainerState(199)) - Error in executing end point task.
java.util.concurrent.ExecutionException: java.util.concurrent.TimeoutException
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.hadoop.ozone.container.common.states.datanode.RunningDatanodeState.computeNextContainerState(RunningDatanodeState.java:191)
	at org.apache.hadoop.ozone.container.common.states.datanode.RunningDatanodeState.await(RunningDatanodeState.java:231)
	at org.apache.hadoop.ozone.container.common.states.datanode.RunningDatanodeState.await(RunningDatanodeState.java:50)
	at org.apache.hadoop.ozone.container.common.statemachine.StateContext.execute(StateContext.java:629)
	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.start(DatanodeStateMachine.java:270)
	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.lambda$startDaemon$0(DatanodeStateMachine.java:457)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.util.concurrent.TimeoutException
	at java.util.concurrent.FutureTask.get(FutureTask.java:205)
	at org.apache.hadoop.ozone.container.common.states.datanode.RunningDatanodeState.lambda$execute$0(RunningDatanodeState.java:149)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
2021-10-05 13:24:07,758 [Listener at 127.0.0.1/10356] INFO  ha.SCMHAInvocationHandler (SCMHAInvocationHandler.java:invokeRatis(113)) - Invoking method public abstract void org.apache.hadoop.hdds.scm.container.ContainerStateManagerV2.addContainer(org.apache.hadoop.hdds.protocol.proto.HddsProtos$ContainerInfoProto) throws java.io.IOException on target org.apache.hadoop.hdds.scm.ha.SCMRatisServerImpl@6344f74b, cost 45452.306us
2021-10-05 13:24:07,765 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  safemode.HealthyPipelineSafeModeRule (HealthyPipelineSafeModeRule.java:initializeRule(152)) - Refreshed total pipeline count is 1, healthy pipeline threshold count is 1
2021-10-05 13:24:07,769 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  ha.SCMStateMachine (SCMStateMachine.java:takeSnapshot(290)) - Current Snapshot Index 100, takeSnapshot took 0 ms
2021-10-05 13:24:07,769 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:takeSnapshot(281)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater: Took a snapshot at index 100
2021-10-05 13:24:07,769 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:lambda$new$0(89)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater: snapshotIndex: updateIncreasingly 95 -> 100
2021-10-05 13:24:07,769 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:purge(306)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-SegmentedRaftLog: purge 100
2021-10-05 13:24:07,769 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-SegmentedRaftLog: snapshotIndex: updateIncreasingly 95 -> 100
2021-10-05 13:24:07,769 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-SegmentedRaftLog: purgeIndex: updateToMax old=95, new=100, updated? true
2021-10-05 13:24:07,870 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  ha.SCMStateMachine (SCMStateMachine.java:takeSnapshot(290)) - Current Snapshot Index 100, takeSnapshot took 0 ms
2021-10-05 13:24:07,870 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:takeSnapshot(281)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater: Took a snapshot at index 100
2021-10-05 13:24:07,870 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:lambda$new$0(89)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater: snapshotIndex: updateIncreasingly 95 -> 100
2021-10-05 13:24:07,870 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:purge(306)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-SegmentedRaftLog: purge 100
2021-10-05 13:24:07,870 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-SegmentedRaftLog: snapshotIndex: updateIncreasingly 95 -> 100
2021-10-05 13:24:07,870 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-SegmentedRaftLog: purgeIndex: updateToMax old=95, new=100, updated? true
2021-10-05 13:24:07,872 [Listener at 127.0.0.1/10356] INFO  ha.SCMHAInvocationHandler (SCMHAInvocationHandler.java:invokeRatis(113)) - Invoking method public abstract void org.apache.hadoop.hdds.scm.container.ContainerStateManagerV2.addContainer(org.apache.hadoop.hdds.protocol.proto.HddsProtos$ContainerInfoProto) throws java.io.IOException on target org.apache.hadoop.hdds.scm.ha.SCMRatisServerImpl@6344f74b, cost 6472.356us
2021-10-05 13:24:07,875 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  safemode.HealthyPipelineSafeModeRule (HealthyPipelineSafeModeRule.java:initializeRule(152)) - Refreshed total pipeline count is 1, healthy pipeline threshold count is 1
2021-10-05 13:24:07,979 [Listener at 127.0.0.1/10356] INFO  ha.SCMHAInvocationHandler (SCMHAInvocationHandler.java:invokeRatis(113)) - Invoking method public abstract void org.apache.hadoop.hdds.scm.container.ContainerStateManagerV2.addContainer(org.apache.hadoop.hdds.protocol.proto.HddsProtos$ContainerInfoProto) throws java.io.IOException on target org.apache.hadoop.hdds.scm.ha.SCMRatisServerImpl@6344f74b, cost 6539.863us
2021-10-05 13:24:07,982 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  safemode.HealthyPipelineSafeModeRule (HealthyPipelineSafeModeRule.java:initializeRule(152)) - Refreshed total pipeline count is 1, healthy pipeline threshold count is 1
2021-10-05 13:24:07,984 [Datanode State Machine Thread - 0] ERROR datanode.RunningDatanodeState (RunningDatanodeState.java:computeNextContainerState(199)) - Error in executing end point task.
java.util.concurrent.ExecutionException: java.util.concurrent.TimeoutException
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.hadoop.ozone.container.common.states.datanode.RunningDatanodeState.computeNextContainerState(RunningDatanodeState.java:191)
	at org.apache.hadoop.ozone.container.common.states.datanode.RunningDatanodeState.await(RunningDatanodeState.java:231)
	at org.apache.hadoop.ozone.container.common.states.datanode.RunningDatanodeState.await(RunningDatanodeState.java:50)
	at org.apache.hadoop.ozone.container.common.statemachine.StateContext.execute(StateContext.java:629)
	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.start(DatanodeStateMachine.java:270)
	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.lambda$startDaemon$0(DatanodeStateMachine.java:457)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.util.concurrent.TimeoutException
	at java.util.concurrent.FutureTask.get(FutureTask.java:205)
	at org.apache.hadoop.ozone.container.common.states.datanode.RunningDatanodeState.lambda$execute$0(RunningDatanodeState.java:149)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
2021-10-05 13:24:08,080 [Listener at 127.0.0.1/10356] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:rollLogSegment(399)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-SegmentedRaftLogWorker: Rolling segment log-1_104 to index:104
2021-10-05 13:24:08,081 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(558)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-SegmentedRaftLogWorker: Rolled log segment from /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-98f4f1fb-613f-4a4a-83a3-c748f4b4520d/scmNode-1/scm-ha/98f4f1fb-613f-4a4a-83a3-c748f4b4520d/current/log_inprogress_1 to /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-98f4f1fb-613f-4a4a-83a3-c748f4b4520d/scmNode-1/scm-ha/98f4f1fb-613f-4a4a-83a3-c748f4b4520d/current/log_1-104
2021-10-05 13:24:08,083 [grpc-default-executor-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:rollLogSegment(399)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-SegmentedRaftLogWorker: Rolling segment log-1_104 to index:104
2021-10-05 13:24:08,084 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(558)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-SegmentedRaftLogWorker: Rolled log segment from /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-98f4f1fb-613f-4a4a-83a3-c748f4b4520d/scmNode-2/scm-ha/98f4f1fb-613f-4a4a-83a3-c748f4b4520d/current/log_inprogress_1 to /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-98f4f1fb-613f-4a4a-83a3-c748f4b4520d/scmNode-2/scm-ha/98f4f1fb-613f-4a4a-83a3-c748f4b4520d/current/log_1-104
2021-10-05 13:24:08,088 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(601)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-SegmentedRaftLogWorker: created new log segment /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-98f4f1fb-613f-4a4a-83a3-c748f4b4520d/scmNode-2/scm-ha/98f4f1fb-613f-4a4a-83a3-c748f4b4520d/current/log_inprogress_105
2021-10-05 13:24:08,090 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(601)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-SegmentedRaftLogWorker: created new log segment /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-98f4f1fb-613f-4a4a-83a3-c748f4b4520d/scmNode-1/scm-ha/98f4f1fb-613f-4a4a-83a3-c748f4b4520d/current/log_inprogress_105
2021-10-05 13:24:08,092 [Listener at 127.0.0.1/10356] INFO  ha.SCMHAInvocationHandler (SCMHAInvocationHandler.java:invokeRatis(113)) - Invoking method public abstract void org.apache.hadoop.hdds.scm.container.ContainerStateManagerV2.addContainer(org.apache.hadoop.hdds.protocol.proto.HddsProtos$ContainerInfoProto) throws java.io.IOException on target org.apache.hadoop.hdds.scm.ha.SCMRatisServerImpl@6344f74b, cost 12090.525us
2021-10-05 13:24:08,092 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  ha.SCMStateMachine (SCMStateMachine.java:takeSnapshot(290)) - Current Snapshot Index 105, takeSnapshot took 1 ms
2021-10-05 13:24:08,092 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:takeSnapshot(281)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater: Took a snapshot at index 105
2021-10-05 13:24:08,092 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:lambda$new$0(89)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater: snapshotIndex: updateIncreasingly 100 -> 105
2021-10-05 13:24:08,092 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:purge(306)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-SegmentedRaftLog: purge 105
2021-10-05 13:24:08,093 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-SegmentedRaftLog: snapshotIndex: updateIncreasingly 100 -> 105
2021-10-05 13:24:08,093 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-SegmentedRaftLogWorker] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-SegmentedRaftLog: purgeIndex: updateToMax old=100, new=104, updated? true
2021-10-05 13:24:08,095 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  safemode.HealthyPipelineSafeModeRule (HealthyPipelineSafeModeRule.java:initializeRule(152)) - Refreshed total pipeline count is 1, healthy pipeline threshold count is 1
2021-10-05 13:24:08,095 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  ha.SCMStateMachine (SCMStateMachine.java:takeSnapshot(290)) - Current Snapshot Index 105, takeSnapshot took 0 ms
2021-10-05 13:24:08,095 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:takeSnapshot(281)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater: Took a snapshot at index 105
2021-10-05 13:24:08,095 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:lambda$new$0(89)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater: snapshotIndex: updateIncreasingly 100 -> 105
2021-10-05 13:24:08,095 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:purge(306)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-SegmentedRaftLog: purge 105
2021-10-05 13:24:08,095 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-SegmentedRaftLog: snapshotIndex: updateIncreasingly 100 -> 105
2021-10-05 13:24:08,095 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-SegmentedRaftLogWorker] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-SegmentedRaftLog: purgeIndex: updateToMax old=100, new=104, updated? true
2021-10-05 13:24:08,201 [Listener at 127.0.0.1/10356] INFO  ha.SCMHAInvocationHandler (SCMHAInvocationHandler.java:invokeRatis(113)) - Invoking method public abstract void org.apache.hadoop.hdds.scm.container.ContainerStateManagerV2.addContainer(org.apache.hadoop.hdds.protocol.proto.HddsProtos$ContainerInfoProto) throws java.io.IOException on target org.apache.hadoop.hdds.scm.ha.SCMRatisServerImpl@6344f74b, cost 8319.043us
2021-10-05 13:24:08,203 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  safemode.HealthyPipelineSafeModeRule (HealthyPipelineSafeModeRule.java:initializeRule(152)) - Refreshed total pipeline count is 1, healthy pipeline threshold count is 1
2021-10-05 13:24:08,308 [Listener at 127.0.0.1/10356] INFO  ha.SCMHAInvocationHandler (SCMHAInvocationHandler.java:invokeRatis(113)) - Invoking method public abstract void org.apache.hadoop.hdds.scm.container.ContainerStateManagerV2.addContainer(org.apache.hadoop.hdds.protocol.proto.HddsProtos$ContainerInfoProto) throws java.io.IOException on target org.apache.hadoop.hdds.scm.ha.SCMRatisServerImpl@6344f74b, cost 6231.131us
2021-10-05 13:24:08,310 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  safemode.HealthyPipelineSafeModeRule (HealthyPipelineSafeModeRule.java:initializeRule(152)) - Refreshed total pipeline count is 1, healthy pipeline threshold count is 1
2021-10-05 13:24:08,311 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  ha.SCMStateMachine (SCMStateMachine.java:takeSnapshot(290)) - Current Snapshot Index 110, takeSnapshot took 0 ms
2021-10-05 13:24:08,311 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:takeSnapshot(281)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater: Took a snapshot at index 110
2021-10-05 13:24:08,311 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:lambda$new$0(89)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater: snapshotIndex: updateIncreasingly 105 -> 110
2021-10-05 13:24:08,311 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:purge(306)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-SegmentedRaftLog: purge 110
2021-10-05 13:24:08,311 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-SegmentedRaftLog: snapshotIndex: updateIncreasingly 105 -> 110
2021-10-05 13:24:08,311 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-SegmentedRaftLog: purgeIndex: updateToMax old=104, new=110, updated? true
2021-10-05 13:24:08,413 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  ha.SCMStateMachine (SCMStateMachine.java:takeSnapshot(290)) - Current Snapshot Index 110, takeSnapshot took 0 ms
2021-10-05 13:24:08,413 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:takeSnapshot(281)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater: Took a snapshot at index 110
2021-10-05 13:24:08,413 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:lambda$new$0(89)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater: snapshotIndex: updateIncreasingly 105 -> 110
2021-10-05 13:24:08,413 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:purge(306)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-SegmentedRaftLog: purge 110
2021-10-05 13:24:08,413 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-SegmentedRaftLog: snapshotIndex: updateIncreasingly 105 -> 110
2021-10-05 13:24:08,413 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-SegmentedRaftLog: purgeIndex: updateToMax old=104, new=110, updated? true
2021-10-05 13:24:08,415 [Listener at 127.0.0.1/10356] INFO  ha.SCMHAInvocationHandler (SCMHAInvocationHandler.java:invokeRatis(113)) - Invoking method public abstract void org.apache.hadoop.hdds.scm.container.ContainerStateManagerV2.addContainer(org.apache.hadoop.hdds.protocol.proto.HddsProtos$ContainerInfoProto) throws java.io.IOException on target org.apache.hadoop.hdds.scm.ha.SCMRatisServerImpl@6344f74b, cost 5562.663us
2021-10-05 13:24:08,417 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  safemode.HealthyPipelineSafeModeRule (HealthyPipelineSafeModeRule.java:initializeRule(152)) - Refreshed total pipeline count is 1, healthy pipeline threshold count is 1
2021-10-05 13:24:08,521 [Listener at 127.0.0.1/10356] INFO  ha.SCMHAInvocationHandler (SCMHAInvocationHandler.java:invokeRatis(113)) - Invoking method public abstract void org.apache.hadoop.hdds.scm.container.ContainerStateManagerV2.addContainer(org.apache.hadoop.hdds.protocol.proto.HddsProtos$ContainerInfoProto) throws java.io.IOException on target org.apache.hadoop.hdds.scm.ha.SCMRatisServerImpl@6344f74b, cost 5373.944us
2021-10-05 13:24:08,525 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  safemode.HealthyPipelineSafeModeRule (HealthyPipelineSafeModeRule.java:initializeRule(152)) - Refreshed total pipeline count is 1, healthy pipeline threshold count is 1
2021-10-05 13:24:08,626 [Listener at 127.0.0.1/10356] INFO  ha.SCMHAInvocationHandler (SCMHAInvocationHandler.java:invokeRatis(113)) - Invoking method public abstract void org.apache.hadoop.hdds.scm.container.ContainerStateManagerV2.addContainer(org.apache.hadoop.hdds.protocol.proto.HddsProtos$ContainerInfoProto) throws java.io.IOException on target org.apache.hadoop.hdds.scm.ha.SCMRatisServerImpl@6344f74b, cost 3443.249us
2021-10-05 13:24:08,626 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  ha.SCMStateMachine (SCMStateMachine.java:takeSnapshot(290)) - Current Snapshot Index 115, takeSnapshot took 0 ms
2021-10-05 13:24:08,626 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:takeSnapshot(281)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater: Took a snapshot at index 115
2021-10-05 13:24:08,626 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:lambda$new$0(89)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater: snapshotIndex: updateIncreasingly 110 -> 115
2021-10-05 13:24:08,626 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:purge(306)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-SegmentedRaftLog: purge 115
2021-10-05 13:24:08,626 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-SegmentedRaftLog: snapshotIndex: updateIncreasingly 110 -> 115
2021-10-05 13:24:08,626 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-SegmentedRaftLog: purgeIndex: updateToMax old=110, new=115, updated? true
2021-10-05 13:24:08,628 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  safemode.HealthyPipelineSafeModeRule (HealthyPipelineSafeModeRule.java:initializeRule(152)) - Refreshed total pipeline count is 1, healthy pipeline threshold count is 1
2021-10-05 13:24:08,628 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  ha.SCMStateMachine (SCMStateMachine.java:takeSnapshot(290)) - Current Snapshot Index 115, takeSnapshot took 1 ms
2021-10-05 13:24:08,628 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:takeSnapshot(281)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater: Took a snapshot at index 115
2021-10-05 13:24:08,628 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:lambda$new$0(89)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater: snapshotIndex: updateIncreasingly 110 -> 115
2021-10-05 13:24:08,628 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:purge(306)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-SegmentedRaftLog: purge 115
2021-10-05 13:24:08,628 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-SegmentedRaftLog: snapshotIndex: updateIncreasingly 110 -> 115
2021-10-05 13:24:08,628 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-SegmentedRaftLog: purgeIndex: updateToMax old=110, new=115, updated? true
2021-10-05 13:24:08,657 [a9b6c243-aad2-4cee-be19-871628539a81@group-52E96576A6DB-FollowerState] INFO  impl.FollowerState (FollowerState.java:run(134)) - a9b6c243-aad2-4cee-be19-871628539a81@group-52E96576A6DB-FollowerState: change to CANDIDATE, lastRpcElapsedTime:5008652460ns, electionTimeout:5008ms
2021-10-05 13:24:08,657 [a9b6c243-aad2-4cee-be19-871628539a81@group-52E96576A6DB-FollowerState] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(108)) - a9b6c243-aad2-4cee-be19-871628539a81: shutdown a9b6c243-aad2-4cee-be19-871628539a81@group-52E96576A6DB-FollowerState
2021-10-05 13:24:08,658 [a9b6c243-aad2-4cee-be19-871628539a81@group-52E96576A6DB-FollowerState] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(285)) - a9b6c243-aad2-4cee-be19-871628539a81@group-52E96576A6DB: changes role from  FOLLOWER to CANDIDATE at term 2 for changeToCandidate
2021-10-05 13:24:08,658 [a9b6c243-aad2-4cee-be19-871628539a81@group-52E96576A6DB-FollowerState] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.leaderelection.pre-vote = false (custom)
2021-10-05 13:24:08,658 [a9b6c243-aad2-4cee-be19-871628539a81@group-52E96576A6DB-FollowerState] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(130)) - a9b6c243-aad2-4cee-be19-871628539a81: start a9b6c243-aad2-4cee-be19-871628539a81@group-52E96576A6DB-LeaderElection11
2021-10-05 13:24:08,661 [a9b6c243-aad2-4cee-be19-871628539a81@group-52E96576A6DB-LeaderElection11] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(306)) - a9b6c243-aad2-4cee-be19-871628539a81@group-52E96576A6DB-LeaderElection11 ELECTION round 0: submit vote requests at term 3 for -1: [0c34be74-1f5b-4b04-a6d4-fde6c3deb89a|rpc:127.0.0.1:33359|dataStream:|priority:0, f990c0ed-f7f2-4f8a-8ec9-db097d9c855e|rpc:127.0.0.1:44595|dataStream:|priority:0, a9b6c243-aad2-4cee-be19-871628539a81|rpc:127.0.0.1:36351|dataStream:|priority:1], old=null
2021-10-05 13:24:08,675 [grpc-default-executor-1] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1043)) - 0c34be74-1f5b-4b04-a6d4-fde6c3deb89a@group-52E96576A6DB: receive requestVote(ELECTION, a9b6c243-aad2-4cee-be19-871628539a81, group-52E96576A6DB, 3, (t:0, i:0))
2021-10-05 13:24:08,675 [grpc-default-executor-1] INFO  impl.VoteContext (VoteContext.java:log(48)) - 0c34be74-1f5b-4b04-a6d4-fde6c3deb89a@group-52E96576A6DB-FOLLOWER: accept ELECTION from a9b6c243-aad2-4cee-be19-871628539a81: our priority 0 <= candidate's priority 1
2021-10-05 13:24:08,675 [grpc-default-executor-1] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(285)) - 0c34be74-1f5b-4b04-a6d4-fde6c3deb89a@group-52E96576A6DB: changes role from  FOLLOWER to FOLLOWER at term 3 for candidate:a9b6c243-aad2-4cee-be19-871628539a81
2021-10-05 13:24:08,675 [grpc-default-executor-1] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(108)) - 0c34be74-1f5b-4b04-a6d4-fde6c3deb89a: shutdown 0c34be74-1f5b-4b04-a6d4-fde6c3deb89a@group-52E96576A6DB-FollowerState
2021-10-05 13:24:08,675 [grpc-default-executor-1] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(130)) - 0c34be74-1f5b-4b04-a6d4-fde6c3deb89a: start 0c34be74-1f5b-4b04-a6d4-fde6c3deb89a@group-52E96576A6DB-FollowerState
2021-10-05 13:24:08,676 [0c34be74-1f5b-4b04-a6d4-fde6c3deb89a@group-52E96576A6DB-FollowerState] INFO  impl.FollowerState (FollowerState.java:run(143)) - 0c34be74-1f5b-4b04-a6d4-fde6c3deb89a@group-52E96576A6DB-FollowerState was interrupted: {}
java.lang.InterruptedException: sleep interrupted
	at java.lang.Thread.sleep(Native Method)
	at java.lang.Thread.sleep(Thread.java:340)
	at java.util.concurrent.TimeUnit.sleep(TimeUnit.java:386)
	at org.apache.ratis.util.TimeDuration.sleep(TimeDuration.java:324)
	at org.apache.ratis.util.TimeDuration.sleep(TimeDuration.java:309)
	at org.apache.ratis.server.impl.FollowerState.run(FollowerState.java:118)
2021-10-05 13:24:08,677 [grpc-default-executor-1] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1075)) - 0c34be74-1f5b-4b04-a6d4-fde6c3deb89a@group-52E96576A6DB replies to ELECTION vote request: a9b6c243-aad2-4cee-be19-871628539a81<-0c34be74-1f5b-4b04-a6d4-fde6c3deb89a#0:OK-t3. Peer's state: 0c34be74-1f5b-4b04-a6d4-fde6c3deb89a@group-52E96576A6DB:t3, leader=null, voted=a9b6c243-aad2-4cee-be19-871628539a81, raftlog=0c34be74-1f5b-4b04-a6d4-fde6c3deb89a@group-52E96576A6DB-SegmentedRaftLog:OPENED:c-1,f-1,i0, conf=-1: [0c34be74-1f5b-4b04-a6d4-fde6c3deb89a|rpc:127.0.0.1:33359|dataStream:|priority:0, f990c0ed-f7f2-4f8a-8ec9-db097d9c855e|rpc:127.0.0.1:44595|dataStream:|priority:0, a9b6c243-aad2-4cee-be19-871628539a81|rpc:127.0.0.1:36351|dataStream:|priority:1], old=null
2021-10-05 13:24:08,679 [f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-52E96576A6DB-FollowerState] INFO  impl.FollowerState (FollowerState.java:run(134)) - f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-52E96576A6DB-FollowerState: change to CANDIDATE, lastRpcElapsedTime:5021042213ns, electionTimeout:5011ms
2021-10-05 13:24:08,679 [f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-52E96576A6DB-FollowerState] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(108)) - f990c0ed-f7f2-4f8a-8ec9-db097d9c855e: shutdown f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-52E96576A6DB-FollowerState
2021-10-05 13:24:08,679 [f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-52E96576A6DB-FollowerState] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(285)) - f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-52E96576A6DB: changes role from  FOLLOWER to CANDIDATE at term 2 for changeToCandidate
2021-10-05 13:24:08,679 [f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-52E96576A6DB-FollowerState] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.leaderelection.pre-vote = false (custom)
2021-10-05 13:24:08,679 [f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-52E96576A6DB-FollowerState] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(130)) - f990c0ed-f7f2-4f8a-8ec9-db097d9c855e: start f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-52E96576A6DB-LeaderElection12
2021-10-05 13:24:08,687 [grpc-default-executor-1] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1043)) - f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-52E96576A6DB: receive requestVote(ELECTION, a9b6c243-aad2-4cee-be19-871628539a81, group-52E96576A6DB, 3, (t:0, i:0))
2021-10-05 13:24:08,688 [a9b6c243-aad2-4cee-be19-871628539a81@group-52E96576A6DB-LeaderElection11] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(89)) - a9b6c243-aad2-4cee-be19-871628539a81@group-52E96576A6DB-LeaderElection11: ELECTION PASSED received 1 response(s) and 0 exception(s):
2021-10-05 13:24:08,694 [a9b6c243-aad2-4cee-be19-871628539a81@group-52E96576A6DB-LeaderElection11] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(93)) -   Response 0: a9b6c243-aad2-4cee-be19-871628539a81<-0c34be74-1f5b-4b04-a6d4-fde6c3deb89a#0:OK-t3
2021-10-05 13:24:08,694 [a9b6c243-aad2-4cee-be19-871628539a81@group-52E96576A6DB-LeaderElection11] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(308)) - a9b6c243-aad2-4cee-be19-871628539a81@group-52E96576A6DB-LeaderElection11 ELECTION round 0: result PASSED
2021-10-05 13:24:08,694 [a9b6c243-aad2-4cee-be19-871628539a81@group-52E96576A6DB-LeaderElection11] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(121)) - a9b6c243-aad2-4cee-be19-871628539a81: shutdown a9b6c243-aad2-4cee-be19-871628539a81@group-52E96576A6DB-LeaderElection11
2021-10-05 13:24:08,694 [a9b6c243-aad2-4cee-be19-871628539a81@group-52E96576A6DB-LeaderElection11] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(285)) - a9b6c243-aad2-4cee-be19-871628539a81@group-52E96576A6DB: changes role from CANDIDATE to LEADER at term 3 for changeToLeader
2021-10-05 13:24:08,694 [a9b6c243-aad2-4cee-be19-871628539a81@group-52E96576A6DB-LeaderElection11] INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:handleLeaderChangedNotification(861)) - Leader change notification received for group: group-52E96576A6DB with new leaderId: a9b6c243-aad2-4cee-be19-871628539a81
2021-10-05 13:24:08,695 [a9b6c243-aad2-4cee-be19-871628539a81@group-52E96576A6DB-LeaderElection11] INFO  server.RaftServer$Division (ServerState.java:setLeader(285)) - a9b6c243-aad2-4cee-be19-871628539a81@group-52E96576A6DB: change Leader from null to a9b6c243-aad2-4cee-be19-871628539a81 at term 3 for becomeLeader, leader elected after 15044ms
2021-10-05 13:24:08,695 [a9b6c243-aad2-4cee-be19-871628539a81@group-52E96576A6DB-LeaderElection11] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.staging.catchup.gap = 1000 (default)
2021-10-05 13:24:08,695 [a9b6c243-aad2-4cee-be19-871628539a81@group-52E96576A6DB-LeaderElection11] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.write.element-limit = 1024 (custom)
2021-10-05 13:24:08,695 [a9b6c243-aad2-4cee-be19-871628539a81@group-52E96576A6DB-LeaderElection11] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.write.byte-limit = 1024 M (=1073741824) (custom)
2021-10-05 13:24:08,695 [a9b6c243-aad2-4cee-be19-871628539a81@group-52E96576A6DB-LeaderElection11] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.watch.timeout = 180s (custom)
2021-10-05 13:24:08,695 [a9b6c243-aad2-4cee-be19-871628539a81@group-52E96576A6DB-LeaderElection11] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.watch.timeout.denomination = 1s (default)
2021-10-05 13:24:08,695 [a9b6c243-aad2-4cee-be19-871628539a81@group-52E96576A6DB-LeaderElection11] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.watch.element-limit = 65536 (default)
2021-10-05 13:24:08,696 [a9b6c243-aad2-4cee-be19-871628539a81@group-52E96576A6DB-LeaderElection11] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2021-10-05 13:24:08,696 [a9b6c243-aad2-4cee-be19-871628539a81@group-52E96576A6DB-LeaderElection11] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2021-10-05 13:24:08,696 [a9b6c243-aad2-4cee-be19-871628539a81@group-52E96576A6DB-LeaderElection11] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.appender.buffer.element-limit = 1 (custom)
2021-10-05 13:24:08,696 [a9b6c243-aad2-4cee-be19-871628539a81@group-52E96576A6DB-LeaderElection11] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(44)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2021-10-05 13:24:08,696 [a9b6c243-aad2-4cee-be19-871628539a81@group-52E96576A6DB-LeaderElection11] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.request.timeout = 60s (custom)
2021-10-05 13:24:08,696 [a9b6c243-aad2-4cee-be19-871628539a81@group-52E96576A6DB-LeaderElection11] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.appender.install.snapshot.enabled = false (custom)
2021-10-05 13:24:08,696 [EventQueue-PipelineReportForPipelineReportHandler] INFO  pipeline.PipelineManagerImpl (PipelineManagerImpl.java:openPipeline(282)) - Pipeline Pipeline[ Id: 8c8a590d-1d11-430c-931a-52e96576a6db, Nodes: f990c0ed-f7f2-4f8a-8ec9-db097d9c855e{ip: 127.0.0.1, host: localhost, ports: [REPLICATION=39769, RATIS=44595, RATIS_ADMIN=44595, RATIS_SERVER=44595, STANDALONE=39009], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}0c34be74-1f5b-4b04-a6d4-fde6c3deb89a{ip: 127.0.0.1, host: localhost, ports: [REPLICATION=46311, RATIS=33359, RATIS_ADMIN=33359, RATIS_SERVER=33359, STANDALONE=44513], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}a9b6c243-aad2-4cee-be19-871628539a81{ip: 127.0.0.1, host: localhost, ports: [REPLICATION=45095, RATIS=36351, RATIS_ADMIN=36351, RATIS_SERVER=36351, STANDALONE=33273], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}, ReplicationConfig: RATIS/THREE, State:ALLOCATED, leaderId:a9b6c243-aad2-4cee-be19-871628539a81, CreationTimestamp2021-10-05T13:23:50.875Z[Etc/UTC]] moved to OPEN state
2021-10-05 13:24:08,696 [a9b6c243-aad2-4cee-be19-871628539a81@group-52E96576A6DB-LeaderElection11] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2021-10-05 13:24:08,697 [a9b6c243-aad2-4cee-be19-871628539a81@group-52E96576A6DB-LeaderElection11] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2021-10-05 13:24:08,697 [a9b6c243-aad2-4cee-be19-871628539a81@group-52E96576A6DB-LeaderElection11] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.appender.buffer.element-limit = 1 (custom)
2021-10-05 13:24:08,697 [a9b6c243-aad2-4cee-be19-871628539a81@group-52E96576A6DB-LeaderElection11] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(44)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2021-10-05 13:24:08,697 [a9b6c243-aad2-4cee-be19-871628539a81@group-52E96576A6DB-LeaderElection11] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.request.timeout = 60s (custom)
2021-10-05 13:24:08,697 [a9b6c243-aad2-4cee-be19-871628539a81@group-52E96576A6DB-LeaderElection11] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.appender.install.snapshot.enabled = false (custom)
2021-10-05 13:24:08,698 [EventQueue-PipelineReportForPipelineReportHandler] INFO  pipeline.PipelineManagerImpl (PipelineManagerImpl.java:openPipeline(282)) - Pipeline Pipeline[ Id: 8c8a590d-1d11-430c-931a-52e96576a6db, Nodes: f990c0ed-f7f2-4f8a-8ec9-db097d9c855e{ip: 127.0.0.1, host: localhost, ports: [REPLICATION=39769, RATIS=44595, RATIS_ADMIN=44595, RATIS_SERVER=44595, STANDALONE=39009], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}0c34be74-1f5b-4b04-a6d4-fde6c3deb89a{ip: 127.0.0.1, host: localhost, ports: [REPLICATION=46311, RATIS=33359, RATIS_ADMIN=33359, RATIS_SERVER=33359, STANDALONE=44513], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}a9b6c243-aad2-4cee-be19-871628539a81{ip: 127.0.0.1, host: localhost, ports: [REPLICATION=45095, RATIS=36351, RATIS_ADMIN=36351, RATIS_SERVER=36351, STANDALONE=33273], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}, ReplicationConfig: RATIS/THREE, State:ALLOCATED, leaderId:a9b6c243-aad2-4cee-be19-871628539a81, CreationTimestamp2021-10-05T13:23:50.875Z[Etc/UTC]] moved to OPEN state
2021-10-05 13:24:08,700 [EventQueue-PipelineReportForPipelineReportHandler] INFO  ha.SCMHAInvocationHandler (SCMHAInvocationHandler.java:invokeRatis(113)) - Invoking method public abstract void org.apache.hadoop.hdds.scm.pipeline.PipelineStateManager.updatePipelineState(org.apache.hadoop.hdds.protocol.proto.HddsProtos$PipelineID,org.apache.hadoop.hdds.protocol.proto.HddsProtos$PipelineState) throws java.io.IOException on target org.apache.hadoop.hdds.scm.ha.SCMRatisServerImpl@4caa9da2, cost 221.723us
2021-10-05 13:24:08,699 [a9b6c243-aad2-4cee-be19-871628539a81@group-52E96576A6DB-LeaderElection11] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(130)) - a9b6c243-aad2-4cee-be19-871628539a81: start a9b6c243-aad2-4cee-be19-871628539a81@group-52E96576A6DB-LeaderStateImpl
2021-10-05 13:24:08,705 [a9b6c243-aad2-4cee-be19-871628539a81@group-52E96576A6DB-LeaderElection11] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:startLogSegment(394)) - a9b6c243-aad2-4cee-be19-871628539a81@group-52E96576A6DB-SegmentedRaftLogWorker: Starting segment from index:0
2021-10-05 13:24:08,699 [f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-52E96576A6DB-LeaderElection12] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(306)) - f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-52E96576A6DB-LeaderElection12 ELECTION round 0: submit vote requests at term 3 for -1: [0c34be74-1f5b-4b04-a6d4-fde6c3deb89a|rpc:127.0.0.1:33359|priority:0, f990c0ed-f7f2-4f8a-8ec9-db097d9c855e|rpc:127.0.0.1:44595|priority:0, a9b6c243-aad2-4cee-be19-871628539a81|rpc:127.0.0.1:36351|priority:1], old=null
2021-10-05 13:24:08,704 [EventQueue-PipelineReportForPipelineReportHandler] INFO  ha.SCMHAInvocationHandler (SCMHAInvocationHandler.java:invokeRatis(113)) - Invoking method public abstract void org.apache.hadoop.hdds.scm.pipeline.PipelineStateManager.updatePipelineState(org.apache.hadoop.hdds.protocol.proto.HddsProtos$PipelineID,org.apache.hadoop.hdds.protocol.proto.HddsProtos$PipelineState) throws java.io.IOException on target org.apache.hadoop.hdds.scm.ha.SCMRatisServerImpl@6344f74b, cost 7119.621us
2021-10-05 13:24:08,700 [grpc-default-executor-1] INFO  impl.VoteContext (VoteContext.java:log(48)) - f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-52E96576A6DB-CANDIDATE: reject ELECTION from a9b6c243-aad2-4cee-be19-871628539a81: already has voted for f990c0ed-f7f2-4f8a-8ec9-db097d9c855e at current term 3
2021-10-05 13:24:08,700 [EventQueue-OpenPipelineForHealthyPipelineSafeModeRule] INFO  safemode.SCMSafeModeManager (HealthyPipelineSafeModeRule.java:process(124)) - SCM in safe mode. Healthy pipelines reported count is 1, required healthy pipeline reported count is 1
2021-10-05 13:24:08,706 [grpc-default-executor-1] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1075)) - f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-52E96576A6DB replies to ELECTION vote request: a9b6c243-aad2-4cee-be19-871628539a81<-f990c0ed-f7f2-4f8a-8ec9-db097d9c855e#0:FAIL-t3. Peer's state: f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-52E96576A6DB:t3, leader=null, voted=f990c0ed-f7f2-4f8a-8ec9-db097d9c855e, raftlog=f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-52E96576A6DB-SegmentedRaftLog:OPENED:c-1,f-1,i0, conf=-1: [0c34be74-1f5b-4b04-a6d4-fde6c3deb89a|rpc:127.0.0.1:33359|priority:0, f990c0ed-f7f2-4f8a-8ec9-db097d9c855e|rpc:127.0.0.1:44595|priority:0, a9b6c243-aad2-4cee-be19-871628539a81|rpc:127.0.0.1:36351|priority:1], old=null
2021-10-05 13:24:08,706 [EventQueue-OpenPipelineForHealthyPipelineSafeModeRule] INFO  safemode.SCMSafeModeManager (SCMSafeModeManager.java:validateSafeModeExitRules(204)) - HealthyPipelineSafeModeRule rule is successfully validated
2021-10-05 13:24:08,706 [EventQueue-OpenPipelineForHealthyPipelineSafeModeRule] INFO  safemode.SCMSafeModeManager (SCMSafeModeManager.java:validateSafeModeExitRules(219)) - ScmSafeModeManager, all rules are successfully validated
2021-10-05 13:24:08,706 [EventQueue-OpenPipelineForHealthyPipelineSafeModeRule] INFO  safemode.SCMSafeModeManager (SCMSafeModeManager.java:exitSafeMode(248)) - SCM exiting safe mode.
2021-10-05 13:24:08,706 [EventQueue-OpenPipelineForHealthyPipelineSafeModeRule] WARN  events.EventQueue (EventQueue.java:fireEvent(194)) - No event handler registered for event TypedEvent{payloadType=SafeModeStatus, name='Safe mode status'}
2021-10-05 13:24:08,706 [EventQueue-OpenPipelineForHealthyPipelineSafeModeRule] INFO  ha.SCMContext (SCMContext.java:updateSafeModeStatus(205)) - Update SafeModeStatus from SafeModeStatus{safeModeStatus=true, preCheckPassed=true} to SafeModeStatus{safeModeStatus=false, preCheckPassed=true}.
2021-10-05 13:24:08,709 [a9b6c243-aad2-4cee-be19-871628539a81@group-52E96576A6DB-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(601)) - a9b6c243-aad2-4cee-be19-871628539a81@group-52E96576A6DB-SegmentedRaftLogWorker: created new log segment /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-98f4f1fb-613f-4a4a-83a3-c748f4b4520d/datanode-2/data/ratis/8c8a590d-1d11-430c-931a-52e96576a6db/current/log_inprogress_0
2021-10-05 13:24:08,727 [a9b6c243-aad2-4cee-be19-871628539a81@group-52E96576A6DB-LeaderElection11] INFO  server.RaftServer$Division (ServerState.java:setRaftConf(387)) - a9b6c243-aad2-4cee-be19-871628539a81@group-52E96576A6DB: set configuration 0: [0c34be74-1f5b-4b04-a6d4-fde6c3deb89a|rpc:127.0.0.1:33359|dataStream:|priority:0, f990c0ed-f7f2-4f8a-8ec9-db097d9c855e|rpc:127.0.0.1:44595|dataStream:|priority:0, a9b6c243-aad2-4cee-be19-871628539a81|rpc:127.0.0.1:36351|dataStream:|priority:1], old=null
2021-10-05 13:24:08,732 [grpc-default-executor-1] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1043)) - 0c34be74-1f5b-4b04-a6d4-fde6c3deb89a@group-52E96576A6DB: receive requestVote(ELECTION, f990c0ed-f7f2-4f8a-8ec9-db097d9c855e, group-52E96576A6DB, 3, (t:0, i:0))
2021-10-05 13:24:08,732 [grpc-default-executor-1] INFO  impl.VoteContext (VoteContext.java:log(48)) - 0c34be74-1f5b-4b04-a6d4-fde6c3deb89a@group-52E96576A6DB-FOLLOWER: reject ELECTION from f990c0ed-f7f2-4f8a-8ec9-db097d9c855e: already has voted for a9b6c243-aad2-4cee-be19-871628539a81 at current term 3
2021-10-05 13:24:08,732 [grpc-default-executor-1] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1075)) - 0c34be74-1f5b-4b04-a6d4-fde6c3deb89a@group-52E96576A6DB replies to ELECTION vote request: f990c0ed-f7f2-4f8a-8ec9-db097d9c855e<-0c34be74-1f5b-4b04-a6d4-fde6c3deb89a#0:FAIL-t3. Peer's state: 0c34be74-1f5b-4b04-a6d4-fde6c3deb89a@group-52E96576A6DB:t3, leader=null, voted=a9b6c243-aad2-4cee-be19-871628539a81, raftlog=0c34be74-1f5b-4b04-a6d4-fde6c3deb89a@group-52E96576A6DB-SegmentedRaftLog:OPENED:c-1,f-1,i0, conf=-1: [0c34be74-1f5b-4b04-a6d4-fde6c3deb89a|rpc:127.0.0.1:33359|dataStream:|priority:0, f990c0ed-f7f2-4f8a-8ec9-db097d9c855e|rpc:127.0.0.1:44595|dataStream:|priority:0, a9b6c243-aad2-4cee-be19-871628539a81|rpc:127.0.0.1:36351|dataStream:|priority:1], old=null
2021-10-05 13:24:08,732 [grpc-default-executor-0] INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:handleLeaderChangedNotification(861)) - Leader change notification received for group: group-52E96576A6DB with new leaderId: a9b6c243-aad2-4cee-be19-871628539a81
2021-10-05 13:24:08,732 [grpc-default-executor-0] INFO  server.RaftServer$Division (ServerState.java:setLeader(285)) - 0c34be74-1f5b-4b04-a6d4-fde6c3deb89a@group-52E96576A6DB: change Leader from null to a9b6c243-aad2-4cee-be19-871628539a81 at term 3 for appendEntries, leader elected after 15198ms
2021-10-05 13:24:08,734 [grpc-default-executor-3] INFO  server.RaftServer$Division (ServerState.java:setRaftConf(387)) - 0c34be74-1f5b-4b04-a6d4-fde6c3deb89a@group-52E96576A6DB: set configuration 0: [0c34be74-1f5b-4b04-a6d4-fde6c3deb89a|rpc:127.0.0.1:33359|dataStream:|priority:0, f990c0ed-f7f2-4f8a-8ec9-db097d9c855e|rpc:127.0.0.1:44595|dataStream:|priority:0, a9b6c243-aad2-4cee-be19-871628539a81|rpc:127.0.0.1:36351|dataStream:|priority:1], old=null
2021-10-05 13:24:08,734 [grpc-default-executor-3] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:startLogSegment(394)) - 0c34be74-1f5b-4b04-a6d4-fde6c3deb89a@group-52E96576A6DB-SegmentedRaftLogWorker: Starting segment from index:0
2021-10-05 13:24:08,736 [0c34be74-1f5b-4b04-a6d4-fde6c3deb89a@group-52E96576A6DB-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(601)) - 0c34be74-1f5b-4b04-a6d4-fde6c3deb89a@group-52E96576A6DB-SegmentedRaftLogWorker: created new log segment /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-98f4f1fb-613f-4a4a-83a3-c748f4b4520d/datanode-1/data/ratis/8c8a590d-1d11-430c-931a-52e96576a6db/current/log_inprogress_0
2021-10-05 13:24:08,736 [grpc-default-executor-4] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(285)) - f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-52E96576A6DB: changes role from CANDIDATE to FOLLOWER at term 3 for appendEntries
2021-10-05 13:24:08,736 [grpc-default-executor-4] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(121)) - f990c0ed-f7f2-4f8a-8ec9-db097d9c855e: shutdown f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-52E96576A6DB-LeaderElection12
2021-10-05 13:24:08,736 [grpc-default-executor-4] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(130)) - f990c0ed-f7f2-4f8a-8ec9-db097d9c855e: start f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-52E96576A6DB-FollowerState
2021-10-05 13:24:08,737 [grpc-default-executor-4] INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:handleLeaderChangedNotification(861)) - Leader change notification received for group: group-52E96576A6DB with new leaderId: a9b6c243-aad2-4cee-be19-871628539a81
2021-10-05 13:24:08,737 [grpc-default-executor-4] INFO  server.RaftServer$Division (ServerState.java:setLeader(285)) - f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-52E96576A6DB: change Leader from null to a9b6c243-aad2-4cee-be19-871628539a81 at term 3 for appendEntries, leader elected after 15332ms
2021-10-05 13:24:08,738 [Listener at 127.0.0.1/10356] INFO  ha.SCMHAInvocationHandler (SCMHAInvocationHandler.java:invokeRatis(113)) - Invoking method public abstract void org.apache.hadoop.hdds.scm.container.ContainerStateManagerV2.addContainer(org.apache.hadoop.hdds.protocol.proto.HddsProtos$ContainerInfoProto) throws java.io.IOException on target org.apache.hadoop.hdds.scm.ha.SCMRatisServerImpl@6344f74b, cost 11332.848us
2021-10-05 13:24:08,738 [grpc-default-executor-3] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1043)) - a9b6c243-aad2-4cee-be19-871628539a81@group-52E96576A6DB: receive requestVote(ELECTION, f990c0ed-f7f2-4f8a-8ec9-db097d9c855e, group-52E96576A6DB, 3, (t:0, i:0))
2021-10-05 13:24:08,738 [grpc-default-executor-3] INFO  impl.VoteContext (VoteContext.java:log(48)) - a9b6c243-aad2-4cee-be19-871628539a81@group-52E96576A6DB-LEADER: reject ELECTION from f990c0ed-f7f2-4f8a-8ec9-db097d9c855e: already has voted for a9b6c243-aad2-4cee-be19-871628539a81 at current term 3
2021-10-05 13:24:08,738 [grpc-default-executor-3] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1075)) - a9b6c243-aad2-4cee-be19-871628539a81@group-52E96576A6DB replies to ELECTION vote request: f990c0ed-f7f2-4f8a-8ec9-db097d9c855e<-a9b6c243-aad2-4cee-be19-871628539a81#0:FAIL-t3. Peer's state: a9b6c243-aad2-4cee-be19-871628539a81@group-52E96576A6DB:t3, leader=a9b6c243-aad2-4cee-be19-871628539a81, voted=a9b6c243-aad2-4cee-be19-871628539a81, raftlog=a9b6c243-aad2-4cee-be19-871628539a81@group-52E96576A6DB-SegmentedRaftLog:OPENED:c0,f0,i0, conf=0: [0c34be74-1f5b-4b04-a6d4-fde6c3deb89a|rpc:127.0.0.1:33359|dataStream:|priority:0, f990c0ed-f7f2-4f8a-8ec9-db097d9c855e|rpc:127.0.0.1:44595|dataStream:|priority:0, a9b6c243-aad2-4cee-be19-871628539a81|rpc:127.0.0.1:36351|dataStream:|priority:1], old=null
2021-10-05 13:24:08,739 [f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-52E96576A6DB-LeaderElection12] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(89)) - f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-52E96576A6DB-LeaderElection12: ELECTION REJECTED received 1 response(s) and 0 exception(s):
2021-10-05 13:24:08,739 [f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-52E96576A6DB-LeaderElection12] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(93)) -   Response 0: f990c0ed-f7f2-4f8a-8ec9-db097d9c855e<-a9b6c243-aad2-4cee-be19-871628539a81#0:FAIL-t3
2021-10-05 13:24:08,740 [f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-52E96576A6DB-LeaderElection12] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(308)) - f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-52E96576A6DB-LeaderElection12 ELECTION round 0: result REJECTED
2021-10-05 13:24:08,748 [grpc-default-executor-3] INFO  server.RaftServer$Division (ServerState.java:setRaftConf(387)) - f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-52E96576A6DB: set configuration 0: [0c34be74-1f5b-4b04-a6d4-fde6c3deb89a|rpc:127.0.0.1:33359|dataStream:|priority:0, f990c0ed-f7f2-4f8a-8ec9-db097d9c855e|rpc:127.0.0.1:44595|dataStream:|priority:0, a9b6c243-aad2-4cee-be19-871628539a81|rpc:127.0.0.1:36351|dataStream:|priority:1], old=null
2021-10-05 13:24:08,749 [grpc-default-executor-3] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:startLogSegment(394)) - f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-52E96576A6DB-SegmentedRaftLogWorker: Starting segment from index:0
2021-10-05 13:24:08,750 [f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-52E96576A6DB-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(601)) - f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-52E96576A6DB-SegmentedRaftLogWorker: created new log segment /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-98f4f1fb-613f-4a4a-83a3-c748f4b4520d/datanode-0/data/ratis/8c8a590d-1d11-430c-931a-52e96576a6db/current/log_inprogress_0
2021-10-05 13:24:08,752 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  ha.SCMStateMachine (SCMStateMachine.java:takeSnapshot(290)) - Current Snapshot Index 120, takeSnapshot took 0 ms
2021-10-05 13:24:08,752 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:takeSnapshot(281)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater: Took a snapshot at index 120
2021-10-05 13:24:08,752 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:lambda$new$0(89)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater: snapshotIndex: updateIncreasingly 115 -> 120
2021-10-05 13:24:08,752 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:purge(306)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-SegmentedRaftLog: purge 120
2021-10-05 13:24:08,752 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-SegmentedRaftLog: snapshotIndex: updateIncreasingly 115 -> 120
2021-10-05 13:24:08,752 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-SegmentedRaftLog: purgeIndex: updateToMax old=115, new=120, updated? true
2021-10-05 13:24:08,841 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  ha.SCMStateMachine (SCMStateMachine.java:takeSnapshot(290)) - Current Snapshot Index 120, takeSnapshot took 0 ms
2021-10-05 13:24:08,841 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:takeSnapshot(281)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater: Took a snapshot at index 120
2021-10-05 13:24:08,841 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:lambda$new$0(89)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater: snapshotIndex: updateIncreasingly 115 -> 120
2021-10-05 13:24:08,841 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:purge(306)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-SegmentedRaftLog: purge 120
2021-10-05 13:24:08,841 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-SegmentedRaftLog: snapshotIndex: updateIncreasingly 115 -> 120
2021-10-05 13:24:08,841 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-SegmentedRaftLog: purgeIndex: updateToMax old=115, new=120, updated? true
2021-10-05 13:24:08,843 [Listener at 127.0.0.1/10356] INFO  ha.SCMHAInvocationHandler (SCMHAInvocationHandler.java:invokeRatis(113)) - Invoking method public abstract void org.apache.hadoop.hdds.scm.container.ContainerStateManagerV2.addContainer(org.apache.hadoop.hdds.protocol.proto.HddsProtos$ContainerInfoProto) throws java.io.IOException on target org.apache.hadoop.hdds.scm.ha.SCMRatisServerImpl@6344f74b, cost 4619.468us
2021-10-05 13:24:08,949 [Listener at 127.0.0.1/10356] INFO  ha.SCMHAInvocationHandler (SCMHAInvocationHandler.java:invokeRatis(113)) - Invoking method public abstract void org.apache.hadoop.hdds.scm.container.ContainerStateManagerV2.addContainer(org.apache.hadoop.hdds.protocol.proto.HddsProtos$ContainerInfoProto) throws java.io.IOException on target org.apache.hadoop.hdds.scm.ha.SCMRatisServerImpl@6344f74b, cost 5127.019us
2021-10-05 13:24:09,056 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  ha.SCMStateMachine (SCMStateMachine.java:takeSnapshot(290)) - Current Snapshot Index 125, takeSnapshot took 0 ms
2021-10-05 13:24:09,056 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:takeSnapshot(281)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater: Took a snapshot at index 125
2021-10-05 13:24:09,056 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:lambda$new$0(89)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater: snapshotIndex: updateIncreasingly 120 -> 125
2021-10-05 13:24:09,056 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:purge(306)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-SegmentedRaftLog: purge 125
2021-10-05 13:24:09,056 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-SegmentedRaftLog: snapshotIndex: updateIncreasingly 120 -> 125
2021-10-05 13:24:09,056 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-SegmentedRaftLog: purgeIndex: updateToMax old=120, new=125, updated? true
2021-10-05 13:24:09,057 [Listener at 127.0.0.1/10356] INFO  ha.SCMHAInvocationHandler (SCMHAInvocationHandler.java:invokeRatis(113)) - Invoking method public abstract void org.apache.hadoop.hdds.scm.container.ContainerStateManagerV2.addContainer(org.apache.hadoop.hdds.protocol.proto.HddsProtos$ContainerInfoProto) throws java.io.IOException on target org.apache.hadoop.hdds.scm.ha.SCMRatisServerImpl@6344f74b, cost 6247.233us
2021-10-05 13:24:09,063 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  ha.SCMStateMachine (SCMStateMachine.java:takeSnapshot(290)) - Current Snapshot Index 125, takeSnapshot took 0 ms
2021-10-05 13:24:09,063 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:takeSnapshot(281)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater: Took a snapshot at index 125
2021-10-05 13:24:09,063 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:lambda$new$0(89)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater: snapshotIndex: updateIncreasingly 120 -> 125
2021-10-05 13:24:09,063 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:purge(306)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-SegmentedRaftLog: purge 125
2021-10-05 13:24:09,063 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-SegmentedRaftLog: snapshotIndex: updateIncreasingly 120 -> 125
2021-10-05 13:24:09,064 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-SegmentedRaftLog: purgeIndex: updateToMax old=120, new=125, updated? true
2021-10-05 13:24:09,164 [Listener at 127.0.0.1/10356] INFO  ha.SCMHAInvocationHandler (SCMHAInvocationHandler.java:invokeRatis(113)) - Invoking method public abstract void org.apache.hadoop.hdds.scm.container.ContainerStateManagerV2.addContainer(org.apache.hadoop.hdds.protocol.proto.HddsProtos$ContainerInfoProto) throws java.io.IOException on target org.apache.hadoop.hdds.scm.ha.SCMRatisServerImpl@6344f74b, cost 6052.413us
2021-10-05 13:24:09,270 [Listener at 127.0.0.1/10356] INFO  ha.SCMHAInvocationHandler (SCMHAInvocationHandler.java:invokeRatis(113)) - Invoking method public abstract void org.apache.hadoop.hdds.scm.container.ContainerStateManagerV2.addContainer(org.apache.hadoop.hdds.protocol.proto.HddsProtos$ContainerInfoProto) throws java.io.IOException on target org.apache.hadoop.hdds.scm.ha.SCMRatisServerImpl@6344f74b, cost 5408.147us
2021-10-05 13:24:09,274 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  ha.SCMStateMachine (SCMStateMachine.java:takeSnapshot(290)) - Current Snapshot Index 130, takeSnapshot took 0 ms
2021-10-05 13:24:09,274 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:takeSnapshot(281)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater: Took a snapshot at index 130
2021-10-05 13:24:09,274 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:lambda$new$0(89)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater: snapshotIndex: updateIncreasingly 125 -> 130
2021-10-05 13:24:09,274 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:purge(306)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-SegmentedRaftLog: purge 130
2021-10-05 13:24:09,274 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-SegmentedRaftLog: snapshotIndex: updateIncreasingly 125 -> 130
2021-10-05 13:24:09,275 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-SegmentedRaftLog: purgeIndex: updateToMax old=125, new=130, updated? true
2021-10-05 13:24:09,374 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  ha.SCMStateMachine (SCMStateMachine.java:takeSnapshot(290)) - Current Snapshot Index 130, takeSnapshot took 0 ms
2021-10-05 13:24:09,374 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:takeSnapshot(281)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater: Took a snapshot at index 130
2021-10-05 13:24:09,375 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:lambda$new$0(89)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater: snapshotIndex: updateIncreasingly 125 -> 130
2021-10-05 13:24:09,375 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:purge(306)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-SegmentedRaftLog: purge 130
2021-10-05 13:24:09,375 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-SegmentedRaftLog: snapshotIndex: updateIncreasingly 125 -> 130
2021-10-05 13:24:09,375 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-SegmentedRaftLog: purgeIndex: updateToMax old=125, new=130, updated? true
2021-10-05 13:24:09,376 [Listener at 127.0.0.1/10356] INFO  ha.SCMHAInvocationHandler (SCMHAInvocationHandler.java:invokeRatis(113)) - Invoking method public abstract void org.apache.hadoop.hdds.scm.container.ContainerStateManagerV2.addContainer(org.apache.hadoop.hdds.protocol.proto.HddsProtos$ContainerInfoProto) throws java.io.IOException on target org.apache.hadoop.hdds.scm.ha.SCMRatisServerImpl@6344f74b, cost 5173.323us
2021-10-05 13:24:09,480 [Listener at 127.0.0.1/10356] INFO  ha.SCMHAInvocationHandler (SCMHAInvocationHandler.java:invokeRatis(113)) - Invoking method public abstract void org.apache.hadoop.hdds.scm.container.ContainerStateManagerV2.addContainer(org.apache.hadoop.hdds.protocol.proto.HddsProtos$ContainerInfoProto) throws java.io.IOException on target org.apache.hadoop.hdds.scm.ha.SCMRatisServerImpl@6344f74b, cost 3514.656us
2021-10-05 13:24:09,585 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  ha.SCMStateMachine (SCMStateMachine.java:takeSnapshot(290)) - Current Snapshot Index 135, takeSnapshot took 0 ms
2021-10-05 13:24:09,585 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:takeSnapshot(281)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater: Took a snapshot at index 135
2021-10-05 13:24:09,585 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:lambda$new$0(89)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater: snapshotIndex: updateIncreasingly 130 -> 135
2021-10-05 13:24:09,586 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:purge(306)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-SegmentedRaftLog: purge 135
2021-10-05 13:24:09,586 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-SegmentedRaftLog: snapshotIndex: updateIncreasingly 130 -> 135
2021-10-05 13:24:09,586 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-SegmentedRaftLog: purgeIndex: updateToMax old=130, new=135, updated? true
2021-10-05 13:24:09,586 [Listener at 127.0.0.1/10356] INFO  ha.SCMHAInvocationHandler (SCMHAInvocationHandler.java:invokeRatis(113)) - Invoking method public abstract void org.apache.hadoop.hdds.scm.container.ContainerStateManagerV2.addContainer(org.apache.hadoop.hdds.protocol.proto.HddsProtos$ContainerInfoProto) throws java.io.IOException on target org.apache.hadoop.hdds.scm.ha.SCMRatisServerImpl@6344f74b, cost 6107.019us
2021-10-05 13:24:09,588 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  ha.SCMStateMachine (SCMStateMachine.java:takeSnapshot(290)) - Current Snapshot Index 135, takeSnapshot took 0 ms
2021-10-05 13:24:09,588 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:takeSnapshot(281)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater: Took a snapshot at index 135
2021-10-05 13:24:09,589 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:lambda$new$0(89)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater: snapshotIndex: updateIncreasingly 130 -> 135
2021-10-05 13:24:09,589 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:purge(306)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-SegmentedRaftLog: purge 135
2021-10-05 13:24:09,589 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-SegmentedRaftLog: snapshotIndex: updateIncreasingly 130 -> 135
2021-10-05 13:24:09,589 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-SegmentedRaftLog: purgeIndex: updateToMax old=130, new=135, updated? true
2021-10-05 13:24:09,693 [Listener at 127.0.0.1/10356] INFO  ha.SCMHAInvocationHandler (SCMHAInvocationHandler.java:invokeRatis(113)) - Invoking method public abstract void org.apache.hadoop.hdds.scm.container.ContainerStateManagerV2.addContainer(org.apache.hadoop.hdds.protocol.proto.HddsProtos$ContainerInfoProto) throws java.io.IOException on target org.apache.hadoop.hdds.scm.ha.SCMRatisServerImpl@6344f74b, cost 5287.435us
2021-10-05 13:24:09,796 [Listener at 127.0.0.1/10356] INFO  ha.SCMHAInvocationHandler (SCMHAInvocationHandler.java:invokeRatis(113)) - Invoking method public abstract void org.apache.hadoop.hdds.scm.container.ContainerStateManagerV2.addContainer(org.apache.hadoop.hdds.protocol.proto.HddsProtos$ContainerInfoProto) throws java.io.IOException on target org.apache.hadoop.hdds.scm.ha.SCMRatisServerImpl@6344f74b, cost 3197.624us
2021-10-05 13:24:09,799 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  ha.SCMStateMachine (SCMStateMachine.java:takeSnapshot(290)) - Current Snapshot Index 140, takeSnapshot took 0 ms
2021-10-05 13:24:09,799 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:takeSnapshot(281)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater: Took a snapshot at index 140
2021-10-05 13:24:09,799 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:lambda$new$0(89)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater: snapshotIndex: updateIncreasingly 135 -> 140
2021-10-05 13:24:09,799 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:purge(306)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-SegmentedRaftLog: purge 140
2021-10-05 13:24:09,799 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-SegmentedRaftLog: snapshotIndex: updateIncreasingly 135 -> 140
2021-10-05 13:24:09,799 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-SegmentedRaftLog: purgeIndex: updateToMax old=135, new=140, updated? true
2021-10-05 13:24:09,900 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  ha.SCMStateMachine (SCMStateMachine.java:takeSnapshot(290)) - Current Snapshot Index 140, takeSnapshot took 1 ms
2021-10-05 13:24:09,901 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:takeSnapshot(281)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater: Took a snapshot at index 140
2021-10-05 13:24:09,901 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:lambda$new$0(89)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater: snapshotIndex: updateIncreasingly 135 -> 140
2021-10-05 13:24:09,901 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:purge(306)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-SegmentedRaftLog: purge 140
2021-10-05 13:24:09,901 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-SegmentedRaftLog: snapshotIndex: updateIncreasingly 135 -> 140
2021-10-05 13:24:09,901 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-SegmentedRaftLog: purgeIndex: updateToMax old=135, new=140, updated? true
2021-10-05 13:24:09,903 [Listener at 127.0.0.1/10356] INFO  ha.SCMHAInvocationHandler (SCMHAInvocationHandler.java:invokeRatis(113)) - Invoking method public abstract void org.apache.hadoop.hdds.scm.container.ContainerStateManagerV2.addContainer(org.apache.hadoop.hdds.protocol.proto.HddsProtos$ContainerInfoProto) throws java.io.IOException on target org.apache.hadoop.hdds.scm.ha.SCMRatisServerImpl@6344f74b, cost 6105.618us
2021-10-05 13:24:10,008 [Listener at 127.0.0.1/10356] INFO  ha.SCMHAInvocationHandler (SCMHAInvocationHandler.java:invokeRatis(113)) - Invoking method public abstract void org.apache.hadoop.hdds.scm.container.ContainerStateManagerV2.addContainer(org.apache.hadoop.hdds.protocol.proto.HddsProtos$ContainerInfoProto) throws java.io.IOException on target org.apache.hadoop.hdds.scm.ha.SCMRatisServerImpl@6344f74b, cost 3969.202us
2021-10-05 13:24:10,113 [Listener at 127.0.0.1/10356] INFO  ha.SCMHAInvocationHandler (SCMHAInvocationHandler.java:invokeRatis(113)) - Invoking method public abstract void org.apache.hadoop.hdds.scm.container.ContainerStateManagerV2.addContainer(org.apache.hadoop.hdds.protocol.proto.HddsProtos$ContainerInfoProto) throws java.io.IOException on target org.apache.hadoop.hdds.scm.ha.SCMRatisServerImpl@6344f74b, cost 4299.835us
2021-10-05 13:24:10,113 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  ha.SCMStateMachine (SCMStateMachine.java:takeSnapshot(290)) - Current Snapshot Index 145, takeSnapshot took 0 ms
2021-10-05 13:24:10,113 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:takeSnapshot(281)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater: Took a snapshot at index 145
2021-10-05 13:24:10,113 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:lambda$new$0(89)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater: snapshotIndex: updateIncreasingly 140 -> 145
2021-10-05 13:24:10,113 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:purge(306)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-SegmentedRaftLog: purge 145
2021-10-05 13:24:10,114 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-SegmentedRaftLog: snapshotIndex: updateIncreasingly 140 -> 145
2021-10-05 13:24:10,114 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-SegmentedRaftLog: purgeIndex: updateToMax old=140, new=145, updated? true
2021-10-05 13:24:10,117 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  ha.SCMStateMachine (SCMStateMachine.java:takeSnapshot(290)) - Current Snapshot Index 145, takeSnapshot took 0 ms
2021-10-05 13:24:10,117 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:takeSnapshot(281)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater: Took a snapshot at index 145
2021-10-05 13:24:10,117 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:lambda$new$0(89)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater: snapshotIndex: updateIncreasingly 140 -> 145
2021-10-05 13:24:10,117 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:purge(306)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-SegmentedRaftLog: purge 145
2021-10-05 13:24:10,117 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-SegmentedRaftLog: snapshotIndex: updateIncreasingly 140 -> 145
2021-10-05 13:24:10,117 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-SegmentedRaftLog: purgeIndex: updateToMax old=140, new=145, updated? true
2021-10-05 13:24:10,218 [Listener at 127.0.0.1/10356] INFO  ha.SCMHAInvocationHandler (SCMHAInvocationHandler.java:invokeRatis(113)) - Invoking method public abstract void org.apache.hadoop.hdds.scm.container.ContainerStateManagerV2.addContainer(org.apache.hadoop.hdds.protocol.proto.HddsProtos$ContainerInfoProto) throws java.io.IOException on target org.apache.hadoop.hdds.scm.ha.SCMRatisServerImpl@6344f74b, cost 4783.584us
2021-10-05 13:24:10,324 [Listener at 127.0.0.1/10356] INFO  ha.SCMHAInvocationHandler (SCMHAInvocationHandler.java:invokeRatis(113)) - Invoking method public abstract void org.apache.hadoop.hdds.scm.container.ContainerStateManagerV2.addContainer(org.apache.hadoop.hdds.protocol.proto.HddsProtos$ContainerInfoProto) throws java.io.IOException on target org.apache.hadoop.hdds.scm.ha.SCMRatisServerImpl@6344f74b, cost 4329.738us
2021-10-05 13:24:10,329 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  ha.SCMStateMachine (SCMStateMachine.java:takeSnapshot(290)) - Current Snapshot Index 150, takeSnapshot took 0 ms
2021-10-05 13:24:10,329 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:takeSnapshot(281)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater: Took a snapshot at index 150
2021-10-05 13:24:10,329 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:lambda$new$0(89)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater: snapshotIndex: updateIncreasingly 145 -> 150
2021-10-05 13:24:10,329 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:purge(306)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-SegmentedRaftLog: purge 150
2021-10-05 13:24:10,329 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-SegmentedRaftLog: snapshotIndex: updateIncreasingly 145 -> 150
2021-10-05 13:24:10,329 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-SegmentedRaftLog: purgeIndex: updateToMax old=145, new=150, updated? true
2021-10-05 13:24:10,429 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  ha.SCMStateMachine (SCMStateMachine.java:takeSnapshot(290)) - Current Snapshot Index 150, takeSnapshot took 0 ms
2021-10-05 13:24:10,429 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:takeSnapshot(281)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater: Took a snapshot at index 150
2021-10-05 13:24:10,429 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:lambda$new$0(89)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater: snapshotIndex: updateIncreasingly 145 -> 150
2021-10-05 13:24:10,429 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:purge(306)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-SegmentedRaftLog: purge 150
2021-10-05 13:24:10,429 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-SegmentedRaftLog: snapshotIndex: updateIncreasingly 145 -> 150
2021-10-05 13:24:10,429 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-SegmentedRaftLog: purgeIndex: updateToMax old=145, new=150, updated? true
2021-10-05 13:24:10,431 [Listener at 127.0.0.1/10356] INFO  ha.SCMHAInvocationHandler (SCMHAInvocationHandler.java:invokeRatis(113)) - Invoking method public abstract void org.apache.hadoop.hdds.scm.container.ContainerStateManagerV2.addContainer(org.apache.hadoop.hdds.protocol.proto.HddsProtos$ContainerInfoProto) throws java.io.IOException on target org.apache.hadoop.hdds.scm.ha.SCMRatisServerImpl@6344f74b, cost 6687.276us
2021-10-05 13:24:10,536 [Listener at 127.0.0.1/10356] INFO  ha.SCMHAInvocationHandler (SCMHAInvocationHandler.java:invokeRatis(113)) - Invoking method public abstract void org.apache.hadoop.hdds.scm.container.ContainerStateManagerV2.addContainer(org.apache.hadoop.hdds.protocol.proto.HddsProtos$ContainerInfoProto) throws java.io.IOException on target org.apache.hadoop.hdds.scm.ha.SCMRatisServerImpl@6344f74b, cost 4618.768us
2021-10-05 13:24:10,650 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  ha.SCMStateMachine (SCMStateMachine.java:takeSnapshot(290)) - Current Snapshot Index 155, takeSnapshot took 0 ms
2021-10-05 13:24:10,650 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:takeSnapshot(281)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater: Took a snapshot at index 155
2021-10-05 13:24:10,650 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:lambda$new$0(89)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater: snapshotIndex: updateIncreasingly 150 -> 155
2021-10-05 13:24:10,650 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:purge(306)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-SegmentedRaftLog: purge 155
2021-10-05 13:24:10,650 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-SegmentedRaftLog: snapshotIndex: updateIncreasingly 150 -> 155
2021-10-05 13:24:10,650 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-SegmentedRaftLog: purgeIndex: updateToMax old=150, new=155, updated? true
2021-10-05 13:24:10,650 [Listener at 127.0.0.1/10356] INFO  ha.SCMHAInvocationHandler (SCMHAInvocationHandler.java:invokeRatis(113)) - Invoking method public abstract void org.apache.hadoop.hdds.scm.container.ContainerStateManagerV2.addContainer(org.apache.hadoop.hdds.protocol.proto.HddsProtos$ContainerInfoProto) throws java.io.IOException on target org.apache.hadoop.hdds.scm.ha.SCMRatisServerImpl@6344f74b, cost 11695.784us
2021-10-05 13:24:10,652 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  ha.SCMStateMachine (SCMStateMachine.java:takeSnapshot(290)) - Current Snapshot Index 155, takeSnapshot took 0 ms
2021-10-05 13:24:10,652 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:takeSnapshot(281)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater: Took a snapshot at index 155
2021-10-05 13:24:10,652 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:lambda$new$0(89)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater: snapshotIndex: updateIncreasingly 150 -> 155
2021-10-05 13:24:10,652 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:purge(306)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-SegmentedRaftLog: purge 155
2021-10-05 13:24:10,652 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-SegmentedRaftLog: snapshotIndex: updateIncreasingly 150 -> 155
2021-10-05 13:24:10,652 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-SegmentedRaftLog: purgeIndex: updateToMax old=150, new=155, updated? true
2021-10-05 13:24:10,756 [Listener at 127.0.0.1/10356] INFO  ha.SCMHAInvocationHandler (SCMHAInvocationHandler.java:invokeRatis(113)) - Invoking method public abstract void org.apache.hadoop.hdds.scm.container.ContainerStateManagerV2.addContainer(org.apache.hadoop.hdds.protocol.proto.HddsProtos$ContainerInfoProto) throws java.io.IOException on target org.apache.hadoop.hdds.scm.ha.SCMRatisServerImpl@6344f74b, cost 5357.142us
2021-10-05 13:24:10,861 [Listener at 127.0.0.1/10356] INFO  ha.SCMHAInvocationHandler (SCMHAInvocationHandler.java:invokeRatis(113)) - Invoking method public abstract void org.apache.hadoop.hdds.scm.container.ContainerStateManagerV2.addContainer(org.apache.hadoop.hdds.protocol.proto.HddsProtos$ContainerInfoProto) throws java.io.IOException on target org.apache.hadoop.hdds.scm.ha.SCMRatisServerImpl@6344f74b, cost 4453.75us
2021-10-05 13:24:10,863 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  ha.SCMStateMachine (SCMStateMachine.java:takeSnapshot(290)) - Current Snapshot Index 160, takeSnapshot took 0 ms
2021-10-05 13:24:10,864 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:takeSnapshot(281)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater: Took a snapshot at index 160
2021-10-05 13:24:10,864 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:lambda$new$0(89)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater: snapshotIndex: updateIncreasingly 155 -> 160
2021-10-05 13:24:10,864 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:purge(306)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-SegmentedRaftLog: purge 160
2021-10-05 13:24:10,864 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-SegmentedRaftLog: snapshotIndex: updateIncreasingly 155 -> 160
2021-10-05 13:24:10,864 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-SegmentedRaftLog: purgeIndex: updateToMax old=155, new=160, updated? true
2021-10-05 13:24:10,965 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  ha.SCMStateMachine (SCMStateMachine.java:takeSnapshot(290)) - Current Snapshot Index 160, takeSnapshot took 0 ms
2021-10-05 13:24:10,965 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:takeSnapshot(281)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater: Took a snapshot at index 160
2021-10-05 13:24:10,965 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:lambda$new$0(89)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater: snapshotIndex: updateIncreasingly 155 -> 160
2021-10-05 13:24:10,965 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:purge(306)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-SegmentedRaftLog: purge 160
2021-10-05 13:24:10,965 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-SegmentedRaftLog: snapshotIndex: updateIncreasingly 155 -> 160
2021-10-05 13:24:10,965 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-SegmentedRaftLog: purgeIndex: updateToMax old=155, new=160, updated? true
2021-10-05 13:24:10,966 [Listener at 127.0.0.1/10356] INFO  ha.SCMHAInvocationHandler (SCMHAInvocationHandler.java:invokeRatis(113)) - Invoking method public abstract void org.apache.hadoop.hdds.scm.container.ContainerStateManagerV2.addContainer(org.apache.hadoop.hdds.protocol.proto.HddsProtos$ContainerInfoProto) throws java.io.IOException on target org.apache.hadoop.hdds.scm.ha.SCMRatisServerImpl@6344f74b, cost 4537.359us
2021-10-05 13:24:11,071 [Listener at 127.0.0.1/10356] INFO  ha.SCMHAInvocationHandler (SCMHAInvocationHandler.java:invokeRatis(113)) - Invoking method public abstract void org.apache.hadoop.hdds.scm.container.ContainerStateManagerV2.addContainer(org.apache.hadoop.hdds.protocol.proto.HddsProtos$ContainerInfoProto) throws java.io.IOException on target org.apache.hadoop.hdds.scm.ha.SCMRatisServerImpl@6344f74b, cost 4527.058us
2021-10-05 13:24:11,177 [Listener at 127.0.0.1/10356] INFO  ha.SCMHAInvocationHandler (SCMHAInvocationHandler.java:invokeRatis(113)) - Invoking method public abstract void org.apache.hadoop.hdds.scm.container.ContainerStateManagerV2.addContainer(org.apache.hadoop.hdds.protocol.proto.HddsProtos$ContainerInfoProto) throws java.io.IOException on target org.apache.hadoop.hdds.scm.ha.SCMRatisServerImpl@6344f74b, cost 4564.462us
2021-10-05 13:24:11,177 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  ha.SCMStateMachine (SCMStateMachine.java:takeSnapshot(290)) - Current Snapshot Index 165, takeSnapshot took 0 ms
2021-10-05 13:24:11,177 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:takeSnapshot(281)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater: Took a snapshot at index 165
2021-10-05 13:24:11,177 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:lambda$new$0(89)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater: snapshotIndex: updateIncreasingly 160 -> 165
2021-10-05 13:24:11,177 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:purge(306)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-SegmentedRaftLog: purge 165
2021-10-05 13:24:11,177 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-SegmentedRaftLog: snapshotIndex: updateIncreasingly 160 -> 165
2021-10-05 13:24:11,177 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-SegmentedRaftLog: purgeIndex: updateToMax old=160, new=165, updated? true
2021-10-05 13:24:11,179 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  ha.SCMStateMachine (SCMStateMachine.java:takeSnapshot(290)) - Current Snapshot Index 165, takeSnapshot took 0 ms
2021-10-05 13:24:11,179 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:takeSnapshot(281)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater: Took a snapshot at index 165
2021-10-05 13:24:11,179 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:lambda$new$0(89)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater: snapshotIndex: updateIncreasingly 160 -> 165
2021-10-05 13:24:11,179 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:purge(306)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-SegmentedRaftLog: purge 165
2021-10-05 13:24:11,179 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-SegmentedRaftLog: snapshotIndex: updateIncreasingly 160 -> 165
2021-10-05 13:24:11,179 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-SegmentedRaftLog: purgeIndex: updateToMax old=160, new=165, updated? true
2021-10-05 13:24:11,281 [Listener at 127.0.0.1/10356] INFO  ha.SCMHAInvocationHandler (SCMHAInvocationHandler.java:invokeRatis(113)) - Invoking method public abstract void org.apache.hadoop.hdds.scm.container.ContainerStateManagerV2.addContainer(org.apache.hadoop.hdds.protocol.proto.HddsProtos$ContainerInfoProto) throws java.io.IOException on target org.apache.hadoop.hdds.scm.ha.SCMRatisServerImpl@6344f74b, cost 3263.53us
2021-10-05 13:24:11,385 [Listener at 127.0.0.1/10356] INFO  ha.SCMHAInvocationHandler (SCMHAInvocationHandler.java:invokeRatis(113)) - Invoking method public abstract void org.apache.hadoop.hdds.scm.container.ContainerStateManagerV2.addContainer(org.apache.hadoop.hdds.protocol.proto.HddsProtos$ContainerInfoProto) throws java.io.IOException on target org.apache.hadoop.hdds.scm.ha.SCMRatisServerImpl@6344f74b, cost 4010.606us
2021-10-05 13:24:11,389 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  ha.SCMStateMachine (SCMStateMachine.java:takeSnapshot(290)) - Current Snapshot Index 170, takeSnapshot took 0 ms
2021-10-05 13:24:11,389 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:takeSnapshot(281)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater: Took a snapshot at index 170
2021-10-05 13:24:11,389 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:lambda$new$0(89)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater: snapshotIndex: updateIncreasingly 165 -> 170
2021-10-05 13:24:11,389 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:purge(306)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-SegmentedRaftLog: purge 170
2021-10-05 13:24:11,389 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-SegmentedRaftLog: snapshotIndex: updateIncreasingly 165 -> 170
2021-10-05 13:24:11,389 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-SegmentedRaftLog: purgeIndex: updateToMax old=165, new=170, updated? true
2021-10-05 13:24:11,489 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  ha.SCMStateMachine (SCMStateMachine.java:takeSnapshot(290)) - Current Snapshot Index 170, takeSnapshot took 0 ms
2021-10-05 13:24:11,489 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:takeSnapshot(281)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater: Took a snapshot at index 170
2021-10-05 13:24:11,490 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:lambda$new$0(89)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater: snapshotIndex: updateIncreasingly 165 -> 170
2021-10-05 13:24:11,490 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:purge(306)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-SegmentedRaftLog: purge 170
2021-10-05 13:24:11,490 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-SegmentedRaftLog: snapshotIndex: updateIncreasingly 165 -> 170
2021-10-05 13:24:11,490 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-SegmentedRaftLog: purgeIndex: updateToMax old=165, new=170, updated? true
2021-10-05 13:24:11,492 [Listener at 127.0.0.1/10356] INFO  ha.SCMHAInvocationHandler (SCMHAInvocationHandler.java:invokeRatis(113)) - Invoking method public abstract void org.apache.hadoop.hdds.scm.container.ContainerStateManagerV2.addContainer(org.apache.hadoop.hdds.protocol.proto.HddsProtos$ContainerInfoProto) throws java.io.IOException on target org.apache.hadoop.hdds.scm.ha.SCMRatisServerImpl@6344f74b, cost 5953.002us
2021-10-05 13:24:11,597 [Listener at 127.0.0.1/10356] INFO  ha.SCMHAInvocationHandler (SCMHAInvocationHandler.java:invokeRatis(113)) - Invoking method public abstract void org.apache.hadoop.hdds.scm.container.ContainerStateManagerV2.addContainer(org.apache.hadoop.hdds.protocol.proto.HddsProtos$ContainerInfoProto) throws java.io.IOException on target org.apache.hadoop.hdds.scm.ha.SCMRatisServerImpl@6344f74b, cost 4594.965us
2021-10-05 13:24:11,696 [Datanode State Machine Thread - 0] ERROR datanode.RunningDatanodeState (RunningDatanodeState.java:computeNextContainerState(199)) - Error in executing end point task.
java.util.concurrent.ExecutionException: java.util.concurrent.TimeoutException
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.hadoop.ozone.container.common.states.datanode.RunningDatanodeState.computeNextContainerState(RunningDatanodeState.java:191)
	at org.apache.hadoop.ozone.container.common.states.datanode.RunningDatanodeState.await(RunningDatanodeState.java:231)
	at org.apache.hadoop.ozone.container.common.states.datanode.RunningDatanodeState.await(RunningDatanodeState.java:50)
	at org.apache.hadoop.ozone.container.common.statemachine.StateContext.execute(StateContext.java:629)
	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.start(DatanodeStateMachine.java:270)
	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.lambda$startDaemon$0(DatanodeStateMachine.java:457)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.util.concurrent.TimeoutException
	at java.util.concurrent.FutureTask.get(FutureTask.java:205)
	at org.apache.hadoop.ozone.container.common.states.datanode.RunningDatanodeState.lambda$execute$0(RunningDatanodeState.java:149)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
2021-10-05 13:24:11,704 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  ha.SCMStateMachine (SCMStateMachine.java:takeSnapshot(290)) - Current Snapshot Index 175, takeSnapshot took 0 ms
2021-10-05 13:24:11,704 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:takeSnapshot(281)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater: Took a snapshot at index 175
2021-10-05 13:24:11,704 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:lambda$new$0(89)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater: snapshotIndex: updateIncreasingly 170 -> 175
2021-10-05 13:24:11,704 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:purge(306)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-SegmentedRaftLog: purge 175
2021-10-05 13:24:11,705 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-SegmentedRaftLog: snapshotIndex: updateIncreasingly 170 -> 175
2021-10-05 13:24:11,705 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-SegmentedRaftLog: purgeIndex: updateToMax old=170, new=175, updated? true
2021-10-05 13:24:11,705 [Listener at 127.0.0.1/10356] INFO  ha.SCMHAInvocationHandler (SCMHAInvocationHandler.java:invokeRatis(113)) - Invoking method public abstract void org.apache.hadoop.hdds.scm.container.ContainerStateManagerV2.addContainer(org.apache.hadoop.hdds.protocol.proto.HddsProtos$ContainerInfoProto) throws java.io.IOException on target org.apache.hadoop.hdds.scm.ha.SCMRatisServerImpl@6344f74b, cost 6555.863us
2021-10-05 13:24:11,707 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  ha.SCMStateMachine (SCMStateMachine.java:takeSnapshot(290)) - Current Snapshot Index 175, takeSnapshot took 0 ms
2021-10-05 13:24:11,707 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:takeSnapshot(281)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater: Took a snapshot at index 175
2021-10-05 13:24:11,707 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:lambda$new$0(89)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater: snapshotIndex: updateIncreasingly 170 -> 175
2021-10-05 13:24:11,707 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:purge(306)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-SegmentedRaftLog: purge 175
2021-10-05 13:24:11,707 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-SegmentedRaftLog: snapshotIndex: updateIncreasingly 170 -> 175
2021-10-05 13:24:11,707 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-SegmentedRaftLog: purgeIndex: updateToMax old=170, new=175, updated? true
2021-10-05 13:24:11,811 [Listener at 127.0.0.1/10356] INFO  ha.SCMHAInvocationHandler (SCMHAInvocationHandler.java:invokeRatis(113)) - Invoking method public abstract void org.apache.hadoop.hdds.scm.container.ContainerStateManagerV2.addContainer(org.apache.hadoop.hdds.protocol.proto.HddsProtos$ContainerInfoProto) throws java.io.IOException on target org.apache.hadoop.hdds.scm.ha.SCMRatisServerImpl@6344f74b, cost 5424.649us
2021-10-05 13:24:11,917 [Listener at 127.0.0.1/10356] INFO  ha.SCMHAInvocationHandler (SCMHAInvocationHandler.java:invokeRatis(113)) - Invoking method public abstract void org.apache.hadoop.hdds.scm.container.ContainerStateManagerV2.addContainer(org.apache.hadoop.hdds.protocol.proto.HddsProtos$ContainerInfoProto) throws java.io.IOException on target org.apache.hadoop.hdds.scm.ha.SCMRatisServerImpl@6344f74b, cost 4839.49us
2021-10-05 13:24:11,919 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  ha.SCMStateMachine (SCMStateMachine.java:takeSnapshot(290)) - Current Snapshot Index 180, takeSnapshot took 0 ms
2021-10-05 13:24:11,920 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:takeSnapshot(281)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater: Took a snapshot at index 180
2021-10-05 13:24:11,920 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:lambda$new$0(89)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater: snapshotIndex: updateIncreasingly 175 -> 180
2021-10-05 13:24:11,920 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:purge(306)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-SegmentedRaftLog: purge 180
2021-10-05 13:24:11,920 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-SegmentedRaftLog: snapshotIndex: updateIncreasingly 175 -> 180
2021-10-05 13:24:11,920 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-SegmentedRaftLog: purgeIndex: updateToMax old=175, new=180, updated? true
2021-10-05 13:24:12,021 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  ha.SCMStateMachine (SCMStateMachine.java:takeSnapshot(290)) - Current Snapshot Index 180, takeSnapshot took 0 ms
2021-10-05 13:24:12,021 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:takeSnapshot(281)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater: Took a snapshot at index 180
2021-10-05 13:24:12,021 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:lambda$new$0(89)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater: snapshotIndex: updateIncreasingly 175 -> 180
2021-10-05 13:24:12,021 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:purge(306)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-SegmentedRaftLog: purge 180
2021-10-05 13:24:12,021 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-SegmentedRaftLog: snapshotIndex: updateIncreasingly 175 -> 180
2021-10-05 13:24:12,021 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-SegmentedRaftLog: purgeIndex: updateToMax old=175, new=180, updated? true
2021-10-05 13:24:12,023 [Listener at 127.0.0.1/10356] INFO  ha.SCMHAInvocationHandler (SCMHAInvocationHandler.java:invokeRatis(113)) - Invoking method public abstract void org.apache.hadoop.hdds.scm.container.ContainerStateManagerV2.addContainer(org.apache.hadoop.hdds.protocol.proto.HddsProtos$ContainerInfoProto) throws java.io.IOException on target org.apache.hadoop.hdds.scm.ha.SCMRatisServerImpl@6344f74b, cost 5611.167us
2021-10-05 13:24:12,129 [Listener at 127.0.0.1/10356] INFO  ha.SCMHAInvocationHandler (SCMHAInvocationHandler.java:invokeRatis(113)) - Invoking method public abstract void org.apache.hadoop.hdds.scm.container.ContainerStateManagerV2.addContainer(org.apache.hadoop.hdds.protocol.proto.HddsProtos$ContainerInfoProto) throws java.io.IOException on target org.apache.hadoop.hdds.scm.ha.SCMRatisServerImpl@6344f74b, cost 4978.203us
2021-10-05 13:24:12,234 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  ha.SCMStateMachine (SCMStateMachine.java:takeSnapshot(290)) - Current Snapshot Index 185, takeSnapshot took 0 ms
2021-10-05 13:24:12,234 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:takeSnapshot(281)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater: Took a snapshot at index 185
2021-10-05 13:24:12,234 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:lambda$new$0(89)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater: snapshotIndex: updateIncreasingly 180 -> 185
2021-10-05 13:24:12,234 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:purge(306)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-SegmentedRaftLog: purge 185
2021-10-05 13:24:12,234 [Listener at 127.0.0.1/10356] INFO  ha.SCMHAInvocationHandler (SCMHAInvocationHandler.java:invokeRatis(113)) - Invoking method public abstract void org.apache.hadoop.hdds.scm.container.ContainerStateManagerV2.addContainer(org.apache.hadoop.hdds.protocol.proto.HddsProtos$ContainerInfoProto) throws java.io.IOException on target org.apache.hadoop.hdds.scm.ha.SCMRatisServerImpl@6344f74b, cost 4624.867us
2021-10-05 13:24:12,235 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-SegmentedRaftLog: snapshotIndex: updateIncreasingly 180 -> 185
2021-10-05 13:24:12,235 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-SegmentedRaftLog: purgeIndex: updateToMax old=180, new=185, updated? true
2021-10-05 13:24:12,239 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  ha.SCMStateMachine (SCMStateMachine.java:takeSnapshot(290)) - Current Snapshot Index 185, takeSnapshot took 0 ms
2021-10-05 13:24:12,239 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:takeSnapshot(281)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater: Took a snapshot at index 185
2021-10-05 13:24:12,239 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:lambda$new$0(89)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater: snapshotIndex: updateIncreasingly 180 -> 185
2021-10-05 13:24:12,239 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:purge(306)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-SegmentedRaftLog: purge 185
2021-10-05 13:24:12,239 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-SegmentedRaftLog: snapshotIndex: updateIncreasingly 180 -> 185
2021-10-05 13:24:12,239 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-SegmentedRaftLog: purgeIndex: updateToMax old=180, new=185, updated? true
2021-10-05 13:24:12,340 [Listener at 127.0.0.1/10356] INFO  ha.SCMHAInvocationHandler (SCMHAInvocationHandler.java:invokeRatis(113)) - Invoking method public abstract void org.apache.hadoop.hdds.scm.container.ContainerStateManagerV2.addContainer(org.apache.hadoop.hdds.protocol.proto.HddsProtos$ContainerInfoProto) throws java.io.IOException on target org.apache.hadoop.hdds.scm.ha.SCMRatisServerImpl@6344f74b, cost 5725.578us
2021-10-05 13:24:12,446 [Listener at 127.0.0.1/10356] INFO  ha.SCMHAInvocationHandler (SCMHAInvocationHandler.java:invokeRatis(113)) - Invoking method public abstract void org.apache.hadoop.hdds.scm.container.ContainerStateManagerV2.addContainer(org.apache.hadoop.hdds.protocol.proto.HddsProtos$ContainerInfoProto) throws java.io.IOException on target org.apache.hadoop.hdds.scm.ha.SCMRatisServerImpl@6344f74b, cost 4250.93us
2021-10-05 13:24:12,449 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  ha.SCMStateMachine (SCMStateMachine.java:takeSnapshot(290)) - Current Snapshot Index 190, takeSnapshot took 0 ms
2021-10-05 13:24:12,449 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:takeSnapshot(281)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater: Took a snapshot at index 190
2021-10-05 13:24:12,449 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:lambda$new$0(89)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater: snapshotIndex: updateIncreasingly 185 -> 190
2021-10-05 13:24:12,449 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:purge(306)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-SegmentedRaftLog: purge 190
2021-10-05 13:24:12,449 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-SegmentedRaftLog: snapshotIndex: updateIncreasingly 185 -> 190
2021-10-05 13:24:12,449 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-SegmentedRaftLog: purgeIndex: updateToMax old=185, new=190, updated? true
2021-10-05 13:24:12,549 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  ha.SCMStateMachine (SCMStateMachine.java:takeSnapshot(290)) - Current Snapshot Index 190, takeSnapshot took 0 ms
2021-10-05 13:24:12,549 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:takeSnapshot(281)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater: Took a snapshot at index 190
2021-10-05 13:24:12,549 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:lambda$new$0(89)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater: snapshotIndex: updateIncreasingly 185 -> 190
2021-10-05 13:24:12,549 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:purge(306)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-SegmentedRaftLog: purge 190
2021-10-05 13:24:12,549 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-SegmentedRaftLog: snapshotIndex: updateIncreasingly 185 -> 190
2021-10-05 13:24:12,549 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-SegmentedRaftLog: purgeIndex: updateToMax old=185, new=190, updated? true
2021-10-05 13:24:12,551 [Listener at 127.0.0.1/10356] INFO  ha.SCMHAInvocationHandler (SCMHAInvocationHandler.java:invokeRatis(113)) - Invoking method public abstract void org.apache.hadoop.hdds.scm.container.ContainerStateManagerV2.addContainer(org.apache.hadoop.hdds.protocol.proto.HddsProtos$ContainerInfoProto) throws java.io.IOException on target org.apache.hadoop.hdds.scm.ha.SCMRatisServerImpl@6344f74b, cost 5023.407us
2021-10-05 13:24:12,657 [Listener at 127.0.0.1/10356] INFO  ha.SCMHAInvocationHandler (SCMHAInvocationHandler.java:invokeRatis(113)) - Invoking method public abstract void org.apache.hadoop.hdds.scm.container.ContainerStateManagerV2.addContainer(org.apache.hadoop.hdds.protocol.proto.HddsProtos$ContainerInfoProto) throws java.io.IOException on target org.apache.hadoop.hdds.scm.ha.SCMRatisServerImpl@6344f74b, cost 5057.312us
2021-10-05 13:24:12,762 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  ha.SCMStateMachine (SCMStateMachine.java:takeSnapshot(290)) - Current Snapshot Index 195, takeSnapshot took 0 ms
2021-10-05 13:24:12,762 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:takeSnapshot(281)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater: Took a snapshot at index 195
2021-10-05 13:24:12,763 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:lambda$new$0(89)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater: snapshotIndex: updateIncreasingly 190 -> 195
2021-10-05 13:24:12,763 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:purge(306)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-SegmentedRaftLog: purge 195
2021-10-05 13:24:12,763 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-SegmentedRaftLog: snapshotIndex: updateIncreasingly 190 -> 195
2021-10-05 13:24:12,763 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-SegmentedRaftLog: purgeIndex: updateToMax old=190, new=195, updated? true
2021-10-05 13:24:12,764 [Listener at 127.0.0.1/10356] INFO  ha.SCMHAInvocationHandler (SCMHAInvocationHandler.java:invokeRatis(113)) - Invoking method public abstract void org.apache.hadoop.hdds.scm.container.ContainerStateManagerV2.addContainer(org.apache.hadoop.hdds.protocol.proto.HddsProtos$ContainerInfoProto) throws java.io.IOException on target org.apache.hadoop.hdds.scm.ha.SCMRatisServerImpl@6344f74b, cost 6365.644us
2021-10-05 13:24:12,766 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  ha.SCMStateMachine (SCMStateMachine.java:takeSnapshot(290)) - Current Snapshot Index 195, takeSnapshot took 0 ms
2021-10-05 13:24:12,766 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:takeSnapshot(281)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater: Took a snapshot at index 195
2021-10-05 13:24:12,766 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:lambda$new$0(89)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater: snapshotIndex: updateIncreasingly 190 -> 195
2021-10-05 13:24:12,766 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:purge(306)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-SegmentedRaftLog: purge 195
2021-10-05 13:24:12,767 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-SegmentedRaftLog: snapshotIndex: updateIncreasingly 190 -> 195
2021-10-05 13:24:12,767 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-SegmentedRaftLog: purgeIndex: updateToMax old=190, new=195, updated? true
2021-10-05 13:24:12,870 [Listener at 127.0.0.1/10356] INFO  ha.SCMHAInvocationHandler (SCMHAInvocationHandler.java:invokeRatis(113)) - Invoking method public abstract void org.apache.hadoop.hdds.scm.container.ContainerStateManagerV2.addContainer(org.apache.hadoop.hdds.protocol.proto.HddsProtos$ContainerInfoProto) throws java.io.IOException on target org.apache.hadoop.hdds.scm.ha.SCMRatisServerImpl@6344f74b, cost 4853.491us
2021-10-05 13:24:12,977 [Listener at 127.0.0.1/10356] INFO  ha.SCMHAInvocationHandler (SCMHAInvocationHandler.java:invokeRatis(113)) - Invoking method public abstract void org.apache.hadoop.hdds.scm.container.ContainerStateManagerV2.addContainer(org.apache.hadoop.hdds.protocol.proto.HddsProtos$ContainerInfoProto) throws java.io.IOException on target org.apache.hadoop.hdds.scm.ha.SCMRatisServerImpl@6344f74b, cost 6325.339us
2021-10-05 13:24:12,980 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  ha.SCMStateMachine (SCMStateMachine.java:takeSnapshot(290)) - Current Snapshot Index 200, takeSnapshot took 1 ms
2021-10-05 13:24:12,980 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:takeSnapshot(281)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater: Took a snapshot at index 200
2021-10-05 13:24:12,980 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:lambda$new$0(89)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater: snapshotIndex: updateIncreasingly 195 -> 200
2021-10-05 13:24:12,980 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:purge(306)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-SegmentedRaftLog: purge 200
2021-10-05 13:24:12,980 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-SegmentedRaftLog: snapshotIndex: updateIncreasingly 195 -> 200
2021-10-05 13:24:12,980 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-SegmentedRaftLog: purgeIndex: updateToMax old=195, new=200, updated? true
2021-10-05 13:24:13,080 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  ha.SCMStateMachine (SCMStateMachine.java:takeSnapshot(290)) - Current Snapshot Index 200, takeSnapshot took 0 ms
2021-10-05 13:24:13,081 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:takeSnapshot(281)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater: Took a snapshot at index 200
2021-10-05 13:24:13,081 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:lambda$new$0(89)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater: snapshotIndex: updateIncreasingly 195 -> 200
2021-10-05 13:24:13,081 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:purge(306)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-SegmentedRaftLog: purge 200
2021-10-05 13:24:13,081 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-SegmentedRaftLog: snapshotIndex: updateIncreasingly 195 -> 200
2021-10-05 13:24:13,081 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-SegmentedRaftLog: purgeIndex: updateToMax old=195, new=200, updated? true
2021-10-05 13:24:13,082 [Listener at 127.0.0.1/10356] INFO  ha.SCMHAInvocationHandler (SCMHAInvocationHandler.java:invokeRatis(113)) - Invoking method public abstract void org.apache.hadoop.hdds.scm.container.ContainerStateManagerV2.addContainer(org.apache.hadoop.hdds.protocol.proto.HddsProtos$ContainerInfoProto) throws java.io.IOException on target org.apache.hadoop.hdds.scm.ha.SCMRatisServerImpl@6344f74b, cost 4474.652us
2021-10-05 13:24:13,183 [Listener at 127.0.0.1/10356] INFO  server.StorageContainerManager (StorageContainerManager.java:start(1303)) - StorageContainerLocationProtocol RPC server is listening at /0.0.0.0:15043
2021-10-05 13:24:13,184 [Listener at 127.0.0.1/10356] INFO  ha.SCMRatisServerImpl (SCMRatisServerImpl.java:start(177)) - starting ratis server 0.0.0.0:15040
2021-10-05 13:24:13,184 [Listener at 127.0.0.1/10356] INFO  server.RaftServer$Division (RaftServerImpl.java:start(299)) - 34671d38-b53b-4109-b2ef-192b14535a6e@group-C748F4B4520D: start with initializing state, conf=-1: [], old=null
2021-10-05 13:24:13,184 [Listener at 127.0.0.1/10356] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(285)) - 34671d38-b53b-4109-b2ef-192b14535a6e@group-C748F4B4520D: changes role from      null to FOLLOWER at term 0 for startInitializing
2021-10-05 13:24:13,185 [Listener at 127.0.0.1/10356] INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-C748F4B4520D,id=34671d38-b53b-4109-b2ef-192b14535a6e
2021-10-05 13:24:13,186 [Listener at 127.0.0.1/10356] INFO  server.RaftServer (RaftServerProxy.java:lambda$start$5(374)) - 34671d38-b53b-4109-b2ef-192b14535a6e: start RPC server
2021-10-05 13:24:13,189 [Listener at 127.0.0.1/10356] INFO  server.GrpcService (GrpcService.java:startImpl(253)) - 34671d38-b53b-4109-b2ef-192b14535a6e: GrpcService started, listening on 15040
2021-10-05 13:24:13,191 [org.apache.ratis.util.JvmPauseMonitor$$Lambda$499/1586779822@e774bb3] INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(103)) - JvmPauseMonitor-34671d38-b53b-4109-b2ef-192b14535a6e: Started
2021-10-05 13:24:13,192 [Listener at 127.0.0.1/10356] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.client.port appended with serviceId and nodeId
2021-10-05 13:24:13,192 [Listener at 127.0.0.1/10356] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.block.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.block.client.port appended with serviceId and nodeId
2021-10-05 13:24:13,192 [Listener at 127.0.0.1/10356] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.datanode.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.datanode.port appended with serviceId and nodeId
2021-10-05 13:24:13,192 [Listener at 127.0.0.1/10356] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.client.port appended with serviceId and nodeId
2021-10-05 13:24:13,193 [Listener at 127.0.0.1/10356] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.block.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.block.client.port appended with serviceId and nodeId
2021-10-05 13:24:13,193 [Listener at 127.0.0.1/10356] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.datanode.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.datanode.port appended with serviceId and nodeId
2021-10-05 13:24:13,193 [Listener at 127.0.0.1/10356] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.client.port appended with serviceId and nodeId
2021-10-05 13:24:13,193 [Listener at 127.0.0.1/10356] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.block.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.block.client.port appended with serviceId and nodeId
2021-10-05 13:24:13,193 [Listener at 127.0.0.1/10356] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.datanode.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.datanode.port appended with serviceId and nodeId
2021-10-05 13:24:13,204 [IPC Server handler 2 on default port 15022] INFO  ha.SCMRatisServerImpl (SCMRatisServerImpl.java:addSCM(291)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0: Submitting SetConfiguration request to Ratis server with new SCM peers list: [86d8d056-6822-410c-8a18-8ea32f12a493|rpc:localhost:15030|priority:0, a4bffdee-6562-4179-bbcd-2dfbb5550fc0|rpc:localhost:15020|admin:|client:|dataStream:|priority:0, 34671d38-b53b-4109-b2ef-192b14535a6e|rpc:localhost:15040|priority:0]
2021-10-05 13:24:13,204 [IPC Server handler 2 on default port 15022] INFO  server.RaftServer$Division (RaftServerImpl.java:setConfigurationAsync(971)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D: receive setConfiguration SetConfigurationRequest:client-BBB1D7FEF41B->a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D, cid=99, seq=0, RW, null, peers:[86d8d056-6822-410c-8a18-8ea32f12a493|rpc:localhost:15030|priority:0, a4bffdee-6562-4179-bbcd-2dfbb5550fc0|rpc:localhost:15020|admin:|client:|dataStream:|priority:0, 34671d38-b53b-4109-b2ef-192b14535a6e|rpc:localhost:15040|priority:0]
2021-10-05 13:24:13,204 [IPC Server handler 2 on default port 15022] INFO  server.RaftServer$Division (LeaderStateImpl.java:startSetConfiguration(345)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-LeaderStateImpl: startSetConfiguration SetConfigurationRequest:client-BBB1D7FEF41B->a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D, cid=99, seq=0, RW, null, peers:[86d8d056-6822-410c-8a18-8ea32f12a493|rpc:localhost:15030|priority:0, a4bffdee-6562-4179-bbcd-2dfbb5550fc0|rpc:localhost:15020|admin:|client:|dataStream:|priority:0, 34671d38-b53b-4109-b2ef-192b14535a6e|rpc:localhost:15040|priority:0]
2021-10-05 13:24:13,205 [IPC Server handler 2 on default port 15022] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2021-10-05 13:24:13,205 [IPC Server handler 2 on default port 15022] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2021-10-05 13:24:13,205 [IPC Server handler 2 on default port 15022] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.appender.buffer.element-limit = 1024 (custom)
2021-10-05 13:24:13,206 [IPC Server handler 2 on default port 15022] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(44)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2021-10-05 13:24:13,206 [IPC Server handler 2 on default port 15022] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.request.timeout = 30000ms (custom)
2021-10-05 13:24:13,206 [IPC Server handler 2 on default port 15022] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.appender.install.snapshot.enabled = false (custom)
2021-10-05 13:24:13,206 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D->34671d38-b53b-4109-b2ef-192b14535a6e-GrpcLogAppender-LogAppenderDaemon] INFO  server.GrpcLogAppender (GrpcLogAppender.java:installSnapshot(524)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D->34671d38-b53b-4109-b2ef-192b14535a6e-GrpcLogAppender: followerNextIndex = 0 but logStartIndex = 105, notify follower to install snapshot-(t:2, i:105)
2021-10-05 13:24:13,215 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D->34671d38-b53b-4109-b2ef-192b14535a6e-GrpcLogAppender-LogAppenderDaemon] INFO  server.GrpcLogAppender (GrpcLogAppender.java:installSnapshot(532)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D->34671d38-b53b-4109-b2ef-192b14535a6e-GrpcLogAppender: send a4bffdee-6562-4179-bbcd-2dfbb5550fc0->34671d38-b53b-4109-b2ef-192b14535a6e#0-t2,notify:(t:2, i:105)
2021-10-05 13:24:13,225 [grpc-default-executor-3] INFO  server.RaftServer$Division (RaftServerImpl.java:installSnapshot(1329)) - 34671d38-b53b-4109-b2ef-192b14535a6e@group-C748F4B4520D: receive installSnapshot: a4bffdee-6562-4179-bbcd-2dfbb5550fc0->34671d38-b53b-4109-b2ef-192b14535a6e#0-t2,notify:(t:2, i:105)
2021-10-05 13:24:13,226 [grpc-default-executor-3] INFO  ha.SCMStateMachine (SCMStateMachine.java:notifyLeaderChanged(248)) - leader changed, yet current SCM is still follower.
2021-10-05 13:24:13,227 [grpc-default-executor-3] INFO  server.RaftServer$Division (ServerState.java:setLeader(285)) - 34671d38-b53b-4109-b2ef-192b14535a6e@group-C748F4B4520D: change Leader from null to a4bffdee-6562-4179-bbcd-2dfbb5550fc0 at term 2 for installSnapshot, leader elected after 28540ms
2021-10-05 13:24:13,229 [grpc-default-executor-3] INFO  server.RaftServer$Division (RaftServerImpl.java:notifyStateMachineToInstallSnapshot(1581)) - 34671d38-b53b-4109-b2ef-192b14535a6e@group-C748F4B4520D: notifyInstallSnapshot: nextIndex is 0 but the leader's first available index is 105.
2021-10-05 13:24:13,229 [grpc-default-executor-3] INFO  ha.SCMStateMachine (SCMStateMachine.java:notifyInstallSnapshotFromLeader(212)) - Received install snapshot notification from SCM leader: localhost:15020 with term index: (t:2, i:105)
2021-10-05 13:24:13,236 [grpc-default-executor-3] INFO  server.RaftServer$Division (RaftServerImpl.java:installSnapshotImpl(1459)) - 34671d38-b53b-4109-b2ef-192b14535a6e@group-C748F4B4520D: set new configuration index: 5
configurationEntry {
  peers {
    id: "86d8d056-6822-410c-8a18-8ea32f12a493"
    address: "localhost:15030"
  }
  peers {
    id: "a4bffdee-6562-4179-bbcd-2dfbb5550fc0"
    address: "localhost:15020"
  }
}
 from snapshot
2021-10-05 13:24:13,236 [pool-58-thread-1] INFO  ha.SCMHAManagerImpl (SCMHAManagerImpl.java:getDBCheckpointFromLeader(206)) - Downloading checkpoint from leader SCM scmNode-1 and reloading state from the checkpoint.
2021-10-05 13:24:13,241 [grpc-default-executor-3] INFO  server.RaftServer$Division (ServerState.java:setRaftConf(387)) - 34671d38-b53b-4109-b2ef-192b14535a6e@group-C748F4B4520D: set configuration 5: [86d8d056-6822-410c-8a18-8ea32f12a493|rpc:localhost:15030|admin:|client:|dataStream:|priority:0, a4bffdee-6562-4179-bbcd-2dfbb5550fc0|rpc:localhost:15020|admin:|client:|dataStream:|priority:0], old=null
2021-10-05 13:24:13,241 [grpc-default-executor-3] INFO  server.RaftServer$Division (RaftServerImpl.java:installSnapshot(1340)) - 34671d38-b53b-4109-b2ef-192b14535a6e@group-C748F4B4520D: reply installSnapshot: a4bffdee-6562-4179-bbcd-2dfbb5550fc0<-34671d38-b53b-4109-b2ef-192b14535a6e#0:FAIL-t0,IN_PROGRESS
2021-10-05 13:24:13,243 [grpc-default-executor-4] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onNext(400)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D->34671d38-b53b-4109-b2ef-192b14535a6e-InstallSnapshotResponseHandler: received the first reply a4bffdee-6562-4179-bbcd-2dfbb5550fc0<-34671d38-b53b-4109-b2ef-192b14535a6e#0:FAIL-t0,IN_PROGRESS
2021-10-05 13:24:13,244 [grpc-default-executor-4] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onNext(417)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D->34671d38-b53b-4109-b2ef-192b14535a6e-InstallSnapshotResponseHandler: InstallSnapshot in progress.
2021-10-05 13:24:13,247 [grpc-default-executor-3] INFO  server.GrpcServerProtocolService (GrpcServerProtocolService.java:onCompleted(140)) - 34671d38-b53b-4109-b2ef-192b14535a6e: Completed INSTALL_SNAPSHOT, lastRequest: a4bffdee-6562-4179-bbcd-2dfbb5550fc0->34671d38-b53b-4109-b2ef-192b14535a6e#0-t2,notify:(t:2, i:105)
2021-10-05 13:24:13,248 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D->34671d38-b53b-4109-b2ef-192b14535a6e-GrpcLogAppender-LogAppenderDaemon] INFO  server.GrpcLogAppender (GrpcLogAppender.java:installSnapshot(524)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D->34671d38-b53b-4109-b2ef-192b14535a6e-GrpcLogAppender: followerNextIndex = 0 but logStartIndex = 105, notify follower to install snapshot-(t:2, i:105)
2021-10-05 13:24:13,248 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D->34671d38-b53b-4109-b2ef-192b14535a6e-GrpcLogAppender-LogAppenderDaemon] INFO  server.GrpcLogAppender (GrpcLogAppender.java:installSnapshot(532)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D->34671d38-b53b-4109-b2ef-192b14535a6e-GrpcLogAppender: send a4bffdee-6562-4179-bbcd-2dfbb5550fc0->34671d38-b53b-4109-b2ef-192b14535a6e#0-t2,notify:(t:2, i:105)
2021-10-05 13:24:13,252 [grpc-default-executor-4] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(130)) - 34671d38-b53b-4109-b2ef-192b14535a6e: start 34671d38-b53b-4109-b2ef-192b14535a6e@group-C748F4B4520D-FollowerState
2021-10-05 13:24:13,252 [grpc-default-executor-4] INFO  server.RaftServer$Division (RaftServerImpl.java:checkInconsistentAppendEntries(1293)) - 34671d38-b53b-4109-b2ef-192b14535a6e@group-C748F4B4520D: Failed appendEntries as snapshot ((t:2, i:105)) installation is in progress
2021-10-05 13:24:13,252 [grpc-default-executor-4] INFO  server.RaftServer$Division (RaftServerImpl.java:checkInconsistentAppendEntries(1285)) - 34671d38-b53b-4109-b2ef-192b14535a6e@group-C748F4B4520D: inconsistency entries. Reply:a4bffdee-6562-4179-bbcd-2dfbb5550fc0<-34671d38-b53b-4109-b2ef-192b14535a6e#0:FAIL-t2,INCONSISTENCY,nextIndex=0,followerCommit=-1
2021-10-05 13:24:13,256 [grpc-default-executor-3] INFO  server.RaftServer$Division (RaftServerImpl.java:installSnapshot(1329)) - 34671d38-b53b-4109-b2ef-192b14535a6e@group-C748F4B4520D: receive installSnapshot: a4bffdee-6562-4179-bbcd-2dfbb5550fc0->34671d38-b53b-4109-b2ef-192b14535a6e#0-t2,notify:(t:2, i:105)
2021-10-05 13:24:13,256 [grpc-default-executor-3] INFO  server.RaftServer$Division (RaftServerImpl.java:notifyStateMachineToInstallSnapshot(1611)) - 34671d38-b53b-4109-b2ef-192b14535a6e@group-C748F4B4520D: Snapshot Installation by StateMachine is in progress.
2021-10-05 13:24:13,256 [grpc-default-executor-3] INFO  server.RaftServer$Division (RaftServerImpl.java:installSnapshotImpl(1459)) - 34671d38-b53b-4109-b2ef-192b14535a6e@group-C748F4B4520D: set new configuration index: 5
configurationEntry {
  peers {
    id: "86d8d056-6822-410c-8a18-8ea32f12a493"
    address: "localhost:15030"
  }
  peers {
    id: "a4bffdee-6562-4179-bbcd-2dfbb5550fc0"
    address: "localhost:15020"
  }
}
 from snapshot
2021-10-05 13:24:13,257 [grpc-default-executor-3] INFO  server.RaftServer$Division (ServerState.java:setRaftConf(387)) - 34671d38-b53b-4109-b2ef-192b14535a6e@group-C748F4B4520D: set configuration 5: [86d8d056-6822-410c-8a18-8ea32f12a493|rpc:localhost:15030|admin:|client:|dataStream:|priority:0, a4bffdee-6562-4179-bbcd-2dfbb5550fc0|rpc:localhost:15020|admin:|client:|dataStream:|priority:0], old=null
2021-10-05 13:24:13,258 [grpc-default-executor-3] INFO  server.RaftServer$Division (RaftServerImpl.java:installSnapshot(1340)) - 34671d38-b53b-4109-b2ef-192b14535a6e@group-C748F4B4520D: reply installSnapshot: a4bffdee-6562-4179-bbcd-2dfbb5550fc0<-34671d38-b53b-4109-b2ef-192b14535a6e#0:FAIL-t2,IN_PROGRESS
2021-10-05 13:24:13,258 [grpc-default-executor-3] INFO  server.GrpcServerProtocolService (GrpcServerProtocolService.java:onCompleted(140)) - 34671d38-b53b-4109-b2ef-192b14535a6e: Completed INSTALL_SNAPSHOT, lastRequest: a4bffdee-6562-4179-bbcd-2dfbb5550fc0->34671d38-b53b-4109-b2ef-192b14535a6e#0-t2,notify:(t:2, i:105)
2021-10-05 13:24:13,259 [grpc-default-executor-4] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(46)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D->34671d38-b53b-4109-b2ef-192b14535a6e: nextIndex: updateUnconditionally 0 -> 0
2021-10-05 13:24:13,259 [grpc-default-executor-0] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onNext(400)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D->34671d38-b53b-4109-b2ef-192b14535a6e-InstallSnapshotResponseHandler: received a reply a4bffdee-6562-4179-bbcd-2dfbb5550fc0<-34671d38-b53b-4109-b2ef-192b14535a6e#0:FAIL-t2,IN_PROGRESS
2021-10-05 13:24:13,259 [grpc-default-executor-0] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onNext(417)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D->34671d38-b53b-4109-b2ef-192b14535a6e-InstallSnapshotResponseHandler: InstallSnapshot in progress.
2021-10-05 13:24:13,260 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D->34671d38-b53b-4109-b2ef-192b14535a6e-GrpcLogAppender-LogAppenderDaemon] INFO  server.GrpcLogAppender (GrpcLogAppender.java:installSnapshot(524)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D->34671d38-b53b-4109-b2ef-192b14535a6e-GrpcLogAppender: followerNextIndex = 0 but logStartIndex = 105, notify follower to install snapshot-(t:2, i:105)
2021-10-05 13:24:13,260 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D->34671d38-b53b-4109-b2ef-192b14535a6e-GrpcLogAppender-LogAppenderDaemon] INFO  server.GrpcLogAppender (GrpcLogAppender.java:installSnapshot(532)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D->34671d38-b53b-4109-b2ef-192b14535a6e-GrpcLogAppender: send a4bffdee-6562-4179-bbcd-2dfbb5550fc0->34671d38-b53b-4109-b2ef-192b14535a6e#0-t2,notify:(t:2, i:105)
2021-10-05 13:24:13,261 [grpc-default-executor-0] INFO  server.RaftServer$Division (RaftServerImpl.java:checkInconsistentAppendEntries(1293)) - 34671d38-b53b-4109-b2ef-192b14535a6e@group-C748F4B4520D: Failed appendEntries as snapshot ((t:2, i:105)) installation is in progress
2021-10-05 13:24:13,261 [grpc-default-executor-0] INFO  server.RaftServer$Division (RaftServerImpl.java:checkInconsistentAppendEntries(1285)) - 34671d38-b53b-4109-b2ef-192b14535a6e@group-C748F4B4520D: inconsistency entries. Reply:a4bffdee-6562-4179-bbcd-2dfbb5550fc0<-34671d38-b53b-4109-b2ef-192b14535a6e#1:FAIL-t2,INCONSISTENCY,nextIndex=0,followerCommit=-1
2021-10-05 13:24:13,265 [grpc-default-executor-3] INFO  ha.SCMDBCheckpointProvider (SCMDBCheckpointProvider.java:writeDBCheckPointToSream(48)) - Received request to obtain SCM DB checkpoint snapshot
2021-10-05 13:24:13,265 [grpc-default-executor-4] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(46)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D->34671d38-b53b-4109-b2ef-192b14535a6e: nextIndex: updateUnconditionally 0 -> 0
2021-10-05 13:24:13,269 [grpc-default-executor-0] INFO  server.RaftServer$Division (RaftServerImpl.java:installSnapshot(1329)) - 34671d38-b53b-4109-b2ef-192b14535a6e@group-C748F4B4520D: receive installSnapshot: a4bffdee-6562-4179-bbcd-2dfbb5550fc0->34671d38-b53b-4109-b2ef-192b14535a6e#0-t2,notify:(t:2, i:105)
2021-10-05 13:24:13,269 [grpc-default-executor-0] INFO  server.RaftServer$Division (RaftServerImpl.java:notifyStateMachineToInstallSnapshot(1611)) - 34671d38-b53b-4109-b2ef-192b14535a6e@group-C748F4B4520D: Snapshot Installation by StateMachine is in progress.
2021-10-05 13:24:13,269 [grpc-default-executor-0] INFO  server.RaftServer$Division (RaftServerImpl.java:installSnapshotImpl(1459)) - 34671d38-b53b-4109-b2ef-192b14535a6e@group-C748F4B4520D: set new configuration index: 5
configurationEntry {
  peers {
    id: "86d8d056-6822-410c-8a18-8ea32f12a493"
    address: "localhost:15030"
  }
  peers {
    id: "a4bffdee-6562-4179-bbcd-2dfbb5550fc0"
    address: "localhost:15020"
  }
}
 from snapshot
2021-10-05 13:24:13,269 [grpc-default-executor-0] INFO  server.RaftServer$Division (ServerState.java:setRaftConf(387)) - 34671d38-b53b-4109-b2ef-192b14535a6e@group-C748F4B4520D: set configuration 5: [86d8d056-6822-410c-8a18-8ea32f12a493|rpc:localhost:15030|admin:|client:|dataStream:|priority:0, a4bffdee-6562-4179-bbcd-2dfbb5550fc0|rpc:localhost:15020|admin:|client:|dataStream:|priority:0], old=null
2021-10-05 13:24:13,269 [grpc-default-executor-0] INFO  server.RaftServer$Division (RaftServerImpl.java:installSnapshot(1340)) - 34671d38-b53b-4109-b2ef-192b14535a6e@group-C748F4B4520D: reply installSnapshot: a4bffdee-6562-4179-bbcd-2dfbb5550fc0<-34671d38-b53b-4109-b2ef-192b14535a6e#0:FAIL-t2,IN_PROGRESS
2021-10-05 13:24:13,270 [grpc-default-executor-0] INFO  server.GrpcServerProtocolService (GrpcServerProtocolService.java:onCompleted(140)) - 34671d38-b53b-4109-b2ef-192b14535a6e: Completed INSTALL_SNAPSHOT, lastRequest: a4bffdee-6562-4179-bbcd-2dfbb5550fc0->34671d38-b53b-4109-b2ef-192b14535a6e#0-t2,notify:(t:2, i:105)
2021-10-05 13:24:13,270 [grpc-default-executor-0] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onNext(400)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D->34671d38-b53b-4109-b2ef-192b14535a6e-InstallSnapshotResponseHandler: received a reply a4bffdee-6562-4179-bbcd-2dfbb5550fc0<-34671d38-b53b-4109-b2ef-192b14535a6e#0:FAIL-t2,IN_PROGRESS
2021-10-05 13:24:13,270 [grpc-default-executor-0] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onNext(417)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D->34671d38-b53b-4109-b2ef-192b14535a6e-InstallSnapshotResponseHandler: InstallSnapshot in progress.
2021-10-05 13:24:13,272 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D->34671d38-b53b-4109-b2ef-192b14535a6e-GrpcLogAppender-LogAppenderDaemon] INFO  server.GrpcLogAppender (GrpcLogAppender.java:installSnapshot(524)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D->34671d38-b53b-4109-b2ef-192b14535a6e-GrpcLogAppender: followerNextIndex = 0 but logStartIndex = 105, notify follower to install snapshot-(t:2, i:105)
2021-10-05 13:24:13,272 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D->34671d38-b53b-4109-b2ef-192b14535a6e-GrpcLogAppender-LogAppenderDaemon] INFO  server.GrpcLogAppender (GrpcLogAppender.java:installSnapshot(532)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D->34671d38-b53b-4109-b2ef-192b14535a6e-GrpcLogAppender: send a4bffdee-6562-4179-bbcd-2dfbb5550fc0->34671d38-b53b-4109-b2ef-192b14535a6e#0-t2,notify:(t:2, i:105)
2021-10-05 13:24:13,274 [grpc-default-executor-0] INFO  server.RaftServer$Division (RaftServerImpl.java:installSnapshot(1329)) - 34671d38-b53b-4109-b2ef-192b14535a6e@group-C748F4B4520D: receive installSnapshot: a4bffdee-6562-4179-bbcd-2dfbb5550fc0->34671d38-b53b-4109-b2ef-192b14535a6e#0-t2,notify:(t:2, i:105)
2021-10-05 13:24:13,275 [grpc-default-executor-0] INFO  server.RaftServer$Division (RaftServerImpl.java:notifyStateMachineToInstallSnapshot(1611)) - 34671d38-b53b-4109-b2ef-192b14535a6e@group-C748F4B4520D: Snapshot Installation by StateMachine is in progress.
2021-10-05 13:24:13,275 [grpc-default-executor-0] INFO  server.RaftServer$Division (RaftServerImpl.java:installSnapshotImpl(1459)) - 34671d38-b53b-4109-b2ef-192b14535a6e@group-C748F4B4520D: set new configuration index: 5
configurationEntry {
  peers {
    id: "86d8d056-6822-410c-8a18-8ea32f12a493"
    address: "localhost:15030"
  }
  peers {
    id: "a4bffdee-6562-4179-bbcd-2dfbb5550fc0"
    address: "localhost:15020"
  }
}
 from snapshot
2021-10-05 13:24:13,275 [grpc-default-executor-0] INFO  server.RaftServer$Division (ServerState.java:setRaftConf(387)) - 34671d38-b53b-4109-b2ef-192b14535a6e@group-C748F4B4520D: set configuration 5: [86d8d056-6822-410c-8a18-8ea32f12a493|rpc:localhost:15030|admin:|client:|dataStream:|priority:0, a4bffdee-6562-4179-bbcd-2dfbb5550fc0|rpc:localhost:15020|admin:|client:|dataStream:|priority:0], old=null
2021-10-05 13:24:13,275 [grpc-default-executor-0] INFO  server.RaftServer$Division (RaftServerImpl.java:installSnapshot(1340)) - 34671d38-b53b-4109-b2ef-192b14535a6e@group-C748F4B4520D: reply installSnapshot: a4bffdee-6562-4179-bbcd-2dfbb5550fc0<-34671d38-b53b-4109-b2ef-192b14535a6e#0:FAIL-t2,IN_PROGRESS
2021-10-05 13:24:13,276 [grpc-default-executor-0] INFO  server.GrpcServerProtocolService (GrpcServerProtocolService.java:onCompleted(140)) - 34671d38-b53b-4109-b2ef-192b14535a6e: Completed INSTALL_SNAPSHOT, lastRequest: a4bffdee-6562-4179-bbcd-2dfbb5550fc0->34671d38-b53b-4109-b2ef-192b14535a6e#0-t2,notify:(t:2, i:105)
2021-10-05 13:24:13,276 [grpc-default-executor-4] INFO  server.RaftServer$Division (RaftServerImpl.java:checkInconsistentAppendEntries(1293)) - 34671d38-b53b-4109-b2ef-192b14535a6e@group-C748F4B4520D: Failed appendEntries as snapshot ((t:2, i:105)) installation is in progress
2021-10-05 13:24:13,276 [grpc-default-executor-4] INFO  server.RaftServer$Division (RaftServerImpl.java:checkInconsistentAppendEntries(1285)) - 34671d38-b53b-4109-b2ef-192b14535a6e@group-C748F4B4520D: inconsistency entries. Reply:a4bffdee-6562-4179-bbcd-2dfbb5550fc0<-34671d38-b53b-4109-b2ef-192b14535a6e#2:FAIL-t2,INCONSISTENCY,nextIndex=0,followerCommit=-1
2021-10-05 13:24:13,277 [grpc-default-executor-4] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(46)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D->34671d38-b53b-4109-b2ef-192b14535a6e: nextIndex: updateUnconditionally 0 -> 0
2021-10-05 13:24:13,277 [grpc-default-executor-0] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onNext(400)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D->34671d38-b53b-4109-b2ef-192b14535a6e-InstallSnapshotResponseHandler: received a reply a4bffdee-6562-4179-bbcd-2dfbb5550fc0<-34671d38-b53b-4109-b2ef-192b14535a6e#0:FAIL-t2,IN_PROGRESS
2021-10-05 13:24:13,277 [grpc-default-executor-0] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onNext(417)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D->34671d38-b53b-4109-b2ef-192b14535a6e-InstallSnapshotResponseHandler: InstallSnapshot in progress.
2021-10-05 13:24:13,281 [grpc-default-executor-3] INFO  db.RDBCheckpointManager (RDBCheckpointManager.java:createCheckpoint(86)) - Created checkpoint at /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-98f4f1fb-613f-4a4a-83a3-c748f4b4520d/scmNode-1/db.checkpoints/scm.db_checkpoint_1633440253266 in 15 milliseconds
2021-10-05 13:24:13,282 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D->34671d38-b53b-4109-b2ef-192b14535a6e-GrpcLogAppender-LogAppenderDaemon] INFO  server.GrpcLogAppender (GrpcLogAppender.java:installSnapshot(524)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D->34671d38-b53b-4109-b2ef-192b14535a6e-GrpcLogAppender: followerNextIndex = 0 but logStartIndex = 105, notify follower to install snapshot-(t:2, i:105)
2021-10-05 13:24:13,283 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D->34671d38-b53b-4109-b2ef-192b14535a6e-GrpcLogAppender-LogAppenderDaemon] INFO  server.GrpcLogAppender (GrpcLogAppender.java:installSnapshot(532)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D->34671d38-b53b-4109-b2ef-192b14535a6e-GrpcLogAppender: send a4bffdee-6562-4179-bbcd-2dfbb5550fc0->34671d38-b53b-4109-b2ef-192b14535a6e#0-t2,notify:(t:2, i:105)
2021-10-05 13:24:13,283 [grpc-default-executor-0] INFO  server.RaftServer$Division (RaftServerImpl.java:checkInconsistentAppendEntries(1293)) - 34671d38-b53b-4109-b2ef-192b14535a6e@group-C748F4B4520D: Failed appendEntries as snapshot ((t:2, i:105)) installation is in progress
2021-10-05 13:24:13,283 [grpc-default-executor-0] INFO  server.RaftServer$Division (RaftServerImpl.java:checkInconsistentAppendEntries(1285)) - 34671d38-b53b-4109-b2ef-192b14535a6e@group-C748F4B4520D: inconsistency entries. Reply:a4bffdee-6562-4179-bbcd-2dfbb5550fc0<-34671d38-b53b-4109-b2ef-192b14535a6e#3:FAIL-t2,INCONSISTENCY,nextIndex=0,followerCommit=-1
2021-10-05 13:24:13,286 [grpc-default-executor-4] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(46)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D->34671d38-b53b-4109-b2ef-192b14535a6e: nextIndex: updateUnconditionally 0 -> 0
2021-10-05 13:24:13,286 [grpc-default-executor-0] INFO  server.RaftServer$Division (RaftServerImpl.java:installSnapshot(1329)) - 34671d38-b53b-4109-b2ef-192b14535a6e@group-C748F4B4520D: receive installSnapshot: a4bffdee-6562-4179-bbcd-2dfbb5550fc0->34671d38-b53b-4109-b2ef-192b14535a6e#0-t2,notify:(t:2, i:105)
2021-10-05 13:24:13,286 [grpc-default-executor-0] INFO  server.RaftServer$Division (RaftServerImpl.java:notifyStateMachineToInstallSnapshot(1611)) - 34671d38-b53b-4109-b2ef-192b14535a6e@group-C748F4B4520D: Snapshot Installation by StateMachine is in progress.
2021-10-05 13:24:13,286 [grpc-default-executor-0] INFO  server.RaftServer$Division (RaftServerImpl.java:installSnapshotImpl(1459)) - 34671d38-b53b-4109-b2ef-192b14535a6e@group-C748F4B4520D: set new configuration index: 5
configurationEntry {
  peers {
    id: "86d8d056-6822-410c-8a18-8ea32f12a493"
    address: "localhost:15030"
  }
  peers {
    id: "a4bffdee-6562-4179-bbcd-2dfbb5550fc0"
    address: "localhost:15020"
  }
}
 from snapshot
2021-10-05 13:24:13,286 [grpc-default-executor-0] INFO  server.RaftServer$Division (ServerState.java:setRaftConf(387)) - 34671d38-b53b-4109-b2ef-192b14535a6e@group-C748F4B4520D: set configuration 5: [86d8d056-6822-410c-8a18-8ea32f12a493|rpc:localhost:15030|admin:|client:|dataStream:|priority:0, a4bffdee-6562-4179-bbcd-2dfbb5550fc0|rpc:localhost:15020|admin:|client:|dataStream:|priority:0], old=null
2021-10-05 13:24:13,287 [grpc-default-executor-0] INFO  server.RaftServer$Division (RaftServerImpl.java:installSnapshot(1340)) - 34671d38-b53b-4109-b2ef-192b14535a6e@group-C748F4B4520D: reply installSnapshot: a4bffdee-6562-4179-bbcd-2dfbb5550fc0<-34671d38-b53b-4109-b2ef-192b14535a6e#0:FAIL-t2,IN_PROGRESS
2021-10-05 13:24:13,287 [grpc-default-executor-0] INFO  server.GrpcServerProtocolService (GrpcServerProtocolService.java:onCompleted(140)) - 34671d38-b53b-4109-b2ef-192b14535a6e: Completed INSTALL_SNAPSHOT, lastRequest: a4bffdee-6562-4179-bbcd-2dfbb5550fc0->34671d38-b53b-4109-b2ef-192b14535a6e#0-t2,notify:(t:2, i:105)
2021-10-05 13:24:13,287 [grpc-default-executor-0] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onNext(400)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D->34671d38-b53b-4109-b2ef-192b14535a6e-InstallSnapshotResponseHandler: received a reply a4bffdee-6562-4179-bbcd-2dfbb5550fc0<-34671d38-b53b-4109-b2ef-192b14535a6e#0:FAIL-t2,IN_PROGRESS
2021-10-05 13:24:13,287 [grpc-default-executor-0] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onNext(417)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D->34671d38-b53b-4109-b2ef-192b14535a6e-InstallSnapshotResponseHandler: InstallSnapshot in progress.
2021-10-05 13:24:13,288 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D->34671d38-b53b-4109-b2ef-192b14535a6e-GrpcLogAppender-LogAppenderDaemon] INFO  server.GrpcLogAppender (GrpcLogAppender.java:installSnapshot(524)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D->34671d38-b53b-4109-b2ef-192b14535a6e-GrpcLogAppender: followerNextIndex = 0 but logStartIndex = 105, notify follower to install snapshot-(t:2, i:105)
2021-10-05 13:24:13,289 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D->34671d38-b53b-4109-b2ef-192b14535a6e-GrpcLogAppender-LogAppenderDaemon] INFO  server.GrpcLogAppender (GrpcLogAppender.java:installSnapshot(532)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D->34671d38-b53b-4109-b2ef-192b14535a6e-GrpcLogAppender: send a4bffdee-6562-4179-bbcd-2dfbb5550fc0->34671d38-b53b-4109-b2ef-192b14535a6e#0-t2,notify:(t:2, i:105)
2021-10-05 13:24:13,290 [grpc-default-executor-0] INFO  server.RaftServer$Division (RaftServerImpl.java:installSnapshot(1329)) - 34671d38-b53b-4109-b2ef-192b14535a6e@group-C748F4B4520D: receive installSnapshot: a4bffdee-6562-4179-bbcd-2dfbb5550fc0->34671d38-b53b-4109-b2ef-192b14535a6e#0-t2,notify:(t:2, i:105)
2021-10-05 13:24:13,290 [grpc-default-executor-0] INFO  server.RaftServer$Division (RaftServerImpl.java:notifyStateMachineToInstallSnapshot(1611)) - 34671d38-b53b-4109-b2ef-192b14535a6e@group-C748F4B4520D: Snapshot Installation by StateMachine is in progress.
2021-10-05 13:24:13,291 [grpc-default-executor-0] INFO  server.RaftServer$Division (RaftServerImpl.java:installSnapshotImpl(1459)) - 34671d38-b53b-4109-b2ef-192b14535a6e@group-C748F4B4520D: set new configuration index: 5
configurationEntry {
  peers {
    id: "86d8d056-6822-410c-8a18-8ea32f12a493"
    address: "localhost:15030"
  }
  peers {
    id: "a4bffdee-6562-4179-bbcd-2dfbb5550fc0"
    address: "localhost:15020"
  }
}
 from snapshot
2021-10-05 13:24:13,291 [grpc-default-executor-0] INFO  server.RaftServer$Division (ServerState.java:setRaftConf(387)) - 34671d38-b53b-4109-b2ef-192b14535a6e@group-C748F4B4520D: set configuration 5: [86d8d056-6822-410c-8a18-8ea32f12a493|rpc:localhost:15030|admin:|client:|dataStream:|priority:0, a4bffdee-6562-4179-bbcd-2dfbb5550fc0|rpc:localhost:15020|admin:|client:|dataStream:|priority:0], old=null
2021-10-05 13:24:13,291 [grpc-default-executor-0] INFO  server.RaftServer$Division (RaftServerImpl.java:installSnapshot(1340)) - 34671d38-b53b-4109-b2ef-192b14535a6e@group-C748F4B4520D: reply installSnapshot: a4bffdee-6562-4179-bbcd-2dfbb5550fc0<-34671d38-b53b-4109-b2ef-192b14535a6e#0:FAIL-t2,IN_PROGRESS
2021-10-05 13:24:13,291 [grpc-default-executor-0] INFO  server.GrpcServerProtocolService (GrpcServerProtocolService.java:onCompleted(140)) - 34671d38-b53b-4109-b2ef-192b14535a6e: Completed INSTALL_SNAPSHOT, lastRequest: a4bffdee-6562-4179-bbcd-2dfbb5550fc0->34671d38-b53b-4109-b2ef-192b14535a6e#0-t2,notify:(t:2, i:105)
2021-10-05 13:24:13,292 [grpc-default-executor-0] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onNext(400)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D->34671d38-b53b-4109-b2ef-192b14535a6e-InstallSnapshotResponseHandler: received a reply a4bffdee-6562-4179-bbcd-2dfbb5550fc0<-34671d38-b53b-4109-b2ef-192b14535a6e#0:FAIL-t2,IN_PROGRESS
2021-10-05 13:24:13,292 [grpc-default-executor-0] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onNext(417)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D->34671d38-b53b-4109-b2ef-192b14535a6e-InstallSnapshotResponseHandler: InstallSnapshot in progress.
2021-10-05 13:24:13,293 [grpc-default-executor-4] INFO  server.RaftServer$Division (RaftServerImpl.java:checkInconsistentAppendEntries(1293)) - 34671d38-b53b-4109-b2ef-192b14535a6e@group-C748F4B4520D: Failed appendEntries as snapshot ((t:2, i:105)) installation is in progress
2021-10-05 13:24:13,293 [grpc-default-executor-4] INFO  server.RaftServer$Division (RaftServerImpl.java:checkInconsistentAppendEntries(1285)) - 34671d38-b53b-4109-b2ef-192b14535a6e@group-C748F4B4520D: inconsistency entries. Reply:a4bffdee-6562-4179-bbcd-2dfbb5550fc0<-34671d38-b53b-4109-b2ef-192b14535a6e#4:FAIL-t2,INCONSISTENCY,nextIndex=0,followerCommit=-1
2021-10-05 13:24:13,294 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D->34671d38-b53b-4109-b2ef-192b14535a6e-GrpcLogAppender-LogAppenderDaemon] INFO  server.GrpcLogAppender (GrpcLogAppender.java:installSnapshot(524)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D->34671d38-b53b-4109-b2ef-192b14535a6e-GrpcLogAppender: followerNextIndex = 0 but logStartIndex = 105, notify follower to install snapshot-(t:2, i:105)
2021-10-05 13:24:13,294 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D->34671d38-b53b-4109-b2ef-192b14535a6e-GrpcLogAppender-LogAppenderDaemon] INFO  server.GrpcLogAppender (GrpcLogAppender.java:installSnapshot(532)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D->34671d38-b53b-4109-b2ef-192b14535a6e-GrpcLogAppender: send a4bffdee-6562-4179-bbcd-2dfbb5550fc0->34671d38-b53b-4109-b2ef-192b14535a6e#0-t2,notify:(t:2, i:105)
2021-10-05 13:24:13,294 [grpc-default-executor-4] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(46)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D->34671d38-b53b-4109-b2ef-192b14535a6e: nextIndex: updateUnconditionally 0 -> 0
2021-10-05 13:24:13,294 [grpc-default-executor-4] INFO  server.RaftServer$Division (RaftServerImpl.java:checkInconsistentAppendEntries(1293)) - 34671d38-b53b-4109-b2ef-192b14535a6e@group-C748F4B4520D: Failed appendEntries as snapshot ((t:2, i:105)) installation is in progress
2021-10-05 13:24:13,294 [grpc-default-executor-4] INFO  server.RaftServer$Division (RaftServerImpl.java:checkInconsistentAppendEntries(1285)) - 34671d38-b53b-4109-b2ef-192b14535a6e@group-C748F4B4520D: inconsistency entries. Reply:a4bffdee-6562-4179-bbcd-2dfbb5550fc0<-34671d38-b53b-4109-b2ef-192b14535a6e#5:FAIL-t2,INCONSISTENCY,nextIndex=0,followerCommit=-1
2021-10-05 13:24:13,296 [grpc-default-executor-4] INFO  server.RaftServer$Division (RaftServerImpl.java:installSnapshot(1329)) - 34671d38-b53b-4109-b2ef-192b14535a6e@group-C748F4B4520D: receive installSnapshot: a4bffdee-6562-4179-bbcd-2dfbb5550fc0->34671d38-b53b-4109-b2ef-192b14535a6e#0-t2,notify:(t:2, i:105)
2021-10-05 13:24:13,296 [grpc-default-executor-4] INFO  server.RaftServer$Division (RaftServerImpl.java:notifyStateMachineToInstallSnapshot(1611)) - 34671d38-b53b-4109-b2ef-192b14535a6e@group-C748F4B4520D: Snapshot Installation by StateMachine is in progress.
2021-10-05 13:24:13,296 [grpc-default-executor-4] INFO  server.RaftServer$Division (RaftServerImpl.java:installSnapshotImpl(1459)) - 34671d38-b53b-4109-b2ef-192b14535a6e@group-C748F4B4520D: set new configuration index: 5
configurationEntry {
  peers {
    id: "86d8d056-6822-410c-8a18-8ea32f12a493"
    address: "localhost:15030"
  }
  peers {
    id: "a4bffdee-6562-4179-bbcd-2dfbb5550fc0"
    address: "localhost:15020"
  }
}
 from snapshot
2021-10-05 13:24:13,296 [grpc-default-executor-4] INFO  server.RaftServer$Division (ServerState.java:setRaftConf(387)) - 34671d38-b53b-4109-b2ef-192b14535a6e@group-C748F4B4520D: set configuration 5: [86d8d056-6822-410c-8a18-8ea32f12a493|rpc:localhost:15030|admin:|client:|dataStream:|priority:0, a4bffdee-6562-4179-bbcd-2dfbb5550fc0|rpc:localhost:15020|admin:|client:|dataStream:|priority:0], old=null
2021-10-05 13:24:13,296 [grpc-default-executor-4] INFO  server.RaftServer$Division (RaftServerImpl.java:installSnapshot(1340)) - 34671d38-b53b-4109-b2ef-192b14535a6e@group-C748F4B4520D: reply installSnapshot: a4bffdee-6562-4179-bbcd-2dfbb5550fc0<-34671d38-b53b-4109-b2ef-192b14535a6e#0:FAIL-t2,IN_PROGRESS
2021-10-05 13:24:13,297 [grpc-default-executor-4] INFO  server.GrpcServerProtocolService (GrpcServerProtocolService.java:onCompleted(140)) - 34671d38-b53b-4109-b2ef-192b14535a6e: Completed INSTALL_SNAPSHOT, lastRequest: a4bffdee-6562-4179-bbcd-2dfbb5550fc0->34671d38-b53b-4109-b2ef-192b14535a6e#0-t2,notify:(t:2, i:105)
2021-10-05 13:24:13,297 [grpc-default-executor-4] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onNext(400)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D->34671d38-b53b-4109-b2ef-192b14535a6e-InstallSnapshotResponseHandler: received a reply a4bffdee-6562-4179-bbcd-2dfbb5550fc0<-34671d38-b53b-4109-b2ef-192b14535a6e#0:FAIL-t2,IN_PROGRESS
2021-10-05 13:24:13,297 [grpc-default-executor-4] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onNext(417)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D->34671d38-b53b-4109-b2ef-192b14535a6e-InstallSnapshotResponseHandler: InstallSnapshot in progress.
2021-10-05 13:24:13,298 [grpc-default-executor-0] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(46)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D->34671d38-b53b-4109-b2ef-192b14535a6e: nextIndex: updateUnconditionally 0 -> 0
2021-10-05 13:24:13,300 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D->34671d38-b53b-4109-b2ef-192b14535a6e-GrpcLogAppender-LogAppenderDaemon] INFO  server.GrpcLogAppender (GrpcLogAppender.java:installSnapshot(524)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D->34671d38-b53b-4109-b2ef-192b14535a6e-GrpcLogAppender: followerNextIndex = 0 but logStartIndex = 105, notify follower to install snapshot-(t:2, i:105)
2021-10-05 13:24:13,300 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D->34671d38-b53b-4109-b2ef-192b14535a6e-GrpcLogAppender-LogAppenderDaemon] INFO  server.GrpcLogAppender (GrpcLogAppender.java:installSnapshot(532)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D->34671d38-b53b-4109-b2ef-192b14535a6e-GrpcLogAppender: send a4bffdee-6562-4179-bbcd-2dfbb5550fc0->34671d38-b53b-4109-b2ef-192b14535a6e#0-t2,notify:(t:2, i:105)
2021-10-05 13:24:13,301 [grpc-default-executor-0] INFO  server.RaftServer$Division (RaftServerImpl.java:checkInconsistentAppendEntries(1293)) - 34671d38-b53b-4109-b2ef-192b14535a6e@group-C748F4B4520D: Failed appendEntries as snapshot ((t:2, i:105)) installation is in progress
2021-10-05 13:24:13,301 [grpc-default-executor-0] INFO  server.RaftServer$Division (RaftServerImpl.java:checkInconsistentAppendEntries(1285)) - 34671d38-b53b-4109-b2ef-192b14535a6e@group-C748F4B4520D: inconsistency entries. Reply:a4bffdee-6562-4179-bbcd-2dfbb5550fc0<-34671d38-b53b-4109-b2ef-192b14535a6e#6:FAIL-t2,INCONSISTENCY,nextIndex=0,followerCommit=-1
2021-10-05 13:24:13,302 [grpc-default-executor-0] INFO  server.RaftServer$Division (RaftServerImpl.java:installSnapshot(1329)) - 34671d38-b53b-4109-b2ef-192b14535a6e@group-C748F4B4520D: receive installSnapshot: a4bffdee-6562-4179-bbcd-2dfbb5550fc0->34671d38-b53b-4109-b2ef-192b14535a6e#0-t2,notify:(t:2, i:105)
2021-10-05 13:24:13,302 [grpc-default-executor-0] INFO  server.RaftServer$Division (RaftServerImpl.java:notifyStateMachineToInstallSnapshot(1611)) - 34671d38-b53b-4109-b2ef-192b14535a6e@group-C748F4B4520D: Snapshot Installation by StateMachine is in progress.
2021-10-05 13:24:13,303 [grpc-default-executor-4] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(46)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D->34671d38-b53b-4109-b2ef-192b14535a6e: nextIndex: updateUnconditionally 0 -> 0
2021-10-05 13:24:13,304 [grpc-default-executor-0] INFO  server.RaftServer$Division (RaftServerImpl.java:installSnapshotImpl(1459)) - 34671d38-b53b-4109-b2ef-192b14535a6e@group-C748F4B4520D: set new configuration index: 5
configurationEntry {
  peers {
    id: "86d8d056-6822-410c-8a18-8ea32f12a493"
    address: "localhost:15030"
  }
  peers {
    id: "a4bffdee-6562-4179-bbcd-2dfbb5550fc0"
    address: "localhost:15020"
  }
}
 from snapshot
2021-10-05 13:24:13,305 [grpc-default-executor-0] INFO  server.RaftServer$Division (ServerState.java:setRaftConf(387)) - 34671d38-b53b-4109-b2ef-192b14535a6e@group-C748F4B4520D: set configuration 5: [86d8d056-6822-410c-8a18-8ea32f12a493|rpc:localhost:15030|admin:|client:|dataStream:|priority:0, a4bffdee-6562-4179-bbcd-2dfbb5550fc0|rpc:localhost:15020|admin:|client:|dataStream:|priority:0], old=null
2021-10-05 13:24:13,305 [grpc-default-executor-0] INFO  server.RaftServer$Division (RaftServerImpl.java:installSnapshot(1340)) - 34671d38-b53b-4109-b2ef-192b14535a6e@group-C748F4B4520D: reply installSnapshot: a4bffdee-6562-4179-bbcd-2dfbb5550fc0<-34671d38-b53b-4109-b2ef-192b14535a6e#0:FAIL-t2,IN_PROGRESS
2021-10-05 13:24:13,305 [grpc-default-executor-0] INFO  server.GrpcServerProtocolService (GrpcServerProtocolService.java:onCompleted(140)) - 34671d38-b53b-4109-b2ef-192b14535a6e: Completed INSTALL_SNAPSHOT, lastRequest: a4bffdee-6562-4179-bbcd-2dfbb5550fc0->34671d38-b53b-4109-b2ef-192b14535a6e#0-t2,notify:(t:2, i:105)
2021-10-05 13:24:13,305 [grpc-default-executor-0] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onNext(400)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D->34671d38-b53b-4109-b2ef-192b14535a6e-InstallSnapshotResponseHandler: received a reply a4bffdee-6562-4179-bbcd-2dfbb5550fc0<-34671d38-b53b-4109-b2ef-192b14535a6e#0:FAIL-t2,IN_PROGRESS
2021-10-05 13:24:13,306 [grpc-default-executor-0] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onNext(417)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D->34671d38-b53b-4109-b2ef-192b14535a6e-InstallSnapshotResponseHandler: InstallSnapshot in progress.
2021-10-05 13:24:13,306 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D->34671d38-b53b-4109-b2ef-192b14535a6e-GrpcLogAppender-LogAppenderDaemon] INFO  server.GrpcLogAppender (GrpcLogAppender.java:installSnapshot(524)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D->34671d38-b53b-4109-b2ef-192b14535a6e-GrpcLogAppender: followerNextIndex = 0 but logStartIndex = 105, notify follower to install snapshot-(t:2, i:105)
2021-10-05 13:24:13,307 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D->34671d38-b53b-4109-b2ef-192b14535a6e-GrpcLogAppender-LogAppenderDaemon] INFO  server.GrpcLogAppender (GrpcLogAppender.java:installSnapshot(532)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D->34671d38-b53b-4109-b2ef-192b14535a6e-GrpcLogAppender: send a4bffdee-6562-4179-bbcd-2dfbb5550fc0->34671d38-b53b-4109-b2ef-192b14535a6e#0-t2,notify:(t:2, i:105)
2021-10-05 13:24:13,308 [grpc-default-executor-4] INFO  server.RaftServer$Division (RaftServerImpl.java:checkInconsistentAppendEntries(1293)) - 34671d38-b53b-4109-b2ef-192b14535a6e@group-C748F4B4520D: Failed appendEntries as snapshot ((t:2, i:105)) installation is in progress
2021-10-05 13:24:13,308 [grpc-default-executor-0] INFO  server.RaftServer$Division (RaftServerImpl.java:installSnapshot(1329)) - 34671d38-b53b-4109-b2ef-192b14535a6e@group-C748F4B4520D: receive installSnapshot: a4bffdee-6562-4179-bbcd-2dfbb5550fc0->34671d38-b53b-4109-b2ef-192b14535a6e#0-t2,notify:(t:2, i:105)
2021-10-05 13:24:13,308 [grpc-default-executor-4] INFO  server.RaftServer$Division (RaftServerImpl.java:checkInconsistentAppendEntries(1285)) - 34671d38-b53b-4109-b2ef-192b14535a6e@group-C748F4B4520D: inconsistency entries. Reply:a4bffdee-6562-4179-bbcd-2dfbb5550fc0<-34671d38-b53b-4109-b2ef-192b14535a6e#7:FAIL-t2,INCONSISTENCY,nextIndex=0,followerCommit=-1
2021-10-05 13:24:13,309 [grpc-default-executor-0] INFO  server.RaftServer$Division (RaftServerImpl.java:notifyStateMachineToInstallSnapshot(1611)) - 34671d38-b53b-4109-b2ef-192b14535a6e@group-C748F4B4520D: Snapshot Installation by StateMachine is in progress.
2021-10-05 13:24:13,309 [grpc-default-executor-0] INFO  server.RaftServer$Division (RaftServerImpl.java:installSnapshotImpl(1459)) - 34671d38-b53b-4109-b2ef-192b14535a6e@group-C748F4B4520D: set new configuration index: 5
configurationEntry {
  peers {
    id: "86d8d056-6822-410c-8a18-8ea32f12a493"
    address: "localhost:15030"
  }
  peers {
    id: "a4bffdee-6562-4179-bbcd-2dfbb5550fc0"
    address: "localhost:15020"
  }
}
 from snapshot
2021-10-05 13:24:13,309 [grpc-default-executor-0] INFO  server.RaftServer$Division (ServerState.java:setRaftConf(387)) - 34671d38-b53b-4109-b2ef-192b14535a6e@group-C748F4B4520D: set configuration 5: [86d8d056-6822-410c-8a18-8ea32f12a493|rpc:localhost:15030|admin:|client:|dataStream:|priority:0, a4bffdee-6562-4179-bbcd-2dfbb5550fc0|rpc:localhost:15020|admin:|client:|dataStream:|priority:0], old=null
2021-10-05 13:24:13,309 [grpc-default-executor-0] INFO  server.RaftServer$Division (RaftServerImpl.java:installSnapshot(1340)) - 34671d38-b53b-4109-b2ef-192b14535a6e@group-C748F4B4520D: reply installSnapshot: a4bffdee-6562-4179-bbcd-2dfbb5550fc0<-34671d38-b53b-4109-b2ef-192b14535a6e#0:FAIL-t2,IN_PROGRESS
2021-10-05 13:24:13,309 [grpc-default-executor-0] INFO  server.GrpcServerProtocolService (GrpcServerProtocolService.java:onCompleted(140)) - 34671d38-b53b-4109-b2ef-192b14535a6e: Completed INSTALL_SNAPSHOT, lastRequest: a4bffdee-6562-4179-bbcd-2dfbb5550fc0->34671d38-b53b-4109-b2ef-192b14535a6e#0-t2,notify:(t:2, i:105)
2021-10-05 13:24:13,311 [grpc-default-executor-0] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(46)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D->34671d38-b53b-4109-b2ef-192b14535a6e: nextIndex: updateUnconditionally 0 -> 0
2021-10-05 13:24:13,311 [grpc-default-executor-0] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onNext(400)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D->34671d38-b53b-4109-b2ef-192b14535a6e-InstallSnapshotResponseHandler: received a reply a4bffdee-6562-4179-bbcd-2dfbb5550fc0<-34671d38-b53b-4109-b2ef-192b14535a6e#0:FAIL-t2,IN_PROGRESS
2021-10-05 13:24:13,311 [grpc-default-executor-0] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onNext(417)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D->34671d38-b53b-4109-b2ef-192b14535a6e-InstallSnapshotResponseHandler: InstallSnapshot in progress.
2021-10-05 13:24:13,316 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D->34671d38-b53b-4109-b2ef-192b14535a6e-GrpcLogAppender-LogAppenderDaemon] INFO  server.GrpcLogAppender (GrpcLogAppender.java:installSnapshot(524)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D->34671d38-b53b-4109-b2ef-192b14535a6e-GrpcLogAppender: followerNextIndex = 0 but logStartIndex = 105, notify follower to install snapshot-(t:2, i:105)
2021-10-05 13:24:13,316 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D->34671d38-b53b-4109-b2ef-192b14535a6e-GrpcLogAppender-LogAppenderDaemon] INFO  server.GrpcLogAppender (GrpcLogAppender.java:installSnapshot(532)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D->34671d38-b53b-4109-b2ef-192b14535a6e-GrpcLogAppender: send a4bffdee-6562-4179-bbcd-2dfbb5550fc0->34671d38-b53b-4109-b2ef-192b14535a6e#0-t2,notify:(t:2, i:105)
2021-10-05 13:24:13,322 [grpc-default-executor-0] INFO  server.RaftServer$Division (RaftServerImpl.java:checkInconsistentAppendEntries(1293)) - 34671d38-b53b-4109-b2ef-192b14535a6e@group-C748F4B4520D: Failed appendEntries as snapshot ((t:2, i:105)) installation is in progress
2021-10-05 13:24:13,322 [grpc-default-executor-0] INFO  server.RaftServer$Division (RaftServerImpl.java:checkInconsistentAppendEntries(1285)) - 34671d38-b53b-4109-b2ef-192b14535a6e@group-C748F4B4520D: inconsistency entries. Reply:a4bffdee-6562-4179-bbcd-2dfbb5550fc0<-34671d38-b53b-4109-b2ef-192b14535a6e#8:FAIL-t2,INCONSISTENCY,nextIndex=0,followerCommit=-1
2021-10-05 13:24:13,322 [grpc-default-executor-4] INFO  server.RaftServer$Division (RaftServerImpl.java:installSnapshot(1329)) - 34671d38-b53b-4109-b2ef-192b14535a6e@group-C748F4B4520D: receive installSnapshot: a4bffdee-6562-4179-bbcd-2dfbb5550fc0->34671d38-b53b-4109-b2ef-192b14535a6e#0-t2,notify:(t:2, i:105)
2021-10-05 13:24:13,322 [grpc-default-executor-4] INFO  server.RaftServer$Division (RaftServerImpl.java:notifyStateMachineToInstallSnapshot(1611)) - 34671d38-b53b-4109-b2ef-192b14535a6e@group-C748F4B4520D: Snapshot Installation by StateMachine is in progress.
2021-10-05 13:24:13,322 [grpc-default-executor-4] INFO  server.RaftServer$Division (RaftServerImpl.java:installSnapshotImpl(1459)) - 34671d38-b53b-4109-b2ef-192b14535a6e@group-C748F4B4520D: set new configuration index: 5
configurationEntry {
  peers {
    id: "86d8d056-6822-410c-8a18-8ea32f12a493"
    address: "localhost:15030"
  }
  peers {
    id: "a4bffdee-6562-4179-bbcd-2dfbb5550fc0"
    address: "localhost:15020"
  }
}
 from snapshot
2021-10-05 13:24:13,323 [grpc-default-executor-4] INFO  server.RaftServer$Division (ServerState.java:setRaftConf(387)) - 34671d38-b53b-4109-b2ef-192b14535a6e@group-C748F4B4520D: set configuration 5: [86d8d056-6822-410c-8a18-8ea32f12a493|rpc:localhost:15030|admin:|client:|dataStream:|priority:0, a4bffdee-6562-4179-bbcd-2dfbb5550fc0|rpc:localhost:15020|admin:|client:|dataStream:|priority:0], old=null
2021-10-05 13:24:13,323 [grpc-default-executor-4] INFO  server.RaftServer$Division (RaftServerImpl.java:installSnapshot(1340)) - 34671d38-b53b-4109-b2ef-192b14535a6e@group-C748F4B4520D: reply installSnapshot: a4bffdee-6562-4179-bbcd-2dfbb5550fc0<-34671d38-b53b-4109-b2ef-192b14535a6e#0:FAIL-t2,IN_PROGRESS
2021-10-05 13:24:13,323 [grpc-default-executor-4] INFO  server.GrpcServerProtocolService (GrpcServerProtocolService.java:onCompleted(140)) - 34671d38-b53b-4109-b2ef-192b14535a6e: Completed INSTALL_SNAPSHOT, lastRequest: a4bffdee-6562-4179-bbcd-2dfbb5550fc0->34671d38-b53b-4109-b2ef-192b14535a6e#0-t2,notify:(t:2, i:105)
2021-10-05 13:24:13,331 [grpc-default-executor-4] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(46)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D->34671d38-b53b-4109-b2ef-192b14535a6e: nextIndex: updateUnconditionally 0 -> 0
2021-10-05 13:24:13,332 [grpc-default-executor-4] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onNext(400)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D->34671d38-b53b-4109-b2ef-192b14535a6e-InstallSnapshotResponseHandler: received a reply a4bffdee-6562-4179-bbcd-2dfbb5550fc0<-34671d38-b53b-4109-b2ef-192b14535a6e#0:FAIL-t2,IN_PROGRESS
2021-10-05 13:24:13,332 [grpc-default-executor-4] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onNext(417)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D->34671d38-b53b-4109-b2ef-192b14535a6e-InstallSnapshotResponseHandler: InstallSnapshot in progress.
2021-10-05 13:24:13,333 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D->34671d38-b53b-4109-b2ef-192b14535a6e-GrpcLogAppender-LogAppenderDaemon] INFO  server.GrpcLogAppender (GrpcLogAppender.java:installSnapshot(524)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D->34671d38-b53b-4109-b2ef-192b14535a6e-GrpcLogAppender: followerNextIndex = 0 but logStartIndex = 105, notify follower to install snapshot-(t:2, i:105)
2021-10-05 13:24:13,333 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D->34671d38-b53b-4109-b2ef-192b14535a6e-GrpcLogAppender-LogAppenderDaemon] INFO  server.GrpcLogAppender (GrpcLogAppender.java:installSnapshot(532)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D->34671d38-b53b-4109-b2ef-192b14535a6e-GrpcLogAppender: send a4bffdee-6562-4179-bbcd-2dfbb5550fc0->34671d38-b53b-4109-b2ef-192b14535a6e#0-t2,notify:(t:2, i:105)
2021-10-05 13:24:13,334 [grpc-default-executor-0] INFO  server.RaftServer$Division (RaftServerImpl.java:checkInconsistentAppendEntries(1293)) - 34671d38-b53b-4109-b2ef-192b14535a6e@group-C748F4B4520D: Failed appendEntries as snapshot ((t:2, i:105)) installation is in progress
2021-10-05 13:24:13,334 [grpc-default-executor-0] INFO  server.RaftServer$Division (RaftServerImpl.java:checkInconsistentAppendEntries(1285)) - 34671d38-b53b-4109-b2ef-192b14535a6e@group-C748F4B4520D: inconsistency entries. Reply:a4bffdee-6562-4179-bbcd-2dfbb5550fc0<-34671d38-b53b-4109-b2ef-192b14535a6e#9:FAIL-t2,INCONSISTENCY,nextIndex=0,followerCommit=-1
2021-10-05 13:24:13,335 [grpc-default-executor-4] INFO  server.RaftServer$Division (RaftServerImpl.java:installSnapshot(1329)) - 34671d38-b53b-4109-b2ef-192b14535a6e@group-C748F4B4520D: receive installSnapshot: a4bffdee-6562-4179-bbcd-2dfbb5550fc0->34671d38-b53b-4109-b2ef-192b14535a6e#0-t2,notify:(t:2, i:105)
2021-10-05 13:24:13,335 [grpc-default-executor-4] INFO  server.RaftServer$Division (RaftServerImpl.java:notifyStateMachineToInstallSnapshot(1611)) - 34671d38-b53b-4109-b2ef-192b14535a6e@group-C748F4B4520D: Snapshot Installation by StateMachine is in progress.
2021-10-05 13:24:13,335 [grpc-default-executor-0] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(46)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D->34671d38-b53b-4109-b2ef-192b14535a6e: nextIndex: updateUnconditionally 0 -> 0
2021-10-05 13:24:13,335 [grpc-default-executor-4] INFO  server.RaftServer$Division (RaftServerImpl.java:installSnapshotImpl(1459)) - 34671d38-b53b-4109-b2ef-192b14535a6e@group-C748F4B4520D: set new configuration index: 5
configurationEntry {
  peers {
    id: "86d8d056-6822-410c-8a18-8ea32f12a493"
    address: "localhost:15030"
  }
  peers {
    id: "a4bffdee-6562-4179-bbcd-2dfbb5550fc0"
    address: "localhost:15020"
  }
}
 from snapshot
2021-10-05 13:24:13,336 [grpc-default-executor-4] INFO  server.RaftServer$Division (ServerState.java:setRaftConf(387)) - 34671d38-b53b-4109-b2ef-192b14535a6e@group-C748F4B4520D: set configuration 5: [86d8d056-6822-410c-8a18-8ea32f12a493|rpc:localhost:15030|admin:|client:|dataStream:|priority:0, a4bffdee-6562-4179-bbcd-2dfbb5550fc0|rpc:localhost:15020|admin:|client:|dataStream:|priority:0], old=null
2021-10-05 13:24:13,336 [grpc-default-executor-4] INFO  server.RaftServer$Division (RaftServerImpl.java:installSnapshot(1340)) - 34671d38-b53b-4109-b2ef-192b14535a6e@group-C748F4B4520D: reply installSnapshot: a4bffdee-6562-4179-bbcd-2dfbb5550fc0<-34671d38-b53b-4109-b2ef-192b14535a6e#0:FAIL-t2,IN_PROGRESS
2021-10-05 13:24:13,336 [grpc-default-executor-4] INFO  server.GrpcServerProtocolService (GrpcServerProtocolService.java:onCompleted(140)) - 34671d38-b53b-4109-b2ef-192b14535a6e: Completed INSTALL_SNAPSHOT, lastRequest: a4bffdee-6562-4179-bbcd-2dfbb5550fc0->34671d38-b53b-4109-b2ef-192b14535a6e#0-t2,notify:(t:2, i:105)
2021-10-05 13:24:13,336 [grpc-default-executor-0] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onNext(400)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D->34671d38-b53b-4109-b2ef-192b14535a6e-InstallSnapshotResponseHandler: received a reply a4bffdee-6562-4179-bbcd-2dfbb5550fc0<-34671d38-b53b-4109-b2ef-192b14535a6e#0:FAIL-t2,IN_PROGRESS
2021-10-05 13:24:13,337 [grpc-default-executor-0] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onNext(417)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D->34671d38-b53b-4109-b2ef-192b14535a6e-InstallSnapshotResponseHandler: InstallSnapshot in progress.
2021-10-05 13:24:13,339 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D->34671d38-b53b-4109-b2ef-192b14535a6e-GrpcLogAppender-LogAppenderDaemon] INFO  server.GrpcLogAppender (GrpcLogAppender.java:installSnapshot(524)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D->34671d38-b53b-4109-b2ef-192b14535a6e-GrpcLogAppender: followerNextIndex = 0 but logStartIndex = 105, notify follower to install snapshot-(t:2, i:105)
2021-10-05 13:24:13,339 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D->34671d38-b53b-4109-b2ef-192b14535a6e-GrpcLogAppender-LogAppenderDaemon] INFO  server.GrpcLogAppender (GrpcLogAppender.java:installSnapshot(532)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D->34671d38-b53b-4109-b2ef-192b14535a6e-GrpcLogAppender: send a4bffdee-6562-4179-bbcd-2dfbb5550fc0->34671d38-b53b-4109-b2ef-192b14535a6e#0-t2,notify:(t:2, i:105)
2021-10-05 13:24:13,341 [grpc-default-executor-1] INFO  server.RaftServer$Division (RaftServerImpl.java:checkInconsistentAppendEntries(1293)) - 34671d38-b53b-4109-b2ef-192b14535a6e@group-C748F4B4520D: Failed appendEntries as snapshot ((t:2, i:105)) installation is in progress
2021-10-05 13:24:13,341 [grpc-default-executor-1] INFO  server.RaftServer$Division (RaftServerImpl.java:checkInconsistentAppendEntries(1285)) - 34671d38-b53b-4109-b2ef-192b14535a6e@group-C748F4B4520D: inconsistency entries. Reply:a4bffdee-6562-4179-bbcd-2dfbb5550fc0<-34671d38-b53b-4109-b2ef-192b14535a6e#10:FAIL-t2,INCONSISTENCY,nextIndex=0,followerCommit=-1
2021-10-05 13:24:13,348 [grpc-default-executor-4] INFO  server.RaftServer$Division (RaftServerImpl.java:installSnapshot(1329)) - 34671d38-b53b-4109-b2ef-192b14535a6e@group-C748F4B4520D: receive installSnapshot: a4bffdee-6562-4179-bbcd-2dfbb5550fc0->34671d38-b53b-4109-b2ef-192b14535a6e#0-t2,notify:(t:2, i:105)
2021-10-05 13:24:13,348 [grpc-default-executor-4] INFO  server.RaftServer$Division (RaftServerImpl.java:notifyStateMachineToInstallSnapshot(1611)) - 34671d38-b53b-4109-b2ef-192b14535a6e@group-C748F4B4520D: Snapshot Installation by StateMachine is in progress.
2021-10-05 13:24:13,348 [grpc-default-executor-4] INFO  server.RaftServer$Division (RaftServerImpl.java:installSnapshotImpl(1459)) - 34671d38-b53b-4109-b2ef-192b14535a6e@group-C748F4B4520D: set new configuration index: 5
configurationEntry {
  peers {
    id: "86d8d056-6822-410c-8a18-8ea32f12a493"
    address: "localhost:15030"
  }
  peers {
    id: "a4bffdee-6562-4179-bbcd-2dfbb5550fc0"
    address: "localhost:15020"
  }
}
 from snapshot
2021-10-05 13:24:13,348 [grpc-default-executor-4] INFO  server.RaftServer$Division (ServerState.java:setRaftConf(387)) - 34671d38-b53b-4109-b2ef-192b14535a6e@group-C748F4B4520D: set configuration 5: [86d8d056-6822-410c-8a18-8ea32f12a493|rpc:localhost:15030|admin:|client:|dataStream:|priority:0, a4bffdee-6562-4179-bbcd-2dfbb5550fc0|rpc:localhost:15020|admin:|client:|dataStream:|priority:0], old=null
2021-10-05 13:24:13,348 [grpc-default-executor-4] INFO  server.RaftServer$Division (RaftServerImpl.java:installSnapshot(1340)) - 34671d38-b53b-4109-b2ef-192b14535a6e@group-C748F4B4520D: reply installSnapshot: a4bffdee-6562-4179-bbcd-2dfbb5550fc0<-34671d38-b53b-4109-b2ef-192b14535a6e#0:FAIL-t2,IN_PROGRESS
2021-10-05 13:24:13,349 [grpc-default-executor-4] INFO  server.GrpcServerProtocolService (GrpcServerProtocolService.java:onCompleted(140)) - 34671d38-b53b-4109-b2ef-192b14535a6e: Completed INSTALL_SNAPSHOT, lastRequest: a4bffdee-6562-4179-bbcd-2dfbb5550fc0->34671d38-b53b-4109-b2ef-192b14535a6e#0-t2,notify:(t:2, i:105)
2021-10-05 13:24:13,349 [grpc-default-executor-1] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(46)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D->34671d38-b53b-4109-b2ef-192b14535a6e: nextIndex: updateUnconditionally 0 -> 0
2021-10-05 13:24:13,349 [grpc-default-executor-4] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onNext(400)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D->34671d38-b53b-4109-b2ef-192b14535a6e-InstallSnapshotResponseHandler: received a reply a4bffdee-6562-4179-bbcd-2dfbb5550fc0<-34671d38-b53b-4109-b2ef-192b14535a6e#0:FAIL-t2,IN_PROGRESS
2021-10-05 13:24:13,349 [grpc-default-executor-4] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onNext(417)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D->34671d38-b53b-4109-b2ef-192b14535a6e-InstallSnapshotResponseHandler: InstallSnapshot in progress.
2021-10-05 13:24:13,349 [grpc-default-executor-3] INFO  ha.SCMGrpcOutputStream (SCMGrpcOutputStream.java:close(111)) - Sent 7719 bytes for cluster 98f4f1fb-613f-4a4a-83a3-c748f4b4520d
2021-10-05 13:24:13,351 [grpc-default-executor-3] INFO  ha.SCMDBCheckpointProvider (SCMDBCheckpointProvider.java:writeDBCheckPointToSream(73)) - Time taken to write the checkpoint to response output stream: 65 milliseconds
2021-10-05 13:24:13,351 [grpc-default-executor-1] INFO  ha.InterSCMGrpcClient (InterSCMGrpcClient.java:onCompleted(173)) - Checkpoint is downloaded to /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-98f4f1fb-613f-4a4a-83a3-c748f4b4520d/scmNode-3/snapshot/scm.db-scmNode-1-1633440253236.tar.gz
2021-10-05 13:24:13,352 [grpc-default-executor-3] INFO  db.RocksDBCheckpoint (RocksDBCheckpoint.java:cleanupCheckpoint(78)) - Cleaning up RocksDB checkpoint at /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-98f4f1fb-613f-4a4a-83a3-c748f4b4520d/scmNode-1/db.checkpoints/scm.db_checkpoint_1633440253266
2021-10-05 13:24:13,355 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D->34671d38-b53b-4109-b2ef-192b14535a6e-GrpcLogAppender-LogAppenderDaemon] INFO  server.GrpcLogAppender (GrpcLogAppender.java:installSnapshot(524)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D->34671d38-b53b-4109-b2ef-192b14535a6e-GrpcLogAppender: followerNextIndex = 0 but logStartIndex = 105, notify follower to install snapshot-(t:2, i:105)
2021-10-05 13:24:13,355 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D->34671d38-b53b-4109-b2ef-192b14535a6e-GrpcLogAppender-LogAppenderDaemon] INFO  server.GrpcLogAppender (GrpcLogAppender.java:installSnapshot(532)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D->34671d38-b53b-4109-b2ef-192b14535a6e-GrpcLogAppender: send a4bffdee-6562-4179-bbcd-2dfbb5550fc0->34671d38-b53b-4109-b2ef-192b14535a6e#0-t2,notify:(t:2, i:105)
2021-10-05 13:24:13,355 [grpc-default-executor-4] INFO  server.RaftServer$Division (RaftServerImpl.java:checkInconsistentAppendEntries(1293)) - 34671d38-b53b-4109-b2ef-192b14535a6e@group-C748F4B4520D: Failed appendEntries as snapshot ((t:2, i:105)) installation is in progress
2021-10-05 13:24:13,355 [grpc-default-executor-4] INFO  server.RaftServer$Division (RaftServerImpl.java:checkInconsistentAppendEntries(1285)) - 34671d38-b53b-4109-b2ef-192b14535a6e@group-C748F4B4520D: inconsistency entries. Reply:a4bffdee-6562-4179-bbcd-2dfbb5550fc0<-34671d38-b53b-4109-b2ef-192b14535a6e#11:FAIL-t2,INCONSISTENCY,nextIndex=0,followerCommit=-1
2021-10-05 13:24:13,356 [grpc-default-executor-0] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(46)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D->34671d38-b53b-4109-b2ef-192b14535a6e: nextIndex: updateUnconditionally 0 -> 0
2021-10-05 13:24:13,357 [grpc-default-executor-1] INFO  server.RaftServer$Division (RaftServerImpl.java:installSnapshot(1329)) - 34671d38-b53b-4109-b2ef-192b14535a6e@group-C748F4B4520D: receive installSnapshot: a4bffdee-6562-4179-bbcd-2dfbb5550fc0->34671d38-b53b-4109-b2ef-192b14535a6e#0-t2,notify:(t:2, i:105)
2021-10-05 13:24:13,364 [grpc-default-executor-1] INFO  server.RaftServer$Division (RaftServerImpl.java:notifyStateMachineToInstallSnapshot(1611)) - 34671d38-b53b-4109-b2ef-192b14535a6e@group-C748F4B4520D: Snapshot Installation by StateMachine is in progress.
2021-10-05 13:24:13,364 [grpc-default-executor-1] INFO  server.RaftServer$Division (RaftServerImpl.java:installSnapshotImpl(1459)) - 34671d38-b53b-4109-b2ef-192b14535a6e@group-C748F4B4520D: set new configuration index: 5
configurationEntry {
  peers {
    id: "86d8d056-6822-410c-8a18-8ea32f12a493"
    address: "localhost:15030"
  }
  peers {
    id: "a4bffdee-6562-4179-bbcd-2dfbb5550fc0"
    address: "localhost:15020"
  }
}
 from snapshot
2021-10-05 13:24:13,364 [grpc-default-executor-1] INFO  server.RaftServer$Division (ServerState.java:setRaftConf(387)) - 34671d38-b53b-4109-b2ef-192b14535a6e@group-C748F4B4520D: set configuration 5: [86d8d056-6822-410c-8a18-8ea32f12a493|rpc:localhost:15030|admin:|client:|dataStream:|priority:0, a4bffdee-6562-4179-bbcd-2dfbb5550fc0|rpc:localhost:15020|admin:|client:|dataStream:|priority:0], old=null
2021-10-05 13:24:13,364 [grpc-default-executor-1] INFO  server.RaftServer$Division (RaftServerImpl.java:installSnapshot(1340)) - 34671d38-b53b-4109-b2ef-192b14535a6e@group-C748F4B4520D: reply installSnapshot: a4bffdee-6562-4179-bbcd-2dfbb5550fc0<-34671d38-b53b-4109-b2ef-192b14535a6e#0:FAIL-t2,IN_PROGRESS
2021-10-05 13:24:13,364 [grpc-default-executor-1] INFO  server.GrpcServerProtocolService (GrpcServerProtocolService.java:onCompleted(140)) - 34671d38-b53b-4109-b2ef-192b14535a6e: Completed INSTALL_SNAPSHOT, lastRequest: a4bffdee-6562-4179-bbcd-2dfbb5550fc0->34671d38-b53b-4109-b2ef-192b14535a6e#0-t2,notify:(t:2, i:105)
2021-10-05 13:24:13,366 [grpc-default-executor-1] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onNext(400)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D->34671d38-b53b-4109-b2ef-192b14535a6e-InstallSnapshotResponseHandler: received a reply a4bffdee-6562-4179-bbcd-2dfbb5550fc0<-34671d38-b53b-4109-b2ef-192b14535a6e#0:FAIL-t2,IN_PROGRESS
2021-10-05 13:24:13,366 [grpc-default-executor-1] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onNext(417)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D->34671d38-b53b-4109-b2ef-192b14535a6e-InstallSnapshotResponseHandler: InstallSnapshot in progress.
2021-10-05 13:24:13,368 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D->34671d38-b53b-4109-b2ef-192b14535a6e-GrpcLogAppender-LogAppenderDaemon] INFO  server.GrpcLogAppender (GrpcLogAppender.java:installSnapshot(524)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D->34671d38-b53b-4109-b2ef-192b14535a6e-GrpcLogAppender: followerNextIndex = 0 but logStartIndex = 105, notify follower to install snapshot-(t:2, i:105)
2021-10-05 13:24:13,368 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D->34671d38-b53b-4109-b2ef-192b14535a6e-GrpcLogAppender-LogAppenderDaemon] INFO  server.GrpcLogAppender (GrpcLogAppender.java:installSnapshot(532)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D->34671d38-b53b-4109-b2ef-192b14535a6e-GrpcLogAppender: send a4bffdee-6562-4179-bbcd-2dfbb5550fc0->34671d38-b53b-4109-b2ef-192b14535a6e#0-t2,notify:(t:2, i:105)
2021-10-05 13:24:13,371 [grpc-default-executor-0] INFO  server.RaftServer$Division (RaftServerImpl.java:installSnapshot(1329)) - 34671d38-b53b-4109-b2ef-192b14535a6e@group-C748F4B4520D: receive installSnapshot: a4bffdee-6562-4179-bbcd-2dfbb5550fc0->34671d38-b53b-4109-b2ef-192b14535a6e#0-t2,notify:(t:2, i:105)
2021-10-05 13:24:13,371 [grpc-default-executor-0] INFO  server.RaftServer$Division (RaftServerImpl.java:notifyStateMachineToInstallSnapshot(1611)) - 34671d38-b53b-4109-b2ef-192b14535a6e@group-C748F4B4520D: Snapshot Installation by StateMachine is in progress.
2021-10-05 13:24:13,371 [grpc-default-executor-0] INFO  server.RaftServer$Division (RaftServerImpl.java:installSnapshotImpl(1459)) - 34671d38-b53b-4109-b2ef-192b14535a6e@group-C748F4B4520D: set new configuration index: 5
configurationEntry {
  peers {
    id: "86d8d056-6822-410c-8a18-8ea32f12a493"
    address: "localhost:15030"
  }
  peers {
    id: "a4bffdee-6562-4179-bbcd-2dfbb5550fc0"
    address: "localhost:15020"
  }
}
 from snapshot
2021-10-05 13:24:13,371 [grpc-default-executor-0] INFO  server.RaftServer$Division (ServerState.java:setRaftConf(387)) - 34671d38-b53b-4109-b2ef-192b14535a6e@group-C748F4B4520D: set configuration 5: [86d8d056-6822-410c-8a18-8ea32f12a493|rpc:localhost:15030|admin:|client:|dataStream:|priority:0, a4bffdee-6562-4179-bbcd-2dfbb5550fc0|rpc:localhost:15020|admin:|client:|dataStream:|priority:0], old=null
2021-10-05 13:24:13,371 [grpc-default-executor-0] INFO  server.RaftServer$Division (RaftServerImpl.java:installSnapshot(1340)) - 34671d38-b53b-4109-b2ef-192b14535a6e@group-C748F4B4520D: reply installSnapshot: a4bffdee-6562-4179-bbcd-2dfbb5550fc0<-34671d38-b53b-4109-b2ef-192b14535a6e#0:FAIL-t2,IN_PROGRESS
2021-10-05 13:24:13,371 [grpc-default-executor-0] INFO  server.GrpcServerProtocolService (GrpcServerProtocolService.java:onCompleted(140)) - 34671d38-b53b-4109-b2ef-192b14535a6e: Completed INSTALL_SNAPSHOT, lastRequest: a4bffdee-6562-4179-bbcd-2dfbb5550fc0->34671d38-b53b-4109-b2ef-192b14535a6e#0-t2,notify:(t:2, i:105)
2021-10-05 13:24:13,373 [grpc-default-executor-1] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onNext(400)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D->34671d38-b53b-4109-b2ef-192b14535a6e-InstallSnapshotResponseHandler: received a reply a4bffdee-6562-4179-bbcd-2dfbb5550fc0<-34671d38-b53b-4109-b2ef-192b14535a6e#0:FAIL-t2,IN_PROGRESS
2021-10-05 13:24:13,373 [grpc-default-executor-1] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onNext(417)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D->34671d38-b53b-4109-b2ef-192b14535a6e-InstallSnapshotResponseHandler: InstallSnapshot in progress.
2021-10-05 13:24:13,374 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D->34671d38-b53b-4109-b2ef-192b14535a6e-GrpcLogAppender-LogAppenderDaemon] INFO  server.GrpcLogAppender (GrpcLogAppender.java:installSnapshot(524)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D->34671d38-b53b-4109-b2ef-192b14535a6e-GrpcLogAppender: followerNextIndex = 0 but logStartIndex = 105, notify follower to install snapshot-(t:2, i:105)
2021-10-05 13:24:13,374 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D->34671d38-b53b-4109-b2ef-192b14535a6e-GrpcLogAppender-LogAppenderDaemon] INFO  server.GrpcLogAppender (GrpcLogAppender.java:installSnapshot(532)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D->34671d38-b53b-4109-b2ef-192b14535a6e-GrpcLogAppender: send a4bffdee-6562-4179-bbcd-2dfbb5550fc0->34671d38-b53b-4109-b2ef-192b14535a6e#0-t2,notify:(t:2, i:105)
2021-10-05 13:24:13,375 [grpc-default-executor-4] INFO  server.RaftServer$Division (RaftServerImpl.java:checkInconsistentAppendEntries(1293)) - 34671d38-b53b-4109-b2ef-192b14535a6e@group-C748F4B4520D: Failed appendEntries as snapshot ((t:2, i:105)) installation is in progress
2021-10-05 13:24:13,375 [grpc-default-executor-4] INFO  server.RaftServer$Division (RaftServerImpl.java:checkInconsistentAppendEntries(1285)) - 34671d38-b53b-4109-b2ef-192b14535a6e@group-C748F4B4520D: inconsistency entries. Reply:a4bffdee-6562-4179-bbcd-2dfbb5550fc0<-34671d38-b53b-4109-b2ef-192b14535a6e#12:FAIL-t2,INCONSISTENCY,nextIndex=0,followerCommit=-1
2021-10-05 13:24:13,380 [grpc-default-executor-1] INFO  server.RaftServer$Division (RaftServerImpl.java:checkInconsistentAppendEntries(1293)) - 34671d38-b53b-4109-b2ef-192b14535a6e@group-C748F4B4520D: Failed appendEntries as snapshot ((t:2, i:105)) installation is in progress
2021-10-05 13:24:13,380 [grpc-default-executor-1] INFO  server.RaftServer$Division (RaftServerImpl.java:checkInconsistentAppendEntries(1285)) - 34671d38-b53b-4109-b2ef-192b14535a6e@group-C748F4B4520D: inconsistency entries. Reply:a4bffdee-6562-4179-bbcd-2dfbb5550fc0<-34671d38-b53b-4109-b2ef-192b14535a6e#13:FAIL-t2,INCONSISTENCY,nextIndex=0,followerCommit=-1
2021-10-05 13:24:13,380 [grpc-default-executor-0] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(46)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D->34671d38-b53b-4109-b2ef-192b14535a6e: nextIndex: updateUnconditionally 0 -> 0
2021-10-05 13:24:13,383 [grpc-default-executor-0] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(46)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D->34671d38-b53b-4109-b2ef-192b14535a6e: nextIndex: updateUnconditionally 0 -> 0
2021-10-05 13:24:13,383 [grpc-default-executor-4] INFO  server.RaftServer$Division (RaftServerImpl.java:installSnapshot(1329)) - 34671d38-b53b-4109-b2ef-192b14535a6e@group-C748F4B4520D: receive installSnapshot: a4bffdee-6562-4179-bbcd-2dfbb5550fc0->34671d38-b53b-4109-b2ef-192b14535a6e#0-t2,notify:(t:2, i:105)
2021-10-05 13:24:13,383 [grpc-default-executor-4] INFO  server.RaftServer$Division (RaftServerImpl.java:notifyStateMachineToInstallSnapshot(1611)) - 34671d38-b53b-4109-b2ef-192b14535a6e@group-C748F4B4520D: Snapshot Installation by StateMachine is in progress.
2021-10-05 13:24:13,383 [pool-58-thread-1] INFO  ha.SCMSnapshotProvider (SCMSnapshotProvider.java:getSCMDBSnapshot(131)) - Successfully downloaded latest checkpoint from leader SCM: scmNode-1 path /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-98f4f1fb-613f-4a4a-83a3-c748f4b4520d/scmNode-3/snapshot/scm.db-scmNode-1-1633440253236
2021-10-05 13:24:13,383 [pool-58-thread-1] INFO  ha.SCMHAManagerImpl (SCMHAManagerImpl.java:downloadCheckpointFromLeader(158)) - Downloaded checkpoint from Leader scmNode-1 to the location /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-98f4f1fb-613f-4a4a-83a3-c748f4b4520d/scmNode-3/snapshot/scm.db-scmNode-1-1633440253236
2021-10-05 13:24:13,384 [grpc-default-executor-4] INFO  server.RaftServer$Division (RaftServerImpl.java:installSnapshotImpl(1459)) - 34671d38-b53b-4109-b2ef-192b14535a6e@group-C748F4B4520D: set new configuration index: 5
configurationEntry {
  peers {
    id: "86d8d056-6822-410c-8a18-8ea32f12a493"
    address: "localhost:15030"
  }
  peers {
    id: "a4bffdee-6562-4179-bbcd-2dfbb5550fc0"
    address: "localhost:15020"
  }
}
 from snapshot
2021-10-05 13:24:13,384 [grpc-default-executor-4] INFO  server.RaftServer$Division (ServerState.java:setRaftConf(387)) - 34671d38-b53b-4109-b2ef-192b14535a6e@group-C748F4B4520D: set configuration 5: [86d8d056-6822-410c-8a18-8ea32f12a493|rpc:localhost:15030|admin:|client:|dataStream:|priority:0, a4bffdee-6562-4179-bbcd-2dfbb5550fc0|rpc:localhost:15020|admin:|client:|dataStream:|priority:0], old=null
2021-10-05 13:24:13,384 [grpc-default-executor-4] INFO  server.RaftServer$Division (RaftServerImpl.java:installSnapshot(1340)) - 34671d38-b53b-4109-b2ef-192b14535a6e@group-C748F4B4520D: reply installSnapshot: a4bffdee-6562-4179-bbcd-2dfbb5550fc0<-34671d38-b53b-4109-b2ef-192b14535a6e#0:FAIL-t2,IN_PROGRESS
2021-10-05 13:24:13,384 [grpc-default-executor-4] INFO  server.GrpcServerProtocolService (GrpcServerProtocolService.java:onCompleted(140)) - 34671d38-b53b-4109-b2ef-192b14535a6e: Completed INSTALL_SNAPSHOT, lastRequest: a4bffdee-6562-4179-bbcd-2dfbb5550fc0->34671d38-b53b-4109-b2ef-192b14535a6e#0-t2,notify:(t:2, i:105)
2021-10-05 13:24:13,386 [grpc-default-executor-0] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onNext(400)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D->34671d38-b53b-4109-b2ef-192b14535a6e-InstallSnapshotResponseHandler: received a reply a4bffdee-6562-4179-bbcd-2dfbb5550fc0<-34671d38-b53b-4109-b2ef-192b14535a6e#0:FAIL-t2,IN_PROGRESS
2021-10-05 13:24:13,386 [grpc-default-executor-0] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onNext(417)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D->34671d38-b53b-4109-b2ef-192b14535a6e-InstallSnapshotResponseHandler: InstallSnapshot in progress.
2021-10-05 13:24:13,387 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D->34671d38-b53b-4109-b2ef-192b14535a6e-GrpcLogAppender-LogAppenderDaemon] INFO  server.GrpcLogAppender (GrpcLogAppender.java:installSnapshot(524)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D->34671d38-b53b-4109-b2ef-192b14535a6e-GrpcLogAppender: followerNextIndex = 0 but logStartIndex = 105, notify follower to install snapshot-(t:2, i:105)
2021-10-05 13:24:13,388 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D->34671d38-b53b-4109-b2ef-192b14535a6e-GrpcLogAppender-LogAppenderDaemon] INFO  server.GrpcLogAppender (GrpcLogAppender.java:installSnapshot(532)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D->34671d38-b53b-4109-b2ef-192b14535a6e-GrpcLogAppender: send a4bffdee-6562-4179-bbcd-2dfbb5550fc0->34671d38-b53b-4109-b2ef-192b14535a6e#0-t2,notify:(t:2, i:105)
2021-10-05 13:24:13,388 [grpc-default-executor-0] INFO  server.RaftServer$Division (RaftServerImpl.java:checkInconsistentAppendEntries(1293)) - 34671d38-b53b-4109-b2ef-192b14535a6e@group-C748F4B4520D: Failed appendEntries as snapshot ((t:2, i:105)) installation is in progress
2021-10-05 13:24:13,388 [grpc-default-executor-0] INFO  server.RaftServer$Division (RaftServerImpl.java:checkInconsistentAppendEntries(1285)) - 34671d38-b53b-4109-b2ef-192b14535a6e@group-C748F4B4520D: inconsistency entries. Reply:a4bffdee-6562-4179-bbcd-2dfbb5550fc0<-34671d38-b53b-4109-b2ef-192b14535a6e#14:FAIL-t2,INCONSISTENCY,nextIndex=0,followerCommit=-1
2021-10-05 13:24:13,393 [grpc-default-executor-0] INFO  server.RaftServer$Division (RaftServerImpl.java:installSnapshot(1329)) - 34671d38-b53b-4109-b2ef-192b14535a6e@group-C748F4B4520D: receive installSnapshot: a4bffdee-6562-4179-bbcd-2dfbb5550fc0->34671d38-b53b-4109-b2ef-192b14535a6e#0-t2,notify:(t:2, i:105)
2021-10-05 13:24:13,393 [grpc-default-executor-0] INFO  server.RaftServer$Division (RaftServerImpl.java:notifyStateMachineToInstallSnapshot(1611)) - 34671d38-b53b-4109-b2ef-192b14535a6e@group-C748F4B4520D: Snapshot Installation by StateMachine is in progress.
2021-10-05 13:24:13,394 [grpc-default-executor-0] INFO  server.RaftServer$Division (RaftServerImpl.java:installSnapshotImpl(1459)) - 34671d38-b53b-4109-b2ef-192b14535a6e@group-C748F4B4520D: set new configuration index: 5
configurationEntry {
  peers {
    id: "86d8d056-6822-410c-8a18-8ea32f12a493"
    address: "localhost:15030"
  }
  peers {
    id: "a4bffdee-6562-4179-bbcd-2dfbb5550fc0"
    address: "localhost:15020"
  }
}
 from snapshot
2021-10-05 13:24:13,394 [grpc-default-executor-0] INFO  server.RaftServer$Division (ServerState.java:setRaftConf(387)) - 34671d38-b53b-4109-b2ef-192b14535a6e@group-C748F4B4520D: set configuration 5: [86d8d056-6822-410c-8a18-8ea32f12a493|rpc:localhost:15030|admin:|client:|dataStream:|priority:0, a4bffdee-6562-4179-bbcd-2dfbb5550fc0|rpc:localhost:15020|admin:|client:|dataStream:|priority:0], old=null
2021-10-05 13:24:13,394 [grpc-default-executor-0] INFO  server.RaftServer$Division (RaftServerImpl.java:installSnapshot(1340)) - 34671d38-b53b-4109-b2ef-192b14535a6e@group-C748F4B4520D: reply installSnapshot: a4bffdee-6562-4179-bbcd-2dfbb5550fc0<-34671d38-b53b-4109-b2ef-192b14535a6e#0:FAIL-t2,IN_PROGRESS
2021-10-05 13:24:13,395 [grpc-default-executor-1] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onNext(400)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D->34671d38-b53b-4109-b2ef-192b14535a6e-InstallSnapshotResponseHandler: received a reply a4bffdee-6562-4179-bbcd-2dfbb5550fc0<-34671d38-b53b-4109-b2ef-192b14535a6e#0:FAIL-t2,IN_PROGRESS
2021-10-05 13:24:13,395 [grpc-default-executor-4] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(46)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D->34671d38-b53b-4109-b2ef-192b14535a6e: nextIndex: updateUnconditionally 0 -> 0
2021-10-05 13:24:13,395 [grpc-default-executor-1] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onNext(417)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D->34671d38-b53b-4109-b2ef-192b14535a6e-InstallSnapshotResponseHandler: InstallSnapshot in progress.
2021-10-05 13:24:13,399 [grpc-default-executor-0] INFO  server.GrpcServerProtocolService (GrpcServerProtocolService.java:onCompleted(140)) - 34671d38-b53b-4109-b2ef-192b14535a6e: Completed INSTALL_SNAPSHOT, lastRequest: a4bffdee-6562-4179-bbcd-2dfbb5550fc0->34671d38-b53b-4109-b2ef-192b14535a6e#0-t2,notify:(t:2, i:105)
2021-10-05 13:24:13,401 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D->34671d38-b53b-4109-b2ef-192b14535a6e-GrpcLogAppender-LogAppenderDaemon] INFO  server.GrpcLogAppender (GrpcLogAppender.java:installSnapshot(524)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D->34671d38-b53b-4109-b2ef-192b14535a6e-GrpcLogAppender: followerNextIndex = 0 but logStartIndex = 105, notify follower to install snapshot-(t:2, i:105)
2021-10-05 13:24:13,401 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D->34671d38-b53b-4109-b2ef-192b14535a6e-GrpcLogAppender-LogAppenderDaemon] INFO  server.GrpcLogAppender (GrpcLogAppender.java:installSnapshot(532)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D->34671d38-b53b-4109-b2ef-192b14535a6e-GrpcLogAppender: send a4bffdee-6562-4179-bbcd-2dfbb5550fc0->34671d38-b53b-4109-b2ef-192b14535a6e#0-t2,notify:(t:2, i:105)
2021-10-05 13:24:13,401 [grpc-default-executor-0] INFO  server.RaftServer$Division (RaftServerImpl.java:checkInconsistentAppendEntries(1293)) - 34671d38-b53b-4109-b2ef-192b14535a6e@group-C748F4B4520D: Failed appendEntries as snapshot ((t:2, i:105)) installation is in progress
2021-10-05 13:24:13,401 [grpc-default-executor-0] INFO  server.RaftServer$Division (RaftServerImpl.java:checkInconsistentAppendEntries(1285)) - 34671d38-b53b-4109-b2ef-192b14535a6e@group-C748F4B4520D: inconsistency entries. Reply:a4bffdee-6562-4179-bbcd-2dfbb5550fc0<-34671d38-b53b-4109-b2ef-192b14535a6e#15:FAIL-t2,INCONSISTENCY,nextIndex=0,followerCommit=-1
2021-10-05 13:24:13,415 [grpc-default-executor-0] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(46)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D->34671d38-b53b-4109-b2ef-192b14535a6e: nextIndex: updateUnconditionally 0 -> 0
2021-10-05 13:24:13,415 [grpc-default-executor-3] INFO  server.RaftServer$Division (RaftServerImpl.java:installSnapshot(1329)) - 34671d38-b53b-4109-b2ef-192b14535a6e@group-C748F4B4520D: receive installSnapshot: a4bffdee-6562-4179-bbcd-2dfbb5550fc0->34671d38-b53b-4109-b2ef-192b14535a6e#0-t2,notify:(t:2, i:105)
2021-10-05 13:24:13,416 [grpc-default-executor-3] INFO  server.RaftServer$Division (RaftServerImpl.java:notifyStateMachineToInstallSnapshot(1611)) - 34671d38-b53b-4109-b2ef-192b14535a6e@group-C748F4B4520D: Snapshot Installation by StateMachine is in progress.
2021-10-05 13:24:13,416 [grpc-default-executor-3] INFO  server.RaftServer$Division (RaftServerImpl.java:installSnapshotImpl(1459)) - 34671d38-b53b-4109-b2ef-192b14535a6e@group-C748F4B4520D: set new configuration index: 5
configurationEntry {
  peers {
    id: "86d8d056-6822-410c-8a18-8ea32f12a493"
    address: "localhost:15030"
  }
  peers {
    id: "a4bffdee-6562-4179-bbcd-2dfbb5550fc0"
    address: "localhost:15020"
  }
}
 from snapshot
2021-10-05 13:24:13,416 [grpc-default-executor-3] INFO  server.RaftServer$Division (ServerState.java:setRaftConf(387)) - 34671d38-b53b-4109-b2ef-192b14535a6e@group-C748F4B4520D: set configuration 5: [86d8d056-6822-410c-8a18-8ea32f12a493|rpc:localhost:15030|admin:|client:|dataStream:|priority:0, a4bffdee-6562-4179-bbcd-2dfbb5550fc0|rpc:localhost:15020|admin:|client:|dataStream:|priority:0], old=null
2021-10-05 13:24:13,416 [grpc-default-executor-3] INFO  server.RaftServer$Division (RaftServerImpl.java:installSnapshot(1340)) - 34671d38-b53b-4109-b2ef-192b14535a6e@group-C748F4B4520D: reply installSnapshot: a4bffdee-6562-4179-bbcd-2dfbb5550fc0<-34671d38-b53b-4109-b2ef-192b14535a6e#0:FAIL-t2,IN_PROGRESS
2021-10-05 13:24:13,416 [grpc-default-executor-3] INFO  server.GrpcServerProtocolService (GrpcServerProtocolService.java:onCompleted(140)) - 34671d38-b53b-4109-b2ef-192b14535a6e: Completed INSTALL_SNAPSHOT, lastRequest: a4bffdee-6562-4179-bbcd-2dfbb5550fc0->34671d38-b53b-4109-b2ef-192b14535a6e#0-t2,notify:(t:2, i:105)
2021-10-05 13:24:13,417 [grpc-default-executor-0] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onNext(400)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D->34671d38-b53b-4109-b2ef-192b14535a6e-InstallSnapshotResponseHandler: received a reply a4bffdee-6562-4179-bbcd-2dfbb5550fc0<-34671d38-b53b-4109-b2ef-192b14535a6e#0:FAIL-t2,IN_PROGRESS
2021-10-05 13:24:13,417 [grpc-default-executor-0] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onNext(417)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D->34671d38-b53b-4109-b2ef-192b14535a6e-InstallSnapshotResponseHandler: InstallSnapshot in progress.
2021-10-05 13:24:13,418 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D->34671d38-b53b-4109-b2ef-192b14535a6e-GrpcLogAppender-LogAppenderDaemon] INFO  server.GrpcLogAppender (GrpcLogAppender.java:installSnapshot(524)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D->34671d38-b53b-4109-b2ef-192b14535a6e-GrpcLogAppender: followerNextIndex = 0 but logStartIndex = 105, notify follower to install snapshot-(t:2, i:105)
2021-10-05 13:24:13,418 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D->34671d38-b53b-4109-b2ef-192b14535a6e-GrpcLogAppender-LogAppenderDaemon] INFO  server.GrpcLogAppender (GrpcLogAppender.java:installSnapshot(532)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D->34671d38-b53b-4109-b2ef-192b14535a6e-GrpcLogAppender: send a4bffdee-6562-4179-bbcd-2dfbb5550fc0->34671d38-b53b-4109-b2ef-192b14535a6e#0-t2,notify:(t:2, i:105)
2021-10-05 13:24:13,420 [grpc-default-executor-3] INFO  server.RaftServer$Division (RaftServerImpl.java:installSnapshot(1329)) - 34671d38-b53b-4109-b2ef-192b14535a6e@group-C748F4B4520D: receive installSnapshot: a4bffdee-6562-4179-bbcd-2dfbb5550fc0->34671d38-b53b-4109-b2ef-192b14535a6e#0-t2,notify:(t:2, i:105)
2021-10-05 13:24:13,420 [grpc-default-executor-3] INFO  server.RaftServer$Division (RaftServerImpl.java:notifyStateMachineToInstallSnapshot(1611)) - 34671d38-b53b-4109-b2ef-192b14535a6e@group-C748F4B4520D: Snapshot Installation by StateMachine is in progress.
2021-10-05 13:24:13,420 [grpc-default-executor-3] INFO  server.RaftServer$Division (RaftServerImpl.java:installSnapshotImpl(1459)) - 34671d38-b53b-4109-b2ef-192b14535a6e@group-C748F4B4520D: set new configuration index: 5
configurationEntry {
  peers {
    id: "86d8d056-6822-410c-8a18-8ea32f12a493"
    address: "localhost:15030"
  }
  peers {
    id: "a4bffdee-6562-4179-bbcd-2dfbb5550fc0"
    address: "localhost:15020"
  }
}
 from snapshot
2021-10-05 13:24:13,420 [grpc-default-executor-3] INFO  server.RaftServer$Division (ServerState.java:setRaftConf(387)) - 34671d38-b53b-4109-b2ef-192b14535a6e@group-C748F4B4520D: set configuration 5: [86d8d056-6822-410c-8a18-8ea32f12a493|rpc:localhost:15030|admin:|client:|dataStream:|priority:0, a4bffdee-6562-4179-bbcd-2dfbb5550fc0|rpc:localhost:15020|admin:|client:|dataStream:|priority:0], old=null
2021-10-05 13:24:13,420 [grpc-default-executor-4] INFO  server.RaftServer$Division (RaftServerImpl.java:checkInconsistentAppendEntries(1293)) - 34671d38-b53b-4109-b2ef-192b14535a6e@group-C748F4B4520D: Failed appendEntries as snapshot ((t:2, i:105)) installation is in progress
2021-10-05 13:24:13,420 [grpc-default-executor-3] INFO  server.RaftServer$Division (RaftServerImpl.java:installSnapshot(1340)) - 34671d38-b53b-4109-b2ef-192b14535a6e@group-C748F4B4520D: reply installSnapshot: a4bffdee-6562-4179-bbcd-2dfbb5550fc0<-34671d38-b53b-4109-b2ef-192b14535a6e#0:FAIL-t2,IN_PROGRESS
2021-10-05 13:24:13,420 [grpc-default-executor-4] INFO  server.RaftServer$Division (RaftServerImpl.java:checkInconsistentAppendEntries(1285)) - 34671d38-b53b-4109-b2ef-192b14535a6e@group-C748F4B4520D: inconsistency entries. Reply:a4bffdee-6562-4179-bbcd-2dfbb5550fc0<-34671d38-b53b-4109-b2ef-192b14535a6e#16:FAIL-t2,INCONSISTENCY,nextIndex=0,followerCommit=-1
2021-10-05 13:24:13,420 [grpc-default-executor-3] INFO  server.GrpcServerProtocolService (GrpcServerProtocolService.java:onCompleted(140)) - 34671d38-b53b-4109-b2ef-192b14535a6e: Completed INSTALL_SNAPSHOT, lastRequest: a4bffdee-6562-4179-bbcd-2dfbb5550fc0->34671d38-b53b-4109-b2ef-192b14535a6e#0-t2,notify:(t:2, i:105)
2021-10-05 13:24:13,421 [grpc-default-executor-4] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onNext(400)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D->34671d38-b53b-4109-b2ef-192b14535a6e-InstallSnapshotResponseHandler: received a reply a4bffdee-6562-4179-bbcd-2dfbb5550fc0<-34671d38-b53b-4109-b2ef-192b14535a6e#0:FAIL-t2,IN_PROGRESS
2021-10-05 13:24:13,421 [grpc-default-executor-4] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onNext(417)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D->34671d38-b53b-4109-b2ef-192b14535a6e-InstallSnapshotResponseHandler: InstallSnapshot in progress.
2021-10-05 13:24:13,421 [grpc-default-executor-0] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(46)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D->34671d38-b53b-4109-b2ef-192b14535a6e: nextIndex: updateUnconditionally 0 -> 0
2021-10-05 13:24:13,422 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D->34671d38-b53b-4109-b2ef-192b14535a6e-GrpcLogAppender-LogAppenderDaemon] INFO  server.GrpcLogAppender (GrpcLogAppender.java:installSnapshot(524)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D->34671d38-b53b-4109-b2ef-192b14535a6e-GrpcLogAppender: followerNextIndex = 0 but logStartIndex = 105, notify follower to install snapshot-(t:2, i:105)
2021-10-05 13:24:13,422 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D->34671d38-b53b-4109-b2ef-192b14535a6e-GrpcLogAppender-LogAppenderDaemon] INFO  server.GrpcLogAppender (GrpcLogAppender.java:installSnapshot(532)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D->34671d38-b53b-4109-b2ef-192b14535a6e-GrpcLogAppender: send a4bffdee-6562-4179-bbcd-2dfbb5550fc0->34671d38-b53b-4109-b2ef-192b14535a6e#0-t2,notify:(t:2, i:105)
2021-10-05 13:24:13,423 [grpc-default-executor-3] INFO  server.RaftServer$Division (RaftServerImpl.java:checkInconsistentAppendEntries(1293)) - 34671d38-b53b-4109-b2ef-192b14535a6e@group-C748F4B4520D: Failed appendEntries as snapshot ((t:2, i:105)) installation is in progress
2021-10-05 13:24:13,423 [grpc-default-executor-3] INFO  server.RaftServer$Division (RaftServerImpl.java:checkInconsistentAppendEntries(1285)) - 34671d38-b53b-4109-b2ef-192b14535a6e@group-C748F4B4520D: inconsistency entries. Reply:a4bffdee-6562-4179-bbcd-2dfbb5550fc0<-34671d38-b53b-4109-b2ef-192b14535a6e#17:FAIL-t2,INCONSISTENCY,nextIndex=0,followerCommit=-1
2021-10-05 13:24:13,424 [grpc-default-executor-3] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(46)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D->34671d38-b53b-4109-b2ef-192b14535a6e: nextIndex: updateUnconditionally 0 -> 0
2021-10-05 13:24:13,425 [grpc-default-executor-0] INFO  server.RaftServer$Division (RaftServerImpl.java:installSnapshot(1329)) - 34671d38-b53b-4109-b2ef-192b14535a6e@group-C748F4B4520D: receive installSnapshot: a4bffdee-6562-4179-bbcd-2dfbb5550fc0->34671d38-b53b-4109-b2ef-192b14535a6e#0-t2,notify:(t:2, i:105)
2021-10-05 13:24:13,425 [grpc-default-executor-0] INFO  server.RaftServer$Division (RaftServerImpl.java:notifyStateMachineToInstallSnapshot(1611)) - 34671d38-b53b-4109-b2ef-192b14535a6e@group-C748F4B4520D: Snapshot Installation by StateMachine is in progress.
2021-10-05 13:24:13,425 [grpc-default-executor-0] INFO  server.RaftServer$Division (RaftServerImpl.java:installSnapshotImpl(1459)) - 34671d38-b53b-4109-b2ef-192b14535a6e@group-C748F4B4520D: set new configuration index: 5
configurationEntry {
  peers {
    id: "86d8d056-6822-410c-8a18-8ea32f12a493"
    address: "localhost:15030"
  }
  peers {
    id: "a4bffdee-6562-4179-bbcd-2dfbb5550fc0"
    address: "localhost:15020"
  }
}
 from snapshot
2021-10-05 13:24:13,425 [grpc-default-executor-0] INFO  server.RaftServer$Division (ServerState.java:setRaftConf(387)) - 34671d38-b53b-4109-b2ef-192b14535a6e@group-C748F4B4520D: set configuration 5: [86d8d056-6822-410c-8a18-8ea32f12a493|rpc:localhost:15030|admin:|client:|dataStream:|priority:0, a4bffdee-6562-4179-bbcd-2dfbb5550fc0|rpc:localhost:15020|admin:|client:|dataStream:|priority:0], old=null
2021-10-05 13:24:13,425 [grpc-default-executor-0] INFO  server.RaftServer$Division (RaftServerImpl.java:installSnapshot(1340)) - 34671d38-b53b-4109-b2ef-192b14535a6e@group-C748F4B4520D: reply installSnapshot: a4bffdee-6562-4179-bbcd-2dfbb5550fc0<-34671d38-b53b-4109-b2ef-192b14535a6e#0:FAIL-t2,IN_PROGRESS
2021-10-05 13:24:13,425 [grpc-default-executor-0] INFO  server.GrpcServerProtocolService (GrpcServerProtocolService.java:onCompleted(140)) - 34671d38-b53b-4109-b2ef-192b14535a6e: Completed INSTALL_SNAPSHOT, lastRequest: a4bffdee-6562-4179-bbcd-2dfbb5550fc0->34671d38-b53b-4109-b2ef-192b14535a6e#0-t2,notify:(t:2, i:105)
2021-10-05 13:24:13,426 [grpc-default-executor-4] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onNext(400)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D->34671d38-b53b-4109-b2ef-192b14535a6e-InstallSnapshotResponseHandler: received a reply a4bffdee-6562-4179-bbcd-2dfbb5550fc0<-34671d38-b53b-4109-b2ef-192b14535a6e#0:FAIL-t2,IN_PROGRESS
2021-10-05 13:24:13,426 [grpc-default-executor-4] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onNext(417)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D->34671d38-b53b-4109-b2ef-192b14535a6e-InstallSnapshotResponseHandler: InstallSnapshot in progress.
2021-10-05 13:24:13,428 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D->34671d38-b53b-4109-b2ef-192b14535a6e-GrpcLogAppender-LogAppenderDaemon] INFO  server.GrpcLogAppender (GrpcLogAppender.java:installSnapshot(524)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D->34671d38-b53b-4109-b2ef-192b14535a6e-GrpcLogAppender: followerNextIndex = 0 but logStartIndex = 105, notify follower to install snapshot-(t:2, i:105)
2021-10-05 13:24:13,428 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D->34671d38-b53b-4109-b2ef-192b14535a6e-GrpcLogAppender-LogAppenderDaemon] INFO  server.GrpcLogAppender (GrpcLogAppender.java:installSnapshot(532)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D->34671d38-b53b-4109-b2ef-192b14535a6e-GrpcLogAppender: send a4bffdee-6562-4179-bbcd-2dfbb5550fc0->34671d38-b53b-4109-b2ef-192b14535a6e#0-t2,notify:(t:2, i:105)
2021-10-05 13:24:13,429 [grpc-default-executor-3] INFO  server.RaftServer$Division (RaftServerImpl.java:checkInconsistentAppendEntries(1293)) - 34671d38-b53b-4109-b2ef-192b14535a6e@group-C748F4B4520D: Failed appendEntries as snapshot ((t:2, i:105)) installation is in progress
2021-10-05 13:24:13,429 [grpc-default-executor-3] INFO  server.RaftServer$Division (RaftServerImpl.java:checkInconsistentAppendEntries(1285)) - 34671d38-b53b-4109-b2ef-192b14535a6e@group-C748F4B4520D: inconsistency entries. Reply:a4bffdee-6562-4179-bbcd-2dfbb5550fc0<-34671d38-b53b-4109-b2ef-192b14535a6e#18:FAIL-t2,INCONSISTENCY,nextIndex=0,followerCommit=-1
2021-10-05 13:24:13,429 [grpc-default-executor-4] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(46)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D->34671d38-b53b-4109-b2ef-192b14535a6e: nextIndex: updateUnconditionally 0 -> 0
2021-10-05 13:24:13,430 [grpc-default-executor-0] INFO  server.RaftServer$Division (RaftServerImpl.java:installSnapshot(1329)) - 34671d38-b53b-4109-b2ef-192b14535a6e@group-C748F4B4520D: receive installSnapshot: a4bffdee-6562-4179-bbcd-2dfbb5550fc0->34671d38-b53b-4109-b2ef-192b14535a6e#0-t2,notify:(t:2, i:105)
2021-10-05 13:24:13,430 [grpc-default-executor-0] INFO  server.RaftServer$Division (RaftServerImpl.java:notifyStateMachineToInstallSnapshot(1611)) - 34671d38-b53b-4109-b2ef-192b14535a6e@group-C748F4B4520D: Snapshot Installation by StateMachine is in progress.
2021-10-05 13:24:13,430 [grpc-default-executor-0] INFO  server.RaftServer$Division (RaftServerImpl.java:installSnapshotImpl(1459)) - 34671d38-b53b-4109-b2ef-192b14535a6e@group-C748F4B4520D: set new configuration index: 5
configurationEntry {
  peers {
    id: "86d8d056-6822-410c-8a18-8ea32f12a493"
    address: "localhost:15030"
  }
  peers {
    id: "a4bffdee-6562-4179-bbcd-2dfbb5550fc0"
    address: "localhost:15020"
  }
}
 from snapshot
2021-10-05 13:24:13,430 [grpc-default-executor-0] INFO  server.RaftServer$Division (ServerState.java:setRaftConf(387)) - 34671d38-b53b-4109-b2ef-192b14535a6e@group-C748F4B4520D: set configuration 5: [86d8d056-6822-410c-8a18-8ea32f12a493|rpc:localhost:15030|admin:|client:|dataStream:|priority:0, a4bffdee-6562-4179-bbcd-2dfbb5550fc0|rpc:localhost:15020|admin:|client:|dataStream:|priority:0], old=null
2021-10-05 13:24:13,430 [grpc-default-executor-0] INFO  server.RaftServer$Division (RaftServerImpl.java:installSnapshot(1340)) - 34671d38-b53b-4109-b2ef-192b14535a6e@group-C748F4B4520D: reply installSnapshot: a4bffdee-6562-4179-bbcd-2dfbb5550fc0<-34671d38-b53b-4109-b2ef-192b14535a6e#0:FAIL-t2,IN_PROGRESS
2021-10-05 13:24:13,431 [grpc-default-executor-0] INFO  server.GrpcServerProtocolService (GrpcServerProtocolService.java:onCompleted(140)) - 34671d38-b53b-4109-b2ef-192b14535a6e: Completed INSTALL_SNAPSHOT, lastRequest: a4bffdee-6562-4179-bbcd-2dfbb5550fc0->34671d38-b53b-4109-b2ef-192b14535a6e#0-t2,notify:(t:2, i:105)
2021-10-05 13:24:13,431 [grpc-default-executor-4] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onNext(400)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D->34671d38-b53b-4109-b2ef-192b14535a6e-InstallSnapshotResponseHandler: received a reply a4bffdee-6562-4179-bbcd-2dfbb5550fc0<-34671d38-b53b-4109-b2ef-192b14535a6e#0:FAIL-t2,IN_PROGRESS
2021-10-05 13:24:13,431 [grpc-default-executor-4] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onNext(417)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D->34671d38-b53b-4109-b2ef-192b14535a6e-InstallSnapshotResponseHandler: InstallSnapshot in progress.
2021-10-05 13:24:13,434 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D->34671d38-b53b-4109-b2ef-192b14535a6e-GrpcLogAppender-LogAppenderDaemon] INFO  server.GrpcLogAppender (GrpcLogAppender.java:installSnapshot(524)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D->34671d38-b53b-4109-b2ef-192b14535a6e-GrpcLogAppender: followerNextIndex = 0 but logStartIndex = 105, notify follower to install snapshot-(t:2, i:105)
2021-10-05 13:24:13,434 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D->34671d38-b53b-4109-b2ef-192b14535a6e-GrpcLogAppender-LogAppenderDaemon] INFO  server.GrpcLogAppender (GrpcLogAppender.java:installSnapshot(532)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D->34671d38-b53b-4109-b2ef-192b14535a6e-GrpcLogAppender: send a4bffdee-6562-4179-bbcd-2dfbb5550fc0->34671d38-b53b-4109-b2ef-192b14535a6e#0-t2,notify:(t:2, i:105)
2021-10-05 13:24:13,435 [grpc-default-executor-3] INFO  server.RaftServer$Division (RaftServerImpl.java:checkInconsistentAppendEntries(1293)) - 34671d38-b53b-4109-b2ef-192b14535a6e@group-C748F4B4520D: Failed appendEntries as snapshot ((t:2, i:105)) installation is in progress
2021-10-05 13:24:13,435 [grpc-default-executor-3] INFO  server.RaftServer$Division (RaftServerImpl.java:checkInconsistentAppendEntries(1285)) - 34671d38-b53b-4109-b2ef-192b14535a6e@group-C748F4B4520D: inconsistency entries. Reply:a4bffdee-6562-4179-bbcd-2dfbb5550fc0<-34671d38-b53b-4109-b2ef-192b14535a6e#19:FAIL-t2,INCONSISTENCY,nextIndex=0,followerCommit=-1
2021-10-05 13:24:13,436 [grpc-default-executor-4] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(46)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D->34671d38-b53b-4109-b2ef-192b14535a6e: nextIndex: updateUnconditionally 0 -> 0
2021-10-05 13:24:13,436 [grpc-default-executor-0] INFO  server.RaftServer$Division (RaftServerImpl.java:installSnapshot(1329)) - 34671d38-b53b-4109-b2ef-192b14535a6e@group-C748F4B4520D: receive installSnapshot: a4bffdee-6562-4179-bbcd-2dfbb5550fc0->34671d38-b53b-4109-b2ef-192b14535a6e#0-t2,notify:(t:2, i:105)
2021-10-05 13:24:13,437 [grpc-default-executor-0] INFO  server.RaftServer$Division (RaftServerImpl.java:notifyStateMachineToInstallSnapshot(1611)) - 34671d38-b53b-4109-b2ef-192b14535a6e@group-C748F4B4520D: Snapshot Installation by StateMachine is in progress.
2021-10-05 13:24:13,437 [grpc-default-executor-0] INFO  server.RaftServer$Division (RaftServerImpl.java:installSnapshotImpl(1459)) - 34671d38-b53b-4109-b2ef-192b14535a6e@group-C748F4B4520D: set new configuration index: 5
configurationEntry {
  peers {
    id: "86d8d056-6822-410c-8a18-8ea32f12a493"
    address: "localhost:15030"
  }
  peers {
    id: "a4bffdee-6562-4179-bbcd-2dfbb5550fc0"
    address: "localhost:15020"
  }
}
 from snapshot
2021-10-05 13:24:13,437 [grpc-default-executor-0] INFO  server.RaftServer$Division (ServerState.java:setRaftConf(387)) - 34671d38-b53b-4109-b2ef-192b14535a6e@group-C748F4B4520D: set configuration 5: [86d8d056-6822-410c-8a18-8ea32f12a493|rpc:localhost:15030|admin:|client:|dataStream:|priority:0, a4bffdee-6562-4179-bbcd-2dfbb5550fc0|rpc:localhost:15020|admin:|client:|dataStream:|priority:0], old=null
2021-10-05 13:24:13,437 [grpc-default-executor-0] INFO  server.RaftServer$Division (RaftServerImpl.java:installSnapshot(1340)) - 34671d38-b53b-4109-b2ef-192b14535a6e@group-C748F4B4520D: reply installSnapshot: a4bffdee-6562-4179-bbcd-2dfbb5550fc0<-34671d38-b53b-4109-b2ef-192b14535a6e#0:FAIL-t2,IN_PROGRESS
2021-10-05 13:24:13,438 [grpc-default-executor-0] INFO  server.GrpcServerProtocolService (GrpcServerProtocolService.java:onCompleted(140)) - 34671d38-b53b-4109-b2ef-192b14535a6e: Completed INSTALL_SNAPSHOT, lastRequest: a4bffdee-6562-4179-bbcd-2dfbb5550fc0->34671d38-b53b-4109-b2ef-192b14535a6e#0-t2,notify:(t:2, i:105)
2021-10-05 13:24:13,438 [grpc-default-executor-0] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onNext(400)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D->34671d38-b53b-4109-b2ef-192b14535a6e-InstallSnapshotResponseHandler: received a reply a4bffdee-6562-4179-bbcd-2dfbb5550fc0<-34671d38-b53b-4109-b2ef-192b14535a6e#0:FAIL-t2,IN_PROGRESS
2021-10-05 13:24:13,438 [grpc-default-executor-0] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onNext(417)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D->34671d38-b53b-4109-b2ef-192b14535a6e-InstallSnapshotResponseHandler: InstallSnapshot in progress.
2021-10-05 13:24:13,441 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D->34671d38-b53b-4109-b2ef-192b14535a6e-GrpcLogAppender-LogAppenderDaemon] INFO  server.GrpcLogAppender (GrpcLogAppender.java:installSnapshot(524)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D->34671d38-b53b-4109-b2ef-192b14535a6e-GrpcLogAppender: followerNextIndex = 0 but logStartIndex = 105, notify follower to install snapshot-(t:2, i:105)
2021-10-05 13:24:13,441 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D->34671d38-b53b-4109-b2ef-192b14535a6e-GrpcLogAppender-LogAppenderDaemon] INFO  server.GrpcLogAppender (GrpcLogAppender.java:installSnapshot(532)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D->34671d38-b53b-4109-b2ef-192b14535a6e-GrpcLogAppender: send a4bffdee-6562-4179-bbcd-2dfbb5550fc0->34671d38-b53b-4109-b2ef-192b14535a6e#0-t2,notify:(t:2, i:105)
2021-10-05 13:24:13,442 [grpc-default-executor-0] INFO  server.RaftServer$Division (RaftServerImpl.java:checkInconsistentAppendEntries(1293)) - 34671d38-b53b-4109-b2ef-192b14535a6e@group-C748F4B4520D: Failed appendEntries as snapshot ((t:2, i:105)) installation is in progress
2021-10-05 13:24:13,442 [grpc-default-executor-0] INFO  server.RaftServer$Division (RaftServerImpl.java:checkInconsistentAppendEntries(1285)) - 34671d38-b53b-4109-b2ef-192b14535a6e@group-C748F4B4520D: inconsistency entries. Reply:a4bffdee-6562-4179-bbcd-2dfbb5550fc0<-34671d38-b53b-4109-b2ef-192b14535a6e#20:FAIL-t2,INCONSISTENCY,nextIndex=0,followerCommit=-1
2021-10-05 13:24:13,443 [grpc-default-executor-3] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(46)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D->34671d38-b53b-4109-b2ef-192b14535a6e: nextIndex: updateUnconditionally 0 -> 0
2021-10-05 13:24:13,444 [grpc-default-executor-4] INFO  server.RaftServer$Division (RaftServerImpl.java:installSnapshot(1329)) - 34671d38-b53b-4109-b2ef-192b14535a6e@group-C748F4B4520D: receive installSnapshot: a4bffdee-6562-4179-bbcd-2dfbb5550fc0->34671d38-b53b-4109-b2ef-192b14535a6e#0-t2,notify:(t:2, i:105)
2021-10-05 13:24:13,444 [grpc-default-executor-4] INFO  server.RaftServer$Division (RaftServerImpl.java:notifyStateMachineToInstallSnapshot(1611)) - 34671d38-b53b-4109-b2ef-192b14535a6e@group-C748F4B4520D: Snapshot Installation by StateMachine is in progress.
2021-10-05 13:24:13,444 [grpc-default-executor-4] INFO  server.RaftServer$Division (RaftServerImpl.java:installSnapshotImpl(1459)) - 34671d38-b53b-4109-b2ef-192b14535a6e@group-C748F4B4520D: set new configuration index: 5
configurationEntry {
  peers {
    id: "86d8d056-6822-410c-8a18-8ea32f12a493"
    address: "localhost:15030"
  }
  peers {
    id: "a4bffdee-6562-4179-bbcd-2dfbb5550fc0"
    address: "localhost:15020"
  }
}
 from snapshot
2021-10-05 13:24:13,444 [grpc-default-executor-4] INFO  server.RaftServer$Division (ServerState.java:setRaftConf(387)) - 34671d38-b53b-4109-b2ef-192b14535a6e@group-C748F4B4520D: set configuration 5: [86d8d056-6822-410c-8a18-8ea32f12a493|rpc:localhost:15030|admin:|client:|dataStream:|priority:0, a4bffdee-6562-4179-bbcd-2dfbb5550fc0|rpc:localhost:15020|admin:|client:|dataStream:|priority:0], old=null
2021-10-05 13:24:13,444 [grpc-default-executor-4] INFO  server.RaftServer$Division (RaftServerImpl.java:installSnapshot(1340)) - 34671d38-b53b-4109-b2ef-192b14535a6e@group-C748F4B4520D: reply installSnapshot: a4bffdee-6562-4179-bbcd-2dfbb5550fc0<-34671d38-b53b-4109-b2ef-192b14535a6e#0:FAIL-t2,IN_PROGRESS
2021-10-05 13:24:13,445 [grpc-default-executor-4] INFO  server.GrpcServerProtocolService (GrpcServerProtocolService.java:onCompleted(140)) - 34671d38-b53b-4109-b2ef-192b14535a6e: Completed INSTALL_SNAPSHOT, lastRequest: a4bffdee-6562-4179-bbcd-2dfbb5550fc0->34671d38-b53b-4109-b2ef-192b14535a6e#0-t2,notify:(t:2, i:105)
2021-10-05 13:24:13,451 [pool-58-thread-1] INFO  ha.SCMHAManagerImpl (SCMHAManagerImpl.java:verifyCheckpointFromLeader(172)) - Installing checkpoint with SCMTransactionInfo 2#202
2021-10-05 13:24:13,451 [pool-58-thread-1] INFO  server.RaftServer$Division (RaftServerImpl.java:lambda$notifyStateMachineToInstallSnapshot$30(1594)) - 34671d38-b53b-4109-b2ef-192b14535a6e@group-C748F4B4520D: StateMachine successfully installed snapshot index 202. Reloading the StateMachine.
2021-10-05 13:24:13,451 [pool-58-thread-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:lambda$new$0(133)) - 34671d38-b53b-4109-b2ef-192b14535a6e@group-C748F4B4520D-SegmentedRaftLogWorker: flushIndex: setUnconditionally -1 -> 202
2021-10-05 13:24:13,452 [pool-58-thread-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:lambda$new$0(133)) - 34671d38-b53b-4109-b2ef-192b14535a6e@group-C748F4B4520D-SegmentedRaftLogWorker: safeCacheEvictIndex: setUnconditionally -1 -> 202
2021-10-05 13:24:13,452 [pool-58-thread-1] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - 34671d38-b53b-4109-b2ef-192b14535a6e@group-C748F4B4520D-SegmentedRaftLog: snapshotIndex: updateIncreasingly -1 -> 202
2021-10-05 13:24:13,455 [grpc-default-executor-4] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onNext(400)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D->34671d38-b53b-4109-b2ef-192b14535a6e-InstallSnapshotResponseHandler: received a reply a4bffdee-6562-4179-bbcd-2dfbb5550fc0<-34671d38-b53b-4109-b2ef-192b14535a6e#0:FAIL-t2,IN_PROGRESS
2021-10-05 13:24:13,455 [grpc-default-executor-4] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onNext(417)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D->34671d38-b53b-4109-b2ef-192b14535a6e-InstallSnapshotResponseHandler: InstallSnapshot in progress.
2021-10-05 13:24:13,459 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D->34671d38-b53b-4109-b2ef-192b14535a6e-GrpcLogAppender-LogAppenderDaemon] INFO  server.GrpcLogAppender (GrpcLogAppender.java:installSnapshot(524)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D->34671d38-b53b-4109-b2ef-192b14535a6e-GrpcLogAppender: followerNextIndex = 0 but logStartIndex = 105, notify follower to install snapshot-(t:2, i:105)
2021-10-05 13:24:13,459 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D->34671d38-b53b-4109-b2ef-192b14535a6e-GrpcLogAppender-LogAppenderDaemon] INFO  server.GrpcLogAppender (GrpcLogAppender.java:installSnapshot(532)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D->34671d38-b53b-4109-b2ef-192b14535a6e-GrpcLogAppender: send a4bffdee-6562-4179-bbcd-2dfbb5550fc0->34671d38-b53b-4109-b2ef-192b14535a6e#0-t2,notify:(t:2, i:105)
2021-10-05 13:24:13,463 [grpc-default-executor-4] INFO  server.RaftServer$Division (RaftServerImpl.java:installSnapshot(1329)) - 34671d38-b53b-4109-b2ef-192b14535a6e@group-C748F4B4520D: receive installSnapshot: a4bffdee-6562-4179-bbcd-2dfbb5550fc0->34671d38-b53b-4109-b2ef-192b14535a6e#0-t2,notify:(t:2, i:105)
2021-10-05 13:24:13,463 [grpc-default-executor-4] INFO  server.RaftServer$Division (RaftServerImpl.java:notifyStateMachineToInstallSnapshot(1560)) - 34671d38-b53b-4109-b2ef-192b14535a6e@group-C748F4B4520D: StateMachine snapshotIndex is 202
2021-10-05 13:24:13,463 [grpc-default-executor-4] INFO  server.RaftServer$Division (RaftServerImpl.java:installSnapshotImpl(1459)) - 34671d38-b53b-4109-b2ef-192b14535a6e@group-C748F4B4520D: set new configuration index: 5
configurationEntry {
  peers {
    id: "86d8d056-6822-410c-8a18-8ea32f12a493"
    address: "localhost:15030"
  }
  peers {
    id: "a4bffdee-6562-4179-bbcd-2dfbb5550fc0"
    address: "localhost:15020"
  }
}
 from snapshot
2021-10-05 13:24:13,463 [grpc-default-executor-4] INFO  server.RaftServer$Division (ServerState.java:setRaftConf(387)) - 34671d38-b53b-4109-b2ef-192b14535a6e@group-C748F4B4520D: set configuration 5: [86d8d056-6822-410c-8a18-8ea32f12a493|rpc:localhost:15030|admin:|client:|dataStream:|priority:0, a4bffdee-6562-4179-bbcd-2dfbb5550fc0|rpc:localhost:15020|admin:|client:|dataStream:|priority:0], old=null
2021-10-05 13:24:13,463 [grpc-default-executor-4] INFO  server.RaftServer$Division (RaftServerImpl.java:installSnapshot(1340)) - 34671d38-b53b-4109-b2ef-192b14535a6e@group-C748F4B4520D: reply installSnapshot: a4bffdee-6562-4179-bbcd-2dfbb5550fc0<-34671d38-b53b-4109-b2ef-192b14535a6e#0:FAIL-t2,ALREADY_INSTALLED,snapshotIndex=202
2021-10-05 13:24:13,464 [grpc-default-executor-4] INFO  server.GrpcServerProtocolService (GrpcServerProtocolService.java:onCompleted(140)) - 34671d38-b53b-4109-b2ef-192b14535a6e: Completed INSTALL_SNAPSHOT, lastRequest: a4bffdee-6562-4179-bbcd-2dfbb5550fc0->34671d38-b53b-4109-b2ef-192b14535a6e#0-t2,notify:(t:2, i:105)
2021-10-05 13:24:13,464 [grpc-default-executor-3] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onNext(400)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D->34671d38-b53b-4109-b2ef-192b14535a6e-InstallSnapshotResponseHandler: received a reply a4bffdee-6562-4179-bbcd-2dfbb5550fc0<-34671d38-b53b-4109-b2ef-192b14535a6e#0:FAIL-t2,ALREADY_INSTALLED,snapshotIndex=202
2021-10-05 13:24:13,464 [grpc-default-executor-3] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onNext(422)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D->34671d38-b53b-4109-b2ef-192b14535a6e-InstallSnapshotResponseHandler: Already Installed Snapshot Index 202.
2021-10-05 13:24:13,464 [grpc-default-executor-3] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(46)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D->34671d38-b53b-4109-b2ef-192b14535a6e: snapshotIndex: setUnconditionally 0 -> 202
2021-10-05 13:24:13,464 [grpc-default-executor-3] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(46)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D->34671d38-b53b-4109-b2ef-192b14535a6e: matchIndex: setUnconditionally 0 -> 202
2021-10-05 13:24:13,464 [grpc-default-executor-3] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(46)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D->34671d38-b53b-4109-b2ef-192b14535a6e: nextIndex: setUnconditionally 0 -> 203
2021-10-05 13:24:13,464 [grpc-default-executor-3] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(46)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D->34671d38-b53b-4109-b2ef-192b14535a6e: nextIndex: updateToMax old=203, new=203, updated? false
2021-10-05 13:24:13,489 [34671d38-b53b-4109-b2ef-192b14535a6e@group-C748F4B4520D-StateMachineUpdater] INFO  ha.SCMHAManagerImpl (SCMHAManagerImpl.java:installCheckpoint(227)) - Installing checkpoint with SCMTransactionInfo 2#202
2021-10-05 13:24:13,491 [34671d38-b53b-4109-b2ef-192b14535a6e@group-C748F4B4520D-StateMachineUpdater] INFO  ha.SCMHAManagerImpl (SCMHAManagerImpl.java:installCheckpoint(266)) - Replaced DB with checkpoint, term: 2, index: 202
2021-10-05 13:24:13,491 [34671d38-b53b-4109-b2ef-192b14535a6e@group-C748F4B4520D-StateMachineUpdater] WARN  utils.HAUtils (HAUtils.java:getMetaDir(342)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2021-10-05 13:24:13,491 [34671d38-b53b-4109-b2ef-192b14535a6e@group-C748F4B4520D-StateMachineUpdater] WARN  db.DBStoreBuilder (DBStoreBuilder.java:applyDBDefinition(145)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2021-10-05 13:24:13,517 [34671d38-b53b-4109-b2ef-192b14535a6e@group-C748F4B4520D-StateMachineUpdater] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:reinitialize(166)) - reinitialize SequenceIdGenerator.
2021-10-05 13:24:13,526 [34671d38-b53b-4109-b2ef-192b14535a6e@group-C748F4B4520D-StateMachineUpdater] INFO  ha.SCMHAManagerImpl (SCMHAManagerImpl.java:installCheckpoint(277)) - Reloaded SCM state with Term: 2 and Index: 202
2021-10-05 13:24:13,529 [34671d38-b53b-4109-b2ef-192b14535a6e@group-C748F4B4520D-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:lambda$new$0(89)) - 34671d38-b53b-4109-b2ef-192b14535a6e@group-C748F4B4520D-StateMachineUpdater: snapshotIndex: setUnconditionally -1 -> 202
2021-10-05 13:24:13,529 [34671d38-b53b-4109-b2ef-192b14535a6e@group-C748F4B4520D-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:lambda$new$0(89)) - 34671d38-b53b-4109-b2ef-192b14535a6e@group-C748F4B4520D-StateMachineUpdater: appliedIndex: setUnconditionally -1 -> 202
2021-10-05 13:24:13,700 [Datanode State Machine Thread - 0] ERROR datanode.RunningDatanodeState (RunningDatanodeState.java:computeNextContainerState(199)) - Error in executing end point task.
java.util.concurrent.ExecutionException: java.util.concurrent.TimeoutException
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.hadoop.ozone.container.common.states.datanode.RunningDatanodeState.computeNextContainerState(RunningDatanodeState.java:191)
	at org.apache.hadoop.ozone.container.common.states.datanode.RunningDatanodeState.await(RunningDatanodeState.java:231)
	at org.apache.hadoop.ozone.container.common.states.datanode.RunningDatanodeState.await(RunningDatanodeState.java:50)
	at org.apache.hadoop.ozone.container.common.statemachine.StateContext.execute(StateContext.java:629)
	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.start(DatanodeStateMachine.java:270)
	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.lambda$startDaemon$0(DatanodeStateMachine.java:457)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.util.concurrent.TimeoutException
	at java.util.concurrent.FutureTask.get(FutureTask.java:205)
	at org.apache.hadoop.ozone.container.common.states.datanode.RunningDatanodeState.lambda$execute$0(RunningDatanodeState.java:149)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
2021-10-05 13:24:13,771 [Datanode State Machine Thread - 0] ERROR datanode.RunningDatanodeState (RunningDatanodeState.java:computeNextContainerState(199)) - Error in executing end point task.
java.util.concurrent.ExecutionException: java.util.concurrent.TimeoutException
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.hadoop.ozone.container.common.states.datanode.RunningDatanodeState.computeNextContainerState(RunningDatanodeState.java:191)
	at org.apache.hadoop.ozone.container.common.states.datanode.RunningDatanodeState.await(RunningDatanodeState.java:231)
	at org.apache.hadoop.ozone.container.common.states.datanode.RunningDatanodeState.await(RunningDatanodeState.java:50)
	at org.apache.hadoop.ozone.container.common.statemachine.StateContext.execute(StateContext.java:629)
	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.start(DatanodeStateMachine.java:270)
	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.lambda$startDaemon$0(DatanodeStateMachine.java:457)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.util.concurrent.TimeoutException
	at java.util.concurrent.FutureTask.get(FutureTask.java:205)
	at org.apache.hadoop.ozone.container.common.states.datanode.RunningDatanodeState.lambda$execute$0(RunningDatanodeState.java:149)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
2021-10-05 13:24:16,702 [Datanode State Machine Thread - 0] ERROR datanode.RunningDatanodeState (RunningDatanodeState.java:computeNextContainerState(199)) - Error in executing end point task.
java.util.concurrent.ExecutionException: java.util.concurrent.TimeoutException
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.hadoop.ozone.container.common.states.datanode.RunningDatanodeState.computeNextContainerState(RunningDatanodeState.java:191)
	at org.apache.hadoop.ozone.container.common.states.datanode.RunningDatanodeState.await(RunningDatanodeState.java:231)
	at org.apache.hadoop.ozone.container.common.states.datanode.RunningDatanodeState.await(RunningDatanodeState.java:50)
	at org.apache.hadoop.ozone.container.common.statemachine.StateContext.execute(StateContext.java:629)
	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.start(DatanodeStateMachine.java:270)
	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.lambda$startDaemon$0(DatanodeStateMachine.java:457)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.util.concurrent.TimeoutException
	at java.util.concurrent.FutureTask.get(FutureTask.java:205)
	at org.apache.hadoop.ozone.container.common.states.datanode.RunningDatanodeState.lambda$execute$0(RunningDatanodeState.java:149)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
2021-10-05 13:24:17,765 [Datanode State Machine Thread - 0] ERROR datanode.RunningDatanodeState (RunningDatanodeState.java:computeNextContainerState(199)) - Error in executing end point task.
java.util.concurrent.ExecutionException: java.util.concurrent.TimeoutException
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.hadoop.ozone.container.common.states.datanode.RunningDatanodeState.computeNextContainerState(RunningDatanodeState.java:191)
	at org.apache.hadoop.ozone.container.common.states.datanode.RunningDatanodeState.await(RunningDatanodeState.java:231)
	at org.apache.hadoop.ozone.container.common.states.datanode.RunningDatanodeState.await(RunningDatanodeState.java:50)
	at org.apache.hadoop.ozone.container.common.statemachine.StateContext.execute(StateContext.java:629)
	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.start(DatanodeStateMachine.java:270)
	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.lambda$startDaemon$0(DatanodeStateMachine.java:457)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.util.concurrent.TimeoutException
	at java.util.concurrent.FutureTask.get(FutureTask.java:205)
	at org.apache.hadoop.ozone.container.common.states.datanode.RunningDatanodeState.lambda$execute$0(RunningDatanodeState.java:149)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
2021-10-05 13:24:17,777 [Datanode State Machine Thread - 0] ERROR datanode.RunningDatanodeState (RunningDatanodeState.java:computeNextContainerState(199)) - Error in executing end point task.
java.util.concurrent.ExecutionException: java.util.concurrent.TimeoutException
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.hadoop.ozone.container.common.states.datanode.RunningDatanodeState.computeNextContainerState(RunningDatanodeState.java:191)
	at org.apache.hadoop.ozone.container.common.states.datanode.RunningDatanodeState.await(RunningDatanodeState.java:231)
	at org.apache.hadoop.ozone.container.common.states.datanode.RunningDatanodeState.await(RunningDatanodeState.java:50)
	at org.apache.hadoop.ozone.container.common.statemachine.StateContext.execute(StateContext.java:629)
	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.start(DatanodeStateMachine.java:270)
	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.lambda$startDaemon$0(DatanodeStateMachine.java:457)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.util.concurrent.TimeoutException
	at java.util.concurrent.FutureTask.get(FutureTask.java:205)
	at org.apache.hadoop.ozone.container.common.states.datanode.RunningDatanodeState.lambda$execute$0(RunningDatanodeState.java:149)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
2021-10-05 13:24:18,285 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-LeaderStateImpl] INFO  server.RaftServer$Division (ServerState.java:setRaftConf(387)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D: set configuration 203: [86d8d056-6822-410c-8a18-8ea32f12a493|rpc:localhost:15030|priority:0, a4bffdee-6562-4179-bbcd-2dfbb5550fc0|rpc:localhost:15020|admin:|client:|dataStream:|priority:0, 34671d38-b53b-4109-b2ef-192b14535a6e|rpc:localhost:15040|priority:0], old=[86d8d056-6822-410c-8a18-8ea32f12a493|rpc:localhost:15030|priority:0, a4bffdee-6562-4179-bbcd-2dfbb5550fc0|rpc:localhost:15020|admin:|client:|dataStream:|priority:0]
2021-10-05 13:24:18,288 [grpc-default-executor-3] INFO  server.RaftServer$Division (ServerState.java:setRaftConf(387)) - 34671d38-b53b-4109-b2ef-192b14535a6e@group-C748F4B4520D: set configuration 203: [86d8d056-6822-410c-8a18-8ea32f12a493|rpc:localhost:15030|admin:|client:|dataStream:|priority:0, a4bffdee-6562-4179-bbcd-2dfbb5550fc0|rpc:localhost:15020|admin:|client:|dataStream:|priority:0, 34671d38-b53b-4109-b2ef-192b14535a6e|rpc:localhost:15040|admin:|client:|dataStream:|priority:0], old=[86d8d056-6822-410c-8a18-8ea32f12a493|rpc:localhost:15030|admin:|client:|dataStream:|priority:0, a4bffdee-6562-4179-bbcd-2dfbb5550fc0|rpc:localhost:15020|admin:|client:|dataStream:|priority:0]
2021-10-05 13:24:18,288 [grpc-default-executor-3] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:startLogSegment(394)) - 34671d38-b53b-4109-b2ef-192b14535a6e@group-C748F4B4520D-SegmentedRaftLogWorker: Starting segment from index:203
2021-10-05 13:24:18,289 [grpc-default-executor-4] INFO  server.RaftServer$Division (ServerState.java:setRaftConf(387)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D: set configuration 203: [86d8d056-6822-410c-8a18-8ea32f12a493|rpc:localhost:15030|admin:|client:|dataStream:|priority:0, a4bffdee-6562-4179-bbcd-2dfbb5550fc0|rpc:localhost:15020|admin:|client:|dataStream:|priority:0, 34671d38-b53b-4109-b2ef-192b14535a6e|rpc:localhost:15040|admin:|client:|dataStream:|priority:0], old=[86d8d056-6822-410c-8a18-8ea32f12a493|rpc:localhost:15030|admin:|client:|dataStream:|priority:0, a4bffdee-6562-4179-bbcd-2dfbb5550fc0|rpc:localhost:15020|admin:|client:|dataStream:|priority:0]
2021-10-05 13:24:18,291 [34671d38-b53b-4109-b2ef-192b14535a6e@group-C748F4B4520D-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(601)) - 34671d38-b53b-4109-b2ef-192b14535a6e@group-C748F4B4520D-SegmentedRaftLogWorker: created new log segment /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-98f4f1fb-613f-4a4a-83a3-c748f4b4520d/scmNode-3/scm-ha/98f4f1fb-613f-4a4a-83a3-c748f4b4520d/current/log_inprogress_203
2021-10-05 13:24:18,294 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-LeaderStateImpl] INFO  server.RaftServer$Division (ServerState.java:setRaftConf(387)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D: set configuration 205: [86d8d056-6822-410c-8a18-8ea32f12a493|rpc:localhost:15030|priority:0, a4bffdee-6562-4179-bbcd-2dfbb5550fc0|rpc:localhost:15020|admin:|client:|dataStream:|priority:0, 34671d38-b53b-4109-b2ef-192b14535a6e|rpc:localhost:15040|priority:0], old=null
2021-10-05 13:24:18,295 [grpc-default-executor-4] INFO  server.RaftServer$Division (ServerState.java:setRaftConf(387)) - 34671d38-b53b-4109-b2ef-192b14535a6e@group-C748F4B4520D: set configuration 205: [86d8d056-6822-410c-8a18-8ea32f12a493|rpc:localhost:15030|admin:|client:|dataStream:|priority:0, a4bffdee-6562-4179-bbcd-2dfbb5550fc0|rpc:localhost:15020|admin:|client:|dataStream:|priority:0, 34671d38-b53b-4109-b2ef-192b14535a6e|rpc:localhost:15040|admin:|client:|dataStream:|priority:0], old=null
2021-10-05 13:24:18,296 [grpc-default-executor-3] INFO  server.RaftServer$Division (ServerState.java:setRaftConf(387)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D: set configuration 205: [86d8d056-6822-410c-8a18-8ea32f12a493|rpc:localhost:15030|admin:|client:|dataStream:|priority:0, a4bffdee-6562-4179-bbcd-2dfbb5550fc0|rpc:localhost:15020|admin:|client:|dataStream:|priority:0, 34671d38-b53b-4109-b2ef-192b14535a6e|rpc:localhost:15040|admin:|client:|dataStream:|priority:0], old=null
2021-10-05 13:24:18,299 [34671d38-b53b-4109-b2ef-192b14535a6e@group-C748F4B4520D-StateMachineUpdater] INFO  safemode.HealthyPipelineSafeModeRule (HealthyPipelineSafeModeRule.java:initializeRule(152)) - Refreshed total pipeline count is 2, healthy pipeline threshold count is 1
2021-10-05 13:24:18,300 [IPC Server handler 2 on default port 15022] INFO  ha.SCMRatisServerImpl (SCMRatisServerImpl.java:addSCM(302)) - Successfully added new SCM: 34671d38-b53b-4109-b2ef-192b14535a6e.
2021-10-05 13:24:18,301 [34671d38-b53b-4109-b2ef-192b14535a6e@group-C748F4B4520D-StateMachineUpdater] INFO  safemode.ContainerSafeModeRule (ContainerSafeModeRule.java:reInitializeRule(177)) - Refreshed one replica container threshold 0, currentThreshold 0
2021-10-05 13:24:18,301 [34671d38-b53b-4109-b2ef-192b14535a6e@group-C748F4B4520D-StateMachineUpdater] INFO  safemode.OneReplicaPipelineSafeModeRule (OneReplicaPipelineSafeModeRule.java:initializeRule(176)) - Refreshed Total pipeline count is 2, pipeline's with at least one datanode reported threshold count is 2
2021-10-05 13:24:18,301 [34671d38-b53b-4109-b2ef-192b14535a6e@group-C748F4B4520D-StateMachineUpdater] INFO  server.SCMDatanodeProtocolServer (SCMDatanodeProtocolServer.java:start(181)) - RPC server for DataNodes is listening at /0.0.0.0:15041
2021-10-05 13:24:18,302 [Listener at 127.0.0.1/10356] INFO  ha.SCMHAManagerImpl (SCMHAManagerImpl.java:start(116)) - Successfully added SCM scmNode-3 to group group-C748F4B4520D:[86d8d056-6822-410c-8a18-8ea32f12a493|rpc:localhost:15030|admin:|client:|dataStream:|priority:0, a4bffdee-6562-4179-bbcd-2dfbb5550fc0|rpc:localhost:15020|admin:|client:|dataStream:|priority:0, 34671d38-b53b-4109-b2ef-192b14535a6e|rpc:localhost:15040|admin:|client:|dataStream:|priority:0]
2021-10-05 13:24:18,302 [Listener at 127.0.0.1/10356] INFO  ha.InterSCMGrpcService (InterSCMGrpcProtocolService.java:start(94)) - Starting SCM Grpc Service at port 15044
2021-10-05 13:24:18,304 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  ha.SCMStateMachine (SCMStateMachine.java:takeSnapshot(290)) - Current Snapshot Index 205, takeSnapshot took 1 ms
2021-10-05 13:24:18,305 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:takeSnapshot(281)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater: Took a snapshot at index 205
2021-10-05 13:24:18,305 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:lambda$new$0(89)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater: snapshotIndex: updateIncreasingly 200 -> 205
2021-10-05 13:24:18,305 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:purge(306)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-SegmentedRaftLog: purge 205
2021-10-05 13:24:18,305 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-SegmentedRaftLog: snapshotIndex: updateIncreasingly 200 -> 205
2021-10-05 13:24:18,305 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-SegmentedRaftLog: purgeIndex: updateToMax old=200, new=205, updated? true
2021-10-05 13:24:18,305 [Listener at 127.0.0.1/10356] INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:init(158)) - StorageContainerManager metrics system started (again)
2021-10-05 13:24:18,318 [IPC Server listener on 15041] INFO  ipc.Server (Server.java:run(1344)) - IPC Server listener on 15041: starting
2021-10-05 13:24:18,333 [IPC Server Responder] INFO  ipc.Server (Server.java:run(1507)) - IPC Server Responder: starting
2021-10-05 13:24:18,333 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  ha.SCMStateMachine (SCMStateMachine.java:takeSnapshot(290)) - Current Snapshot Index 205, takeSnapshot took 1 ms
2021-10-05 13:24:18,333 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:takeSnapshot(281)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater: Took a snapshot at index 205
2021-10-05 13:24:18,333 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:lambda$new$0(89)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater: snapshotIndex: updateIncreasingly 200 -> 205
2021-10-05 13:24:18,333 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:purge(306)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-SegmentedRaftLog: purge 205
2021-10-05 13:24:18,333 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-SegmentedRaftLog: snapshotIndex: updateIncreasingly 200 -> 205
2021-10-05 13:24:18,333 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-SegmentedRaftLog: purgeIndex: updateToMax old=200, new=205, updated? true
2021-10-05 13:24:18,334 [Listener at 127.0.0.1/10356] INFO  server.SCMClientProtocolServer (SCMClientProtocolServer.java:start(164)) - RPC server for Client  is listening at /0.0.0.0:15043
2021-10-05 13:24:18,335 [IPC Server Responder] INFO  ipc.Server (Server.java:run(1507)) - IPC Server Responder: starting
2021-10-05 13:24:18,335 [IPC Server listener on 15043] INFO  ipc.Server (Server.java:run(1344)) - IPC Server listener on 15043: starting
2021-10-05 13:24:18,336 [Listener at 127.0.0.1/10356] INFO  server.StorageContainerManager (StorageContainerManager.java:start(1318)) - ScmBlockLocationProtocol RPC server is listening at /0.0.0.0:15042
2021-10-05 13:24:18,337 [Listener at 127.0.0.1/10356] INFO  server.SCMBlockProtocolServer (SCMBlockProtocolServer.java:start(151)) - RPC server for Block Protocol is listening at /0.0.0.0:15042
2021-10-05 13:24:18,337 [IPC Server Responder] INFO  ipc.Server (Server.java:run(1507)) - IPC Server Responder: starting
2021-10-05 13:24:18,338 [IPC Server listener on 15042] INFO  ipc.Server (Server.java:run(1344)) - IPC Server listener on 15042: starting
2021-10-05 13:24:18,344 [Listener at 127.0.0.1/10356] INFO  server.StorageContainerManager (StorageContainerManager.java:start(1324)) - ScmDatanodeProtocl RPC server is listening at /0.0.0.0:15041
2021-10-05 13:24:18,350 [org.apache.hadoop.util.JvmPauseMonitor$Monitor@c334f3b] INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(188)) - Starting JVM pause monitor
2021-10-05 13:24:18,355 [IPC Server handler 1 on default port 15041] INFO  ipc.Server (Server.java:run(1026)) - IPC Server handler 1 on default port 15041: skipped Call#148 Retry#0 org.apache.hadoop.ozone.protocol.StorageContainerDatanodeProtocol.submitRequest from 127.0.0.1:39342
2021-10-05 13:24:18,355 [IPC Server handler 1 on default port 15041] INFO  ipc.Server (Server.java:run(1026)) - IPC Server handler 1 on default port 15041: skipped Call#112 Retry#0 org.apache.hadoop.ozone.protocol.StorageContainerDatanodeProtocol.submitRequest from 127.0.0.1:39324
2021-10-05 13:24:18,355 [IPC Server handler 1 on default port 15041] INFO  ipc.Server (Server.java:run(1026)) - IPC Server handler 1 on default port 15041: skipped Call#6 Retry#0 org.apache.hadoop.ozone.protocol.StorageContainerDatanodeProtocol.submitRequest from 127.0.0.1:39288
2021-10-05 13:24:18,355 [IPC Server handler 1 on default port 15041] INFO  ipc.Server (Server.java:run(1026)) - IPC Server handler 1 on default port 15041: skipped Call#28 Retry#0 org.apache.hadoop.ozone.protocol.StorageContainerDatanodeProtocol.submitRequest from 127.0.0.1:39298
2021-10-05 13:24:18,356 [IPC Server handler 1 on default port 15041] INFO  ipc.Server (Server.java:run(1026)) - IPC Server handler 1 on default port 15041: skipped Call#182 Retry#0 org.apache.hadoop.ozone.protocol.StorageContainerDatanodeProtocol.submitRequest from 127.0.0.1:39360
2021-10-05 13:24:18,356 [IPC Server handler 1 on default port 15041] INFO  ipc.Server (Server.java:run(1026)) - IPC Server handler 1 on default port 15041: skipped Call#76 Retry#0 org.apache.hadoop.ozone.protocol.StorageContainerDatanodeProtocol.submitRequest from 127.0.0.1:39308
2021-10-05 13:24:18,356 [IPC Server handler 1 on default port 15041] INFO  ipc.Server (Server.java:run(1026)) - IPC Server handler 1 on default port 15041: skipped Call#149 Retry#0 org.apache.hadoop.ozone.protocol.StorageContainerDatanodeProtocol.submitRequest from 127.0.0.1:39342
2021-10-05 13:24:18,356 [IPC Server handler 1 on default port 15041] INFO  ipc.Server (Server.java:run(1026)) - IPC Server handler 1 on default port 15041: skipped Call#113 Retry#0 org.apache.hadoop.ozone.protocol.StorageContainerDatanodeProtocol.submitRequest from 127.0.0.1:39324
2021-10-05 13:24:18,356 [IPC Server handler 1 on default port 15041] INFO  ipc.Server (Server.java:run(1026)) - IPC Server handler 1 on default port 15041: skipped Call#8 Retry#0 org.apache.hadoop.ozone.protocol.StorageContainerDatanodeProtocol.submitRequest from 127.0.0.1:39288
2021-10-05 13:24:18,356 [IPC Server handler 1 on default port 15041] INFO  ipc.Server (Server.java:run(1026)) - IPC Server handler 1 on default port 15041: skipped Call#29 Retry#0 org.apache.hadoop.ozone.protocol.StorageContainerDatanodeProtocol.submitRequest from 127.0.0.1:39298
2021-10-05 13:24:18,356 [IPC Server handler 1 on default port 15041] INFO  ipc.Server (Server.java:run(1026)) - IPC Server handler 1 on default port 15041: skipped Call#183 Retry#0 org.apache.hadoop.ozone.protocol.StorageContainerDatanodeProtocol.submitRequest from 127.0.0.1:39360
2021-10-05 13:24:18,356 [IPC Server handler 1 on default port 15041] INFO  ipc.Server (Server.java:run(1026)) - IPC Server handler 1 on default port 15041: skipped Call#77 Retry#0 org.apache.hadoop.ozone.protocol.StorageContainerDatanodeProtocol.submitRequest from 127.0.0.1:39308
2021-10-05 13:24:18,356 [IPC Server handler 1 on default port 15041] INFO  ipc.Server (Server.java:run(1026)) - IPC Server handler 1 on default port 15041: skipped Call#147 Retry#0 org.apache.hadoop.ozone.protocol.StorageContainerDatanodeProtocol.submitRequest from 127.0.0.1:39342
2021-10-05 13:24:18,356 [IPC Server handler 1 on default port 15041] INFO  ipc.Server (Server.java:run(1026)) - IPC Server handler 1 on default port 15041: skipped Call#114 Retry#0 org.apache.hadoop.ozone.protocol.StorageContainerDatanodeProtocol.submitRequest from 127.0.0.1:39324
2021-10-05 13:24:18,356 [IPC Server handler 1 on default port 15041] INFO  ipc.Server (Server.java:run(1026)) - IPC Server handler 1 on default port 15041: skipped Call#13 Retry#0 org.apache.hadoop.ozone.protocol.StorageContainerDatanodeProtocol.submitRequest from 127.0.0.1:39288
2021-10-05 13:24:18,356 [IPC Server handler 1 on default port 15041] INFO  ipc.Server (Server.java:run(1026)) - IPC Server handler 1 on default port 15041: skipped Call#30 Retry#0 org.apache.hadoop.ozone.protocol.StorageContainerDatanodeProtocol.submitRequest from 127.0.0.1:39298
2021-10-05 13:24:18,357 [IPC Server handler 0 on default port 15041] INFO  ipc.Server (Server.java:run(1026)) - IPC Server handler 0 on default port 15041: skipped Call#75 Retry#0 org.apache.hadoop.ozone.protocol.StorageContainerDatanodeProtocol.submitRequest from 127.0.0.1:39308
2021-10-05 13:24:18,357 [Listener at 127.0.0.1/10356] INFO  http.BaseHttpServer (BaseHttpServer.java:newHttpServer2BuilderForOzone(209)) - Starting Web-server for scm at: http://0.0.0.0:15038
2021-10-05 13:24:18,357 [Listener at 127.0.0.1/10356] INFO  http.BaseHttpServer (BaseHttpServer.java:<init>(107)) - Hadoop Security Enabled: false Ozone Security Enabled: false Ozone HTTP Security Enabled: false 
2021-10-05 13:24:18,359 [Listener at 127.0.0.1/10356] INFO  server.AuthenticationFilter (AuthenticationFilter.java:constructSecretProvider(240)) - Unable to initialize FileSignerSecretProvider, falling back to use random secrets.
2021-10-05 13:24:18,360 [Listener at 127.0.0.1/10356] WARN  http.HttpRequestLog (HttpRequestLog.java:getRequestLog(103)) - Jetty request log can only be enabled using Log4j
2021-10-05 13:24:18,361 [Listener at 127.0.0.1/10356] INFO  http.HttpServer2 (HttpServer2.java:addGlobalFilter(1030)) - Added global filter 'safety' (class=org.apache.hadoop.hdds.server.http.HttpServer2$QuotingInputFilter)
2021-10-05 13:24:18,362 [Listener at 127.0.0.1/10356] INFO  http.HttpServer2 (HttpServer2.java:addFilter(1006)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context scm
2021-10-05 13:24:18,362 [Listener at 127.0.0.1/10356] INFO  http.HttpServer2 (HttpServer2.java:addFilter(1014)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context logs
2021-10-05 13:24:18,362 [Listener at 127.0.0.1/10356] INFO  http.HttpServer2 (HttpServer2.java:addFilter(1014)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context static
2021-10-05 13:24:18,363 [Listener at 127.0.0.1/10356] INFO  http.HttpServer2 (HttpServer2.java:bindListener(1249)) - Jetty bound to port 15038
2021-10-05 13:24:18,363 [Listener at 127.0.0.1/10356] INFO  server.Server (Server.java:doStart(375)) - jetty-9.4.43.v20210629; built: 2021-06-30T11:07:22.254Z; git: 526006ecfa3af7f1a27ef3a288e2bef7ea9dd7e8; jvm 1.8.0_292-b10
2021-10-05 13:24:18,376 [Listener at 127.0.0.1/10356] INFO  server.session (DefaultSessionIdManager.java:doStart(334)) - DefaultSessionIdManager workerName=node0
2021-10-05 13:24:18,376 [Listener at 127.0.0.1/10356] INFO  server.session (DefaultSessionIdManager.java:doStart(339)) - No SessionScavenger set, using defaults
2021-10-05 13:24:18,376 [Listener at 127.0.0.1/10356] INFO  server.session (HouseKeeper.java:startScavenging(132)) - node0 Scavenging every 660000ms
2021-10-05 13:24:18,377 [Listener at 127.0.0.1/10356] INFO  handler.ContextHandler (ContextHandler.java:doStart(915)) - Started o.e.j.s.ServletContextHandler@1df2d986{logs,/logs,file:///home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/log,AVAILABLE}
2021-10-05 13:24:18,378 [Listener at 127.0.0.1/10356] INFO  handler.ContextHandler (ContextHandler.java:doStart(915)) - Started o.e.j.s.ServletContextHandler@52214284{static,/static,file:///home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-classes/webapps/static,AVAILABLE}
2021-10-05 13:24:18,381 [EndpointStateMachine task thread for /127.0.0.1:15041 - 0 ] INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(300)) - Ignore. OzoneContainer already started.
2021-10-05 13:24:18,381 [EndpointStateMachine task thread for /127.0.0.1:15041 - 0 ] INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(300)) - Ignore. OzoneContainer already started.
2021-10-05 13:24:18,382 [EndpointStateMachine task thread for /127.0.0.1:15041 - 0 ] INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(300)) - Ignore. OzoneContainer already started.
2021-10-05 13:24:18,385 [Listener at 127.0.0.1/10356] INFO  handler.ContextHandler (ContextHandler.java:doStart(915)) - Started o.e.j.w.WebAppContext@3edb7be5{scm,/,file:///home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-classes/webapps/scm/,AVAILABLE}{file:/home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-classes/webapps/scm}
2021-10-05 13:24:18,395 [Listener at 127.0.0.1/10356] INFO  server.AbstractConnector (AbstractConnector.java:doStart(331)) - Started ServerConnector@6216b817{HTTP/1.1, (http/1.1)}{0.0.0.0:15038}
2021-10-05 13:24:18,395 [Listener at 127.0.0.1/10356] INFO  server.Server (Server.java:doStart(415)) - Started @52054ms
2021-10-05 13:24:18,395 [Listener at 127.0.0.1/10356] WARN  impl.MetricsSystemImpl (MetricsSystemImpl.java:register(279)) - Sink prometheus already exists!
2021-10-05 13:24:18,395 [Listener at 127.0.0.1/10356] INFO  http.BaseHttpServer (BaseHttpServer.java:updateConnectorAddress(329)) - HTTP server of scm listening at http://0.0.0.0:15038
2021-10-05 13:24:18,404 [Listener at 127.0.0.1/10356] INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:shutdown(453)) - Shutting down the Mini Ozone Cluster
2021-10-05 13:24:18,405 [Listener at 127.0.0.1/10356] INFO  ozone.MiniOzoneHAClusterImpl (MiniOzoneHAClusterImpl.java:stop(298)) - Stopping the OzoneManager omNode-1
2021-10-05 13:24:18,405 [Listener at 127.0.0.1/10356] INFO  om.OzoneManager (OzoneManager.java:stop(1644)) - Stopping Ozone Manager
2021-10-05 13:24:18,406 [Listener at 127.0.0.1/10356] INFO  ipc.Server (Server.java:stop(3414)) - Stopping server on 10356
2021-10-05 13:24:18,413 [IPC Server listener on 10356] INFO  ipc.Server (Server.java:run(1376)) - Stopping IPC Server listener on 10356
2021-10-05 13:24:18,413 [IPC Server Responder] INFO  ipc.Server (Server.java:run(1512)) - Stopping IPC Server Responder
2021-10-05 13:24:18,417 [Listener at 127.0.0.1/10356] INFO  server.RaftServer (RaftServerProxy.java:lambda$close$6(391)) - omNode-1: close
2021-10-05 13:24:18,418 [Listener at 127.0.0.1/10356] INFO  server.RaftServer$Division (RaftServerImpl.java:lambda$close$4(407)) - omNode-1@group-523986131536: shutdown
2021-10-05 13:24:18,418 [Listener at 127.0.0.1/10356] INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-523986131536,id=omNode-1
2021-10-05 13:24:18,418 [Listener at 127.0.0.1/10356] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(91)) - omNode-1: shutdown omNode-1@group-523986131536-LeaderStateImpl
2021-10-05 13:24:18,418 [Listener at 127.0.0.1/10356] INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(282)) - omNode-1@group-523986131536-PendingRequests: sendNotLeaderResponses
2021-10-05 13:24:18,419 [omNode-1@group-523986131536-StateMachineUpdater] INFO  ratis.OzoneManagerStateMachine (OzoneManagerStateMachine.java:takeSnapshot(417)) - Current Snapshot Index (t:1, i:0)
2021-10-05 13:24:18,419 [omNode-1@group-523986131536-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:takeSnapshot(281)) - omNode-1@group-523986131536-StateMachineUpdater: Took a snapshot at index 0
2021-10-05 13:24:18,419 [omNode-1@group-523986131536-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:lambda$new$0(89)) - omNode-1@group-523986131536-StateMachineUpdater: snapshotIndex: updateIncreasingly -1 -> 0
2021-10-05 13:24:18,419 [omNode-1@group-523986131536-StateMachineUpdater] INFO  ratis.OzoneManagerStateMachine (OzoneManagerStateMachine.java:close(471)) - StateMachine has shutdown. Shutdown OzoneManager if not already shutdown.
2021-10-05 13:24:18,420 [Listener at 127.0.0.1/10356] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(149)) - omNode-1@group-523986131536-StateMachineUpdater: set stopIndex = 0
2021-10-05 13:24:18,420 [Listener at 127.0.0.1/10356] INFO  server.RaftServer$Division (ServerState.java:close(419)) - omNode-1@group-523986131536: closes. applyIndex: 0
2021-10-05 13:24:18,420 [omNode-1@group-523986131536-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:run(327)) - omNode-1@group-523986131536-SegmentedRaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2021-10-05 13:24:18,421 [Listener at 127.0.0.1/10356] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:close(237)) - omNode-1@group-523986131536-SegmentedRaftLogWorker close()
2021-10-05 13:24:18,424 [Listener at 127.0.0.1/10356] INFO  server.GrpcService (GrpcService.java:closeImpl(262)) - omNode-1: shutdown server with port 10360 now
2021-10-05 13:24:18,424 [Listener at 127.0.0.1/10356] INFO  server.GrpcService (GrpcService.java:closeImpl(271)) - omNode-1: shutdown server with port 10360 successfully
2021-10-05 13:24:18,424 [org.apache.ratis.util.JvmPauseMonitor$$Lambda$499/1586779822@440e28fa] INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(109)) - JvmPauseMonitor-omNode-1: Stopped
2021-10-05 13:24:18,425 [Listener at 127.0.0.1/10356] INFO  ratis.OzoneManagerDoubleBuffer (OzoneManagerDoubleBuffer.java:stop(437)) - Stopping OMDoubleBuffer flush thread
2021-10-05 13:24:18,425 [OMDoubleBufferFlushThread] INFO  ratis.OzoneManagerDoubleBuffer (OzoneManagerDoubleBuffer.java:flushTransactions(356)) - OMDoubleBuffer flush thread OMDoubleBufferFlushThread is interrupted and will exit. OMDoubleBufferFlushThread
2021-10-05 13:24:18,426 [Listener at 127.0.0.1/10356] INFO  utils.BackgroundService (BackgroundService.java:shutdown(132)) - Shutting down service KeyDeletingService
2021-10-05 13:24:18,427 [Listener at 127.0.0.1/10356] INFO  utils.BackgroundService (BackgroundService.java:shutdown(132)) - Shutting down service DirectoryDeletingService
2021-10-05 13:24:18,429 [Listener at 127.0.0.1/10356] INFO  handler.ContextHandler (ContextHandler.java:doStop(1153)) - Stopped o.e.j.w.WebAppContext@1427cc16{ozoneManager,/,null,STOPPED}{file:/home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-classes/webapps/ozoneManager}
2021-10-05 13:24:18,432 [Listener at 127.0.0.1/10356] INFO  server.AbstractConnector (AbstractConnector.java:doStop(381)) - Stopped ServerConnector@63f38fb1{HTTP/1.1, (http/1.1)}{0.0.0.0:10358}
2021-10-05 13:24:18,433 [Listener at 127.0.0.1/10356] INFO  server.session (HouseKeeper.java:stopScavenging(149)) - node0 Stopped scavenging
2021-10-05 13:24:18,433 [Listener at 127.0.0.1/10356] INFO  handler.ContextHandler (ContextHandler.java:doStop(1153)) - Stopped o.e.j.s.ServletContextHandler@2a201aa9{static,/static,file:///home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-classes/webapps/static,STOPPED}
2021-10-05 13:24:18,433 [Listener at 127.0.0.1/10356] INFO  handler.ContextHandler (ContextHandler.java:doStop(1153)) - Stopped o.e.j.s.ServletContextHandler@445eed0b{logs,/logs,file:///home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/log,STOPPED}
2021-10-05 13:24:18,436 [Listener at 127.0.0.1/10356] INFO  ozone.MiniOzoneHAClusterImpl (MiniOzoneHAClusterImpl.java:stop(306)) - Stopping the StorageContainerManager 86d8d056-6822-410c-8a18-8ea32f12a493
2021-10-05 13:24:18,436 [Listener at 127.0.0.1/10356] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1395)) - Stopping Container Balancer service.
2021-10-05 13:24:18,436 [Listener at 127.0.0.1/10356] INFO  balancer.ContainerBalancer (ContainerBalancer.java:stop(742)) - Container Balancer is not running.
2021-10-05 13:24:18,436 [Listener at 127.0.0.1/10356] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1402)) - Stopping Replication Manager Service.
2021-10-05 13:24:18,436 [Listener at 127.0.0.1/10356] INFO  container.ReplicationManager (ReplicationManager.java:stop(350)) - Stopping Replication Monitor Thread.
2021-10-05 13:24:18,436 [Listener at 127.0.0.1/10356] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1409)) - Stopping the Datanode Admin Monitor.
2021-10-05 13:24:18,437 [Listener at 127.0.0.1/10356] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1416)) - Stopping Lease Manager of the command watchers
2021-10-05 13:24:18,437 [Listener at 127.0.0.1/10356] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1423)) - Stopping datanode service RPC server
2021-10-05 13:24:18,437 [Listener at 127.0.0.1/10356] INFO  server.SCMDatanodeProtocolServer (SCMDatanodeProtocolServer.java:stop(389)) - Stopping the RPC server for DataNodes
2021-10-05 13:24:18,437 [Listener at 127.0.0.1/10356] INFO  ipc.Server (Server.java:stop(3414)) - Stopping server on 15031
2021-10-05 13:24:18,438 [IPC Server listener on 15031] INFO  ipc.Server (Server.java:run(1376)) - Stopping IPC Server listener on 15031
2021-10-05 13:24:18,443 [IPC Server Responder] INFO  ipc.Server (Server.java:run(1512)) - Stopping IPC Server Responder
2021-10-05 13:24:18,494 [SCM Heartbeat Processing Thread - 0] WARN  node.NodeStateManager (NodeStateManager.java:scheduleNextHealthCheck(799)) - Current Thread is interrupted, shutting down HB processing thread for Node Manager.
2021-10-05 13:24:18,498 [Listener at 127.0.0.1/10356] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1431)) - Stopping block service RPC server
2021-10-05 13:24:18,498 [Listener at 127.0.0.1/10356] INFO  server.SCMBlockProtocolServer (SCMBlockProtocolServer.java:stop(160)) - Stopping the RPC server for Block Protocol
2021-10-05 13:24:18,498 [Listener at 127.0.0.1/10356] INFO  ipc.Server (Server.java:stop(3414)) - Stopping server on 15032
2021-10-05 13:24:18,501 [IPC Server listener on 15032] INFO  ipc.Server (Server.java:run(1376)) - Stopping IPC Server listener on 15032
2021-10-05 13:24:18,502 [IPC Server Responder] INFO  ipc.Server (Server.java:run(1512)) - Stopping IPC Server Responder
2021-10-05 13:24:18,503 [Listener at 127.0.0.1/10356] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1438)) - Stopping the StorageContainerLocationProtocol RPC server
2021-10-05 13:24:18,503 [Listener at 127.0.0.1/10356] INFO  server.SCMClientProtocolServer (SCMClientProtocolServer.java:stop(173)) - Stopping the RPC server for Client Protocol
2021-10-05 13:24:18,503 [Listener at 127.0.0.1/10356] INFO  ipc.Server (Server.java:stop(3414)) - Stopping server on 15033
2021-10-05 13:24:18,506 [IPC Server listener on 15033] INFO  ipc.Server (Server.java:run(1376)) - Stopping IPC Server listener on 15033
2021-10-05 13:24:18,506 [Listener at 127.0.0.1/10356] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1445)) - Stopping Storage Container Manager HTTP server.
2021-10-05 13:24:18,506 [IPC Server Responder] INFO  ipc.Server (Server.java:run(1512)) - Stopping IPC Server Responder
2021-10-05 13:24:18,508 [Listener at 127.0.0.1/10356] INFO  handler.ContextHandler (ContextHandler.java:doStop(1153)) - Stopped o.e.j.w.WebAppContext@28f081ad{scm,/,null,STOPPED}{file:/home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-classes/webapps/scm}
2021-10-05 13:24:18,508 [Listener at 127.0.0.1/10356] INFO  server.AbstractConnector (AbstractConnector.java:doStop(381)) - Stopped ServerConnector@73158d35{HTTP/1.1, (http/1.1)}{0.0.0.0:15028}
2021-10-05 13:24:18,509 [Listener at 127.0.0.1/10356] INFO  server.session (HouseKeeper.java:stopScavenging(149)) - node0 Stopped scavenging
2021-10-05 13:24:18,509 [Listener at 127.0.0.1/10356] INFO  handler.ContextHandler (ContextHandler.java:doStop(1153)) - Stopped o.e.j.s.ServletContextHandler@28effa3f{static,/static,file:///home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-classes/webapps/static,STOPPED}
2021-10-05 13:24:18,509 [Listener at 127.0.0.1/10356] INFO  handler.ContextHandler (ContextHandler.java:doStop(1153)) - Stopped o.e.j.s.ServletContextHandler@600a1270{logs,/logs,file:///home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/log,STOPPED}
2021-10-05 13:24:18,510 [Listener at 127.0.0.1/10356] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1456)) - Stopping Block Manager Service.
2021-10-05 13:24:18,510 [Listener at 127.0.0.1/10356] INFO  utils.BackgroundService (BackgroundService.java:shutdown(132)) - Shutting down service SCMBlockDeletingService
2021-10-05 13:24:18,510 [Listener at 127.0.0.1/10356] INFO  utils.BackgroundService (BackgroundService.java:shutdown(132)) - Shutting down service SCMBlockDeletingService
2021-10-05 13:24:18,511 [Listener at 127.0.0.1/10356] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1483)) - Stopping SCM Event Queue.
2021-10-05 13:24:18,513 [Listener at 127.0.0.1/10356] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1494)) - Stopping SCM HA services.
2021-10-05 13:24:18,513 [Listener at 127.0.0.1/10356] INFO  ha.SCMRatisServerImpl (SCMRatisServerImpl.java:stop(236)) - stopping ratis server 0.0.0.0:15030
2021-10-05 13:24:18,514 [Listener at 127.0.0.1/10356] INFO  server.RaftServer (RaftServerProxy.java:lambda$close$6(391)) - 86d8d056-6822-410c-8a18-8ea32f12a493: close
2021-10-05 13:24:18,514 [Listener at 127.0.0.1/10356] INFO  server.RaftServer$Division (RaftServerImpl.java:lambda$close$4(407)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D: shutdown
2021-10-05 13:24:18,514 [Listener at 127.0.0.1/10356] INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-C748F4B4520D,id=86d8d056-6822-410c-8a18-8ea32f12a493
2021-10-05 13:24:18,514 [Listener at 127.0.0.1/10356] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(108)) - 86d8d056-6822-410c-8a18-8ea32f12a493: shutdown 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-FollowerState
2021-10-05 13:24:18,514 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-FollowerState] INFO  impl.FollowerState (FollowerState.java:run(143)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-FollowerState was interrupted: {}
java.lang.InterruptedException: sleep interrupted
	at java.lang.Thread.sleep(Native Method)
	at java.lang.Thread.sleep(Thread.java:340)
	at java.util.concurrent.TimeUnit.sleep(TimeUnit.java:386)
	at org.apache.ratis.util.TimeDuration.sleep(TimeDuration.java:324)
	at org.apache.ratis.util.TimeDuration.sleep(TimeDuration.java:309)
	at org.apache.ratis.server.impl.FollowerState.run(FollowerState.java:118)
2021-10-05 13:24:18,515 [Listener at 127.0.0.1/10356] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(149)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-StateMachineUpdater: set stopIndex = 205
2021-10-05 13:24:18,515 [Listener at 127.0.0.1/10356] INFO  server.RaftServer$Division (ServerState.java:close(419)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D: closes. applyIndex: 205
2021-10-05 13:24:18,515 [86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:run(327)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-SegmentedRaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2021-10-05 13:24:18,516 [Listener at 127.0.0.1/10356] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:close(237)) - 86d8d056-6822-410c-8a18-8ea32f12a493@group-C748F4B4520D-SegmentedRaftLogWorker close()
2021-10-05 13:24:18,517 [Listener at 127.0.0.1/10356] INFO  server.GrpcService (GrpcService.java:closeImpl(262)) - 86d8d056-6822-410c-8a18-8ea32f12a493: shutdown server with port 15030 now
2021-10-05 13:24:18,521 [grpc-default-executor-4] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(122)) - 86d8d056-6822-410c-8a18-8ea32f12a493: installSnapshot onError, lastRequest: a4bffdee-6562-4179-bbcd-2dfbb5550fc0->86d8d056-6822-410c-8a18-8ea32f12a493#2127-t2,previous=(t:2, i:205),leaderCommit=205,initializing? true,entries: size=1, first=(t:2, i:206), METADATAENTRY(c:205): org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2021-10-05 13:24:18,523 [Listener at 127.0.0.1/10356] INFO  server.GrpcService (GrpcService.java:closeImpl(271)) - 86d8d056-6822-410c-8a18-8ea32f12a493: shutdown server with port 15030 successfully
2021-10-05 13:24:18,523 [org.apache.ratis.util.JvmPauseMonitor$$Lambda$499/1586779822@753c7411] INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(109)) - JvmPauseMonitor-86d8d056-6822-410c-8a18-8ea32f12a493: Stopped
2021-10-05 13:24:18,523 [Listener at 127.0.0.1/10356] INFO  pipeline.BackgroundPipelineCreator (BackgroundPipelineCreatorV2.java:stop(158)) - Stopping RatisPipelineUtilsThread.
2021-10-05 13:24:18,524 [Listener at 127.0.0.1/10356] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1504)) - Stopping SCM MetadataStore.
2021-10-05 13:24:18,525 [Listener at 127.0.0.1/10356] INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:stop(210)) - Stopping StorageContainerManager metrics system...
2021-10-05 13:24:18,529 [grpc-default-executor-3] WARN  server.GrpcLogAppender (LogUtils.java:warn(122)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D->86d8d056-6822-410c-8a18-8ea32f12a493-AppendLogResponseHandler: Failed appendEntries: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: HTTP/2 error code: CANCEL
Received Rst Stream
2021-10-05 13:24:18,537 [grpc-default-executor-3] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(46)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D->86d8d056-6822-410c-8a18-8ea32f12a493: nextIndex: updateUnconditionally 207 -> 206
2021-10-05 13:24:18,537 [prometheus] INFO  impl.MetricsSinkAdapter (MetricsSinkAdapter.java:publishMetricsFromQueue(141)) - prometheus thread interrupted.
2021-10-05 13:24:18,537 [Listener at 127.0.0.1/10356] INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:stop(216)) - StorageContainerManager metrics system stopped.
2021-10-05 13:24:18,538 [Listener at 127.0.0.1/10356] INFO  ozone.MiniOzoneHAClusterImpl (MiniOzoneHAClusterImpl.java:stop(306)) - Stopping the StorageContainerManager a4bffdee-6562-4179-bbcd-2dfbb5550fc0
2021-10-05 13:24:18,538 [Listener at 127.0.0.1/10356] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1395)) - Stopping Container Balancer service.
2021-10-05 13:24:18,538 [Listener at 127.0.0.1/10356] INFO  balancer.ContainerBalancer (ContainerBalancer.java:stop(742)) - Container Balancer is not running.
2021-10-05 13:24:18,538 [Listener at 127.0.0.1/10356] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1402)) - Stopping Replication Manager Service.
2021-10-05 13:24:18,538 [Listener at 127.0.0.1/10356] INFO  container.ReplicationManager (ReplicationManager.java:stop(350)) - Stopping Replication Monitor Thread.
2021-10-05 13:24:18,538 [Listener at 127.0.0.1/10356] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1409)) - Stopping the Datanode Admin Monitor.
2021-10-05 13:24:18,538 [Listener at 127.0.0.1/10356] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1416)) - Stopping Lease Manager of the command watchers
2021-10-05 13:24:18,539 [Listener at 127.0.0.1/10356] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1423)) - Stopping datanode service RPC server
2021-10-05 13:24:18,539 [Listener at 127.0.0.1/10356] INFO  server.SCMDatanodeProtocolServer (SCMDatanodeProtocolServer.java:stop(389)) - Stopping the RPC server for DataNodes
2021-10-05 13:24:18,539 [Listener at 127.0.0.1/10356] INFO  ipc.Server (Server.java:stop(3414)) - Stopping server on 15021
2021-10-05 13:24:18,545 [IPC Server listener on 15021] INFO  ipc.Server (Server.java:run(1376)) - Stopping IPC Server listener on 15021
2021-10-05 13:24:18,555 [grpc-default-executor-4] WARN  server.GrpcLogAppender (LogUtils.java:warn(122)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D->86d8d056-6822-410c-8a18-8ea32f12a493-AppendLogResponseHandler: Failed appendEntries: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
2021-10-05 13:24:18,555 [IPC Server Responder] INFO  ipc.Server (Server.java:run(1512)) - Stopping IPC Server Responder
2021-10-05 13:24:18,556 [grpc-default-executor-4] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(46)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D->86d8d056-6822-410c-8a18-8ea32f12a493: nextIndex: updateUnconditionally 207 -> 206
2021-10-05 13:24:18,706 [EndpointStateMachine task thread for /127.0.0.1:15021 - 0 ] WARN  statemachine.EndpointStateMachine (EndpointStateMachine.java:logIfNeeded(236)) - Unable to communicate to SCM server at 127.0.0.1:15021 for past 0 seconds.
java.io.EOFException: End of File Exception between local host is: "fv-az270-324/10.1.0.10"; destination host is: "localhost":15021; : java.io.EOFException; For more details see:  http://wiki.apache.org/hadoop/EOFException
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.hadoop.net.NetUtils.wrapWithMessage(NetUtils.java:913)
	at org.apache.hadoop.net.NetUtils.wrapException(NetUtils.java:862)
	at org.apache.hadoop.ipc.Client.getRpcResponse(Client.java:1577)
	at org.apache.hadoop.ipc.Client.call(Client.java:1519)
	at org.apache.hadoop.ipc.Client.call(Client.java:1416)
	at org.apache.hadoop.ipc.ProtobufRpcEngine$Invoker.invoke(ProtobufRpcEngine.java:236)
	at org.apache.hadoop.ipc.ProtobufRpcEngine$Invoker.invoke(ProtobufRpcEngine.java:123)
	at com.sun.proxy.$Proxy48.submitRequest(Unknown Source)
	at org.apache.hadoop.ozone.protocolPB.StorageContainerDatanodeProtocolClientSideTranslatorPB.submitRequest(StorageContainerDatanodeProtocolClientSideTranslatorPB.java:117)
	at org.apache.hadoop.ozone.protocolPB.StorageContainerDatanodeProtocolClientSideTranslatorPB.sendHeartbeat(StorageContainerDatanodeProtocolClientSideTranslatorPB.java:149)
	at org.apache.hadoop.ozone.container.common.states.endpoint.HeartbeatEndpointTask.call(HeartbeatEndpointTask.java:179)
	at org.apache.hadoop.ozone.container.common.states.endpoint.HeartbeatEndpointTask.call(HeartbeatEndpointTask.java:82)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.io.EOFException
	at java.io.DataInputStream.readInt(DataInputStream.java:392)
	at org.apache.hadoop.ipc.Client$IpcStreams.readResponse(Client.java:1892)
	at org.apache.hadoop.ipc.Client$Connection.receiveRpcResponse(Client.java:1202)
	at org.apache.hadoop.ipc.Client$Connection.run(Client.java:1098)
2021-10-05 13:24:18,708 [IPC Server handler 0 on default port 15041] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/a9b6c243-aad2-4cee-be19-871628539a81
2021-10-05 13:24:18,707 [EndpointStateMachine task thread for /127.0.0.1:15031 - 0 ] WARN  statemachine.EndpointStateMachine (EndpointStateMachine.java:logIfNeeded(236)) - Unable to communicate to SCM server at 127.0.0.1:15031 for past 0 seconds.
java.io.EOFException: End of File Exception between local host is: "fv-az270-324/10.1.0.10"; destination host is: "localhost":15031; : java.io.EOFException; For more details see:  http://wiki.apache.org/hadoop/EOFException
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.hadoop.net.NetUtils.wrapWithMessage(NetUtils.java:913)
	at org.apache.hadoop.net.NetUtils.wrapException(NetUtils.java:862)
	at org.apache.hadoop.ipc.Client.getRpcResponse(Client.java:1577)
	at org.apache.hadoop.ipc.Client.call(Client.java:1519)
	at org.apache.hadoop.ipc.Client.call(Client.java:1416)
	at org.apache.hadoop.ipc.ProtobufRpcEngine$Invoker.invoke(ProtobufRpcEngine.java:236)
	at org.apache.hadoop.ipc.ProtobufRpcEngine$Invoker.invoke(ProtobufRpcEngine.java:123)
	at com.sun.proxy.$Proxy48.submitRequest(Unknown Source)
	at org.apache.hadoop.ozone.protocolPB.StorageContainerDatanodeProtocolClientSideTranslatorPB.submitRequest(StorageContainerDatanodeProtocolClientSideTranslatorPB.java:117)
	at org.apache.hadoop.ozone.protocolPB.StorageContainerDatanodeProtocolClientSideTranslatorPB.sendHeartbeat(StorageContainerDatanodeProtocolClientSideTranslatorPB.java:149)
	at org.apache.hadoop.ozone.container.common.states.endpoint.HeartbeatEndpointTask.call(HeartbeatEndpointTask.java:179)
	at org.apache.hadoop.ozone.container.common.states.endpoint.HeartbeatEndpointTask.call(HeartbeatEndpointTask.java:82)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.io.EOFException
	at java.io.DataInputStream.readInt(DataInputStream.java:392)
	at org.apache.hadoop.ipc.Client$IpcStreams.readResponse(Client.java:1892)
	at org.apache.hadoop.ipc.Client$Connection.receiveRpcResponse(Client.java:1202)
	at org.apache.hadoop.ipc.Client$Connection.run(Client.java:1098)
2021-10-05 13:24:18,708 [IPC Server handler 0 on default port 15041] INFO  node.SCMNodeManager (SCMNodeManager.java:register(389)) - Registered Data node : a9b6c243-aad2-4cee-be19-871628539a81{ip: 127.0.0.1, host: localhost, ports: [REPLICATION=45095, RATIS=36351, RATIS_ADMIN=36351, RATIS_SERVER=36351, STANDALONE=33273], networkLocation: /default-rack, certSerialId: null, persistedOpState: null, persistedOpStateExpiryEpochSec: 0}
2021-10-05 13:24:18,713 [EventQueue-NewNodeForNewNodeHandler] INFO  pipeline.BackgroundPipelineCreator (BackgroundPipelineCreatorV2.java:notifyEventTriggered(279)) - ignore, not leader SCM.
2021-10-05 13:24:18,714 [EventQueue-NodeRegistrationContainerReportForDataNodeSafeModeRule] INFO  safemode.SCMSafeModeManager (DataNodeSafeModeRule.java:process(71)) - SCM in safe mode. 1 DataNodes registered, 3 required.
2021-10-05 13:24:18,714 [EventQueue-NodeRegistrationContainerReportForContainerSafeModeRule] INFO  safemode.SCMSafeModeManager (SCMSafeModeManager.java:validateSafeModeExitRules(204)) - ContainerSafeModeRule rule is successfully validated
2021-10-05 13:24:18,716 [EventQueue-PipelineReportForOneReplicaPipelineSafeModeRule] INFO  safemode.SCMSafeModeManager (OneReplicaPipelineSafeModeRule.java:process(120)) - SCM in safe mode. Pipelines with at least one datanode reported count is 2, required at least one datanode reported per pipeline count is 2
2021-10-05 13:24:18,716 [EventQueue-PipelineReportForOneReplicaPipelineSafeModeRule] INFO  safemode.SCMSafeModeManager (SCMSafeModeManager.java:validateSafeModeExitRules(204)) - AtleastOneDatanodeReportedRule rule is successfully validated
2021-10-05 13:24:18,718 [EventQueue-OpenPipelineForHealthyPipelineSafeModeRule] INFO  safemode.SCMSafeModeManager (HealthyPipelineSafeModeRule.java:process(124)) - SCM in safe mode. Healthy pipelines reported count is 0, required healthy pipeline reported count is 1
2021-10-05 13:24:18,773 [IPC Server handler 4 on default port 15041] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/0c34be74-1f5b-4b04-a6d4-fde6c3deb89a
2021-10-05 13:24:18,773 [IPC Server handler 4 on default port 15041] INFO  node.SCMNodeManager (SCMNodeManager.java:register(389)) - Registered Data node : 0c34be74-1f5b-4b04-a6d4-fde6c3deb89a{ip: 127.0.0.1, host: localhost, ports: [REPLICATION=46311, RATIS=33359, RATIS_ADMIN=33359, RATIS_SERVER=33359, STANDALONE=44513], networkLocation: /default-rack, certSerialId: null, persistedOpState: null, persistedOpStateExpiryEpochSec: 0}
2021-10-05 13:24:18,773 [EventQueue-NewNodeForNewNodeHandler] INFO  pipeline.BackgroundPipelineCreator (BackgroundPipelineCreatorV2.java:notifyEventTriggered(279)) - ignore, not leader SCM.
2021-10-05 13:24:18,774 [EventQueue-NodeRegistrationContainerReportForDataNodeSafeModeRule] INFO  safemode.SCMSafeModeManager (DataNodeSafeModeRule.java:process(71)) - SCM in safe mode. 2 DataNodes registered, 3 required.
2021-10-05 13:24:18,774 [EventQueue-OpenPipelineForHealthyPipelineSafeModeRule] INFO  safemode.SCMSafeModeManager (HealthyPipelineSafeModeRule.java:process(124)) - SCM in safe mode. Healthy pipelines reported count is 0, required healthy pipeline reported count is 1
2021-10-05 13:24:18,779 [IPC Server handler 2 on default port 15041] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/f990c0ed-f7f2-4f8a-8ec9-db097d9c855e
2021-10-05 13:24:18,780 [IPC Server handler 2 on default port 15041] INFO  node.SCMNodeManager (SCMNodeManager.java:register(389)) - Registered Data node : f990c0ed-f7f2-4f8a-8ec9-db097d9c855e{ip: 127.0.0.1, host: localhost, ports: [REPLICATION=39769, RATIS=44595, RATIS_ADMIN=44595, RATIS_SERVER=44595, STANDALONE=39009], networkLocation: /default-rack, certSerialId: null, persistedOpState: null, persistedOpStateExpiryEpochSec: 0}
2021-10-05 13:24:18,780 [EventQueue-NewNodeForNewNodeHandler] INFO  pipeline.BackgroundPipelineCreator (BackgroundPipelineCreatorV2.java:notifyEventTriggered(279)) - ignore, not leader SCM.
2021-10-05 13:24:18,780 [EventQueue-NodeRegistrationContainerReportForDataNodeSafeModeRule] INFO  safemode.SCMSafeModeManager (DataNodeSafeModeRule.java:process(71)) - SCM in safe mode. 3 DataNodes registered, 3 required.
2021-10-05 13:24:18,780 [EventQueue-NodeRegistrationContainerReportForDataNodeSafeModeRule] INFO  safemode.SCMSafeModeManager (SCMSafeModeManager.java:validateSafeModeExitRules(204)) - DataNodeSafeModeRule rule is successfully validated
2021-10-05 13:24:18,780 [EventQueue-NodeRegistrationContainerReportForDataNodeSafeModeRule] INFO  safemode.SCMSafeModeManager (SCMSafeModeManager.java:completePreCheck(233)) - All SCM safe mode pre check rules have passed
2021-10-05 13:24:18,780 [EventQueue-NodeRegistrationContainerReportForDataNodeSafeModeRule] WARN  events.EventQueue (EventQueue.java:fireEvent(194)) - No event handler registered for event TypedEvent{payloadType=SafeModeStatus, name='Safe mode status'}
2021-10-05 13:24:18,781 [EventQueue-NodeRegistrationContainerReportForDataNodeSafeModeRule] INFO  ha.SCMContext (SCMContext.java:updateSafeModeStatus(205)) - Update SafeModeStatus from SafeModeStatus{safeModeStatus=true, preCheckPassed=false} to SafeModeStatus{safeModeStatus=true, preCheckPassed=true}.
2021-10-05 13:24:18,781 [EventQueue-NodeRegistrationContainerReportForDataNodeSafeModeRule] INFO  pipeline.BackgroundPipelineCreator (BackgroundPipelineCreatorV2.java:notifyEventTriggered(279)) - ignore, not leader SCM.
2021-10-05 13:24:18,781 [EventQueue-OpenPipelineForHealthyPipelineSafeModeRule] INFO  safemode.SCMSafeModeManager (HealthyPipelineSafeModeRule.java:process(124)) - SCM in safe mode. Healthy pipelines reported count is 1, required healthy pipeline reported count is 1
2021-10-05 13:24:18,781 [EventQueue-OpenPipelineForHealthyPipelineSafeModeRule] INFO  safemode.SCMSafeModeManager (SCMSafeModeManager.java:validateSafeModeExitRules(204)) - HealthyPipelineSafeModeRule rule is successfully validated
2021-10-05 13:24:18,781 [EventQueue-OpenPipelineForHealthyPipelineSafeModeRule] INFO  safemode.SCMSafeModeManager (SCMSafeModeManager.java:validateSafeModeExitRules(219)) - ScmSafeModeManager, all rules are successfully validated
2021-10-05 13:24:18,781 [EventQueue-OpenPipelineForHealthyPipelineSafeModeRule] INFO  safemode.SCMSafeModeManager (SCMSafeModeManager.java:exitSafeMode(248)) - SCM exiting safe mode.
2021-10-05 13:24:18,781 [EventQueue-OpenPipelineForHealthyPipelineSafeModeRule] WARN  events.EventQueue (EventQueue.java:fireEvent(194)) - No event handler registered for event TypedEvent{payloadType=SafeModeStatus, name='Safe mode status'}
2021-10-05 13:24:18,781 [EventQueue-OpenPipelineForHealthyPipelineSafeModeRule] INFO  ha.SCMContext (SCMContext.java:updateSafeModeStatus(205)) - Update SafeModeStatus from SafeModeStatus{safeModeStatus=true, preCheckPassed=true} to SafeModeStatus{safeModeStatus=false, preCheckPassed=true}.
2021-10-05 13:24:19,768 [Datanode State Machine Thread - 0] ERROR datanode.RunningDatanodeState (RunningDatanodeState.java:computeNextContainerState(199)) - Error in executing end point task.
java.util.concurrent.ExecutionException: java.util.concurrent.TimeoutException
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.hadoop.ozone.container.common.states.datanode.RunningDatanodeState.computeNextContainerState(RunningDatanodeState.java:191)
	at org.apache.hadoop.ozone.container.common.states.datanode.RunningDatanodeState.await(RunningDatanodeState.java:231)
	at org.apache.hadoop.ozone.container.common.states.datanode.RunningDatanodeState.await(RunningDatanodeState.java:50)
	at org.apache.hadoop.ozone.container.common.statemachine.StateContext.execute(StateContext.java:629)
	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.start(DatanodeStateMachine.java:270)
	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.lambda$startDaemon$0(DatanodeStateMachine.java:457)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.util.concurrent.TimeoutException
	at java.util.concurrent.FutureTask.get(FutureTask.java:205)
	at org.apache.hadoop.ozone.container.common.states.datanode.RunningDatanodeState.lambda$execute$0(RunningDatanodeState.java:149)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
2021-10-05 13:24:19,770 [EndpointStateMachine task thread for /127.0.0.1:15031 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15031. Already tried 0 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:24:19,772 [EndpointStateMachine task thread for /127.0.0.1:15021 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15021. Already tried 0 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:24:20,705 [Datanode State Machine Thread - 0] ERROR datanode.RunningDatanodeState (RunningDatanodeState.java:computeNextContainerState(199)) - Error in executing end point task.
java.util.concurrent.ExecutionException: java.util.concurrent.TimeoutException
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.hadoop.ozone.container.common.states.datanode.RunningDatanodeState.computeNextContainerState(RunningDatanodeState.java:191)
	at org.apache.hadoop.ozone.container.common.states.datanode.RunningDatanodeState.await(RunningDatanodeState.java:231)
	at org.apache.hadoop.ozone.container.common.states.datanode.RunningDatanodeState.await(RunningDatanodeState.java:50)
	at org.apache.hadoop.ozone.container.common.statemachine.StateContext.execute(StateContext.java:629)
	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.start(DatanodeStateMachine.java:270)
	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.lambda$startDaemon$0(DatanodeStateMachine.java:457)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.util.concurrent.TimeoutException
	at java.util.concurrent.FutureTask.get(FutureTask.java:205)
	at org.apache.hadoop.ozone.container.common.states.datanode.RunningDatanodeState.lambda$execute$0(RunningDatanodeState.java:149)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
2021-10-05 13:24:20,771 [EndpointStateMachine task thread for /127.0.0.1:15031 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15031. Already tried 1 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:24:20,774 [EndpointStateMachine task thread for /127.0.0.1:15021 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15021. Already tried 1 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:24:20,808 [grpc-default-executor-4] WARN  server.GrpcLogAppender (LogUtils.java:warn(122)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D->86d8d056-6822-410c-8a18-8ea32f12a493-AppendLogResponseHandler: Failed appendEntries: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
2021-10-05 13:24:20,810 [grpc-default-executor-4] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(46)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D->86d8d056-6822-410c-8a18-8ea32f12a493: nextIndex: updateUnconditionally 207 -> 206
2021-10-05 13:24:20,885 [SCM Heartbeat Processing Thread - 0] WARN  node.NodeStateManager (NodeStateManager.java:scheduleNextHealthCheck(799)) - Current Thread is interrupted, shutting down HB processing thread for Node Manager.
2021-10-05 13:24:20,886 [Listener at 127.0.0.1/10356] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1431)) - Stopping block service RPC server
2021-10-05 13:24:20,887 [Listener at 127.0.0.1/10356] INFO  server.SCMBlockProtocolServer (SCMBlockProtocolServer.java:stop(160)) - Stopping the RPC server for Block Protocol
2021-10-05 13:24:20,887 [Listener at 127.0.0.1/10356] INFO  ipc.Server (Server.java:stop(3414)) - Stopping server on 15022
2021-10-05 13:24:20,895 [IPC Server listener on 15022] INFO  ipc.Server (Server.java:run(1376)) - Stopping IPC Server listener on 15022
2021-10-05 13:24:20,896 [IPC Server Responder] INFO  ipc.Server (Server.java:run(1512)) - Stopping IPC Server Responder
2021-10-05 13:24:20,895 [Listener at 127.0.0.1/10356] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1438)) - Stopping the StorageContainerLocationProtocol RPC server
2021-10-05 13:24:20,897 [Listener at 127.0.0.1/10356] INFO  server.SCMClientProtocolServer (SCMClientProtocolServer.java:stop(173)) - Stopping the RPC server for Client Protocol
2021-10-05 13:24:20,897 [Listener at 127.0.0.1/10356] INFO  ipc.Server (Server.java:stop(3414)) - Stopping server on 15023
2021-10-05 13:24:20,907 [IPC Server listener on 15023] INFO  ipc.Server (Server.java:run(1376)) - Stopping IPC Server listener on 15023
2021-10-05 13:24:20,907 [IPC Server Responder] INFO  ipc.Server (Server.java:run(1512)) - Stopping IPC Server Responder
2021-10-05 13:24:20,910 [Listener at 127.0.0.1/10356] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1445)) - Stopping Storage Container Manager HTTP server.
2021-10-05 13:24:20,911 [Listener at 127.0.0.1/10356] INFO  handler.ContextHandler (ContextHandler.java:doStop(1153)) - Stopped o.e.j.w.WebAppContext@6d7772d3{scm,/,null,STOPPED}{file:/home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-classes/webapps/scm}
2021-10-05 13:24:20,919 [Listener at 127.0.0.1/10356] INFO  server.AbstractConnector (AbstractConnector.java:doStop(381)) - Stopped ServerConnector@5c43cb12{HTTP/1.1, (http/1.1)}{0.0.0.0:15018}
2021-10-05 13:24:20,920 [Listener at 127.0.0.1/10356] INFO  server.session (HouseKeeper.java:stopScavenging(149)) - node0 Stopped scavenging
2021-10-05 13:24:20,920 [Listener at 127.0.0.1/10356] INFO  handler.ContextHandler (ContextHandler.java:doStop(1153)) - Stopped o.e.j.s.ServletContextHandler@69356aca{static,/static,file:///home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-classes/webapps/static,STOPPED}
2021-10-05 13:24:20,920 [Listener at 127.0.0.1/10356] INFO  handler.ContextHandler (ContextHandler.java:doStop(1153)) - Stopped o.e.j.s.ServletContextHandler@68f1b89{logs,/logs,file:///home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/log,STOPPED}
2021-10-05 13:24:20,922 [Listener at 127.0.0.1/10356] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1456)) - Stopping Block Manager Service.
2021-10-05 13:24:20,922 [Listener at 127.0.0.1/10356] INFO  utils.BackgroundService (BackgroundService.java:shutdown(132)) - Shutting down service SCMBlockDeletingService
2021-10-05 13:24:20,922 [Listener at 127.0.0.1/10356] INFO  utils.BackgroundService (BackgroundService.java:shutdown(132)) - Shutting down service SCMBlockDeletingService
2021-10-05 13:24:20,922 [Listener at 127.0.0.1/10356] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1483)) - Stopping SCM Event Queue.
2021-10-05 13:24:20,923 [Listener at 127.0.0.1/10356] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1494)) - Stopping SCM HA services.
2021-10-05 13:24:20,923 [Listener at 127.0.0.1/10356] INFO  ha.SCMRatisServerImpl (SCMRatisServerImpl.java:stop(236)) - stopping ratis server 0.0.0.0:15020
2021-10-05 13:24:20,923 [Listener at 127.0.0.1/10356] INFO  server.RaftServer (RaftServerProxy.java:lambda$close$6(391)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0: close
2021-10-05 13:24:20,923 [Listener at 127.0.0.1/10356] INFO  server.RaftServer$Division (RaftServerImpl.java:lambda$close$4(407)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D: shutdown
2021-10-05 13:24:20,924 [Listener at 127.0.0.1/10356] INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-C748F4B4520D,id=a4bffdee-6562-4179-bbcd-2dfbb5550fc0
2021-10-05 13:24:20,924 [Listener at 127.0.0.1/10356] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(91)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0: shutdown a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-LeaderStateImpl
2021-10-05 13:24:20,924 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D->86d8d056-6822-410c-8a18-8ea32f12a493-GrpcLogAppender-LogAppenderDaemon] WARN  server.GrpcLogAppender (GrpcLogAppender.java:mayWait(175)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D->86d8d056-6822-410c-8a18-8ea32f12a493-GrpcLogAppender: Wait interrupted by java.lang.InterruptedException
2021-10-05 13:24:20,924 [Listener at 127.0.0.1/10356] INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(282)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-PendingRequests: sendNotLeaderResponses
2021-10-05 13:24:20,925 [Listener at 127.0.0.1/10356] INFO  ha.SCMStateMachine (SCMStateMachine.java:notifyNotLeader(183)) - current leader SCM steps down.
2021-10-05 13:24:20,925 [Listener at 127.0.0.1/10356] INFO  ha.SCMContext (SCMContext.java:updateLeaderAndTerm(88)) - update <isLeader,term> from <true,2> to <false,0>
2021-10-05 13:24:20,925 [Listener at 127.0.0.1/10356] INFO  ha.SCMContext (SCMContext.java:updateLeaderAndTerm(95)) - update <isLeaderReady> from <false> to <false>
2021-10-05 13:24:20,924 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D->34671d38-b53b-4109-b2ef-192b14535a6e-GrpcLogAppender-LogAppenderDaemon] WARN  server.GrpcLogAppender (GrpcLogAppender.java:mayWait(175)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D->34671d38-b53b-4109-b2ef-192b14535a6e-GrpcLogAppender: Wait interrupted by java.lang.InterruptedException
2021-10-05 13:24:20,926 [grpc-default-executor-4] INFO  server.GrpcServerProtocolService (GrpcServerProtocolService.java:onCompleted(140)) - 34671d38-b53b-4109-b2ef-192b14535a6e: Completed APPEND_ENTRIES, lastRequest: a4bffdee-6562-4179-bbcd-2dfbb5550fc0->34671d38-b53b-4109-b2ef-192b14535a6e#29-t2,previous=(t:2, i:205),leaderCommit=205,initializing? true,entries: size=1, first=(t:2, i:206), METADATAENTRY(c:205)
2021-10-05 13:24:20,927 [grpc-default-executor-3] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onCompleted(344)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D->34671d38-b53b-4109-b2ef-192b14535a6e-AppendLogResponseHandler: follower responses appendEntries COMPLETED
2021-10-05 13:24:20,927 [grpc-default-executor-3] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(46)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D->34671d38-b53b-4109-b2ef-192b14535a6e: nextIndex: updateUnconditionally 207 -> 206
2021-10-05 13:24:20,928 [Listener at 127.0.0.1/10356] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(149)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater: set stopIndex = 206
2021-10-05 13:24:20,929 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  ha.SCMStateMachine (SCMStateMachine.java:takeSnapshot(290)) - Current Snapshot Index 206, takeSnapshot took 0 ms
2021-10-05 13:24:20,929 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:takeSnapshot(281)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater: Took a snapshot at index 206
2021-10-05 13:24:20,929 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:lambda$new$0(89)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-StateMachineUpdater: snapshotIndex: updateIncreasingly 205 -> 206
2021-10-05 13:24:20,929 [Listener at 127.0.0.1/10356] INFO  server.RaftServer$Division (ServerState.java:close(419)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D: closes. applyIndex: 206
2021-10-05 13:24:20,929 [a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:run(327)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-SegmentedRaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2021-10-05 13:24:20,930 [Listener at 127.0.0.1/10356] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:close(237)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0@group-C748F4B4520D-SegmentedRaftLogWorker close()
2021-10-05 13:24:20,931 [Listener at 127.0.0.1/10356] INFO  server.GrpcService (GrpcService.java:closeImpl(262)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0: shutdown server with port 15020 now
2021-10-05 13:24:20,938 [Listener at 127.0.0.1/10356] INFO  server.GrpcService (GrpcService.java:closeImpl(271)) - a4bffdee-6562-4179-bbcd-2dfbb5550fc0: shutdown server with port 15020 successfully
2021-10-05 13:24:20,938 [org.apache.ratis.util.JvmPauseMonitor$$Lambda$499/1586779822@48751d8a] INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(109)) - JvmPauseMonitor-a4bffdee-6562-4179-bbcd-2dfbb5550fc0: Stopped
2021-10-05 13:24:20,939 [Listener at 127.0.0.1/10356] INFO  pipeline.BackgroundPipelineCreator (BackgroundPipelineCreatorV2.java:stop(158)) - Stopping RatisPipelineUtilsThread.
2021-10-05 13:24:20,939 [Listener at 127.0.0.1/10356] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1504)) - Stopping SCM MetadataStore.
2021-10-05 13:24:20,940 [Listener at 127.0.0.1/10356] INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:stop(205)) - StorageContainerManager metrics system stopped (again)
2021-10-05 13:24:20,940 [Listener at 127.0.0.1/10356] INFO  ozone.MiniOzoneHAClusterImpl (MiniOzoneHAClusterImpl.java:stop(306)) - Stopping the StorageContainerManager 34671d38-b53b-4109-b2ef-192b14535a6e
2021-10-05 13:24:20,940 [Listener at 127.0.0.1/10356] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1395)) - Stopping Container Balancer service.
2021-10-05 13:24:20,940 [Listener at 127.0.0.1/10356] INFO  balancer.ContainerBalancer (ContainerBalancer.java:stop(742)) - Container Balancer is not running.
2021-10-05 13:24:20,941 [Listener at 127.0.0.1/10356] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1402)) - Stopping Replication Manager Service.
2021-10-05 13:24:20,941 [Listener at 127.0.0.1/10356] INFO  container.ReplicationManager (ReplicationManager.java:stop(350)) - Stopping Replication Monitor Thread.
2021-10-05 13:24:20,941 [Listener at 127.0.0.1/10356] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1409)) - Stopping the Datanode Admin Monitor.
2021-10-05 13:24:20,941 [Listener at 127.0.0.1/10356] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1416)) - Stopping Lease Manager of the command watchers
2021-10-05 13:24:20,941 [Listener at 127.0.0.1/10356] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1423)) - Stopping datanode service RPC server
2021-10-05 13:24:20,941 [Listener at 127.0.0.1/10356] INFO  server.SCMDatanodeProtocolServer (SCMDatanodeProtocolServer.java:stop(389)) - Stopping the RPC server for DataNodes
2021-10-05 13:24:20,941 [Listener at 127.0.0.1/10356] INFO  ipc.Server (Server.java:stop(3414)) - Stopping server on 15041
2021-10-05 13:24:20,942 [IPC Server listener on 15041] INFO  ipc.Server (Server.java:run(1376)) - Stopping IPC Server listener on 15041
2021-10-05 13:24:20,943 [IPC Server Responder] INFO  ipc.Server (Server.java:run(1512)) - Stopping IPC Server Responder
2021-10-05 13:24:21,000 [SCM Heartbeat Processing Thread - 0] WARN  node.NodeStateManager (NodeStateManager.java:scheduleNextHealthCheck(799)) - Current Thread is interrupted, shutting down HB processing thread for Node Manager.
2021-10-05 13:24:21,000 [Listener at 127.0.0.1/10356] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1431)) - Stopping block service RPC server
2021-10-05 13:24:21,000 [Listener at 127.0.0.1/10356] INFO  server.SCMBlockProtocolServer (SCMBlockProtocolServer.java:stop(160)) - Stopping the RPC server for Block Protocol
2021-10-05 13:24:21,000 [Listener at 127.0.0.1/10356] INFO  ipc.Server (Server.java:stop(3414)) - Stopping server on 15042
2021-10-05 13:24:21,002 [IPC Server listener on 15042] INFO  ipc.Server (Server.java:run(1376)) - Stopping IPC Server listener on 15042
2021-10-05 13:24:21,002 [Listener at 127.0.0.1/10356] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1438)) - Stopping the StorageContainerLocationProtocol RPC server
2021-10-05 13:24:21,004 [Listener at 127.0.0.1/10356] INFO  server.SCMClientProtocolServer (SCMClientProtocolServer.java:stop(173)) - Stopping the RPC server for Client Protocol
2021-10-05 13:24:21,004 [Listener at 127.0.0.1/10356] INFO  ipc.Server (Server.java:stop(3414)) - Stopping server on 15043
2021-10-05 13:24:21,004 [IPC Server Responder] INFO  ipc.Server (Server.java:run(1512)) - Stopping IPC Server Responder
2021-10-05 13:24:21,008 [Listener at 127.0.0.1/10356] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1445)) - Stopping Storage Container Manager HTTP server.
2021-10-05 13:24:21,008 [IPC Server listener on 15043] INFO  ipc.Server (Server.java:run(1376)) - Stopping IPC Server listener on 15043
2021-10-05 13:24:21,008 [IPC Server Responder] INFO  ipc.Server (Server.java:run(1512)) - Stopping IPC Server Responder
2021-10-05 13:24:21,010 [Listener at 127.0.0.1/10356] INFO  handler.ContextHandler (ContextHandler.java:doStop(1153)) - Stopped o.e.j.w.WebAppContext@3edb7be5{scm,/,null,STOPPED}{file:/home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-classes/webapps/scm}
2021-10-05 13:24:21,011 [Listener at 127.0.0.1/10356] INFO  server.AbstractConnector (AbstractConnector.java:doStop(381)) - Stopped ServerConnector@6216b817{HTTP/1.1, (http/1.1)}{0.0.0.0:15038}
2021-10-05 13:24:21,011 [Listener at 127.0.0.1/10356] INFO  server.session (HouseKeeper.java:stopScavenging(149)) - node0 Stopped scavenging
2021-10-05 13:24:21,011 [Listener at 127.0.0.1/10356] INFO  handler.ContextHandler (ContextHandler.java:doStop(1153)) - Stopped o.e.j.s.ServletContextHandler@52214284{static,/static,file:///home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-classes/webapps/static,STOPPED}
2021-10-05 13:24:21,012 [Listener at 127.0.0.1/10356] INFO  handler.ContextHandler (ContextHandler.java:doStop(1153)) - Stopped o.e.j.s.ServletContextHandler@1df2d986{logs,/logs,file:///home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/log,STOPPED}
2021-10-05 13:24:21,014 [Listener at 127.0.0.1/10356] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1456)) - Stopping Block Manager Service.
2021-10-05 13:24:21,014 [Listener at 127.0.0.1/10356] INFO  utils.BackgroundService (BackgroundService.java:shutdown(132)) - Shutting down service SCMBlockDeletingService
2021-10-05 13:24:21,014 [Listener at 127.0.0.1/10356] INFO  utils.BackgroundService (BackgroundService.java:shutdown(132)) - Shutting down service SCMBlockDeletingService
2021-10-05 13:24:21,014 [Listener at 127.0.0.1/10356] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1483)) - Stopping SCM Event Queue.
2021-10-05 13:24:21,015 [Listener at 127.0.0.1/10356] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1494)) - Stopping SCM HA services.
2021-10-05 13:24:21,016 [Listener at 127.0.0.1/10356] INFO  ha.SCMRatisServerImpl (SCMRatisServerImpl.java:stop(236)) - stopping ratis server 0.0.0.0:15040
2021-10-05 13:24:21,016 [Listener at 127.0.0.1/10356] INFO  server.RaftServer (RaftServerProxy.java:lambda$close$6(391)) - 34671d38-b53b-4109-b2ef-192b14535a6e: close
2021-10-05 13:24:21,016 [Listener at 127.0.0.1/10356] INFO  server.RaftServer$Division (RaftServerImpl.java:lambda$close$4(407)) - 34671d38-b53b-4109-b2ef-192b14535a6e@group-C748F4B4520D: shutdown
2021-10-05 13:24:21,016 [Listener at 127.0.0.1/10356] INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-C748F4B4520D,id=34671d38-b53b-4109-b2ef-192b14535a6e
2021-10-05 13:24:21,016 [Listener at 127.0.0.1/10356] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(108)) - 34671d38-b53b-4109-b2ef-192b14535a6e: shutdown 34671d38-b53b-4109-b2ef-192b14535a6e@group-C748F4B4520D-FollowerState
2021-10-05 13:24:21,016 [34671d38-b53b-4109-b2ef-192b14535a6e@group-C748F4B4520D-FollowerState] INFO  impl.FollowerState (FollowerState.java:run(143)) - 34671d38-b53b-4109-b2ef-192b14535a6e@group-C748F4B4520D-FollowerState was interrupted: {}
java.lang.InterruptedException: sleep interrupted
	at java.lang.Thread.sleep(Native Method)
	at java.lang.Thread.sleep(Thread.java:340)
	at java.util.concurrent.TimeUnit.sleep(TimeUnit.java:386)
	at org.apache.ratis.util.TimeDuration.sleep(TimeDuration.java:324)
	at org.apache.ratis.util.TimeDuration.sleep(TimeDuration.java:309)
	at org.apache.ratis.server.impl.FollowerState.run(FollowerState.java:118)
2021-10-05 13:24:21,017 [Listener at 127.0.0.1/10356] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(149)) - 34671d38-b53b-4109-b2ef-192b14535a6e@group-C748F4B4520D-StateMachineUpdater: set stopIndex = 206
2021-10-05 13:24:21,017 [34671d38-b53b-4109-b2ef-192b14535a6e@group-C748F4B4520D-StateMachineUpdater] INFO  ha.SCMStateMachine (SCMStateMachine.java:takeSnapshot(290)) - Current Snapshot Index 206, takeSnapshot took 1 ms
2021-10-05 13:24:21,017 [34671d38-b53b-4109-b2ef-192b14535a6e@group-C748F4B4520D-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:takeSnapshot(281)) - 34671d38-b53b-4109-b2ef-192b14535a6e@group-C748F4B4520D-StateMachineUpdater: Took a snapshot at index 206
2021-10-05 13:24:21,018 [34671d38-b53b-4109-b2ef-192b14535a6e@group-C748F4B4520D-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:lambda$new$0(89)) - 34671d38-b53b-4109-b2ef-192b14535a6e@group-C748F4B4520D-StateMachineUpdater: snapshotIndex: updateIncreasingly 202 -> 206
2021-10-05 13:24:21,018 [34671d38-b53b-4109-b2ef-192b14535a6e@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:purge(306)) - 34671d38-b53b-4109-b2ef-192b14535a6e@group-C748F4B4520D-SegmentedRaftLog: purge 206
2021-10-05 13:24:21,018 [34671d38-b53b-4109-b2ef-192b14535a6e@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - 34671d38-b53b-4109-b2ef-192b14535a6e@group-C748F4B4520D-SegmentedRaftLog: snapshotIndex: updateIncreasingly 202 -> 206
2021-10-05 13:24:21,018 [34671d38-b53b-4109-b2ef-192b14535a6e@group-C748F4B4520D-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - 34671d38-b53b-4109-b2ef-192b14535a6e@group-C748F4B4520D-SegmentedRaftLog: purgeIndex: updateToMax old=-1, new=206, updated? true
2021-10-05 13:24:21,018 [Listener at 127.0.0.1/10356] INFO  server.RaftServer$Division (ServerState.java:close(419)) - 34671d38-b53b-4109-b2ef-192b14535a6e@group-C748F4B4520D: closes. applyIndex: 206
2021-10-05 13:24:21,018 [34671d38-b53b-4109-b2ef-192b14535a6e@group-C748F4B4520D-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:run(327)) - 34671d38-b53b-4109-b2ef-192b14535a6e@group-C748F4B4520D-SegmentedRaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2021-10-05 13:24:21,019 [Listener at 127.0.0.1/10356] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:close(237)) - 34671d38-b53b-4109-b2ef-192b14535a6e@group-C748F4B4520D-SegmentedRaftLogWorker close()
2021-10-05 13:24:21,020 [Listener at 127.0.0.1/10356] INFO  server.GrpcService (GrpcService.java:closeImpl(262)) - 34671d38-b53b-4109-b2ef-192b14535a6e: shutdown server with port 15040 now
2021-10-05 13:24:21,021 [Listener at 127.0.0.1/10356] INFO  server.GrpcService (GrpcService.java:closeImpl(271)) - 34671d38-b53b-4109-b2ef-192b14535a6e: shutdown server with port 15040 successfully
2021-10-05 13:24:21,021 [org.apache.ratis.util.JvmPauseMonitor$$Lambda$499/1586779822@e774bb3] INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(109)) - JvmPauseMonitor-34671d38-b53b-4109-b2ef-192b14535a6e: Stopped
2021-10-05 13:24:21,021 [Listener at 127.0.0.1/10356] INFO  pipeline.BackgroundPipelineCreator (BackgroundPipelineCreatorV2.java:stop(158)) - Stopping RatisPipelineUtilsThread.
2021-10-05 13:24:21,022 [Listener at 127.0.0.1/10356] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1504)) - Stopping SCM MetadataStore.
2021-10-05 13:24:21,022 [Listener at 127.0.0.1/10356] INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:stop(205)) - StorageContainerManager metrics system stopped (again)
2021-10-05 13:24:21,022 [Listener at 127.0.0.1/10356] INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:stop(468)) - Stopping the Mini Ozone Cluster
2021-10-05 13:24:21,023 [Listener at 127.0.0.1/10356] INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:stopDatanodes(527)) - Stopping the HddsDatanodes
2021-10-05 13:24:21,709 [EndpointStateMachine task thread for /127.0.0.1:15041 - 0 ] WARN  statemachine.EndpointStateMachine (EndpointStateMachine.java:logIfNeeded(236)) - Unable to communicate to SCM server at localhost:15041 for past 0 seconds.
java.io.EOFException: End of File Exception between local host is: "fv-az270-324/10.1.0.10"; destination host is: "localhost":15041; : java.io.EOFException; For more details see:  http://wiki.apache.org/hadoop/EOFException
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.hadoop.net.NetUtils.wrapWithMessage(NetUtils.java:913)
	at org.apache.hadoop.net.NetUtils.wrapException(NetUtils.java:862)
	at org.apache.hadoop.ipc.Client.getRpcResponse(Client.java:1577)
	at org.apache.hadoop.ipc.Client.call(Client.java:1519)
	at org.apache.hadoop.ipc.Client.call(Client.java:1416)
	at org.apache.hadoop.ipc.ProtobufRpcEngine$Invoker.invoke(ProtobufRpcEngine.java:236)
	at org.apache.hadoop.ipc.ProtobufRpcEngine$Invoker.invoke(ProtobufRpcEngine.java:123)
	at com.sun.proxy.$Proxy48.submitRequest(Unknown Source)
	at org.apache.hadoop.ozone.protocolPB.StorageContainerDatanodeProtocolClientSideTranslatorPB.submitRequest(StorageContainerDatanodeProtocolClientSideTranslatorPB.java:117)
	at org.apache.hadoop.ozone.protocolPB.StorageContainerDatanodeProtocolClientSideTranslatorPB.sendHeartbeat(StorageContainerDatanodeProtocolClientSideTranslatorPB.java:149)
	at org.apache.hadoop.ozone.container.common.states.endpoint.HeartbeatEndpointTask.call(HeartbeatEndpointTask.java:179)
	at org.apache.hadoop.ozone.container.common.states.endpoint.HeartbeatEndpointTask.call(HeartbeatEndpointTask.java:82)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.io.EOFException
	at java.io.DataInputStream.readInt(DataInputStream.java:392)
	at org.apache.hadoop.ipc.Client$IpcStreams.readResponse(Client.java:1892)
	at org.apache.hadoop.ipc.Client$Connection.receiveRpcResponse(Client.java:1202)
	at org.apache.hadoop.ipc.Client$Connection.run(Client.java:1098)
2021-10-05 13:24:21,771 [Datanode State Machine Thread - 0] WARN  statemachine.StateContext (StateContext.java:setState(246)) - Ignore disallowed transition from SHUTDOWN to RUNNING
2021-10-05 13:24:21,772 [EndpointStateMachine task thread for /127.0.0.1:15031 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15031. Already tried 2 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:24:21,775 [EndpointStateMachine task thread for /127.0.0.1:15021 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15021. Already tried 2 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:24:21,779 [Datanode State Machine Thread - 0] WARN  statemachine.StateContext (StateContext.java:setState(246)) - Ignore disallowed transition from SHUTDOWN to RUNNING
2021-10-05 13:24:22,708 [Datanode State Machine Thread - 0] ERROR datanode.RunningDatanodeState (RunningDatanodeState.java:computeNextContainerState(199)) - Error in executing end point task.
java.util.concurrent.ExecutionException: java.util.concurrent.TimeoutException
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.hadoop.ozone.container.common.states.datanode.RunningDatanodeState.computeNextContainerState(RunningDatanodeState.java:191)
	at org.apache.hadoop.ozone.container.common.states.datanode.RunningDatanodeState.await(RunningDatanodeState.java:231)
	at org.apache.hadoop.ozone.container.common.states.datanode.RunningDatanodeState.await(RunningDatanodeState.java:50)
	at org.apache.hadoop.ozone.container.common.statemachine.StateContext.execute(StateContext.java:629)
	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.start(DatanodeStateMachine.java:270)
	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.lambda$startDaemon$0(DatanodeStateMachine.java:457)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.util.concurrent.TimeoutException
	at java.util.concurrent.FutureTask.get(FutureTask.java:205)
	at org.apache.hadoop.ozone.container.common.states.datanode.RunningDatanodeState.lambda$execute$0(RunningDatanodeState.java:149)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
2021-10-05 13:24:22,772 [EndpointStateMachine task thread for /127.0.0.1:15031 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15031. Already tried 3 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:24:22,775 [EndpointStateMachine task thread for /127.0.0.1:15021 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15021. Already tried 3 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:24:23,711 [EndpointStateMachine task thread for /127.0.0.1:15041 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15041. Already tried 0 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:24:23,773 [EndpointStateMachine task thread for /127.0.0.1:15031 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15031. Already tried 4 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:24:23,776 [EndpointStateMachine task thread for /127.0.0.1:15021 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15021. Already tried 4 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:24:24,711 [Datanode State Machine Thread - 0] ERROR datanode.RunningDatanodeState (RunningDatanodeState.java:computeNextContainerState(199)) - Error in executing end point task.
java.util.concurrent.ExecutionException: java.util.concurrent.TimeoutException
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.hadoop.ozone.container.common.states.datanode.RunningDatanodeState.computeNextContainerState(RunningDatanodeState.java:191)
	at org.apache.hadoop.ozone.container.common.states.datanode.RunningDatanodeState.await(RunningDatanodeState.java:231)
	at org.apache.hadoop.ozone.container.common.states.datanode.RunningDatanodeState.await(RunningDatanodeState.java:50)
	at org.apache.hadoop.ozone.container.common.statemachine.StateContext.execute(StateContext.java:629)
	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.start(DatanodeStateMachine.java:270)
	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.lambda$startDaemon$0(DatanodeStateMachine.java:457)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.util.concurrent.TimeoutException
	at java.util.concurrent.FutureTask.get(FutureTask.java:205)
	at org.apache.hadoop.ozone.container.common.states.datanode.RunningDatanodeState.lambda$execute$0(RunningDatanodeState.java:149)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
2021-10-05 13:24:24,712 [EndpointStateMachine task thread for /127.0.0.1:15041 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15041. Already tried 1 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:24:24,774 [EndpointStateMachine task thread for /127.0.0.1:15031 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15031. Already tried 5 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:24:24,777 [EndpointStateMachine task thread for /127.0.0.1:15021 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15021. Already tried 5 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:24:25,713 [EndpointStateMachine task thread for /127.0.0.1:15041 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15041. Already tried 2 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:24:25,775 [EndpointStateMachine task thread for /127.0.0.1:15031 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15031. Already tried 6 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:24:25,777 [EndpointStateMachine task thread for /127.0.0.1:15021 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15021. Already tried 6 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:24:26,025 [Listener at 127.0.0.1/10356] INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(325)) - Attempting to stop container services.
2021-10-05 13:24:26,027 [Listener at 127.0.0.1/10356] INFO  server.RaftServer (RaftServerProxy.java:lambda$close$6(391)) - 0c34be74-1f5b-4b04-a6d4-fde6c3deb89a: close
2021-10-05 13:24:26,028 [Listener at 127.0.0.1/10356] INFO  server.RaftServer$Division (RaftServerImpl.java:lambda$close$4(407)) - 0c34be74-1f5b-4b04-a6d4-fde6c3deb89a@group-52E96576A6DB: shutdown
2021-10-05 13:24:26,028 [Listener at 127.0.0.1/10356] INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-52E96576A6DB,id=0c34be74-1f5b-4b04-a6d4-fde6c3deb89a
2021-10-05 13:24:26,028 [Listener at 127.0.0.1/10356] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(108)) - 0c34be74-1f5b-4b04-a6d4-fde6c3deb89a: shutdown 0c34be74-1f5b-4b04-a6d4-fde6c3deb89a@group-52E96576A6DB-FollowerState
2021-10-05 13:24:26,029 [0c34be74-1f5b-4b04-a6d4-fde6c3deb89a@group-52E96576A6DB-FollowerState] INFO  impl.FollowerState (FollowerState.java:run(143)) - 0c34be74-1f5b-4b04-a6d4-fde6c3deb89a@group-52E96576A6DB-FollowerState was interrupted: {}
java.lang.InterruptedException: sleep interrupted
	at java.lang.Thread.sleep(Native Method)
	at java.lang.Thread.sleep(Thread.java:340)
	at java.util.concurrent.TimeUnit.sleep(TimeUnit.java:386)
	at org.apache.ratis.util.TimeDuration.sleep(TimeDuration.java:324)
	at org.apache.ratis.util.TimeDuration.sleep(TimeDuration.java:309)
	at org.apache.ratis.server.impl.FollowerState.run(FollowerState.java:118)
2021-10-05 13:24:26,029 [0c34be74-1f5b-4b04-a6d4-fde6c3deb89a@group-52E96576A6DB-StateMachineUpdater] INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(292)) - group-52E96576A6DB: Taking a snapshot at:(t:3, i:0) file /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-98f4f1fb-613f-4a4a-83a3-c748f4b4520d/datanode-1/data/ratis/8c8a590d-1d11-430c-931a-52e96576a6db/sm/snapshot.3_0
2021-10-05 13:24:26,027 [ForkJoinPool.commonPool-worker-0] INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(325)) - Attempting to stop container services.
2021-10-05 13:24:26,030 [Listener at 127.0.0.1/10356] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(149)) - 0c34be74-1f5b-4b04-a6d4-fde6c3deb89a@group-52E96576A6DB-StateMachineUpdater: set stopIndex = 0
2021-10-05 13:24:26,031 [ForkJoinPool.commonPool-worker-0] INFO  server.RaftServer (RaftServerProxy.java:lambda$close$6(391)) - f990c0ed-f7f2-4f8a-8ec9-db097d9c855e: close
2021-10-05 13:24:26,032 [ForkJoinPool.commonPool-worker-0] INFO  server.RaftServer$Division (RaftServerImpl.java:lambda$close$4(407)) - f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-52E96576A6DB: shutdown
2021-10-05 13:24:26,032 [ForkJoinPool.commonPool-worker-0] INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-52E96576A6DB,id=f990c0ed-f7f2-4f8a-8ec9-db097d9c855e
2021-10-05 13:24:26,032 [ForkJoinPool.commonPool-worker-0] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(108)) - f990c0ed-f7f2-4f8a-8ec9-db097d9c855e: shutdown f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-52E96576A6DB-FollowerState
2021-10-05 13:24:26,032 [ForkJoinPool.commonPool-worker-0] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(149)) - f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-52E96576A6DB-StateMachineUpdater: set stopIndex = 0
2021-10-05 13:24:26,032 [f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-52E96576A6DB-FollowerState] INFO  impl.FollowerState (FollowerState.java:run(143)) - f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-52E96576A6DB-FollowerState was interrupted: {}
java.lang.InterruptedException: sleep interrupted
	at java.lang.Thread.sleep(Native Method)
	at java.lang.Thread.sleep(Thread.java:340)
	at java.util.concurrent.TimeUnit.sleep(TimeUnit.java:386)
	at org.apache.ratis.util.TimeDuration.sleep(TimeDuration.java:324)
	at org.apache.ratis.util.TimeDuration.sleep(TimeDuration.java:309)
	at org.apache.ratis.server.impl.FollowerState.run(FollowerState.java:118)
2021-10-05 13:24:26,033 [f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-52E96576A6DB-StateMachineUpdater] INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(292)) - group-52E96576A6DB: Taking a snapshot at:(t:3, i:0) file /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-98f4f1fb-613f-4a4a-83a3-c748f4b4520d/datanode-0/data/ratis/8c8a590d-1d11-430c-931a-52e96576a6db/sm/snapshot.3_0
2021-10-05 13:24:26,068 [0c34be74-1f5b-4b04-a6d4-fde6c3deb89a@group-52E96576A6DB-StateMachineUpdater] INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(303)) - group-52E96576A6DB: Finished taking a snapshot at:(t:3, i:0) file:/home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-98f4f1fb-613f-4a4a-83a3-c748f4b4520d/datanode-1/data/ratis/8c8a590d-1d11-430c-931a-52e96576a6db/sm/snapshot.3_0 took: 39 ms
2021-10-05 13:24:26,070 [0c34be74-1f5b-4b04-a6d4-fde6c3deb89a@group-52E96576A6DB-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:takeSnapshot(281)) - 0c34be74-1f5b-4b04-a6d4-fde6c3deb89a@group-52E96576A6DB-StateMachineUpdater: Took a snapshot at index 0
2021-10-05 13:24:26,070 [0c34be74-1f5b-4b04-a6d4-fde6c3deb89a@group-52E96576A6DB-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:lambda$new$0(89)) - 0c34be74-1f5b-4b04-a6d4-fde6c3deb89a@group-52E96576A6DB-StateMachineUpdater: snapshotIndex: updateIncreasingly -1 -> 0
2021-10-05 13:24:26,070 [f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-52E96576A6DB-StateMachineUpdater] INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(303)) - group-52E96576A6DB: Finished taking a snapshot at:(t:3, i:0) file:/home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-98f4f1fb-613f-4a4a-83a3-c748f4b4520d/datanode-0/data/ratis/8c8a590d-1d11-430c-931a-52e96576a6db/sm/snapshot.3_0 took: 37 ms
2021-10-05 13:24:26,071 [f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-52E96576A6DB-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:takeSnapshot(281)) - f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-52E96576A6DB-StateMachineUpdater: Took a snapshot at index 0
2021-10-05 13:24:26,071 [f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-52E96576A6DB-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:lambda$new$0(89)) - f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-52E96576A6DB-StateMachineUpdater: snapshotIndex: updateIncreasingly -1 -> 0
2021-10-05 13:24:26,073 [ForkJoinPool.commonPool-worker-0] INFO  server.RaftServer$Division (ServerState.java:close(419)) - f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-52E96576A6DB: closes. applyIndex: 0
2021-10-05 13:24:26,073 [Listener at 127.0.0.1/10356] INFO  server.RaftServer$Division (ServerState.java:close(419)) - 0c34be74-1f5b-4b04-a6d4-fde6c3deb89a@group-52E96576A6DB: closes. applyIndex: 0
2021-10-05 13:24:26,073 [f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-52E96576A6DB-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:run(327)) - f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-52E96576A6DB-SegmentedRaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2021-10-05 13:24:26,074 [0c34be74-1f5b-4b04-a6d4-fde6c3deb89a@group-52E96576A6DB-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:run(327)) - 0c34be74-1f5b-4b04-a6d4-fde6c3deb89a@group-52E96576A6DB-SegmentedRaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2021-10-05 13:24:26,074 [Listener at 127.0.0.1/10356] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:close(237)) - 0c34be74-1f5b-4b04-a6d4-fde6c3deb89a@group-52E96576A6DB-SegmentedRaftLogWorker close()
2021-10-05 13:24:26,075 [ForkJoinPool.commonPool-worker-0] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:close(237)) - f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-52E96576A6DB-SegmentedRaftLogWorker close()
2021-10-05 13:24:26,076 [ForkJoinPool.commonPool-worker-0] INFO  server.RaftServer$Division (RaftServerImpl.java:lambda$close$4(407)) - f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-1CD77BA4A78C: shutdown
2021-10-05 13:24:26,076 [ForkJoinPool.commonPool-worker-0] INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-1CD77BA4A78C,id=f990c0ed-f7f2-4f8a-8ec9-db097d9c855e
2021-10-05 13:24:26,076 [ForkJoinPool.commonPool-worker-0] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(91)) - f990c0ed-f7f2-4f8a-8ec9-db097d9c855e: shutdown f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-1CD77BA4A78C-LeaderStateImpl
2021-10-05 13:24:26,077 [Listener at 127.0.0.1/10356] INFO  server.RaftServer$Division (RaftServerImpl.java:lambda$close$4(407)) - 0c34be74-1f5b-4b04-a6d4-fde6c3deb89a@group-27B6D48B871B: shutdown
2021-10-05 13:24:26,077 [Listener at 127.0.0.1/10356] INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-27B6D48B871B,id=0c34be74-1f5b-4b04-a6d4-fde6c3deb89a
2021-10-05 13:24:26,077 [Listener at 127.0.0.1/10356] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(91)) - 0c34be74-1f5b-4b04-a6d4-fde6c3deb89a: shutdown 0c34be74-1f5b-4b04-a6d4-fde6c3deb89a@group-27B6D48B871B-LeaderStateImpl
2021-10-05 13:24:26,077 [Listener at 127.0.0.1/10356] INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(282)) - 0c34be74-1f5b-4b04-a6d4-fde6c3deb89a@group-27B6D48B871B-PendingRequests: sendNotLeaderResponses
2021-10-05 13:24:26,077 [Listener at 127.0.0.1/10356] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(149)) - 0c34be74-1f5b-4b04-a6d4-fde6c3deb89a@group-27B6D48B871B-StateMachineUpdater: set stopIndex = 0
2021-10-05 13:24:26,078 [0c34be74-1f5b-4b04-a6d4-fde6c3deb89a@group-27B6D48B871B-StateMachineUpdater] INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(292)) - group-27B6D48B871B: Taking a snapshot at:(t:1, i:0) file /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-98f4f1fb-613f-4a4a-83a3-c748f4b4520d/datanode-1/data/ratis/a2e217e3-801c-4062-af76-27b6d48b871b/sm/snapshot.1_0
2021-10-05 13:24:26,076 [ForkJoinPool.commonPool-worker-0] INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(282)) - f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-1CD77BA4A78C-PendingRequests: sendNotLeaderResponses
2021-10-05 13:24:26,078 [ForkJoinPool.commonPool-worker-0] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(149)) - f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-1CD77BA4A78C-StateMachineUpdater: set stopIndex = 0
2021-10-05 13:24:26,079 [f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-1CD77BA4A78C-StateMachineUpdater] INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(292)) - group-1CD77BA4A78C: Taking a snapshot at:(t:1, i:0) file /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-98f4f1fb-613f-4a4a-83a3-c748f4b4520d/datanode-0/data/ratis/4bafc9c3-fe1c-42b3-af40-1cd77ba4a78c/sm/snapshot.1_0
2021-10-05 13:24:26,079 [0c34be74-1f5b-4b04-a6d4-fde6c3deb89a@group-27B6D48B871B-StateMachineUpdater] INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(303)) - group-27B6D48B871B: Finished taking a snapshot at:(t:1, i:0) file:/home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-98f4f1fb-613f-4a4a-83a3-c748f4b4520d/datanode-1/data/ratis/a2e217e3-801c-4062-af76-27b6d48b871b/sm/snapshot.1_0 took: 2 ms
2021-10-05 13:24:26,080 [0c34be74-1f5b-4b04-a6d4-fde6c3deb89a@group-27B6D48B871B-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:takeSnapshot(281)) - 0c34be74-1f5b-4b04-a6d4-fde6c3deb89a@group-27B6D48B871B-StateMachineUpdater: Took a snapshot at index 0
2021-10-05 13:24:26,080 [0c34be74-1f5b-4b04-a6d4-fde6c3deb89a@group-27B6D48B871B-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:lambda$new$0(89)) - 0c34be74-1f5b-4b04-a6d4-fde6c3deb89a@group-27B6D48B871B-StateMachineUpdater: snapshotIndex: updateIncreasingly -1 -> 0
2021-10-05 13:24:26,080 [Listener at 127.0.0.1/10356] INFO  server.RaftServer$Division (ServerState.java:close(419)) - 0c34be74-1f5b-4b04-a6d4-fde6c3deb89a@group-27B6D48B871B: closes. applyIndex: 0
2021-10-05 13:24:26,080 [0c34be74-1f5b-4b04-a6d4-fde6c3deb89a@group-27B6D48B871B-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:run(327)) - 0c34be74-1f5b-4b04-a6d4-fde6c3deb89a@group-27B6D48B871B-SegmentedRaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2021-10-05 13:24:26,081 [f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-1CD77BA4A78C-StateMachineUpdater] INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(303)) - group-1CD77BA4A78C: Finished taking a snapshot at:(t:1, i:0) file:/home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-98f4f1fb-613f-4a4a-83a3-c748f4b4520d/datanode-0/data/ratis/4bafc9c3-fe1c-42b3-af40-1cd77ba4a78c/sm/snapshot.1_0 took: 2 ms
2021-10-05 13:24:26,081 [f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-1CD77BA4A78C-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:takeSnapshot(281)) - f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-1CD77BA4A78C-StateMachineUpdater: Took a snapshot at index 0
2021-10-05 13:24:26,081 [f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-1CD77BA4A78C-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:lambda$new$0(89)) - f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-1CD77BA4A78C-StateMachineUpdater: snapshotIndex: updateIncreasingly -1 -> 0
2021-10-05 13:24:26,081 [ForkJoinPool.commonPool-worker-0] INFO  server.RaftServer$Division (ServerState.java:close(419)) - f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-1CD77BA4A78C: closes. applyIndex: 0
2021-10-05 13:24:26,081 [f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-1CD77BA4A78C-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:run(327)) - f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-1CD77BA4A78C-SegmentedRaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2021-10-05 13:24:26,082 [ForkJoinPool.commonPool-worker-0] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:close(237)) - f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-1CD77BA4A78C-SegmentedRaftLogWorker close()
2021-10-05 13:24:26,082 [ForkJoinPool.commonPool-worker-0] INFO  server.RaftServer$Division (RaftServerImpl.java:lambda$close$4(407)) - f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-D8E46993F0F1: shutdown
2021-10-05 13:24:26,082 [ForkJoinPool.commonPool-worker-0] INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-D8E46993F0F1,id=f990c0ed-f7f2-4f8a-8ec9-db097d9c855e
2021-10-05 13:24:26,083 [ForkJoinPool.commonPool-worker-0] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(91)) - f990c0ed-f7f2-4f8a-8ec9-db097d9c855e: shutdown f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-D8E46993F0F1-LeaderStateImpl
2021-10-05 13:24:26,083 [ForkJoinPool.commonPool-worker-0] INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(282)) - f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-D8E46993F0F1-PendingRequests: sendNotLeaderResponses
2021-10-05 13:24:26,083 [f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-D8E46993F0F1->a9b6c243-aad2-4cee-be19-871628539a81-GrpcLogAppender-LogAppenderDaemon] WARN  server.GrpcLogAppender (GrpcLogAppender.java:mayWait(175)) - f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-D8E46993F0F1->a9b6c243-aad2-4cee-be19-871628539a81-GrpcLogAppender: Wait interrupted by java.lang.InterruptedException
2021-10-05 13:24:26,083 [f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-D8E46993F0F1-StateMachineUpdater] INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(292)) - group-D8E46993F0F1: Taking a snapshot at:(t:2, i:0) file /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-98f4f1fb-613f-4a4a-83a3-c748f4b4520d/datanode-0/data/ratis/90899f2e-5ed2-48cb-9677-d8e46993f0f1/sm/snapshot.2_0
2021-10-05 13:24:26,084 [ForkJoinPool.commonPool-worker-0] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(149)) - f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-D8E46993F0F1-StateMachineUpdater: set stopIndex = 0
2021-10-05 13:24:26,084 [Listener at 127.0.0.1/10356] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:close(237)) - 0c34be74-1f5b-4b04-a6d4-fde6c3deb89a@group-27B6D48B871B-SegmentedRaftLogWorker close()
2021-10-05 13:24:26,084 [f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-D8E46993F0F1-StateMachineUpdater] INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(303)) - group-D8E46993F0F1: Finished taking a snapshot at:(t:2, i:0) file:/home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-98f4f1fb-613f-4a4a-83a3-c748f4b4520d/datanode-0/data/ratis/90899f2e-5ed2-48cb-9677-d8e46993f0f1/sm/snapshot.2_0 took: 1 ms
2021-10-05 13:24:26,084 [f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-D8E46993F0F1-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:takeSnapshot(281)) - f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-D8E46993F0F1-StateMachineUpdater: Took a snapshot at index 0
2021-10-05 13:24:26,084 [f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-D8E46993F0F1-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:lambda$new$0(89)) - f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-D8E46993F0F1-StateMachineUpdater: snapshotIndex: updateIncreasingly -1 -> 0
2021-10-05 13:24:26,085 [f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-D8E46993F0F1->0c34be74-1f5b-4b04-a6d4-fde6c3deb89a-GrpcLogAppender-LogAppenderDaemon] WARN  server.GrpcLogAppender (GrpcLogAppender.java:mayWait(175)) - f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-D8E46993F0F1->0c34be74-1f5b-4b04-a6d4-fde6c3deb89a-GrpcLogAppender: Wait interrupted by java.lang.InterruptedException
2021-10-05 13:24:26,085 [ForkJoinPool.commonPool-worker-0] INFO  server.RaftServer$Division (ServerState.java:close(419)) - f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-D8E46993F0F1: closes. applyIndex: 0
2021-10-05 13:24:26,085 [grpc-default-executor-4] INFO  server.GrpcServerProtocolService (GrpcServerProtocolService.java:onCompleted(140)) - a9b6c243-aad2-4cee-be19-871628539a81: Completed APPEND_ENTRIES, lastRequest: f990c0ed-f7f2-4f8a-8ec9-db097d9c855e->a9b6c243-aad2-4cee-be19-871628539a81#1-t2,previous=(t:0, i:0),leaderCommit=0,initializing? true,entries: size=1, first=(t:2, i:0), CONFIGURATIONENTRY
2021-10-05 13:24:26,085 [grpc-default-executor-3] INFO  server.GrpcServerProtocolService (GrpcServerProtocolService.java:onCompleted(140)) - 0c34be74-1f5b-4b04-a6d4-fde6c3deb89a: Completed APPEND_ENTRIES, lastRequest: f990c0ed-f7f2-4f8a-8ec9-db097d9c855e->0c34be74-1f5b-4b04-a6d4-fde6c3deb89a#1-t2,previous=(t:0, i:0),leaderCommit=-1,initializing? true,entries: size=1, first=(t:2, i:0), CONFIGURATIONENTRY
2021-10-05 13:24:26,085 [f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-D8E46993F0F1-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:run(327)) - f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-D8E46993F0F1-SegmentedRaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2021-10-05 13:24:26,087 [ForkJoinPool.commonPool-worker-0] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:close(237)) - f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-D8E46993F0F1-SegmentedRaftLogWorker close()
2021-10-05 13:24:26,087 [Listener at 127.0.0.1/10356] INFO  server.RaftServer$Division (RaftServerImpl.java:lambda$close$4(407)) - 0c34be74-1f5b-4b04-a6d4-fde6c3deb89a@group-D8E46993F0F1: shutdown
2021-10-05 13:24:26,087 [grpc-default-executor-3] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onCompleted(344)) - f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-D8E46993F0F1->a9b6c243-aad2-4cee-be19-871628539a81-AppendLogResponseHandler: follower responses appendEntries COMPLETED
2021-10-05 13:24:26,089 [grpc-default-executor-3] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(46)) - f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-D8E46993F0F1->a9b6c243-aad2-4cee-be19-871628539a81: nextIndex: updateUnconditionally 1 -> 0
2021-10-05 13:24:26,089 [ForkJoinPool.commonPool-worker-0] INFO  server.GrpcService (GrpcService.java:closeImpl(262)) - f990c0ed-f7f2-4f8a-8ec9-db097d9c855e: shutdown server with port 44595 now
2021-10-05 13:24:26,089 [grpc-default-executor-3] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onCompleted(344)) - f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-D8E46993F0F1->0c34be74-1f5b-4b04-a6d4-fde6c3deb89a-AppendLogResponseHandler: follower responses appendEntries COMPLETED
2021-10-05 13:24:26,089 [grpc-default-executor-3] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(46)) - f990c0ed-f7f2-4f8a-8ec9-db097d9c855e@group-D8E46993F0F1->0c34be74-1f5b-4b04-a6d4-fde6c3deb89a: nextIndex: updateUnconditionally 1 -> 0
2021-10-05 13:24:26,095 [Listener at 127.0.0.1/10356] INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-D8E46993F0F1,id=0c34be74-1f5b-4b04-a6d4-fde6c3deb89a
2021-10-05 13:24:26,096 [Listener at 127.0.0.1/10356] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(108)) - 0c34be74-1f5b-4b04-a6d4-fde6c3deb89a: shutdown 0c34be74-1f5b-4b04-a6d4-fde6c3deb89a@group-D8E46993F0F1-FollowerState
2021-10-05 13:24:26,096 [0c34be74-1f5b-4b04-a6d4-fde6c3deb89a@group-D8E46993F0F1-FollowerState] INFO  impl.FollowerState (FollowerState.java:run(143)) - 0c34be74-1f5b-4b04-a6d4-fde6c3deb89a@group-D8E46993F0F1-FollowerState was interrupted: {}
java.lang.InterruptedException: sleep interrupted
	at java.lang.Thread.sleep(Native Method)
	at java.lang.Thread.sleep(Thread.java:340)
	at java.util.concurrent.TimeUnit.sleep(TimeUnit.java:386)
	at org.apache.ratis.util.TimeDuration.sleep(TimeDuration.java:324)
	at org.apache.ratis.util.TimeDuration.sleep(TimeDuration.java:309)
	at org.apache.ratis.server.impl.FollowerState.run(FollowerState.java:118)
2021-10-05 13:24:26,096 [0c34be74-1f5b-4b04-a6d4-fde6c3deb89a@group-D8E46993F0F1-StateMachineUpdater] INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(292)) - group-D8E46993F0F1: Taking a snapshot at:(t:2, i:0) file /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-98f4f1fb-613f-4a4a-83a3-c748f4b4520d/datanode-1/data/ratis/90899f2e-5ed2-48cb-9677-d8e46993f0f1/sm/snapshot.2_0
2021-10-05 13:24:26,097 [Listener at 127.0.0.1/10356] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(149)) - 0c34be74-1f5b-4b04-a6d4-fde6c3deb89a@group-D8E46993F0F1-StateMachineUpdater: set stopIndex = 0
2021-10-05 13:24:26,097 [grpc-default-executor-3] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(122)) - f990c0ed-f7f2-4f8a-8ec9-db097d9c855e: installSnapshot onError, lastRequest: a9b6c243-aad2-4cee-be19-871628539a81->f990c0ed-f7f2-4f8a-8ec9-db097d9c855e#1-t3,previous=(t:0, i:0),leaderCommit=-1,initializing? true,entries: size=1, first=(t:3, i:0), CONFIGURATIONENTRY: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2021-10-05 13:24:26,098 [0c34be74-1f5b-4b04-a6d4-fde6c3deb89a@group-D8E46993F0F1-StateMachineUpdater] INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(303)) - group-D8E46993F0F1: Finished taking a snapshot at:(t:2, i:0) file:/home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-98f4f1fb-613f-4a4a-83a3-c748f4b4520d/datanode-1/data/ratis/90899f2e-5ed2-48cb-9677-d8e46993f0f1/sm/snapshot.2_0 took: 2 ms
2021-10-05 13:24:26,098 [0c34be74-1f5b-4b04-a6d4-fde6c3deb89a@group-D8E46993F0F1-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:takeSnapshot(281)) - 0c34be74-1f5b-4b04-a6d4-fde6c3deb89a@group-D8E46993F0F1-StateMachineUpdater: Took a snapshot at index 0
2021-10-05 13:24:26,098 [0c34be74-1f5b-4b04-a6d4-fde6c3deb89a@group-D8E46993F0F1-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:lambda$new$0(89)) - 0c34be74-1f5b-4b04-a6d4-fde6c3deb89a@group-D8E46993F0F1-StateMachineUpdater: snapshotIndex: updateIncreasingly -1 -> 0
2021-10-05 13:24:26,100 [grpc-default-executor-3] WARN  server.GrpcLogAppender (LogUtils.java:warn(122)) - a9b6c243-aad2-4cee-be19-871628539a81@group-52E96576A6DB->f990c0ed-f7f2-4f8a-8ec9-db097d9c855e-AppendLogResponseHandler: Failed appendEntries: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: HTTP/2 error code: CANCEL
Received Rst Stream
2021-10-05 13:24:26,100 [grpc-default-executor-3] WARN  server.GrpcLogAppender (GrpcLogAppender.java:resetClient(111)) - a9b6c243-aad2-4cee-be19-871628539a81@group-52E96576A6DB->f990c0ed-f7f2-4f8a-8ec9-db097d9c855e-GrpcLogAppender: Leader has not got in touch with Follower a9b6c243-aad2-4cee-be19-871628539a81@group-52E96576A6DB->f990c0ed-f7f2-4f8a-8ec9-db097d9c855e(c0,m0,n1, attendVote=true, lastRpcSendTime=2323, lastRpcResponseTime=2322) yet, just keep nextIndex unchanged and retry.
2021-10-05 13:24:26,100 [Listener at 127.0.0.1/10356] INFO  server.RaftServer$Division (ServerState.java:close(419)) - 0c34be74-1f5b-4b04-a6d4-fde6c3deb89a@group-D8E46993F0F1: closes. applyIndex: 0
2021-10-05 13:24:26,100 [0c34be74-1f5b-4b04-a6d4-fde6c3deb89a@group-D8E46993F0F1-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:run(327)) - 0c34be74-1f5b-4b04-a6d4-fde6c3deb89a@group-D8E46993F0F1-SegmentedRaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2021-10-05 13:24:26,100 [Listener at 127.0.0.1/10356] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:close(237)) - 0c34be74-1f5b-4b04-a6d4-fde6c3deb89a@group-D8E46993F0F1-SegmentedRaftLogWorker close()
2021-10-05 13:24:26,114 [ForkJoinPool.commonPool-worker-0] INFO  server.GrpcService (GrpcService.java:closeImpl(271)) - f990c0ed-f7f2-4f8a-8ec9-db097d9c855e: shutdown server with port 44595 successfully
2021-10-05 13:24:26,114 [org.apache.ratis.util.JvmPauseMonitor$$Lambda$499/1586779822@227d0cd5] INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(109)) - JvmPauseMonitor-f990c0ed-f7f2-4f8a-8ec9-db097d9c855e: Stopped
2021-10-05 13:24:26,114 [Listener at 127.0.0.1/10356] INFO  server.GrpcService (GrpcService.java:closeImpl(262)) - 0c34be74-1f5b-4b04-a6d4-fde6c3deb89a: shutdown server with port 33359 now
2021-10-05 13:24:26,117 [grpc-default-executor-3] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(122)) - 0c34be74-1f5b-4b04-a6d4-fde6c3deb89a: installSnapshot onError, lastRequest: a9b6c243-aad2-4cee-be19-871628539a81->0c34be74-1f5b-4b04-a6d4-fde6c3deb89a#1-t3,previous=(t:0, i:0),leaderCommit=-1,initializing? true,entries: size=1, first=(t:3, i:0), CONFIGURATIONENTRY: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2021-10-05 13:24:26,119 [grpc-default-executor-3] WARN  server.GrpcLogAppender (LogUtils.java:warn(122)) - a9b6c243-aad2-4cee-be19-871628539a81@group-52E96576A6DB->0c34be74-1f5b-4b04-a6d4-fde6c3deb89a-AppendLogResponseHandler: Failed appendEntries: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: HTTP/2 error code: CANCEL
Received Rst Stream
2021-10-05 13:24:26,119 [grpc-default-executor-3] WARN  server.GrpcLogAppender (GrpcLogAppender.java:resetClient(111)) - a9b6c243-aad2-4cee-be19-871628539a81@group-52E96576A6DB->0c34be74-1f5b-4b04-a6d4-fde6c3deb89a-GrpcLogAppender: Leader has not got in touch with Follower a9b6c243-aad2-4cee-be19-871628539a81@group-52E96576A6DB->0c34be74-1f5b-4b04-a6d4-fde6c3deb89a(c0,m0,n1, attendVote=true, lastRpcSendTime=2352, lastRpcResponseTime=2349) yet, just keep nextIndex unchanged and retry.
2021-10-05 13:24:26,121 [ForkJoinPool.commonPool-worker-0] INFO  utils.BackgroundService (BackgroundService.java:shutdown(132)) - Shutting down service BlockDeletingService
2021-10-05 13:24:26,131 [Listener at 127.0.0.1/10356] INFO  server.GrpcService (GrpcService.java:closeImpl(271)) - 0c34be74-1f5b-4b04-a6d4-fde6c3deb89a: shutdown server with port 33359 successfully
2021-10-05 13:24:26,131 [org.apache.ratis.util.JvmPauseMonitor$$Lambda$499/1586779822@28f26e39] INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(109)) - JvmPauseMonitor-0c34be74-1f5b-4b04-a6d4-fde6c3deb89a: Stopped
2021-10-05 13:24:26,133 [Listener at 127.0.0.1/10356] INFO  utils.BackgroundService (BackgroundService.java:shutdown(132)) - Shutting down service BlockDeletingService
2021-10-05 13:24:26,280 [grpc-default-executor-3] WARN  server.GrpcLogAppender (LogUtils.java:warn(122)) - a9b6c243-aad2-4cee-be19-871628539a81@group-52E96576A6DB->0c34be74-1f5b-4b04-a6d4-fde6c3deb89a-AppendLogResponseHandler: Failed appendEntries: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
2021-10-05 13:24:26,281 [grpc-default-executor-3] WARN  server.GrpcLogAppender (GrpcLogAppender.java:resetClient(111)) - a9b6c243-aad2-4cee-be19-871628539a81@group-52E96576A6DB->0c34be74-1f5b-4b04-a6d4-fde6c3deb89a-GrpcLogAppender: Leader has not got in touch with Follower a9b6c243-aad2-4cee-be19-871628539a81@group-52E96576A6DB->0c34be74-1f5b-4b04-a6d4-fde6c3deb89a(c0,m0,n1, attendVote=true, lastRpcSendTime=2514, lastRpcResponseTime=2511) yet, just keep nextIndex unchanged and retry.
2021-10-05 13:24:26,304 [grpc-default-executor-3] WARN  server.GrpcLogAppender (LogUtils.java:warn(122)) - a9b6c243-aad2-4cee-be19-871628539a81@group-52E96576A6DB->f990c0ed-f7f2-4f8a-8ec9-db097d9c855e-AppendLogResponseHandler: Failed appendEntries: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
2021-10-05 13:24:26,304 [grpc-default-executor-3] WARN  server.GrpcLogAppender (GrpcLogAppender.java:resetClient(111)) - a9b6c243-aad2-4cee-be19-871628539a81@group-52E96576A6DB->f990c0ed-f7f2-4f8a-8ec9-db097d9c855e-GrpcLogAppender: Leader has not got in touch with Follower a9b6c243-aad2-4cee-be19-871628539a81@group-52E96576A6DB->f990c0ed-f7f2-4f8a-8ec9-db097d9c855e(c0,m0,n1, attendVote=true, lastRpcSendTime=0, lastRpcResponseTime=2526) yet, just keep nextIndex unchanged and retry.
2021-10-05 13:24:26,714 [EndpointStateMachine task thread for /127.0.0.1:15041 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15041. Already tried 3 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:24:26,776 [EndpointStateMachine task thread for /127.0.0.1:15031 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15031. Already tried 7 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:24:26,778 [EndpointStateMachine task thread for /127.0.0.1:15021 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15021. Already tried 7 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:24:27,715 [EndpointStateMachine task thread for /127.0.0.1:15041 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15041. Already tried 4 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:24:27,777 [EndpointStateMachine task thread for /127.0.0.1:15031 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15031. Already tried 8 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:24:27,778 [EndpointStateMachine task thread for /127.0.0.1:15021 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15021. Already tried 8 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:24:28,716 [EndpointStateMachine task thread for /127.0.0.1:15041 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15041. Already tried 5 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:24:28,777 [EndpointStateMachine task thread for /127.0.0.1:15031 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15031. Already tried 9 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:24:28,779 [EndpointStateMachine task thread for /127.0.0.1:15021 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15021. Already tried 9 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:24:28,787 [grpc-default-executor-3] WARN  server.GrpcLogAppender (LogUtils.java:warn(122)) - a9b6c243-aad2-4cee-be19-871628539a81@group-52E96576A6DB->0c34be74-1f5b-4b04-a6d4-fde6c3deb89a-AppendLogResponseHandler: Failed appendEntries: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
2021-10-05 13:24:28,788 [grpc-default-executor-3] WARN  server.GrpcLogAppender (GrpcLogAppender.java:resetClient(111)) - a9b6c243-aad2-4cee-be19-871628539a81@group-52E96576A6DB->0c34be74-1f5b-4b04-a6d4-fde6c3deb89a-GrpcLogAppender: Leader has not got in touch with Follower a9b6c243-aad2-4cee-be19-871628539a81@group-52E96576A6DB->0c34be74-1f5b-4b04-a6d4-fde6c3deb89a(c0,m0,n1, attendVote=true, lastRpcSendTime=2506, lastRpcResponseTime=5019) yet, just keep nextIndex unchanged and retry.
2021-10-05 13:24:28,811 [grpc-default-executor-3] WARN  server.GrpcLogAppender (LogUtils.java:warn(122)) - a9b6c243-aad2-4cee-be19-871628539a81@group-52E96576A6DB->f990c0ed-f7f2-4f8a-8ec9-db097d9c855e-AppendLogResponseHandler: Failed appendEntries: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
2021-10-05 13:24:28,812 [grpc-default-executor-3] WARN  server.GrpcLogAppender (GrpcLogAppender.java:resetClient(111)) - a9b6c243-aad2-4cee-be19-871628539a81@group-52E96576A6DB->f990c0ed-f7f2-4f8a-8ec9-db097d9c855e-GrpcLogAppender: Leader has not got in touch with Follower a9b6c243-aad2-4cee-be19-871628539a81@group-52E96576A6DB->f990c0ed-f7f2-4f8a-8ec9-db097d9c855e(c0,m0,n1, attendVote=true, lastRpcSendTime=0, lastRpcResponseTime=5034) yet, just keep nextIndex unchanged and retry.
2021-10-05 13:24:29,154 [Listener at 127.0.0.1/10356] INFO  statemachine.DatanodeStateMachine (DatanodeStateMachine.java:stopDaemon(515)) - Ozone container server stopped.
2021-10-05 13:24:29,155 [Listener at 127.0.0.1/10356] INFO  handler.ContextHandler (ContextHandler.java:doStop(1153)) - Stopped o.e.j.w.WebAppContext@463b7913{hddsDatanode,/,null,STOPPED}{jar:file:/home/runner/.m2/repository/org/apache/ozone/hdds-container-service/1.2.0-SNAPSHOT/hdds-container-service-1.2.0-SNAPSHOT.jar!/webapps/hddsDatanode}
2021-10-05 13:24:29,156 [ForkJoinPool.commonPool-worker-0] INFO  statemachine.DatanodeStateMachine (DatanodeStateMachine.java:stopDaemon(515)) - Ozone container server stopped.
2021-10-05 13:24:29,156 [Listener at 127.0.0.1/10356] INFO  server.AbstractConnector (AbstractConnector.java:doStop(381)) - Stopped ServerConnector@553011a9{HTTP/1.1, (http/1.1)}{0.0.0.0:0}
2021-10-05 13:24:29,160 [ForkJoinPool.commonPool-worker-0] INFO  handler.ContextHandler (ContextHandler.java:doStop(1153)) - Stopped o.e.j.w.WebAppContext@47af69bc{hddsDatanode,/,null,STOPPED}{jar:file:/home/runner/.m2/repository/org/apache/ozone/hdds-container-service/1.2.0-SNAPSHOT/hdds-container-service-1.2.0-SNAPSHOT.jar!/webapps/hddsDatanode}
2021-10-05 13:24:29,167 [Listener at 127.0.0.1/10356] INFO  server.session (HouseKeeper.java:stopScavenging(149)) - node0 Stopped scavenging
2021-10-05 13:24:29,168 [Listener at 127.0.0.1/10356] INFO  handler.ContextHandler (ContextHandler.java:doStop(1153)) - Stopped o.e.j.s.ServletContextHandler@e6f7638{static,/static,jar:file:/home/runner/.m2/repository/org/apache/ozone/hdds-container-service/1.2.0-SNAPSHOT/hdds-container-service-1.2.0-SNAPSHOT.jar!/webapps/static,STOPPED}
2021-10-05 13:24:29,168 [Listener at 127.0.0.1/10356] INFO  handler.ContextHandler (ContextHandler.java:doStop(1153)) - Stopped o.e.j.s.ServletContextHandler@51f779b2{logs,/logs,file:///home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/log,STOPPED}
2021-10-05 13:24:29,168 [ForkJoinPool.commonPool-worker-0] INFO  server.AbstractConnector (AbstractConnector.java:doStop(381)) - Stopped ServerConnector@2063d1c8{HTTP/1.1, (http/1.1)}{0.0.0.0:0}
2021-10-05 13:24:29,169 [ForkJoinPool.commonPool-worker-0] INFO  server.session (HouseKeeper.java:stopScavenging(149)) - node0 Stopped scavenging
2021-10-05 13:24:29,174 [ForkJoinPool.commonPool-worker-0] INFO  handler.ContextHandler (ContextHandler.java:doStop(1153)) - Stopped o.e.j.s.ServletContextHandler@36db2ef8{static,/static,jar:file:/home/runner/.m2/repository/org/apache/ozone/hdds-container-service/1.2.0-SNAPSHOT/hdds-container-service-1.2.0-SNAPSHOT.jar!/webapps/static,STOPPED}
2021-10-05 13:24:29,174 [ForkJoinPool.commonPool-worker-0] INFO  handler.ContextHandler (ContextHandler.java:doStop(1153)) - Stopped o.e.j.s.ServletContextHandler@15d0d8c{logs,/logs,file:///home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/log,STOPPED}
2021-10-05 13:24:29,229 [a9b6c243-aad2-4cee-be19-871628539a81@group-D8E46993F0F1-FollowerState] INFO  impl.FollowerState (FollowerState.java:run(134)) - a9b6c243-aad2-4cee-be19-871628539a81@group-D8E46993F0F1-FollowerState: change to CANDIDATE, lastRpcElapsedTime:5386390987ns, electionTimeout:5127ms
2021-10-05 13:24:29,229 [a9b6c243-aad2-4cee-be19-871628539a81@group-D8E46993F0F1-FollowerState] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(108)) - a9b6c243-aad2-4cee-be19-871628539a81: shutdown a9b6c243-aad2-4cee-be19-871628539a81@group-D8E46993F0F1-FollowerState
2021-10-05 13:24:29,229 [a9b6c243-aad2-4cee-be19-871628539a81@group-D8E46993F0F1-FollowerState] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(285)) - a9b6c243-aad2-4cee-be19-871628539a81@group-D8E46993F0F1: changes role from  FOLLOWER to CANDIDATE at term 2 for changeToCandidate
2021-10-05 13:24:29,229 [a9b6c243-aad2-4cee-be19-871628539a81@group-D8E46993F0F1-FollowerState] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.leaderelection.pre-vote = false (custom)
2021-10-05 13:24:29,230 [a9b6c243-aad2-4cee-be19-871628539a81@group-D8E46993F0F1-FollowerState] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(130)) - a9b6c243-aad2-4cee-be19-871628539a81: start a9b6c243-aad2-4cee-be19-871628539a81@group-D8E46993F0F1-LeaderElection13
2021-10-05 13:24:29,244 [a9b6c243-aad2-4cee-be19-871628539a81@group-D8E46993F0F1-LeaderElection13] INFO  server.RaftServer$Division (ServerState.java:setLeader(285)) - a9b6c243-aad2-4cee-be19-871628539a81@group-D8E46993F0F1: change Leader from f990c0ed-f7f2-4f8a-8ec9-db097d9c855e to null at term 2 for ELECTION
2021-10-05 13:24:29,251 [a9b6c243-aad2-4cee-be19-871628539a81@group-D8E46993F0F1-LeaderElection13] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(306)) - a9b6c243-aad2-4cee-be19-871628539a81@group-D8E46993F0F1-LeaderElection13 ELECTION round 0: submit vote requests at term 3 for 0: [0c34be74-1f5b-4b04-a6d4-fde6c3deb89a|rpc:127.0.0.1:33359|dataStream:|priority:0, f990c0ed-f7f2-4f8a-8ec9-db097d9c855e|rpc:127.0.0.1:44595|dataStream:|priority:1, a9b6c243-aad2-4cee-be19-871628539a81|rpc:127.0.0.1:36351|dataStream:|priority:0], old=null
2021-10-05 13:24:29,272 [a9b6c243-aad2-4cee-be19-871628539a81@group-D8E46993F0F1-LeaderElection13] INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(137)) - a9b6c243-aad2-4cee-be19-871628539a81@group-D8E46993F0F1-LeaderElection13 got exception when requesting votes: java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
2021-10-05 13:24:29,275 [a9b6c243-aad2-4cee-be19-871628539a81@group-D8E46993F0F1-LeaderElection13] INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(137)) - a9b6c243-aad2-4cee-be19-871628539a81@group-D8E46993F0F1-LeaderElection13 got exception when requesting votes: java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
2021-10-05 13:24:29,276 [a9b6c243-aad2-4cee-be19-871628539a81@group-D8E46993F0F1-LeaderElection13] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(89)) - a9b6c243-aad2-4cee-be19-871628539a81@group-D8E46993F0F1-LeaderElection13: ELECTION REJECTED received 0 response(s) and 2 exception(s):
2021-10-05 13:24:29,276 [a9b6c243-aad2-4cee-be19-871628539a81@group-D8E46993F0F1-LeaderElection13] INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(137)) -   Exception 0: java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
2021-10-05 13:24:29,276 [a9b6c243-aad2-4cee-be19-871628539a81@group-D8E46993F0F1-LeaderElection13] INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(137)) -   Exception 1: java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
2021-10-05 13:24:29,276 [a9b6c243-aad2-4cee-be19-871628539a81@group-D8E46993F0F1-LeaderElection13] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(308)) - a9b6c243-aad2-4cee-be19-871628539a81@group-D8E46993F0F1-LeaderElection13 ELECTION round 0: result REJECTED
2021-10-05 13:24:29,276 [a9b6c243-aad2-4cee-be19-871628539a81@group-D8E46993F0F1-LeaderElection13] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(285)) - a9b6c243-aad2-4cee-be19-871628539a81@group-D8E46993F0F1: changes role from CANDIDATE to FOLLOWER at term 3 for REJECTED
2021-10-05 13:24:29,276 [a9b6c243-aad2-4cee-be19-871628539a81@group-D8E46993F0F1-LeaderElection13] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(121)) - a9b6c243-aad2-4cee-be19-871628539a81: shutdown a9b6c243-aad2-4cee-be19-871628539a81@group-D8E46993F0F1-LeaderElection13
2021-10-05 13:24:29,276 [a9b6c243-aad2-4cee-be19-871628539a81@group-D8E46993F0F1-LeaderElection13] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(130)) - a9b6c243-aad2-4cee-be19-871628539a81: start a9b6c243-aad2-4cee-be19-871628539a81@group-D8E46993F0F1-FollowerState
2021-10-05 13:24:29,529 [a9b6c243-aad2-4cee-be19-871628539a81@group-52E96576A6DB-LeaderStateImpl] WARN  server.RaftServer$Division (LeaderStateImpl.java:checkLeadership(944)) - a9b6c243-aad2-4cee-be19-871628539a81@group-52E96576A6DB-LeaderStateImpl: Lost leadership on term: 3. Election timeout: 5200ms. In charge for: 20834ms. Conf: 0: [0c34be74-1f5b-4b04-a6d4-fde6c3deb89a|rpc:127.0.0.1:33359|dataStream:|priority:0, f990c0ed-f7f2-4f8a-8ec9-db097d9c855e|rpc:127.0.0.1:44595|dataStream:|priority:0, a9b6c243-aad2-4cee-be19-871628539a81|rpc:127.0.0.1:36351|dataStream:|priority:1], old=null
2021-10-05 13:24:29,530 [a9b6c243-aad2-4cee-be19-871628539a81@group-52E96576A6DB-LeaderStateImpl] WARN  server.RaftServer$Division (LeaderStateImpl.java:lambda$checkLeadership$15(948)) - Follower a9b6c243-aad2-4cee-be19-871628539a81@group-52E96576A6DB->0c34be74-1f5b-4b04-a6d4-fde6c3deb89a(c0,m0,n1, attendVote=true, lastRpcSendTime=741, lastRpcResponseTime=5760)
2021-10-05 13:24:29,530 [a9b6c243-aad2-4cee-be19-871628539a81@group-52E96576A6DB-LeaderStateImpl] WARN  server.RaftServer$Division (LeaderStateImpl.java:lambda$checkLeadership$15(948)) - Follower a9b6c243-aad2-4cee-be19-871628539a81@group-52E96576A6DB->f990c0ed-f7f2-4f8a-8ec9-db097d9c855e(c0,m0,n1, attendVote=true, lastRpcSendTime=718, lastRpcResponseTime=5752)
2021-10-05 13:24:29,530 [a9b6c243-aad2-4cee-be19-871628539a81@group-52E96576A6DB-LeaderStateImpl] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(285)) - a9b6c243-aad2-4cee-be19-871628539a81@group-52E96576A6DB: changes role from    LEADER to FOLLOWER at term 3 for StepDownReason:LOST_MAJORITY_HEARTBEATS
2021-10-05 13:24:29,530 [a9b6c243-aad2-4cee-be19-871628539a81@group-52E96576A6DB-LeaderStateImpl] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(91)) - a9b6c243-aad2-4cee-be19-871628539a81: shutdown a9b6c243-aad2-4cee-be19-871628539a81@group-52E96576A6DB-LeaderStateImpl
2021-10-05 13:24:29,530 [a9b6c243-aad2-4cee-be19-871628539a81@group-52E96576A6DB-LeaderStateImpl] INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(282)) - a9b6c243-aad2-4cee-be19-871628539a81@group-52E96576A6DB-PendingRequests: sendNotLeaderResponses
2021-10-05 13:24:29,530 [a9b6c243-aad2-4cee-be19-871628539a81@group-52E96576A6DB-LeaderStateImpl] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(130)) - a9b6c243-aad2-4cee-be19-871628539a81: start a9b6c243-aad2-4cee-be19-871628539a81@group-52E96576A6DB-FollowerState
2021-10-05 13:24:29,714 [Datanode State Machine Thread - 0] WARN  statemachine.StateContext (StateContext.java:setState(246)) - Ignore disallowed transition from SHUTDOWN to RUNNING
2021-10-05 13:24:29,716 [EndpointStateMachine task thread for /127.0.0.1:15041 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15041. Already tried 6 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:24:29,778 [EndpointStateMachine task thread for /127.0.0.1:15031 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15031. Already tried 10 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:24:29,779 [EndpointStateMachine task thread for /127.0.0.1:15021 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15021. Already tried 10 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:24:30,717 [EndpointStateMachine task thread for /127.0.0.1:15041 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15041. Already tried 7 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:24:30,779 [EndpointStateMachine task thread for /127.0.0.1:15031 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15031. Already tried 11 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:24:30,780 [EndpointStateMachine task thread for /127.0.0.1:15021 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15021. Already tried 11 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:24:31,718 [EndpointStateMachine task thread for /127.0.0.1:15041 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15041. Already tried 8 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:24:31,780 [EndpointStateMachine task thread for /127.0.0.1:15031 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15031. Already tried 12 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:24:31,780 [EndpointStateMachine task thread for /127.0.0.1:15021 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15021. Already tried 12 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:24:32,718 [EndpointStateMachine task thread for /127.0.0.1:15041 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15041. Already tried 9 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:24:32,780 [EndpointStateMachine task thread for /127.0.0.1:15031 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15031. Already tried 13 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:24:32,781 [EndpointStateMachine task thread for /127.0.0.1:15021 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15021. Already tried 13 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:24:33,719 [EndpointStateMachine task thread for /127.0.0.1:15041 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15041. Already tried 10 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:24:33,781 [EndpointStateMachine task thread for /127.0.0.1:15031 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15031. Already tried 14 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:24:33,781 [EndpointStateMachine task thread for /127.0.0.1:15021 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15021. Already tried 14 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:24:33,781 [EndpointStateMachine task thread for /127.0.0.1:15031 - 0 ] WARN  statemachine.EndpointStateMachine (EndpointStateMachine.java:logIfNeeded(236)) - Unable to communicate to SCM server at localhost:15031 for past 0 seconds.
java.net.ConnectException: Call From fv-az270-324/10.1.0.10 to localhost:15031 failed on connection exception: java.net.ConnectException: Connection refused; For more details see:  http://wiki.apache.org/hadoop/ConnectionRefused
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.hadoop.net.NetUtils.wrapWithMessage(NetUtils.java:913)
	at org.apache.hadoop.net.NetUtils.wrapException(NetUtils.java:828)
	at org.apache.hadoop.ipc.Client.getRpcResponse(Client.java:1577)
	at org.apache.hadoop.ipc.Client.call(Client.java:1519)
	at org.apache.hadoop.ipc.Client.call(Client.java:1416)
	at org.apache.hadoop.ipc.ProtobufRpcEngine$Invoker.invoke(ProtobufRpcEngine.java:236)
	at org.apache.hadoop.ipc.ProtobufRpcEngine$Invoker.invoke(ProtobufRpcEngine.java:123)
	at com.sun.proxy.$Proxy48.submitRequest(Unknown Source)
	at org.apache.hadoop.ozone.protocolPB.StorageContainerDatanodeProtocolClientSideTranslatorPB.submitRequest(StorageContainerDatanodeProtocolClientSideTranslatorPB.java:117)
	at org.apache.hadoop.ozone.protocolPB.StorageContainerDatanodeProtocolClientSideTranslatorPB.sendHeartbeat(StorageContainerDatanodeProtocolClientSideTranslatorPB.java:149)
	at org.apache.hadoop.ozone.container.common.states.endpoint.HeartbeatEndpointTask.call(HeartbeatEndpointTask.java:179)
	at org.apache.hadoop.ozone.container.common.states.endpoint.HeartbeatEndpointTask.call(HeartbeatEndpointTask.java:82)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.net.ConnectException: Connection refused
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:716)
	at org.apache.hadoop.net.SocketIOWithTimeout.connect(SocketIOWithTimeout.java:206)
	at org.apache.hadoop.net.NetUtils.connect(NetUtils.java:586)
	at org.apache.hadoop.ipc.Client$Connection.setupConnection(Client.java:701)
	at org.apache.hadoop.ipc.Client$Connection.setupIOstreams(Client.java:822)
	at org.apache.hadoop.ipc.Client$Connection.access$3800(Client.java:414)
	at org.apache.hadoop.ipc.Client.getConnection(Client.java:1647)
	at org.apache.hadoop.ipc.Client.call(Client.java:1463)
	... 12 more
2021-10-05 13:24:33,782 [EndpointStateMachine task thread for /127.0.0.1:15021 - 0 ] WARN  statemachine.EndpointStateMachine (EndpointStateMachine.java:logIfNeeded(236)) - Unable to communicate to SCM server at localhost:15021 for past 0 seconds.
java.net.ConnectException: Call From fv-az270-324/10.1.0.10 to localhost:15021 failed on connection exception: java.net.ConnectException: Connection refused; For more details see:  http://wiki.apache.org/hadoop/ConnectionRefused
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.hadoop.net.NetUtils.wrapWithMessage(NetUtils.java:913)
	at org.apache.hadoop.net.NetUtils.wrapException(NetUtils.java:828)
	at org.apache.hadoop.ipc.Client.getRpcResponse(Client.java:1577)
	at org.apache.hadoop.ipc.Client.call(Client.java:1519)
	at org.apache.hadoop.ipc.Client.call(Client.java:1416)
	at org.apache.hadoop.ipc.ProtobufRpcEngine$Invoker.invoke(ProtobufRpcEngine.java:236)
	at org.apache.hadoop.ipc.ProtobufRpcEngine$Invoker.invoke(ProtobufRpcEngine.java:123)
	at com.sun.proxy.$Proxy48.submitRequest(Unknown Source)
	at org.apache.hadoop.ozone.protocolPB.StorageContainerDatanodeProtocolClientSideTranslatorPB.submitRequest(StorageContainerDatanodeProtocolClientSideTranslatorPB.java:117)
	at org.apache.hadoop.ozone.protocolPB.StorageContainerDatanodeProtocolClientSideTranslatorPB.sendHeartbeat(StorageContainerDatanodeProtocolClientSideTranslatorPB.java:149)
	at org.apache.hadoop.ozone.container.common.states.endpoint.HeartbeatEndpointTask.call(HeartbeatEndpointTask.java:179)
	at org.apache.hadoop.ozone.container.common.states.endpoint.HeartbeatEndpointTask.call(HeartbeatEndpointTask.java:82)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.net.ConnectException: Connection refused
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:716)
	at org.apache.hadoop.net.SocketIOWithTimeout.connect(SocketIOWithTimeout.java:206)
	at org.apache.hadoop.net.NetUtils.connect(NetUtils.java:586)
	at org.apache.hadoop.ipc.Client$Connection.setupConnection(Client.java:701)
	at org.apache.hadoop.ipc.Client$Connection.setupIOstreams(Client.java:822)
	at org.apache.hadoop.ipc.Client$Connection.access$3800(Client.java:414)
	at org.apache.hadoop.ipc.Client.getConnection(Client.java:1647)
	at org.apache.hadoop.ipc.Client.call(Client.java:1463)
	... 12 more
2021-10-05 13:24:34,176 [Listener at 127.0.0.1/10356] INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(325)) - Attempting to stop container services.
2021-10-05 13:24:34,177 [Listener at 127.0.0.1/10356] INFO  server.RaftServer (RaftServerProxy.java:lambda$close$6(391)) - a9b6c243-aad2-4cee-be19-871628539a81: close
2021-10-05 13:24:34,180 [Listener at 127.0.0.1/10356] INFO  server.RaftServer$Division (RaftServerImpl.java:lambda$close$4(407)) - a9b6c243-aad2-4cee-be19-871628539a81@group-52E96576A6DB: shutdown
2021-10-05 13:24:34,180 [ForkJoinPool.commonPool-worker-1] INFO  server.RaftServer$Division (RaftServerImpl.java:lambda$close$4(407)) - a9b6c243-aad2-4cee-be19-871628539a81@group-D8E46993F0F1: shutdown
2021-10-05 13:24:34,181 [Listener at 127.0.0.1/10356] INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-52E96576A6DB,id=a9b6c243-aad2-4cee-be19-871628539a81
2021-10-05 13:24:34,187 [Listener at 127.0.0.1/10356] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(108)) - a9b6c243-aad2-4cee-be19-871628539a81: shutdown a9b6c243-aad2-4cee-be19-871628539a81@group-52E96576A6DB-FollowerState
2021-10-05 13:24:34,187 [Listener at 127.0.0.1/10356] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(149)) - a9b6c243-aad2-4cee-be19-871628539a81@group-52E96576A6DB-StateMachineUpdater: set stopIndex = 0
2021-10-05 13:24:34,187 [ForkJoinPool.commonPool-worker-1] INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-D8E46993F0F1,id=a9b6c243-aad2-4cee-be19-871628539a81
2021-10-05 13:24:34,187 [ForkJoinPool.commonPool-worker-1] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(108)) - a9b6c243-aad2-4cee-be19-871628539a81: shutdown a9b6c243-aad2-4cee-be19-871628539a81@group-D8E46993F0F1-FollowerState
2021-10-05 13:24:34,187 [ForkJoinPool.commonPool-worker-1] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(149)) - a9b6c243-aad2-4cee-be19-871628539a81@group-D8E46993F0F1-StateMachineUpdater: set stopIndex = 0
2021-10-05 13:24:34,187 [a9b6c243-aad2-4cee-be19-871628539a81@group-D8E46993F0F1-FollowerState] INFO  impl.FollowerState (FollowerState.java:run(143)) - a9b6c243-aad2-4cee-be19-871628539a81@group-D8E46993F0F1-FollowerState was interrupted: {}
java.lang.InterruptedException: sleep interrupted
	at java.lang.Thread.sleep(Native Method)
	at java.lang.Thread.sleep(Thread.java:340)
	at java.util.concurrent.TimeUnit.sleep(TimeUnit.java:386)
	at org.apache.ratis.util.TimeDuration.sleep(TimeDuration.java:324)
	at org.apache.ratis.util.TimeDuration.sleep(TimeDuration.java:309)
	at org.apache.ratis.server.impl.FollowerState.run(FollowerState.java:118)
2021-10-05 13:24:34,187 [a9b6c243-aad2-4cee-be19-871628539a81@group-52E96576A6DB-FollowerState] INFO  impl.FollowerState (FollowerState.java:run(143)) - a9b6c243-aad2-4cee-be19-871628539a81@group-52E96576A6DB-FollowerState was interrupted: {}
java.lang.InterruptedException: sleep interrupted
	at java.lang.Thread.sleep(Native Method)
	at java.lang.Thread.sleep(Thread.java:340)
	at java.util.concurrent.TimeUnit.sleep(TimeUnit.java:386)
	at org.apache.ratis.util.TimeDuration.sleep(TimeDuration.java:324)
	at org.apache.ratis.util.TimeDuration.sleep(TimeDuration.java:309)
	at org.apache.ratis.server.impl.FollowerState.run(FollowerState.java:118)
2021-10-05 13:24:34,187 [a9b6c243-aad2-4cee-be19-871628539a81@group-52E96576A6DB-StateMachineUpdater] INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(292)) - group-52E96576A6DB: Taking a snapshot at:(t:3, i:0) file /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-98f4f1fb-613f-4a4a-83a3-c748f4b4520d/datanode-2/data/ratis/8c8a590d-1d11-430c-931a-52e96576a6db/sm/snapshot.3_0
2021-10-05 13:24:34,188 [a9b6c243-aad2-4cee-be19-871628539a81@group-D8E46993F0F1-StateMachineUpdater] INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(292)) - group-D8E46993F0F1: Taking a snapshot at:(t:2, i:0) file /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-98f4f1fb-613f-4a4a-83a3-c748f4b4520d/datanode-2/data/ratis/90899f2e-5ed2-48cb-9677-d8e46993f0f1/sm/snapshot.2_0
2021-10-05 13:24:34,189 [a9b6c243-aad2-4cee-be19-871628539a81@group-52E96576A6DB-StateMachineUpdater] INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(303)) - group-52E96576A6DB: Finished taking a snapshot at:(t:3, i:0) file:/home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-98f4f1fb-613f-4a4a-83a3-c748f4b4520d/datanode-2/data/ratis/8c8a590d-1d11-430c-931a-52e96576a6db/sm/snapshot.3_0 took: 2 ms
2021-10-05 13:24:34,189 [a9b6c243-aad2-4cee-be19-871628539a81@group-52E96576A6DB-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:takeSnapshot(281)) - a9b6c243-aad2-4cee-be19-871628539a81@group-52E96576A6DB-StateMachineUpdater: Took a snapshot at index 0
2021-10-05 13:24:34,189 [a9b6c243-aad2-4cee-be19-871628539a81@group-52E96576A6DB-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:lambda$new$0(89)) - a9b6c243-aad2-4cee-be19-871628539a81@group-52E96576A6DB-StateMachineUpdater: snapshotIndex: updateIncreasingly -1 -> 0
2021-10-05 13:24:34,190 [Listener at 127.0.0.1/10356] INFO  server.RaftServer$Division (ServerState.java:close(419)) - a9b6c243-aad2-4cee-be19-871628539a81@group-52E96576A6DB: closes. applyIndex: 0
2021-10-05 13:24:34,190 [a9b6c243-aad2-4cee-be19-871628539a81@group-52E96576A6DB-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:run(327)) - a9b6c243-aad2-4cee-be19-871628539a81@group-52E96576A6DB-SegmentedRaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2021-10-05 13:24:34,190 [Listener at 127.0.0.1/10356] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:close(237)) - a9b6c243-aad2-4cee-be19-871628539a81@group-52E96576A6DB-SegmentedRaftLogWorker close()
2021-10-05 13:24:34,191 [a9b6c243-aad2-4cee-be19-871628539a81@group-D8E46993F0F1-StateMachineUpdater] INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(303)) - group-D8E46993F0F1: Finished taking a snapshot at:(t:2, i:0) file:/home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-98f4f1fb-613f-4a4a-83a3-c748f4b4520d/datanode-2/data/ratis/90899f2e-5ed2-48cb-9677-d8e46993f0f1/sm/snapshot.2_0 took: 2 ms
2021-10-05 13:24:34,191 [a9b6c243-aad2-4cee-be19-871628539a81@group-D8E46993F0F1-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:takeSnapshot(281)) - a9b6c243-aad2-4cee-be19-871628539a81@group-D8E46993F0F1-StateMachineUpdater: Took a snapshot at index 0
2021-10-05 13:24:34,191 [a9b6c243-aad2-4cee-be19-871628539a81@group-D8E46993F0F1-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:lambda$new$0(89)) - a9b6c243-aad2-4cee-be19-871628539a81@group-D8E46993F0F1-StateMachineUpdater: snapshotIndex: updateIncreasingly -1 -> 0
2021-10-05 13:24:34,191 [ForkJoinPool.commonPool-worker-1] INFO  server.RaftServer$Division (ServerState.java:close(419)) - a9b6c243-aad2-4cee-be19-871628539a81@group-D8E46993F0F1: closes. applyIndex: 0
2021-10-05 13:24:34,191 [a9b6c243-aad2-4cee-be19-871628539a81@group-D8E46993F0F1-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:run(327)) - a9b6c243-aad2-4cee-be19-871628539a81@group-D8E46993F0F1-SegmentedRaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2021-10-05 13:24:34,192 [ForkJoinPool.commonPool-worker-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:close(237)) - a9b6c243-aad2-4cee-be19-871628539a81@group-D8E46993F0F1-SegmentedRaftLogWorker close()
2021-10-05 13:24:34,192 [ForkJoinPool.commonPool-worker-1] INFO  server.RaftServer$Division (RaftServerImpl.java:lambda$close$4(407)) - a9b6c243-aad2-4cee-be19-871628539a81@group-DC372A106217: shutdown
2021-10-05 13:24:34,192 [ForkJoinPool.commonPool-worker-1] INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-DC372A106217,id=a9b6c243-aad2-4cee-be19-871628539a81
2021-10-05 13:24:34,192 [ForkJoinPool.commonPool-worker-1] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(91)) - a9b6c243-aad2-4cee-be19-871628539a81: shutdown a9b6c243-aad2-4cee-be19-871628539a81@group-DC372A106217-LeaderStateImpl
2021-10-05 13:24:34,192 [ForkJoinPool.commonPool-worker-1] INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(282)) - a9b6c243-aad2-4cee-be19-871628539a81@group-DC372A106217-PendingRequests: sendNotLeaderResponses
2021-10-05 13:24:34,192 [ForkJoinPool.commonPool-worker-1] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(149)) - a9b6c243-aad2-4cee-be19-871628539a81@group-DC372A106217-StateMachineUpdater: set stopIndex = 0
2021-10-05 13:24:34,194 [a9b6c243-aad2-4cee-be19-871628539a81@group-DC372A106217-StateMachineUpdater] INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(292)) - group-DC372A106217: Taking a snapshot at:(t:1, i:0) file /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-98f4f1fb-613f-4a4a-83a3-c748f4b4520d/datanode-2/data/ratis/422df7cd-075e-4b52-b513-dc372a106217/sm/snapshot.1_0
2021-10-05 13:24:34,195 [a9b6c243-aad2-4cee-be19-871628539a81@group-DC372A106217-StateMachineUpdater] INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(303)) - group-DC372A106217: Finished taking a snapshot at:(t:1, i:0) file:/home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-98f4f1fb-613f-4a4a-83a3-c748f4b4520d/datanode-2/data/ratis/422df7cd-075e-4b52-b513-dc372a106217/sm/snapshot.1_0 took: 0 ms
2021-10-05 13:24:34,195 [a9b6c243-aad2-4cee-be19-871628539a81@group-DC372A106217-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:takeSnapshot(281)) - a9b6c243-aad2-4cee-be19-871628539a81@group-DC372A106217-StateMachineUpdater: Took a snapshot at index 0
2021-10-05 13:24:34,195 [a9b6c243-aad2-4cee-be19-871628539a81@group-DC372A106217-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:lambda$new$0(89)) - a9b6c243-aad2-4cee-be19-871628539a81@group-DC372A106217-StateMachineUpdater: snapshotIndex: updateIncreasingly -1 -> 0
2021-10-05 13:24:34,195 [ForkJoinPool.commonPool-worker-1] INFO  server.RaftServer$Division (ServerState.java:close(419)) - a9b6c243-aad2-4cee-be19-871628539a81@group-DC372A106217: closes. applyIndex: 0
2021-10-05 13:24:34,196 [a9b6c243-aad2-4cee-be19-871628539a81@group-DC372A106217-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:run(327)) - a9b6c243-aad2-4cee-be19-871628539a81@group-DC372A106217-SegmentedRaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2021-10-05 13:24:34,196 [ForkJoinPool.commonPool-worker-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:close(237)) - a9b6c243-aad2-4cee-be19-871628539a81@group-DC372A106217-SegmentedRaftLogWorker close()
2021-10-05 13:24:34,196 [Listener at 127.0.0.1/10356] INFO  server.GrpcService (GrpcService.java:closeImpl(262)) - a9b6c243-aad2-4cee-be19-871628539a81: shutdown server with port 36351 now
2021-10-05 13:24:34,198 [Listener at 127.0.0.1/10356] INFO  server.GrpcService (GrpcService.java:closeImpl(271)) - a9b6c243-aad2-4cee-be19-871628539a81: shutdown server with port 36351 successfully
2021-10-05 13:24:34,198 [org.apache.ratis.util.JvmPauseMonitor$$Lambda$499/1586779822@41fe9138] INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(109)) - JvmPauseMonitor-a9b6c243-aad2-4cee-be19-871628539a81: Stopped
2021-10-05 13:24:34,198 [Listener at 127.0.0.1/10356] INFO  utils.BackgroundService (BackgroundService.java:shutdown(132)) - Shutting down service BlockDeletingService
2021-10-05 13:24:34,720 [EndpointStateMachine task thread for /127.0.0.1:15041 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15041. Already tried 11 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:24:34,782 [EndpointStateMachine task thread for /127.0.0.1:15031 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15031. Already tried 0 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:24:34,783 [EndpointStateMachine task thread for /127.0.0.1:15021 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15021. Already tried 0 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:24:35,720 [EndpointStateMachine task thread for /127.0.0.1:15041 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15041. Already tried 12 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:24:35,783 [EndpointStateMachine task thread for /127.0.0.1:15031 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15031. Already tried 1 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:24:35,785 [EndpointStateMachine task thread for /127.0.0.1:15021 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15021. Already tried 1 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:24:36,721 [EndpointStateMachine task thread for /127.0.0.1:15041 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15041. Already tried 13 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:24:36,783 [EndpointStateMachine task thread for /127.0.0.1:15031 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15031. Already tried 2 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:24:36,785 [EndpointStateMachine task thread for /127.0.0.1:15021 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15021. Already tried 2 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:24:37,200 [Listener at 127.0.0.1/10356] INFO  statemachine.DatanodeStateMachine (DatanodeStateMachine.java:stopDaemon(515)) - Ozone container server stopped.
2021-10-05 13:24:37,201 [Listener at 127.0.0.1/10356] INFO  handler.ContextHandler (ContextHandler.java:doStop(1153)) - Stopped o.e.j.w.WebAppContext@1bf1f019{hddsDatanode,/,null,STOPPED}{jar:file:/home/runner/.m2/repository/org/apache/ozone/hdds-container-service/1.2.0-SNAPSHOT/hdds-container-service-1.2.0-SNAPSHOT.jar!/webapps/hddsDatanode}
2021-10-05 13:24:37,201 [Listener at 127.0.0.1/10356] INFO  server.AbstractConnector (AbstractConnector.java:doStop(381)) - Stopped ServerConnector@749bbb99{HTTP/1.1, (http/1.1)}{0.0.0.0:0}
2021-10-05 13:24:37,202 [Listener at 127.0.0.1/10356] INFO  server.session (HouseKeeper.java:stopScavenging(149)) - node0 Stopped scavenging
2021-10-05 13:24:37,202 [Listener at 127.0.0.1/10356] INFO  handler.ContextHandler (ContextHandler.java:doStop(1153)) - Stopped o.e.j.s.ServletContextHandler@12cd321d{static,/static,jar:file:/home/runner/.m2/repository/org/apache/ozone/hdds-container-service/1.2.0-SNAPSHOT/hdds-container-service-1.2.0-SNAPSHOT.jar!/webapps/static,STOPPED}
2021-10-05 13:24:37,202 [Listener at 127.0.0.1/10356] INFO  handler.ContextHandler (ContextHandler.java:doStop(1153)) - Stopped o.e.j.s.ServletContextHandler@7d49efaf{logs,/logs,file:///home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/log,STOPPED}
2021-10-05 13:24:37,330 [Listener at 127.0.0.1/10356] WARN  server.ServerUtils (ServerUtils.java:getScmDbDir(148)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2021-10-05 13:24:37,334 [Listener at 127.0.0.1/10356] INFO  ha.SCMHANodeDetails (SCMHANodeDetails.java:loadSCMHAConfig(157)) - ServiceID for StorageContainerManager is scm-service-test1
2021-10-05 13:24:37,334 [Listener at 127.0.0.1/10356] INFO  ha.SCMHANodeDetails (SCMHANodeDetails.java:loadSCMHAConfig(168)) - ServiceID for StorageContainerManager is scm-service-test1
2021-10-05 13:24:37,334 [Listener at 127.0.0.1/10356] WARN  scm.ScmUtils (ScmUtils.java:logWarn(179)) - ConfigKey ozone.scm.block.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.block.client.port appended with serviceId and nodeId. If want to configure same port configure ozone.scm.block.client.port
2021-10-05 13:24:37,337 [Listener at 127.0.0.1/10356] WARN  scm.ScmUtils (ScmUtils.java:logWarn(179)) - ConfigKey ozone.scm.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.client.port appended with serviceId and nodeId. If want to configure same port configure ozone.scm.client.port
2021-10-05 13:24:37,337 [Listener at 127.0.0.1/10356] WARN  scm.ScmUtils (ScmUtils.java:logWarn(179)) - ConfigKey ozone.scm.datanode.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.datanode.port appended with serviceId and nodeId. If want to configure same port configure ozone.scm.datanode.port
2021-10-05 13:24:37,338 [Listener at 127.0.0.1/10356] WARN  scm.ScmUtils (ScmUtils.java:logWarn(179)) - ConfigKey ozone.scm.block.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.block.client.port appended with serviceId and nodeId. If want to configure same port configure ozone.scm.block.client.port
2021-10-05 13:24:37,339 [Listener at 127.0.0.1/10356] WARN  scm.ScmUtils (ScmUtils.java:logWarn(179)) - ConfigKey ozone.scm.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.client.port appended with serviceId and nodeId. If want to configure same port configure ozone.scm.client.port
2021-10-05 13:24:37,339 [Listener at 127.0.0.1/10356] WARN  scm.ScmUtils (ScmUtils.java:logWarn(179)) - ConfigKey ozone.scm.datanode.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.datanode.port appended with serviceId and nodeId. If want to configure same port configure ozone.scm.datanode.port
2021-10-05 13:24:37,339 [Listener at 127.0.0.1/10356] INFO  ha.SCMHANodeDetails (SCMHANodeDetails.java:loadSCMHAConfig(250)) - Found matching SCM address with SCMServiceId: scm-service-test1, SCMNodeId: scmNode-1, RPC Address: localhost:13528 and Ratis port: 13528
2021-10-05 13:24:37,339 [Listener at 127.0.0.1/10356] INFO  ha.SCMHANodeDetails (ConfUtils.java:setNodeSpecificConfigs(108)) - Setting configuration key ozone.scm.datanode.address with value of key ozone.scm.datanode.address.scm-service-test1.scmNode-1: 127.0.0.1:13529
2021-10-05 13:24:37,339 [Listener at 127.0.0.1/10356] INFO  ha.SCMHANodeDetails (ConfUtils.java:setNodeSpecificConfigs(108)) - Setting configuration key ozone.scm.block.client.address with value of key ozone.scm.block.client.address.scm-service-test1.scmNode-1: 127.0.0.1:13530
2021-10-05 13:24:37,339 [Listener at 127.0.0.1/10356] INFO  ha.SCMHANodeDetails (ConfUtils.java:setNodeSpecificConfigs(108)) - Setting configuration key ozone.scm.client.address with value of key ozone.scm.client.address.scm-service-test1.scmNode-1: 127.0.0.1:13531
2021-10-05 13:24:37,339 [Listener at 127.0.0.1/10356] INFO  ha.SCMHANodeDetails (ConfUtils.java:setNodeSpecificConfigs(108)) - Setting configuration key ozone.scm.ratis.port with value of key ozone.scm.ratis.port.scm-service-test1.scmNode-1: 13528
2021-10-05 13:24:37,339 [Listener at 127.0.0.1/10356] INFO  ha.SCMHANodeDetails (ConfUtils.java:setNodeSpecificConfigs(108)) - Setting configuration key ozone.scm.grpc.port with value of key ozone.scm.grpc.port.scm-service-test1.scmNode-1: 13532
2021-10-05 13:24:37,339 [Listener at 127.0.0.1/10356] INFO  ha.SCMHANodeDetails (ConfUtils.java:setNodeSpecificConfigs(108)) - Setting configuration key ozone.scm.http-address with value of key ozone.scm.http-address.scm-service-test1.scmNode-1: 127.0.0.1:13526
2021-10-05 13:24:37,339 [Listener at 127.0.0.1/10356] INFO  ha.SCMHANodeDetails (ConfUtils.java:setNodeSpecificConfigs(108)) - Setting configuration key ozone.scm.https-address with value of key ozone.scm.https-address.scm-service-test1.scmNode-1: 127.0.0.1:13527
2021-10-05 13:24:37,340 [Listener at 127.0.0.1/10356] INFO  ha.SCMHANodeDetails (ConfUtils.java:setNodeSpecificConfigs(108)) - Setting configuration key ozone.scm.address with value of key ozone.scm.address.scm-service-test1.scmNode-1: 127.0.0.1
2021-10-05 13:24:37,340 [Listener at 127.0.0.1/10356] WARN  scm.ScmUtils (ScmUtils.java:logWarn(179)) - ConfigKey ozone.scm.block.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.block.client.port appended with serviceId and nodeId. If want to configure same port configure ozone.scm.block.client.port
2021-10-05 13:24:37,340 [Listener at 127.0.0.1/10356] WARN  scm.ScmUtils (ScmUtils.java:logWarn(179)) - ConfigKey ozone.scm.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.client.port appended with serviceId and nodeId. If want to configure same port configure ozone.scm.client.port
2021-10-05 13:24:37,340 [Listener at 127.0.0.1/10356] WARN  scm.ScmUtils (ScmUtils.java:logWarn(179)) - ConfigKey ozone.scm.datanode.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.datanode.port appended with serviceId and nodeId. If want to configure same port configure ozone.scm.datanode.port
2021-10-05 13:24:37,362 [Listener at 127.0.0.1/10356] INFO  server.RaftServer (ConfUtils.java:logGet(44)) - raft.rpc.type = GRPC (default)
2021-10-05 13:24:37,362 [Listener at 127.0.0.1/10356] INFO  grpc.GrpcFactory (GrpcFactory.java:checkPooledByteBufAllocatorUseCacheForAllThreads(48)) - PERFORMANCE WARNING: useCacheForAllThreads is true that may cause Netty to create a lot garbage objects and, as a result, trigger GC.
	It is recommended to disable useCacheForAllThreads by setting -Dorg.apache.ratis.thirdparty.io.netty.allocator.useCacheForAllThreads=false in command line.
2021-10-05 13:24:37,362 [Listener at 127.0.0.1/10356] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(44)) - raft.grpc.admin.port = -1 (default)
2021-10-05 13:24:37,362 [Listener at 127.0.0.1/10356] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(44)) - raft.grpc.server.port = 13528 (custom)
2021-10-05 13:24:37,362 [Listener at 127.0.0.1/10356] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(44)) - raft.grpc.client.port = -1 (default)
2021-10-05 13:24:37,362 [Listener at 127.0.0.1/10356] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(44)) - raft.grpc.server.port = 13528 (custom)
2021-10-05 13:24:37,363 [Listener at 127.0.0.1/10356] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(44)) - raft.grpc.server.port = 13528 (custom)
2021-10-05 13:24:37,363 [Listener at 127.0.0.1/10356] INFO  server.GrpcService (ConfUtils.java:logGet(44)) - raft.grpc.message.size.max = 32m (=33554432) (custom)
2021-10-05 13:24:37,363 [Listener at 127.0.0.1/10356] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2021-10-05 13:24:37,363 [Listener at 127.0.0.1/10356] INFO  server.GrpcService (ConfUtils.java:logGet(44)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2021-10-05 13:24:37,363 [Listener at 127.0.0.1/10356] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.request.timeout = 30000ms (custom)
2021-10-05 13:24:37,364 [Listener at 127.0.0.1/10356] INFO  impl.DataStreamServerImpl (ConfUtils.java:logGet(44)) - raft.datastream.type = DISABLED (default)
2021-10-05 13:24:37,365 [Listener at 127.0.0.1/10356] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.slowness.timeout = 120000ms (custom)
2021-10-05 13:24:37,365 [Listener at 127.0.0.1/10356] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.leaderelection.leader.step-down.wait-time = 10s (default)
2021-10-05 13:24:37,365 [Listener at 127.0.0.1/10356] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.storage.dir = [/home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-36b87918-66c6-4e2c-9c49-5aa8dab94a1f/scmNode-1/scm-ha] (custom)
2021-10-05 13:24:37,367 [Listener at 127.0.0.1/10356] INFO  server.RaftServer (RaftServerProxy.java:addNew(95)) - 21490b65-0a55-46f3-b94a-dd719a327c14: addNew group-5AA8DAB94A1F:[21490b65-0a55-46f3-b94a-dd719a327c14|rpc:localhost:13528|priority:0] returns group-5AA8DAB94A1F:java.util.concurrent.CompletableFuture@6bd9a104[Not completed]
2021-10-05 13:24:37,371 [pool-174-thread-1] INFO  server.RaftServer$Division (RaftServerImpl.java:<init>(181)) - 21490b65-0a55-46f3-b94a-dd719a327c14: new RaftServerImpl for group-5AA8DAB94A1F:[21490b65-0a55-46f3-b94a-dd719a327c14|rpc:localhost:13528|priority:0] with SCMStateMachine:uninitialized
2021-10-05 13:24:37,376 [pool-174-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.timeout.min = 5000ms (custom)
2021-10-05 13:24:37,376 [pool-174-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.timeout.max = 5200ms (custom)
2021-10-05 13:24:37,376 [pool-174-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.sleep.time = 25ms (default)
2021-10-05 13:24:37,376 [pool-174-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.slowness.timeout = 120000ms (custom)
2021-10-05 13:24:37,376 [pool-174-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.leaderelection.leader.step-down.wait-time = 10s (default)
2021-10-05 13:24:37,376 [pool-174-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.sleep.deviation.threshold = 300ms (default)
2021-10-05 13:24:37,376 [pool-174-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.appender.install.snapshot.enabled = false (custom)
2021-10-05 13:24:37,376 [pool-174-thread-1] INFO  server.RaftServer$Division (ServerState.java:<init>(105)) - 21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F: ConfigurationManager, init=-1: [21490b65-0a55-46f3-b94a-dd719a327c14|rpc:localhost:13528|priority:0], old=null, confs=<EMPTY_MAP>
2021-10-05 13:24:37,376 [pool-174-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.storage.dir = [/home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-36b87918-66c6-4e2c-9c49-5aa8dab94a1f/scmNode-1/scm-ha] (custom)
2021-10-05 13:24:37,376 [pool-174-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.corruption.policy = EXCEPTION (default)
2021-10-05 13:24:37,376 [pool-174-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.storage.free-space.min = 0MB (=0) (default)
2021-10-05 13:24:37,377 [pool-174-thread-1] INFO  storage.RaftStorageDirectory (RaftStorageDirectoryImpl.java:analyzeStorage(135)) - The storage directory /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-36b87918-66c6-4e2c-9c49-5aa8dab94a1f/scmNode-1/scm-ha/36b87918-66c6-4e2c-9c49-5aa8dab94a1f does not exist. Creating ...
2021-10-05 13:24:37,381 [pool-174-thread-1] INFO  storage.RaftStorageDirectory (RaftStorageDirectoryImpl.java:tryLock(230)) - Lock on /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-36b87918-66c6-4e2c-9c49-5aa8dab94a1f/scmNode-1/scm-ha/36b87918-66c6-4e2c-9c49-5aa8dab94a1f/in_use.lock acquired by nodename 17451@fv-az270-324
2021-10-05 13:24:37,384 [pool-174-thread-1] INFO  storage.RaftStorage (RaftStorageImpl.java:format(89)) - Storage directory /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-36b87918-66c6-4e2c-9c49-5aa8dab94a1f/scmNode-1/scm-ha/36b87918-66c6-4e2c-9c49-5aa8dab94a1f has been successfully formatted.
2021-10-05 13:24:37,386 [pool-174-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.notification.no-leader.timeout = 60s (default)
2021-10-05 13:24:37,386 [pool-174-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.use.memory = false (default)
2021-10-05 13:24:37,386 [pool-174-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.purge.gap = 5 (custom)
2021-10-05 13:24:37,386 [pool-174-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2021-10-05 13:24:37,386 [pool-174-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.segment.size.max = 16384 (custom)
2021-10-05 13:24:37,387 [pool-174-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.segment.cache.num.max = 2 (custom)
2021-10-05 13:24:37,387 [pool-174-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.segment.cache.size.max = 200MB (=209715200) (default)
2021-10-05 13:24:37,387 [pool-174-thread-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:<init>(182)) - new 21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F-SegmentedRaftLogWorker for RaftStorageImpl:Storage Directory /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-36b87918-66c6-4e2c-9c49-5aa8dab94a1f/scmNode-1/scm-ha/36b87918-66c6-4e2c-9c49-5aa8dab94a1f
2021-10-05 13:24:37,387 [pool-174-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.queue.byte-limit = 64MB (=67108864) (default)
2021-10-05 13:24:37,387 [pool-174-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.queue.element-limit = 4096 (default)
2021-10-05 13:24:37,387 [pool-174-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.segment.size.max = 16384 (custom)
2021-10-05 13:24:37,387 [pool-174-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.preallocated.size = 16384 (custom)
2021-10-05 13:24:37,387 [pool-174-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.force.sync.num = 128 (default)
2021-10-05 13:24:37,387 [pool-174-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.statemachine.data.sync = true (default)
2021-10-05 13:24:37,387 [pool-174-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2021-10-05 13:24:37,387 [pool-174-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2021-10-05 13:24:37,387 [pool-174-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.write.buffer.size = 64KB (=65536) (default)
2021-10-05 13:24:37,388 [pool-174-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.statemachine.data.caching.enabled = false (default)
2021-10-05 13:24:37,388 [pool-174-thread-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:lambda$new$0(133)) - 21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F-SegmentedRaftLogWorker: flushIndex: setUnconditionally 0 -> -1
2021-10-05 13:24:37,388 [pool-174-thread-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:lambda$new$0(133)) - 21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F-SegmentedRaftLogWorker: safeCacheEvictIndex: setUnconditionally 0 -> -1
2021-10-05 13:24:37,399 [pool-174-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2021-10-05 13:24:37,399 [pool-174-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.snapshot.auto.trigger.threshold = 5 (custom)
2021-10-05 13:24:37,399 [pool-174-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.snapshot.retention.file.num = -1 (default)
2021-10-05 13:24:37,399 [pool-174-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.purge.upto.snapshot.index = true (custom)
2021-10-05 13:24:37,399 [pool-174-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.retrycache.expirytime = 60000ms (default)
2021-10-05 13:24:37,399 [pool-174-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.retrycache.statistics.expirytime = 100μs (default)
2021-10-05 13:24:37,400 [Listener at 127.0.0.1/10356] INFO  server.RaftServer$Division (RaftServerImpl.java:start(296)) - 21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F: start as a follower, conf=-1: [21490b65-0a55-46f3-b94a-dd719a327c14|rpc:localhost:13528|priority:0], old=null
2021-10-05 13:24:37,400 [Listener at 127.0.0.1/10356] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(285)) - 21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F: changes role from      null to FOLLOWER at term 0 for startAsFollower
2021-10-05 13:24:37,400 [Listener at 127.0.0.1/10356] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(130)) - 21490b65-0a55-46f3-b94a-dd719a327c14: start 21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F-FollowerState
2021-10-05 13:24:37,407 [Listener at 127.0.0.1/10356] INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-5AA8DAB94A1F,id=21490b65-0a55-46f3-b94a-dd719a327c14
2021-10-05 13:24:37,411 [Listener at 127.0.0.1/10356] INFO  server.RaftServer (RaftServerProxy.java:lambda$start$5(374)) - 21490b65-0a55-46f3-b94a-dd719a327c14: start RPC server
2021-10-05 13:24:37,427 [Listener at 127.0.0.1/10356] INFO  server.GrpcService (GrpcService.java:startImpl(253)) - 21490b65-0a55-46f3-b94a-dd719a327c14: GrpcService started, listening on 13528
2021-10-05 13:24:37,428 [org.apache.ratis.util.JvmPauseMonitor$$Lambda$499/1586779822@79a3499] INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(103)) - JvmPauseMonitor-21490b65-0a55-46f3-b94a-dd719a327c14: Started
2021-10-05 13:24:37,722 [EndpointStateMachine task thread for /127.0.0.1:15041 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15041. Already tried 14 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:24:37,784 [EndpointStateMachine task thread for /127.0.0.1:15031 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15031. Already tried 3 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:24:37,786 [EndpointStateMachine task thread for /127.0.0.1:15021 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15021. Already tried 3 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:24:38,724 [EndpointStateMachine task thread for /127.0.0.1:15041 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15041. Already tried 0 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:24:38,784 [EndpointStateMachine task thread for /127.0.0.1:15031 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15031. Already tried 4 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:24:38,786 [EndpointStateMachine task thread for /127.0.0.1:15021 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15021. Already tried 4 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:24:39,725 [EndpointStateMachine task thread for /127.0.0.1:15041 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15041. Already tried 1 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:24:39,785 [EndpointStateMachine task thread for /127.0.0.1:15031 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15031. Already tried 5 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:24:39,787 [EndpointStateMachine task thread for /127.0.0.1:15021 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15021. Already tried 5 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:24:40,725 [EndpointStateMachine task thread for /127.0.0.1:15041 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15041. Already tried 2 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:24:40,786 [EndpointStateMachine task thread for /127.0.0.1:15031 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15031. Already tried 6 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:24:40,787 [EndpointStateMachine task thread for /127.0.0.1:15021 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15021. Already tried 6 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:24:41,726 [EndpointStateMachine task thread for /127.0.0.1:15041 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15041. Already tried 3 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:24:41,786 [EndpointStateMachine task thread for /127.0.0.1:15031 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15031. Already tried 7 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:24:41,788 [EndpointStateMachine task thread for /127.0.0.1:15021 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15021. Already tried 7 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:24:42,550 [21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F-FollowerState] INFO  impl.FollowerState (FollowerState.java:run(134)) - 21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F-FollowerState: change to CANDIDATE, lastRpcElapsedTime:5150068440ns, electionTimeout:5131ms
2021-10-05 13:24:42,551 [21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F-FollowerState] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(108)) - 21490b65-0a55-46f3-b94a-dd719a327c14: shutdown 21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F-FollowerState
2021-10-05 13:24:42,551 [21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F-FollowerState] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(285)) - 21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F: changes role from  FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2021-10-05 13:24:42,551 [21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F-FollowerState] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.leaderelection.pre-vote = false (custom)
2021-10-05 13:24:42,551 [21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F-FollowerState] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(130)) - 21490b65-0a55-46f3-b94a-dd719a327c14: start 21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F-LeaderElection14
2021-10-05 13:24:42,570 [21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F-LeaderElection14] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(306)) - 21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F-LeaderElection14 ELECTION round 0: submit vote requests at term 1 for -1: [21490b65-0a55-46f3-b94a-dd719a327c14|rpc:localhost:13528|priority:0], old=null
2021-10-05 13:24:42,570 [21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F-LeaderElection14] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(308)) - 21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F-LeaderElection14 ELECTION round 0: result PASSED (term=1)
2021-10-05 13:24:42,570 [21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F-LeaderElection14] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(121)) - 21490b65-0a55-46f3-b94a-dd719a327c14: shutdown 21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F-LeaderElection14
2021-10-05 13:24:42,570 [21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F-LeaderElection14] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(285)) - 21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F: changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2021-10-05 13:24:42,570 [21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F-LeaderElection14] INFO  server.RaftServer$Division (ServerState.java:setLeader(285)) - 21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F: change Leader from null to 21490b65-0a55-46f3-b94a-dd719a327c14 at term 1 for becomeLeader, leader elected after 5184ms
2021-10-05 13:24:42,570 [21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F-LeaderElection14] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.staging.catchup.gap = 1000 (default)
2021-10-05 13:24:42,571 [21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F-LeaderElection14] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.write.element-limit = 4096 (default)
2021-10-05 13:24:42,571 [21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F-LeaderElection14] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.write.byte-limit = 64MB (=67108864) (default)
2021-10-05 13:24:42,571 [21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F-LeaderElection14] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.watch.timeout = 10s (default)
2021-10-05 13:24:42,571 [21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F-LeaderElection14] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.watch.timeout.denomination = 1s (default)
2021-10-05 13:24:42,571 [21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F-LeaderElection14] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.watch.element-limit = 65536 (default)
2021-10-05 13:24:42,571 [21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F-LeaderElection14] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(130)) - 21490b65-0a55-46f3-b94a-dd719a327c14: start 21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F-LeaderStateImpl
2021-10-05 13:24:42,572 [21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F-LeaderElection14] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:startLogSegment(394)) - 21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F-SegmentedRaftLogWorker: Starting segment from index:0
2021-10-05 13:24:42,578 [21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F-LeaderElection14] INFO  server.RaftServer$Division (ServerState.java:setRaftConf(387)) - 21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F: set configuration 0: [21490b65-0a55-46f3-b94a-dd719a327c14|rpc:localhost:13528|admin:|client:|dataStream:|priority:0], old=null
2021-10-05 13:24:42,580 [21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(601)) - 21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F-SegmentedRaftLogWorker: created new log segment /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-36b87918-66c6-4e2c-9c49-5aa8dab94a1f/scmNode-1/scm-ha/36b87918-66c6-4e2c-9c49-5aa8dab94a1f/current/log_inprogress_0
2021-10-05 13:24:42,726 [EndpointStateMachine task thread for /127.0.0.1:15041 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15041. Already tried 4 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:24:42,787 [EndpointStateMachine task thread for /127.0.0.1:15031 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15031. Already tried 8 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:24:42,788 [EndpointStateMachine task thread for /127.0.0.1:15021 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15021. Already tried 8 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:24:43,428 [Listener at 127.0.0.1/10356] INFO  server.RaftServer (RaftServerProxy.java:lambda$close$6(391)) - 21490b65-0a55-46f3-b94a-dd719a327c14: close
2021-10-05 13:24:43,429 [Listener at 127.0.0.1/10356] INFO  server.RaftServer$Division (RaftServerImpl.java:lambda$close$4(407)) - 21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F: shutdown
2021-10-05 13:24:43,429 [Listener at 127.0.0.1/10356] INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-5AA8DAB94A1F,id=21490b65-0a55-46f3-b94a-dd719a327c14
2021-10-05 13:24:43,429 [Listener at 127.0.0.1/10356] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(91)) - 21490b65-0a55-46f3-b94a-dd719a327c14: shutdown 21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F-LeaderStateImpl
2021-10-05 13:24:43,429 [Listener at 127.0.0.1/10356] INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(282)) - 21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F-PendingRequests: sendNotLeaderResponses
2021-10-05 13:24:43,430 [Listener at 127.0.0.1/10356] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(149)) - 21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F-StateMachineUpdater: set stopIndex = 0
2021-10-05 13:24:43,430 [21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:takeSnapshot(281)) - 21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F-StateMachineUpdater: Took a snapshot at index 0
2021-10-05 13:24:43,430 [21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:lambda$new$0(89)) - 21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F-StateMachineUpdater: snapshotIndex: updateIncreasingly -1 -> 0
2021-10-05 13:24:43,431 [Listener at 127.0.0.1/10356] INFO  server.RaftServer$Division (ServerState.java:close(419)) - 21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F: closes. applyIndex: 0
2021-10-05 13:24:43,431 [21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:run(327)) - 21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F-SegmentedRaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2021-10-05 13:24:43,432 [Listener at 127.0.0.1/10356] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:close(237)) - 21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F-SegmentedRaftLogWorker close()
2021-10-05 13:24:43,435 [Listener at 127.0.0.1/10356] INFO  server.GrpcService (GrpcService.java:closeImpl(262)) - 21490b65-0a55-46f3-b94a-dd719a327c14: shutdown server with port 13528 now
2021-10-05 13:24:43,435 [Listener at 127.0.0.1/10356] INFO  server.GrpcService (GrpcService.java:closeImpl(271)) - 21490b65-0a55-46f3-b94a-dd719a327c14: shutdown server with port 13528 successfully
2021-10-05 13:24:43,436 [org.apache.ratis.util.JvmPauseMonitor$$Lambda$499/1586779822@79a3499] INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(109)) - JvmPauseMonitor-21490b65-0a55-46f3-b94a-dd719a327c14: Stopped
2021-10-05 13:24:43,436 [Listener at 127.0.0.1/10356] WARN  server.ServerUtils (ServerUtils.java:getScmDbDir(148)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2021-10-05 13:24:43,444 [Listener at 127.0.0.1/10356] INFO  server.StorageContainerManager (StorageContainerManager.java:scmInit(1083)) - SCM initialization succeeded. Current cluster id for sd=/home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-36b87918-66c6-4e2c-9c49-5aa8dab94a1f/scmNode-1/scm; cid=36b87918-66c6-4e2c-9c49-5aa8dab94a1f; layoutVersion=2; scmId=21490b65-0a55-46f3-b94a-dd719a327c14
2021-10-05 13:24:43,444 [Listener at 127.0.0.1/10356] INFO  ha.SCMHANodeDetails (SCMHANodeDetails.java:loadSCMHAConfig(157)) - ServiceID for StorageContainerManager is scm-service-test1
2021-10-05 13:24:43,444 [Listener at 127.0.0.1/10356] INFO  ha.SCMHANodeDetails (SCMHANodeDetails.java:loadSCMHAConfig(168)) - ServiceID for StorageContainerManager is scm-service-test1
2021-10-05 13:24:43,444 [Listener at 127.0.0.1/10356] WARN  scm.ScmUtils (ScmUtils.java:logWarn(179)) - ConfigKey ozone.scm.block.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.block.client.port appended with serviceId and nodeId. If want to configure same port configure ozone.scm.block.client.port
2021-10-05 13:24:43,445 [Listener at 127.0.0.1/10356] WARN  scm.ScmUtils (ScmUtils.java:logWarn(179)) - ConfigKey ozone.scm.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.client.port appended with serviceId and nodeId. If want to configure same port configure ozone.scm.client.port
2021-10-05 13:24:43,445 [Listener at 127.0.0.1/10356] WARN  scm.ScmUtils (ScmUtils.java:logWarn(179)) - ConfigKey ozone.scm.datanode.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.datanode.port appended with serviceId and nodeId. If want to configure same port configure ozone.scm.datanode.port
2021-10-05 13:24:43,445 [Listener at 127.0.0.1/10356] WARN  scm.ScmUtils (ScmUtils.java:logWarn(179)) - ConfigKey ozone.scm.block.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.block.client.port appended with serviceId and nodeId. If want to configure same port configure ozone.scm.block.client.port
2021-10-05 13:24:43,445 [Listener at 127.0.0.1/10356] WARN  scm.ScmUtils (ScmUtils.java:logWarn(179)) - ConfigKey ozone.scm.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.client.port appended with serviceId and nodeId. If want to configure same port configure ozone.scm.client.port
2021-10-05 13:24:43,445 [Listener at 127.0.0.1/10356] WARN  scm.ScmUtils (ScmUtils.java:logWarn(179)) - ConfigKey ozone.scm.datanode.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.datanode.port appended with serviceId and nodeId. If want to configure same port configure ozone.scm.datanode.port
2021-10-05 13:24:43,445 [Listener at 127.0.0.1/10356] INFO  ha.SCMHANodeDetails (SCMHANodeDetails.java:loadSCMHAConfig(250)) - Found matching SCM address with SCMServiceId: scm-service-test1, SCMNodeId: scmNode-1, RPC Address: localhost:13528 and Ratis port: 13528
2021-10-05 13:24:43,445 [Listener at 127.0.0.1/10356] INFO  ha.SCMHANodeDetails (ConfUtils.java:setNodeSpecificConfigs(108)) - Setting configuration key ozone.scm.datanode.address with value of key ozone.scm.datanode.address.scm-service-test1.scmNode-1: 127.0.0.1:13529
2021-10-05 13:24:43,445 [Listener at 127.0.0.1/10356] INFO  ha.SCMHANodeDetails (ConfUtils.java:setNodeSpecificConfigs(108)) - Setting configuration key ozone.scm.block.client.address with value of key ozone.scm.block.client.address.scm-service-test1.scmNode-1: 127.0.0.1:13530
2021-10-05 13:24:43,446 [Listener at 127.0.0.1/10356] INFO  ha.SCMHANodeDetails (ConfUtils.java:setNodeSpecificConfigs(108)) - Setting configuration key ozone.scm.client.address with value of key ozone.scm.client.address.scm-service-test1.scmNode-1: 127.0.0.1:13531
2021-10-05 13:24:43,446 [Listener at 127.0.0.1/10356] INFO  ha.SCMHANodeDetails (ConfUtils.java:setNodeSpecificConfigs(108)) - Setting configuration key ozone.scm.ratis.port with value of key ozone.scm.ratis.port.scm-service-test1.scmNode-1: 13528
2021-10-05 13:24:43,446 [Listener at 127.0.0.1/10356] INFO  ha.SCMHANodeDetails (ConfUtils.java:setNodeSpecificConfigs(108)) - Setting configuration key ozone.scm.grpc.port with value of key ozone.scm.grpc.port.scm-service-test1.scmNode-1: 13532
2021-10-05 13:24:43,446 [Listener at 127.0.0.1/10356] INFO  ha.SCMHANodeDetails (ConfUtils.java:setNodeSpecificConfigs(108)) - Setting configuration key ozone.scm.http-address with value of key ozone.scm.http-address.scm-service-test1.scmNode-1: 127.0.0.1:13526
2021-10-05 13:24:43,446 [Listener at 127.0.0.1/10356] INFO  ha.SCMHANodeDetails (ConfUtils.java:setNodeSpecificConfigs(108)) - Setting configuration key ozone.scm.https-address with value of key ozone.scm.https-address.scm-service-test1.scmNode-1: 127.0.0.1:13527
2021-10-05 13:24:43,446 [Listener at 127.0.0.1/10356] INFO  ha.SCMHANodeDetails (ConfUtils.java:setNodeSpecificConfigs(108)) - Setting configuration key ozone.scm.address with value of key ozone.scm.address.scm-service-test1.scmNode-1: 127.0.0.1
2021-10-05 13:24:43,446 [Listener at 127.0.0.1/10356] WARN  scm.ScmUtils (ScmUtils.java:logWarn(179)) - ConfigKey ozone.scm.block.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.block.client.port appended with serviceId and nodeId. If want to configure same port configure ozone.scm.block.client.port
2021-10-05 13:24:43,446 [Listener at 127.0.0.1/10356] WARN  scm.ScmUtils (ScmUtils.java:logWarn(179)) - ConfigKey ozone.scm.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.client.port appended with serviceId and nodeId. If want to configure same port configure ozone.scm.client.port
2021-10-05 13:24:43,446 [Listener at 127.0.0.1/10356] WARN  scm.ScmUtils (ScmUtils.java:logWarn(179)) - ConfigKey ozone.scm.datanode.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.datanode.port appended with serviceId and nodeId. If want to configure same port configure ozone.scm.datanode.port
2021-10-05 13:24:43,447 [Listener at 127.0.0.1/10356] WARN  server.ServerUtils (ServerUtils.java:getScmDbDir(148)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2021-10-05 13:24:43,448 [Listener at 127.0.0.1/10356] INFO  upgrade.AbstractLayoutVersionManager (AbstractLayoutVersionManager.java:init(79)) - Initializing Layout version manager with metadata layout = SCM_HA (version = 2), software layout = SCM_HA (version = 2)
2021-10-05 13:24:43,556 [Listener at 127.0.0.1/10356] INFO  reflections.Reflections (Reflections.java:scan(232)) - Reflections took 106 ms to scan 7 urls, producing 119 keys and 275 values 
2021-10-05 13:24:43,580 [Listener at 127.0.0.1/10356] WARN  utils.HAUtils (HAUtils.java:getMetaDir(342)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2021-10-05 13:24:43,588 [Listener at 127.0.0.1/10356] WARN  db.DBStoreBuilder (DBStoreBuilder.java:applyDBDefinition(145)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2021-10-05 13:24:43,727 [EndpointStateMachine task thread for /127.0.0.1:15041 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15041. Already tried 5 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:24:43,728 [Listener at 127.0.0.1/10356] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchemaFromFile(129)) - Loading schema from [jar:file:/home/runner/.m2/repository/org/apache/ozone/hdds-common/1.2.0-SNAPSHOT/hdds-common-1.2.0-SNAPSHOT.jar!/network-topology-default.xml]
2021-10-05 13:24:43,728 [Listener at 127.0.0.1/10356] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchema(176)) - Loading network topology layer schema file
2021-10-05 13:24:43,731 [Listener at 127.0.0.1/10356] INFO  ha.SCMRatisServerImpl (SCMRatisServerImpl.java:<init>(87)) - starting Raft server for scm:21490b65-0a55-46f3-b94a-dd719a327c14
2021-10-05 13:24:43,732 [Listener at 127.0.0.1/10356] INFO  server.RaftServer (ConfUtils.java:logGet(44)) - raft.rpc.type = GRPC (default)
2021-10-05 13:24:43,732 [Listener at 127.0.0.1/10356] INFO  grpc.GrpcFactory (GrpcFactory.java:checkPooledByteBufAllocatorUseCacheForAllThreads(48)) - PERFORMANCE WARNING: useCacheForAllThreads is true that may cause Netty to create a lot garbage objects and, as a result, trigger GC.
	It is recommended to disable useCacheForAllThreads by setting -Dorg.apache.ratis.thirdparty.io.netty.allocator.useCacheForAllThreads=false in command line.
2021-10-05 13:24:43,732 [Listener at 127.0.0.1/10356] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(44)) - raft.grpc.admin.port = -1 (default)
2021-10-05 13:24:43,732 [Listener at 127.0.0.1/10356] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(44)) - raft.grpc.server.port = 13528 (custom)
2021-10-05 13:24:43,732 [Listener at 127.0.0.1/10356] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(44)) - raft.grpc.client.port = -1 (default)
2021-10-05 13:24:43,733 [Listener at 127.0.0.1/10356] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(44)) - raft.grpc.server.port = 13528 (custom)
2021-10-05 13:24:43,733 [Listener at 127.0.0.1/10356] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(44)) - raft.grpc.server.port = 13528 (custom)
2021-10-05 13:24:43,733 [Listener at 127.0.0.1/10356] INFO  server.GrpcService (ConfUtils.java:logGet(44)) - raft.grpc.message.size.max = 32m (=33554432) (custom)
2021-10-05 13:24:43,733 [Listener at 127.0.0.1/10356] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2021-10-05 13:24:43,733 [Listener at 127.0.0.1/10356] INFO  server.GrpcService (ConfUtils.java:logGet(44)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2021-10-05 13:24:43,733 [Listener at 127.0.0.1/10356] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.request.timeout = 30000ms (custom)
2021-10-05 13:24:43,735 [Listener at 127.0.0.1/10356] INFO  impl.DataStreamServerImpl (ConfUtils.java:logGet(44)) - raft.datastream.type = DISABLED (default)
2021-10-05 13:24:43,736 [Listener at 127.0.0.1/10356] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.slowness.timeout = 120000ms (custom)
2021-10-05 13:24:43,739 [Listener at 127.0.0.1/10356] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.leaderelection.leader.step-down.wait-time = 10s (default)
2021-10-05 13:24:43,739 [Listener at 127.0.0.1/10356] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.storage.dir = [/home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-36b87918-66c6-4e2c-9c49-5aa8dab94a1f/scmNode-1/scm-ha] (custom)
2021-10-05 13:24:43,740 [Listener at 127.0.0.1/10356] INFO  server.RaftServer (RaftServerProxy.java:lambda$null$1(235)) - 21490b65-0a55-46f3-b94a-dd719a327c14: found a subdirectory /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-36b87918-66c6-4e2c-9c49-5aa8dab94a1f/scmNode-1/scm-ha/36b87918-66c6-4e2c-9c49-5aa8dab94a1f
2021-10-05 13:24:43,743 [Listener at 127.0.0.1/10356] INFO  server.RaftServer (RaftServerProxy.java:addNew(95)) - 21490b65-0a55-46f3-b94a-dd719a327c14: addNew group-5AA8DAB94A1F:[] returns group-5AA8DAB94A1F:java.util.concurrent.CompletableFuture@47f64e86[Not completed]
2021-10-05 13:24:43,743 [pool-189-thread-1] INFO  server.RaftServer$Division (RaftServerImpl.java:<init>(181)) - 21490b65-0a55-46f3-b94a-dd719a327c14: new RaftServerImpl for group-5AA8DAB94A1F:[] with SCMStateMachine:uninitialized
2021-10-05 13:24:43,751 [pool-189-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.timeout.min = 5000ms (custom)
2021-10-05 13:24:43,759 [pool-189-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.timeout.max = 5200ms (custom)
2021-10-05 13:24:43,759 [pool-189-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.sleep.time = 25ms (default)
2021-10-05 13:24:43,759 [pool-189-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.slowness.timeout = 120000ms (custom)
2021-10-05 13:24:43,759 [pool-189-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.leaderelection.leader.step-down.wait-time = 10s (default)
2021-10-05 13:24:43,759 [pool-189-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.sleep.deviation.threshold = 300ms (default)
2021-10-05 13:24:43,759 [pool-189-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.appender.install.snapshot.enabled = false (custom)
2021-10-05 13:24:43,759 [pool-189-thread-1] INFO  server.RaftServer$Division (ServerState.java:<init>(105)) - 21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F: ConfigurationManager, init=-1: [], old=null, confs=<EMPTY_MAP>
2021-10-05 13:24:43,760 [pool-189-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.storage.dir = [/home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-36b87918-66c6-4e2c-9c49-5aa8dab94a1f/scmNode-1/scm-ha] (custom)
2021-10-05 13:24:43,760 [pool-189-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.corruption.policy = EXCEPTION (default)
2021-10-05 13:24:43,760 [pool-189-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.storage.free-space.min = 0MB (=0) (default)
2021-10-05 13:24:43,762 [pool-189-thread-1] INFO  storage.RaftStorageDirectory (RaftStorageDirectoryImpl.java:tryLock(230)) - Lock on /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-36b87918-66c6-4e2c-9c49-5aa8dab94a1f/scmNode-1/scm-ha/36b87918-66c6-4e2c-9c49-5aa8dab94a1f/in_use.lock acquired by nodename 17451@fv-az270-324
2021-10-05 13:24:43,762 [pool-189-thread-1] INFO  storage.RaftStorage (RaftStorageImpl.java:analyzeAndRecoverStorage(110)) - Read RaftStorageMetadata{term=1, votedFor=21490b65-0a55-46f3-b94a-dd719a327c14} from /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-36b87918-66c6-4e2c-9c49-5aa8dab94a1f/scmNode-1/scm-ha/36b87918-66c6-4e2c-9c49-5aa8dab94a1f/current/raft-meta
2021-10-05 13:24:43,763 [pool-189-thread-1] INFO  server.RaftServer$Division (ServerState.java:setRaftConf(387)) - 21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F: set configuration 0: [21490b65-0a55-46f3-b94a-dd719a327c14|rpc:localhost:13528|admin:|client:|dataStream:|priority:0], old=null
2021-10-05 13:24:43,763 [pool-189-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.notification.no-leader.timeout = 60s (default)
2021-10-05 13:24:43,763 [pool-189-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.use.memory = false (default)
2021-10-05 13:24:43,763 [pool-189-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.purge.gap = 5 (custom)
2021-10-05 13:24:43,763 [pool-189-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2021-10-05 13:24:43,763 [pool-189-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.segment.size.max = 16384 (custom)
2021-10-05 13:24:43,763 [pool-189-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.segment.cache.num.max = 2 (custom)
2021-10-05 13:24:43,764 [pool-189-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.segment.cache.size.max = 200MB (=209715200) (default)
2021-10-05 13:24:43,764 [pool-189-thread-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:<init>(182)) - new 21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F-SegmentedRaftLogWorker for RaftStorageImpl:Storage Directory /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-36b87918-66c6-4e2c-9c49-5aa8dab94a1f/scmNode-1/scm-ha/36b87918-66c6-4e2c-9c49-5aa8dab94a1f
2021-10-05 13:24:43,764 [pool-189-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.queue.byte-limit = 64MB (=67108864) (default)
2021-10-05 13:24:43,764 [pool-189-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.queue.element-limit = 4096 (default)
2021-10-05 13:24:43,764 [pool-189-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.segment.size.max = 16384 (custom)
2021-10-05 13:24:43,764 [pool-189-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.preallocated.size = 16384 (custom)
2021-10-05 13:24:43,764 [pool-189-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.force.sync.num = 128 (default)
2021-10-05 13:24:43,764 [pool-189-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.statemachine.data.sync = true (default)
2021-10-05 13:24:43,764 [pool-189-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2021-10-05 13:24:43,764 [pool-189-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2021-10-05 13:24:43,764 [pool-189-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.write.buffer.size = 64KB (=65536) (default)
2021-10-05 13:24:43,765 [pool-189-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.statemachine.data.caching.enabled = false (default)
2021-10-05 13:24:43,765 [pool-189-thread-1] INFO  server.RaftServer$Division (ServerState.java:setRaftConf(387)) - 21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F: set configuration 0: [21490b65-0a55-46f3-b94a-dd719a327c14|rpc:localhost:13528|admin:|client:|dataStream:|priority:0], old=null
2021-10-05 13:24:43,765 [pool-189-thread-1] INFO  segmented.LogSegment (LogSegment.java:loadSegment(173)) - Successfully read 1 entries from segment file /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-36b87918-66c6-4e2c-9c49-5aa8dab94a1f/scmNode-1/scm-ha/36b87918-66c6-4e2c-9c49-5aa8dab94a1f/current/log_inprogress_0
2021-10-05 13:24:43,765 [pool-189-thread-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:lambda$new$0(133)) - 21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F-SegmentedRaftLogWorker: flushIndex: setUnconditionally 0 -> 0
2021-10-05 13:24:43,765 [pool-189-thread-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:lambda$new$0(133)) - 21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F-SegmentedRaftLogWorker: safeCacheEvictIndex: setUnconditionally 0 -> -1
2021-10-05 13:24:43,771 [pool-189-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2021-10-05 13:24:43,771 [pool-189-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.snapshot.auto.trigger.threshold = 5 (custom)
2021-10-05 13:24:43,772 [pool-189-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.snapshot.retention.file.num = -1 (default)
2021-10-05 13:24:43,772 [pool-189-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.purge.upto.snapshot.index = true (custom)
2021-10-05 13:24:43,772 [pool-189-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.retrycache.expirytime = 60000ms (default)
2021-10-05 13:24:43,772 [pool-189-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.retrycache.statistics.expirytime = 100μs (default)
2021-10-05 13:24:43,773 [Listener at 127.0.0.1/10356] INFO  ha.SCMSnapshotProvider (SCMSnapshotProvider.java:<init>(66)) - Initializing SCM Snapshot Provider
2021-10-05 13:24:43,773 [Listener at 127.0.0.1/10356] WARN  server.ServerUtils (ServerUtils.java:getDefaultRatisDirectory(237)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2021-10-05 13:24:43,773 [Listener at 127.0.0.1/10356] WARN  ha.SCMHAUtils (SCMHAUtils.java:getSCMRatisSnapshotDirectory(146)) - SCM snapshot dir is not configured. Falling back to ozone.metadata.dirs config
2021-10-05 13:24:43,784 [Listener at 127.0.0.1/10356] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:upgradeToSequenceId(347)) - upgrade localId to 107544261427200000
2021-10-05 13:24:43,784 [Listener at 127.0.0.1/10356] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:upgradeToSequenceId(357)) - upgrade delTxnId to 0
2021-10-05 13:24:43,784 [Listener at 127.0.0.1/10356] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:upgradeToSequenceId(371)) - upgrade containerId to 0
2021-10-05 13:24:43,785 [Listener at 127.0.0.1/10356] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:<init>(218)) - Init the HA SequenceIdGenerator.
2021-10-05 13:24:43,787 [EndpointStateMachine task thread for /127.0.0.1:15031 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15031. Already tried 9 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:24:43,788 [EndpointStateMachine task thread for /127.0.0.1:15021 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15021. Already tried 9 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:24:43,796 [Listener at 127.0.0.1/10356] INFO  node.SCMNodeManager (SCMNodeManager.java:<init>(144)) - Entering startup safe mode.
2021-10-05 13:24:43,796 [Listener at 127.0.0.1/10356] INFO  algorithms.ContainerPlacementPolicyFactory (ContainerPlacementPolicyFactory.java:getPolicy(60)) - Create container placement policy of type org.apache.hadoop.hdds.scm.container.placement.algorithms.SCMContainerPlacementRandom
2021-10-05 13:24:43,797 [Listener at 127.0.0.1/10356] INFO  pipeline.PipelineStateManagerImpl (PipelineStateManagerImpl.java:initialize(78)) - No pipeline exists in current db
2021-10-05 13:24:43,797 [Listener at 127.0.0.1/10356] INFO  algorithms.LeaderChoosePolicyFactory (LeaderChoosePolicyFactory.java:getPolicy(57)) - Create leader choose policy of type org.apache.hadoop.hdds.scm.pipeline.leader.choose.algorithms.MinLeaderCountChoosePolicy
2021-10-05 13:24:43,797 [Listener at 127.0.0.1/10356] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(43)) - Registering service BackgroundPipelineCreator.
2021-10-05 13:24:43,797 [Listener at 127.0.0.1/10356] INFO  pipeline.BackgroundPipelineCreator (BackgroundPipelineCreatorV2.java:start(130)) - Starting RatisPipelineUtilsThread.
2021-10-05 13:24:43,807 [Listener at 127.0.0.1/10356] INFO  algorithms.PipelineChoosePolicyFactory (PipelineChoosePolicyFactory.java:createPipelineChoosePolicyFromClass(73)) - Create pipeline choose policy of type org.apache.hadoop.hdds.scm.pipeline.choose.algorithms.RandomPipelineChoosePolicy
2021-10-05 13:24:43,808 [Listener at 127.0.0.1/10356] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(43)) - Registering service SCMBlockDeletingService.
2021-10-05 13:24:43,808 [Listener at 127.0.0.1/10356] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(43)) - Registering service ReplicationManager.
2021-10-05 13:24:43,808 [Listener at 127.0.0.1/10356] INFO  container.ReplicationManager (ReplicationManager.java:start(319)) - Starting Replication Monitor Thread.
2021-10-05 13:24:43,820 [Listener at 127.0.0.1/10356] INFO  safemode.ContainerSafeModeRule (ContainerSafeModeRule.java:<init>(89)) - containers with one replica threshold count 0
2021-10-05 13:24:43,820 [Listener at 127.0.0.1/10356] INFO  safemode.HealthyPipelineSafeModeRule (HealthyPipelineSafeModeRule.java:initializeRule(156)) - Total pipeline count is 0, healthy pipeline threshold count is 1
2021-10-05 13:24:43,820 [Listener at 127.0.0.1/10356] INFO  safemode.OneReplicaPipelineSafeModeRule (OneReplicaPipelineSafeModeRule.java:initializeRule(180)) - Total pipeline count is 0, pipeline's with at least one datanode reported threshold count is 0
2021-10-05 13:24:43,823 [Listener at 127.0.0.1/10356] INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(90)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 10000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false.
2021-10-05 13:24:43,827 [Socket Reader #1 for port 13529] INFO  ipc.Server (Server.java:run(1265)) - Starting Socket Reader #1 for port 13529
2021-10-05 13:24:43,829 [Listener at 0.0.0.0/13529] INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(90)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 10000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false.
2021-10-05 13:24:43,830 [Socket Reader #1 for port 13530] INFO  ipc.Server (Server.java:run(1265)) - Starting Socket Reader #1 for port 13530
2021-10-05 13:24:43,831 [Listener at 0.0.0.0/13530] INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(90)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 10000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false.
2021-10-05 13:24:43,831 [Socket Reader #1 for port 13531] INFO  ipc.Server (Server.java:run(1265)) - Starting Socket Reader #1 for port 13531
2021-10-05 13:24:43,865 [ReplicationMonitor] INFO  container.ReplicationManager (ReplicationManager.java:processAll(371)) - Replication Monitor Thread took 0 milliseconds for processing 0 containers.
2021-10-05 13:24:43,887 [Listener at 0.0.0.0/13531] INFO  algorithms.ContainerPlacementPolicyFactory (ContainerPlacementPolicyFactory.java:getPolicy(60)) - Create container placement policy of type org.apache.hadoop.hdds.scm.container.placement.algorithms.SCMContainerPlacementRandom
2021-10-05 13:24:43,889 [Listener at 0.0.0.0/13531] INFO  server.StorageContainerManager (StorageContainerManager.java:<init>(388)) - 
Container Balancer status:
Key                            Value
Running                        false
Container Balancer Configuration values:
Key                                                Value
Threshold                                          0.1
Max Datanodes to Involve per Iteration(ratio)      0.2
Max Size to Move per Iteration                     32212254720B

2021-10-05 13:24:43,895 [Listener at 0.0.0.0/13531] WARN  events.EventQueue (EventQueue.java:fireEvent(194)) - No event handler registered for event TypedEvent{payloadType=SafeModeStatus, name='Safe mode status'}
2021-10-05 13:24:43,895 [Listener at 0.0.0.0/13531] INFO  ha.SCMContext (SCMContext.java:updateSafeModeStatus(205)) - Update SafeModeStatus from SafeModeStatus{safeModeStatus=true, preCheckPassed=false} to SafeModeStatus{safeModeStatus=true, preCheckPassed=false}.
2021-10-05 13:24:43,896 [Listener at 0.0.0.0/13531] INFO  server.StorageContainerManager (StorageContainerManager.java:start(1303)) - StorageContainerLocationProtocol RPC server is listening at /0.0.0.0:13531
2021-10-05 13:24:43,896 [Listener at 0.0.0.0/13531] INFO  ha.SCMRatisServerImpl (SCMRatisServerImpl.java:start(177)) - starting ratis server 0.0.0.0:13528
2021-10-05 13:24:43,896 [Listener at 0.0.0.0/13531] INFO  server.RaftServer$Division (RaftServerImpl.java:start(296)) - 21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F: start as a follower, conf=0: [21490b65-0a55-46f3-b94a-dd719a327c14|rpc:localhost:13528|admin:|client:|dataStream:|priority:0], old=null
2021-10-05 13:24:43,896 [Listener at 0.0.0.0/13531] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(285)) - 21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F: changes role from      null to FOLLOWER at term 1 for startAsFollower
2021-10-05 13:24:43,896 [Listener at 0.0.0.0/13531] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(130)) - 21490b65-0a55-46f3-b94a-dd719a327c14: start 21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F-FollowerState
2021-10-05 13:24:43,897 [Listener at 0.0.0.0/13531] INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-5AA8DAB94A1F,id=21490b65-0a55-46f3-b94a-dd719a327c14
2021-10-05 13:24:43,915 [Listener at 0.0.0.0/13531] INFO  server.RaftServer (RaftServerProxy.java:lambda$start$5(374)) - 21490b65-0a55-46f3-b94a-dd719a327c14: start RPC server
2021-10-05 13:24:43,916 [Listener at 0.0.0.0/13531] INFO  server.GrpcService (GrpcService.java:startImpl(253)) - 21490b65-0a55-46f3-b94a-dd719a327c14: GrpcService started, listening on 13528
2021-10-05 13:24:43,916 [Listener at 0.0.0.0/13531] INFO  ha.SCMHAManagerImpl (SCMHAManagerImpl.java:start(120)) -  scm role is FOLLOWER peers [21490b65-0a55-46f3-b94a-dd719a327c14|rpc:localhost:13528|admin:|client:|dataStream:|priority:0]
2021-10-05 13:24:43,917 [Listener at 0.0.0.0/13531] INFO  ha.InterSCMGrpcService (InterSCMGrpcProtocolService.java:start(94)) - Starting SCM Grpc Service at port 13532
2021-10-05 13:24:43,918 [Listener at 0.0.0.0/13531] WARN  impl.MetricsConfig (MetricsConfig.java:loadFirst(136)) - Cannot locate configuration: tried hadoop-metrics2-storagecontainermanager.properties,hadoop-metrics2.properties
2021-10-05 13:24:43,925 [Listener at 0.0.0.0/13531] INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:startTimer(378)) - Scheduled Metric snapshot period at 10 second(s).
2021-10-05 13:24:43,925 [Listener at 0.0.0.0/13531] INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:start(191)) - StorageContainerManager metrics system started
2021-10-05 13:24:43,927 [org.apache.ratis.util.JvmPauseMonitor$$Lambda$499/1586779822@561d0389] INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(103)) - JvmPauseMonitor-21490b65-0a55-46f3-b94a-dd719a327c14: Started
2021-10-05 13:24:43,951 [Listener at 0.0.0.0/13531] INFO  impl.MetricsSinkAdapter (MetricsSinkAdapter.java:start(204)) - Sink prometheus started
2021-10-05 13:24:43,955 [Listener at 0.0.0.0/13531] INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:registerSink(305)) - Registered sink prometheus
2021-10-05 13:24:43,986 [Listener at 0.0.0.0/13531] INFO  server.SCMClientProtocolServer (SCMClientProtocolServer.java:start(164)) - RPC server for Client  is listening at /0.0.0.0:13531
2021-10-05 13:24:43,986 [IPC Server Responder] INFO  ipc.Server (Server.java:run(1507)) - IPC Server Responder: starting
2021-10-05 13:24:43,991 [IPC Server listener on 13531] INFO  ipc.Server (Server.java:run(1344)) - IPC Server listener on 13531: starting
2021-10-05 13:24:44,200 [Listener at 0.0.0.0/13531] INFO  server.StorageContainerManager (StorageContainerManager.java:start(1318)) - ScmBlockLocationProtocol RPC server is listening at /0.0.0.0:13530
2021-10-05 13:24:44,201 [Listener at 0.0.0.0/13531] INFO  server.SCMBlockProtocolServer (SCMBlockProtocolServer.java:start(151)) - RPC server for Block Protocol is listening at /0.0.0.0:13530
2021-10-05 13:24:44,204 [IPC Server Responder] INFO  ipc.Server (Server.java:run(1507)) - IPC Server Responder: starting
2021-10-05 13:24:44,219 [IPC Server listener on 13530] INFO  ipc.Server (Server.java:run(1344)) - IPC Server listener on 13530: starting
2021-10-05 13:24:44,287 [Listener at 0.0.0.0/13531] INFO  server.StorageContainerManager (StorageContainerManager.java:start(1324)) - ScmDatanodeProtocl RPC server is listening at /0.0.0.0:13529
2021-10-05 13:24:44,288 [Listener at 0.0.0.0/13531] INFO  http.BaseHttpServer (BaseHttpServer.java:newHttpServer2BuilderForOzone(209)) - Starting Web-server for scm at: http://0.0.0.0:13526
2021-10-05 13:24:44,288 [Listener at 0.0.0.0/13531] INFO  http.BaseHttpServer (BaseHttpServer.java:<init>(107)) - Hadoop Security Enabled: false Ozone Security Enabled: false Ozone HTTP Security Enabled: false 
2021-10-05 13:24:44,289 [Listener at 0.0.0.0/13531] INFO  server.AuthenticationFilter (AuthenticationFilter.java:constructSecretProvider(240)) - Unable to initialize FileSignerSecretProvider, falling back to use random secrets.
2021-10-05 13:24:44,304 [org.apache.hadoop.util.JvmPauseMonitor$Monitor@358a33e3] INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(188)) - Starting JVM pause monitor
2021-10-05 13:24:44,309 [Listener at 0.0.0.0/13531] WARN  http.HttpRequestLog (HttpRequestLog.java:getRequestLog(103)) - Jetty request log can only be enabled using Log4j
2021-10-05 13:24:44,310 [Listener at 0.0.0.0/13531] INFO  http.HttpServer2 (HttpServer2.java:addGlobalFilter(1030)) - Added global filter 'safety' (class=org.apache.hadoop.hdds.server.http.HttpServer2$QuotingInputFilter)
2021-10-05 13:24:44,311 [Listener at 0.0.0.0/13531] INFO  http.HttpServer2 (HttpServer2.java:addFilter(1006)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context scm
2021-10-05 13:24:44,311 [Listener at 0.0.0.0/13531] INFO  http.HttpServer2 (HttpServer2.java:addFilter(1014)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context logs
2021-10-05 13:24:44,311 [Listener at 0.0.0.0/13531] INFO  http.HttpServer2 (HttpServer2.java:addFilter(1014)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context static
2021-10-05 13:24:44,312 [Listener at 0.0.0.0/13531] INFO  http.HttpServer2 (HttpServer2.java:bindListener(1249)) - Jetty bound to port 13526
2021-10-05 13:24:44,312 [Listener at 0.0.0.0/13531] INFO  server.Server (Server.java:doStart(375)) - jetty-9.4.43.v20210629; built: 2021-06-30T11:07:22.254Z; git: 526006ecfa3af7f1a27ef3a288e2bef7ea9dd7e8; jvm 1.8.0_292-b10
2021-10-05 13:24:44,321 [Listener at 0.0.0.0/13531] INFO  server.session (DefaultSessionIdManager.java:doStart(334)) - DefaultSessionIdManager workerName=node0
2021-10-05 13:24:44,321 [Listener at 0.0.0.0/13531] INFO  server.session (DefaultSessionIdManager.java:doStart(339)) - No SessionScavenger set, using defaults
2021-10-05 13:24:44,321 [Listener at 0.0.0.0/13531] INFO  server.session (HouseKeeper.java:startScavenging(132)) - node0 Scavenging every 600000ms
2021-10-05 13:24:44,327 [Listener at 0.0.0.0/13531] INFO  handler.ContextHandler (ContextHandler.java:doStart(915)) - Started o.e.j.s.ServletContextHandler@27d74f45{logs,/logs,file:///home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/log,AVAILABLE}
2021-10-05 13:24:44,328 [Listener at 0.0.0.0/13531] INFO  handler.ContextHandler (ContextHandler.java:doStart(915)) - Started o.e.j.s.ServletContextHandler@36d61bbf{static,/static,file:///home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-classes/webapps/static,AVAILABLE}
2021-10-05 13:24:44,331 [Listener at 0.0.0.0/13531] INFO  handler.ContextHandler (ContextHandler.java:doStart(915)) - Started o.e.j.w.WebAppContext@9d7522{scm,/,file:///home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-classes/webapps/scm/,AVAILABLE}{file:/home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-classes/webapps/scm}
2021-10-05 13:24:44,336 [Listener at 0.0.0.0/13531] INFO  server.AbstractConnector (AbstractConnector.java:doStart(331)) - Started ServerConnector@66b46edd{HTTP/1.1, (http/1.1)}{0.0.0.0:13526}
2021-10-05 13:24:44,337 [Listener at 0.0.0.0/13531] INFO  server.Server (Server.java:doStart(415)) - Started @77996ms
2021-10-05 13:24:44,337 [Listener at 0.0.0.0/13531] WARN  impl.MetricsSystemImpl (MetricsSystemImpl.java:register(279)) - Sink prometheus already exists!
2021-10-05 13:24:44,339 [Listener at 0.0.0.0/13531] INFO  http.BaseHttpServer (BaseHttpServer.java:updateConnectorAddress(329)) - HTTP server of scm listening at http://0.0.0.0:13526
2021-10-05 13:24:44,339 [Listener at 0.0.0.0/13531] INFO  ozone.MiniOzoneHAClusterImpl (MiniOzoneHAClusterImpl.java:createSCMService(564)) - Started SCM RPC server at org.apache.hadoop.hdds.scm.server.SCMClientProtocolServer@5914bf5f
2021-10-05 13:24:44,340 [Listener at 0.0.0.0/13531] INFO  ha.SCMHANodeDetails (SCMHANodeDetails.java:loadSCMHAConfig(157)) - ServiceID for StorageContainerManager is scm-service-test1
2021-10-05 13:24:44,340 [Listener at 0.0.0.0/13531] INFO  ha.SCMHANodeDetails (SCMHANodeDetails.java:loadSCMHAConfig(168)) - ServiceID for StorageContainerManager is scm-service-test1
2021-10-05 13:24:44,340 [Listener at 0.0.0.0/13531] WARN  scm.ScmUtils (ScmUtils.java:logWarn(179)) - ConfigKey ozone.scm.block.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.block.client.port appended with serviceId and nodeId. If want to configure same port configure ozone.scm.block.client.port
2021-10-05 13:24:44,340 [Listener at 0.0.0.0/13531] WARN  scm.ScmUtils (ScmUtils.java:logWarn(179)) - ConfigKey ozone.scm.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.client.port appended with serviceId and nodeId. If want to configure same port configure ozone.scm.client.port
2021-10-05 13:24:44,340 [Listener at 0.0.0.0/13531] WARN  scm.ScmUtils (ScmUtils.java:logWarn(179)) - ConfigKey ozone.scm.datanode.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.datanode.port appended with serviceId and nodeId. If want to configure same port configure ozone.scm.datanode.port
2021-10-05 13:24:44,341 [Listener at 0.0.0.0/13531] WARN  scm.ScmUtils (ScmUtils.java:logWarn(179)) - ConfigKey ozone.scm.block.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.block.client.port appended with serviceId and nodeId. If want to configure same port configure ozone.scm.block.client.port
2021-10-05 13:24:44,341 [Listener at 0.0.0.0/13531] WARN  scm.ScmUtils (ScmUtils.java:logWarn(179)) - ConfigKey ozone.scm.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.client.port appended with serviceId and nodeId. If want to configure same port configure ozone.scm.client.port
2021-10-05 13:24:44,341 [Listener at 0.0.0.0/13531] WARN  scm.ScmUtils (ScmUtils.java:logWarn(179)) - ConfigKey ozone.scm.datanode.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.datanode.port appended with serviceId and nodeId. If want to configure same port configure ozone.scm.datanode.port
2021-10-05 13:24:44,341 [Listener at 0.0.0.0/13531] INFO  ha.SCMHANodeDetails (SCMHANodeDetails.java:loadSCMHAConfig(250)) - Found matching SCM address with SCMServiceId: scm-service-test1, SCMNodeId: scmNode-2, RPC Address: localhost:13538 and Ratis port: 13538
2021-10-05 13:24:44,341 [Listener at 0.0.0.0/13531] INFO  ha.SCMHANodeDetails (ConfUtils.java:setNodeSpecificConfigs(108)) - Setting configuration key ozone.scm.datanode.address with value of key ozone.scm.datanode.address.scm-service-test1.scmNode-2: 127.0.0.1:13539
2021-10-05 13:24:44,341 [Listener at 0.0.0.0/13531] INFO  ha.SCMHANodeDetails (ConfUtils.java:setNodeSpecificConfigs(108)) - Setting configuration key ozone.scm.block.client.address with value of key ozone.scm.block.client.address.scm-service-test1.scmNode-2: 127.0.0.1:13540
2021-10-05 13:24:44,341 [Listener at 0.0.0.0/13531] INFO  ha.SCMHANodeDetails (ConfUtils.java:setNodeSpecificConfigs(108)) - Setting configuration key ozone.scm.client.address with value of key ozone.scm.client.address.scm-service-test1.scmNode-2: 127.0.0.1:13541
2021-10-05 13:24:44,341 [Listener at 0.0.0.0/13531] INFO  ha.SCMHANodeDetails (ConfUtils.java:setNodeSpecificConfigs(108)) - Setting configuration key ozone.scm.ratis.port with value of key ozone.scm.ratis.port.scm-service-test1.scmNode-2: 13538
2021-10-05 13:24:44,341 [Listener at 0.0.0.0/13531] INFO  ha.SCMHANodeDetails (ConfUtils.java:setNodeSpecificConfigs(108)) - Setting configuration key ozone.scm.grpc.port with value of key ozone.scm.grpc.port.scm-service-test1.scmNode-2: 13542
2021-10-05 13:24:44,342 [Listener at 0.0.0.0/13531] INFO  ha.SCMHANodeDetails (ConfUtils.java:setNodeSpecificConfigs(108)) - Setting configuration key ozone.scm.http-address with value of key ozone.scm.http-address.scm-service-test1.scmNode-2: 127.0.0.1:13536
2021-10-05 13:24:44,342 [Listener at 0.0.0.0/13531] INFO  ha.SCMHANodeDetails (ConfUtils.java:setNodeSpecificConfigs(108)) - Setting configuration key ozone.scm.https-address with value of key ozone.scm.https-address.scm-service-test1.scmNode-2: 127.0.0.1:13537
2021-10-05 13:24:44,342 [Listener at 0.0.0.0/13531] INFO  ha.SCMHANodeDetails (ConfUtils.java:setNodeSpecificConfigs(108)) - Setting configuration key ozone.scm.address with value of key ozone.scm.address.scm-service-test1.scmNode-2: 127.0.0.1
2021-10-05 13:24:44,342 [Listener at 0.0.0.0/13531] WARN  scm.ScmUtils (ScmUtils.java:logWarn(179)) - ConfigKey ozone.scm.block.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.block.client.port appended with serviceId and nodeId. If want to configure same port configure ozone.scm.block.client.port
2021-10-05 13:24:44,342 [Listener at 0.0.0.0/13531] WARN  scm.ScmUtils (ScmUtils.java:logWarn(179)) - ConfigKey ozone.scm.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.client.port appended with serviceId and nodeId. If want to configure same port configure ozone.scm.client.port
2021-10-05 13:24:44,342 [Listener at 0.0.0.0/13531] WARN  scm.ScmUtils (ScmUtils.java:logWarn(179)) - ConfigKey ozone.scm.datanode.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.datanode.port appended with serviceId and nodeId. If want to configure same port configure ozone.scm.datanode.port
2021-10-05 13:24:44,342 [Listener at 0.0.0.0/13531] WARN  server.ServerUtils (ServerUtils.java:getScmDbDir(148)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2021-10-05 13:24:44,344 [Listener at 0.0.0.0/13531] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.client.port appended with serviceId and nodeId
2021-10-05 13:24:44,344 [Listener at 0.0.0.0/13531] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.block.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.block.client.port appended with serviceId and nodeId
2021-10-05 13:24:44,344 [Listener at 0.0.0.0/13531] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.datanode.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.datanode.port appended with serviceId and nodeId
2021-10-05 13:24:44,344 [Listener at 0.0.0.0/13531] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.client.port appended with serviceId and nodeId
2021-10-05 13:24:44,344 [Listener at 0.0.0.0/13531] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.block.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.block.client.port appended with serviceId and nodeId
2021-10-05 13:24:44,344 [Listener at 0.0.0.0/13531] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.datanode.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.datanode.port appended with serviceId and nodeId
2021-10-05 13:24:44,344 [Listener at 0.0.0.0/13531] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.client.port appended with serviceId and nodeId
2021-10-05 13:24:44,345 [Listener at 0.0.0.0/13531] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.block.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.block.client.port appended with serviceId and nodeId
2021-10-05 13:24:44,345 [Listener at 0.0.0.0/13531] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.datanode.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.datanode.port appended with serviceId and nodeId
2021-10-05 13:24:44,728 [EndpointStateMachine task thread for /127.0.0.1:15041 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15041. Already tried 6 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:24:44,788 [EndpointStateMachine task thread for /127.0.0.1:15031 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15031. Already tried 10 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:24:44,789 [EndpointStateMachine task thread for /127.0.0.1:15021 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15021. Already tried 10 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:24:45,728 [EndpointStateMachine task thread for /127.0.0.1:15041 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15041. Already tried 7 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:24:45,788 [EndpointStateMachine task thread for /127.0.0.1:15031 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15031. Already tried 11 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:24:45,789 [EndpointStateMachine task thread for /127.0.0.1:15021 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15021. Already tried 11 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:24:46,357 [Listener at 0.0.0.0/13531] INFO  retry.RetryInvocationHandler (RetryInvocationHandler.java:log(411)) - com.google.protobuf.ServiceException: java.net.ConnectException: Call From fv-az270-324/10.1.0.10 to localhost:13540 failed on connection exception: java.net.ConnectException: Connection refused; For more details see:  http://wiki.apache.org/hadoop/ConnectionRefused, while invoking $Proxy39.send over nodeId=scmNode-2,nodeAddress=/127.0.0.1:13540 after 1 failover attempts. Trying to failover after sleeping for 2000ms.
2021-10-05 13:24:46,729 [EndpointStateMachine task thread for /127.0.0.1:15041 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15041. Already tried 8 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:24:46,789 [EndpointStateMachine task thread for /127.0.0.1:15031 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15031. Already tried 12 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:24:46,790 [EndpointStateMachine task thread for /127.0.0.1:15021 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15021. Already tried 12 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:24:47,730 [EndpointStateMachine task thread for /127.0.0.1:15041 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15041. Already tried 9 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:24:47,789 [EndpointStateMachine task thread for /127.0.0.1:15031 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15031. Already tried 13 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:24:47,790 [EndpointStateMachine task thread for /127.0.0.1:15021 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15021. Already tried 13 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:24:48,359 [Listener at 0.0.0.0/13531] INFO  retry.RetryInvocationHandler (RetryInvocationHandler.java:log(411)) - com.google.protobuf.ServiceException: java.net.ConnectException: Call From fv-az270-324/10.1.0.10 to localhost:13550 failed on connection exception: java.net.ConnectException: Connection refused; For more details see:  http://wiki.apache.org/hadoop/ConnectionRefused, while invoking $Proxy39.send over nodeId=scmNode-3,nodeAddress=/127.0.0.1:13550 after 2 failover attempts. Trying to failover after sleeping for 2000ms.
2021-10-05 13:24:48,730 [EndpointStateMachine task thread for /127.0.0.1:15041 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15041. Already tried 10 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:24:48,790 [EndpointStateMachine task thread for /127.0.0.1:15031 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15031. Already tried 14 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:24:48,791 [EndpointStateMachine task thread for /127.0.0.1:15021 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15021. Already tried 14 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:24:49,054 [21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F-FollowerState] INFO  impl.FollowerState (FollowerState.java:run(134)) - 21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F-FollowerState: change to CANDIDATE, lastRpcElapsedTime:5157278634ns, electionTimeout:5138ms
2021-10-05 13:24:49,054 [21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F-FollowerState] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(108)) - 21490b65-0a55-46f3-b94a-dd719a327c14: shutdown 21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F-FollowerState
2021-10-05 13:24:49,054 [21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F-FollowerState] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(285)) - 21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F: changes role from  FOLLOWER to CANDIDATE at term 1 for changeToCandidate
2021-10-05 13:24:49,054 [21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F-FollowerState] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.leaderelection.pre-vote = false (custom)
2021-10-05 13:24:49,054 [21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F-FollowerState] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(130)) - 21490b65-0a55-46f3-b94a-dd719a327c14: start 21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F-LeaderElection15
2021-10-05 13:24:49,070 [21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F-LeaderElection15] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(306)) - 21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F-LeaderElection15 ELECTION round 0: submit vote requests at term 2 for 0: [21490b65-0a55-46f3-b94a-dd719a327c14|rpc:localhost:13528|admin:|client:|dataStream:|priority:0], old=null
2021-10-05 13:24:49,070 [21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F-LeaderElection15] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(308)) - 21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F-LeaderElection15 ELECTION round 0: result PASSED (term=2)
2021-10-05 13:24:49,070 [21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F-LeaderElection15] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(121)) - 21490b65-0a55-46f3-b94a-dd719a327c14: shutdown 21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F-LeaderElection15
2021-10-05 13:24:49,070 [21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F-LeaderElection15] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(285)) - 21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F: changes role from CANDIDATE to LEADER at term 2 for changeToLeader
2021-10-05 13:24:49,070 [21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F-LeaderElection15] INFO  ha.SCMStateMachine (SCMStateMachine.java:notifyLeaderChanged(252)) - current SCM becomes leader of term 2.
2021-10-05 13:24:49,070 [21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F-LeaderElection15] INFO  ha.SCMContext (SCMContext.java:updateLeaderAndTerm(88)) - update <isLeader,term> from <false,0> to <true,2>
2021-10-05 13:24:49,071 [21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F-LeaderElection15] INFO  server.RaftServer$Division (ServerState.java:setLeader(285)) - 21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F: change Leader from null to 21490b65-0a55-46f3-b94a-dd719a327c14 at term 2 for becomeLeader, leader elected after 5307ms
2021-10-05 13:24:49,071 [21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F-LeaderElection15] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.staging.catchup.gap = 1000 (default)
2021-10-05 13:24:49,071 [21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F-LeaderElection15] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.write.element-limit = 4096 (default)
2021-10-05 13:24:49,071 [21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F-LeaderElection15] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.write.byte-limit = 64MB (=67108864) (default)
2021-10-05 13:24:49,071 [21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F-LeaderElection15] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.watch.timeout = 10s (default)
2021-10-05 13:24:49,071 [21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F-LeaderElection15] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.watch.timeout.denomination = 1s (default)
2021-10-05 13:24:49,071 [21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F-LeaderElection15] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.watch.element-limit = 65536 (default)
2021-10-05 13:24:49,072 [21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F-LeaderElection15] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(130)) - 21490b65-0a55-46f3-b94a-dd719a327c14: start 21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F-LeaderStateImpl
2021-10-05 13:24:49,072 [21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F-LeaderElection15] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:rollLogSegment(399)) - 21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F-SegmentedRaftLogWorker: Rolling segment log-0_0 to index:0
2021-10-05 13:24:49,073 [21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(558)) - 21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F-SegmentedRaftLogWorker: Rolled log segment from /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-36b87918-66c6-4e2c-9c49-5aa8dab94a1f/scmNode-1/scm-ha/36b87918-66c6-4e2c-9c49-5aa8dab94a1f/current/log_inprogress_0 to /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-36b87918-66c6-4e2c-9c49-5aa8dab94a1f/scmNode-1/scm-ha/36b87918-66c6-4e2c-9c49-5aa8dab94a1f/current/log_0-0
2021-10-05 13:24:49,080 [21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(601)) - 21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F-SegmentedRaftLogWorker: created new log segment /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-36b87918-66c6-4e2c-9c49-5aa8dab94a1f/scmNode-1/scm-ha/36b87918-66c6-4e2c-9c49-5aa8dab94a1f/current/log_inprogress_1
2021-10-05 13:24:49,093 [21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F-LeaderElection15] INFO  server.RaftServer$Division (ServerState.java:setRaftConf(387)) - 21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F: set configuration 1: [21490b65-0a55-46f3-b94a-dd719a327c14|rpc:localhost:13528|admin:|client:|dataStream:|priority:0], old=null
2021-10-05 13:24:49,094 [21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F-StateMachineUpdater] INFO  ha.SCMContext (SCMContext.java:setLeaderReady(115)) - update <isLeaderReady> from <false> to <true>
2021-10-05 13:24:49,100 [21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F-StateMachineUpdater] INFO  pipeline.BackgroundPipelineCreator (BackgroundPipelineCreatorV2.java:notifyStatusChanged(264)) - Service BackgroundPipelineCreator transitions to RUNNING.
2021-10-05 13:24:49,109 [21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F-StateMachineUpdater] INFO  safemode.HealthyPipelineSafeModeRule (HealthyPipelineSafeModeRule.java:initializeRule(152)) - Refreshed total pipeline count is 0, healthy pipeline threshold count is 1
2021-10-05 13:24:49,109 [21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F-StateMachineUpdater] INFO  safemode.ContainerSafeModeRule (ContainerSafeModeRule.java:reInitializeRule(177)) - Refreshed one replica container threshold 0, currentThreshold 0
2021-10-05 13:24:49,109 [21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F-StateMachineUpdater] INFO  safemode.OneReplicaPipelineSafeModeRule (OneReplicaPipelineSafeModeRule.java:initializeRule(176)) - Refreshed Total pipeline count is 0, pipeline's with at least one datanode reported threshold count is 0
2021-10-05 13:24:49,109 [21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F-StateMachineUpdater] INFO  server.SCMDatanodeProtocolServer (SCMDatanodeProtocolServer.java:start(181)) - RPC server for DataNodes is listening at /0.0.0.0:13529
2021-10-05 13:24:49,117 [IPC Server listener on 13529] INFO  ipc.Server (Server.java:run(1344)) - IPC Server listener on 13529: starting
2021-10-05 13:24:49,142 [IPC Server Responder] INFO  ipc.Server (Server.java:run(1507)) - IPC Server Responder: starting
2021-10-05 13:24:49,731 [EndpointStateMachine task thread for /127.0.0.1:15041 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15041. Already tried 11 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:24:49,791 [EndpointStateMachine task thread for /127.0.0.1:15031 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15031. Already tried 0 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:24:49,792 [EndpointStateMachine task thread for /127.0.0.1:15021 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15021. Already tried 0 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:24:50,364 [Listener at 0.0.0.0/13531] INFO  server.StorageContainerManager (StorageContainerManager.java:scmBootstrap(987)) - SCM BootStrap  is successful for ClusterID 36b87918-66c6-4e2c-9c49-5aa8dab94a1f, SCMID 6d234f4d-474a-4c74-a9e9-8f3885fce584
2021-10-05 13:24:50,364 [Listener at 0.0.0.0/13531] INFO  server.StorageContainerManager (StorageContainerManager.java:scmBootstrap(989)) - Primary SCM Node ID 21490b65-0a55-46f3-b94a-dd719a327c14
2021-10-05 13:24:50,365 [Listener at 0.0.0.0/13531] INFO  ha.SCMHANodeDetails (SCMHANodeDetails.java:loadSCMHAConfig(157)) - ServiceID for StorageContainerManager is scm-service-test1
2021-10-05 13:24:50,365 [Listener at 0.0.0.0/13531] INFO  ha.SCMHANodeDetails (SCMHANodeDetails.java:loadSCMHAConfig(168)) - ServiceID for StorageContainerManager is scm-service-test1
2021-10-05 13:24:50,365 [Listener at 0.0.0.0/13531] WARN  scm.ScmUtils (ScmUtils.java:logWarn(179)) - ConfigKey ozone.scm.block.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.block.client.port appended with serviceId and nodeId. If want to configure same port configure ozone.scm.block.client.port
2021-10-05 13:24:50,365 [Listener at 0.0.0.0/13531] WARN  scm.ScmUtils (ScmUtils.java:logWarn(179)) - ConfigKey ozone.scm.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.client.port appended with serviceId and nodeId. If want to configure same port configure ozone.scm.client.port
2021-10-05 13:24:50,365 [Listener at 0.0.0.0/13531] WARN  scm.ScmUtils (ScmUtils.java:logWarn(179)) - ConfigKey ozone.scm.datanode.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.datanode.port appended with serviceId and nodeId. If want to configure same port configure ozone.scm.datanode.port
2021-10-05 13:24:50,366 [Listener at 0.0.0.0/13531] WARN  scm.ScmUtils (ScmUtils.java:logWarn(179)) - ConfigKey ozone.scm.block.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.block.client.port appended with serviceId and nodeId. If want to configure same port configure ozone.scm.block.client.port
2021-10-05 13:24:50,366 [Listener at 0.0.0.0/13531] WARN  scm.ScmUtils (ScmUtils.java:logWarn(179)) - ConfigKey ozone.scm.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.client.port appended with serviceId and nodeId. If want to configure same port configure ozone.scm.client.port
2021-10-05 13:24:50,366 [Listener at 0.0.0.0/13531] WARN  scm.ScmUtils (ScmUtils.java:logWarn(179)) - ConfigKey ozone.scm.datanode.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.datanode.port appended with serviceId and nodeId. If want to configure same port configure ozone.scm.datanode.port
2021-10-05 13:24:50,366 [Listener at 0.0.0.0/13531] INFO  ha.SCMHANodeDetails (SCMHANodeDetails.java:loadSCMHAConfig(250)) - Found matching SCM address with SCMServiceId: scm-service-test1, SCMNodeId: scmNode-2, RPC Address: localhost:13538 and Ratis port: 13538
2021-10-05 13:24:50,366 [Listener at 0.0.0.0/13531] INFO  ha.SCMHANodeDetails (ConfUtils.java:setNodeSpecificConfigs(108)) - Setting configuration key ozone.scm.datanode.address with value of key ozone.scm.datanode.address.scm-service-test1.scmNode-2: 127.0.0.1:13539
2021-10-05 13:24:50,366 [Listener at 0.0.0.0/13531] INFO  ha.SCMHANodeDetails (ConfUtils.java:setNodeSpecificConfigs(108)) - Setting configuration key ozone.scm.block.client.address with value of key ozone.scm.block.client.address.scm-service-test1.scmNode-2: 127.0.0.1:13540
2021-10-05 13:24:50,366 [Listener at 0.0.0.0/13531] INFO  ha.SCMHANodeDetails (ConfUtils.java:setNodeSpecificConfigs(108)) - Setting configuration key ozone.scm.client.address with value of key ozone.scm.client.address.scm-service-test1.scmNode-2: 127.0.0.1:13541
2021-10-05 13:24:50,366 [Listener at 0.0.0.0/13531] INFO  ha.SCMHANodeDetails (ConfUtils.java:setNodeSpecificConfigs(108)) - Setting configuration key ozone.scm.ratis.port with value of key ozone.scm.ratis.port.scm-service-test1.scmNode-2: 13538
2021-10-05 13:24:50,367 [Listener at 0.0.0.0/13531] INFO  ha.SCMHANodeDetails (ConfUtils.java:setNodeSpecificConfigs(108)) - Setting configuration key ozone.scm.grpc.port with value of key ozone.scm.grpc.port.scm-service-test1.scmNode-2: 13542
2021-10-05 13:24:50,367 [Listener at 0.0.0.0/13531] INFO  ha.SCMHANodeDetails (ConfUtils.java:setNodeSpecificConfigs(108)) - Setting configuration key ozone.scm.http-address with value of key ozone.scm.http-address.scm-service-test1.scmNode-2: 127.0.0.1:13536
2021-10-05 13:24:50,367 [Listener at 0.0.0.0/13531] INFO  ha.SCMHANodeDetails (ConfUtils.java:setNodeSpecificConfigs(108)) - Setting configuration key ozone.scm.https-address with value of key ozone.scm.https-address.scm-service-test1.scmNode-2: 127.0.0.1:13537
2021-10-05 13:24:50,367 [Listener at 0.0.0.0/13531] INFO  ha.SCMHANodeDetails (ConfUtils.java:setNodeSpecificConfigs(108)) - Setting configuration key ozone.scm.address with value of key ozone.scm.address.scm-service-test1.scmNode-2: 127.0.0.1
2021-10-05 13:24:50,367 [Listener at 0.0.0.0/13531] WARN  scm.ScmUtils (ScmUtils.java:logWarn(179)) - ConfigKey ozone.scm.block.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.block.client.port appended with serviceId and nodeId. If want to configure same port configure ozone.scm.block.client.port
2021-10-05 13:24:50,367 [Listener at 0.0.0.0/13531] WARN  scm.ScmUtils (ScmUtils.java:logWarn(179)) - ConfigKey ozone.scm.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.client.port appended with serviceId and nodeId. If want to configure same port configure ozone.scm.client.port
2021-10-05 13:24:50,367 [Listener at 0.0.0.0/13531] WARN  scm.ScmUtils (ScmUtils.java:logWarn(179)) - ConfigKey ozone.scm.datanode.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.datanode.port appended with serviceId and nodeId. If want to configure same port configure ozone.scm.datanode.port
2021-10-05 13:24:50,368 [Listener at 0.0.0.0/13531] WARN  server.ServerUtils (ServerUtils.java:getScmDbDir(148)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2021-10-05 13:24:50,368 [Listener at 0.0.0.0/13531] INFO  upgrade.AbstractLayoutVersionManager (AbstractLayoutVersionManager.java:init(79)) - Initializing Layout version manager with metadata layout = SCM_HA (version = 2), software layout = SCM_HA (version = 2)
2021-10-05 13:24:50,401 [Listener at 0.0.0.0/13531] INFO  reflections.Reflections (Reflections.java:scan(232)) - Reflections took 32 ms to scan 7 urls, producing 119 keys and 275 values 
2021-10-05 13:24:50,402 [Listener at 0.0.0.0/13531] WARN  utils.HAUtils (HAUtils.java:getMetaDir(342)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2021-10-05 13:24:50,403 [Listener at 0.0.0.0/13531] WARN  db.DBStoreBuilder (DBStoreBuilder.java:applyDBDefinition(145)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2021-10-05 13:24:50,576 [Listener at 0.0.0.0/13531] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchemaFromFile(129)) - Loading schema from [jar:file:/home/runner/.m2/repository/org/apache/ozone/hdds-common/1.2.0-SNAPSHOT/hdds-common-1.2.0-SNAPSHOT.jar!/network-topology-default.xml]
2021-10-05 13:24:50,576 [Listener at 0.0.0.0/13531] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchema(176)) - Loading network topology layer schema file
2021-10-05 13:24:50,598 [Listener at 0.0.0.0/13531] WARN  impl.MetricRegistriesImpl (MetricRegistriesImpl.java:addReporterRegistration(111)) - New reporters are added after registries were created. Some metrics will be missing from the reporter. Please add reporter before adding any new registry.
2021-10-05 13:24:50,600 [Listener at 0.0.0.0/13531] WARN  impl.MetricRegistriesImpl (MetricRegistriesImpl.java:addReporterRegistration(111)) - New reporters are added after registries were created. Some metrics will be missing from the reporter. Please add reporter before adding any new registry.
2021-10-05 13:24:50,601 [Listener at 0.0.0.0/13531] INFO  ha.SCMRatisServerImpl (SCMRatisServerImpl.java:<init>(87)) - starting Raft server for scm:6d234f4d-474a-4c74-a9e9-8f3885fce584
2021-10-05 13:24:50,602 [Listener at 0.0.0.0/13531] INFO  server.RaftServer (ConfUtils.java:logGet(44)) - raft.rpc.type = GRPC (default)
2021-10-05 13:24:50,602 [Listener at 0.0.0.0/13531] INFO  grpc.GrpcFactory (GrpcFactory.java:checkPooledByteBufAllocatorUseCacheForAllThreads(48)) - PERFORMANCE WARNING: useCacheForAllThreads is true that may cause Netty to create a lot garbage objects and, as a result, trigger GC.
	It is recommended to disable useCacheForAllThreads by setting -Dorg.apache.ratis.thirdparty.io.netty.allocator.useCacheForAllThreads=false in command line.
2021-10-05 13:24:50,602 [Listener at 0.0.0.0/13531] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(44)) - raft.grpc.admin.port = -1 (default)
2021-10-05 13:24:50,602 [Listener at 0.0.0.0/13531] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(44)) - raft.grpc.server.port = 13538 (custom)
2021-10-05 13:24:50,603 [Listener at 0.0.0.0/13531] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(44)) - raft.grpc.client.port = -1 (default)
2021-10-05 13:24:50,603 [Listener at 0.0.0.0/13531] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(44)) - raft.grpc.server.port = 13538 (custom)
2021-10-05 13:24:50,603 [Listener at 0.0.0.0/13531] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(44)) - raft.grpc.server.port = 13538 (custom)
2021-10-05 13:24:50,603 [Listener at 0.0.0.0/13531] INFO  server.GrpcService (ConfUtils.java:logGet(44)) - raft.grpc.message.size.max = 32m (=33554432) (custom)
2021-10-05 13:24:50,603 [Listener at 0.0.0.0/13531] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2021-10-05 13:24:50,603 [Listener at 0.0.0.0/13531] INFO  server.GrpcService (ConfUtils.java:logGet(44)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2021-10-05 13:24:50,603 [Listener at 0.0.0.0/13531] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.request.timeout = 30000ms (custom)
2021-10-05 13:24:50,605 [Listener at 0.0.0.0/13531] INFO  impl.DataStreamServerImpl (ConfUtils.java:logGet(44)) - raft.datastream.type = DISABLED (default)
2021-10-05 13:24:50,607 [Listener at 0.0.0.0/13531] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.slowness.timeout = 120000ms (custom)
2021-10-05 13:24:50,607 [Listener at 0.0.0.0/13531] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.leaderelection.leader.step-down.wait-time = 10s (default)
2021-10-05 13:24:50,607 [Listener at 0.0.0.0/13531] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.storage.dir = [/home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-36b87918-66c6-4e2c-9c49-5aa8dab94a1f/scmNode-2/scm-ha] (custom)
2021-10-05 13:24:50,612 [Listener at 0.0.0.0/13531] INFO  server.RaftServer (RaftServerProxy.java:addNew(95)) - 6d234f4d-474a-4c74-a9e9-8f3885fce584: addNew group-5AA8DAB94A1F:[] returns group-5AA8DAB94A1F:java.util.concurrent.CompletableFuture@36971bef[Not completed]
2021-10-05 13:24:50,612 [pool-208-thread-1] INFO  server.RaftServer$Division (RaftServerImpl.java:<init>(181)) - 6d234f4d-474a-4c74-a9e9-8f3885fce584: new RaftServerImpl for group-5AA8DAB94A1F:[] with SCMStateMachine:uninitialized
2021-10-05 13:24:50,614 [pool-208-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.timeout.min = 5000ms (custom)
2021-10-05 13:24:50,614 [pool-208-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.timeout.max = 5200ms (custom)
2021-10-05 13:24:50,614 [pool-208-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.sleep.time = 25ms (default)
2021-10-05 13:24:50,614 [pool-208-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.slowness.timeout = 120000ms (custom)
2021-10-05 13:24:50,614 [pool-208-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.leaderelection.leader.step-down.wait-time = 10s (default)
2021-10-05 13:24:50,614 [pool-208-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.sleep.deviation.threshold = 300ms (default)
2021-10-05 13:24:50,614 [pool-208-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.appender.install.snapshot.enabled = false (custom)
2021-10-05 13:24:50,614 [pool-208-thread-1] INFO  server.RaftServer$Division (ServerState.java:<init>(105)) - 6d234f4d-474a-4c74-a9e9-8f3885fce584@group-5AA8DAB94A1F: ConfigurationManager, init=-1: [], old=null, confs=<EMPTY_MAP>
2021-10-05 13:24:50,614 [pool-208-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.storage.dir = [/home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-36b87918-66c6-4e2c-9c49-5aa8dab94a1f/scmNode-2/scm-ha] (custom)
2021-10-05 13:24:50,614 [pool-208-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.corruption.policy = EXCEPTION (default)
2021-10-05 13:24:50,614 [pool-208-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.storage.free-space.min = 0MB (=0) (default)
2021-10-05 13:24:50,615 [pool-208-thread-1] INFO  storage.RaftStorageDirectory (RaftStorageDirectoryImpl.java:analyzeStorage(135)) - The storage directory /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-36b87918-66c6-4e2c-9c49-5aa8dab94a1f/scmNode-2/scm-ha/36b87918-66c6-4e2c-9c49-5aa8dab94a1f does not exist. Creating ...
2021-10-05 13:24:50,625 [pool-208-thread-1] INFO  storage.RaftStorageDirectory (RaftStorageDirectoryImpl.java:tryLock(230)) - Lock on /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-36b87918-66c6-4e2c-9c49-5aa8dab94a1f/scmNode-2/scm-ha/36b87918-66c6-4e2c-9c49-5aa8dab94a1f/in_use.lock acquired by nodename 17451@fv-az270-324
2021-10-05 13:24:50,630 [pool-208-thread-1] INFO  storage.RaftStorage (RaftStorageImpl.java:format(89)) - Storage directory /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-36b87918-66c6-4e2c-9c49-5aa8dab94a1f/scmNode-2/scm-ha/36b87918-66c6-4e2c-9c49-5aa8dab94a1f has been successfully formatted.
2021-10-05 13:24:50,630 [pool-208-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.notification.no-leader.timeout = 60s (default)
2021-10-05 13:24:50,630 [pool-208-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.use.memory = false (default)
2021-10-05 13:24:50,630 [pool-208-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.purge.gap = 5 (custom)
2021-10-05 13:24:50,630 [pool-208-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2021-10-05 13:24:50,630 [pool-208-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.segment.size.max = 16384 (custom)
2021-10-05 13:24:50,631 [pool-208-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.segment.cache.num.max = 2 (custom)
2021-10-05 13:24:50,631 [pool-208-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.segment.cache.size.max = 200MB (=209715200) (default)
2021-10-05 13:24:50,631 [pool-208-thread-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:<init>(182)) - new 6d234f4d-474a-4c74-a9e9-8f3885fce584@group-5AA8DAB94A1F-SegmentedRaftLogWorker for RaftStorageImpl:Storage Directory /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-36b87918-66c6-4e2c-9c49-5aa8dab94a1f/scmNode-2/scm-ha/36b87918-66c6-4e2c-9c49-5aa8dab94a1f
2021-10-05 13:24:50,631 [pool-208-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.queue.byte-limit = 64MB (=67108864) (default)
2021-10-05 13:24:50,631 [pool-208-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.queue.element-limit = 4096 (default)
2021-10-05 13:24:50,631 [pool-208-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.segment.size.max = 16384 (custom)
2021-10-05 13:24:50,631 [pool-208-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.preallocated.size = 16384 (custom)
2021-10-05 13:24:50,631 [pool-208-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.force.sync.num = 128 (default)
2021-10-05 13:24:50,631 [pool-208-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.statemachine.data.sync = true (default)
2021-10-05 13:24:50,631 [pool-208-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2021-10-05 13:24:50,631 [pool-208-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2021-10-05 13:24:50,632 [pool-208-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.write.buffer.size = 64KB (=65536) (default)
2021-10-05 13:24:50,632 [pool-208-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.statemachine.data.caching.enabled = false (default)
2021-10-05 13:24:50,632 [pool-208-thread-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:lambda$new$0(133)) - 6d234f4d-474a-4c74-a9e9-8f3885fce584@group-5AA8DAB94A1F-SegmentedRaftLogWorker: flushIndex: setUnconditionally 0 -> -1
2021-10-05 13:24:50,632 [pool-208-thread-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:lambda$new$0(133)) - 6d234f4d-474a-4c74-a9e9-8f3885fce584@group-5AA8DAB94A1F-SegmentedRaftLogWorker: safeCacheEvictIndex: setUnconditionally 0 -> -1
2021-10-05 13:24:50,635 [pool-208-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2021-10-05 13:24:50,635 [pool-208-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.snapshot.auto.trigger.threshold = 5 (custom)
2021-10-05 13:24:50,635 [pool-208-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.snapshot.retention.file.num = -1 (default)
2021-10-05 13:24:50,635 [pool-208-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.purge.upto.snapshot.index = true (custom)
2021-10-05 13:24:50,635 [pool-208-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.retrycache.expirytime = 60000ms (default)
2021-10-05 13:24:50,635 [pool-208-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.retrycache.statistics.expirytime = 100μs (default)
2021-10-05 13:24:50,638 [Listener at 0.0.0.0/13531] INFO  ha.SCMSnapshotProvider (SCMSnapshotProvider.java:<init>(66)) - Initializing SCM Snapshot Provider
2021-10-05 13:24:50,638 [Listener at 0.0.0.0/13531] WARN  server.ServerUtils (ServerUtils.java:getDefaultRatisDirectory(237)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2021-10-05 13:24:50,639 [Listener at 0.0.0.0/13531] WARN  ha.SCMHAUtils (SCMHAUtils.java:getSCMRatisSnapshotDirectory(146)) - SCM snapshot dir is not configured. Falling back to ozone.metadata.dirs config
2021-10-05 13:24:50,640 [Listener at 0.0.0.0/13531] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:upgradeToSequenceId(347)) - upgrade localId to 107544261427200000
2021-10-05 13:24:50,640 [Listener at 0.0.0.0/13531] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:upgradeToSequenceId(357)) - upgrade delTxnId to 0
2021-10-05 13:24:50,640 [Listener at 0.0.0.0/13531] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:upgradeToSequenceId(371)) - upgrade containerId to 0
2021-10-05 13:24:50,640 [Listener at 0.0.0.0/13531] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:<init>(218)) - Init the HA SequenceIdGenerator.
2021-10-05 13:24:50,641 [Listener at 0.0.0.0/13531] WARN  server.ServerUtils (ServerUtils.java:sanitizeUserArgs(73)) - ozone.scm.stale.node.interval value = 300000 is larger than max = 100000 based on the key value of ozone.scm.heartbeat.thread.interval, reset to the max value 100000.
2021-10-05 13:24:50,641 [Listener at 0.0.0.0/13531] WARN  server.ServerUtils (ServerUtils.java:sanitizeUserArgs(73)) - ozone.scm.stale.node.interval value = 300000 is larger than max = 100000 based on the key value of ozone.scm.heartbeat.thread.interval, reset to the max value 100000.
2021-10-05 13:24:50,643 [Listener at 0.0.0.0/13531] INFO  node.SCMNodeManager (SCMNodeManager.java:<init>(144)) - Entering startup safe mode.
2021-10-05 13:24:50,644 [Listener at 0.0.0.0/13531] INFO  algorithms.ContainerPlacementPolicyFactory (ContainerPlacementPolicyFactory.java:getPolicy(60)) - Create container placement policy of type org.apache.hadoop.hdds.scm.container.placement.algorithms.SCMContainerPlacementRandom
2021-10-05 13:24:50,644 [Listener at 0.0.0.0/13531] INFO  pipeline.PipelineStateManagerImpl (PipelineStateManagerImpl.java:initialize(78)) - No pipeline exists in current db
2021-10-05 13:24:50,644 [Listener at 0.0.0.0/13531] INFO  algorithms.LeaderChoosePolicyFactory (LeaderChoosePolicyFactory.java:getPolicy(57)) - Create leader choose policy of type org.apache.hadoop.hdds.scm.pipeline.leader.choose.algorithms.MinLeaderCountChoosePolicy
2021-10-05 13:24:50,645 [Listener at 0.0.0.0/13531] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(43)) - Registering service BackgroundPipelineCreator.
2021-10-05 13:24:50,645 [Listener at 0.0.0.0/13531] INFO  pipeline.BackgroundPipelineCreator (BackgroundPipelineCreatorV2.java:start(130)) - Starting RatisPipelineUtilsThread.
2021-10-05 13:24:50,654 [Listener at 0.0.0.0/13531] INFO  algorithms.PipelineChoosePolicyFactory (PipelineChoosePolicyFactory.java:createPipelineChoosePolicyFromClass(73)) - Create pipeline choose policy of type org.apache.hadoop.hdds.scm.pipeline.choose.algorithms.RandomPipelineChoosePolicy
2021-10-05 13:24:50,656 [Listener at 0.0.0.0/13531] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(43)) - Registering service SCMBlockDeletingService.
2021-10-05 13:24:50,656 [Listener at 0.0.0.0/13531] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(43)) - Registering service ReplicationManager.
2021-10-05 13:24:50,656 [Listener at 0.0.0.0/13531] INFO  container.ReplicationManager (ReplicationManager.java:start(319)) - Starting Replication Monitor Thread.
2021-10-05 13:24:50,660 [Listener at 0.0.0.0/13531] INFO  safemode.ContainerSafeModeRule (ContainerSafeModeRule.java:<init>(89)) - containers with one replica threshold count 0
2021-10-05 13:24:50,661 [Listener at 0.0.0.0/13531] INFO  safemode.HealthyPipelineSafeModeRule (HealthyPipelineSafeModeRule.java:initializeRule(156)) - Total pipeline count is 0, healthy pipeline threshold count is 1
2021-10-05 13:24:50,662 [Listener at 0.0.0.0/13531] INFO  safemode.OneReplicaPipelineSafeModeRule (OneReplicaPipelineSafeModeRule.java:initializeRule(180)) - Total pipeline count is 0, pipeline's with at least one datanode reported threshold count is 0
2021-10-05 13:24:50,665 [Listener at 0.0.0.0/13531] INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(90)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 2000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false.
2021-10-05 13:24:50,675 [Socket Reader #1 for port 13539] INFO  ipc.Server (Server.java:run(1265)) - Starting Socket Reader #1 for port 13539
2021-10-05 13:24:50,684 [ReplicationMonitor] INFO  container.ReplicationManager (ReplicationManager.java:processAll(371)) - Replication Monitor Thread took 0 milliseconds for processing 0 containers.
2021-10-05 13:24:50,692 [Listener at 0.0.0.0/13539] INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(90)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 2000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false.
2021-10-05 13:24:50,693 [Socket Reader #1 for port 13540] INFO  ipc.Server (Server.java:run(1265)) - Starting Socket Reader #1 for port 13540
2021-10-05 13:24:50,704 [Listener at 0.0.0.0/13540] INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(90)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 2000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false.
2021-10-05 13:24:50,711 [Socket Reader #1 for port 13541] INFO  ipc.Server (Server.java:run(1265)) - Starting Socket Reader #1 for port 13541
2021-10-05 13:24:50,735 [EndpointStateMachine task thread for /127.0.0.1:15041 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15041. Already tried 12 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:24:50,781 [Listener at 0.0.0.0/13541] INFO  algorithms.ContainerPlacementPolicyFactory (ContainerPlacementPolicyFactory.java:getPolicy(60)) - Create container placement policy of type org.apache.hadoop.hdds.scm.container.placement.algorithms.SCMContainerPlacementRandom
2021-10-05 13:24:50,792 [EndpointStateMachine task thread for /127.0.0.1:15031 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15031. Already tried 1 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:24:50,792 [EndpointStateMachine task thread for /127.0.0.1:15021 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15021. Already tried 1 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:24:50,793 [Listener at 0.0.0.0/13541] INFO  server.StorageContainerManager (StorageContainerManager.java:<init>(388)) - 
Container Balancer status:
Key                            Value
Running                        false
Container Balancer Configuration values:
Key                                                Value
Threshold                                          0.1
Max Datanodes to Involve per Iteration(ratio)      0.2
Max Size to Move per Iteration                     32212254720B

2021-10-05 13:24:50,793 [Listener at 0.0.0.0/13541] WARN  events.EventQueue (EventQueue.java:fireEvent(194)) - No event handler registered for event TypedEvent{payloadType=SafeModeStatus, name='Safe mode status'}
2021-10-05 13:24:50,793 [Listener at 0.0.0.0/13541] INFO  ha.SCMContext (SCMContext.java:updateSafeModeStatus(205)) - Update SafeModeStatus from SafeModeStatus{safeModeStatus=true, preCheckPassed=false} to SafeModeStatus{safeModeStatus=true, preCheckPassed=false}.
2021-10-05 13:24:50,794 [Listener at 0.0.0.0/13541] INFO  server.StorageContainerManager (StorageContainerManager.java:start(1303)) - StorageContainerLocationProtocol RPC server is listening at /0.0.0.0:13541
2021-10-05 13:24:50,794 [Listener at 0.0.0.0/13541] INFO  ha.SCMRatisServerImpl (SCMRatisServerImpl.java:start(177)) - starting ratis server 0.0.0.0:13538
2021-10-05 13:24:50,794 [Listener at 0.0.0.0/13541] INFO  server.RaftServer$Division (RaftServerImpl.java:start(299)) - 6d234f4d-474a-4c74-a9e9-8f3885fce584@group-5AA8DAB94A1F: start with initializing state, conf=-1: [], old=null
2021-10-05 13:24:50,794 [Listener at 0.0.0.0/13541] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(285)) - 6d234f4d-474a-4c74-a9e9-8f3885fce584@group-5AA8DAB94A1F: changes role from      null to FOLLOWER at term 0 for startInitializing
2021-10-05 13:24:50,794 [Listener at 0.0.0.0/13541] INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-5AA8DAB94A1F,id=6d234f4d-474a-4c74-a9e9-8f3885fce584
2021-10-05 13:24:50,811 [Listener at 0.0.0.0/13541] INFO  server.RaftServer (RaftServerProxy.java:lambda$start$5(374)) - 6d234f4d-474a-4c74-a9e9-8f3885fce584: start RPC server
2021-10-05 13:24:50,812 [Listener at 0.0.0.0/13541] INFO  server.GrpcService (GrpcService.java:startImpl(253)) - 6d234f4d-474a-4c74-a9e9-8f3885fce584: GrpcService started, listening on 13538
2021-10-05 13:24:50,828 [org.apache.ratis.util.JvmPauseMonitor$$Lambda$499/1586779822@d2df0f5] INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(103)) - JvmPauseMonitor-6d234f4d-474a-4c74-a9e9-8f3885fce584: Started
2021-10-05 13:24:50,828 [Listener at 0.0.0.0/13541] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.client.port appended with serviceId and nodeId
2021-10-05 13:24:50,828 [Listener at 0.0.0.0/13541] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.block.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.block.client.port appended with serviceId and nodeId
2021-10-05 13:24:50,828 [Listener at 0.0.0.0/13541] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.datanode.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.datanode.port appended with serviceId and nodeId
2021-10-05 13:24:50,829 [Listener at 0.0.0.0/13541] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.client.port appended with serviceId and nodeId
2021-10-05 13:24:50,829 [Listener at 0.0.0.0/13541] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.block.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.block.client.port appended with serviceId and nodeId
2021-10-05 13:24:50,829 [Listener at 0.0.0.0/13541] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.datanode.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.datanode.port appended with serviceId and nodeId
2021-10-05 13:24:50,829 [Listener at 0.0.0.0/13541] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.client.port appended with serviceId and nodeId
2021-10-05 13:24:50,829 [Listener at 0.0.0.0/13541] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.block.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.block.client.port appended with serviceId and nodeId
2021-10-05 13:24:50,829 [Listener at 0.0.0.0/13541] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.datanode.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.datanode.port appended with serviceId and nodeId
2021-10-05 13:24:50,845 [IPC Server handler 3 on default port 13530] INFO  ha.SCMRatisServerImpl (SCMRatisServerImpl.java:addSCM(291)) - 21490b65-0a55-46f3-b94a-dd719a327c14: Submitting SetConfiguration request to Ratis server with new SCM peers list: [21490b65-0a55-46f3-b94a-dd719a327c14|rpc:localhost:13528|admin:|client:|dataStream:|priority:0, 6d234f4d-474a-4c74-a9e9-8f3885fce584|rpc:localhost:13538|priority:0]
2021-10-05 13:24:50,845 [IPC Server handler 3 on default port 13530] INFO  server.RaftServer$Division (RaftServerImpl.java:setConfigurationAsync(971)) - 21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F: receive setConfiguration SetConfigurationRequest:client-474D5F38DF1B->21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F, cid=0, seq=0, RW, null, peers:[21490b65-0a55-46f3-b94a-dd719a327c14|rpc:localhost:13528|admin:|client:|dataStream:|priority:0, 6d234f4d-474a-4c74-a9e9-8f3885fce584|rpc:localhost:13538|priority:0]
2021-10-05 13:24:50,845 [IPC Server handler 3 on default port 13530] INFO  server.RaftServer$Division (LeaderStateImpl.java:startSetConfiguration(345)) - 21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F-LeaderStateImpl: startSetConfiguration SetConfigurationRequest:client-474D5F38DF1B->21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F, cid=0, seq=0, RW, null, peers:[21490b65-0a55-46f3-b94a-dd719a327c14|rpc:localhost:13528|admin:|client:|dataStream:|priority:0, 6d234f4d-474a-4c74-a9e9-8f3885fce584|rpc:localhost:13538|priority:0]
2021-10-05 13:24:50,846 [IPC Server handler 3 on default port 13530] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2021-10-05 13:24:50,846 [IPC Server handler 3 on default port 13530] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2021-10-05 13:24:50,846 [IPC Server handler 3 on default port 13530] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.appender.buffer.element-limit = 1024 (custom)
2021-10-05 13:24:50,847 [IPC Server handler 3 on default port 13530] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(44)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2021-10-05 13:24:50,848 [IPC Server handler 3 on default port 13530] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.request.timeout = 30000ms (custom)
2021-10-05 13:24:50,848 [IPC Server handler 3 on default port 13530] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.appender.install.snapshot.enabled = false (custom)
2021-10-05 13:24:50,896 [grpc-default-executor-0] INFO  ha.SCMStateMachine (SCMStateMachine.java:notifyLeaderChanged(248)) - leader changed, yet current SCM is still follower.
2021-10-05 13:24:50,897 [grpc-default-executor-0] INFO  server.RaftServer$Division (ServerState.java:setLeader(285)) - 6d234f4d-474a-4c74-a9e9-8f3885fce584@group-5AA8DAB94A1F: change Leader from null to 21490b65-0a55-46f3-b94a-dd719a327c14 at term 2 for appendEntries, leader elected after 266ms
2021-10-05 13:24:50,897 [grpc-default-executor-0] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(130)) - 6d234f4d-474a-4c74-a9e9-8f3885fce584: start 6d234f4d-474a-4c74-a9e9-8f3885fce584@group-5AA8DAB94A1F-FollowerState
2021-10-05 13:24:50,916 [grpc-default-executor-2] INFO  server.RaftServer$Division (ServerState.java:setRaftConf(387)) - 6d234f4d-474a-4c74-a9e9-8f3885fce584@group-5AA8DAB94A1F: set configuration 0: [21490b65-0a55-46f3-b94a-dd719a327c14|rpc:localhost:13528|admin:|client:|dataStream:|priority:0], old=null
2021-10-05 13:24:50,916 [grpc-default-executor-2] INFO  server.RaftServer$Division (ServerState.java:setRaftConf(387)) - 6d234f4d-474a-4c74-a9e9-8f3885fce584@group-5AA8DAB94A1F: set configuration 1: [21490b65-0a55-46f3-b94a-dd719a327c14|rpc:localhost:13528|admin:|client:|dataStream:|priority:0], old=null
2021-10-05 13:24:50,917 [grpc-default-executor-2] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:startLogSegment(394)) - 6d234f4d-474a-4c74-a9e9-8f3885fce584@group-5AA8DAB94A1F-SegmentedRaftLogWorker: Starting segment from index:0
2021-10-05 13:24:50,917 [grpc-default-executor-2] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:rollLogSegment(399)) - 6d234f4d-474a-4c74-a9e9-8f3885fce584@group-5AA8DAB94A1F-SegmentedRaftLogWorker: Rolling segment log-0_0 to index:0
2021-10-05 13:24:50,927 [6d234f4d-474a-4c74-a9e9-8f3885fce584@group-5AA8DAB94A1F-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(601)) - 6d234f4d-474a-4c74-a9e9-8f3885fce584@group-5AA8DAB94A1F-SegmentedRaftLogWorker: created new log segment /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-36b87918-66c6-4e2c-9c49-5aa8dab94a1f/scmNode-2/scm-ha/36b87918-66c6-4e2c-9c49-5aa8dab94a1f/current/log_inprogress_0
2021-10-05 13:24:50,931 [6d234f4d-474a-4c74-a9e9-8f3885fce584@group-5AA8DAB94A1F-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(558)) - 6d234f4d-474a-4c74-a9e9-8f3885fce584@group-5AA8DAB94A1F-SegmentedRaftLogWorker: Rolled log segment from /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-36b87918-66c6-4e2c-9c49-5aa8dab94a1f/scmNode-2/scm-ha/36b87918-66c6-4e2c-9c49-5aa8dab94a1f/current/log_inprogress_0 to /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-36b87918-66c6-4e2c-9c49-5aa8dab94a1f/scmNode-2/scm-ha/36b87918-66c6-4e2c-9c49-5aa8dab94a1f/current/log_0-0
2021-10-05 13:24:50,932 [6d234f4d-474a-4c74-a9e9-8f3885fce584@group-5AA8DAB94A1F-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(601)) - 6d234f4d-474a-4c74-a9e9-8f3885fce584@group-5AA8DAB94A1F-SegmentedRaftLogWorker: created new log segment /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-36b87918-66c6-4e2c-9c49-5aa8dab94a1f/scmNode-2/scm-ha/36b87918-66c6-4e2c-9c49-5aa8dab94a1f/current/log_inprogress_1
2021-10-05 13:24:50,940 [6d234f4d-474a-4c74-a9e9-8f3885fce584@group-5AA8DAB94A1F-StateMachineUpdater] INFO  safemode.HealthyPipelineSafeModeRule (HealthyPipelineSafeModeRule.java:initializeRule(152)) - Refreshed total pipeline count is 0, healthy pipeline threshold count is 1
2021-10-05 13:24:50,940 [6d234f4d-474a-4c74-a9e9-8f3885fce584@group-5AA8DAB94A1F-StateMachineUpdater] INFO  safemode.ContainerSafeModeRule (ContainerSafeModeRule.java:reInitializeRule(177)) - Refreshed one replica container threshold 0, currentThreshold 0
2021-10-05 13:24:50,940 [6d234f4d-474a-4c74-a9e9-8f3885fce584@group-5AA8DAB94A1F-StateMachineUpdater] INFO  safemode.OneReplicaPipelineSafeModeRule (OneReplicaPipelineSafeModeRule.java:initializeRule(176)) - Refreshed Total pipeline count is 0, pipeline's with at least one datanode reported threshold count is 0
2021-10-05 13:24:50,940 [6d234f4d-474a-4c74-a9e9-8f3885fce584@group-5AA8DAB94A1F-StateMachineUpdater] INFO  server.SCMDatanodeProtocolServer (SCMDatanodeProtocolServer.java:start(181)) - RPC server for DataNodes is listening at /0.0.0.0:13539
2021-10-05 13:24:50,943 [IPC Server listener on 13539] INFO  ipc.Server (Server.java:run(1344)) - IPC Server listener on 13539: starting
2021-10-05 13:24:50,946 [21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F-LeaderStateImpl] INFO  server.RaftServer$Division (ServerState.java:setRaftConf(387)) - 21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F: set configuration 3: [21490b65-0a55-46f3-b94a-dd719a327c14|rpc:localhost:13528|admin:|client:|dataStream:|priority:0, 6d234f4d-474a-4c74-a9e9-8f3885fce584|rpc:localhost:13538|priority:0], old=[21490b65-0a55-46f3-b94a-dd719a327c14|rpc:localhost:13528|admin:|client:|dataStream:|priority:0]
2021-10-05 13:24:50,947 [grpc-default-executor-2] INFO  server.RaftServer$Division (ServerState.java:setRaftConf(387)) - 6d234f4d-474a-4c74-a9e9-8f3885fce584@group-5AA8DAB94A1F: set configuration 3: [21490b65-0a55-46f3-b94a-dd719a327c14|rpc:localhost:13528|admin:|client:|dataStream:|priority:0, 6d234f4d-474a-4c74-a9e9-8f3885fce584|rpc:localhost:13538|admin:|client:|dataStream:|priority:0], old=[21490b65-0a55-46f3-b94a-dd719a327c14|rpc:localhost:13528|admin:|client:|dataStream:|priority:0]
2021-10-05 13:24:50,949 [21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F-LeaderStateImpl] INFO  server.RaftServer$Division (ServerState.java:setRaftConf(387)) - 21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F: set configuration 5: [21490b65-0a55-46f3-b94a-dd719a327c14|rpc:localhost:13528|admin:|client:|dataStream:|priority:0, 6d234f4d-474a-4c74-a9e9-8f3885fce584|rpc:localhost:13538|priority:0], old=null
2021-10-05 13:24:50,950 [grpc-default-executor-2] INFO  server.RaftServer$Division (ServerState.java:setRaftConf(387)) - 6d234f4d-474a-4c74-a9e9-8f3885fce584@group-5AA8DAB94A1F: set configuration 5: [21490b65-0a55-46f3-b94a-dd719a327c14|rpc:localhost:13528|admin:|client:|dataStream:|priority:0, 6d234f4d-474a-4c74-a9e9-8f3885fce584|rpc:localhost:13538|admin:|client:|dataStream:|priority:0], old=null
2021-10-05 13:24:50,952 [IPC Server Responder] INFO  ipc.Server (Server.java:run(1507)) - IPC Server Responder: starting
2021-10-05 13:24:50,987 [IPC Server handler 3 on default port 13530] INFO  ha.SCMRatisServerImpl (SCMRatisServerImpl.java:addSCM(302)) - Successfully added new SCM: 6d234f4d-474a-4c74-a9e9-8f3885fce584.
2021-10-05 13:24:50,988 [21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F-StateMachineUpdater] INFO  ha.SCMStateMachine (SCMStateMachine.java:takeSnapshot(290)) - Current Snapshot Index 5, takeSnapshot took 0 ms
2021-10-05 13:24:50,988 [21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:takeSnapshot(281)) - 21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F-StateMachineUpdater: Took a snapshot at index 5
2021-10-05 13:24:50,988 [21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:lambda$new$0(89)) - 21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F-StateMachineUpdater: snapshotIndex: updateIncreasingly -1 -> 5
2021-10-05 13:24:50,988 [21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:purge(306)) - 21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F-SegmentedRaftLog: purge 5
2021-10-05 13:24:50,988 [21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - 21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F-SegmentedRaftLog: snapshotIndex: updateIncreasingly -1 -> 5
2021-10-05 13:24:50,989 [Listener at 0.0.0.0/13541] INFO  ha.SCMHAManagerImpl (SCMHAManagerImpl.java:start(116)) - Successfully added SCM scmNode-2 to group group-5AA8DAB94A1F:[21490b65-0a55-46f3-b94a-dd719a327c14|rpc:localhost:13528|admin:|client:|dataStream:|priority:0, 6d234f4d-474a-4c74-a9e9-8f3885fce584|rpc:localhost:13538|admin:|client:|dataStream:|priority:0]
2021-10-05 13:24:50,989 [Listener at 0.0.0.0/13541] INFO  ha.InterSCMGrpcService (InterSCMGrpcProtocolService.java:start(94)) - Starting SCM Grpc Service at port 13542
2021-10-05 13:24:50,989 [21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F-SegmentedRaftLogWorker] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - 21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F-SegmentedRaftLog: purgeIndex: updateToMax old=-1, new=0, updated? true
2021-10-05 13:24:51,001 [Listener at 0.0.0.0/13541] INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:init(158)) - StorageContainerManager metrics system started (again)
2021-10-05 13:24:51,012 [6d234f4d-474a-4c74-a9e9-8f3885fce584@group-5AA8DAB94A1F-StateMachineUpdater] INFO  ha.SCMStateMachine (SCMStateMachine.java:takeSnapshot(290)) - Current Snapshot Index 5, takeSnapshot took 0 ms
2021-10-05 13:24:51,012 [6d234f4d-474a-4c74-a9e9-8f3885fce584@group-5AA8DAB94A1F-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:takeSnapshot(281)) - 6d234f4d-474a-4c74-a9e9-8f3885fce584@group-5AA8DAB94A1F-StateMachineUpdater: Took a snapshot at index 5
2021-10-05 13:24:51,012 [6d234f4d-474a-4c74-a9e9-8f3885fce584@group-5AA8DAB94A1F-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:lambda$new$0(89)) - 6d234f4d-474a-4c74-a9e9-8f3885fce584@group-5AA8DAB94A1F-StateMachineUpdater: snapshotIndex: updateIncreasingly -1 -> 5
2021-10-05 13:24:51,012 [6d234f4d-474a-4c74-a9e9-8f3885fce584@group-5AA8DAB94A1F-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:purge(306)) - 6d234f4d-474a-4c74-a9e9-8f3885fce584@group-5AA8DAB94A1F-SegmentedRaftLog: purge 5
2021-10-05 13:24:51,012 [6d234f4d-474a-4c74-a9e9-8f3885fce584@group-5AA8DAB94A1F-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - 6d234f4d-474a-4c74-a9e9-8f3885fce584@group-5AA8DAB94A1F-SegmentedRaftLog: snapshotIndex: updateIncreasingly -1 -> 5
2021-10-05 13:24:51,012 [6d234f4d-474a-4c74-a9e9-8f3885fce584@group-5AA8DAB94A1F-SegmentedRaftLogWorker] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - 6d234f4d-474a-4c74-a9e9-8f3885fce584@group-5AA8DAB94A1F-SegmentedRaftLog: purgeIndex: updateToMax old=-1, new=0, updated? true
2021-10-05 13:24:51,025 [Listener at 0.0.0.0/13541] INFO  server.SCMClientProtocolServer (SCMClientProtocolServer.java:start(164)) - RPC server for Client  is listening at /0.0.0.0:13541
2021-10-05 13:24:51,026 [IPC Server Responder] INFO  ipc.Server (Server.java:run(1507)) - IPC Server Responder: starting
2021-10-05 13:24:51,026 [IPC Server listener on 13541] INFO  ipc.Server (Server.java:run(1344)) - IPC Server listener on 13541: starting
2021-10-05 13:24:51,060 [Listener at 0.0.0.0/13541] INFO  server.StorageContainerManager (StorageContainerManager.java:start(1318)) - ScmBlockLocationProtocol RPC server is listening at /0.0.0.0:13540
2021-10-05 13:24:51,060 [Listener at 0.0.0.0/13541] INFO  server.SCMBlockProtocolServer (SCMBlockProtocolServer.java:start(151)) - RPC server for Block Protocol is listening at /0.0.0.0:13540
2021-10-05 13:24:51,061 [IPC Server Responder] INFO  ipc.Server (Server.java:run(1507)) - IPC Server Responder: starting
2021-10-05 13:24:51,061 [IPC Server listener on 13540] INFO  ipc.Server (Server.java:run(1344)) - IPC Server listener on 13540: starting
2021-10-05 13:24:51,062 [Listener at 0.0.0.0/13541] INFO  server.StorageContainerManager (StorageContainerManager.java:start(1324)) - ScmDatanodeProtocl RPC server is listening at /0.0.0.0:13539
2021-10-05 13:24:51,068 [Listener at 0.0.0.0/13541] INFO  http.BaseHttpServer (BaseHttpServer.java:newHttpServer2BuilderForOzone(209)) - Starting Web-server for scm at: http://0.0.0.0:13536
2021-10-05 13:24:51,068 [Listener at 0.0.0.0/13541] INFO  http.BaseHttpServer (BaseHttpServer.java:<init>(107)) - Hadoop Security Enabled: false Ozone Security Enabled: false Ozone HTTP Security Enabled: false 
2021-10-05 13:24:51,069 [Listener at 0.0.0.0/13541] INFO  server.AuthenticationFilter (AuthenticationFilter.java:constructSecretProvider(240)) - Unable to initialize FileSignerSecretProvider, falling back to use random secrets.
2021-10-05 13:24:51,073 [Listener at 0.0.0.0/13541] WARN  http.HttpRequestLog (HttpRequestLog.java:getRequestLog(103)) - Jetty request log can only be enabled using Log4j
2021-10-05 13:24:51,074 [Listener at 0.0.0.0/13541] INFO  http.HttpServer2 (HttpServer2.java:addGlobalFilter(1030)) - Added global filter 'safety' (class=org.apache.hadoop.hdds.server.http.HttpServer2$QuotingInputFilter)
2021-10-05 13:24:51,075 [Listener at 0.0.0.0/13541] INFO  http.HttpServer2 (HttpServer2.java:addFilter(1006)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context scm
2021-10-05 13:24:51,076 [Listener at 0.0.0.0/13541] INFO  http.HttpServer2 (HttpServer2.java:addFilter(1014)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context logs
2021-10-05 13:24:51,076 [Listener at 0.0.0.0/13541] INFO  http.HttpServer2 (HttpServer2.java:addFilter(1014)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context static
2021-10-05 13:24:51,076 [Listener at 0.0.0.0/13541] INFO  http.HttpServer2 (HttpServer2.java:bindListener(1249)) - Jetty bound to port 13536
2021-10-05 13:24:51,077 [Listener at 0.0.0.0/13541] INFO  server.Server (Server.java:doStart(375)) - jetty-9.4.43.v20210629; built: 2021-06-30T11:07:22.254Z; git: 526006ecfa3af7f1a27ef3a288e2bef7ea9dd7e8; jvm 1.8.0_292-b10
2021-10-05 13:24:51,087 [org.apache.hadoop.util.JvmPauseMonitor$Monitor@3fc6ae7b] INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(188)) - Starting JVM pause monitor
2021-10-05 13:24:51,118 [Listener at 0.0.0.0/13541] INFO  server.session (DefaultSessionIdManager.java:doStart(334)) - DefaultSessionIdManager workerName=node0
2021-10-05 13:24:51,118 [Listener at 0.0.0.0/13541] INFO  server.session (DefaultSessionIdManager.java:doStart(339)) - No SessionScavenger set, using defaults
2021-10-05 13:24:51,118 [Listener at 0.0.0.0/13541] INFO  server.session (HouseKeeper.java:startScavenging(132)) - node0 Scavenging every 660000ms
2021-10-05 13:24:51,120 [Listener at 0.0.0.0/13541] INFO  handler.ContextHandler (ContextHandler.java:doStart(915)) - Started o.e.j.s.ServletContextHandler@76838ab3{logs,/logs,file:///home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/log,AVAILABLE}
2021-10-05 13:24:51,120 [Listener at 0.0.0.0/13541] INFO  handler.ContextHandler (ContextHandler.java:doStart(915)) - Started o.e.j.s.ServletContextHandler@48cea80f{static,/static,file:///home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-classes/webapps/static,AVAILABLE}
2021-10-05 13:24:51,127 [Listener at 0.0.0.0/13541] INFO  handler.ContextHandler (ContextHandler.java:doStart(915)) - Started o.e.j.w.WebAppContext@14c4b3e1{scm,/,file:///home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-classes/webapps/scm/,AVAILABLE}{file:/home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-classes/webapps/scm}
2021-10-05 13:24:51,130 [Listener at 0.0.0.0/13541] INFO  server.AbstractConnector (AbstractConnector.java:doStart(331)) - Started ServerConnector@4dfb114e{HTTP/1.1, (http/1.1)}{0.0.0.0:13536}
2021-10-05 13:24:51,139 [Listener at 0.0.0.0/13541] INFO  server.Server (Server.java:doStart(415)) - Started @84798ms
2021-10-05 13:24:51,139 [Listener at 0.0.0.0/13541] WARN  impl.MetricsSystemImpl (MetricsSystemImpl.java:register(279)) - Sink prometheus already exists!
2021-10-05 13:24:51,140 [Listener at 0.0.0.0/13541] INFO  http.BaseHttpServer (BaseHttpServer.java:updateConnectorAddress(329)) - HTTP server of scm listening at http://0.0.0.0:13536
2021-10-05 13:24:51,140 [Listener at 0.0.0.0/13541] INFO  ozone.MiniOzoneHAClusterImpl (MiniOzoneHAClusterImpl.java:createSCMService(564)) - Started SCM RPC server at org.apache.hadoop.hdds.scm.server.SCMClientProtocolServer@8119d43
2021-10-05 13:24:51,144 [Listener at 0.0.0.0/13541] INFO  ha.SCMHANodeDetails (SCMHANodeDetails.java:loadSCMHAConfig(157)) - ServiceID for StorageContainerManager is scm-service-test1
2021-10-05 13:24:51,144 [Listener at 0.0.0.0/13541] INFO  ha.SCMHANodeDetails (SCMHANodeDetails.java:loadSCMHAConfig(168)) - ServiceID for StorageContainerManager is scm-service-test1
2021-10-05 13:24:51,144 [Listener at 0.0.0.0/13541] WARN  scm.ScmUtils (ScmUtils.java:logWarn(179)) - ConfigKey ozone.scm.block.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.block.client.port appended with serviceId and nodeId. If want to configure same port configure ozone.scm.block.client.port
2021-10-05 13:24:51,144 [Listener at 0.0.0.0/13541] WARN  scm.ScmUtils (ScmUtils.java:logWarn(179)) - ConfigKey ozone.scm.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.client.port appended with serviceId and nodeId. If want to configure same port configure ozone.scm.client.port
2021-10-05 13:24:51,145 [Listener at 0.0.0.0/13541] WARN  scm.ScmUtils (ScmUtils.java:logWarn(179)) - ConfigKey ozone.scm.datanode.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.datanode.port appended with serviceId and nodeId. If want to configure same port configure ozone.scm.datanode.port
2021-10-05 13:24:51,145 [Listener at 0.0.0.0/13541] WARN  scm.ScmUtils (ScmUtils.java:logWarn(179)) - ConfigKey ozone.scm.block.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.block.client.port appended with serviceId and nodeId. If want to configure same port configure ozone.scm.block.client.port
2021-10-05 13:24:51,145 [Listener at 0.0.0.0/13541] WARN  scm.ScmUtils (ScmUtils.java:logWarn(179)) - ConfigKey ozone.scm.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.client.port appended with serviceId and nodeId. If want to configure same port configure ozone.scm.client.port
2021-10-05 13:24:51,145 [Listener at 0.0.0.0/13541] WARN  scm.ScmUtils (ScmUtils.java:logWarn(179)) - ConfigKey ozone.scm.datanode.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.datanode.port appended with serviceId and nodeId. If want to configure same port configure ozone.scm.datanode.port
2021-10-05 13:24:51,145 [Listener at 0.0.0.0/13541] INFO  ha.SCMHANodeDetails (SCMHANodeDetails.java:loadSCMHAConfig(250)) - Found matching SCM address with SCMServiceId: scm-service-test1, SCMNodeId: scmNode-3, RPC Address: localhost:13548 and Ratis port: 13548
2021-10-05 13:24:51,145 [Listener at 0.0.0.0/13541] INFO  ha.SCMHANodeDetails (ConfUtils.java:setNodeSpecificConfigs(108)) - Setting configuration key ozone.scm.datanode.address with value of key ozone.scm.datanode.address.scm-service-test1.scmNode-3: 127.0.0.1:13549
2021-10-05 13:24:51,145 [Listener at 0.0.0.0/13541] INFO  ha.SCMHANodeDetails (ConfUtils.java:setNodeSpecificConfigs(108)) - Setting configuration key ozone.scm.block.client.address with value of key ozone.scm.block.client.address.scm-service-test1.scmNode-3: 127.0.0.1:13550
2021-10-05 13:24:51,146 [Listener at 0.0.0.0/13541] INFO  ha.SCMHANodeDetails (ConfUtils.java:setNodeSpecificConfigs(108)) - Setting configuration key ozone.scm.client.address with value of key ozone.scm.client.address.scm-service-test1.scmNode-3: 127.0.0.1:13551
2021-10-05 13:24:51,146 [Listener at 0.0.0.0/13541] INFO  ha.SCMHANodeDetails (ConfUtils.java:setNodeSpecificConfigs(108)) - Setting configuration key ozone.scm.ratis.port with value of key ozone.scm.ratis.port.scm-service-test1.scmNode-3: 13548
2021-10-05 13:24:51,146 [Listener at 0.0.0.0/13541] INFO  ha.SCMHANodeDetails (ConfUtils.java:setNodeSpecificConfigs(108)) - Setting configuration key ozone.scm.grpc.port with value of key ozone.scm.grpc.port.scm-service-test1.scmNode-3: 13552
2021-10-05 13:24:51,146 [Listener at 0.0.0.0/13541] INFO  ha.SCMHANodeDetails (ConfUtils.java:setNodeSpecificConfigs(108)) - Setting configuration key ozone.scm.http-address with value of key ozone.scm.http-address.scm-service-test1.scmNode-3: 127.0.0.1:13546
2021-10-05 13:24:51,146 [Listener at 0.0.0.0/13541] INFO  ha.SCMHANodeDetails (ConfUtils.java:setNodeSpecificConfigs(108)) - Setting configuration key ozone.scm.https-address with value of key ozone.scm.https-address.scm-service-test1.scmNode-3: 127.0.0.1:13547
2021-10-05 13:24:51,146 [Listener at 0.0.0.0/13541] INFO  ha.SCMHANodeDetails (ConfUtils.java:setNodeSpecificConfigs(108)) - Setting configuration key ozone.scm.address with value of key ozone.scm.address.scm-service-test1.scmNode-3: 127.0.0.1
2021-10-05 13:24:51,146 [Listener at 0.0.0.0/13541] WARN  scm.ScmUtils (ScmUtils.java:logWarn(179)) - ConfigKey ozone.scm.block.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.block.client.port appended with serviceId and nodeId. If want to configure same port configure ozone.scm.block.client.port
2021-10-05 13:24:51,146 [Listener at 0.0.0.0/13541] WARN  scm.ScmUtils (ScmUtils.java:logWarn(179)) - ConfigKey ozone.scm.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.client.port appended with serviceId and nodeId. If want to configure same port configure ozone.scm.client.port
2021-10-05 13:24:51,147 [Listener at 0.0.0.0/13541] WARN  scm.ScmUtils (ScmUtils.java:logWarn(179)) - ConfigKey ozone.scm.datanode.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.datanode.port appended with serviceId and nodeId. If want to configure same port configure ozone.scm.datanode.port
2021-10-05 13:24:51,149 [Listener at 0.0.0.0/13541] WARN  server.ServerUtils (ServerUtils.java:getScmDbDir(148)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2021-10-05 13:24:51,152 [Listener at 0.0.0.0/13541] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.client.port appended with serviceId and nodeId
2021-10-05 13:24:51,152 [Listener at 0.0.0.0/13541] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.block.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.block.client.port appended with serviceId and nodeId
2021-10-05 13:24:51,152 [Listener at 0.0.0.0/13541] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.datanode.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.datanode.port appended with serviceId and nodeId
2021-10-05 13:24:51,153 [Listener at 0.0.0.0/13541] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.client.port appended with serviceId and nodeId
2021-10-05 13:24:51,153 [Listener at 0.0.0.0/13541] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.block.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.block.client.port appended with serviceId and nodeId
2021-10-05 13:24:51,153 [Listener at 0.0.0.0/13541] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.datanode.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.datanode.port appended with serviceId and nodeId
2021-10-05 13:24:51,153 [Listener at 0.0.0.0/13541] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.client.port appended with serviceId and nodeId
2021-10-05 13:24:51,153 [Listener at 0.0.0.0/13541] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.block.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.block.client.port appended with serviceId and nodeId
2021-10-05 13:24:51,153 [Listener at 0.0.0.0/13541] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.datanode.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.datanode.port appended with serviceId and nodeId
2021-10-05 13:24:51,174 [Listener at 0.0.0.0/13541] INFO  server.StorageContainerManager (StorageContainerManager.java:scmBootstrap(987)) - SCM BootStrap  is successful for ClusterID 36b87918-66c6-4e2c-9c49-5aa8dab94a1f, SCMID b6de9022-5a0e-4aec-a94e-4e214b276ef3
2021-10-05 13:24:51,174 [Listener at 0.0.0.0/13541] INFO  server.StorageContainerManager (StorageContainerManager.java:scmBootstrap(989)) - Primary SCM Node ID 21490b65-0a55-46f3-b94a-dd719a327c14
2021-10-05 13:24:51,174 [Listener at 0.0.0.0/13541] INFO  ha.SCMHANodeDetails (SCMHANodeDetails.java:loadSCMHAConfig(157)) - ServiceID for StorageContainerManager is scm-service-test1
2021-10-05 13:24:51,174 [Listener at 0.0.0.0/13541] INFO  ha.SCMHANodeDetails (SCMHANodeDetails.java:loadSCMHAConfig(168)) - ServiceID for StorageContainerManager is scm-service-test1
2021-10-05 13:24:51,174 [Listener at 0.0.0.0/13541] WARN  scm.ScmUtils (ScmUtils.java:logWarn(179)) - ConfigKey ozone.scm.block.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.block.client.port appended with serviceId and nodeId. If want to configure same port configure ozone.scm.block.client.port
2021-10-05 13:24:51,174 [Listener at 0.0.0.0/13541] WARN  scm.ScmUtils (ScmUtils.java:logWarn(179)) - ConfigKey ozone.scm.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.client.port appended with serviceId and nodeId. If want to configure same port configure ozone.scm.client.port
2021-10-05 13:24:51,175 [Listener at 0.0.0.0/13541] WARN  scm.ScmUtils (ScmUtils.java:logWarn(179)) - ConfigKey ozone.scm.datanode.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.datanode.port appended with serviceId and nodeId. If want to configure same port configure ozone.scm.datanode.port
2021-10-05 13:24:51,175 [Listener at 0.0.0.0/13541] WARN  scm.ScmUtils (ScmUtils.java:logWarn(179)) - ConfigKey ozone.scm.block.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.block.client.port appended with serviceId and nodeId. If want to configure same port configure ozone.scm.block.client.port
2021-10-05 13:24:51,175 [Listener at 0.0.0.0/13541] WARN  scm.ScmUtils (ScmUtils.java:logWarn(179)) - ConfigKey ozone.scm.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.client.port appended with serviceId and nodeId. If want to configure same port configure ozone.scm.client.port
2021-10-05 13:24:51,175 [Listener at 0.0.0.0/13541] WARN  scm.ScmUtils (ScmUtils.java:logWarn(179)) - ConfigKey ozone.scm.datanode.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.datanode.port appended with serviceId and nodeId. If want to configure same port configure ozone.scm.datanode.port
2021-10-05 13:24:51,175 [Listener at 0.0.0.0/13541] INFO  ha.SCMHANodeDetails (SCMHANodeDetails.java:loadSCMHAConfig(250)) - Found matching SCM address with SCMServiceId: scm-service-test1, SCMNodeId: scmNode-3, RPC Address: localhost:13548 and Ratis port: 13548
2021-10-05 13:24:51,176 [Listener at 0.0.0.0/13541] INFO  ha.SCMHANodeDetails (ConfUtils.java:setNodeSpecificConfigs(108)) - Setting configuration key ozone.scm.datanode.address with value of key ozone.scm.datanode.address.scm-service-test1.scmNode-3: 127.0.0.1:13549
2021-10-05 13:24:51,176 [Listener at 0.0.0.0/13541] INFO  ha.SCMHANodeDetails (ConfUtils.java:setNodeSpecificConfigs(108)) - Setting configuration key ozone.scm.block.client.address with value of key ozone.scm.block.client.address.scm-service-test1.scmNode-3: 127.0.0.1:13550
2021-10-05 13:24:51,176 [Listener at 0.0.0.0/13541] INFO  ha.SCMHANodeDetails (ConfUtils.java:setNodeSpecificConfigs(108)) - Setting configuration key ozone.scm.client.address with value of key ozone.scm.client.address.scm-service-test1.scmNode-3: 127.0.0.1:13551
2021-10-05 13:24:51,176 [Listener at 0.0.0.0/13541] INFO  ha.SCMHANodeDetails (ConfUtils.java:setNodeSpecificConfigs(108)) - Setting configuration key ozone.scm.ratis.port with value of key ozone.scm.ratis.port.scm-service-test1.scmNode-3: 13548
2021-10-05 13:24:51,176 [Listener at 0.0.0.0/13541] INFO  ha.SCMHANodeDetails (ConfUtils.java:setNodeSpecificConfigs(108)) - Setting configuration key ozone.scm.grpc.port with value of key ozone.scm.grpc.port.scm-service-test1.scmNode-3: 13552
2021-10-05 13:24:51,176 [Listener at 0.0.0.0/13541] INFO  ha.SCMHANodeDetails (ConfUtils.java:setNodeSpecificConfigs(108)) - Setting configuration key ozone.scm.http-address with value of key ozone.scm.http-address.scm-service-test1.scmNode-3: 127.0.0.1:13546
2021-10-05 13:24:51,176 [Listener at 0.0.0.0/13541] INFO  ha.SCMHANodeDetails (ConfUtils.java:setNodeSpecificConfigs(108)) - Setting configuration key ozone.scm.https-address with value of key ozone.scm.https-address.scm-service-test1.scmNode-3: 127.0.0.1:13547
2021-10-05 13:24:51,177 [Listener at 0.0.0.0/13541] INFO  ha.SCMHANodeDetails (ConfUtils.java:setNodeSpecificConfigs(108)) - Setting configuration key ozone.scm.address with value of key ozone.scm.address.scm-service-test1.scmNode-3: 127.0.0.1
2021-10-05 13:24:51,177 [Listener at 0.0.0.0/13541] WARN  scm.ScmUtils (ScmUtils.java:logWarn(179)) - ConfigKey ozone.scm.block.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.block.client.port appended with serviceId and nodeId. If want to configure same port configure ozone.scm.block.client.port
2021-10-05 13:24:51,177 [Listener at 0.0.0.0/13541] WARN  scm.ScmUtils (ScmUtils.java:logWarn(179)) - ConfigKey ozone.scm.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.client.port appended with serviceId and nodeId. If want to configure same port configure ozone.scm.client.port
2021-10-05 13:24:51,177 [Listener at 0.0.0.0/13541] WARN  scm.ScmUtils (ScmUtils.java:logWarn(179)) - ConfigKey ozone.scm.datanode.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.datanode.port appended with serviceId and nodeId. If want to configure same port configure ozone.scm.datanode.port
2021-10-05 13:24:51,179 [Listener at 0.0.0.0/13541] WARN  server.ServerUtils (ServerUtils.java:getScmDbDir(148)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2021-10-05 13:24:51,179 [Listener at 0.0.0.0/13541] INFO  upgrade.AbstractLayoutVersionManager (AbstractLayoutVersionManager.java:init(79)) - Initializing Layout version manager with metadata layout = SCM_HA (version = 2), software layout = SCM_HA (version = 2)
2021-10-05 13:24:51,261 [Listener at 0.0.0.0/13541] INFO  reflections.Reflections (Reflections.java:scan(232)) - Reflections took 81 ms to scan 7 urls, producing 119 keys and 275 values 
2021-10-05 13:24:51,272 [Listener at 0.0.0.0/13541] WARN  utils.HAUtils (HAUtils.java:getMetaDir(342)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2021-10-05 13:24:51,274 [Listener at 0.0.0.0/13541] WARN  db.DBStoreBuilder (DBStoreBuilder.java:applyDBDefinition(145)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2021-10-05 13:24:51,431 [Listener at 0.0.0.0/13541] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchemaFromFile(129)) - Loading schema from [jar:file:/home/runner/.m2/repository/org/apache/ozone/hdds-common/1.2.0-SNAPSHOT/hdds-common-1.2.0-SNAPSHOT.jar!/network-topology-default.xml]
2021-10-05 13:24:51,431 [Listener at 0.0.0.0/13541] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchema(176)) - Loading network topology layer schema file
2021-10-05 13:24:51,435 [Listener at 0.0.0.0/13541] WARN  impl.MetricRegistriesImpl (MetricRegistriesImpl.java:addReporterRegistration(111)) - New reporters are added after registries were created. Some metrics will be missing from the reporter. Please add reporter before adding any new registry.
2021-10-05 13:24:51,436 [Listener at 0.0.0.0/13541] WARN  impl.MetricRegistriesImpl (MetricRegistriesImpl.java:addReporterRegistration(111)) - New reporters are added after registries were created. Some metrics will be missing from the reporter. Please add reporter before adding any new registry.
2021-10-05 13:24:51,437 [Listener at 0.0.0.0/13541] INFO  ha.SCMRatisServerImpl (SCMRatisServerImpl.java:<init>(87)) - starting Raft server for scm:b6de9022-5a0e-4aec-a94e-4e214b276ef3
2021-10-05 13:24:51,438 [Listener at 0.0.0.0/13541] INFO  server.RaftServer (ConfUtils.java:logGet(44)) - raft.rpc.type = GRPC (default)
2021-10-05 13:24:51,439 [Listener at 0.0.0.0/13541] INFO  grpc.GrpcFactory (GrpcFactory.java:checkPooledByteBufAllocatorUseCacheForAllThreads(48)) - PERFORMANCE WARNING: useCacheForAllThreads is true that may cause Netty to create a lot garbage objects and, as a result, trigger GC.
	It is recommended to disable useCacheForAllThreads by setting -Dorg.apache.ratis.thirdparty.io.netty.allocator.useCacheForAllThreads=false in command line.
2021-10-05 13:24:51,439 [Listener at 0.0.0.0/13541] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(44)) - raft.grpc.admin.port = -1 (default)
2021-10-05 13:24:51,439 [Listener at 0.0.0.0/13541] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(44)) - raft.grpc.server.port = 13548 (custom)
2021-10-05 13:24:51,440 [Listener at 0.0.0.0/13541] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(44)) - raft.grpc.client.port = -1 (default)
2021-10-05 13:24:51,440 [Listener at 0.0.0.0/13541] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(44)) - raft.grpc.server.port = 13548 (custom)
2021-10-05 13:24:51,440 [Listener at 0.0.0.0/13541] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(44)) - raft.grpc.server.port = 13548 (custom)
2021-10-05 13:24:51,440 [Listener at 0.0.0.0/13541] INFO  server.GrpcService (ConfUtils.java:logGet(44)) - raft.grpc.message.size.max = 32m (=33554432) (custom)
2021-10-05 13:24:51,440 [Listener at 0.0.0.0/13541] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2021-10-05 13:24:51,440 [Listener at 0.0.0.0/13541] INFO  server.GrpcService (ConfUtils.java:logGet(44)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2021-10-05 13:24:51,441 [Listener at 0.0.0.0/13541] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.request.timeout = 30000ms (custom)
2021-10-05 13:24:51,442 [Listener at 0.0.0.0/13541] INFO  impl.DataStreamServerImpl (ConfUtils.java:logGet(44)) - raft.datastream.type = DISABLED (default)
2021-10-05 13:24:51,442 [Listener at 0.0.0.0/13541] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.slowness.timeout = 120000ms (custom)
2021-10-05 13:24:51,442 [Listener at 0.0.0.0/13541] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.leaderelection.leader.step-down.wait-time = 10s (default)
2021-10-05 13:24:51,442 [Listener at 0.0.0.0/13541] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.storage.dir = [/home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-36b87918-66c6-4e2c-9c49-5aa8dab94a1f/scmNode-3/scm-ha] (custom)
2021-10-05 13:24:51,443 [Listener at 0.0.0.0/13541] INFO  server.RaftServer (RaftServerProxy.java:addNew(95)) - b6de9022-5a0e-4aec-a94e-4e214b276ef3: addNew group-5AA8DAB94A1F:[] returns group-5AA8DAB94A1F:java.util.concurrent.CompletableFuture@30845b6d[Not completed]
2021-10-05 13:24:51,444 [pool-227-thread-1] INFO  server.RaftServer$Division (RaftServerImpl.java:<init>(181)) - b6de9022-5a0e-4aec-a94e-4e214b276ef3: new RaftServerImpl for group-5AA8DAB94A1F:[] with SCMStateMachine:uninitialized
2021-10-05 13:24:51,450 [pool-227-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.timeout.min = 5000ms (custom)
2021-10-05 13:24:51,450 [pool-227-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.timeout.max = 5200ms (custom)
2021-10-05 13:24:51,450 [pool-227-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.sleep.time = 25ms (default)
2021-10-05 13:24:51,451 [pool-227-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.slowness.timeout = 120000ms (custom)
2021-10-05 13:24:51,451 [pool-227-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.leaderelection.leader.step-down.wait-time = 10s (default)
2021-10-05 13:24:51,451 [pool-227-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.sleep.deviation.threshold = 300ms (default)
2021-10-05 13:24:51,451 [pool-227-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.appender.install.snapshot.enabled = false (custom)
2021-10-05 13:24:51,451 [pool-227-thread-1] INFO  server.RaftServer$Division (ServerState.java:<init>(105)) - b6de9022-5a0e-4aec-a94e-4e214b276ef3@group-5AA8DAB94A1F: ConfigurationManager, init=-1: [], old=null, confs=<EMPTY_MAP>
2021-10-05 13:24:51,451 [pool-227-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.storage.dir = [/home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-36b87918-66c6-4e2c-9c49-5aa8dab94a1f/scmNode-3/scm-ha] (custom)
2021-10-05 13:24:51,451 [pool-227-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.corruption.policy = EXCEPTION (default)
2021-10-05 13:24:51,451 [pool-227-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.storage.free-space.min = 0MB (=0) (default)
2021-10-05 13:24:51,451 [pool-227-thread-1] INFO  storage.RaftStorageDirectory (RaftStorageDirectoryImpl.java:analyzeStorage(135)) - The storage directory /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-36b87918-66c6-4e2c-9c49-5aa8dab94a1f/scmNode-3/scm-ha/36b87918-66c6-4e2c-9c49-5aa8dab94a1f does not exist. Creating ...
2021-10-05 13:24:51,456 [pool-227-thread-1] INFO  storage.RaftStorageDirectory (RaftStorageDirectoryImpl.java:tryLock(230)) - Lock on /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-36b87918-66c6-4e2c-9c49-5aa8dab94a1f/scmNode-3/scm-ha/36b87918-66c6-4e2c-9c49-5aa8dab94a1f/in_use.lock acquired by nodename 17451@fv-az270-324
2021-10-05 13:24:51,462 [pool-227-thread-1] INFO  storage.RaftStorage (RaftStorageImpl.java:format(89)) - Storage directory /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-36b87918-66c6-4e2c-9c49-5aa8dab94a1f/scmNode-3/scm-ha/36b87918-66c6-4e2c-9c49-5aa8dab94a1f has been successfully formatted.
2021-10-05 13:24:51,462 [pool-227-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.notification.no-leader.timeout = 60s (default)
2021-10-05 13:24:51,462 [pool-227-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.use.memory = false (default)
2021-10-05 13:24:51,462 [pool-227-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.purge.gap = 5 (custom)
2021-10-05 13:24:51,462 [pool-227-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2021-10-05 13:24:51,462 [pool-227-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.segment.size.max = 16384 (custom)
2021-10-05 13:24:51,463 [pool-227-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.segment.cache.num.max = 2 (custom)
2021-10-05 13:24:51,463 [pool-227-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.segment.cache.size.max = 200MB (=209715200) (default)
2021-10-05 13:24:51,463 [pool-227-thread-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:<init>(182)) - new b6de9022-5a0e-4aec-a94e-4e214b276ef3@group-5AA8DAB94A1F-SegmentedRaftLogWorker for RaftStorageImpl:Storage Directory /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-36b87918-66c6-4e2c-9c49-5aa8dab94a1f/scmNode-3/scm-ha/36b87918-66c6-4e2c-9c49-5aa8dab94a1f
2021-10-05 13:24:51,463 [pool-227-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.queue.byte-limit = 64MB (=67108864) (default)
2021-10-05 13:24:51,463 [pool-227-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.queue.element-limit = 4096 (default)
2021-10-05 13:24:51,463 [pool-227-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.segment.size.max = 16384 (custom)
2021-10-05 13:24:51,463 [pool-227-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.preallocated.size = 16384 (custom)
2021-10-05 13:24:51,463 [pool-227-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.force.sync.num = 128 (default)
2021-10-05 13:24:51,463 [pool-227-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.statemachine.data.sync = true (default)
2021-10-05 13:24:51,463 [pool-227-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2021-10-05 13:24:51,463 [pool-227-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2021-10-05 13:24:51,464 [pool-227-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.write.buffer.size = 64KB (=65536) (default)
2021-10-05 13:24:51,464 [pool-227-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.statemachine.data.caching.enabled = false (default)
2021-10-05 13:24:51,464 [pool-227-thread-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:lambda$new$0(133)) - b6de9022-5a0e-4aec-a94e-4e214b276ef3@group-5AA8DAB94A1F-SegmentedRaftLogWorker: flushIndex: setUnconditionally 0 -> -1
2021-10-05 13:24:51,464 [pool-227-thread-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:lambda$new$0(133)) - b6de9022-5a0e-4aec-a94e-4e214b276ef3@group-5AA8DAB94A1F-SegmentedRaftLogWorker: safeCacheEvictIndex: setUnconditionally 0 -> -1
2021-10-05 13:24:51,468 [pool-227-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2021-10-05 13:24:51,469 [pool-227-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.snapshot.auto.trigger.threshold = 5 (custom)
2021-10-05 13:24:51,469 [pool-227-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.snapshot.retention.file.num = -1 (default)
2021-10-05 13:24:51,469 [pool-227-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.purge.upto.snapshot.index = true (custom)
2021-10-05 13:24:51,469 [pool-227-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.retrycache.expirytime = 60000ms (default)
2021-10-05 13:24:51,469 [pool-227-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.retrycache.statistics.expirytime = 100μs (default)
2021-10-05 13:24:51,472 [Listener at 0.0.0.0/13541] INFO  ha.SCMSnapshotProvider (SCMSnapshotProvider.java:<init>(66)) - Initializing SCM Snapshot Provider
2021-10-05 13:24:51,472 [Listener at 0.0.0.0/13541] WARN  server.ServerUtils (ServerUtils.java:getDefaultRatisDirectory(237)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2021-10-05 13:24:51,472 [Listener at 0.0.0.0/13541] WARN  ha.SCMHAUtils (SCMHAUtils.java:getSCMRatisSnapshotDirectory(146)) - SCM snapshot dir is not configured. Falling back to ozone.metadata.dirs config
2021-10-05 13:24:51,474 [Listener at 0.0.0.0/13541] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:upgradeToSequenceId(347)) - upgrade localId to 107544261427200000
2021-10-05 13:24:51,474 [Listener at 0.0.0.0/13541] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:upgradeToSequenceId(357)) - upgrade delTxnId to 0
2021-10-05 13:24:51,474 [Listener at 0.0.0.0/13541] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:upgradeToSequenceId(371)) - upgrade containerId to 0
2021-10-05 13:24:51,474 [Listener at 0.0.0.0/13541] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:<init>(218)) - Init the HA SequenceIdGenerator.
2021-10-05 13:24:51,475 [Listener at 0.0.0.0/13541] WARN  server.ServerUtils (ServerUtils.java:sanitizeUserArgs(73)) - ozone.scm.stale.node.interval value = 300000 is larger than max = 100000 based on the key value of ozone.scm.heartbeat.thread.interval, reset to the max value 100000.
2021-10-05 13:24:51,475 [Listener at 0.0.0.0/13541] WARN  server.ServerUtils (ServerUtils.java:sanitizeUserArgs(73)) - ozone.scm.stale.node.interval value = 300000 is larger than max = 100000 based on the key value of ozone.scm.heartbeat.thread.interval, reset to the max value 100000.
2021-10-05 13:24:51,483 [Listener at 0.0.0.0/13541] INFO  node.SCMNodeManager (SCMNodeManager.java:<init>(144)) - Entering startup safe mode.
2021-10-05 13:24:51,484 [Listener at 0.0.0.0/13541] INFO  algorithms.ContainerPlacementPolicyFactory (ContainerPlacementPolicyFactory.java:getPolicy(60)) - Create container placement policy of type org.apache.hadoop.hdds.scm.container.placement.algorithms.SCMContainerPlacementRandom
2021-10-05 13:24:51,484 [Listener at 0.0.0.0/13541] INFO  pipeline.PipelineStateManagerImpl (PipelineStateManagerImpl.java:initialize(78)) - No pipeline exists in current db
2021-10-05 13:24:51,485 [Listener at 0.0.0.0/13541] INFO  algorithms.LeaderChoosePolicyFactory (LeaderChoosePolicyFactory.java:getPolicy(57)) - Create leader choose policy of type org.apache.hadoop.hdds.scm.pipeline.leader.choose.algorithms.MinLeaderCountChoosePolicy
2021-10-05 13:24:51,485 [Listener at 0.0.0.0/13541] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(43)) - Registering service BackgroundPipelineCreator.
2021-10-05 13:24:51,485 [Listener at 0.0.0.0/13541] INFO  pipeline.BackgroundPipelineCreator (BackgroundPipelineCreatorV2.java:start(130)) - Starting RatisPipelineUtilsThread.
2021-10-05 13:24:51,488 [Listener at 0.0.0.0/13541] INFO  algorithms.PipelineChoosePolicyFactory (PipelineChoosePolicyFactory.java:createPipelineChoosePolicyFromClass(73)) - Create pipeline choose policy of type org.apache.hadoop.hdds.scm.pipeline.choose.algorithms.RandomPipelineChoosePolicy
2021-10-05 13:24:51,489 [Listener at 0.0.0.0/13541] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(43)) - Registering service SCMBlockDeletingService.
2021-10-05 13:24:51,491 [Listener at 0.0.0.0/13541] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(43)) - Registering service ReplicationManager.
2021-10-05 13:24:51,491 [Listener at 0.0.0.0/13541] INFO  container.ReplicationManager (ReplicationManager.java:start(319)) - Starting Replication Monitor Thread.
2021-10-05 13:24:51,497 [Listener at 0.0.0.0/13541] INFO  safemode.ContainerSafeModeRule (ContainerSafeModeRule.java:<init>(89)) - containers with one replica threshold count 0
2021-10-05 13:24:51,498 [Listener at 0.0.0.0/13541] INFO  safemode.HealthyPipelineSafeModeRule (HealthyPipelineSafeModeRule.java:initializeRule(156)) - Total pipeline count is 0, healthy pipeline threshold count is 1
2021-10-05 13:24:51,498 [Listener at 0.0.0.0/13541] INFO  safemode.OneReplicaPipelineSafeModeRule (OneReplicaPipelineSafeModeRule.java:initializeRule(180)) - Total pipeline count is 0, pipeline's with at least one datanode reported threshold count is 0
2021-10-05 13:24:51,512 [ReplicationMonitor] INFO  container.ReplicationManager (ReplicationManager.java:processAll(371)) - Replication Monitor Thread took 0 milliseconds for processing 0 containers.
2021-10-05 13:24:51,515 [Listener at 0.0.0.0/13541] INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(90)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 2000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false.
2021-10-05 13:24:51,519 [Socket Reader #1 for port 13549] INFO  ipc.Server (Server.java:run(1265)) - Starting Socket Reader #1 for port 13549
2021-10-05 13:24:51,521 [Listener at 0.0.0.0/13549] INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(90)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 2000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false.
2021-10-05 13:24:51,527 [Socket Reader #1 for port 13550] INFO  ipc.Server (Server.java:run(1265)) - Starting Socket Reader #1 for port 13550
2021-10-05 13:24:51,538 [Listener at 0.0.0.0/13550] INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(90)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 2000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false.
2021-10-05 13:24:51,547 [Socket Reader #1 for port 13551] INFO  ipc.Server (Server.java:run(1265)) - Starting Socket Reader #1 for port 13551
2021-10-05 13:24:51,593 [Listener at 0.0.0.0/13551] INFO  algorithms.ContainerPlacementPolicyFactory (ContainerPlacementPolicyFactory.java:getPolicy(60)) - Create container placement policy of type org.apache.hadoop.hdds.scm.container.placement.algorithms.SCMContainerPlacementRandom
2021-10-05 13:24:51,596 [Listener at 0.0.0.0/13551] INFO  server.StorageContainerManager (StorageContainerManager.java:<init>(388)) - 
Container Balancer status:
Key                            Value
Running                        false
Container Balancer Configuration values:
Key                                                Value
Threshold                                          0.1
Max Datanodes to Involve per Iteration(ratio)      0.2
Max Size to Move per Iteration                     32212254720B

2021-10-05 13:24:51,596 [Listener at 0.0.0.0/13551] WARN  events.EventQueue (EventQueue.java:fireEvent(194)) - No event handler registered for event TypedEvent{payloadType=SafeModeStatus, name='Safe mode status'}
2021-10-05 13:24:51,598 [Listener at 0.0.0.0/13551] INFO  ha.SCMContext (SCMContext.java:updateSafeModeStatus(205)) - Update SafeModeStatus from SafeModeStatus{safeModeStatus=true, preCheckPassed=false} to SafeModeStatus{safeModeStatus=true, preCheckPassed=false}.
2021-10-05 13:24:51,599 [Listener at 0.0.0.0/13551] INFO  ozone.MiniOzoneHAClusterImpl (MiniOzoneHAClusterImpl.java:createSCMService(568)) - Intialized SCM at org.apache.hadoop.hdds.scm.server.SCMClientProtocolServer@1d6d2b60. This SCM is currently inactive (not running).
2021-10-05 13:24:51,600 [Listener at 0.0.0.0/13551] INFO  ha.OMHANodeDetails (OMHANodeDetails.java:loadOMHAConfig(118)) - ServiceID for OzoneManager is om-service-test1
2021-10-05 13:24:51,600 [Listener at 0.0.0.0/13551] INFO  ha.OMHANodeDetails (OMHANodeDetails.java:loadOMHAConfig(194)) - Found matching OM address with OMServiceId: om-service-test1, OMNodeId: omNode-1, RPC Address: localhost:13296 and Ratis port: 13300
2021-10-05 13:24:51,600 [Listener at 0.0.0.0/13551] INFO  ha.OMHANodeDetails (ConfUtils.java:setNodeSpecificConfigs(108)) - Setting configuration key ozone.om.http-address with value of key ozone.om.http-address.om-service-test1.omNode-1: 127.0.0.1:13298
2021-10-05 13:24:51,600 [Listener at 0.0.0.0/13551] INFO  ha.OMHANodeDetails (ConfUtils.java:setNodeSpecificConfigs(108)) - Setting configuration key ozone.om.https-address with value of key ozone.om.https-address.om-service-test1.omNode-1: 127.0.0.1:13299
2021-10-05 13:24:51,600 [Listener at 0.0.0.0/13551] INFO  ha.OMHANodeDetails (ConfUtils.java:setNodeSpecificConfigs(108)) - Setting configuration key ozone.om.address with value of key ozone.om.address.om-service-test1.omNode-1: 127.0.0.1:13296
2021-10-05 13:24:51,601 [Listener at 0.0.0.0/13551] WARN  server.ServerUtils (ServerUtils.java:getDBPath(225)) - ozone.om.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2021-10-05 13:24:51,602 [Listener at 0.0.0.0/13551] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.client.port appended with serviceId and nodeId
2021-10-05 13:24:51,602 [Listener at 0.0.0.0/13551] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.block.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.block.client.port appended with serviceId and nodeId
2021-10-05 13:24:51,602 [Listener at 0.0.0.0/13551] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.datanode.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.datanode.port appended with serviceId and nodeId
2021-10-05 13:24:51,602 [Listener at 0.0.0.0/13551] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.client.port appended with serviceId and nodeId
2021-10-05 13:24:51,602 [Listener at 0.0.0.0/13551] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.block.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.block.client.port appended with serviceId and nodeId
2021-10-05 13:24:51,602 [Listener at 0.0.0.0/13551] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.datanode.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.datanode.port appended with serviceId and nodeId
2021-10-05 13:24:51,603 [Listener at 0.0.0.0/13551] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.client.port appended with serviceId and nodeId
2021-10-05 13:24:51,603 [Listener at 0.0.0.0/13551] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.block.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.block.client.port appended with serviceId and nodeId
2021-10-05 13:24:51,603 [Listener at 0.0.0.0/13551] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.datanode.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.datanode.port appended with serviceId and nodeId
OM initialization succeeded.Current cluster id for sd=/home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-36b87918-66c6-4e2c-9c49-5aa8dab94a1f/omNode-1/om;cid=36b87918-66c6-4e2c-9c49-5aa8dab94a1f;layoutVersion=0
2021-10-05 13:24:51,623 [Listener at 0.0.0.0/13551] INFO  ha.OMHANodeDetails (OMHANodeDetails.java:loadOMHAConfig(118)) - ServiceID for OzoneManager is om-service-test1
2021-10-05 13:24:51,624 [Listener at 0.0.0.0/13551] INFO  ha.OMHANodeDetails (OMHANodeDetails.java:loadOMHAConfig(194)) - Found matching OM address with OMServiceId: om-service-test1, OMNodeId: omNode-1, RPC Address: localhost:13296 and Ratis port: 13300
2021-10-05 13:24:51,624 [Listener at 0.0.0.0/13551] INFO  ha.OMHANodeDetails (ConfUtils.java:setNodeSpecificConfigs(108)) - Setting configuration key ozone.om.http-address with value of key ozone.om.http-address.om-service-test1.omNode-1: 127.0.0.1:13298
2021-10-05 13:24:51,624 [Listener at 0.0.0.0/13551] INFO  ha.OMHANodeDetails (ConfUtils.java:setNodeSpecificConfigs(108)) - Setting configuration key ozone.om.https-address with value of key ozone.om.https-address.om-service-test1.omNode-1: 127.0.0.1:13299
2021-10-05 13:24:51,624 [Listener at 0.0.0.0/13551] INFO  ha.OMHANodeDetails (ConfUtils.java:setNodeSpecificConfigs(108)) - Setting configuration key ozone.om.address with value of key ozone.om.address.om-service-test1.omNode-1: 127.0.0.1:13296
2021-10-05 13:24:51,624 [Listener at 0.0.0.0/13551] WARN  server.ServerUtils (ServerUtils.java:getDBPath(225)) - ozone.om.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2021-10-05 13:24:51,624 [Listener at 0.0.0.0/13551] INFO  upgrade.AbstractLayoutVersionManager (AbstractLayoutVersionManager.java:init(79)) - Initializing Layout version manager with metadata layout = INITIAL_VERSION (version = 0), software layout = INITIAL_VERSION (version = 0)
2021-10-05 13:24:51,723 [Listener at 0.0.0.0/13551] INFO  reflections.Reflections (Reflections.java:scan(232)) - Reflections took 97 ms to scan 2 urls, producing 131 keys and 342 values [using 2 cores]
2021-10-05 13:24:51,723 [Listener at 0.0.0.0/13551] INFO  upgrade.OMLayoutVersionManager (OMLayoutVersionManager.java:lambda$0(115)) - Skipping Upgrade Action MockOmUpgradeAction since it has been finalized.
2021-10-05 13:24:51,723 [Listener at 0.0.0.0/13551] WARN  server.ServerUtils (ServerUtils.java:getDBPath(225)) - ozone.om.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2021-10-05 13:24:51,724 [Listener at 0.0.0.0/13551] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.client.port appended with serviceId and nodeId
2021-10-05 13:24:51,724 [Listener at 0.0.0.0/13551] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.block.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.block.client.port appended with serviceId and nodeId
2021-10-05 13:24:51,724 [Listener at 0.0.0.0/13551] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.datanode.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.datanode.port appended with serviceId and nodeId
2021-10-05 13:24:51,724 [Listener at 0.0.0.0/13551] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.client.port appended with serviceId and nodeId
2021-10-05 13:24:51,724 [Listener at 0.0.0.0/13551] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.block.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.block.client.port appended with serviceId and nodeId
2021-10-05 13:24:51,724 [Listener at 0.0.0.0/13551] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.datanode.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.datanode.port appended with serviceId and nodeId
2021-10-05 13:24:51,724 [Listener at 0.0.0.0/13551] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.client.port appended with serviceId and nodeId
2021-10-05 13:24:51,724 [Listener at 0.0.0.0/13551] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.block.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.block.client.port appended with serviceId and nodeId
2021-10-05 13:24:51,724 [Listener at 0.0.0.0/13551] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.datanode.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.datanode.port appended with serviceId and nodeId
2021-10-05 13:24:51,725 [Listener at 0.0.0.0/13551] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.client.port appended with serviceId and nodeId
2021-10-05 13:24:51,725 [Listener at 0.0.0.0/13551] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.block.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.block.client.port appended with serviceId and nodeId
2021-10-05 13:24:51,725 [Listener at 0.0.0.0/13551] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.datanode.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.datanode.port appended with serviceId and nodeId
2021-10-05 13:24:51,725 [Listener at 0.0.0.0/13551] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.client.port appended with serviceId and nodeId
2021-10-05 13:24:51,725 [Listener at 0.0.0.0/13551] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.block.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.block.client.port appended with serviceId and nodeId
2021-10-05 13:24:51,725 [Listener at 0.0.0.0/13551] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.datanode.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.datanode.port appended with serviceId and nodeId
2021-10-05 13:24:51,726 [Listener at 0.0.0.0/13551] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.client.port appended with serviceId and nodeId
2021-10-05 13:24:51,726 [Listener at 0.0.0.0/13551] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.block.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.block.client.port appended with serviceId and nodeId
2021-10-05 13:24:51,726 [Listener at 0.0.0.0/13551] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.datanode.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.datanode.port appended with serviceId and nodeId
2021-10-05 13:24:51,727 [Listener at 0.0.0.0/13551] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.client.port appended with serviceId and nodeId
2021-10-05 13:24:51,727 [Listener at 0.0.0.0/13551] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.block.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.block.client.port appended with serviceId and nodeId
2021-10-05 13:24:51,727 [Listener at 0.0.0.0/13551] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.datanode.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.datanode.port appended with serviceId and nodeId
2021-10-05 13:24:51,727 [Listener at 0.0.0.0/13551] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.client.port appended with serviceId and nodeId
2021-10-05 13:24:51,727 [Listener at 0.0.0.0/13551] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.block.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.block.client.port appended with serviceId and nodeId
2021-10-05 13:24:51,727 [Listener at 0.0.0.0/13551] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.datanode.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.datanode.port appended with serviceId and nodeId
2021-10-05 13:24:51,727 [Listener at 0.0.0.0/13551] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.client.port appended with serviceId and nodeId
2021-10-05 13:24:51,727 [Listener at 0.0.0.0/13551] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.block.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.block.client.port appended with serviceId and nodeId
2021-10-05 13:24:51,728 [Listener at 0.0.0.0/13551] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.datanode.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.datanode.port appended with serviceId and nodeId
2021-10-05 13:24:51,735 [EndpointStateMachine task thread for /127.0.0.1:15041 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15041. Already tried 13 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:24:51,788 [Listener at 0.0.0.0/13551] WARN  server.ServerUtils (ServerUtils.java:getDBPath(225)) - ozone.om.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2021-10-05 13:24:51,790 [Listener at 0.0.0.0/13551] INFO  codec.OmKeyInfoCodec (OmKeyInfoCodec.java:<init>(51)) - OmKeyInfoCodec ignorePipeline = true
2021-10-05 13:24:51,790 [Listener at 0.0.0.0/13551] INFO  codec.RepeatedOmKeyInfoCodec (RepeatedOmKeyInfoCodec.java:<init>(42)) - RepeatedOmKeyInfoCodec ignorePipeline = true
2021-10-05 13:24:51,792 [EndpointStateMachine task thread for /127.0.0.1:15031 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15031. Already tried 2 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:24:51,793 [EndpointStateMachine task thread for /127.0.0.1:15021 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15021. Already tried 2 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:24:52,026 [Listener at 0.0.0.0/13551] INFO  om.OzoneManager (OzoneManager.java:addS3GVolumeToDB(4127)) - Created Volume s3v With Owner runner required for S3Gateway operations.
2021-10-05 13:24:52,026 [Listener at 0.0.0.0/13551] WARN  server.ServerUtils (ServerUtils.java:getDefaultRatisDirectory(237)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2021-10-05 13:24:52,027 [Listener at 0.0.0.0/13551] WARN  utils.OzoneManagerRatisUtils (OzoneManagerRatisUtils.java:getOMRatisSnapshotDirectory(435)) - ozone.om.ratis.snapshot.dir is not configured. Falling back to ozone.metadata.dirs config
2021-10-05 13:24:52,028 [Listener at 0.0.0.0/13551] WARN  impl.MetricRegistriesImpl (MetricRegistriesImpl.java:addReporterRegistration(111)) - New reporters are added after registries were created. Some metrics will be missing from the reporter. Please add reporter before adding any new registry.
2021-10-05 13:24:52,030 [Listener at 0.0.0.0/13551] WARN  impl.MetricRegistriesImpl (MetricRegistriesImpl.java:addReporterRegistration(111)) - New reporters are added after registries were created. Some metrics will be missing from the reporter. Please add reporter before adding any new registry.
2021-10-05 13:24:52,031 [Listener at 0.0.0.0/13551] WARN  server.ServerUtils (ServerUtils.java:getDefaultRatisDirectory(237)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2021-10-05 13:24:52,035 [Listener at 0.0.0.0/13551] INFO  ratis.OzoneManagerRatisServer (OzoneManagerRatisServer.java:<init>(158)) - Instantiating OM Ratis server with groupID: om-service-test1 and peers: localhost:13300
2021-10-05 13:24:52,035 [Listener at 0.0.0.0/13551] INFO  ratis.OzoneManagerStateMachine (OzoneManagerStateMachine.java:loadSnapshotInfoFromDB(605)) - LastAppliedIndex is set from TransactionInfo from OM DB as (t:0, i:~)
2021-10-05 13:24:52,047 [Listener at 0.0.0.0/13551] INFO  server.RaftServer (ConfUtils.java:logGet(44)) - raft.rpc.type = GRPC (default)
2021-10-05 13:24:52,047 [Listener at 0.0.0.0/13551] INFO  grpc.GrpcFactory (GrpcFactory.java:checkPooledByteBufAllocatorUseCacheForAllThreads(48)) - PERFORMANCE WARNING: useCacheForAllThreads is true that may cause Netty to create a lot garbage objects and, as a result, trigger GC.
	It is recommended to disable useCacheForAllThreads by setting -Dorg.apache.ratis.thirdparty.io.netty.allocator.useCacheForAllThreads=false in command line.
2021-10-05 13:24:52,048 [Listener at 0.0.0.0/13551] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(44)) - raft.grpc.admin.port = -1 (default)
2021-10-05 13:24:52,048 [Listener at 0.0.0.0/13551] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(44)) - raft.grpc.server.port = 13300 (custom)
2021-10-05 13:24:52,048 [Listener at 0.0.0.0/13551] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(44)) - raft.grpc.client.port = -1 (default)
2021-10-05 13:24:52,048 [Listener at 0.0.0.0/13551] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(44)) - raft.grpc.server.port = 13300 (custom)
2021-10-05 13:24:52,048 [Listener at 0.0.0.0/13551] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(44)) - raft.grpc.server.port = 13300 (custom)
2021-10-05 13:24:52,048 [Listener at 0.0.0.0/13551] INFO  server.GrpcService (ConfUtils.java:logGet(44)) - raft.grpc.message.size.max = 33554432 (custom)
2021-10-05 13:24:52,048 [Listener at 0.0.0.0/13551] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2021-10-05 13:24:52,048 [Listener at 0.0.0.0/13551] INFO  server.GrpcService (ConfUtils.java:logGet(44)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2021-10-05 13:24:52,049 [Listener at 0.0.0.0/13551] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.request.timeout = 3000ms (default)
2021-10-05 13:24:52,050 [Listener at 0.0.0.0/13551] INFO  impl.DataStreamServerImpl (ConfUtils.java:logGet(44)) - raft.datastream.type = DISABLED (default)
2021-10-05 13:24:52,050 [Listener at 0.0.0.0/13551] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.slowness.timeout = 2s (custom)
2021-10-05 13:24:52,050 [Listener at 0.0.0.0/13551] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.leaderelection.leader.step-down.wait-time = 10s (default)
2021-10-05 13:24:52,050 [Listener at 0.0.0.0/13551] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.storage.dir = [/home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-36b87918-66c6-4e2c-9c49-5aa8dab94a1f/omNode-1/ratis] (custom)
2021-10-05 13:24:52,060 [Listener at 0.0.0.0/13551] INFO  server.RaftServer (RaftServerProxy.java:addNew(95)) - omNode-1: addNew group-523986131536:[omNode-1|rpc:localhost:13300|priority:0] returns group-523986131536:java.util.concurrent.CompletableFuture@231e72e1[Not completed]
2021-10-05 13:24:52,060 [Listener at 0.0.0.0/13551] INFO  om.OzoneManager (OzoneManager.java:initializeRatisServer(1585)) - OzoneManager Ratis server initialized at port 13300
2021-10-05 13:24:52,061 [Listener at 0.0.0.0/13551] INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(90)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 2000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false.
2021-10-05 13:24:52,062 [pool-251-thread-1] INFO  server.RaftServer$Division (RaftServerImpl.java:<init>(181)) - omNode-1: new RaftServerImpl for group-523986131536:[omNode-1|rpc:localhost:13300|priority:0] with OzoneManagerStateMachine:uninitialized
2021-10-05 13:24:52,063 [pool-251-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.timeout.min = 1s (custom)
2021-10-05 13:24:52,063 [pool-251-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.timeout.max = 1200ms (custom)
2021-10-05 13:24:52,063 [pool-251-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.sleep.time = 25ms (default)
2021-10-05 13:24:52,063 [pool-251-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.slowness.timeout = 2s (custom)
2021-10-05 13:24:52,063 [pool-251-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.leaderelection.leader.step-down.wait-time = 10s (default)
2021-10-05 13:24:52,063 [pool-251-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.sleep.deviation.threshold = 300ms (default)
2021-10-05 13:24:52,063 [pool-251-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.appender.install.snapshot.enabled = false (custom)
2021-10-05 13:24:52,063 [pool-251-thread-1] INFO  server.RaftServer$Division (ServerState.java:<init>(105)) - omNode-1@group-523986131536: ConfigurationManager, init=-1: [omNode-1|rpc:localhost:13300|priority:0], old=null, confs=<EMPTY_MAP>
2021-10-05 13:24:52,064 [pool-251-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.storage.dir = [/home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-36b87918-66c6-4e2c-9c49-5aa8dab94a1f/omNode-1/ratis] (custom)
2021-10-05 13:24:52,064 [pool-251-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.corruption.policy = EXCEPTION (default)
2021-10-05 13:24:52,064 [pool-251-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.storage.free-space.min = 0MB (=0) (default)
2021-10-05 13:24:52,064 [pool-251-thread-1] INFO  storage.RaftStorageDirectory (RaftStorageDirectoryImpl.java:analyzeStorage(135)) - The storage directory /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-36b87918-66c6-4e2c-9c49-5aa8dab94a1f/omNode-1/ratis/c9bc4cf4-3bc3-3c60-a66b-523986131536 does not exist. Creating ...
2021-10-05 13:24:52,065 [Socket Reader #1 for port 13296] INFO  ipc.Server (Server.java:run(1265)) - Starting Socket Reader #1 for port 13296
2021-10-05 13:24:52,066 [pool-251-thread-1] INFO  storage.RaftStorageDirectory (RaftStorageDirectoryImpl.java:tryLock(230)) - Lock on /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-36b87918-66c6-4e2c-9c49-5aa8dab94a1f/omNode-1/ratis/c9bc4cf4-3bc3-3c60-a66b-523986131536/in_use.lock acquired by nodename 17451@fv-az270-324
2021-10-05 13:24:52,067 [pool-251-thread-1] INFO  storage.RaftStorage (RaftStorageImpl.java:format(89)) - Storage directory /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-36b87918-66c6-4e2c-9c49-5aa8dab94a1f/omNode-1/ratis/c9bc4cf4-3bc3-3c60-a66b-523986131536 has been successfully formatted.
2021-10-05 13:24:52,067 [pool-251-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.notification.no-leader.timeout = 2s (custom)
2021-10-05 13:24:52,068 [pool-251-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.use.memory = false (default)
2021-10-05 13:24:52,068 [pool-251-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.purge.gap = 1000000 (custom)
2021-10-05 13:24:52,068 [pool-251-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2021-10-05 13:24:52,068 [pool-251-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.segment.size.max = 4194304 (custom)
2021-10-05 13:24:52,068 [pool-251-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.segment.cache.num.max = 2 (custom)
2021-10-05 13:24:52,069 [pool-251-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.segment.cache.size.max = 200MB (=209715200) (default)
2021-10-05 13:24:52,069 [pool-251-thread-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:<init>(182)) - new omNode-1@group-523986131536-SegmentedRaftLogWorker for RaftStorageImpl:Storage Directory /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-36b87918-66c6-4e2c-9c49-5aa8dab94a1f/omNode-1/ratis/c9bc4cf4-3bc3-3c60-a66b-523986131536
2021-10-05 13:24:52,069 [pool-251-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.queue.byte-limit = 64MB (=67108864) (default)
2021-10-05 13:24:52,069 [pool-251-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.queue.element-limit = 4096 (default)
2021-10-05 13:24:52,069 [pool-251-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.segment.size.max = 4194304 (custom)
2021-10-05 13:24:52,069 [pool-251-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.preallocated.size = 4194304 (custom)
2021-10-05 13:24:52,069 [pool-251-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.force.sync.num = 128 (default)
2021-10-05 13:24:52,069 [pool-251-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.statemachine.data.sync = true (default)
2021-10-05 13:24:52,069 [pool-251-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2021-10-05 13:24:52,069 [pool-251-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2021-10-05 13:24:52,076 [pool-251-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.write.buffer.size = 64KB (=65536) (default)
2021-10-05 13:24:52,076 [pool-251-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.statemachine.data.caching.enabled = false (default)
2021-10-05 13:24:52,076 [pool-251-thread-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:lambda$new$0(133)) - omNode-1@group-523986131536-SegmentedRaftLogWorker: flushIndex: setUnconditionally 0 -> -1
2021-10-05 13:24:52,099 [pool-251-thread-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:lambda$new$0(133)) - omNode-1@group-523986131536-SegmentedRaftLogWorker: safeCacheEvictIndex: setUnconditionally 0 -> -1
2021-10-05 13:24:52,103 [pool-251-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2021-10-05 13:24:52,103 [pool-251-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.snapshot.auto.trigger.threshold = 400000 (default)
2021-10-05 13:24:52,103 [pool-251-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.snapshot.retention.file.num = -1 (default)
2021-10-05 13:24:52,103 [pool-251-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.purge.upto.snapshot.index = true (custom)
2021-10-05 13:24:52,103 [pool-251-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.retrycache.expirytime = 300s (custom)
2021-10-05 13:24:52,107 [pool-251-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.retrycache.statistics.expirytime = 100μs (default)
2021-10-05 13:24:52,114 [Listener at 127.0.0.1/13296] INFO  om.OzoneManager (OzoneManager.java:initFSOLayout(4333)) - Configured ozone.om.metadata.layout=SIMPLE and disabled optimized OM FS operations
2021-10-05 13:24:52,118 [Listener at 127.0.0.1/13296] INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:init(158)) - OzoneManager metrics system started (again)
2021-10-05 13:24:52,142 [Listener at 127.0.0.1/13296] INFO  om.OzoneManager (OzoneManager.java:start(1281)) - OzoneManager RPC server is listening at localhost/127.0.0.1:13296
2021-10-05 13:24:52,142 [Listener at 127.0.0.1/13296] INFO  ratis.OzoneManagerRatisServer (OzoneManagerRatisServer.java:start(516)) - Starting OzoneManagerRatisServer omNode-1 at port 13300
2021-10-05 13:24:52,142 [Listener at 127.0.0.1/13296] INFO  server.RaftServer$Division (RaftServerImpl.java:start(296)) - omNode-1@group-523986131536: start as a follower, conf=-1: [omNode-1|rpc:localhost:13300|priority:0], old=null
2021-10-05 13:24:52,142 [Listener at 127.0.0.1/13296] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(285)) - omNode-1@group-523986131536: changes role from      null to FOLLOWER at term 0 for startAsFollower
2021-10-05 13:24:52,149 [Listener at 127.0.0.1/13296] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(130)) - omNode-1: start omNode-1@group-523986131536-FollowerState
2021-10-05 13:24:52,150 [Listener at 127.0.0.1/13296] INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-523986131536,id=omNode-1
2021-10-05 13:24:52,152 [Listener at 127.0.0.1/13296] INFO  server.RaftServer (RaftServerProxy.java:lambda$start$5(374)) - omNode-1: start RPC server
2021-10-05 13:24:52,154 [Listener at 127.0.0.1/13296] INFO  server.GrpcService (GrpcService.java:startImpl(253)) - omNode-1: GrpcService started, listening on 13300
2021-10-05 13:24:52,160 [Listener at 127.0.0.1/13296] INFO  om.OzoneManager (OzoneManager.java:start(1299)) - Version File has different layout version (0) than OM DB (null). That is expected if this OM has never been finalized to a newer layout version.
2021-10-05 13:24:52,160 [org.apache.ratis.util.JvmPauseMonitor$$Lambda$499/1586779822@7f4358b8] INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(103)) - JvmPauseMonitor-omNode-1: Started
2021-10-05 13:24:52,199 [Listener at 127.0.0.1/13296] INFO  http.BaseHttpServer (BaseHttpServer.java:newHttpServer2BuilderForOzone(209)) - Starting Web-server for ozoneManager at: http://0.0.0.0:13298
2021-10-05 13:24:52,199 [Listener at 127.0.0.1/13296] INFO  http.BaseHttpServer (BaseHttpServer.java:<init>(107)) - Hadoop Security Enabled: false Ozone Security Enabled: false Ozone HTTP Security Enabled: false 
2021-10-05 13:24:52,200 [Listener at 127.0.0.1/13296] INFO  server.AuthenticationFilter (AuthenticationFilter.java:constructSecretProvider(240)) - Unable to initialize FileSignerSecretProvider, falling back to use random secrets.
2021-10-05 13:24:52,205 [Listener at 127.0.0.1/13296] WARN  http.HttpRequestLog (HttpRequestLog.java:getRequestLog(103)) - Jetty request log can only be enabled using Log4j
2021-10-05 13:24:52,206 [Listener at 127.0.0.1/13296] INFO  http.HttpServer2 (HttpServer2.java:addGlobalFilter(1030)) - Added global filter 'safety' (class=org.apache.hadoop.hdds.server.http.HttpServer2$QuotingInputFilter)
2021-10-05 13:24:52,207 [Listener at 127.0.0.1/13296] INFO  http.HttpServer2 (HttpServer2.java:addFilter(1006)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context ozoneManager
2021-10-05 13:24:52,207 [Listener at 127.0.0.1/13296] INFO  http.HttpServer2 (HttpServer2.java:addFilter(1014)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context logs
2021-10-05 13:24:52,207 [Listener at 127.0.0.1/13296] INFO  http.HttpServer2 (HttpServer2.java:addFilter(1014)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context static
2021-10-05 13:24:52,208 [Listener at 127.0.0.1/13296] INFO  http.HttpServer2 (HttpServer2.java:bindListener(1249)) - Jetty bound to port 13298
2021-10-05 13:24:52,208 [Listener at 127.0.0.1/13296] INFO  server.Server (Server.java:doStart(375)) - jetty-9.4.43.v20210629; built: 2021-06-30T11:07:22.254Z; git: 526006ecfa3af7f1a27ef3a288e2bef7ea9dd7e8; jvm 1.8.0_292-b10
2021-10-05 13:24:52,260 [Listener at 127.0.0.1/13296] INFO  server.session (DefaultSessionIdManager.java:doStart(334)) - DefaultSessionIdManager workerName=node0
2021-10-05 13:24:52,260 [Listener at 127.0.0.1/13296] INFO  server.session (DefaultSessionIdManager.java:doStart(339)) - No SessionScavenger set, using defaults
2021-10-05 13:24:52,260 [Listener at 127.0.0.1/13296] INFO  server.session (HouseKeeper.java:startScavenging(132)) - node0 Scavenging every 660000ms
2021-10-05 13:24:52,270 [Listener at 127.0.0.1/13296] INFO  handler.ContextHandler (ContextHandler.java:doStart(915)) - Started o.e.j.s.ServletContextHandler@25dc4d01{logs,/logs,file:///home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/log,AVAILABLE}
2021-10-05 13:24:52,271 [Listener at 127.0.0.1/13296] INFO  handler.ContextHandler (ContextHandler.java:doStart(915)) - Started o.e.j.s.ServletContextHandler@3dfabb85{static,/static,file:///home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-classes/webapps/static,AVAILABLE}
2021-10-05 13:24:52,275 [Listener at 127.0.0.1/13296] INFO  handler.ContextHandler (ContextHandler.java:doStart(915)) - Started o.e.j.w.WebAppContext@5f3f31df{ozoneManager,/,file:///home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-classes/webapps/ozoneManager/,AVAILABLE}{file:/home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-classes/webapps/ozoneManager}
2021-10-05 13:24:52,279 [Listener at 127.0.0.1/13296] INFO  server.AbstractConnector (AbstractConnector.java:doStart(331)) - Started ServerConnector@403eab3{HTTP/1.1, (http/1.1)}{0.0.0.0:13298}
2021-10-05 13:24:52,279 [Listener at 127.0.0.1/13296] INFO  server.Server (Server.java:doStart(415)) - Started @85939ms
2021-10-05 13:24:52,279 [Listener at 127.0.0.1/13296] WARN  impl.MetricsSystemImpl (MetricsSystemImpl.java:register(279)) - Sink prometheus already exists!
2021-10-05 13:24:52,281 [Listener at 127.0.0.1/13296] INFO  http.BaseHttpServer (BaseHttpServer.java:updateConnectorAddress(329)) - HTTP server of ozoneManager listening at http://0.0.0.0:13298
2021-10-05 13:24:52,286 [IPC Server Responder] INFO  ipc.Server (Server.java:run(1507)) - IPC Server Responder: starting
2021-10-05 13:24:52,455 [Listener at 127.0.0.1/13296] INFO  om.OzoneManager (OzoneManager.java:startTrashEmptier(1543)) - Trash Interval set to 0. Files deleted will not move to trash
2021-10-05 13:24:52,460 [Listener at 127.0.0.1/13296] INFO  ozone.MiniOzoneHAClusterImpl (MiniOzoneHAClusterImpl.java:createOMService(485)) - Started OzoneManager omNode-1 RPC server at localhost/127.0.0.1:13296
2021-10-05 13:24:52,463 [IPC Server listener on 13296] INFO  ipc.Server (Server.java:run(1344)) - IPC Server listener on 13296: starting
2021-10-05 13:24:52,470 [org.apache.hadoop.util.JvmPauseMonitor$Monitor@38f42298] INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(188)) - Starting JVM pause monitor
2021-10-05 13:24:52,485 [Listener at 127.0.0.1/13296] WARN  impl.MetricRegistriesImpl (MetricRegistriesImpl.java:addReporterRegistration(111)) - New reporters are added after registries were created. Some metrics will be missing from the reporter. Please add reporter before adding any new registry.
2021-10-05 13:24:52,486 [Listener at 127.0.0.1/13296] WARN  impl.MetricRegistriesImpl (MetricRegistriesImpl.java:addReporterRegistration(111)) - New reporters are added after registries were created. Some metrics will be missing from the reporter. Please add reporter before adding any new registry.
2021-10-05 13:24:52,486 [Listener at 127.0.0.1/13296] INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:init(158)) - HddsDatanode metrics system started (again)
2021-10-05 13:24:52,521 [Listener at 127.0.0.1/13296] INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:start(234)) - HddsDatanodeService host:fv-az270-324.tacnzluakwdehk1hpragurqkma.bx.internal.cloudapp.net ip:10.1.0.10
2021-10-05 13:24:52,585 [Listener at 127.0.0.1/13296] INFO  upgrade.AbstractLayoutVersionManager (AbstractLayoutVersionManager.java:init(79)) - Initializing Layout version manager with metadata layout = SCM_HA (version = 2), software layout = SCM_HA (version = 2)
2021-10-05 13:24:52,687 [Listener at 127.0.0.1/13296] INFO  reflections.Reflections (Reflections.java:scan(232)) - Reflections took 100 ms to scan 7 urls, producing 119 keys and 275 values 
2021-10-05 13:24:52,689 [Listener at 127.0.0.1/13296] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.client.port appended with serviceId and nodeId
2021-10-05 13:24:52,689 [Listener at 127.0.0.1/13296] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.block.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.block.client.port appended with serviceId and nodeId
2021-10-05 13:24:52,689 [Listener at 127.0.0.1/13296] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.datanode.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.datanode.port appended with serviceId and nodeId
2021-10-05 13:24:52,689 [Listener at 127.0.0.1/13296] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.client.port appended with serviceId and nodeId
2021-10-05 13:24:52,689 [Listener at 127.0.0.1/13296] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.block.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.block.client.port appended with serviceId and nodeId
2021-10-05 13:24:52,689 [Listener at 127.0.0.1/13296] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.datanode.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.datanode.port appended with serviceId and nodeId
2021-10-05 13:24:52,689 [Listener at 127.0.0.1/13296] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.client.port appended with serviceId and nodeId
2021-10-05 13:24:52,689 [Listener at 127.0.0.1/13296] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.block.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.block.client.port appended with serviceId and nodeId
2021-10-05 13:24:52,689 [Listener at 127.0.0.1/13296] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.datanode.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.datanode.port appended with serviceId and nodeId
2021-10-05 13:24:52,699 [Listener at 127.0.0.1/13296] INFO  volume.HddsVolume (HddsVolume.java:<init>(120)) - Creating HddsVolume: /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-36b87918-66c6-4e2c-9c49-5aa8dab94a1f/datanode-0/data-0/containers/hdds of storage type : DISK capacity : 9223372036854775807
2021-10-05 13:24:52,700 [Listener at 127.0.0.1/13296] INFO  volume.MutableVolumeSet (MutableVolumeSet.java:initializeVolumeSet(168)) - Added Volume : /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-36b87918-66c6-4e2c-9c49-5aa8dab94a1f/datanode-0/data-0/containers/hdds to VolumeSet
2021-10-05 13:24:52,700 [Listener at 127.0.0.1/13296] INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(141)) - Scheduling a check for /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-36b87918-66c6-4e2c-9c49-5aa8dab94a1f/datanode-0/data-0/containers/hdds
2021-10-05 13:24:52,719 [Listener at 127.0.0.1/13296] INFO  volume.StorageVolumeChecker (StorageVolumeChecker.java:checkAllVolumes(202)) - Scheduled health check for volume /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-36b87918-66c6-4e2c-9c49-5aa8dab94a1f/datanode-0/data-0/containers/hdds
2021-10-05 13:24:52,736 [EndpointStateMachine task thread for /127.0.0.1:15041 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15041. Already tried 14 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:24:52,741 [Listener at 127.0.0.1/13296] INFO  volume.MutableVolumeSet (MutableVolumeSet.java:initializeVolumeSet(168)) - Added Volume : /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-36b87918-66c6-4e2c-9c49-5aa8dab94a1f/datanode-0/data/ratis to VolumeSet
2021-10-05 13:24:52,741 [Listener at 127.0.0.1/13296] INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(141)) - Scheduling a check for /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-36b87918-66c6-4e2c-9c49-5aa8dab94a1f/datanode-0/data/ratis
2021-10-05 13:24:52,741 [Listener at 127.0.0.1/13296] INFO  volume.StorageVolumeChecker (StorageVolumeChecker.java:checkAllVolumes(202)) - Scheduled health check for volume /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-36b87918-66c6-4e2c-9c49-5aa8dab94a1f/datanode-0/data/ratis
2021-10-05 13:24:52,793 [EndpointStateMachine task thread for /127.0.0.1:15021 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15021. Already tried 3 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:24:52,793 [EndpointStateMachine task thread for /127.0.0.1:15031 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15031. Already tried 3 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:24:52,803 [Thread-1462] INFO  ozoneimpl.ContainerReader (ContainerReader.java:readVolume(172)) - Finish verifying containers on volume /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-36b87918-66c6-4e2c-9c49-5aa8dab94a1f/datanode-0/data-0/containers/hdds
2021-10-05 13:24:52,803 [Listener at 127.0.0.1/13296] INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:buildContainerSet(236)) - Build ContainerSet costs 0s
2021-10-05 13:24:52,806 [Listener at 127.0.0.1/13296] INFO  server.RaftServer (ConfUtils.java:logGet(44)) - raft.rpc.type = GRPC (default)
2021-10-05 13:24:52,806 [Listener at 127.0.0.1/13296] INFO  grpc.GrpcFactory (GrpcFactory.java:checkPooledByteBufAllocatorUseCacheForAllThreads(48)) - PERFORMANCE WARNING: useCacheForAllThreads is true that may cause Netty to create a lot garbage objects and, as a result, trigger GC.
	It is recommended to disable useCacheForAllThreads by setting -Dorg.apache.ratis.thirdparty.io.netty.allocator.useCacheForAllThreads=false in command line.
2021-10-05 13:24:52,806 [Listener at 127.0.0.1/13296] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(44)) - raft.grpc.admin.port = 0 (custom)
2021-10-05 13:24:52,806 [Listener at 127.0.0.1/13296] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(44)) - raft.grpc.client.port = 0 (custom)
2021-10-05 13:24:52,806 [Listener at 127.0.0.1/13296] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(44)) - raft.grpc.server.port = 0 (default)
2021-10-05 13:24:52,806 [Listener at 127.0.0.1/13296] INFO  server.GrpcService (ConfUtils.java:logGet(44)) - raft.grpc.message.size.max = 32MB (=33554432) (custom)
2021-10-05 13:24:52,806 [Listener at 127.0.0.1/13296] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2021-10-05 13:24:52,807 [Listener at 127.0.0.1/13296] INFO  server.GrpcService (ConfUtils.java:logGet(44)) - raft.grpc.flow.control.window = 5MB (=5242880) (custom)
2021-10-05 13:24:52,807 [Listener at 127.0.0.1/13296] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.request.timeout = 60s (custom)
2021-10-05 13:24:52,808 [Listener at 127.0.0.1/13296] INFO  impl.DataStreamServerImpl (ConfUtils.java:logGet(44)) - raft.datastream.type = DISABLED (default)
2021-10-05 13:24:52,808 [Listener at 127.0.0.1/13296] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.slowness.timeout = 300s (custom)
2021-10-05 13:24:52,808 [Listener at 127.0.0.1/13296] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.leaderelection.leader.step-down.wait-time = 10s (default)
2021-10-05 13:24:52,808 [Listener at 127.0.0.1/13296] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.storage.dir = [/home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-36b87918-66c6-4e2c-9c49-5aa8dab94a1f/datanode-0/data/ratis] (custom)
2021-10-05 13:24:52,823 [Listener at 127.0.0.1/13296] INFO  http.BaseHttpServer (BaseHttpServer.java:newHttpServer2BuilderForOzone(209)) - Starting Web-server for hddsDatanode at: http://0.0.0.0:0
2021-10-05 13:24:52,823 [Listener at 127.0.0.1/13296] INFO  http.BaseHttpServer (BaseHttpServer.java:<init>(107)) - Hadoop Security Enabled: false Ozone Security Enabled: false Ozone HTTP Security Enabled: false 
2021-10-05 13:24:52,832 [Listener at 127.0.0.1/13296] INFO  server.AuthenticationFilter (AuthenticationFilter.java:constructSecretProvider(240)) - Unable to initialize FileSignerSecretProvider, falling back to use random secrets.
2021-10-05 13:24:52,835 [Listener at 127.0.0.1/13296] WARN  http.HttpRequestLog (HttpRequestLog.java:getRequestLog(103)) - Jetty request log can only be enabled using Log4j
2021-10-05 13:24:52,836 [Listener at 127.0.0.1/13296] INFO  http.HttpServer2 (HttpServer2.java:addGlobalFilter(1030)) - Added global filter 'safety' (class=org.apache.hadoop.hdds.server.http.HttpServer2$QuotingInputFilter)
2021-10-05 13:24:52,837 [Listener at 127.0.0.1/13296] INFO  http.HttpServer2 (HttpServer2.java:addFilter(1006)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context hddsDatanode
2021-10-05 13:24:52,837 [Listener at 127.0.0.1/13296] INFO  http.HttpServer2 (HttpServer2.java:addFilter(1014)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context static
2021-10-05 13:24:52,837 [Listener at 127.0.0.1/13296] INFO  http.HttpServer2 (HttpServer2.java:addFilter(1014)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context logs
2021-10-05 13:24:52,837 [Listener at 127.0.0.1/13296] INFO  http.HttpServer2 (HttpServer2.java:bindListener(1249)) - Jetty bound to port 37557
2021-10-05 13:24:52,838 [Listener at 127.0.0.1/13296] INFO  server.Server (Server.java:doStart(375)) - jetty-9.4.43.v20210629; built: 2021-06-30T11:07:22.254Z; git: 526006ecfa3af7f1a27ef3a288e2bef7ea9dd7e8; jvm 1.8.0_292-b10
2021-10-05 13:24:52,856 [Listener at 127.0.0.1/13296] INFO  server.session (DefaultSessionIdManager.java:doStart(334)) - DefaultSessionIdManager workerName=node0
2021-10-05 13:24:52,856 [Listener at 127.0.0.1/13296] INFO  server.session (DefaultSessionIdManager.java:doStart(339)) - No SessionScavenger set, using defaults
2021-10-05 13:24:52,856 [Listener at 127.0.0.1/13296] INFO  server.session (HouseKeeper.java:startScavenging(132)) - node0 Scavenging every 660000ms
2021-10-05 13:24:52,864 [Listener at 127.0.0.1/13296] INFO  handler.ContextHandler (ContextHandler.java:doStart(915)) - Started o.e.j.s.ServletContextHandler@544f5414{logs,/logs,file:///home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/log,AVAILABLE}
2021-10-05 13:24:52,864 [Listener at 127.0.0.1/13296] INFO  handler.ContextHandler (ContextHandler.java:doStart(915)) - Started o.e.j.s.ServletContextHandler@5af08862{static,/static,jar:file:/home/runner/.m2/repository/org/apache/ozone/hdds-container-service/1.2.0-SNAPSHOT/hdds-container-service-1.2.0-SNAPSHOT.jar!/webapps/static,AVAILABLE}
2021-10-05 13:24:52,944 [Listener at 127.0.0.1/13296] INFO  handler.ContextHandler (ContextHandler.java:doStart(915)) - Started o.e.j.w.WebAppContext@20afcc5c{hddsDatanode,/,file:///tmp/jetty-0_0_0_0-37557-hdds-container-service-1_2_0-SNAPSHOT_jar-_-any-5658527191666595328/webapp/,AVAILABLE}{jar:file:/home/runner/.m2/repository/org/apache/ozone/hdds-container-service/1.2.0-SNAPSHOT/hdds-container-service-1.2.0-SNAPSHOT.jar!/webapps/hddsDatanode}
2021-10-05 13:24:52,955 [Listener at 127.0.0.1/13296] INFO  server.AbstractConnector (AbstractConnector.java:doStart(331)) - Started ServerConnector@4a314ae4{HTTP/1.1, (http/1.1)}{0.0.0.0:37557}
2021-10-05 13:24:52,956 [Listener at 127.0.0.1/13296] INFO  server.Server (Server.java:doStart(415)) - Started @86615ms
2021-10-05 13:24:52,956 [Listener at 127.0.0.1/13296] WARN  impl.MetricsSystemImpl (MetricsSystemImpl.java:register(279)) - Sink prometheus already exists!
2021-10-05 13:24:52,957 [Listener at 127.0.0.1/13296] INFO  http.BaseHttpServer (BaseHttpServer.java:updateConnectorAddress(329)) - HTTP server of hddsDatanode listening at http://0.0.0.0:37557
2021-10-05 13:24:52,961 [Listener at 127.0.0.1/13296] WARN  impl.MetricRegistriesImpl (MetricRegistriesImpl.java:addReporterRegistration(111)) - New reporters are added after registries were created. Some metrics will be missing from the reporter. Please add reporter before adding any new registry.
2021-10-05 13:24:52,961 [Listener at 127.0.0.1/13296] WARN  impl.MetricRegistriesImpl (MetricRegistriesImpl.java:addReporterRegistration(111)) - New reporters are added after registries were created. Some metrics will be missing from the reporter. Please add reporter before adding any new registry.
2021-10-05 13:24:52,961 [Listener at 127.0.0.1/13296] INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:init(158)) - HddsDatanode metrics system started (again)
2021-10-05 13:24:52,967 [Datanode State Machine Thread - 0] INFO  statemachine.DatanodeStateMachine (DatanodeStateMachine.java:lambda$startDaemon$0(456)) - Ozone container server started.
2021-10-05 13:24:52,995 [org.apache.hadoop.util.JvmPauseMonitor$Monitor@3e43cd9c] INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(188)) - Starting JVM pause monitor
2021-10-05 13:24:52,998 [Listener at 127.0.0.1/13296] INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:start(234)) - HddsDatanodeService host:fv-az270-324.tacnzluakwdehk1hpragurqkma.bx.internal.cloudapp.net ip:10.1.0.10
2021-10-05 13:24:53,007 [Datanode State Machine Task Thread - 0] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.client.port appended with serviceId and nodeId
2021-10-05 13:24:53,007 [Datanode State Machine Task Thread - 0] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.block.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.block.client.port appended with serviceId and nodeId
2021-10-05 13:24:53,007 [Datanode State Machine Task Thread - 0] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.datanode.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.datanode.port appended with serviceId and nodeId
2021-10-05 13:24:53,007 [Datanode State Machine Task Thread - 0] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.client.port appended with serviceId and nodeId
2021-10-05 13:24:53,008 [Datanode State Machine Task Thread - 0] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.block.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.block.client.port appended with serviceId and nodeId
2021-10-05 13:24:53,008 [Datanode State Machine Task Thread - 0] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.datanode.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.datanode.port appended with serviceId and nodeId
2021-10-05 13:24:53,008 [Datanode State Machine Task Thread - 0] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.client.port appended with serviceId and nodeId
2021-10-05 13:24:53,008 [Datanode State Machine Task Thread - 0] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.block.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.block.client.port appended with serviceId and nodeId
2021-10-05 13:24:53,008 [Datanode State Machine Task Thread - 0] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.datanode.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.datanode.port appended with serviceId and nodeId
2021-10-05 13:24:53,009 [Datanode State Machine Task Thread - 0] INFO  datanode.InitDatanodeState (InitDatanodeState.java:persistContainerDatanodeDetails(145)) - DatanodeDetails is persisted to /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-36b87918-66c6-4e2c-9c49-5aa8dab94a1f/datanode-0/meta/datanode.id
2021-10-05 13:24:53,058 [Listener at 127.0.0.1/13296] INFO  upgrade.AbstractLayoutVersionManager (AbstractLayoutVersionManager.java:init(79)) - Initializing Layout version manager with metadata layout = SCM_HA (version = 2), software layout = SCM_HA (version = 2)
2021-10-05 13:24:53,134 [Listener at 127.0.0.1/13296] INFO  reflections.Reflections (Reflections.java:scan(232)) - Reflections took 74 ms to scan 7 urls, producing 119 keys and 275 values 
2021-10-05 13:24:53,138 [Listener at 127.0.0.1/13296] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.client.port appended with serviceId and nodeId
2021-10-05 13:24:53,139 [Listener at 127.0.0.1/13296] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.block.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.block.client.port appended with serviceId and nodeId
2021-10-05 13:24:53,140 [Listener at 127.0.0.1/13296] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.datanode.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.datanode.port appended with serviceId and nodeId
2021-10-05 13:24:53,142 [Listener at 127.0.0.1/13296] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.client.port appended with serviceId and nodeId
2021-10-05 13:24:53,142 [Listener at 127.0.0.1/13296] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.block.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.block.client.port appended with serviceId and nodeId
2021-10-05 13:24:53,142 [Listener at 127.0.0.1/13296] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.datanode.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.datanode.port appended with serviceId and nodeId
2021-10-05 13:24:53,142 [Listener at 127.0.0.1/13296] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.client.port appended with serviceId and nodeId
2021-10-05 13:24:53,142 [Listener at 127.0.0.1/13296] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.block.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.block.client.port appended with serviceId and nodeId
2021-10-05 13:24:53,142 [Listener at 127.0.0.1/13296] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.datanode.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.datanode.port appended with serviceId and nodeId
2021-10-05 13:24:53,144 [Listener at 127.0.0.1/13296] INFO  volume.HddsVolume (HddsVolume.java:<init>(120)) - Creating HddsVolume: /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-36b87918-66c6-4e2c-9c49-5aa8dab94a1f/datanode-1/data-0/containers/hdds of storage type : DISK capacity : 9223372036854775807
2021-10-05 13:24:53,145 [Listener at 127.0.0.1/13296] INFO  volume.MutableVolumeSet (MutableVolumeSet.java:initializeVolumeSet(168)) - Added Volume : /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-36b87918-66c6-4e2c-9c49-5aa8dab94a1f/datanode-1/data-0/containers/hdds to VolumeSet
2021-10-05 13:24:53,151 [Listener at 127.0.0.1/13296] INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(141)) - Scheduling a check for /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-36b87918-66c6-4e2c-9c49-5aa8dab94a1f/datanode-1/data-0/containers/hdds
2021-10-05 13:24:53,155 [Listener at 127.0.0.1/13296] INFO  volume.StorageVolumeChecker (StorageVolumeChecker.java:checkAllVolumes(202)) - Scheduled health check for volume /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-36b87918-66c6-4e2c-9c49-5aa8dab94a1f/datanode-1/data-0/containers/hdds
2021-10-05 13:24:53,176 [Listener at 127.0.0.1/13296] INFO  volume.MutableVolumeSet (MutableVolumeSet.java:initializeVolumeSet(168)) - Added Volume : /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-36b87918-66c6-4e2c-9c49-5aa8dab94a1f/datanode-1/data/ratis to VolumeSet
2021-10-05 13:24:53,177 [Listener at 127.0.0.1/13296] INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(141)) - Scheduling a check for /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-36b87918-66c6-4e2c-9c49-5aa8dab94a1f/datanode-1/data/ratis
2021-10-05 13:24:53,177 [Listener at 127.0.0.1/13296] INFO  volume.StorageVolumeChecker (StorageVolumeChecker.java:checkAllVolumes(202)) - Scheduled health check for volume /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-36b87918-66c6-4e2c-9c49-5aa8dab94a1f/datanode-1/data/ratis
2021-10-05 13:24:53,229 [Thread-1474] INFO  ozoneimpl.ContainerReader (ContainerReader.java:readVolume(172)) - Finish verifying containers on volume /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-36b87918-66c6-4e2c-9c49-5aa8dab94a1f/datanode-1/data-0/containers/hdds
2021-10-05 13:24:53,233 [Listener at 127.0.0.1/13296] INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:buildContainerSet(236)) - Build ContainerSet costs 0s
2021-10-05 13:24:53,236 [Listener at 127.0.0.1/13296] INFO  server.RaftServer (ConfUtils.java:logGet(44)) - raft.rpc.type = GRPC (default)
2021-10-05 13:24:53,236 [Listener at 127.0.0.1/13296] INFO  grpc.GrpcFactory (GrpcFactory.java:checkPooledByteBufAllocatorUseCacheForAllThreads(48)) - PERFORMANCE WARNING: useCacheForAllThreads is true that may cause Netty to create a lot garbage objects and, as a result, trigger GC.
	It is recommended to disable useCacheForAllThreads by setting -Dorg.apache.ratis.thirdparty.io.netty.allocator.useCacheForAllThreads=false in command line.
2021-10-05 13:24:53,236 [Listener at 127.0.0.1/13296] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(44)) - raft.grpc.admin.port = 0 (custom)
2021-10-05 13:24:53,236 [Listener at 127.0.0.1/13296] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(44)) - raft.grpc.client.port = 0 (custom)
2021-10-05 13:24:53,237 [Listener at 127.0.0.1/13296] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(44)) - raft.grpc.server.port = 0 (default)
2021-10-05 13:24:53,237 [Listener at 127.0.0.1/13296] INFO  server.GrpcService (ConfUtils.java:logGet(44)) - raft.grpc.message.size.max = 32MB (=33554432) (custom)
2021-10-05 13:24:53,237 [Listener at 127.0.0.1/13296] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2021-10-05 13:24:53,237 [Listener at 127.0.0.1/13296] INFO  server.GrpcService (ConfUtils.java:logGet(44)) - raft.grpc.flow.control.window = 5MB (=5242880) (custom)
2021-10-05 13:24:53,237 [Listener at 127.0.0.1/13296] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.request.timeout = 60s (custom)
2021-10-05 13:24:53,238 [Listener at 127.0.0.1/13296] INFO  impl.DataStreamServerImpl (ConfUtils.java:logGet(44)) - raft.datastream.type = DISABLED (default)
2021-10-05 13:24:53,239 [Listener at 127.0.0.1/13296] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.slowness.timeout = 300s (custom)
2021-10-05 13:24:53,239 [Listener at 127.0.0.1/13296] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.leaderelection.leader.step-down.wait-time = 10s (default)
2021-10-05 13:24:53,239 [Listener at 127.0.0.1/13296] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.storage.dir = [/home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-36b87918-66c6-4e2c-9c49-5aa8dab94a1f/datanode-1/data/ratis] (custom)
2021-10-05 13:24:53,244 [Listener at 127.0.0.1/13296] INFO  http.BaseHttpServer (BaseHttpServer.java:newHttpServer2BuilderForOzone(209)) - Starting Web-server for hddsDatanode at: http://0.0.0.0:0
2021-10-05 13:24:53,244 [Listener at 127.0.0.1/13296] INFO  http.BaseHttpServer (BaseHttpServer.java:<init>(107)) - Hadoop Security Enabled: false Ozone Security Enabled: false Ozone HTTP Security Enabled: false 
2021-10-05 13:24:53,250 [Listener at 127.0.0.1/13296] INFO  server.AuthenticationFilter (AuthenticationFilter.java:constructSecretProvider(240)) - Unable to initialize FileSignerSecretProvider, falling back to use random secrets.
2021-10-05 13:24:53,256 [Listener at 127.0.0.1/13296] WARN  http.HttpRequestLog (HttpRequestLog.java:getRequestLog(103)) - Jetty request log can only be enabled using Log4j
2021-10-05 13:24:53,256 [Listener at 127.0.0.1/13296] INFO  http.HttpServer2 (HttpServer2.java:addGlobalFilter(1030)) - Added global filter 'safety' (class=org.apache.hadoop.hdds.server.http.HttpServer2$QuotingInputFilter)
2021-10-05 13:24:53,257 [Listener at 127.0.0.1/13296] INFO  http.HttpServer2 (HttpServer2.java:addFilter(1006)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context hddsDatanode
2021-10-05 13:24:53,257 [Listener at 127.0.0.1/13296] INFO  http.HttpServer2 (HttpServer2.java:addFilter(1014)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context static
2021-10-05 13:24:53,257 [Listener at 127.0.0.1/13296] INFO  http.HttpServer2 (HttpServer2.java:addFilter(1014)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context logs
2021-10-05 13:24:53,258 [Listener at 127.0.0.1/13296] INFO  http.HttpServer2 (HttpServer2.java:bindListener(1249)) - Jetty bound to port 34503
2021-10-05 13:24:53,258 [Listener at 127.0.0.1/13296] INFO  server.Server (Server.java:doStart(375)) - jetty-9.4.43.v20210629; built: 2021-06-30T11:07:22.254Z; git: 526006ecfa3af7f1a27ef3a288e2bef7ea9dd7e8; jvm 1.8.0_292-b10
2021-10-05 13:24:53,326 [Listener at 127.0.0.1/13296] INFO  server.session (DefaultSessionIdManager.java:doStart(334)) - DefaultSessionIdManager workerName=node0
2021-10-05 13:24:53,326 [Listener at 127.0.0.1/13296] INFO  server.session (DefaultSessionIdManager.java:doStart(339)) - No SessionScavenger set, using defaults
2021-10-05 13:24:53,326 [Listener at 127.0.0.1/13296] INFO  server.session (HouseKeeper.java:startScavenging(132)) - node0 Scavenging every 660000ms
2021-10-05 13:24:53,333 [Listener at 127.0.0.1/13296] INFO  handler.ContextHandler (ContextHandler.java:doStart(915)) - Started o.e.j.s.ServletContextHandler@3b111f64{logs,/logs,file:///home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/log,AVAILABLE}
2021-10-05 13:24:53,333 [Listener at 127.0.0.1/13296] INFO  handler.ContextHandler (ContextHandler.java:doStart(915)) - Started o.e.j.s.ServletContextHandler@70163ce4{static,/static,jar:file:/home/runner/.m2/repository/org/apache/ozone/hdds-container-service/1.2.0-SNAPSHOT/hdds-container-service-1.2.0-SNAPSHOT.jar!/webapps/static,AVAILABLE}
2021-10-05 13:24:53,351 [omNode-1@group-523986131536-FollowerState] INFO  impl.FollowerState (FollowerState.java:run(134)) - omNode-1@group-523986131536-FollowerState: change to CANDIDATE, lastRpcElapsedTime:1201932246ns, electionTimeout:1169ms
2021-10-05 13:24:53,352 [omNode-1@group-523986131536-FollowerState] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(108)) - omNode-1: shutdown omNode-1@group-523986131536-FollowerState
2021-10-05 13:24:53,352 [omNode-1@group-523986131536-FollowerState] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(285)) - omNode-1@group-523986131536: changes role from  FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2021-10-05 13:24:53,352 [omNode-1@group-523986131536-FollowerState] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.leaderelection.pre-vote = false (custom)
2021-10-05 13:24:53,352 [omNode-1@group-523986131536-FollowerState] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(130)) - omNode-1: start omNode-1@group-523986131536-LeaderElection16
2021-10-05 13:24:53,377 [omNode-1@group-523986131536-LeaderElection16] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(306)) - omNode-1@group-523986131536-LeaderElection16 ELECTION round 0: submit vote requests at term 1 for -1: [omNode-1|rpc:localhost:13300|priority:0], old=null
2021-10-05 13:24:53,377 [omNode-1@group-523986131536-LeaderElection16] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(308)) - omNode-1@group-523986131536-LeaderElection16 ELECTION round 0: result PASSED (term=1)
2021-10-05 13:24:53,377 [omNode-1@group-523986131536-LeaderElection16] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(121)) - omNode-1: shutdown omNode-1@group-523986131536-LeaderElection16
2021-10-05 13:24:53,377 [omNode-1@group-523986131536-LeaderElection16] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(285)) - omNode-1@group-523986131536: changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2021-10-05 13:24:53,377 [omNode-1@group-523986131536-LeaderElection16] INFO  server.RaftServer$Division (ServerState.java:setLeader(285)) - omNode-1@group-523986131536: change Leader from null to omNode-1 at term 1 for becomeLeader, leader elected after 1309ms
2021-10-05 13:24:53,377 [omNode-1@group-523986131536-LeaderElection16] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.staging.catchup.gap = 1000 (default)
2021-10-05 13:24:53,378 [omNode-1@group-523986131536-LeaderElection16] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.write.element-limit = 4096 (default)
2021-10-05 13:24:53,378 [omNode-1@group-523986131536-LeaderElection16] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.write.byte-limit = 64MB (=67108864) (default)
2021-10-05 13:24:53,378 [omNode-1@group-523986131536-LeaderElection16] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.watch.timeout = 10s (default)
2021-10-05 13:24:53,378 [omNode-1@group-523986131536-LeaderElection16] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.watch.timeout.denomination = 1s (default)
2021-10-05 13:24:53,378 [omNode-1@group-523986131536-LeaderElection16] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.watch.element-limit = 65536 (default)
2021-10-05 13:24:53,378 [omNode-1@group-523986131536-LeaderElection16] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(130)) - omNode-1: start omNode-1@group-523986131536-LeaderStateImpl
2021-10-05 13:24:53,378 [omNode-1@group-523986131536-LeaderElection16] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:startLogSegment(394)) - omNode-1@group-523986131536-SegmentedRaftLogWorker: Starting segment from index:0
2021-10-05 13:24:53,387 [omNode-1@group-523986131536-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(601)) - omNode-1@group-523986131536-SegmentedRaftLogWorker: created new log segment /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-36b87918-66c6-4e2c-9c49-5aa8dab94a1f/omNode-1/ratis/c9bc4cf4-3bc3-3c60-a66b-523986131536/current/log_inprogress_0
2021-10-05 13:24:53,396 [omNode-1@group-523986131536-LeaderElection16] INFO  server.RaftServer$Division (ServerState.java:setRaftConf(387)) - omNode-1@group-523986131536: set configuration 0: [omNode-1|rpc:localhost:13300|admin:|client:|dataStream:|priority:0], old=null
2021-10-05 13:24:53,412 [omNode-1@group-523986131536-StateMachineUpdater] INFO  ratis.OzoneManagerStateMachine (OzoneManagerStateMachine.java:notifyConfigurationChanged(188)) - Received Configuration change notification from Ratis. New Peer list:
[id: "omNode-1"
address: "localhost:13300"
]
2021-10-05 13:24:53,448 [Listener at 127.0.0.1/13296] INFO  handler.ContextHandler (ContextHandler.java:doStart(915)) - Started o.e.j.w.WebAppContext@59412c{hddsDatanode,/,file:///tmp/jetty-0_0_0_0-34503-hdds-container-service-1_2_0-SNAPSHOT_jar-_-any-2141869463484394449/webapp/,AVAILABLE}{jar:file:/home/runner/.m2/repository/org/apache/ozone/hdds-container-service/1.2.0-SNAPSHOT/hdds-container-service-1.2.0-SNAPSHOT.jar!/webapps/hddsDatanode}
2021-10-05 13:24:53,459 [Listener at 127.0.0.1/13296] INFO  server.AbstractConnector (AbstractConnector.java:doStart(331)) - Started ServerConnector@46c805be{HTTP/1.1, (http/1.1)}{0.0.0.0:34503}
2021-10-05 13:24:53,459 [Listener at 127.0.0.1/13296] INFO  server.Server (Server.java:doStart(415)) - Started @87119ms
2021-10-05 13:24:53,460 [Listener at 127.0.0.1/13296] WARN  impl.MetricsSystemImpl (MetricsSystemImpl.java:register(279)) - Sink prometheus already exists!
2021-10-05 13:24:53,460 [Listener at 127.0.0.1/13296] INFO  http.BaseHttpServer (BaseHttpServer.java:updateConnectorAddress(329)) - HTTP server of hddsDatanode listening at http://0.0.0.0:34503
2021-10-05 13:24:53,466 [Listener at 127.0.0.1/13296] WARN  impl.MetricRegistriesImpl (MetricRegistriesImpl.java:addReporterRegistration(111)) - New reporters are added after registries were created. Some metrics will be missing from the reporter. Please add reporter before adding any new registry.
2021-10-05 13:24:53,466 [Listener at 127.0.0.1/13296] WARN  impl.MetricRegistriesImpl (MetricRegistriesImpl.java:addReporterRegistration(111)) - New reporters are added after registries were created. Some metrics will be missing from the reporter. Please add reporter before adding any new registry.
2021-10-05 13:24:53,467 [Listener at 127.0.0.1/13296] INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:init(158)) - HddsDatanode metrics system started (again)
2021-10-05 13:24:53,475 [Datanode State Machine Thread - 0] INFO  statemachine.DatanodeStateMachine (DatanodeStateMachine.java:lambda$startDaemon$0(456)) - Ozone container server started.
2021-10-05 13:24:53,487 [org.apache.hadoop.util.JvmPauseMonitor$Monitor@3f73fd1] INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(188)) - Starting JVM pause monitor
2021-10-05 13:24:53,500 [Listener at 127.0.0.1/13296] INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:start(234)) - HddsDatanodeService host:fv-az270-324.tacnzluakwdehk1hpragurqkma.bx.internal.cloudapp.net ip:10.1.0.10
2021-10-05 13:24:53,503 [Datanode State Machine Task Thread - 0] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.client.port appended with serviceId and nodeId
2021-10-05 13:24:53,505 [Datanode State Machine Task Thread - 0] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.block.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.block.client.port appended with serviceId and nodeId
2021-10-05 13:24:53,505 [Datanode State Machine Task Thread - 0] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.datanode.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.datanode.port appended with serviceId and nodeId
2021-10-05 13:24:53,505 [Datanode State Machine Task Thread - 0] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.client.port appended with serviceId and nodeId
2021-10-05 13:24:53,505 [Datanode State Machine Task Thread - 0] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.block.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.block.client.port appended with serviceId and nodeId
2021-10-05 13:24:53,505 [Datanode State Machine Task Thread - 0] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.datanode.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.datanode.port appended with serviceId and nodeId
2021-10-05 13:24:53,505 [Datanode State Machine Task Thread - 0] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.client.port appended with serviceId and nodeId
2021-10-05 13:24:53,505 [Datanode State Machine Task Thread - 0] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.block.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.block.client.port appended with serviceId and nodeId
2021-10-05 13:24:53,505 [Datanode State Machine Task Thread - 0] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.datanode.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.datanode.port appended with serviceId and nodeId
2021-10-05 13:24:53,506 [Datanode State Machine Task Thread - 0] INFO  datanode.InitDatanodeState (InitDatanodeState.java:persistContainerDatanodeDetails(145)) - DatanodeDetails is persisted to /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-36b87918-66c6-4e2c-9c49-5aa8dab94a1f/datanode-1/meta/datanode.id
2021-10-05 13:24:53,544 [Listener at 127.0.0.1/13296] INFO  upgrade.AbstractLayoutVersionManager (AbstractLayoutVersionManager.java:init(79)) - Initializing Layout version manager with metadata layout = SCM_HA (version = 2), software layout = SCM_HA (version = 2)
2021-10-05 13:24:53,577 [Listener at 127.0.0.1/13296] INFO  reflections.Reflections (Reflections.java:scan(232)) - Reflections took 31 ms to scan 7 urls, producing 119 keys and 275 values 
2021-10-05 13:24:53,578 [Listener at 127.0.0.1/13296] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.client.port appended with serviceId and nodeId
2021-10-05 13:24:53,578 [Listener at 127.0.0.1/13296] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.block.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.block.client.port appended with serviceId and nodeId
2021-10-05 13:24:53,578 [Listener at 127.0.0.1/13296] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.datanode.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.datanode.port appended with serviceId and nodeId
2021-10-05 13:24:53,579 [Listener at 127.0.0.1/13296] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.client.port appended with serviceId and nodeId
2021-10-05 13:24:53,579 [Listener at 127.0.0.1/13296] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.block.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.block.client.port appended with serviceId and nodeId
2021-10-05 13:24:53,579 [Listener at 127.0.0.1/13296] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.datanode.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.datanode.port appended with serviceId and nodeId
2021-10-05 13:24:53,579 [Listener at 127.0.0.1/13296] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.client.port appended with serviceId and nodeId
2021-10-05 13:24:53,579 [Listener at 127.0.0.1/13296] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.block.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.block.client.port appended with serviceId and nodeId
2021-10-05 13:24:53,579 [Listener at 127.0.0.1/13296] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.datanode.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.datanode.port appended with serviceId and nodeId
2021-10-05 13:24:53,580 [Listener at 127.0.0.1/13296] INFO  volume.HddsVolume (HddsVolume.java:<init>(120)) - Creating HddsVolume: /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-36b87918-66c6-4e2c-9c49-5aa8dab94a1f/datanode-2/data-0/containers/hdds of storage type : DISK capacity : 9223372036854775807
2021-10-05 13:24:53,581 [Listener at 127.0.0.1/13296] INFO  volume.MutableVolumeSet (MutableVolumeSet.java:initializeVolumeSet(168)) - Added Volume : /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-36b87918-66c6-4e2c-9c49-5aa8dab94a1f/datanode-2/data-0/containers/hdds to VolumeSet
2021-10-05 13:24:53,581 [Listener at 127.0.0.1/13296] INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(141)) - Scheduling a check for /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-36b87918-66c6-4e2c-9c49-5aa8dab94a1f/datanode-2/data-0/containers/hdds
2021-10-05 13:24:53,581 [Listener at 127.0.0.1/13296] INFO  volume.StorageVolumeChecker (StorageVolumeChecker.java:checkAllVolumes(202)) - Scheduled health check for volume /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-36b87918-66c6-4e2c-9c49-5aa8dab94a1f/datanode-2/data-0/containers/hdds
2021-10-05 13:24:53,593 [Listener at 127.0.0.1/13296] INFO  volume.MutableVolumeSet (MutableVolumeSet.java:initializeVolumeSet(168)) - Added Volume : /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-36b87918-66c6-4e2c-9c49-5aa8dab94a1f/datanode-2/data/ratis to VolumeSet
2021-10-05 13:24:53,594 [Listener at 127.0.0.1/13296] INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(141)) - Scheduling a check for /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-36b87918-66c6-4e2c-9c49-5aa8dab94a1f/datanode-2/data/ratis
2021-10-05 13:24:53,594 [Listener at 127.0.0.1/13296] INFO  volume.StorageVolumeChecker (StorageVolumeChecker.java:checkAllVolumes(202)) - Scheduled health check for volume /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-36b87918-66c6-4e2c-9c49-5aa8dab94a1f/datanode-2/data/ratis
2021-10-05 13:24:53,622 [Thread-1489] INFO  ozoneimpl.ContainerReader (ContainerReader.java:readVolume(172)) - Finish verifying containers on volume /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-36b87918-66c6-4e2c-9c49-5aa8dab94a1f/datanode-2/data-0/containers/hdds
2021-10-05 13:24:53,622 [Listener at 127.0.0.1/13296] INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:buildContainerSet(236)) - Build ContainerSet costs 0s
2021-10-05 13:24:53,624 [Listener at 127.0.0.1/13296] INFO  server.RaftServer (ConfUtils.java:logGet(44)) - raft.rpc.type = GRPC (default)
2021-10-05 13:24:53,625 [Listener at 127.0.0.1/13296] INFO  grpc.GrpcFactory (GrpcFactory.java:checkPooledByteBufAllocatorUseCacheForAllThreads(48)) - PERFORMANCE WARNING: useCacheForAllThreads is true that may cause Netty to create a lot garbage objects and, as a result, trigger GC.
	It is recommended to disable useCacheForAllThreads by setting -Dorg.apache.ratis.thirdparty.io.netty.allocator.useCacheForAllThreads=false in command line.
2021-10-05 13:24:53,625 [Listener at 127.0.0.1/13296] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(44)) - raft.grpc.admin.port = 0 (custom)
2021-10-05 13:24:53,625 [Listener at 127.0.0.1/13296] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(44)) - raft.grpc.client.port = 0 (custom)
2021-10-05 13:24:53,625 [Listener at 127.0.0.1/13296] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(44)) - raft.grpc.server.port = 0 (default)
2021-10-05 13:24:53,625 [Listener at 127.0.0.1/13296] INFO  server.GrpcService (ConfUtils.java:logGet(44)) - raft.grpc.message.size.max = 32MB (=33554432) (custom)
2021-10-05 13:24:53,625 [Listener at 127.0.0.1/13296] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2021-10-05 13:24:53,625 [Listener at 127.0.0.1/13296] INFO  server.GrpcService (ConfUtils.java:logGet(44)) - raft.grpc.flow.control.window = 5MB (=5242880) (custom)
2021-10-05 13:24:53,626 [Listener at 127.0.0.1/13296] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.request.timeout = 60s (custom)
2021-10-05 13:24:53,627 [Listener at 127.0.0.1/13296] INFO  impl.DataStreamServerImpl (ConfUtils.java:logGet(44)) - raft.datastream.type = DISABLED (default)
2021-10-05 13:24:53,627 [Listener at 127.0.0.1/13296] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.slowness.timeout = 300s (custom)
2021-10-05 13:24:53,627 [Listener at 127.0.0.1/13296] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.leaderelection.leader.step-down.wait-time = 10s (default)
2021-10-05 13:24:53,627 [Listener at 127.0.0.1/13296] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.storage.dir = [/home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-36b87918-66c6-4e2c-9c49-5aa8dab94a1f/datanode-2/data/ratis] (custom)
2021-10-05 13:24:53,631 [Listener at 127.0.0.1/13296] INFO  http.BaseHttpServer (BaseHttpServer.java:newHttpServer2BuilderForOzone(209)) - Starting Web-server for hddsDatanode at: http://0.0.0.0:0
2021-10-05 13:24:53,631 [Listener at 127.0.0.1/13296] INFO  http.BaseHttpServer (BaseHttpServer.java:<init>(107)) - Hadoop Security Enabled: false Ozone Security Enabled: false Ozone HTTP Security Enabled: false 
2021-10-05 13:24:53,632 [Listener at 127.0.0.1/13296] INFO  server.AuthenticationFilter (AuthenticationFilter.java:constructSecretProvider(240)) - Unable to initialize FileSignerSecretProvider, falling back to use random secrets.
2021-10-05 13:24:53,632 [Listener at 127.0.0.1/13296] WARN  http.HttpRequestLog (HttpRequestLog.java:getRequestLog(103)) - Jetty request log can only be enabled using Log4j
2021-10-05 13:24:53,633 [Listener at 127.0.0.1/13296] INFO  http.HttpServer2 (HttpServer2.java:addGlobalFilter(1030)) - Added global filter 'safety' (class=org.apache.hadoop.hdds.server.http.HttpServer2$QuotingInputFilter)
2021-10-05 13:24:53,634 [Listener at 127.0.0.1/13296] INFO  http.HttpServer2 (HttpServer2.java:addFilter(1006)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context hddsDatanode
2021-10-05 13:24:53,634 [Listener at 127.0.0.1/13296] INFO  http.HttpServer2 (HttpServer2.java:addFilter(1014)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context static
2021-10-05 13:24:53,634 [Listener at 127.0.0.1/13296] INFO  http.HttpServer2 (HttpServer2.java:addFilter(1014)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context logs
2021-10-05 13:24:53,634 [Listener at 127.0.0.1/13296] INFO  http.HttpServer2 (HttpServer2.java:bindListener(1249)) - Jetty bound to port 42865
2021-10-05 13:24:53,635 [Listener at 127.0.0.1/13296] INFO  server.Server (Server.java:doStart(375)) - jetty-9.4.43.v20210629; built: 2021-06-30T11:07:22.254Z; git: 526006ecfa3af7f1a27ef3a288e2bef7ea9dd7e8; jvm 1.8.0_292-b10
2021-10-05 13:24:53,646 [Listener at 127.0.0.1/13296] INFO  server.session (DefaultSessionIdManager.java:doStart(334)) - DefaultSessionIdManager workerName=node0
2021-10-05 13:24:53,647 [Listener at 127.0.0.1/13296] INFO  server.session (DefaultSessionIdManager.java:doStart(339)) - No SessionScavenger set, using defaults
2021-10-05 13:24:53,647 [Listener at 127.0.0.1/13296] INFO  server.session (HouseKeeper.java:startScavenging(132)) - node0 Scavenging every 600000ms
2021-10-05 13:24:53,647 [Listener at 127.0.0.1/13296] INFO  handler.ContextHandler (ContextHandler.java:doStart(915)) - Started o.e.j.s.ServletContextHandler@430bcbd4{logs,/logs,file:///home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/log,AVAILABLE}
2021-10-05 13:24:53,648 [Listener at 127.0.0.1/13296] INFO  handler.ContextHandler (ContextHandler.java:doStart(915)) - Started o.e.j.s.ServletContextHandler@6834f33a{static,/static,jar:file:/home/runner/.m2/repository/org/apache/ozone/hdds-container-service/1.2.0-SNAPSHOT/hdds-container-service-1.2.0-SNAPSHOT.jar!/webapps/static,AVAILABLE}
2021-10-05 13:24:53,730 [Listener at 127.0.0.1/13296] INFO  handler.ContextHandler (ContextHandler.java:doStart(915)) - Started o.e.j.w.WebAppContext@3989e022{hddsDatanode,/,file:///tmp/jetty-0_0_0_0-42865-hdds-container-service-1_2_0-SNAPSHOT_jar-_-any-7130100187940521289/webapp/,AVAILABLE}{jar:file:/home/runner/.m2/repository/org/apache/ozone/hdds-container-service/1.2.0-SNAPSHOT/hdds-container-service-1.2.0-SNAPSHOT.jar!/webapps/hddsDatanode}
2021-10-05 13:24:53,737 [EndpointStateMachine task thread for /127.0.0.1:15041 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15041. Already tried 0 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:24:53,738 [Listener at 127.0.0.1/13296] INFO  server.AbstractConnector (AbstractConnector.java:doStart(331)) - Started ServerConnector@3b2a3542{HTTP/1.1, (http/1.1)}{0.0.0.0:42865}
2021-10-05 13:24:53,739 [Listener at 127.0.0.1/13296] INFO  server.Server (Server.java:doStart(415)) - Started @87398ms
2021-10-05 13:24:53,739 [Listener at 127.0.0.1/13296] WARN  impl.MetricsSystemImpl (MetricsSystemImpl.java:register(279)) - Sink prometheus already exists!
2021-10-05 13:24:53,741 [Listener at 127.0.0.1/13296] INFO  http.BaseHttpServer (BaseHttpServer.java:updateConnectorAddress(329)) - HTTP server of hddsDatanode listening at http://0.0.0.0:42865
2021-10-05 13:24:53,743 [Listener at 127.0.0.1/13296] INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(235)) - Waiting for nodes to be ready. Got 0 of 3 DN Heartbeats.
2021-10-05 13:24:53,743 [Listener at 127.0.0.1/13296] INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(238)) - Waiting for cluster to exit safe mode
2021-10-05 13:24:53,744 [Listener at 127.0.0.1/13296] INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(240)) - SCM became leader
2021-10-05 13:24:53,744 [Datanode State Machine Thread - 0] INFO  statemachine.DatanodeStateMachine (DatanodeStateMachine.java:lambda$startDaemon$0(456)) - Ozone container server started.
2021-10-05 13:24:53,761 [org.apache.hadoop.util.JvmPauseMonitor$Monitor@6b569fd7] INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(188)) - Starting JVM pause monitor
2021-10-05 13:24:53,777 [Datanode State Machine Task Thread - 0] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.client.port appended with serviceId and nodeId
2021-10-05 13:24:53,777 [Datanode State Machine Task Thread - 0] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.block.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.block.client.port appended with serviceId and nodeId
2021-10-05 13:24:53,777 [Datanode State Machine Task Thread - 0] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.datanode.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.datanode.port appended with serviceId and nodeId
2021-10-05 13:24:53,777 [Datanode State Machine Task Thread - 0] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.client.port appended with serviceId and nodeId
2021-10-05 13:24:53,777 [Datanode State Machine Task Thread - 0] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.block.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.block.client.port appended with serviceId and nodeId
2021-10-05 13:24:53,781 [Datanode State Machine Task Thread - 0] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.datanode.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.datanode.port appended with serviceId and nodeId
2021-10-05 13:24:53,781 [Datanode State Machine Task Thread - 0] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.client.port appended with serviceId and nodeId
2021-10-05 13:24:53,781 [Datanode State Machine Task Thread - 0] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.block.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.block.client.port appended with serviceId and nodeId
2021-10-05 13:24:53,781 [Datanode State Machine Task Thread - 0] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.datanode.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.datanode.port appended with serviceId and nodeId
2021-10-05 13:24:53,783 [Datanode State Machine Task Thread - 0] INFO  datanode.InitDatanodeState (InitDatanodeState.java:persistContainerDatanodeDetails(145)) - DatanodeDetails is persisted to /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-36b87918-66c6-4e2c-9c49-5aa8dab94a1f/datanode-2/meta/datanode.id
2021-10-05 13:24:53,794 [EndpointStateMachine task thread for /127.0.0.1:15031 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15031. Already tried 4 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:24:53,794 [EndpointStateMachine task thread for /127.0.0.1:15021 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15021. Already tried 4 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:24:54,738 [EndpointStateMachine task thread for /127.0.0.1:15041 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15041. Already tried 1 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:24:54,744 [Listener at 127.0.0.1/13296] INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(235)) - Waiting for nodes to be ready. Got 0 of 3 DN Heartbeats.
2021-10-05 13:24:54,744 [Listener at 127.0.0.1/13296] INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(238)) - Waiting for cluster to exit safe mode
2021-10-05 13:24:54,744 [Listener at 127.0.0.1/13296] INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(240)) - SCM became leader
2021-10-05 13:24:54,794 [EndpointStateMachine task thread for /127.0.0.1:15031 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15031. Already tried 5 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:24:54,794 [EndpointStateMachine task thread for /127.0.0.1:15021 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15021. Already tried 5 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:24:55,050 [EndpointStateMachine task thread for /127.0.0.1:13539 - 0 ] INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(304)) - Attempting to start container services.
2021-10-05 13:24:55,051 [EndpointStateMachine task thread for /127.0.0.1:13539 - 0 ] INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(249)) - Background container scanner has been disabled.
2021-10-05 13:24:55,052 [EndpointStateMachine task thread for /127.0.0.1:13539 - 0 ] INFO  replication.ReplicationServer (ReplicationServer.java:start(107)) - ReplicationServer is started using port 42285
2021-10-05 13:24:55,056 [EndpointStateMachine task thread for /127.0.0.1:13539 - 0 ] INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(482)) - Starting XceiverServerRatis b668fbba-0931-4533-8c87-c6849aaa836f
2021-10-05 13:24:55,056 [EndpointStateMachine task thread for /127.0.0.1:13539 - 0 ] INFO  server.RaftServer (RaftServerProxy.java:lambda$start$5(374)) - b668fbba-0931-4533-8c87-c6849aaa836f: start RPC server
2021-10-05 13:24:55,059 [EndpointStateMachine task thread for /127.0.0.1:13539 - 0 ] INFO  server.GrpcService (GrpcService.java:startImpl(253)) - b668fbba-0931-4533-8c87-c6849aaa836f: GrpcService started, listening on 40511
2021-10-05 13:24:55,073 [EndpointStateMachine task thread for /127.0.0.1:13539 - 0 ] INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:getRealPort(503)) - XceiverServerRatis b668fbba-0931-4533-8c87-c6849aaa836f is started using port 40511 for RATIS
2021-10-05 13:24:55,073 [EndpointStateMachine task thread for /127.0.0.1:13539 - 0 ] INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:getRealPort(503)) - XceiverServerRatis b668fbba-0931-4533-8c87-c6849aaa836f is started using port 40511 for RATIS_ADMIN
2021-10-05 13:24:55,073 [EndpointStateMachine task thread for /127.0.0.1:13539 - 0 ] INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:getRealPort(503)) - XceiverServerRatis b668fbba-0931-4533-8c87-c6849aaa836f is started using port 40511 for RATIS_SERVER
2021-10-05 13:24:55,073 [EndpointStateMachine task thread for /127.0.0.1:13539 - 0 ] INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:start(135)) - XceiverServerGrpc b668fbba-0931-4533-8c87-c6849aaa836f is started using port 44361
2021-10-05 13:24:55,074 [org.apache.ratis.util.JvmPauseMonitor$$Lambda$499/1586779822@12ddb026] INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(103)) - JvmPauseMonitor-b668fbba-0931-4533-8c87-c6849aaa836f: Started
2021-10-05 13:24:55,079 [EndpointStateMachine task thread for /127.0.0.1:13529 - 0 ] INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(300)) - Ignore. OzoneContainer already started.
2021-10-05 13:24:55,521 [EndpointStateMachine task thread for /127.0.0.1:13529 - 0 ] INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(304)) - Attempting to start container services.
2021-10-05 13:24:55,521 [EndpointStateMachine task thread for /127.0.0.1:13529 - 0 ] INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(249)) - Background container scanner has been disabled.
2021-10-05 13:24:55,523 [EndpointStateMachine task thread for /127.0.0.1:13529 - 0 ] INFO  replication.ReplicationServer (ReplicationServer.java:start(107)) - ReplicationServer is started using port 34867
2021-10-05 13:24:55,528 [EndpointStateMachine task thread for /127.0.0.1:13529 - 0 ] INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(482)) - Starting XceiverServerRatis 830d4653-8da7-4c59-a1a4-1cd595539218
2021-10-05 13:24:55,535 [EndpointStateMachine task thread for /127.0.0.1:13529 - 0 ] INFO  server.RaftServer (RaftServerProxy.java:lambda$start$5(374)) - 830d4653-8da7-4c59-a1a4-1cd595539218: start RPC server
2021-10-05 13:24:55,542 [EndpointStateMachine task thread for /127.0.0.1:13529 - 0 ] INFO  server.GrpcService (GrpcService.java:startImpl(253)) - 830d4653-8da7-4c59-a1a4-1cd595539218: GrpcService started, listening on 42995
2021-10-05 13:24:55,563 [EndpointStateMachine task thread for /127.0.0.1:13529 - 0 ] INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:getRealPort(503)) - XceiverServerRatis 830d4653-8da7-4c59-a1a4-1cd595539218 is started using port 42995 for RATIS
2021-10-05 13:24:55,563 [EndpointStateMachine task thread for /127.0.0.1:13529 - 0 ] INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:getRealPort(503)) - XceiverServerRatis 830d4653-8da7-4c59-a1a4-1cd595539218 is started using port 42995 for RATIS_ADMIN
2021-10-05 13:24:55,563 [EndpointStateMachine task thread for /127.0.0.1:13529 - 0 ] INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:getRealPort(503)) - XceiverServerRatis 830d4653-8da7-4c59-a1a4-1cd595539218 is started using port 42995 for RATIS_SERVER
2021-10-05 13:24:55,563 [org.apache.ratis.util.JvmPauseMonitor$$Lambda$499/1586779822@2b7b94bd] INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(103)) - JvmPauseMonitor-830d4653-8da7-4c59-a1a4-1cd595539218: Started
2021-10-05 13:24:55,564 [EndpointStateMachine task thread for /127.0.0.1:13529 - 0 ] INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:start(135)) - XceiverServerGrpc 830d4653-8da7-4c59-a1a4-1cd595539218 is started using port 44359
2021-10-05 13:24:55,569 [EndpointStateMachine task thread for /127.0.0.1:13539 - 0 ] INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(300)) - Ignore. OzoneContainer already started.
2021-10-05 13:24:55,738 [EndpointStateMachine task thread for /127.0.0.1:15041 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15041. Already tried 2 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:24:55,744 [Listener at 127.0.0.1/13296] INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(235)) - Waiting for nodes to be ready. Got 0 of 3 DN Heartbeats.
2021-10-05 13:24:55,745 [Listener at 127.0.0.1/13296] INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(238)) - Waiting for cluster to exit safe mode
2021-10-05 13:24:55,745 [Listener at 127.0.0.1/13296] INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(240)) - SCM became leader
2021-10-05 13:24:55,787 [EndpointStateMachine task thread for /127.0.0.1:13539 - 0 ] INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(304)) - Attempting to start container services.
2021-10-05 13:24:55,787 [EndpointStateMachine task thread for /127.0.0.1:13539 - 0 ] INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(249)) - Background container scanner has been disabled.
2021-10-05 13:24:55,788 [EndpointStateMachine task thread for /127.0.0.1:13539 - 0 ] INFO  replication.ReplicationServer (ReplicationServer.java:start(107)) - ReplicationServer is started using port 45905
2021-10-05 13:24:55,789 [EndpointStateMachine task thread for /127.0.0.1:13539 - 0 ] INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(482)) - Starting XceiverServerRatis 9cad18a2-4b78-4cb8-813e-2348ce620e43
2021-10-05 13:24:55,791 [EndpointStateMachine task thread for /127.0.0.1:13539 - 0 ] INFO  server.RaftServer (RaftServerProxy.java:lambda$start$5(374)) - 9cad18a2-4b78-4cb8-813e-2348ce620e43: start RPC server
2021-10-05 13:24:55,795 [EndpointStateMachine task thread for /127.0.0.1:15031 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15031. Already tried 6 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:24:55,795 [EndpointStateMachine task thread for /127.0.0.1:15021 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15021. Already tried 6 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:24:55,801 [EndpointStateMachine task thread for /127.0.0.1:13539 - 0 ] INFO  server.GrpcService (GrpcService.java:startImpl(253)) - 9cad18a2-4b78-4cb8-813e-2348ce620e43: GrpcService started, listening on 34379
2021-10-05 13:24:55,802 [EndpointStateMachine task thread for /127.0.0.1:13539 - 0 ] INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:getRealPort(503)) - XceiverServerRatis 9cad18a2-4b78-4cb8-813e-2348ce620e43 is started using port 34379 for RATIS
2021-10-05 13:24:55,802 [EndpointStateMachine task thread for /127.0.0.1:13539 - 0 ] INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:getRealPort(503)) - XceiverServerRatis 9cad18a2-4b78-4cb8-813e-2348ce620e43 is started using port 34379 for RATIS_ADMIN
2021-10-05 13:24:55,802 [EndpointStateMachine task thread for /127.0.0.1:13539 - 0 ] INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:getRealPort(503)) - XceiverServerRatis 9cad18a2-4b78-4cb8-813e-2348ce620e43 is started using port 34379 for RATIS_SERVER
2021-10-05 13:24:55,803 [EndpointStateMachine task thread for /127.0.0.1:13539 - 0 ] INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:start(135)) - XceiverServerGrpc 9cad18a2-4b78-4cb8-813e-2348ce620e43 is started using port 41383
2021-10-05 13:24:55,804 [EndpointStateMachine task thread for /127.0.0.1:13529 - 0 ] INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(300)) - Ignore. OzoneContainer already started.
2021-10-05 13:24:55,816 [org.apache.ratis.util.JvmPauseMonitor$$Lambda$499/1586779822@6e58f4d1] INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(103)) - JvmPauseMonitor-9cad18a2-4b78-4cb8-813e-2348ce620e43: Started
2021-10-05 13:24:56,739 [EndpointStateMachine task thread for /127.0.0.1:15041 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15041. Already tried 3 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:24:56,745 [Listener at 127.0.0.1/13296] INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(235)) - Waiting for nodes to be ready. Got 0 of 3 DN Heartbeats.
2021-10-05 13:24:56,745 [Listener at 127.0.0.1/13296] INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(238)) - Waiting for cluster to exit safe mode
2021-10-05 13:24:56,745 [Listener at 127.0.0.1/13296] INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(240)) - SCM became leader
2021-10-05 13:24:56,795 [EndpointStateMachine task thread for /127.0.0.1:15021 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15021. Already tried 7 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:24:56,802 [EndpointStateMachine task thread for /127.0.0.1:15031 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15031. Already tried 7 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:24:57,007 [IPC Server handler 2 on default port 13529] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/b668fbba-0931-4533-8c87-c6849aaa836f
2021-10-05 13:24:57,008 [IPC Server handler 2 on default port 13529] INFO  node.SCMNodeManager (SCMNodeManager.java:register(389)) - Registered Data node : b668fbba-0931-4533-8c87-c6849aaa836f{ip: 127.0.0.1, host: localhost, ports: [REPLICATION=42285, RATIS=40511, RATIS_ADMIN=40511, RATIS_SERVER=40511, STANDALONE=44361], networkLocation: /default-rack, certSerialId: null, persistedOpState: null, persistedOpStateExpiryEpochSec: 0}
2021-10-05 13:24:57,009 [EventQueue-NewNodeForNewNodeHandler] INFO  pipeline.BackgroundPipelineCreator (BackgroundPipelineCreatorV2.java:notifyEventTriggered(285)) - trigger a one-shot run on RatisPipelineUtilsThread.
2021-10-05 13:24:57,010 [EventQueue-NodeRegistrationContainerReportForDataNodeSafeModeRule] INFO  safemode.SCMSafeModeManager (DataNodeSafeModeRule.java:process(71)) - SCM in safe mode. 1 DataNodes registered, 3 required.
2021-10-05 13:24:57,010 [RatisPipelineUtilsThread - 0] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(183)) - Sending CreatePipelineCommand for pipeline:PipelineID=fb43a933-1c8b-4815-9314-16677137c488 to datanode:b668fbba-0931-4533-8c87-c6849aaa836f
2021-10-05 13:24:57,012 [EventQueue-NodeRegistrationContainerReportForContainerSafeModeRule] INFO  safemode.SCMSafeModeManager (SCMSafeModeManager.java:validateSafeModeExitRules(204)) - ContainerSafeModeRule rule is successfully validated
2021-10-05 13:24:57,020 [IPC Server handler 0 on default port 13539] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/b668fbba-0931-4533-8c87-c6849aaa836f
2021-10-05 13:24:57,020 [IPC Server handler 0 on default port 13539] INFO  node.SCMNodeManager (SCMNodeManager.java:register(389)) - Registered Data node : b668fbba-0931-4533-8c87-c6849aaa836f{ip: 127.0.0.1, host: localhost, ports: [REPLICATION=42285, RATIS=40511, RATIS_ADMIN=40511, RATIS_SERVER=40511, STANDALONE=44361], networkLocation: /default-rack, certSerialId: null, persistedOpState: null, persistedOpStateExpiryEpochSec: 0}
2021-10-05 13:24:57,023 [EventQueue-PipelineReportForOneReplicaPipelineSafeModeRule] INFO  safemode.SCMSafeModeManager (SCMSafeModeManager.java:validateSafeModeExitRules(204)) - AtleastOneDatanodeReportedRule rule is successfully validated
2021-10-05 13:24:57,028 [EventQueue-NodeRegistrationContainerReportForDataNodeSafeModeRule] INFO  safemode.SCMSafeModeManager (DataNodeSafeModeRule.java:process(71)) - SCM in safe mode. 1 DataNodes registered, 3 required.
2021-10-05 13:24:57,031 [EventQueue-NewNodeForNewNodeHandler] INFO  pipeline.BackgroundPipelineCreator (BackgroundPipelineCreatorV2.java:notifyEventTriggered(279)) - ignore, not leader SCM.
2021-10-05 13:24:57,031 [EventQueue-NodeRegistrationContainerReportForContainerSafeModeRule] INFO  safemode.SCMSafeModeManager (SCMSafeModeManager.java:validateSafeModeExitRules(204)) - ContainerSafeModeRule rule is successfully validated
2021-10-05 13:24:57,042 [EventQueue-PipelineReportForOneReplicaPipelineSafeModeRule] INFO  safemode.SCMSafeModeManager (SCMSafeModeManager.java:validateSafeModeExitRules(204)) - AtleastOneDatanodeReportedRule rule is successfully validated
2021-10-05 13:24:57,084 [21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F-StateMachineUpdater] INFO  pipeline.PipelineStateManagerImpl (PipelineStateManagerImpl.java:addPipeline(101)) - Created pipeline Pipeline[ Id: fb43a933-1c8b-4815-9314-16677137c488, Nodes: b668fbba-0931-4533-8c87-c6849aaa836f{ip: 127.0.0.1, host: localhost, ports: [REPLICATION=42285, RATIS=40511, RATIS_ADMIN=40511, RATIS_SERVER=40511, STANDALONE=44361], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}, ReplicationConfig: RATIS/ONE, State:ALLOCATED, leaderId:, CreationTimestamp2021-10-05T13:24:57.010Z[Etc/UTC]].
2021-10-05 13:24:57,084 [21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F-StateMachineUpdater] INFO  safemode.HealthyPipelineSafeModeRule (HealthyPipelineSafeModeRule.java:initializeRule(152)) - Refreshed total pipeline count is 0, healthy pipeline threshold count is 1
2021-10-05 13:24:57,087 [RatisPipelineUtilsThread - 0] INFO  ha.SCMHAInvocationHandler (SCMHAInvocationHandler.java:invokeRatis(113)) - Invoking method public abstract void org.apache.hadoop.hdds.scm.pipeline.PipelineStateManager.addPipeline(org.apache.hadoop.hdds.protocol.proto.HddsProtos$Pipeline) throws java.io.IOException on target org.apache.hadoop.hdds.scm.ha.SCMRatisServerImpl@7efc167c, cost 74397.566us
2021-10-05 13:24:57,116 [6d234f4d-474a-4c74-a9e9-8f3885fce584@group-5AA8DAB94A1F-StateMachineUpdater] INFO  pipeline.PipelineStateManagerImpl (PipelineStateManagerImpl.java:addPipeline(101)) - Created pipeline Pipeline[ Id: fb43a933-1c8b-4815-9314-16677137c488, Nodes: b668fbba-0931-4533-8c87-c6849aaa836f{ip: 127.0.0.1, host: localhost, ports: [REPLICATION=42285, RATIS=40511, RATIS_ADMIN=40511, RATIS_SERVER=40511, STANDALONE=44361], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}, ReplicationConfig: RATIS/ONE, State:ALLOCATED, leaderId:, CreationTimestamp2021-10-05T13:24:57.010Z[Etc/UTC]].
2021-10-05 13:24:57,116 [6d234f4d-474a-4c74-a9e9-8f3885fce584@group-5AA8DAB94A1F-StateMachineUpdater] INFO  safemode.HealthyPipelineSafeModeRule (HealthyPipelineSafeModeRule.java:initializeRule(152)) - Refreshed total pipeline count is 0, healthy pipeline threshold count is 1
2021-10-05 13:24:57,506 [IPC Server handler 1 on default port 13529] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/830d4653-8da7-4c59-a1a4-1cd595539218
2021-10-05 13:24:57,506 [IPC Server handler 1 on default port 13539] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/830d4653-8da7-4c59-a1a4-1cd595539218
2021-10-05 13:24:57,506 [IPC Server handler 1 on default port 13529] INFO  node.SCMNodeManager (SCMNodeManager.java:register(389)) - Registered Data node : 830d4653-8da7-4c59-a1a4-1cd595539218{ip: 127.0.0.1, host: localhost, ports: [REPLICATION=34867, RATIS=42995, RATIS_ADMIN=42995, RATIS_SERVER=42995, STANDALONE=44359], networkLocation: /default-rack, certSerialId: null, persistedOpState: null, persistedOpStateExpiryEpochSec: 0}
2021-10-05 13:24:57,506 [IPC Server handler 1 on default port 13539] INFO  node.SCMNodeManager (SCMNodeManager.java:register(389)) - Registered Data node : 830d4653-8da7-4c59-a1a4-1cd595539218{ip: 127.0.0.1, host: localhost, ports: [REPLICATION=34867, RATIS=42995, RATIS_ADMIN=42995, RATIS_SERVER=42995, STANDALONE=44359], networkLocation: /default-rack, certSerialId: null, persistedOpState: null, persistedOpStateExpiryEpochSec: 0}
2021-10-05 13:24:57,507 [EventQueue-NewNodeForNewNodeHandler] INFO  pipeline.BackgroundPipelineCreator (BackgroundPipelineCreatorV2.java:notifyEventTriggered(285)) - trigger a one-shot run on RatisPipelineUtilsThread.
2021-10-05 13:24:57,507 [EventQueue-NewNodeForNewNodeHandler] INFO  pipeline.BackgroundPipelineCreator (BackgroundPipelineCreatorV2.java:notifyEventTriggered(279)) - ignore, not leader SCM.
2021-10-05 13:24:57,511 [EventQueue-NodeRegistrationContainerReportForDataNodeSafeModeRule] INFO  safemode.SCMSafeModeManager (DataNodeSafeModeRule.java:process(71)) - SCM in safe mode. 2 DataNodes registered, 3 required.
2021-10-05 13:24:57,513 [RatisPipelineUtilsThread - 0] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(183)) - Sending CreatePipelineCommand for pipeline:PipelineID=41685362-6c68-4243-9411-8307c7c0d048 to datanode:830d4653-8da7-4c59-a1a4-1cd595539218
2021-10-05 13:24:57,516 [EventQueue-NodeRegistrationContainerReportForDataNodeSafeModeRule] INFO  safemode.SCMSafeModeManager (DataNodeSafeModeRule.java:process(71)) - SCM in safe mode. 2 DataNodes registered, 3 required.
2021-10-05 13:24:57,520 [21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F-StateMachineUpdater] INFO  pipeline.PipelineStateManagerImpl (PipelineStateManagerImpl.java:addPipeline(101)) - Created pipeline Pipeline[ Id: 41685362-6c68-4243-9411-8307c7c0d048, Nodes: 830d4653-8da7-4c59-a1a4-1cd595539218{ip: 127.0.0.1, host: localhost, ports: [REPLICATION=34867, RATIS=42995, RATIS_ADMIN=42995, RATIS_SERVER=42995, STANDALONE=44359], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}, ReplicationConfig: RATIS/ONE, State:ALLOCATED, leaderId:, CreationTimestamp2021-10-05T13:24:57.513Z[Etc/UTC]].
2021-10-05 13:24:57,520 [21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F-StateMachineUpdater] INFO  safemode.HealthyPipelineSafeModeRule (HealthyPipelineSafeModeRule.java:initializeRule(152)) - Refreshed total pipeline count is 0, healthy pipeline threshold count is 1
2021-10-05 13:24:57,521 [RatisPipelineUtilsThread - 0] INFO  ha.SCMHAInvocationHandler (SCMHAInvocationHandler.java:invokeRatis(113)) - Invoking method public abstract void org.apache.hadoop.hdds.scm.pipeline.PipelineStateManager.addPipeline(org.apache.hadoop.hdds.protocol.proto.HddsProtos$Pipeline) throws java.io.IOException on target org.apache.hadoop.hdds.scm.ha.SCMRatisServerImpl@7efc167c, cost 7779.17us
2021-10-05 13:24:57,536 [6d234f4d-474a-4c74-a9e9-8f3885fce584@group-5AA8DAB94A1F-StateMachineUpdater] INFO  pipeline.PipelineStateManagerImpl (PipelineStateManagerImpl.java:addPipeline(101)) - Created pipeline Pipeline[ Id: 41685362-6c68-4243-9411-8307c7c0d048, Nodes: 830d4653-8da7-4c59-a1a4-1cd595539218{ip: 127.0.0.1, host: localhost, ports: [REPLICATION=34867, RATIS=42995, RATIS_ADMIN=42995, RATIS_SERVER=42995, STANDALONE=44359], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}, ReplicationConfig: RATIS/ONE, State:ALLOCATED, leaderId:, CreationTimestamp2021-10-05T13:24:57.513Z[Etc/UTC]].
2021-10-05 13:24:57,536 [6d234f4d-474a-4c74-a9e9-8f3885fce584@group-5AA8DAB94A1F-StateMachineUpdater] INFO  safemode.HealthyPipelineSafeModeRule (HealthyPipelineSafeModeRule.java:initializeRule(152)) - Refreshed total pipeline count is 0, healthy pipeline threshold count is 1
2021-10-05 13:24:57,536 [21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F-StateMachineUpdater] INFO  ha.SCMStateMachine (SCMStateMachine.java:takeSnapshot(290)) - Current Snapshot Index 10, takeSnapshot took 0 ms
2021-10-05 13:24:57,536 [21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:takeSnapshot(281)) - 21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F-StateMachineUpdater: Took a snapshot at index 10
2021-10-05 13:24:57,536 [21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:lambda$new$0(89)) - 21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F-StateMachineUpdater: snapshotIndex: updateIncreasingly 5 -> 10
2021-10-05 13:24:57,536 [21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:purge(306)) - 21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F-SegmentedRaftLog: purge 10
2021-10-05 13:24:57,536 [21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - 21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F-SegmentedRaftLog: snapshotIndex: updateIncreasingly 5 -> 10
2021-10-05 13:24:57,536 [21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - 21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F-SegmentedRaftLog: purgeIndex: updateToMax old=0, new=10, updated? true
2021-10-05 13:24:57,740 [EndpointStateMachine task thread for /127.0.0.1:15041 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15041. Already tried 4 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:24:57,746 [Listener at 127.0.0.1/13296] INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(235)) - Waiting for nodes to be ready. Got 2 of 3 DN Heartbeats.
2021-10-05 13:24:57,746 [Listener at 127.0.0.1/13296] INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(238)) - Waiting for cluster to exit safe mode
2021-10-05 13:24:57,746 [Listener at 127.0.0.1/13296] INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(240)) - SCM became leader
2021-10-05 13:24:57,770 [IPC Server handler 19 on default port 13539] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/9cad18a2-4b78-4cb8-813e-2348ce620e43
2021-10-05 13:24:57,770 [IPC Server handler 19 on default port 13539] INFO  node.SCMNodeManager (SCMNodeManager.java:register(389)) - Registered Data node : 9cad18a2-4b78-4cb8-813e-2348ce620e43{ip: 127.0.0.1, host: localhost, ports: [REPLICATION=45905, RATIS=34379, RATIS_ADMIN=34379, RATIS_SERVER=34379, STANDALONE=41383], networkLocation: /default-rack, certSerialId: null, persistedOpState: null, persistedOpStateExpiryEpochSec: 0}
2021-10-05 13:24:57,770 [EventQueue-NewNodeForNewNodeHandler] INFO  pipeline.BackgroundPipelineCreator (BackgroundPipelineCreatorV2.java:notifyEventTriggered(279)) - ignore, not leader SCM.
2021-10-05 13:24:57,771 [IPC Server handler 0 on default port 13529] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/9cad18a2-4b78-4cb8-813e-2348ce620e43
2021-10-05 13:24:57,771 [IPC Server handler 0 on default port 13529] INFO  node.SCMNodeManager (SCMNodeManager.java:register(389)) - Registered Data node : 9cad18a2-4b78-4cb8-813e-2348ce620e43{ip: 127.0.0.1, host: localhost, ports: [REPLICATION=45905, RATIS=34379, RATIS_ADMIN=34379, RATIS_SERVER=34379, STANDALONE=41383], networkLocation: /default-rack, certSerialId: null, persistedOpState: null, persistedOpStateExpiryEpochSec: 0}
2021-10-05 13:24:57,771 [EventQueue-NewNodeForNewNodeHandler] INFO  pipeline.BackgroundPipelineCreator (BackgroundPipelineCreatorV2.java:notifyEventTriggered(285)) - trigger a one-shot run on RatisPipelineUtilsThread.
2021-10-05 13:24:57,771 [RatisPipelineUtilsThread - 0] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(183)) - Sending CreatePipelineCommand for pipeline:PipelineID=698a69f9-cff2-4881-8cc2-9bc7fbf74007 to datanode:9cad18a2-4b78-4cb8-813e-2348ce620e43
2021-10-05 13:24:57,774 [EventQueue-NodeRegistrationContainerReportForDataNodeSafeModeRule] INFO  safemode.SCMSafeModeManager (DataNodeSafeModeRule.java:process(71)) - SCM in safe mode. 3 DataNodes registered, 3 required.
2021-10-05 13:24:57,774 [EventQueue-NodeRegistrationContainerReportForDataNodeSafeModeRule] INFO  safemode.SCMSafeModeManager (SCMSafeModeManager.java:validateSafeModeExitRules(204)) - DataNodeSafeModeRule rule is successfully validated
2021-10-05 13:24:57,774 [EventQueue-NodeRegistrationContainerReportForDataNodeSafeModeRule] INFO  safemode.SCMSafeModeManager (SCMSafeModeManager.java:completePreCheck(233)) - All SCM safe mode pre check rules have passed
2021-10-05 13:24:57,774 [EventQueue-NodeRegistrationContainerReportForDataNodeSafeModeRule] WARN  events.EventQueue (EventQueue.java:fireEvent(194)) - No event handler registered for event TypedEvent{payloadType=SafeModeStatus, name='Safe mode status'}
2021-10-05 13:24:57,774 [EventQueue-NodeRegistrationContainerReportForDataNodeSafeModeRule] INFO  ha.SCMContext (SCMContext.java:updateSafeModeStatus(205)) - Update SafeModeStatus from SafeModeStatus{safeModeStatus=true, preCheckPassed=false} to SafeModeStatus{safeModeStatus=true, preCheckPassed=true}.
2021-10-05 13:24:57,774 [EventQueue-NodeRegistrationContainerReportForDataNodeSafeModeRule] INFO  pipeline.BackgroundPipelineCreator (BackgroundPipelineCreatorV2.java:notifyEventTriggered(279)) - ignore, not leader SCM.
2021-10-05 13:24:57,779 [6d234f4d-474a-4c74-a9e9-8f3885fce584@group-5AA8DAB94A1F-StateMachineUpdater] INFO  ha.SCMStateMachine (SCMStateMachine.java:takeSnapshot(290)) - Current Snapshot Index 10, takeSnapshot took 0 ms
2021-10-05 13:24:57,779 [6d234f4d-474a-4c74-a9e9-8f3885fce584@group-5AA8DAB94A1F-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:takeSnapshot(281)) - 6d234f4d-474a-4c74-a9e9-8f3885fce584@group-5AA8DAB94A1F-StateMachineUpdater: Took a snapshot at index 10
2021-10-05 13:24:57,779 [6d234f4d-474a-4c74-a9e9-8f3885fce584@group-5AA8DAB94A1F-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:lambda$new$0(89)) - 6d234f4d-474a-4c74-a9e9-8f3885fce584@group-5AA8DAB94A1F-StateMachineUpdater: snapshotIndex: updateIncreasingly 5 -> 10
2021-10-05 13:24:57,779 [6d234f4d-474a-4c74-a9e9-8f3885fce584@group-5AA8DAB94A1F-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:purge(306)) - 6d234f4d-474a-4c74-a9e9-8f3885fce584@group-5AA8DAB94A1F-SegmentedRaftLog: purge 10
2021-10-05 13:24:57,779 [6d234f4d-474a-4c74-a9e9-8f3885fce584@group-5AA8DAB94A1F-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - 6d234f4d-474a-4c74-a9e9-8f3885fce584@group-5AA8DAB94A1F-SegmentedRaftLog: snapshotIndex: updateIncreasingly 5 -> 10
2021-10-05 13:24:57,779 [6d234f4d-474a-4c74-a9e9-8f3885fce584@group-5AA8DAB94A1F-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - 6d234f4d-474a-4c74-a9e9-8f3885fce584@group-5AA8DAB94A1F-SegmentedRaftLog: purgeIndex: updateToMax old=0, new=10, updated? true
2021-10-05 13:24:57,780 [21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F-StateMachineUpdater] INFO  pipeline.PipelineStateManagerImpl (PipelineStateManagerImpl.java:addPipeline(101)) - Created pipeline Pipeline[ Id: 698a69f9-cff2-4881-8cc2-9bc7fbf74007, Nodes: 9cad18a2-4b78-4cb8-813e-2348ce620e43{ip: 127.0.0.1, host: localhost, ports: [REPLICATION=45905, RATIS=34379, RATIS_ADMIN=34379, RATIS_SERVER=34379, STANDALONE=41383], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}, ReplicationConfig: RATIS/ONE, State:ALLOCATED, leaderId:, CreationTimestamp2021-10-05T13:24:57.771Z[Etc/UTC]].
2021-10-05 13:24:57,780 [21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F-StateMachineUpdater] INFO  safemode.HealthyPipelineSafeModeRule (HealthyPipelineSafeModeRule.java:initializeRule(152)) - Refreshed total pipeline count is 0, healthy pipeline threshold count is 1
2021-10-05 13:24:57,780 [RatisPipelineUtilsThread - 0] INFO  ha.SCMHAInvocationHandler (SCMHAInvocationHandler.java:invokeRatis(113)) - Invoking method public abstract void org.apache.hadoop.hdds.scm.pipeline.PipelineStateManager.addPipeline(org.apache.hadoop.hdds.protocol.proto.HddsProtos$Pipeline) throws java.io.IOException on target org.apache.hadoop.hdds.scm.ha.SCMRatisServerImpl@7efc167c, cost 8772.668us
2021-10-05 13:24:57,783 [EventQueue-NodeRegistrationContainerReportForDataNodeSafeModeRule] INFO  safemode.SCMSafeModeManager (DataNodeSafeModeRule.java:process(71)) - SCM in safe mode. 3 DataNodes registered, 3 required.
2021-10-05 13:24:57,783 [EventQueue-NodeRegistrationContainerReportForDataNodeSafeModeRule] INFO  safemode.SCMSafeModeManager (SCMSafeModeManager.java:validateSafeModeExitRules(204)) - DataNodeSafeModeRule rule is successfully validated
2021-10-05 13:24:57,783 [EventQueue-NodeRegistrationContainerReportForDataNodeSafeModeRule] INFO  safemode.SCMSafeModeManager (SCMSafeModeManager.java:completePreCheck(233)) - All SCM safe mode pre check rules have passed
2021-10-05 13:24:57,783 [EventQueue-NodeRegistrationContainerReportForDataNodeSafeModeRule] WARN  events.EventQueue (EventQueue.java:fireEvent(194)) - No event handler registered for event TypedEvent{payloadType=SafeModeStatus, name='Safe mode status'}
2021-10-05 13:24:57,783 [EventQueue-NodeRegistrationContainerReportForDataNodeSafeModeRule] INFO  ha.SCMContext (SCMContext.java:updateSafeModeStatus(205)) - Update SafeModeStatus from SafeModeStatus{safeModeStatus=true, preCheckPassed=false} to SafeModeStatus{safeModeStatus=true, preCheckPassed=true}.
2021-10-05 13:24:57,784 [EventQueue-NodeRegistrationContainerReportForDataNodeSafeModeRule] INFO  pipeline.BackgroundPipelineCreator (BackgroundPipelineCreatorV2.java:notifyEventTriggered(285)) - trigger a one-shot run on RatisPipelineUtilsThread.
2021-10-05 13:24:57,784 [RatisPipelineUtilsThread - 0] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(183)) - Sending CreatePipelineCommand for pipeline:PipelineID=5cfa055b-4c5c-4f3c-a5c0-62f8e1a01d1d to datanode:9cad18a2-4b78-4cb8-813e-2348ce620e43
2021-10-05 13:24:57,784 [RatisPipelineUtilsThread - 0] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(183)) - Sending CreatePipelineCommand for pipeline:PipelineID=5cfa055b-4c5c-4f3c-a5c0-62f8e1a01d1d to datanode:b668fbba-0931-4533-8c87-c6849aaa836f
2021-10-05 13:24:57,784 [RatisPipelineUtilsThread - 0] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(183)) - Sending CreatePipelineCommand for pipeline:PipelineID=5cfa055b-4c5c-4f3c-a5c0-62f8e1a01d1d to datanode:830d4653-8da7-4c59-a1a4-1cd595539218
2021-10-05 13:24:57,792 [6d234f4d-474a-4c74-a9e9-8f3885fce584@group-5AA8DAB94A1F-StateMachineUpdater] INFO  pipeline.PipelineStateManagerImpl (PipelineStateManagerImpl.java:addPipeline(101)) - Created pipeline Pipeline[ Id: 698a69f9-cff2-4881-8cc2-9bc7fbf74007, Nodes: 9cad18a2-4b78-4cb8-813e-2348ce620e43{ip: 127.0.0.1, host: localhost, ports: [REPLICATION=45905, RATIS=34379, RATIS_ADMIN=34379, RATIS_SERVER=34379, STANDALONE=41383], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}, ReplicationConfig: RATIS/ONE, State:ALLOCATED, leaderId:, CreationTimestamp2021-10-05T13:24:57.771Z[Etc/UTC]].
2021-10-05 13:24:57,793 [6d234f4d-474a-4c74-a9e9-8f3885fce584@group-5AA8DAB94A1F-StateMachineUpdater] INFO  safemode.HealthyPipelineSafeModeRule (HealthyPipelineSafeModeRule.java:initializeRule(152)) - Refreshed total pipeline count is 0, healthy pipeline threshold count is 1
2021-10-05 13:24:57,796 [EndpointStateMachine task thread for /127.0.0.1:15021 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15021. Already tried 8 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:24:57,798 [21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F-StateMachineUpdater] INFO  pipeline.PipelineStateManagerImpl (PipelineStateManagerImpl.java:addPipeline(101)) - Created pipeline Pipeline[ Id: 5cfa055b-4c5c-4f3c-a5c0-62f8e1a01d1d, Nodes: 9cad18a2-4b78-4cb8-813e-2348ce620e43{ip: 127.0.0.1, host: localhost, ports: [REPLICATION=45905, RATIS=34379, RATIS_ADMIN=34379, RATIS_SERVER=34379, STANDALONE=41383], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}b668fbba-0931-4533-8c87-c6849aaa836f{ip: 127.0.0.1, host: localhost, ports: [REPLICATION=42285, RATIS=40511, RATIS_ADMIN=40511, RATIS_SERVER=40511, STANDALONE=44361], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}830d4653-8da7-4c59-a1a4-1cd595539218{ip: 127.0.0.1, host: localhost, ports: [REPLICATION=34867, RATIS=42995, RATIS_ADMIN=42995, RATIS_SERVER=42995, STANDALONE=44359], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}, ReplicationConfig: RATIS/THREE, State:ALLOCATED, leaderId:, CreationTimestamp2021-10-05T13:24:57.784Z[Etc/UTC]].
2021-10-05 13:24:57,798 [21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F-StateMachineUpdater] INFO  safemode.HealthyPipelineSafeModeRule (HealthyPipelineSafeModeRule.java:initializeRule(152)) - Refreshed total pipeline count is 0, healthy pipeline threshold count is 1
2021-10-05 13:24:57,798 [RatisPipelineUtilsThread - 0] INFO  ha.SCMHAInvocationHandler (SCMHAInvocationHandler.java:invokeRatis(113)) - Invoking method public abstract void org.apache.hadoop.hdds.scm.pipeline.PipelineStateManager.addPipeline(org.apache.hadoop.hdds.protocol.proto.HddsProtos$Pipeline) throws java.io.IOException on target org.apache.hadoop.hdds.scm.ha.SCMRatisServerImpl@7efc167c, cost 13261.613us
2021-10-05 13:24:57,798 [RatisPipelineUtilsThread - 0] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(183)) - Sending CreatePipelineCommand for pipeline:PipelineID=1cc8aba1-0118-4460-9a8d-9360a73a2abc to datanode:b668fbba-0931-4533-8c87-c6849aaa836f
2021-10-05 13:24:57,798 [RatisPipelineUtilsThread - 0] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(183)) - Sending CreatePipelineCommand for pipeline:PipelineID=1cc8aba1-0118-4460-9a8d-9360a73a2abc to datanode:830d4653-8da7-4c59-a1a4-1cd595539218
2021-10-05 13:24:57,798 [RatisPipelineUtilsThread - 0] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(183)) - Sending CreatePipelineCommand for pipeline:PipelineID=1cc8aba1-0118-4460-9a8d-9360a73a2abc to datanode:9cad18a2-4b78-4cb8-813e-2348ce620e43
2021-10-05 13:24:57,802 [EndpointStateMachine task thread for /127.0.0.1:15031 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15031. Already tried 8 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:24:57,807 [6d234f4d-474a-4c74-a9e9-8f3885fce584@group-5AA8DAB94A1F-StateMachineUpdater] INFO  pipeline.PipelineStateManagerImpl (PipelineStateManagerImpl.java:addPipeline(101)) - Created pipeline Pipeline[ Id: 5cfa055b-4c5c-4f3c-a5c0-62f8e1a01d1d, Nodes: 9cad18a2-4b78-4cb8-813e-2348ce620e43{ip: 127.0.0.1, host: localhost, ports: [REPLICATION=45905, RATIS=34379, RATIS_ADMIN=34379, RATIS_SERVER=34379, STANDALONE=41383], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}b668fbba-0931-4533-8c87-c6849aaa836f{ip: 127.0.0.1, host: localhost, ports: [REPLICATION=42285, RATIS=40511, RATIS_ADMIN=40511, RATIS_SERVER=40511, STANDALONE=44361], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}830d4653-8da7-4c59-a1a4-1cd595539218{ip: 127.0.0.1, host: localhost, ports: [REPLICATION=34867, RATIS=42995, RATIS_ADMIN=42995, RATIS_SERVER=42995, STANDALONE=44359], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}, ReplicationConfig: RATIS/THREE, State:ALLOCATED, leaderId:, CreationTimestamp2021-10-05T13:24:57.784Z[Etc/UTC]].
2021-10-05 13:24:57,807 [6d234f4d-474a-4c74-a9e9-8f3885fce584@group-5AA8DAB94A1F-StateMachineUpdater] INFO  safemode.HealthyPipelineSafeModeRule (HealthyPipelineSafeModeRule.java:initializeRule(152)) - Refreshed total pipeline count is 0, healthy pipeline threshold count is 1
2021-10-05 13:24:57,817 [21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F-StateMachineUpdater] INFO  pipeline.PipelineStateManagerImpl (PipelineStateManagerImpl.java:addPipeline(101)) - Created pipeline Pipeline[ Id: 1cc8aba1-0118-4460-9a8d-9360a73a2abc, Nodes: b668fbba-0931-4533-8c87-c6849aaa836f{ip: 127.0.0.1, host: localhost, ports: [REPLICATION=42285, RATIS=40511, RATIS_ADMIN=40511, RATIS_SERVER=40511, STANDALONE=44361], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}830d4653-8da7-4c59-a1a4-1cd595539218{ip: 127.0.0.1, host: localhost, ports: [REPLICATION=34867, RATIS=42995, RATIS_ADMIN=42995, RATIS_SERVER=42995, STANDALONE=44359], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}9cad18a2-4b78-4cb8-813e-2348ce620e43{ip: 127.0.0.1, host: localhost, ports: [REPLICATION=45905, RATIS=34379, RATIS_ADMIN=34379, RATIS_SERVER=34379, STANDALONE=41383], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}, ReplicationConfig: RATIS/THREE, State:ALLOCATED, leaderId:, CreationTimestamp2021-10-05T13:24:57.798Z[Etc/UTC]].
2021-10-05 13:24:57,817 [21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F-StateMachineUpdater] INFO  safemode.HealthyPipelineSafeModeRule (HealthyPipelineSafeModeRule.java:initializeRule(152)) - Refreshed total pipeline count is 0, healthy pipeline threshold count is 1
2021-10-05 13:24:57,817 [RatisPipelineUtilsThread - 0] INFO  ha.SCMHAInvocationHandler (SCMHAInvocationHandler.java:invokeRatis(113)) - Invoking method public abstract void org.apache.hadoop.hdds.scm.pipeline.PipelineStateManager.addPipeline(org.apache.hadoop.hdds.protocol.proto.HddsProtos$Pipeline) throws java.io.IOException on target org.apache.hadoop.hdds.scm.ha.SCMRatisServerImpl@7efc167c, cost 18573.739us
2021-10-05 13:24:57,817 [21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F-StateMachineUpdater] INFO  ha.SCMStateMachine (SCMStateMachine.java:takeSnapshot(290)) - Current Snapshot Index 15, takeSnapshot took 1 ms
2021-10-05 13:24:57,817 [RatisPipelineUtilsThread - 0] INFO  pipeline.PipelineManagerImpl (PipelineManagerImpl.java:recordMetricsForPipeline(613)) - Pipeline: PipelineID=1cc8aba1-0118-4460-9a8d-9360a73a2abc contains same datanodes as previous pipelines: PipelineID=5cfa055b-4c5c-4f3c-a5c0-62f8e1a01d1d nodeIds: b668fbba-0931-4533-8c87-c6849aaa836f, 830d4653-8da7-4c59-a1a4-1cd595539218, 9cad18a2-4b78-4cb8-813e-2348ce620e43
2021-10-05 13:24:57,817 [21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:takeSnapshot(281)) - 21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F-StateMachineUpdater: Took a snapshot at index 15
2021-10-05 13:24:57,818 [21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:lambda$new$0(89)) - 21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F-StateMachineUpdater: snapshotIndex: updateIncreasingly 10 -> 15
2021-10-05 13:24:57,818 [21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:purge(306)) - 21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F-SegmentedRaftLog: purge 15
2021-10-05 13:24:57,818 [21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - 21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F-SegmentedRaftLog: snapshotIndex: updateIncreasingly 10 -> 15
2021-10-05 13:24:57,818 [21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - 21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F-SegmentedRaftLog: purgeIndex: updateToMax old=10, new=15, updated? true
2021-10-05 13:24:57,822 [6d234f4d-474a-4c74-a9e9-8f3885fce584@group-5AA8DAB94A1F-StateMachineUpdater] INFO  pipeline.PipelineStateManagerImpl (PipelineStateManagerImpl.java:addPipeline(101)) - Created pipeline Pipeline[ Id: 1cc8aba1-0118-4460-9a8d-9360a73a2abc, Nodes: b668fbba-0931-4533-8c87-c6849aaa836f{ip: 127.0.0.1, host: localhost, ports: [REPLICATION=42285, RATIS=40511, RATIS_ADMIN=40511, RATIS_SERVER=40511, STANDALONE=44361], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}830d4653-8da7-4c59-a1a4-1cd595539218{ip: 127.0.0.1, host: localhost, ports: [REPLICATION=34867, RATIS=42995, RATIS_ADMIN=42995, RATIS_SERVER=42995, STANDALONE=44359], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}9cad18a2-4b78-4cb8-813e-2348ce620e43{ip: 127.0.0.1, host: localhost, ports: [REPLICATION=45905, RATIS=34379, RATIS_ADMIN=34379, RATIS_SERVER=34379, STANDALONE=41383], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}, ReplicationConfig: RATIS/THREE, State:ALLOCATED, leaderId:, CreationTimestamp2021-10-05T13:24:57.798Z[Etc/UTC]].
2021-10-05 13:24:57,822 [6d234f4d-474a-4c74-a9e9-8f3885fce584@group-5AA8DAB94A1F-StateMachineUpdater] INFO  safemode.HealthyPipelineSafeModeRule (HealthyPipelineSafeModeRule.java:initializeRule(152)) - Refreshed total pipeline count is 0, healthy pipeline threshold count is 1
2021-10-05 13:24:57,825 [6d234f4d-474a-4c74-a9e9-8f3885fce584@group-5AA8DAB94A1F-StateMachineUpdater] INFO  ha.SCMStateMachine (SCMStateMachine.java:takeSnapshot(290)) - Current Snapshot Index 15, takeSnapshot took 0 ms
2021-10-05 13:24:57,826 [6d234f4d-474a-4c74-a9e9-8f3885fce584@group-5AA8DAB94A1F-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:takeSnapshot(281)) - 6d234f4d-474a-4c74-a9e9-8f3885fce584@group-5AA8DAB94A1F-StateMachineUpdater: Took a snapshot at index 15
2021-10-05 13:24:57,826 [6d234f4d-474a-4c74-a9e9-8f3885fce584@group-5AA8DAB94A1F-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:lambda$new$0(89)) - 6d234f4d-474a-4c74-a9e9-8f3885fce584@group-5AA8DAB94A1F-StateMachineUpdater: snapshotIndex: updateIncreasingly 10 -> 15
2021-10-05 13:24:57,826 [6d234f4d-474a-4c74-a9e9-8f3885fce584@group-5AA8DAB94A1F-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:purge(306)) - 6d234f4d-474a-4c74-a9e9-8f3885fce584@group-5AA8DAB94A1F-SegmentedRaftLog: purge 15
2021-10-05 13:24:57,826 [6d234f4d-474a-4c74-a9e9-8f3885fce584@group-5AA8DAB94A1F-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - 6d234f4d-474a-4c74-a9e9-8f3885fce584@group-5AA8DAB94A1F-SegmentedRaftLog: snapshotIndex: updateIncreasingly 10 -> 15
2021-10-05 13:24:57,826 [6d234f4d-474a-4c74-a9e9-8f3885fce584@group-5AA8DAB94A1F-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - 6d234f4d-474a-4c74-a9e9-8f3885fce584@group-5AA8DAB94A1F-SegmentedRaftLog: purgeIndex: updateToMax old=10, new=15, updated? true
2021-10-05 13:24:58,740 [EndpointStateMachine task thread for /127.0.0.1:15041 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15041. Already tried 5 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:24:58,746 [Listener at 127.0.0.1/13296] INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(235)) - Nodes are ready. Got 3 of 3 DN Heartbeats.
2021-10-05 13:24:58,746 [Listener at 127.0.0.1/13296] INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(238)) - Waiting for cluster to exit safe mode
2021-10-05 13:24:58,746 [Listener at 127.0.0.1/13296] INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(240)) - SCM became leader
2021-10-05 13:24:58,796 [EndpointStateMachine task thread for /127.0.0.1:15021 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15021. Already tried 9 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:24:58,803 [EndpointStateMachine task thread for /127.0.0.1:15031 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15031. Already tried 9 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:24:59,741 [EndpointStateMachine task thread for /127.0.0.1:15041 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15041. Already tried 6 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:24:59,747 [Listener at 127.0.0.1/13296] INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(235)) - Nodes are ready. Got 3 of 3 DN Heartbeats.
2021-10-05 13:24:59,747 [Listener at 127.0.0.1/13296] INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(238)) - Waiting for cluster to exit safe mode
2021-10-05 13:24:59,747 [Listener at 127.0.0.1/13296] INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(240)) - SCM became leader
2021-10-05 13:24:59,797 [EndpointStateMachine task thread for /127.0.0.1:15021 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15021. Already tried 10 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:24:59,803 [EndpointStateMachine task thread for /127.0.0.1:15031 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15031. Already tried 10 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:00,002 [Datanode State Machine Thread - 0] ERROR datanode.RunningDatanodeState (RunningDatanodeState.java:computeNextContainerState(199)) - Error in executing end point task.
java.util.concurrent.ExecutionException: java.util.concurrent.TimeoutException
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.hadoop.ozone.container.common.states.datanode.RunningDatanodeState.computeNextContainerState(RunningDatanodeState.java:191)
	at org.apache.hadoop.ozone.container.common.states.datanode.RunningDatanodeState.await(RunningDatanodeState.java:231)
	at org.apache.hadoop.ozone.container.common.states.datanode.RunningDatanodeState.await(RunningDatanodeState.java:50)
	at org.apache.hadoop.ozone.container.common.statemachine.StateContext.execute(StateContext.java:629)
	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.start(DatanodeStateMachine.java:270)
	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.lambda$startDaemon$0(DatanodeStateMachine.java:457)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.util.concurrent.TimeoutException
	at java.util.concurrent.FutureTask.get(FutureTask.java:205)
	at org.apache.hadoop.ozone.container.common.states.datanode.RunningDatanodeState.lambda$execute$0(RunningDatanodeState.java:149)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
2021-10-05 13:25:00,019 [Command processor thread] INFO  server.RaftServer (RaftServerProxy.java:addNew(95)) - b668fbba-0931-4533-8c87-c6849aaa836f: addNew group-16677137C488:[b668fbba-0931-4533-8c87-c6849aaa836f|rpc:127.0.0.1:40511|priority:1] returns group-16677137C488:java.util.concurrent.CompletableFuture@456787ac[Not completed]
2021-10-05 13:25:00,028 [pool-264-thread-1] INFO  server.RaftServer$Division (RaftServerImpl.java:<init>(181)) - b668fbba-0931-4533-8c87-c6849aaa836f: new RaftServerImpl for group-16677137C488:[b668fbba-0931-4533-8c87-c6849aaa836f|rpc:127.0.0.1:40511|priority:1] with ContainerStateMachine:uninitialized
2021-10-05 13:25:00,035 [pool-264-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.timeout.min = 5s (custom)
2021-10-05 13:25:00,035 [pool-264-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.timeout.max = 5200ms (custom)
2021-10-05 13:25:00,035 [pool-264-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.sleep.time = 25ms (default)
2021-10-05 13:25:00,035 [pool-264-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.slowness.timeout = 300s (custom)
2021-10-05 13:25:00,035 [pool-264-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.leaderelection.leader.step-down.wait-time = 10s (default)
2021-10-05 13:25:00,035 [pool-264-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.sleep.deviation.threshold = 300ms (default)
2021-10-05 13:25:00,035 [pool-264-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.appender.install.snapshot.enabled = false (custom)
2021-10-05 13:25:00,035 [pool-264-thread-1] INFO  server.RaftServer$Division (ServerState.java:<init>(105)) - b668fbba-0931-4533-8c87-c6849aaa836f@group-16677137C488: ConfigurationManager, init=-1: [b668fbba-0931-4533-8c87-c6849aaa836f|rpc:127.0.0.1:40511|priority:1], old=null, confs=<EMPTY_MAP>
2021-10-05 13:25:00,036 [pool-264-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.storage.dir = [/home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-36b87918-66c6-4e2c-9c49-5aa8dab94a1f/datanode-0/data/ratis] (custom)
2021-10-05 13:25:00,036 [pool-264-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.corruption.policy = EXCEPTION (default)
2021-10-05 13:25:00,036 [pool-264-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.storage.free-space.min = 0MB (=0) (default)
2021-10-05 13:25:00,036 [pool-264-thread-1] INFO  storage.RaftStorageDirectory (RaftStorageDirectoryImpl.java:analyzeStorage(135)) - The storage directory /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-36b87918-66c6-4e2c-9c49-5aa8dab94a1f/datanode-0/data/ratis/fb43a933-1c8b-4815-9314-16677137c488 does not exist. Creating ...
2021-10-05 13:25:00,038 [pool-264-thread-1] INFO  storage.RaftStorageDirectory (RaftStorageDirectoryImpl.java:tryLock(230)) - Lock on /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-36b87918-66c6-4e2c-9c49-5aa8dab94a1f/datanode-0/data/ratis/fb43a933-1c8b-4815-9314-16677137c488/in_use.lock acquired by nodename 17451@fv-az270-324
2021-10-05 13:25:00,039 [pool-264-thread-1] INFO  storage.RaftStorage (RaftStorageImpl.java:format(89)) - Storage directory /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-36b87918-66c6-4e2c-9c49-5aa8dab94a1f/datanode-0/data/ratis/fb43a933-1c8b-4815-9314-16677137c488 has been successfully formatted.
2021-10-05 13:25:00,039 [pool-264-thread-1] INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(224)) - group-16677137C488: The snapshot info is null. Setting the last applied indexto:(t:0, i:~)
2021-10-05 13:25:00,039 [pool-264-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.notification.no-leader.timeout = 300s (custom)
2021-10-05 13:25:00,039 [pool-264-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.use.memory = false (default)
2021-10-05 13:25:00,039 [pool-264-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.purge.gap = 1000000 (custom)
2021-10-05 13:25:00,039 [pool-264-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2021-10-05 13:25:00,040 [pool-264-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.segment.size.max = 1048576 (custom)
2021-10-05 13:25:00,041 [EventQueue-PipelineReportForPipelineReportHandler] INFO  pipeline.PipelineManagerImpl (PipelineManagerImpl.java:openPipeline(282)) - Pipeline Pipeline[ Id: fb43a933-1c8b-4815-9314-16677137c488, Nodes: b668fbba-0931-4533-8c87-c6849aaa836f{ip: 127.0.0.1, host: localhost, ports: [REPLICATION=42285, RATIS=40511, RATIS_ADMIN=40511, RATIS_SERVER=40511, STANDALONE=44361], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}, ReplicationConfig: RATIS/ONE, State:ALLOCATED, leaderId:b668fbba-0931-4533-8c87-c6849aaa836f, CreationTimestamp2021-10-05T13:24:57.010Z[Etc/UTC]] moved to OPEN state
2021-10-05 13:25:00,041 [EventQueue-PipelineReportForPipelineReportHandler] INFO  pipeline.PipelineManagerImpl (PipelineManagerImpl.java:openPipeline(282)) - Pipeline Pipeline[ Id: fb43a933-1c8b-4815-9314-16677137c488, Nodes: b668fbba-0931-4533-8c87-c6849aaa836f{ip: 127.0.0.1, host: localhost, ports: [REPLICATION=42285, RATIS=40511, RATIS_ADMIN=40511, RATIS_SERVER=40511, STANDALONE=44361], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}, ReplicationConfig: RATIS/ONE, State:ALLOCATED, leaderId:b668fbba-0931-4533-8c87-c6849aaa836f, CreationTimestamp2021-10-05T13:24:57.010Z[Etc/UTC]] moved to OPEN state
2021-10-05 13:25:00,052 [EndpointStateMachine task thread for /127.0.0.1:13549 - 0 ] WARN  statemachine.EndpointStateMachine (EndpointStateMachine.java:logIfNeeded(236)) - Unable to communicate to SCM server at 127.0.0.1:13549 for past 0 seconds.
java.net.SocketTimeoutException: Call From fv-az270-324/10.1.0.10 to localhost:13549 failed on socket timeout exception: java.net.SocketTimeoutException: 5000 millis timeout while waiting for channel to be ready for read. ch : java.nio.channels.SocketChannel[connected local=/127.0.0.1:47820 remote=/127.0.0.1:13549]; For more details see:  http://wiki.apache.org/hadoop/SocketTimeout
	at sun.reflect.GeneratedConstructorAccessor31.newInstance(Unknown Source)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.hadoop.net.NetUtils.wrapWithMessage(NetUtils.java:913)
	at org.apache.hadoop.net.NetUtils.wrapException(NetUtils.java:848)
	at org.apache.hadoop.ipc.Client.getRpcResponse(Client.java:1577)
	at org.apache.hadoop.ipc.Client.call(Client.java:1519)
	at org.apache.hadoop.ipc.Client.call(Client.java:1416)
	at org.apache.hadoop.ipc.ProtobufRpcEngine$Invoker.invoke(ProtobufRpcEngine.java:236)
	at org.apache.hadoop.ipc.ProtobufRpcEngine$Invoker.invoke(ProtobufRpcEngine.java:123)
	at com.sun.proxy.$Proxy48.submitRequest(Unknown Source)
	at org.apache.hadoop.ozone.protocolPB.StorageContainerDatanodeProtocolClientSideTranslatorPB.submitRequest(StorageContainerDatanodeProtocolClientSideTranslatorPB.java:117)
	at org.apache.hadoop.ozone.protocolPB.StorageContainerDatanodeProtocolClientSideTranslatorPB.getVersion(StorageContainerDatanodeProtocolClientSideTranslatorPB.java:133)
	at org.apache.hadoop.ozone.container.common.states.endpoint.VersionEndpointTask.call(VersionEndpointTask.java:71)
	at org.apache.hadoop.ozone.container.common.states.endpoint.VersionEndpointTask.call(VersionEndpointTask.java:42)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.net.SocketTimeoutException: 5000 millis timeout while waiting for channel to be ready for read. ch : java.nio.channels.SocketChannel[connected local=/127.0.0.1:47820 remote=/127.0.0.1:13549]
	at org.apache.hadoop.net.SocketIOWithTimeout.doIO(SocketIOWithTimeout.java:164)
	at org.apache.hadoop.net.SocketInputStream.read(SocketInputStream.java:161)
	at org.apache.hadoop.net.SocketInputStream.read(SocketInputStream.java:131)
	at java.io.FilterInputStream.read(FilterInputStream.java:133)
	at java.io.BufferedInputStream.fill(BufferedInputStream.java:246)
	at java.io.BufferedInputStream.read(BufferedInputStream.java:265)
	at java.io.FilterInputStream.read(FilterInputStream.java:83)
	at java.io.FilterInputStream.read(FilterInputStream.java:83)
	at org.apache.hadoop.ipc.Client$Connection$PingInputStream.read(Client.java:563)
	at java.io.DataInputStream.readInt(DataInputStream.java:387)
	at org.apache.hadoop.ipc.Client$IpcStreams.readResponse(Client.java:1892)
	at org.apache.hadoop.ipc.Client$Connection.receiveRpcResponse(Client.java:1202)
	at org.apache.hadoop.ipc.Client$Connection.run(Client.java:1098)
2021-10-05 13:25:00,053 [pool-264-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.segment.cache.num.max = 2 (custom)
2021-10-05 13:25:00,069 [pool-264-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.segment.cache.size.max = 200MB (=209715200) (default)
2021-10-05 13:25:00,069 [pool-264-thread-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:<init>(182)) - new b668fbba-0931-4533-8c87-c6849aaa836f@group-16677137C488-SegmentedRaftLogWorker for RaftStorageImpl:Storage Directory /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-36b87918-66c6-4e2c-9c49-5aa8dab94a1f/datanode-0/data/ratis/fb43a933-1c8b-4815-9314-16677137c488
2021-10-05 13:25:00,069 [pool-264-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2021-10-05 13:25:00,069 [pool-264-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.queue.element-limit = 1024 (custom)
2021-10-05 13:25:00,069 [pool-264-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.segment.size.max = 1048576 (custom)
2021-10-05 13:25:00,069 [pool-264-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.preallocated.size = 16384 (custom)
2021-10-05 13:25:00,069 [pool-264-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.force.sync.num = 128 (default)
2021-10-05 13:25:00,069 [pool-264-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.statemachine.data.sync = true (default)
2021-10-05 13:25:00,069 [pool-264-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2021-10-05 13:25:00,052 [EndpointStateMachine task thread for /127.0.0.1:13549 - 0 ] WARN  statemachine.EndpointStateMachine (EndpointStateMachine.java:logIfNeeded(236)) - Unable to communicate to SCM server at 127.0.0.1:13549 for past 0 seconds.
java.net.SocketTimeoutException: Call From fv-az270-324/10.1.0.10 to localhost:13549 failed on socket timeout exception: java.net.SocketTimeoutException: 5000 millis timeout while waiting for channel to be ready for read. ch : java.nio.channels.SocketChannel[connected local=/127.0.0.1:47820 remote=/127.0.0.1:13549]; For more details see:  http://wiki.apache.org/hadoop/SocketTimeout
	at sun.reflect.GeneratedConstructorAccessor31.newInstance(Unknown Source)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.hadoop.net.NetUtils.wrapWithMessage(NetUtils.java:913)
	at org.apache.hadoop.net.NetUtils.wrapException(NetUtils.java:848)
	at org.apache.hadoop.ipc.Client.getRpcResponse(Client.java:1577)
	at org.apache.hadoop.ipc.Client.call(Client.java:1519)
	at org.apache.hadoop.ipc.Client.call(Client.java:1416)
	at org.apache.hadoop.ipc.ProtobufRpcEngine$Invoker.invoke(ProtobufRpcEngine.java:236)
	at org.apache.hadoop.ipc.ProtobufRpcEngine$Invoker.invoke(ProtobufRpcEngine.java:123)
	at com.sun.proxy.$Proxy48.submitRequest(Unknown Source)
	at org.apache.hadoop.ozone.protocolPB.StorageContainerDatanodeProtocolClientSideTranslatorPB.submitRequest(StorageContainerDatanodeProtocolClientSideTranslatorPB.java:117)
	at org.apache.hadoop.ozone.protocolPB.StorageContainerDatanodeProtocolClientSideTranslatorPB.getVersion(StorageContainerDatanodeProtocolClientSideTranslatorPB.java:133)
	at org.apache.hadoop.ozone.container.common.states.endpoint.VersionEndpointTask.call(VersionEndpointTask.java:71)
	at org.apache.hadoop.ozone.container.common.states.endpoint.VersionEndpointTask.call(VersionEndpointTask.java:42)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.net.SocketTimeoutException: 5000 millis timeout while waiting for channel to be ready for read. ch : java.nio.channels.SocketChannel[connected local=/127.0.0.1:47820 remote=/127.0.0.1:13549]
	at org.apache.hadoop.net.SocketIOWithTimeout.doIO(SocketIOWithTimeout.java:164)
	at org.apache.hadoop.net.SocketInputStream.read(SocketInputStream.java:161)
	at org.apache.hadoop.net.SocketInputStream.read(SocketInputStream.java:131)
	at java.io.FilterInputStream.read(FilterInputStream.java:133)
	at java.io.BufferedInputStream.fill(BufferedInputStream.java:246)
	at java.io.BufferedInputStream.read(BufferedInputStream.java:265)
	at java.io.FilterInputStream.read(FilterInputStream.java:83)
	at java.io.FilterInputStream.read(FilterInputStream.java:83)
	at org.apache.hadoop.ipc.Client$Connection$PingInputStream.read(Client.java:563)
	at java.io.DataInputStream.readInt(DataInputStream.java:387)
	at org.apache.hadoop.ipc.Client$IpcStreams.readResponse(Client.java:1892)
	at org.apache.hadoop.ipc.Client$Connection.receiveRpcResponse(Client.java:1202)
	at org.apache.hadoop.ipc.Client$Connection.run(Client.java:1098)
2021-10-05 13:25:00,052 [EndpointStateMachine task thread for /127.0.0.1:13549 - 0 ] WARN  statemachine.EndpointStateMachine (EndpointStateMachine.java:logIfNeeded(236)) - Unable to communicate to SCM server at localhost:13549 for past 0 seconds.
java.net.SocketTimeoutException: Call From fv-az270-324/10.1.0.10 to localhost:13549 failed on socket timeout exception: java.net.SocketTimeoutException: 5000 millis timeout while waiting for channel to be ready for read. ch : java.nio.channels.SocketChannel[connected local=/127.0.0.1:47820 remote=/127.0.0.1:13549]; For more details see:  http://wiki.apache.org/hadoop/SocketTimeout
	at sun.reflect.GeneratedConstructorAccessor31.newInstance(Unknown Source)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.hadoop.net.NetUtils.wrapWithMessage(NetUtils.java:913)
	at org.apache.hadoop.net.NetUtils.wrapException(NetUtils.java:848)
	at org.apache.hadoop.ipc.Client.getRpcResponse(Client.java:1577)
	at org.apache.hadoop.ipc.Client.call(Client.java:1519)
	at org.apache.hadoop.ipc.Client.call(Client.java:1416)
	at org.apache.hadoop.ipc.ProtobufRpcEngine$Invoker.invoke(ProtobufRpcEngine.java:236)
	at org.apache.hadoop.ipc.ProtobufRpcEngine$Invoker.invoke(ProtobufRpcEngine.java:123)
	at com.sun.proxy.$Proxy48.submitRequest(Unknown Source)
	at org.apache.hadoop.ozone.protocolPB.StorageContainerDatanodeProtocolClientSideTranslatorPB.submitRequest(StorageContainerDatanodeProtocolClientSideTranslatorPB.java:117)
	at org.apache.hadoop.ozone.protocolPB.StorageContainerDatanodeProtocolClientSideTranslatorPB.getVersion(StorageContainerDatanodeProtocolClientSideTranslatorPB.java:133)
	at org.apache.hadoop.ozone.container.common.states.endpoint.VersionEndpointTask.call(VersionEndpointTask.java:71)
	at org.apache.hadoop.ozone.container.common.states.endpoint.VersionEndpointTask.call(VersionEndpointTask.java:42)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.net.SocketTimeoutException: 5000 millis timeout while waiting for channel to be ready for read. ch : java.nio.channels.SocketChannel[connected local=/127.0.0.1:47820 remote=/127.0.0.1:13549]
	at org.apache.hadoop.net.SocketIOWithTimeout.doIO(SocketIOWithTimeout.java:164)
	at org.apache.hadoop.net.SocketInputStream.read(SocketInputStream.java:161)
	at org.apache.hadoop.net.SocketInputStream.read(SocketInputStream.java:131)
	at java.io.FilterInputStream.read(FilterInputStream.java:133)
	at java.io.BufferedInputStream.fill(BufferedInputStream.java:246)
	at java.io.BufferedInputStream.read(BufferedInputStream.java:265)
	at java.io.FilterInputStream.read(FilterInputStream.java:83)
	at java.io.FilterInputStream.read(FilterInputStream.java:83)
	at org.apache.hadoop.ipc.Client$Connection$PingInputStream.read(Client.java:563)
	at java.io.DataInputStream.readInt(DataInputStream.java:387)
	at org.apache.hadoop.ipc.Client$IpcStreams.readResponse(Client.java:1892)
	at org.apache.hadoop.ipc.Client$Connection.receiveRpcResponse(Client.java:1202)
	at org.apache.hadoop.ipc.Client$Connection.run(Client.java:1098)
2021-10-05 13:25:00,069 [pool-264-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2021-10-05 13:25:00,080 [21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F-StateMachineUpdater] INFO  safemode.HealthyPipelineSafeModeRule (HealthyPipelineSafeModeRule.java:initializeRule(152)) - Refreshed total pipeline count is 0, healthy pipeline threshold count is 1
2021-10-05 13:25:00,081 [EventQueue-PipelineReportForPipelineReportHandler] INFO  ha.SCMHAInvocationHandler (SCMHAInvocationHandler.java:invokeRatis(113)) - Invoking method public abstract void org.apache.hadoop.hdds.scm.pipeline.PipelineStateManager.updatePipelineState(org.apache.hadoop.hdds.protocol.proto.HddsProtos$PipelineID,org.apache.hadoop.hdds.protocol.proto.HddsProtos$PipelineState) throws java.io.IOException on target org.apache.hadoop.hdds.scm.ha.SCMRatisServerImpl@7efc167c, cost 37429.701us
2021-10-05 13:25:00,092 [EventQueue-PipelineReportForPipelineReportHandler] INFO  ha.SCMHAInvocationHandler (SCMHAInvocationHandler.java:invokeRatis(113)) - Invoking method public abstract void org.apache.hadoop.hdds.scm.pipeline.PipelineStateManager.updatePipelineState(org.apache.hadoop.hdds.protocol.proto.HddsProtos$PipelineID,org.apache.hadoop.hdds.protocol.proto.HddsProtos$PipelineState) throws java.io.IOException on target org.apache.hadoop.hdds.scm.ha.SCMRatisServerImpl@7c75acaa, cost 50312.874us
2021-10-05 13:25:00,093 [pool-264-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.write.buffer.size = 1048576 (custom)
2021-10-05 13:25:00,093 [pool-264-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2021-10-05 13:25:00,093 [pool-264-thread-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:lambda$new$0(133)) - b668fbba-0931-4533-8c87-c6849aaa836f@group-16677137C488-SegmentedRaftLogWorker: flushIndex: setUnconditionally 0 -> -1
2021-10-05 13:25:00,093 [pool-264-thread-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:lambda$new$0(133)) - b668fbba-0931-4533-8c87-c6849aaa836f@group-16677137C488-SegmentedRaftLogWorker: safeCacheEvictIndex: setUnconditionally 0 -> -1
2021-10-05 13:25:00,107 [6d234f4d-474a-4c74-a9e9-8f3885fce584@group-5AA8DAB94A1F-StateMachineUpdater] INFO  safemode.HealthyPipelineSafeModeRule (HealthyPipelineSafeModeRule.java:initializeRule(152)) - Refreshed total pipeline count is 0, healthy pipeline threshold count is 1
2021-10-05 13:25:00,107 [pool-264-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2021-10-05 13:25:00,107 [pool-264-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2021-10-05 13:25:00,115 [pool-264-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.snapshot.retention.file.num = 5 (custom)
2021-10-05 13:25:00,115 [pool-264-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.purge.upto.snapshot.index = false (default)
2021-10-05 13:25:00,115 [pool-264-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.retrycache.expirytime = 600000ms (custom)
2021-10-05 13:25:00,115 [pool-264-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.retrycache.statistics.expirytime = 100μs (default)
2021-10-05 13:25:00,117 [pool-264-thread-1] INFO  server.RaftServer$Division (RaftServerImpl.java:start(296)) - b668fbba-0931-4533-8c87-c6849aaa836f@group-16677137C488: start as a follower, conf=-1: [b668fbba-0931-4533-8c87-c6849aaa836f|rpc:127.0.0.1:40511|priority:1], old=null
2021-10-05 13:25:00,117 [pool-264-thread-1] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(285)) - b668fbba-0931-4533-8c87-c6849aaa836f@group-16677137C488: changes role from      null to FOLLOWER at term 0 for startAsFollower
2021-10-05 13:25:00,117 [pool-264-thread-1] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(130)) - b668fbba-0931-4533-8c87-c6849aaa836f: start b668fbba-0931-4533-8c87-c6849aaa836f@group-16677137C488-FollowerState
2021-10-05 13:25:00,127 [EventQueue-OpenPipelineForHealthyPipelineSafeModeRule] INFO  safemode.SCMSafeModeManager (HealthyPipelineSafeModeRule.java:process(124)) - SCM in safe mode. Healthy pipelines reported count is 0, required healthy pipeline reported count is 1
2021-10-05 13:25:00,132 [pool-264-thread-1] INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-16677137C488,id=b668fbba-0931-4533-8c87-c6849aaa836f
2021-10-05 13:25:00,143 [Command processor thread] INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:addGroup(763)) - Created group PipelineID=fb43a933-1c8b-4815-9314-16677137c488
2021-10-05 13:25:00,143 [Command processor thread] INFO  commandhandler.CreatePipelineCommandHandler (CreatePipelineCommandHandler.java:handle(106)) - Created Pipeline RATIS ONE PipelineID=fb43a933-1c8b-4815-9314-16677137c488.
2021-10-05 13:25:00,144 [Command processor thread] INFO  server.RaftServer (RaftServerProxy.java:addNew(95)) - b668fbba-0931-4533-8c87-c6849aaa836f: addNew group-62F8E1A01D1D:[b668fbba-0931-4533-8c87-c6849aaa836f|rpc:127.0.0.1:40511|priority:1, 830d4653-8da7-4c59-a1a4-1cd595539218|rpc:127.0.0.1:42995|priority:0, 9cad18a2-4b78-4cb8-813e-2348ce620e43|rpc:127.0.0.1:34379|priority:0] returns group-62F8E1A01D1D:java.util.concurrent.CompletableFuture@41581bd8[Not completed]
2021-10-05 13:25:00,144 [pool-264-thread-1] INFO  server.RaftServer$Division (RaftServerImpl.java:<init>(181)) - b668fbba-0931-4533-8c87-c6849aaa836f: new RaftServerImpl for group-62F8E1A01D1D:[b668fbba-0931-4533-8c87-c6849aaa836f|rpc:127.0.0.1:40511|priority:1, 830d4653-8da7-4c59-a1a4-1cd595539218|rpc:127.0.0.1:42995|priority:0, 9cad18a2-4b78-4cb8-813e-2348ce620e43|rpc:127.0.0.1:34379|priority:0] with ContainerStateMachine:uninitialized
2021-10-05 13:25:00,145 [pool-264-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.timeout.min = 5s (custom)
2021-10-05 13:25:00,145 [pool-264-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.timeout.max = 5200ms (custom)
2021-10-05 13:25:00,145 [pool-264-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.sleep.time = 25ms (default)
2021-10-05 13:25:00,145 [pool-264-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.slowness.timeout = 300s (custom)
2021-10-05 13:25:00,145 [pool-264-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.leaderelection.leader.step-down.wait-time = 10s (default)
2021-10-05 13:25:00,145 [pool-264-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.sleep.deviation.threshold = 300ms (default)
2021-10-05 13:25:00,145 [pool-264-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.appender.install.snapshot.enabled = false (custom)
2021-10-05 13:25:00,145 [pool-264-thread-1] INFO  server.RaftServer$Division (ServerState.java:<init>(105)) - b668fbba-0931-4533-8c87-c6849aaa836f@group-62F8E1A01D1D: ConfigurationManager, init=-1: [b668fbba-0931-4533-8c87-c6849aaa836f|rpc:127.0.0.1:40511|priority:1, 830d4653-8da7-4c59-a1a4-1cd595539218|rpc:127.0.0.1:42995|priority:0, 9cad18a2-4b78-4cb8-813e-2348ce620e43|rpc:127.0.0.1:34379|priority:0], old=null, confs=<EMPTY_MAP>
2021-10-05 13:25:00,145 [pool-264-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.storage.dir = [/home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-36b87918-66c6-4e2c-9c49-5aa8dab94a1f/datanode-0/data/ratis] (custom)
2021-10-05 13:25:00,145 [pool-264-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.corruption.policy = EXCEPTION (default)
2021-10-05 13:25:00,145 [pool-264-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.storage.free-space.min = 0MB (=0) (default)
2021-10-05 13:25:00,145 [pool-264-thread-1] INFO  storage.RaftStorageDirectory (RaftStorageDirectoryImpl.java:analyzeStorage(135)) - The storage directory /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-36b87918-66c6-4e2c-9c49-5aa8dab94a1f/datanode-0/data/ratis/5cfa055b-4c5c-4f3c-a5c0-62f8e1a01d1d does not exist. Creating ...
2021-10-05 13:25:00,150 [pool-264-thread-1] INFO  storage.RaftStorageDirectory (RaftStorageDirectoryImpl.java:tryLock(230)) - Lock on /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-36b87918-66c6-4e2c-9c49-5aa8dab94a1f/datanode-0/data/ratis/5cfa055b-4c5c-4f3c-a5c0-62f8e1a01d1d/in_use.lock acquired by nodename 17451@fv-az270-324
2021-10-05 13:25:00,152 [pool-264-thread-1] INFO  storage.RaftStorage (RaftStorageImpl.java:format(89)) - Storage directory /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-36b87918-66c6-4e2c-9c49-5aa8dab94a1f/datanode-0/data/ratis/5cfa055b-4c5c-4f3c-a5c0-62f8e1a01d1d has been successfully formatted.
2021-10-05 13:25:00,155 [EventQueue-OpenPipelineForHealthyPipelineSafeModeRule] INFO  safemode.SCMSafeModeManager (HealthyPipelineSafeModeRule.java:process(124)) - SCM in safe mode. Healthy pipelines reported count is 0, required healthy pipeline reported count is 1
2021-10-05 13:25:00,160 [pool-264-thread-1] INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(224)) - group-62F8E1A01D1D: The snapshot info is null. Setting the last applied indexto:(t:0, i:~)
2021-10-05 13:25:00,161 [pool-264-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.notification.no-leader.timeout = 300s (custom)
2021-10-05 13:25:00,161 [pool-264-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.use.memory = false (default)
2021-10-05 13:25:00,161 [pool-264-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.purge.gap = 1000000 (custom)
2021-10-05 13:25:00,161 [pool-264-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2021-10-05 13:25:00,161 [pool-264-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.segment.size.max = 1048576 (custom)
2021-10-05 13:25:00,161 [pool-264-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.segment.cache.num.max = 2 (custom)
2021-10-05 13:25:00,162 [pool-264-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.segment.cache.size.max = 200MB (=209715200) (default)
2021-10-05 13:25:00,162 [pool-264-thread-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:<init>(182)) - new b668fbba-0931-4533-8c87-c6849aaa836f@group-62F8E1A01D1D-SegmentedRaftLogWorker for RaftStorageImpl:Storage Directory /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-36b87918-66c6-4e2c-9c49-5aa8dab94a1f/datanode-0/data/ratis/5cfa055b-4c5c-4f3c-a5c0-62f8e1a01d1d
2021-10-05 13:25:00,162 [pool-264-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2021-10-05 13:25:00,162 [pool-264-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.queue.element-limit = 1024 (custom)
2021-10-05 13:25:00,162 [pool-264-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.segment.size.max = 1048576 (custom)
2021-10-05 13:25:00,162 [pool-264-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.preallocated.size = 16384 (custom)
2021-10-05 13:25:00,162 [pool-264-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.force.sync.num = 128 (default)
2021-10-05 13:25:00,162 [pool-264-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.statemachine.data.sync = true (default)
2021-10-05 13:25:00,162 [pool-264-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2021-10-05 13:25:00,162 [pool-264-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2021-10-05 13:25:00,163 [pool-264-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.write.buffer.size = 1048576 (custom)
2021-10-05 13:25:00,159 [EventQueue-OpenPipelineForHealthyPipelineSafeModeRule] INFO  safemode.SCMSafeModeManager (HealthyPipelineSafeModeRule.java:process(124)) - SCM in safe mode. Healthy pipelines reported count is 0, required healthy pipeline reported count is 1
2021-10-05 13:25:00,165 [pool-264-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2021-10-05 13:25:00,165 [pool-264-thread-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:lambda$new$0(133)) - b668fbba-0931-4533-8c87-c6849aaa836f@group-62F8E1A01D1D-SegmentedRaftLogWorker: flushIndex: setUnconditionally 0 -> -1
2021-10-05 13:25:00,165 [pool-264-thread-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:lambda$new$0(133)) - b668fbba-0931-4533-8c87-c6849aaa836f@group-62F8E1A01D1D-SegmentedRaftLogWorker: safeCacheEvictIndex: setUnconditionally 0 -> -1
2021-10-05 13:25:00,172 [pool-264-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2021-10-05 13:25:00,172 [pool-264-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2021-10-05 13:25:00,172 [pool-264-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.snapshot.retention.file.num = 5 (custom)
2021-10-05 13:25:00,172 [pool-264-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.purge.upto.snapshot.index = false (default)
2021-10-05 13:25:00,172 [pool-264-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.retrycache.expirytime = 600000ms (custom)
2021-10-05 13:25:00,172 [pool-264-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.retrycache.statistics.expirytime = 100μs (default)
2021-10-05 13:25:00,173 [pool-264-thread-1] INFO  server.RaftServer$Division (RaftServerImpl.java:start(296)) - b668fbba-0931-4533-8c87-c6849aaa836f@group-62F8E1A01D1D: start as a follower, conf=-1: [b668fbba-0931-4533-8c87-c6849aaa836f|rpc:127.0.0.1:40511|priority:1, 830d4653-8da7-4c59-a1a4-1cd595539218|rpc:127.0.0.1:42995|priority:0, 9cad18a2-4b78-4cb8-813e-2348ce620e43|rpc:127.0.0.1:34379|priority:0], old=null
2021-10-05 13:25:00,173 [pool-264-thread-1] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(285)) - b668fbba-0931-4533-8c87-c6849aaa836f@group-62F8E1A01D1D: changes role from      null to FOLLOWER at term 0 for startAsFollower
2021-10-05 13:25:00,174 [pool-264-thread-1] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(130)) - b668fbba-0931-4533-8c87-c6849aaa836f: start b668fbba-0931-4533-8c87-c6849aaa836f@group-62F8E1A01D1D-FollowerState
2021-10-05 13:25:00,191 [pool-264-thread-1] INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-62F8E1A01D1D,id=b668fbba-0931-4533-8c87-c6849aaa836f
2021-10-05 13:25:00,194 [Command processor thread] INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:addGroup(763)) - Created group PipelineID=5cfa055b-4c5c-4f3c-a5c0-62f8e1a01d1d
2021-10-05 13:25:00,210 [grpc-default-executor-2] INFO  server.RaftServer (RaftServerProxy.java:addNew(95)) - 9cad18a2-4b78-4cb8-813e-2348ce620e43: addNew group-62F8E1A01D1D:[b668fbba-0931-4533-8c87-c6849aaa836f|rpc:127.0.0.1:40511|dataStream:|priority:1, 830d4653-8da7-4c59-a1a4-1cd595539218|rpc:127.0.0.1:42995|dataStream:|priority:0, 9cad18a2-4b78-4cb8-813e-2348ce620e43|rpc:127.0.0.1:34379|dataStream:|priority:0] returns group-62F8E1A01D1D:java.util.concurrent.CompletableFuture@3d40c228[Not completed]
2021-10-05 13:25:00,211 [pool-306-thread-1] INFO  server.RaftServer$Division (RaftServerImpl.java:<init>(181)) - 9cad18a2-4b78-4cb8-813e-2348ce620e43: new RaftServerImpl for group-62F8E1A01D1D:[b668fbba-0931-4533-8c87-c6849aaa836f|rpc:127.0.0.1:40511|dataStream:|priority:1, 830d4653-8da7-4c59-a1a4-1cd595539218|rpc:127.0.0.1:42995|dataStream:|priority:0, 9cad18a2-4b78-4cb8-813e-2348ce620e43|rpc:127.0.0.1:34379|dataStream:|priority:0] with ContainerStateMachine:uninitialized
2021-10-05 13:25:00,212 [pool-306-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.timeout.min = 5s (custom)
2021-10-05 13:25:00,212 [pool-306-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.timeout.max = 5200ms (custom)
2021-10-05 13:25:00,212 [pool-306-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.sleep.time = 25ms (default)
2021-10-05 13:25:00,213 [pool-306-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.slowness.timeout = 300s (custom)
2021-10-05 13:25:00,213 [pool-306-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.leaderelection.leader.step-down.wait-time = 10s (default)
2021-10-05 13:25:00,213 [pool-306-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.sleep.deviation.threshold = 300ms (default)
2021-10-05 13:25:00,213 [pool-306-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.appender.install.snapshot.enabled = false (custom)
2021-10-05 13:25:00,213 [pool-306-thread-1] INFO  server.RaftServer$Division (ServerState.java:<init>(105)) - 9cad18a2-4b78-4cb8-813e-2348ce620e43@group-62F8E1A01D1D: ConfigurationManager, init=-1: [b668fbba-0931-4533-8c87-c6849aaa836f|rpc:127.0.0.1:40511|dataStream:|priority:1, 830d4653-8da7-4c59-a1a4-1cd595539218|rpc:127.0.0.1:42995|dataStream:|priority:0, 9cad18a2-4b78-4cb8-813e-2348ce620e43|rpc:127.0.0.1:34379|dataStream:|priority:0], old=null, confs=<EMPTY_MAP>
2021-10-05 13:25:00,213 [pool-306-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.storage.dir = [/home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-36b87918-66c6-4e2c-9c49-5aa8dab94a1f/datanode-2/data/ratis] (custom)
2021-10-05 13:25:00,213 [pool-306-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.corruption.policy = EXCEPTION (default)
2021-10-05 13:25:00,213 [pool-306-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.storage.free-space.min = 0MB (=0) (default)
2021-10-05 13:25:00,213 [pool-306-thread-1] INFO  storage.RaftStorageDirectory (RaftStorageDirectoryImpl.java:analyzeStorage(135)) - The storage directory /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-36b87918-66c6-4e2c-9c49-5aa8dab94a1f/datanode-2/data/ratis/5cfa055b-4c5c-4f3c-a5c0-62f8e1a01d1d does not exist. Creating ...
2021-10-05 13:25:00,214 [pool-306-thread-1] INFO  storage.RaftStorageDirectory (RaftStorageDirectoryImpl.java:tryLock(230)) - Lock on /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-36b87918-66c6-4e2c-9c49-5aa8dab94a1f/datanode-2/data/ratis/5cfa055b-4c5c-4f3c-a5c0-62f8e1a01d1d/in_use.lock acquired by nodename 17451@fv-az270-324
2021-10-05 13:25:00,224 [pool-306-thread-1] INFO  storage.RaftStorage (RaftStorageImpl.java:format(89)) - Storage directory /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-36b87918-66c6-4e2c-9c49-5aa8dab94a1f/datanode-2/data/ratis/5cfa055b-4c5c-4f3c-a5c0-62f8e1a01d1d has been successfully formatted.
2021-10-05 13:25:00,224 [pool-306-thread-1] INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(224)) - group-62F8E1A01D1D: The snapshot info is null. Setting the last applied indexto:(t:0, i:~)
2021-10-05 13:25:00,224 [pool-306-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.notification.no-leader.timeout = 300s (custom)
2021-10-05 13:25:00,224 [pool-306-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.use.memory = false (default)
2021-10-05 13:25:00,224 [pool-306-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.purge.gap = 1000000 (custom)
2021-10-05 13:25:00,225 [pool-306-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2021-10-05 13:25:00,225 [pool-306-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.segment.size.max = 1048576 (custom)
2021-10-05 13:25:00,225 [pool-306-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.segment.cache.num.max = 2 (custom)
2021-10-05 13:25:00,225 [pool-306-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.segment.cache.size.max = 200MB (=209715200) (default)
2021-10-05 13:25:00,225 [pool-306-thread-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:<init>(182)) - new 9cad18a2-4b78-4cb8-813e-2348ce620e43@group-62F8E1A01D1D-SegmentedRaftLogWorker for RaftStorageImpl:Storage Directory /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-36b87918-66c6-4e2c-9c49-5aa8dab94a1f/datanode-2/data/ratis/5cfa055b-4c5c-4f3c-a5c0-62f8e1a01d1d
2021-10-05 13:25:00,225 [pool-306-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2021-10-05 13:25:00,225 [pool-306-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.queue.element-limit = 1024 (custom)
2021-10-05 13:25:00,225 [pool-306-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.segment.size.max = 1048576 (custom)
2021-10-05 13:25:00,225 [pool-306-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.preallocated.size = 16384 (custom)
2021-10-05 13:25:00,225 [pool-306-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.force.sync.num = 128 (default)
2021-10-05 13:25:00,225 [pool-306-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.statemachine.data.sync = true (default)
2021-10-05 13:25:00,225 [pool-306-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2021-10-05 13:25:00,226 [pool-306-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2021-10-05 13:25:00,226 [pool-306-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.write.buffer.size = 1048576 (custom)
2021-10-05 13:25:00,231 [pool-306-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2021-10-05 13:25:00,232 [pool-306-thread-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:lambda$new$0(133)) - 9cad18a2-4b78-4cb8-813e-2348ce620e43@group-62F8E1A01D1D-SegmentedRaftLogWorker: flushIndex: setUnconditionally 0 -> -1
2021-10-05 13:25:00,232 [pool-306-thread-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:lambda$new$0(133)) - 9cad18a2-4b78-4cb8-813e-2348ce620e43@group-62F8E1A01D1D-SegmentedRaftLogWorker: safeCacheEvictIndex: setUnconditionally 0 -> -1
2021-10-05 13:25:00,241 [pool-306-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2021-10-05 13:25:00,241 [pool-306-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2021-10-05 13:25:00,241 [pool-306-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.snapshot.retention.file.num = 5 (custom)
2021-10-05 13:25:00,241 [pool-306-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.purge.upto.snapshot.index = false (default)
2021-10-05 13:25:00,241 [pool-306-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.retrycache.expirytime = 600000ms (custom)
2021-10-05 13:25:00,241 [pool-306-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.retrycache.statistics.expirytime = 100μs (default)
2021-10-05 13:25:00,242 [pool-306-thread-1] INFO  server.RaftServer$Division (RaftServerImpl.java:start(296)) - 9cad18a2-4b78-4cb8-813e-2348ce620e43@group-62F8E1A01D1D: start as a follower, conf=-1: [b668fbba-0931-4533-8c87-c6849aaa836f|rpc:127.0.0.1:40511|dataStream:|priority:1, 830d4653-8da7-4c59-a1a4-1cd595539218|rpc:127.0.0.1:42995|dataStream:|priority:0, 9cad18a2-4b78-4cb8-813e-2348ce620e43|rpc:127.0.0.1:34379|dataStream:|priority:0], old=null
2021-10-05 13:25:00,242 [pool-306-thread-1] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(285)) - 9cad18a2-4b78-4cb8-813e-2348ce620e43@group-62F8E1A01D1D: changes role from      null to FOLLOWER at term 0 for startAsFollower
2021-10-05 13:25:00,243 [pool-306-thread-1] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(130)) - 9cad18a2-4b78-4cb8-813e-2348ce620e43: start 9cad18a2-4b78-4cb8-813e-2348ce620e43@group-62F8E1A01D1D-FollowerState
2021-10-05 13:25:00,260 [pool-306-thread-1] INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-62F8E1A01D1D,id=9cad18a2-4b78-4cb8-813e-2348ce620e43
2021-10-05 13:25:00,303 [grpc-default-executor-2] INFO  server.RaftServer (RaftServerProxy.java:addNew(95)) - 830d4653-8da7-4c59-a1a4-1cd595539218: addNew group-62F8E1A01D1D:[b668fbba-0931-4533-8c87-c6849aaa836f|rpc:127.0.0.1:40511|dataStream:|priority:1, 830d4653-8da7-4c59-a1a4-1cd595539218|rpc:127.0.0.1:42995|dataStream:|priority:0, 9cad18a2-4b78-4cb8-813e-2348ce620e43|rpc:127.0.0.1:34379|dataStream:|priority:0] returns group-62F8E1A01D1D:java.util.concurrent.CompletableFuture@fb06624[Not completed]
2021-10-05 13:25:00,304 [pool-285-thread-1] INFO  server.RaftServer$Division (RaftServerImpl.java:<init>(181)) - 830d4653-8da7-4c59-a1a4-1cd595539218: new RaftServerImpl for group-62F8E1A01D1D:[b668fbba-0931-4533-8c87-c6849aaa836f|rpc:127.0.0.1:40511|dataStream:|priority:1, 830d4653-8da7-4c59-a1a4-1cd595539218|rpc:127.0.0.1:42995|dataStream:|priority:0, 9cad18a2-4b78-4cb8-813e-2348ce620e43|rpc:127.0.0.1:34379|dataStream:|priority:0] with ContainerStateMachine:uninitialized
2021-10-05 13:25:00,310 [pool-285-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.timeout.min = 5s (custom)
2021-10-05 13:25:00,310 [pool-285-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.timeout.max = 5200ms (custom)
2021-10-05 13:25:00,310 [pool-285-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.sleep.time = 25ms (default)
2021-10-05 13:25:00,310 [pool-285-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.slowness.timeout = 300s (custom)
2021-10-05 13:25:00,310 [pool-285-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.leaderelection.leader.step-down.wait-time = 10s (default)
2021-10-05 13:25:00,310 [pool-285-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.sleep.deviation.threshold = 300ms (default)
2021-10-05 13:25:00,310 [pool-285-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.appender.install.snapshot.enabled = false (custom)
2021-10-05 13:25:00,310 [pool-285-thread-1] INFO  server.RaftServer$Division (ServerState.java:<init>(105)) - 830d4653-8da7-4c59-a1a4-1cd595539218@group-62F8E1A01D1D: ConfigurationManager, init=-1: [b668fbba-0931-4533-8c87-c6849aaa836f|rpc:127.0.0.1:40511|dataStream:|priority:1, 830d4653-8da7-4c59-a1a4-1cd595539218|rpc:127.0.0.1:42995|dataStream:|priority:0, 9cad18a2-4b78-4cb8-813e-2348ce620e43|rpc:127.0.0.1:34379|dataStream:|priority:0], old=null, confs=<EMPTY_MAP>
2021-10-05 13:25:00,310 [pool-285-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.storage.dir = [/home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-36b87918-66c6-4e2c-9c49-5aa8dab94a1f/datanode-1/data/ratis] (custom)
2021-10-05 13:25:00,310 [pool-285-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.corruption.policy = EXCEPTION (default)
2021-10-05 13:25:00,310 [pool-285-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.storage.free-space.min = 0MB (=0) (default)
2021-10-05 13:25:00,311 [pool-285-thread-1] INFO  storage.RaftStorageDirectory (RaftStorageDirectoryImpl.java:analyzeStorage(135)) - The storage directory /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-36b87918-66c6-4e2c-9c49-5aa8dab94a1f/datanode-1/data/ratis/5cfa055b-4c5c-4f3c-a5c0-62f8e1a01d1d does not exist. Creating ...
2021-10-05 13:25:00,314 [pool-285-thread-1] INFO  storage.RaftStorageDirectory (RaftStorageDirectoryImpl.java:tryLock(230)) - Lock on /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-36b87918-66c6-4e2c-9c49-5aa8dab94a1f/datanode-1/data/ratis/5cfa055b-4c5c-4f3c-a5c0-62f8e1a01d1d/in_use.lock acquired by nodename 17451@fv-az270-324
2021-10-05 13:25:00,319 [pool-285-thread-1] INFO  storage.RaftStorage (RaftStorageImpl.java:format(89)) - Storage directory /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-36b87918-66c6-4e2c-9c49-5aa8dab94a1f/datanode-1/data/ratis/5cfa055b-4c5c-4f3c-a5c0-62f8e1a01d1d has been successfully formatted.
2021-10-05 13:25:00,319 [pool-285-thread-1] INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(224)) - group-62F8E1A01D1D: The snapshot info is null. Setting the last applied indexto:(t:0, i:~)
2021-10-05 13:25:00,320 [pool-285-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.notification.no-leader.timeout = 300s (custom)
2021-10-05 13:25:00,320 [pool-285-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.use.memory = false (default)
2021-10-05 13:25:00,320 [pool-285-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.purge.gap = 1000000 (custom)
2021-10-05 13:25:00,320 [pool-285-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2021-10-05 13:25:00,320 [pool-285-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.segment.size.max = 1048576 (custom)
2021-10-05 13:25:00,321 [pool-285-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.segment.cache.num.max = 2 (custom)
2021-10-05 13:25:00,321 [pool-285-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.segment.cache.size.max = 200MB (=209715200) (default)
2021-10-05 13:25:00,321 [pool-285-thread-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:<init>(182)) - new 830d4653-8da7-4c59-a1a4-1cd595539218@group-62F8E1A01D1D-SegmentedRaftLogWorker for RaftStorageImpl:Storage Directory /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-36b87918-66c6-4e2c-9c49-5aa8dab94a1f/datanode-1/data/ratis/5cfa055b-4c5c-4f3c-a5c0-62f8e1a01d1d
2021-10-05 13:25:00,321 [pool-285-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2021-10-05 13:25:00,321 [pool-285-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.queue.element-limit = 1024 (custom)
2021-10-05 13:25:00,322 [pool-285-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.segment.size.max = 1048576 (custom)
2021-10-05 13:25:00,322 [pool-285-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.preallocated.size = 16384 (custom)
2021-10-05 13:25:00,322 [pool-285-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.force.sync.num = 128 (default)
2021-10-05 13:25:00,323 [pool-285-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.statemachine.data.sync = true (default)
2021-10-05 13:25:00,324 [pool-285-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2021-10-05 13:25:00,324 [pool-285-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2021-10-05 13:25:00,325 [pool-285-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.write.buffer.size = 1048576 (custom)
2021-10-05 13:25:00,325 [pool-285-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2021-10-05 13:25:00,325 [pool-285-thread-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:lambda$new$0(133)) - 830d4653-8da7-4c59-a1a4-1cd595539218@group-62F8E1A01D1D-SegmentedRaftLogWorker: flushIndex: setUnconditionally 0 -> -1
2021-10-05 13:25:00,325 [pool-285-thread-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:lambda$new$0(133)) - 830d4653-8da7-4c59-a1a4-1cd595539218@group-62F8E1A01D1D-SegmentedRaftLogWorker: safeCacheEvictIndex: setUnconditionally 0 -> -1
2021-10-05 13:25:00,331 [pool-285-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2021-10-05 13:25:00,331 [pool-285-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2021-10-05 13:25:00,331 [pool-285-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.snapshot.retention.file.num = 5 (custom)
2021-10-05 13:25:00,331 [pool-285-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.purge.upto.snapshot.index = false (default)
2021-10-05 13:25:00,331 [pool-285-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.retrycache.expirytime = 600000ms (custom)
2021-10-05 13:25:00,332 [pool-285-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.retrycache.statistics.expirytime = 100μs (default)
2021-10-05 13:25:00,333 [pool-285-thread-1] INFO  server.RaftServer$Division (RaftServerImpl.java:start(296)) - 830d4653-8da7-4c59-a1a4-1cd595539218@group-62F8E1A01D1D: start as a follower, conf=-1: [b668fbba-0931-4533-8c87-c6849aaa836f|rpc:127.0.0.1:40511|dataStream:|priority:1, 830d4653-8da7-4c59-a1a4-1cd595539218|rpc:127.0.0.1:42995|dataStream:|priority:0, 9cad18a2-4b78-4cb8-813e-2348ce620e43|rpc:127.0.0.1:34379|dataStream:|priority:0], old=null
2021-10-05 13:25:00,335 [pool-285-thread-1] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(285)) - 830d4653-8da7-4c59-a1a4-1cd595539218@group-62F8E1A01D1D: changes role from      null to FOLLOWER at term 0 for startAsFollower
2021-10-05 13:25:00,335 [pool-285-thread-1] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(130)) - 830d4653-8da7-4c59-a1a4-1cd595539218: start 830d4653-8da7-4c59-a1a4-1cd595539218@group-62F8E1A01D1D-FollowerState
2021-10-05 13:25:00,343 [pool-285-thread-1] INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-62F8E1A01D1D,id=830d4653-8da7-4c59-a1a4-1cd595539218
2021-10-05 13:25:00,353 [Command processor thread] INFO  commandhandler.CreatePipelineCommandHandler (CreatePipelineCommandHandler.java:handle(106)) - Created Pipeline RATIS THREE PipelineID=5cfa055b-4c5c-4f3c-a5c0-62f8e1a01d1d.
2021-10-05 13:25:00,354 [Command processor thread] INFO  server.RaftServer (RaftServerProxy.java:addNew(95)) - b668fbba-0931-4533-8c87-c6849aaa836f: addNew group-9360A73A2ABC:[b668fbba-0931-4533-8c87-c6849aaa836f|rpc:127.0.0.1:40511|priority:0, 830d4653-8da7-4c59-a1a4-1cd595539218|rpc:127.0.0.1:42995|priority:0, 9cad18a2-4b78-4cb8-813e-2348ce620e43|rpc:127.0.0.1:34379|priority:1] returns group-9360A73A2ABC:java.util.concurrent.CompletableFuture@5690230c[Not completed]
2021-10-05 13:25:00,355 [pool-264-thread-1] INFO  server.RaftServer$Division (RaftServerImpl.java:<init>(181)) - b668fbba-0931-4533-8c87-c6849aaa836f: new RaftServerImpl for group-9360A73A2ABC:[b668fbba-0931-4533-8c87-c6849aaa836f|rpc:127.0.0.1:40511|priority:0, 830d4653-8da7-4c59-a1a4-1cd595539218|rpc:127.0.0.1:42995|priority:0, 9cad18a2-4b78-4cb8-813e-2348ce620e43|rpc:127.0.0.1:34379|priority:1] with ContainerStateMachine:uninitialized
2021-10-05 13:25:00,355 [pool-264-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.timeout.min = 5s (custom)
2021-10-05 13:25:00,355 [pool-264-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.timeout.max = 5200ms (custom)
2021-10-05 13:25:00,355 [pool-264-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.sleep.time = 25ms (default)
2021-10-05 13:25:00,355 [pool-264-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.slowness.timeout = 300s (custom)
2021-10-05 13:25:00,355 [pool-264-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.leaderelection.leader.step-down.wait-time = 10s (default)
2021-10-05 13:25:00,355 [pool-264-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.sleep.deviation.threshold = 300ms (default)
2021-10-05 13:25:00,355 [pool-264-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.appender.install.snapshot.enabled = false (custom)
2021-10-05 13:25:00,355 [pool-264-thread-1] INFO  server.RaftServer$Division (ServerState.java:<init>(105)) - b668fbba-0931-4533-8c87-c6849aaa836f@group-9360A73A2ABC: ConfigurationManager, init=-1: [b668fbba-0931-4533-8c87-c6849aaa836f|rpc:127.0.0.1:40511|priority:0, 830d4653-8da7-4c59-a1a4-1cd595539218|rpc:127.0.0.1:42995|priority:0, 9cad18a2-4b78-4cb8-813e-2348ce620e43|rpc:127.0.0.1:34379|priority:1], old=null, confs=<EMPTY_MAP>
2021-10-05 13:25:00,355 [pool-264-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.storage.dir = [/home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-36b87918-66c6-4e2c-9c49-5aa8dab94a1f/datanode-0/data/ratis] (custom)
2021-10-05 13:25:00,355 [pool-264-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.corruption.policy = EXCEPTION (default)
2021-10-05 13:25:00,355 [pool-264-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.storage.free-space.min = 0MB (=0) (default)
2021-10-05 13:25:00,355 [pool-264-thread-1] INFO  storage.RaftStorageDirectory (RaftStorageDirectoryImpl.java:analyzeStorage(135)) - The storage directory /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-36b87918-66c6-4e2c-9c49-5aa8dab94a1f/datanode-0/data/ratis/1cc8aba1-0118-4460-9a8d-9360a73a2abc does not exist. Creating ...
2021-10-05 13:25:00,357 [pool-264-thread-1] INFO  storage.RaftStorageDirectory (RaftStorageDirectoryImpl.java:tryLock(230)) - Lock on /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-36b87918-66c6-4e2c-9c49-5aa8dab94a1f/datanode-0/data/ratis/1cc8aba1-0118-4460-9a8d-9360a73a2abc/in_use.lock acquired by nodename 17451@fv-az270-324
2021-10-05 13:25:00,359 [pool-264-thread-1] INFO  storage.RaftStorage (RaftStorageImpl.java:format(89)) - Storage directory /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-36b87918-66c6-4e2c-9c49-5aa8dab94a1f/datanode-0/data/ratis/1cc8aba1-0118-4460-9a8d-9360a73a2abc has been successfully formatted.
2021-10-05 13:25:00,359 [pool-264-thread-1] INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(224)) - group-9360A73A2ABC: The snapshot info is null. Setting the last applied indexto:(t:0, i:~)
2021-10-05 13:25:00,360 [pool-264-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.notification.no-leader.timeout = 300s (custom)
2021-10-05 13:25:00,360 [pool-264-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.use.memory = false (default)
2021-10-05 13:25:00,360 [pool-264-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.purge.gap = 1000000 (custom)
2021-10-05 13:25:00,360 [pool-264-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2021-10-05 13:25:00,360 [pool-264-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.segment.size.max = 1048576 (custom)
2021-10-05 13:25:00,361 [EventQueue-OpenPipelineForHealthyPipelineSafeModeRule] INFO  safemode.SCMSafeModeManager (HealthyPipelineSafeModeRule.java:process(124)) - SCM in safe mode. Healthy pipelines reported count is 0, required healthy pipeline reported count is 1
2021-10-05 13:25:00,362 [pool-264-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.segment.cache.num.max = 2 (custom)
2021-10-05 13:25:00,362 [pool-264-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.segment.cache.size.max = 200MB (=209715200) (default)
2021-10-05 13:25:00,362 [pool-264-thread-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:<init>(182)) - new b668fbba-0931-4533-8c87-c6849aaa836f@group-9360A73A2ABC-SegmentedRaftLogWorker for RaftStorageImpl:Storage Directory /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-36b87918-66c6-4e2c-9c49-5aa8dab94a1f/datanode-0/data/ratis/1cc8aba1-0118-4460-9a8d-9360a73a2abc
2021-10-05 13:25:00,362 [pool-264-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2021-10-05 13:25:00,362 [pool-264-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.queue.element-limit = 1024 (custom)
2021-10-05 13:25:00,362 [pool-264-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.segment.size.max = 1048576 (custom)
2021-10-05 13:25:00,362 [pool-264-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.preallocated.size = 16384 (custom)
2021-10-05 13:25:00,362 [pool-264-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.force.sync.num = 128 (default)
2021-10-05 13:25:00,362 [EventQueue-OpenPipelineForHealthyPipelineSafeModeRule] INFO  safemode.SCMSafeModeManager (HealthyPipelineSafeModeRule.java:process(124)) - SCM in safe mode. Healthy pipelines reported count is 0, required healthy pipeline reported count is 1
2021-10-05 13:25:00,362 [pool-264-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.statemachine.data.sync = true (default)
2021-10-05 13:25:00,362 [pool-264-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2021-10-05 13:25:00,362 [pool-264-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2021-10-05 13:25:00,363 [pool-264-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.write.buffer.size = 1048576 (custom)
2021-10-05 13:25:00,364 [pool-264-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2021-10-05 13:25:00,364 [pool-264-thread-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:lambda$new$0(133)) - b668fbba-0931-4533-8c87-c6849aaa836f@group-9360A73A2ABC-SegmentedRaftLogWorker: flushIndex: setUnconditionally 0 -> -1
2021-10-05 13:25:00,364 [pool-264-thread-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:lambda$new$0(133)) - b668fbba-0931-4533-8c87-c6849aaa836f@group-9360A73A2ABC-SegmentedRaftLogWorker: safeCacheEvictIndex: setUnconditionally 0 -> -1
2021-10-05 13:25:00,376 [pool-264-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2021-10-05 13:25:00,376 [pool-264-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2021-10-05 13:25:00,376 [pool-264-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.snapshot.retention.file.num = 5 (custom)
2021-10-05 13:25:00,376 [pool-264-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.purge.upto.snapshot.index = false (default)
2021-10-05 13:25:00,376 [pool-264-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.retrycache.expirytime = 600000ms (custom)
2021-10-05 13:25:00,376 [pool-264-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.retrycache.statistics.expirytime = 100μs (default)
2021-10-05 13:25:00,377 [pool-264-thread-1] INFO  server.RaftServer$Division (RaftServerImpl.java:start(296)) - b668fbba-0931-4533-8c87-c6849aaa836f@group-9360A73A2ABC: start as a follower, conf=-1: [b668fbba-0931-4533-8c87-c6849aaa836f|rpc:127.0.0.1:40511|priority:0, 830d4653-8da7-4c59-a1a4-1cd595539218|rpc:127.0.0.1:42995|priority:0, 9cad18a2-4b78-4cb8-813e-2348ce620e43|rpc:127.0.0.1:34379|priority:1], old=null
2021-10-05 13:25:00,378 [pool-264-thread-1] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(285)) - b668fbba-0931-4533-8c87-c6849aaa836f@group-9360A73A2ABC: changes role from      null to FOLLOWER at term 0 for startAsFollower
2021-10-05 13:25:00,378 [pool-264-thread-1] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(130)) - b668fbba-0931-4533-8c87-c6849aaa836f: start b668fbba-0931-4533-8c87-c6849aaa836f@group-9360A73A2ABC-FollowerState
2021-10-05 13:25:00,391 [pool-264-thread-1] INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-9360A73A2ABC,id=b668fbba-0931-4533-8c87-c6849aaa836f
2021-10-05 13:25:00,396 [Command processor thread] INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:addGroup(763)) - Created group PipelineID=1cc8aba1-0118-4460-9a8d-9360a73a2abc
2021-10-05 13:25:00,402 [grpc-default-executor-2] INFO  server.RaftServer (RaftServerProxy.java:addNew(95)) - 830d4653-8da7-4c59-a1a4-1cd595539218: addNew group-9360A73A2ABC:[b668fbba-0931-4533-8c87-c6849aaa836f|rpc:127.0.0.1:40511|dataStream:|priority:0, 830d4653-8da7-4c59-a1a4-1cd595539218|rpc:127.0.0.1:42995|dataStream:|priority:0, 9cad18a2-4b78-4cb8-813e-2348ce620e43|rpc:127.0.0.1:34379|dataStream:|priority:1] returns group-9360A73A2ABC:java.util.concurrent.CompletableFuture@1742b25a[Not completed]
2021-10-05 13:25:00,403 [pool-285-thread-1] INFO  server.RaftServer$Division (RaftServerImpl.java:<init>(181)) - 830d4653-8da7-4c59-a1a4-1cd595539218: new RaftServerImpl for group-9360A73A2ABC:[b668fbba-0931-4533-8c87-c6849aaa836f|rpc:127.0.0.1:40511|dataStream:|priority:0, 830d4653-8da7-4c59-a1a4-1cd595539218|rpc:127.0.0.1:42995|dataStream:|priority:0, 9cad18a2-4b78-4cb8-813e-2348ce620e43|rpc:127.0.0.1:34379|dataStream:|priority:1] with ContainerStateMachine:uninitialized
2021-10-05 13:25:00,403 [pool-285-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.timeout.min = 5s (custom)
2021-10-05 13:25:00,403 [pool-285-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.timeout.max = 5200ms (custom)
2021-10-05 13:25:00,403 [pool-285-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.sleep.time = 25ms (default)
2021-10-05 13:25:00,403 [pool-285-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.slowness.timeout = 300s (custom)
2021-10-05 13:25:00,403 [pool-285-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.leaderelection.leader.step-down.wait-time = 10s (default)
2021-10-05 13:25:00,404 [pool-285-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.sleep.deviation.threshold = 300ms (default)
2021-10-05 13:25:00,404 [pool-285-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.appender.install.snapshot.enabled = false (custom)
2021-10-05 13:25:00,404 [pool-285-thread-1] INFO  server.RaftServer$Division (ServerState.java:<init>(105)) - 830d4653-8da7-4c59-a1a4-1cd595539218@group-9360A73A2ABC: ConfigurationManager, init=-1: [b668fbba-0931-4533-8c87-c6849aaa836f|rpc:127.0.0.1:40511|dataStream:|priority:0, 830d4653-8da7-4c59-a1a4-1cd595539218|rpc:127.0.0.1:42995|dataStream:|priority:0, 9cad18a2-4b78-4cb8-813e-2348ce620e43|rpc:127.0.0.1:34379|dataStream:|priority:1], old=null, confs=<EMPTY_MAP>
2021-10-05 13:25:00,404 [pool-285-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.storage.dir = [/home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-36b87918-66c6-4e2c-9c49-5aa8dab94a1f/datanode-1/data/ratis] (custom)
2021-10-05 13:25:00,404 [pool-285-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.corruption.policy = EXCEPTION (default)
2021-10-05 13:25:00,404 [pool-285-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.storage.free-space.min = 0MB (=0) (default)
2021-10-05 13:25:00,404 [pool-285-thread-1] INFO  storage.RaftStorageDirectory (RaftStorageDirectoryImpl.java:analyzeStorage(135)) - The storage directory /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-36b87918-66c6-4e2c-9c49-5aa8dab94a1f/datanode-1/data/ratis/1cc8aba1-0118-4460-9a8d-9360a73a2abc does not exist. Creating ...
2021-10-05 13:25:00,405 [pool-285-thread-1] INFO  storage.RaftStorageDirectory (RaftStorageDirectoryImpl.java:tryLock(230)) - Lock on /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-36b87918-66c6-4e2c-9c49-5aa8dab94a1f/datanode-1/data/ratis/1cc8aba1-0118-4460-9a8d-9360a73a2abc/in_use.lock acquired by nodename 17451@fv-az270-324
2021-10-05 13:25:00,409 [pool-285-thread-1] INFO  storage.RaftStorage (RaftStorageImpl.java:format(89)) - Storage directory /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-36b87918-66c6-4e2c-9c49-5aa8dab94a1f/datanode-1/data/ratis/1cc8aba1-0118-4460-9a8d-9360a73a2abc has been successfully formatted.
2021-10-05 13:25:00,410 [pool-285-thread-1] INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(224)) - group-9360A73A2ABC: The snapshot info is null. Setting the last applied indexto:(t:0, i:~)
2021-10-05 13:25:00,410 [pool-285-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.notification.no-leader.timeout = 300s (custom)
2021-10-05 13:25:00,410 [pool-285-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.use.memory = false (default)
2021-10-05 13:25:00,410 [pool-285-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.purge.gap = 1000000 (custom)
2021-10-05 13:25:00,410 [pool-285-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2021-10-05 13:25:00,410 [pool-285-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.segment.size.max = 1048576 (custom)
2021-10-05 13:25:00,411 [pool-285-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.segment.cache.num.max = 2 (custom)
2021-10-05 13:25:00,411 [pool-285-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.segment.cache.size.max = 200MB (=209715200) (default)
2021-10-05 13:25:00,411 [pool-285-thread-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:<init>(182)) - new 830d4653-8da7-4c59-a1a4-1cd595539218@group-9360A73A2ABC-SegmentedRaftLogWorker for RaftStorageImpl:Storage Directory /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-36b87918-66c6-4e2c-9c49-5aa8dab94a1f/datanode-1/data/ratis/1cc8aba1-0118-4460-9a8d-9360a73a2abc
2021-10-05 13:25:00,411 [pool-285-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2021-10-05 13:25:00,411 [pool-285-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.queue.element-limit = 1024 (custom)
2021-10-05 13:25:00,411 [pool-285-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.segment.size.max = 1048576 (custom)
2021-10-05 13:25:00,411 [pool-285-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.preallocated.size = 16384 (custom)
2021-10-05 13:25:00,411 [pool-285-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.force.sync.num = 128 (default)
2021-10-05 13:25:00,411 [pool-285-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.statemachine.data.sync = true (default)
2021-10-05 13:25:00,411 [pool-285-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2021-10-05 13:25:00,411 [pool-285-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2021-10-05 13:25:00,412 [pool-285-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.write.buffer.size = 1048576 (custom)
2021-10-05 13:25:00,412 [pool-285-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2021-10-05 13:25:00,412 [pool-285-thread-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:lambda$new$0(133)) - 830d4653-8da7-4c59-a1a4-1cd595539218@group-9360A73A2ABC-SegmentedRaftLogWorker: flushIndex: setUnconditionally 0 -> -1
2021-10-05 13:25:00,413 [pool-285-thread-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:lambda$new$0(133)) - 830d4653-8da7-4c59-a1a4-1cd595539218@group-9360A73A2ABC-SegmentedRaftLogWorker: safeCacheEvictIndex: setUnconditionally 0 -> -1
2021-10-05 13:25:00,423 [pool-285-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2021-10-05 13:25:00,423 [pool-285-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2021-10-05 13:25:00,423 [pool-285-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.snapshot.retention.file.num = 5 (custom)
2021-10-05 13:25:00,423 [pool-285-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.purge.upto.snapshot.index = false (default)
2021-10-05 13:25:00,424 [pool-285-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.retrycache.expirytime = 600000ms (custom)
2021-10-05 13:25:00,424 [pool-285-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.retrycache.statistics.expirytime = 100μs (default)
2021-10-05 13:25:00,425 [pool-285-thread-1] INFO  server.RaftServer$Division (RaftServerImpl.java:start(296)) - 830d4653-8da7-4c59-a1a4-1cd595539218@group-9360A73A2ABC: start as a follower, conf=-1: [b668fbba-0931-4533-8c87-c6849aaa836f|rpc:127.0.0.1:40511|dataStream:|priority:0, 830d4653-8da7-4c59-a1a4-1cd595539218|rpc:127.0.0.1:42995|dataStream:|priority:0, 9cad18a2-4b78-4cb8-813e-2348ce620e43|rpc:127.0.0.1:34379|dataStream:|priority:1], old=null
2021-10-05 13:25:00,425 [pool-285-thread-1] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(285)) - 830d4653-8da7-4c59-a1a4-1cd595539218@group-9360A73A2ABC: changes role from      null to FOLLOWER at term 0 for startAsFollower
2021-10-05 13:25:00,425 [pool-285-thread-1] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(130)) - 830d4653-8da7-4c59-a1a4-1cd595539218: start 830d4653-8da7-4c59-a1a4-1cd595539218@group-9360A73A2ABC-FollowerState
2021-10-05 13:25:00,427 [pool-285-thread-1] INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-9360A73A2ABC,id=830d4653-8da7-4c59-a1a4-1cd595539218
2021-10-05 13:25:00,448 [grpc-default-executor-2] INFO  server.RaftServer (RaftServerProxy.java:addNew(95)) - 9cad18a2-4b78-4cb8-813e-2348ce620e43: addNew group-9360A73A2ABC:[b668fbba-0931-4533-8c87-c6849aaa836f|rpc:127.0.0.1:40511|dataStream:|priority:0, 830d4653-8da7-4c59-a1a4-1cd595539218|rpc:127.0.0.1:42995|dataStream:|priority:0, 9cad18a2-4b78-4cb8-813e-2348ce620e43|rpc:127.0.0.1:34379|dataStream:|priority:1] returns group-9360A73A2ABC:java.util.concurrent.CompletableFuture@33707dc5[Not completed]
2021-10-05 13:25:00,449 [pool-306-thread-1] INFO  server.RaftServer$Division (RaftServerImpl.java:<init>(181)) - 9cad18a2-4b78-4cb8-813e-2348ce620e43: new RaftServerImpl for group-9360A73A2ABC:[b668fbba-0931-4533-8c87-c6849aaa836f|rpc:127.0.0.1:40511|dataStream:|priority:0, 830d4653-8da7-4c59-a1a4-1cd595539218|rpc:127.0.0.1:42995|dataStream:|priority:0, 9cad18a2-4b78-4cb8-813e-2348ce620e43|rpc:127.0.0.1:34379|dataStream:|priority:1] with ContainerStateMachine:uninitialized
2021-10-05 13:25:00,449 [pool-306-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.timeout.min = 5s (custom)
2021-10-05 13:25:00,449 [pool-306-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.timeout.max = 5200ms (custom)
2021-10-05 13:25:00,449 [pool-306-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.sleep.time = 25ms (default)
2021-10-05 13:25:00,449 [pool-306-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.slowness.timeout = 300s (custom)
2021-10-05 13:25:00,449 [pool-306-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.leaderelection.leader.step-down.wait-time = 10s (default)
2021-10-05 13:25:00,449 [pool-306-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.sleep.deviation.threshold = 300ms (default)
2021-10-05 13:25:00,449 [pool-306-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.appender.install.snapshot.enabled = false (custom)
2021-10-05 13:25:00,449 [pool-306-thread-1] INFO  server.RaftServer$Division (ServerState.java:<init>(105)) - 9cad18a2-4b78-4cb8-813e-2348ce620e43@group-9360A73A2ABC: ConfigurationManager, init=-1: [b668fbba-0931-4533-8c87-c6849aaa836f|rpc:127.0.0.1:40511|dataStream:|priority:0, 830d4653-8da7-4c59-a1a4-1cd595539218|rpc:127.0.0.1:42995|dataStream:|priority:0, 9cad18a2-4b78-4cb8-813e-2348ce620e43|rpc:127.0.0.1:34379|dataStream:|priority:1], old=null, confs=<EMPTY_MAP>
2021-10-05 13:25:00,449 [pool-306-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.storage.dir = [/home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-36b87918-66c6-4e2c-9c49-5aa8dab94a1f/datanode-2/data/ratis] (custom)
2021-10-05 13:25:00,450 [pool-306-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.corruption.policy = EXCEPTION (default)
2021-10-05 13:25:00,450 [pool-306-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.storage.free-space.min = 0MB (=0) (default)
2021-10-05 13:25:00,450 [pool-306-thread-1] INFO  storage.RaftStorageDirectory (RaftStorageDirectoryImpl.java:analyzeStorage(135)) - The storage directory /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-36b87918-66c6-4e2c-9c49-5aa8dab94a1f/datanode-2/data/ratis/1cc8aba1-0118-4460-9a8d-9360a73a2abc does not exist. Creating ...
2021-10-05 13:25:00,455 [pool-306-thread-1] INFO  storage.RaftStorageDirectory (RaftStorageDirectoryImpl.java:tryLock(230)) - Lock on /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-36b87918-66c6-4e2c-9c49-5aa8dab94a1f/datanode-2/data/ratis/1cc8aba1-0118-4460-9a8d-9360a73a2abc/in_use.lock acquired by nodename 17451@fv-az270-324
2021-10-05 13:25:00,456 [pool-306-thread-1] INFO  storage.RaftStorage (RaftStorageImpl.java:format(89)) - Storage directory /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-36b87918-66c6-4e2c-9c49-5aa8dab94a1f/datanode-2/data/ratis/1cc8aba1-0118-4460-9a8d-9360a73a2abc has been successfully formatted.
2021-10-05 13:25:00,456 [pool-306-thread-1] INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(224)) - group-9360A73A2ABC: The snapshot info is null. Setting the last applied indexto:(t:0, i:~)
2021-10-05 13:25:00,456 [pool-306-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.notification.no-leader.timeout = 300s (custom)
2021-10-05 13:25:00,457 [pool-306-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.use.memory = false (default)
2021-10-05 13:25:00,457 [pool-306-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.purge.gap = 1000000 (custom)
2021-10-05 13:25:00,457 [pool-306-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2021-10-05 13:25:00,457 [pool-306-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.segment.size.max = 1048576 (custom)
2021-10-05 13:25:00,457 [pool-306-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.segment.cache.num.max = 2 (custom)
2021-10-05 13:25:00,457 [pool-306-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.segment.cache.size.max = 200MB (=209715200) (default)
2021-10-05 13:25:00,457 [pool-306-thread-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:<init>(182)) - new 9cad18a2-4b78-4cb8-813e-2348ce620e43@group-9360A73A2ABC-SegmentedRaftLogWorker for RaftStorageImpl:Storage Directory /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-36b87918-66c6-4e2c-9c49-5aa8dab94a1f/datanode-2/data/ratis/1cc8aba1-0118-4460-9a8d-9360a73a2abc
2021-10-05 13:25:00,457 [pool-306-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2021-10-05 13:25:00,457 [pool-306-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.queue.element-limit = 1024 (custom)
2021-10-05 13:25:00,457 [pool-306-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.segment.size.max = 1048576 (custom)
2021-10-05 13:25:00,457 [pool-306-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.preallocated.size = 16384 (custom)
2021-10-05 13:25:00,458 [pool-306-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.force.sync.num = 128 (default)
2021-10-05 13:25:00,458 [pool-306-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.statemachine.data.sync = true (default)
2021-10-05 13:25:00,458 [pool-306-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2021-10-05 13:25:00,458 [pool-306-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2021-10-05 13:25:00,458 [pool-306-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.write.buffer.size = 1048576 (custom)
2021-10-05 13:25:00,460 [pool-306-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2021-10-05 13:25:00,460 [pool-306-thread-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:lambda$new$0(133)) - 9cad18a2-4b78-4cb8-813e-2348ce620e43@group-9360A73A2ABC-SegmentedRaftLogWorker: flushIndex: setUnconditionally 0 -> -1
2021-10-05 13:25:00,460 [pool-306-thread-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:lambda$new$0(133)) - 9cad18a2-4b78-4cb8-813e-2348ce620e43@group-9360A73A2ABC-SegmentedRaftLogWorker: safeCacheEvictIndex: setUnconditionally 0 -> -1
2021-10-05 13:25:00,470 [pool-306-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2021-10-05 13:25:00,470 [pool-306-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2021-10-05 13:25:00,470 [pool-306-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.snapshot.retention.file.num = 5 (custom)
2021-10-05 13:25:00,470 [pool-306-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.purge.upto.snapshot.index = false (default)
2021-10-05 13:25:00,470 [pool-306-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.retrycache.expirytime = 600000ms (custom)
2021-10-05 13:25:00,470 [pool-306-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.retrycache.statistics.expirytime = 100μs (default)
2021-10-05 13:25:00,473 [pool-306-thread-1] INFO  server.RaftServer$Division (RaftServerImpl.java:start(296)) - 9cad18a2-4b78-4cb8-813e-2348ce620e43@group-9360A73A2ABC: start as a follower, conf=-1: [b668fbba-0931-4533-8c87-c6849aaa836f|rpc:127.0.0.1:40511|dataStream:|priority:0, 830d4653-8da7-4c59-a1a4-1cd595539218|rpc:127.0.0.1:42995|dataStream:|priority:0, 9cad18a2-4b78-4cb8-813e-2348ce620e43|rpc:127.0.0.1:34379|dataStream:|priority:1], old=null
2021-10-05 13:25:00,473 [pool-306-thread-1] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(285)) - 9cad18a2-4b78-4cb8-813e-2348ce620e43@group-9360A73A2ABC: changes role from      null to FOLLOWER at term 0 for startAsFollower
2021-10-05 13:25:00,473 [pool-306-thread-1] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(130)) - 9cad18a2-4b78-4cb8-813e-2348ce620e43: start 9cad18a2-4b78-4cb8-813e-2348ce620e43@group-9360A73A2ABC-FollowerState
2021-10-05 13:25:00,484 [pool-306-thread-1] INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-9360A73A2ABC,id=9cad18a2-4b78-4cb8-813e-2348ce620e43
2021-10-05 13:25:00,491 [Command processor thread] INFO  commandhandler.CreatePipelineCommandHandler (CreatePipelineCommandHandler.java:handle(106)) - Created Pipeline RATIS THREE PipelineID=1cc8aba1-0118-4460-9a8d-9360a73a2abc.
2021-10-05 13:25:00,501 [Command processor thread] INFO  server.RaftServer (RaftServerProxy.java:addNew(95)) - 830d4653-8da7-4c59-a1a4-1cd595539218: addNew group-8307C7C0D048:[830d4653-8da7-4c59-a1a4-1cd595539218|rpc:127.0.0.1:42995|priority:1] returns group-8307C7C0D048:java.util.concurrent.CompletableFuture@4f3cff74[Not completed]
2021-10-05 13:25:00,502 [pool-285-thread-1] INFO  server.RaftServer$Division (RaftServerImpl.java:<init>(181)) - 830d4653-8da7-4c59-a1a4-1cd595539218: new RaftServerImpl for group-8307C7C0D048:[830d4653-8da7-4c59-a1a4-1cd595539218|rpc:127.0.0.1:42995|priority:1] with ContainerStateMachine:uninitialized
2021-10-05 13:25:00,502 [pool-285-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.timeout.min = 5s (custom)
2021-10-05 13:25:00,502 [pool-285-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.timeout.max = 5200ms (custom)
2021-10-05 13:25:00,502 [pool-285-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.sleep.time = 25ms (default)
2021-10-05 13:25:00,502 [pool-285-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.slowness.timeout = 300s (custom)
2021-10-05 13:25:00,502 [pool-285-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.leaderelection.leader.step-down.wait-time = 10s (default)
2021-10-05 13:25:00,502 [pool-285-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.sleep.deviation.threshold = 300ms (default)
2021-10-05 13:25:00,502 [pool-285-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.appender.install.snapshot.enabled = false (custom)
2021-10-05 13:25:00,502 [pool-285-thread-1] INFO  server.RaftServer$Division (ServerState.java:<init>(105)) - 830d4653-8da7-4c59-a1a4-1cd595539218@group-8307C7C0D048: ConfigurationManager, init=-1: [830d4653-8da7-4c59-a1a4-1cd595539218|rpc:127.0.0.1:42995|priority:1], old=null, confs=<EMPTY_MAP>
2021-10-05 13:25:00,502 [pool-285-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.storage.dir = [/home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-36b87918-66c6-4e2c-9c49-5aa8dab94a1f/datanode-1/data/ratis] (custom)
2021-10-05 13:25:00,502 [pool-285-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.corruption.policy = EXCEPTION (default)
2021-10-05 13:25:00,502 [pool-285-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.storage.free-space.min = 0MB (=0) (default)
2021-10-05 13:25:00,502 [pool-285-thread-1] INFO  storage.RaftStorageDirectory (RaftStorageDirectoryImpl.java:analyzeStorage(135)) - The storage directory /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-36b87918-66c6-4e2c-9c49-5aa8dab94a1f/datanode-1/data/ratis/41685362-6c68-4243-9411-8307c7c0d048 does not exist. Creating ...
2021-10-05 13:25:00,504 [pool-285-thread-1] INFO  storage.RaftStorageDirectory (RaftStorageDirectoryImpl.java:tryLock(230)) - Lock on /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-36b87918-66c6-4e2c-9c49-5aa8dab94a1f/datanode-1/data/ratis/41685362-6c68-4243-9411-8307c7c0d048/in_use.lock acquired by nodename 17451@fv-az270-324
2021-10-05 13:25:00,505 [pool-285-thread-1] INFO  storage.RaftStorage (RaftStorageImpl.java:format(89)) - Storage directory /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-36b87918-66c6-4e2c-9c49-5aa8dab94a1f/datanode-1/data/ratis/41685362-6c68-4243-9411-8307c7c0d048 has been successfully formatted.
2021-10-05 13:25:00,505 [pool-285-thread-1] INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(224)) - group-8307C7C0D048: The snapshot info is null. Setting the last applied indexto:(t:0, i:~)
2021-10-05 13:25:00,507 [EventQueue-PipelineReportForPipelineReportHandler] INFO  pipeline.PipelineManagerImpl (PipelineManagerImpl.java:openPipeline(282)) - Pipeline Pipeline[ Id: 41685362-6c68-4243-9411-8307c7c0d048, Nodes: 830d4653-8da7-4c59-a1a4-1cd595539218{ip: 127.0.0.1, host: localhost, ports: [REPLICATION=34867, RATIS=42995, RATIS_ADMIN=42995, RATIS_SERVER=42995, STANDALONE=44359], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}, ReplicationConfig: RATIS/ONE, State:ALLOCATED, leaderId:830d4653-8da7-4c59-a1a4-1cd595539218, CreationTimestamp2021-10-05T13:24:57.513Z[Etc/UTC]] moved to OPEN state
2021-10-05 13:25:00,507 [EventQueue-PipelineReportForPipelineReportHandler] INFO  ha.SCMHAInvocationHandler (SCMHAInvocationHandler.java:invokeRatis(113)) - Invoking method public abstract void org.apache.hadoop.hdds.scm.pipeline.PipelineStateManager.updatePipelineState(org.apache.hadoop.hdds.protocol.proto.HddsProtos$PipelineID,org.apache.hadoop.hdds.protocol.proto.HddsProtos$PipelineState) throws java.io.IOException on target org.apache.hadoop.hdds.scm.ha.SCMRatisServerImpl@7c75acaa, cost 286.228us
2021-10-05 13:25:00,508 [EventQueue-PipelineReportForPipelineReportHandler] INFO  pipeline.PipelineManagerImpl (PipelineManagerImpl.java:openPipeline(282)) - Pipeline Pipeline[ Id: 41685362-6c68-4243-9411-8307c7c0d048, Nodes: 830d4653-8da7-4c59-a1a4-1cd595539218{ip: 127.0.0.1, host: localhost, ports: [REPLICATION=34867, RATIS=42995, RATIS_ADMIN=42995, RATIS_SERVER=42995, STANDALONE=44359], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}, ReplicationConfig: RATIS/ONE, State:ALLOCATED, leaderId:830d4653-8da7-4c59-a1a4-1cd595539218, CreationTimestamp2021-10-05T13:24:57.513Z[Etc/UTC]] moved to OPEN state
2021-10-05 13:25:00,510 [pool-285-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.notification.no-leader.timeout = 300s (custom)
2021-10-05 13:25:00,510 [pool-285-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.use.memory = false (default)
2021-10-05 13:25:00,510 [pool-285-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.purge.gap = 1000000 (custom)
2021-10-05 13:25:00,510 [pool-285-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2021-10-05 13:25:00,510 [pool-285-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.segment.size.max = 1048576 (custom)
2021-10-05 13:25:00,510 [pool-285-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.segment.cache.num.max = 2 (custom)
2021-10-05 13:25:00,510 [pool-285-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.segment.cache.size.max = 200MB (=209715200) (default)
2021-10-05 13:25:00,510 [pool-285-thread-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:<init>(182)) - new 830d4653-8da7-4c59-a1a4-1cd595539218@group-8307C7C0D048-SegmentedRaftLogWorker for RaftStorageImpl:Storage Directory /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-36b87918-66c6-4e2c-9c49-5aa8dab94a1f/datanode-1/data/ratis/41685362-6c68-4243-9411-8307c7c0d048
2021-10-05 13:25:00,510 [pool-285-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2021-10-05 13:25:00,510 [pool-285-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.queue.element-limit = 1024 (custom)
2021-10-05 13:25:00,511 [pool-285-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.segment.size.max = 1048576 (custom)
2021-10-05 13:25:00,511 [pool-285-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.preallocated.size = 16384 (custom)
2021-10-05 13:25:00,511 [pool-285-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.force.sync.num = 128 (default)
2021-10-05 13:25:00,511 [pool-285-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.statemachine.data.sync = true (default)
2021-10-05 13:25:00,511 [pool-285-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2021-10-05 13:25:00,511 [pool-285-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2021-10-05 13:25:00,520 [pool-285-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.write.buffer.size = 1048576 (custom)
2021-10-05 13:25:00,521 [pool-285-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2021-10-05 13:25:00,521 [pool-285-thread-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:lambda$new$0(133)) - 830d4653-8da7-4c59-a1a4-1cd595539218@group-8307C7C0D048-SegmentedRaftLogWorker: flushIndex: setUnconditionally 0 -> -1
2021-10-05 13:25:00,521 [pool-285-thread-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:lambda$new$0(133)) - 830d4653-8da7-4c59-a1a4-1cd595539218@group-8307C7C0D048-SegmentedRaftLogWorker: safeCacheEvictIndex: setUnconditionally 0 -> -1
2021-10-05 13:25:00,521 [pool-285-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2021-10-05 13:25:00,522 [pool-285-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2021-10-05 13:25:00,522 [pool-285-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.snapshot.retention.file.num = 5 (custom)
2021-10-05 13:25:00,522 [pool-285-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.purge.upto.snapshot.index = false (default)
2021-10-05 13:25:00,522 [pool-285-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.retrycache.expirytime = 600000ms (custom)
2021-10-05 13:25:00,522 [pool-285-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.retrycache.statistics.expirytime = 100μs (default)
2021-10-05 13:25:00,523 [pool-285-thread-1] INFO  server.RaftServer$Division (RaftServerImpl.java:start(296)) - 830d4653-8da7-4c59-a1a4-1cd595539218@group-8307C7C0D048: start as a follower, conf=-1: [830d4653-8da7-4c59-a1a4-1cd595539218|rpc:127.0.0.1:42995|priority:1], old=null
2021-10-05 13:25:00,523 [pool-285-thread-1] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(285)) - 830d4653-8da7-4c59-a1a4-1cd595539218@group-8307C7C0D048: changes role from      null to FOLLOWER at term 0 for startAsFollower
2021-10-05 13:25:00,523 [pool-285-thread-1] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(130)) - 830d4653-8da7-4c59-a1a4-1cd595539218: start 830d4653-8da7-4c59-a1a4-1cd595539218@group-8307C7C0D048-FollowerState
2021-10-05 13:25:00,523 [21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F-StateMachineUpdater] INFO  safemode.HealthyPipelineSafeModeRule (HealthyPipelineSafeModeRule.java:initializeRule(152)) - Refreshed total pipeline count is 0, healthy pipeline threshold count is 1
2021-10-05 13:25:00,524 [EventQueue-PipelineReportForPipelineReportHandler] INFO  ha.SCMHAInvocationHandler (SCMHAInvocationHandler.java:invokeRatis(113)) - Invoking method public abstract void org.apache.hadoop.hdds.scm.pipeline.PipelineStateManager.updatePipelineState(org.apache.hadoop.hdds.protocol.proto.HddsProtos$PipelineID,org.apache.hadoop.hdds.protocol.proto.HddsProtos$PipelineState) throws java.io.IOException on target org.apache.hadoop.hdds.scm.ha.SCMRatisServerImpl@7efc167c, cost 15996.481us
2021-10-05 13:25:00,524 [EventQueue-OpenPipelineForHealthyPipelineSafeModeRule] INFO  safemode.SCMSafeModeManager (HealthyPipelineSafeModeRule.java:process(124)) - SCM in safe mode. Healthy pipelines reported count is 0, required healthy pipeline reported count is 1
2021-10-05 13:25:00,527 [pool-285-thread-1] INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-8307C7C0D048,id=830d4653-8da7-4c59-a1a4-1cd595539218
2021-10-05 13:25:00,536 [Command processor thread] INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:addGroup(763)) - Created group PipelineID=41685362-6c68-4243-9411-8307c7c0d048
2021-10-05 13:25:00,536 [Command processor thread] INFO  commandhandler.CreatePipelineCommandHandler (CreatePipelineCommandHandler.java:handle(106)) - Created Pipeline RATIS ONE PipelineID=41685362-6c68-4243-9411-8307c7c0d048.
2021-10-05 13:25:00,546 [6d234f4d-474a-4c74-a9e9-8f3885fce584@group-5AA8DAB94A1F-StateMachineUpdater] INFO  safemode.HealthyPipelineSafeModeRule (HealthyPipelineSafeModeRule.java:initializeRule(152)) - Refreshed total pipeline count is 0, healthy pipeline threshold count is 1
2021-10-05 13:25:00,546 [21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F-StateMachineUpdater] INFO  ha.SCMStateMachine (SCMStateMachine.java:takeSnapshot(290)) - Current Snapshot Index 20, takeSnapshot took 0 ms
2021-10-05 13:25:00,547 [21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:takeSnapshot(281)) - 21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F-StateMachineUpdater: Took a snapshot at index 20
2021-10-05 13:25:00,547 [21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:lambda$new$0(89)) - 21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F-StateMachineUpdater: snapshotIndex: updateIncreasingly 15 -> 20
2021-10-05 13:25:00,547 [21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:purge(306)) - 21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F-SegmentedRaftLog: purge 20
2021-10-05 13:25:00,547 [21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - 21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F-SegmentedRaftLog: snapshotIndex: updateIncreasingly 15 -> 20
2021-10-05 13:25:00,547 [21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - 21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F-SegmentedRaftLog: purgeIndex: updateToMax old=15, new=20, updated? true
2021-10-05 13:25:00,742 [EndpointStateMachine task thread for /127.0.0.1:15041 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15041. Already tried 7 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:00,747 [Listener at 127.0.0.1/13296] INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(235)) - Nodes are ready. Got 3 of 3 DN Heartbeats.
2021-10-05 13:25:00,747 [Listener at 127.0.0.1/13296] INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(238)) - Waiting for cluster to exit safe mode
2021-10-05 13:25:00,748 [Listener at 127.0.0.1/13296] INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(240)) - SCM became leader
2021-10-05 13:25:00,767 [Command processor thread] INFO  server.RaftServer (RaftServerProxy.java:addNew(95)) - 9cad18a2-4b78-4cb8-813e-2348ce620e43: addNew group-9BC7FBF74007:[9cad18a2-4b78-4cb8-813e-2348ce620e43|rpc:127.0.0.1:34379|priority:1] returns group-9BC7FBF74007:java.util.concurrent.CompletableFuture@785eaeea[Not completed]
2021-10-05 13:25:00,768 [pool-306-thread-1] INFO  server.RaftServer$Division (RaftServerImpl.java:<init>(181)) - 9cad18a2-4b78-4cb8-813e-2348ce620e43: new RaftServerImpl for group-9BC7FBF74007:[9cad18a2-4b78-4cb8-813e-2348ce620e43|rpc:127.0.0.1:34379|priority:1] with ContainerStateMachine:uninitialized
2021-10-05 13:25:00,768 [pool-306-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.timeout.min = 5s (custom)
2021-10-05 13:25:00,768 [pool-306-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.timeout.max = 5200ms (custom)
2021-10-05 13:25:00,768 [pool-306-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.sleep.time = 25ms (default)
2021-10-05 13:25:00,768 [pool-306-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.slowness.timeout = 300s (custom)
2021-10-05 13:25:00,768 [pool-306-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.leaderelection.leader.step-down.wait-time = 10s (default)
2021-10-05 13:25:00,768 [pool-306-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.sleep.deviation.threshold = 300ms (default)
2021-10-05 13:25:00,768 [pool-306-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.appender.install.snapshot.enabled = false (custom)
2021-10-05 13:25:00,768 [pool-306-thread-1] INFO  server.RaftServer$Division (ServerState.java:<init>(105)) - 9cad18a2-4b78-4cb8-813e-2348ce620e43@group-9BC7FBF74007: ConfigurationManager, init=-1: [9cad18a2-4b78-4cb8-813e-2348ce620e43|rpc:127.0.0.1:34379|priority:1], old=null, confs=<EMPTY_MAP>
2021-10-05 13:25:00,768 [pool-306-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.storage.dir = [/home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-36b87918-66c6-4e2c-9c49-5aa8dab94a1f/datanode-2/data/ratis] (custom)
2021-10-05 13:25:00,768 [pool-306-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.corruption.policy = EXCEPTION (default)
2021-10-05 13:25:00,768 [pool-306-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.storage.free-space.min = 0MB (=0) (default)
2021-10-05 13:25:00,768 [pool-306-thread-1] INFO  storage.RaftStorageDirectory (RaftStorageDirectoryImpl.java:analyzeStorage(135)) - The storage directory /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-36b87918-66c6-4e2c-9c49-5aa8dab94a1f/datanode-2/data/ratis/698a69f9-cff2-4881-8cc2-9bc7fbf74007 does not exist. Creating ...
2021-10-05 13:25:00,775 [pool-306-thread-1] INFO  storage.RaftStorageDirectory (RaftStorageDirectoryImpl.java:tryLock(230)) - Lock on /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-36b87918-66c6-4e2c-9c49-5aa8dab94a1f/datanode-2/data/ratis/698a69f9-cff2-4881-8cc2-9bc7fbf74007/in_use.lock acquired by nodename 17451@fv-az270-324
2021-10-05 13:25:00,779 [pool-306-thread-1] INFO  storage.RaftStorage (RaftStorageImpl.java:format(89)) - Storage directory /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-36b87918-66c6-4e2c-9c49-5aa8dab94a1f/datanode-2/data/ratis/698a69f9-cff2-4881-8cc2-9bc7fbf74007 has been successfully formatted.
2021-10-05 13:25:00,780 [pool-306-thread-1] INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(224)) - group-9BC7FBF74007: The snapshot info is null. Setting the last applied indexto:(t:0, i:~)
2021-10-05 13:25:00,781 [EventQueue-PipelineReportForPipelineReportHandler] INFO  pipeline.PipelineManagerImpl (PipelineManagerImpl.java:openPipeline(282)) - Pipeline Pipeline[ Id: 698a69f9-cff2-4881-8cc2-9bc7fbf74007, Nodes: 9cad18a2-4b78-4cb8-813e-2348ce620e43{ip: 127.0.0.1, host: localhost, ports: [REPLICATION=45905, RATIS=34379, RATIS_ADMIN=34379, RATIS_SERVER=34379, STANDALONE=41383], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}, ReplicationConfig: RATIS/ONE, State:ALLOCATED, leaderId:9cad18a2-4b78-4cb8-813e-2348ce620e43, CreationTimestamp2021-10-05T13:24:57.771Z[Etc/UTC]] moved to OPEN state
2021-10-05 13:25:00,781 [EventQueue-PipelineReportForPipelineReportHandler] INFO  ha.SCMHAInvocationHandler (SCMHAInvocationHandler.java:invokeRatis(113)) - Invoking method public abstract void org.apache.hadoop.hdds.scm.pipeline.PipelineStateManager.updatePipelineState(org.apache.hadoop.hdds.protocol.proto.HddsProtos$PipelineID,org.apache.hadoop.hdds.protocol.proto.HddsProtos$PipelineState) throws java.io.IOException on target org.apache.hadoop.hdds.scm.ha.SCMRatisServerImpl@7c75acaa, cost 214.721us
2021-10-05 13:25:00,781 [EventQueue-PipelineReportForPipelineReportHandler] INFO  pipeline.PipelineManagerImpl (PipelineManagerImpl.java:openPipeline(282)) - Pipeline Pipeline[ Id: 698a69f9-cff2-4881-8cc2-9bc7fbf74007, Nodes: 9cad18a2-4b78-4cb8-813e-2348ce620e43{ip: 127.0.0.1, host: localhost, ports: [REPLICATION=45905, RATIS=34379, RATIS_ADMIN=34379, RATIS_SERVER=34379, STANDALONE=41383], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}, ReplicationConfig: RATIS/ONE, State:ALLOCATED, leaderId:9cad18a2-4b78-4cb8-813e-2348ce620e43, CreationTimestamp2021-10-05T13:24:57.771Z[Etc/UTC]] moved to OPEN state
2021-10-05 13:25:00,783 [pool-306-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.notification.no-leader.timeout = 300s (custom)
2021-10-05 13:25:00,783 [pool-306-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.use.memory = false (default)
2021-10-05 13:25:00,783 [pool-306-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.purge.gap = 1000000 (custom)
2021-10-05 13:25:00,784 [pool-306-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2021-10-05 13:25:00,784 [pool-306-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.segment.size.max = 1048576 (custom)
2021-10-05 13:25:00,784 [pool-306-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.segment.cache.num.max = 2 (custom)
2021-10-05 13:25:00,784 [pool-306-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.segment.cache.size.max = 200MB (=209715200) (default)
2021-10-05 13:25:00,784 [pool-306-thread-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:<init>(182)) - new 9cad18a2-4b78-4cb8-813e-2348ce620e43@group-9BC7FBF74007-SegmentedRaftLogWorker for RaftStorageImpl:Storage Directory /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-36b87918-66c6-4e2c-9c49-5aa8dab94a1f/datanode-2/data/ratis/698a69f9-cff2-4881-8cc2-9bc7fbf74007
2021-10-05 13:25:00,784 [pool-306-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2021-10-05 13:25:00,784 [pool-306-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.queue.element-limit = 1024 (custom)
2021-10-05 13:25:00,784 [pool-306-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.segment.size.max = 1048576 (custom)
2021-10-05 13:25:00,784 [pool-306-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.preallocated.size = 16384 (custom)
2021-10-05 13:25:00,784 [pool-306-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.force.sync.num = 128 (default)
2021-10-05 13:25:00,784 [pool-306-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.statemachine.data.sync = true (default)
2021-10-05 13:25:00,785 [pool-306-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2021-10-05 13:25:00,785 [pool-306-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2021-10-05 13:25:00,787 [6d234f4d-474a-4c74-a9e9-8f3885fce584@group-5AA8DAB94A1F-StateMachineUpdater] INFO  ha.SCMStateMachine (SCMStateMachine.java:takeSnapshot(290)) - Current Snapshot Index 20, takeSnapshot took 0 ms
2021-10-05 13:25:00,787 [6d234f4d-474a-4c74-a9e9-8f3885fce584@group-5AA8DAB94A1F-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:takeSnapshot(281)) - 6d234f4d-474a-4c74-a9e9-8f3885fce584@group-5AA8DAB94A1F-StateMachineUpdater: Took a snapshot at index 20
2021-10-05 13:25:00,787 [6d234f4d-474a-4c74-a9e9-8f3885fce584@group-5AA8DAB94A1F-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:lambda$new$0(89)) - 6d234f4d-474a-4c74-a9e9-8f3885fce584@group-5AA8DAB94A1F-StateMachineUpdater: snapshotIndex: updateIncreasingly 15 -> 20
2021-10-05 13:25:00,788 [6d234f4d-474a-4c74-a9e9-8f3885fce584@group-5AA8DAB94A1F-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:purge(306)) - 6d234f4d-474a-4c74-a9e9-8f3885fce584@group-5AA8DAB94A1F-SegmentedRaftLog: purge 20
2021-10-05 13:25:00,788 [6d234f4d-474a-4c74-a9e9-8f3885fce584@group-5AA8DAB94A1F-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - 6d234f4d-474a-4c74-a9e9-8f3885fce584@group-5AA8DAB94A1F-SegmentedRaftLog: snapshotIndex: updateIncreasingly 15 -> 20
2021-10-05 13:25:00,788 [6d234f4d-474a-4c74-a9e9-8f3885fce584@group-5AA8DAB94A1F-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - 6d234f4d-474a-4c74-a9e9-8f3885fce584@group-5AA8DAB94A1F-SegmentedRaftLog: purgeIndex: updateToMax old=15, new=20, updated? true
2021-10-05 13:25:00,788 [pool-306-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.write.buffer.size = 1048576 (custom)
2021-10-05 13:25:00,788 [pool-306-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2021-10-05 13:25:00,789 [pool-306-thread-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:lambda$new$0(133)) - 9cad18a2-4b78-4cb8-813e-2348ce620e43@group-9BC7FBF74007-SegmentedRaftLogWorker: flushIndex: setUnconditionally 0 -> -1
2021-10-05 13:25:00,789 [pool-306-thread-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:lambda$new$0(133)) - 9cad18a2-4b78-4cb8-813e-2348ce620e43@group-9BC7FBF74007-SegmentedRaftLogWorker: safeCacheEvictIndex: setUnconditionally 0 -> -1
2021-10-05 13:25:00,789 [pool-306-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2021-10-05 13:25:00,791 [pool-306-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2021-10-05 13:25:00,791 [pool-306-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.snapshot.retention.file.num = 5 (custom)
2021-10-05 13:25:00,791 [pool-306-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.purge.upto.snapshot.index = false (default)
2021-10-05 13:25:00,791 [pool-306-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.retrycache.expirytime = 600000ms (custom)
2021-10-05 13:25:00,791 [pool-306-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.retrycache.statistics.expirytime = 100μs (default)
2021-10-05 13:25:00,790 [21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F-StateMachineUpdater] INFO  safemode.HealthyPipelineSafeModeRule (HealthyPipelineSafeModeRule.java:initializeRule(152)) - Refreshed total pipeline count is 0, healthy pipeline threshold count is 1
2021-10-05 13:25:00,791 [EventQueue-PipelineReportForPipelineReportHandler] INFO  ha.SCMHAInvocationHandler (SCMHAInvocationHandler.java:invokeRatis(113)) - Invoking method public abstract void org.apache.hadoop.hdds.scm.pipeline.PipelineStateManager.updatePipelineState(org.apache.hadoop.hdds.protocol.proto.HddsProtos$PipelineID,org.apache.hadoop.hdds.protocol.proto.HddsProtos$PipelineState) throws java.io.IOException on target org.apache.hadoop.hdds.scm.ha.SCMRatisServerImpl@7efc167c, cost 9871.876us
2021-10-05 13:25:00,792 [EventQueue-OpenPipelineForHealthyPipelineSafeModeRule] INFO  safemode.SCMSafeModeManager (HealthyPipelineSafeModeRule.java:process(124)) - SCM in safe mode. Healthy pipelines reported count is 0, required healthy pipeline reported count is 1
2021-10-05 13:25:00,793 [pool-306-thread-1] INFO  server.RaftServer$Division (RaftServerImpl.java:start(296)) - 9cad18a2-4b78-4cb8-813e-2348ce620e43@group-9BC7FBF74007: start as a follower, conf=-1: [9cad18a2-4b78-4cb8-813e-2348ce620e43|rpc:127.0.0.1:34379|priority:1], old=null
2021-10-05 13:25:00,793 [pool-306-thread-1] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(285)) - 9cad18a2-4b78-4cb8-813e-2348ce620e43@group-9BC7FBF74007: changes role from      null to FOLLOWER at term 0 for startAsFollower
2021-10-05 13:25:00,797 [EndpointStateMachine task thread for /127.0.0.1:15021 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15021. Already tried 11 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:00,799 [6d234f4d-474a-4c74-a9e9-8f3885fce584@group-5AA8DAB94A1F-StateMachineUpdater] INFO  safemode.HealthyPipelineSafeModeRule (HealthyPipelineSafeModeRule.java:initializeRule(152)) - Refreshed total pipeline count is 0, healthy pipeline threshold count is 1
2021-10-05 13:25:00,800 [pool-306-thread-1] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(130)) - 9cad18a2-4b78-4cb8-813e-2348ce620e43: start 9cad18a2-4b78-4cb8-813e-2348ce620e43@group-9BC7FBF74007-FollowerState
2021-10-05 13:25:00,800 [pool-306-thread-1] INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-9BC7FBF74007,id=9cad18a2-4b78-4cb8-813e-2348ce620e43
2021-10-05 13:25:00,803 [Command processor thread] INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:addGroup(763)) - Created group PipelineID=698a69f9-cff2-4881-8cc2-9bc7fbf74007
2021-10-05 13:25:00,803 [Command processor thread] INFO  commandhandler.CreatePipelineCommandHandler (CreatePipelineCommandHandler.java:handle(106)) - Created Pipeline RATIS ONE PipelineID=698a69f9-cff2-4881-8cc2-9bc7fbf74007.
2021-10-05 13:25:00,804 [EndpointStateMachine task thread for /127.0.0.1:15031 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15031. Already tried 11 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:01,742 [EndpointStateMachine task thread for /127.0.0.1:15041 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15041. Already tried 8 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:01,748 [Listener at 127.0.0.1/13296] INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(235)) - Nodes are ready. Got 3 of 3 DN Heartbeats.
2021-10-05 13:25:01,748 [Listener at 127.0.0.1/13296] INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(238)) - Waiting for cluster to exit safe mode
2021-10-05 13:25:01,748 [Listener at 127.0.0.1/13296] INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(240)) - SCM became leader
2021-10-05 13:25:01,798 [EndpointStateMachine task thread for /127.0.0.1:15021 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15021. Already tried 12 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:01,804 [EndpointStateMachine task thread for /127.0.0.1:15031 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15031. Already tried 12 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:02,360 [Datanode State Machine Thread - 0] ERROR datanode.RunningDatanodeState (RunningDatanodeState.java:computeNextContainerState(199)) - Error in executing end point task.
java.util.concurrent.ExecutionException: java.util.concurrent.TimeoutException
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.hadoop.ozone.container.common.states.datanode.RunningDatanodeState.computeNextContainerState(RunningDatanodeState.java:191)
	at org.apache.hadoop.ozone.container.common.states.datanode.RunningDatanodeState.await(RunningDatanodeState.java:231)
	at org.apache.hadoop.ozone.container.common.states.datanode.RunningDatanodeState.await(RunningDatanodeState.java:50)
	at org.apache.hadoop.ozone.container.common.statemachine.StateContext.execute(StateContext.java:629)
	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.start(DatanodeStateMachine.java:270)
	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.lambda$startDaemon$0(DatanodeStateMachine.java:457)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.util.concurrent.TimeoutException
	at java.util.concurrent.FutureTask.get(FutureTask.java:205)
	at org.apache.hadoop.ozone.container.common.states.datanode.RunningDatanodeState.lambda$execute$0(RunningDatanodeState.java:149)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
2021-10-05 13:25:02,743 [EndpointStateMachine task thread for /127.0.0.1:15041 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15041. Already tried 9 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:02,748 [Listener at 127.0.0.1/13296] INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(235)) - Nodes are ready. Got 3 of 3 DN Heartbeats.
2021-10-05 13:25:02,749 [Listener at 127.0.0.1/13296] INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(238)) - Waiting for cluster to exit safe mode
2021-10-05 13:25:02,749 [Listener at 127.0.0.1/13296] INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(240)) - SCM became leader
2021-10-05 13:25:02,798 [EndpointStateMachine task thread for /127.0.0.1:15021 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15021. Already tried 13 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:02,804 [EndpointStateMachine task thread for /127.0.0.1:15031 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15031. Already tried 13 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:03,743 [EndpointStateMachine task thread for /127.0.0.1:15041 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15041. Already tried 10 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:03,749 [Listener at 127.0.0.1/13296] INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(235)) - Nodes are ready. Got 3 of 3 DN Heartbeats.
2021-10-05 13:25:03,749 [Listener at 127.0.0.1/13296] INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(238)) - Waiting for cluster to exit safe mode
2021-10-05 13:25:03,749 [Listener at 127.0.0.1/13296] INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(240)) - SCM became leader
2021-10-05 13:25:03,799 [EndpointStateMachine task thread for /127.0.0.1:15021 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15021. Already tried 14 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:03,805 [EndpointStateMachine task thread for /127.0.0.1:15031 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15031. Already tried 14 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:04,369 [Datanode State Machine Thread - 0] ERROR datanode.RunningDatanodeState (RunningDatanodeState.java:computeNextContainerState(199)) - Error in executing end point task.
java.util.concurrent.ExecutionException: java.util.concurrent.TimeoutException
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.hadoop.ozone.container.common.states.datanode.RunningDatanodeState.computeNextContainerState(RunningDatanodeState.java:191)
	at org.apache.hadoop.ozone.container.common.states.datanode.RunningDatanodeState.await(RunningDatanodeState.java:231)
	at org.apache.hadoop.ozone.container.common.states.datanode.RunningDatanodeState.await(RunningDatanodeState.java:50)
	at org.apache.hadoop.ozone.container.common.statemachine.StateContext.execute(StateContext.java:629)
	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.start(DatanodeStateMachine.java:270)
	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.lambda$startDaemon$0(DatanodeStateMachine.java:457)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.util.concurrent.TimeoutException
	at java.util.concurrent.FutureTask.get(FutureTask.java:205)
	at org.apache.hadoop.ozone.container.common.states.datanode.RunningDatanodeState.lambda$execute$0(RunningDatanodeState.java:149)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
2021-10-05 13:25:04,744 [EndpointStateMachine task thread for /127.0.0.1:15041 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15041. Already tried 11 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:04,750 [Listener at 127.0.0.1/13296] INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(235)) - Nodes are ready. Got 3 of 3 DN Heartbeats.
2021-10-05 13:25:04,750 [Listener at 127.0.0.1/13296] INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(238)) - Waiting for cluster to exit safe mode
2021-10-05 13:25:04,750 [Listener at 127.0.0.1/13296] INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(240)) - SCM became leader
2021-10-05 13:25:04,780 [Datanode State Machine Thread - 0] ERROR datanode.RunningDatanodeState (RunningDatanodeState.java:computeNextContainerState(199)) - Error in executing end point task.
java.util.concurrent.ExecutionException: java.util.concurrent.TimeoutException
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.hadoop.ozone.container.common.states.datanode.RunningDatanodeState.computeNextContainerState(RunningDatanodeState.java:191)
	at org.apache.hadoop.ozone.container.common.states.datanode.RunningDatanodeState.await(RunningDatanodeState.java:231)
	at org.apache.hadoop.ozone.container.common.states.datanode.RunningDatanodeState.await(RunningDatanodeState.java:50)
	at org.apache.hadoop.ozone.container.common.statemachine.StateContext.execute(StateContext.java:629)
	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.start(DatanodeStateMachine.java:270)
	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.lambda$startDaemon$0(DatanodeStateMachine.java:457)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.util.concurrent.TimeoutException
	at java.util.concurrent.FutureTask.get(FutureTask.java:205)
	at org.apache.hadoop.ozone.container.common.states.datanode.RunningDatanodeState.lambda$execute$0(RunningDatanodeState.java:149)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
2021-10-05 13:25:04,800 [EndpointStateMachine task thread for /127.0.0.1:15021 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15021. Already tried 0 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:04,805 [EndpointStateMachine task thread for /127.0.0.1:15031 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15031. Already tried 0 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:05,152 [b668fbba-0931-4533-8c87-c6849aaa836f@group-16677137C488-FollowerState] INFO  impl.FollowerState (FollowerState.java:run(134)) - b668fbba-0931-4533-8c87-c6849aaa836f@group-16677137C488-FollowerState: change to CANDIDATE, lastRpcElapsedTime:5035395179ns, electionTimeout:5005ms
2021-10-05 13:25:05,153 [b668fbba-0931-4533-8c87-c6849aaa836f@group-16677137C488-FollowerState] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(108)) - b668fbba-0931-4533-8c87-c6849aaa836f: shutdown b668fbba-0931-4533-8c87-c6849aaa836f@group-16677137C488-FollowerState
2021-10-05 13:25:05,153 [b668fbba-0931-4533-8c87-c6849aaa836f@group-16677137C488-FollowerState] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(285)) - b668fbba-0931-4533-8c87-c6849aaa836f@group-16677137C488: changes role from  FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2021-10-05 13:25:05,153 [b668fbba-0931-4533-8c87-c6849aaa836f@group-16677137C488-FollowerState] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.leaderelection.pre-vote = false (custom)
2021-10-05 13:25:05,153 [b668fbba-0931-4533-8c87-c6849aaa836f@group-16677137C488-FollowerState] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(130)) - b668fbba-0931-4533-8c87-c6849aaa836f: start b668fbba-0931-4533-8c87-c6849aaa836f@group-16677137C488-LeaderElection17
2021-10-05 13:25:05,166 [b668fbba-0931-4533-8c87-c6849aaa836f@group-16677137C488-LeaderElection17] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(306)) - b668fbba-0931-4533-8c87-c6849aaa836f@group-16677137C488-LeaderElection17 ELECTION round 0: submit vote requests at term 1 for -1: [b668fbba-0931-4533-8c87-c6849aaa836f|rpc:127.0.0.1:40511|priority:1], old=null
2021-10-05 13:25:05,166 [b668fbba-0931-4533-8c87-c6849aaa836f@group-16677137C488-LeaderElection17] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(308)) - b668fbba-0931-4533-8c87-c6849aaa836f@group-16677137C488-LeaderElection17 ELECTION round 0: result PASSED (term=1)
2021-10-05 13:25:05,166 [b668fbba-0931-4533-8c87-c6849aaa836f@group-16677137C488-LeaderElection17] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(121)) - b668fbba-0931-4533-8c87-c6849aaa836f: shutdown b668fbba-0931-4533-8c87-c6849aaa836f@group-16677137C488-LeaderElection17
2021-10-05 13:25:05,166 [b668fbba-0931-4533-8c87-c6849aaa836f@group-16677137C488-LeaderElection17] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(285)) - b668fbba-0931-4533-8c87-c6849aaa836f@group-16677137C488: changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2021-10-05 13:25:05,166 [b668fbba-0931-4533-8c87-c6849aaa836f@group-16677137C488-LeaderElection17] INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:handleLeaderChangedNotification(861)) - Leader change notification received for group: group-16677137C488 with new leaderId: b668fbba-0931-4533-8c87-c6849aaa836f
2021-10-05 13:25:05,167 [b668fbba-0931-4533-8c87-c6849aaa836f@group-16677137C488-LeaderElection17] INFO  server.RaftServer$Division (ServerState.java:setLeader(285)) - b668fbba-0931-4533-8c87-c6849aaa836f@group-16677137C488: change Leader from null to b668fbba-0931-4533-8c87-c6849aaa836f at term 1 for becomeLeader, leader elected after 5127ms
2021-10-05 13:25:05,167 [b668fbba-0931-4533-8c87-c6849aaa836f@group-16677137C488-LeaderElection17] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.staging.catchup.gap = 1000 (default)
2021-10-05 13:25:05,168 [EventQueue-OpenPipelineForHealthyPipelineSafeModeRule] INFO  safemode.SCMSafeModeManager (HealthyPipelineSafeModeRule.java:process(124)) - SCM in safe mode. Healthy pipelines reported count is 0, required healthy pipeline reported count is 1
2021-10-05 13:25:05,169 [b668fbba-0931-4533-8c87-c6849aaa836f@group-16677137C488-LeaderElection17] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.write.element-limit = 1024 (custom)
2021-10-05 13:25:05,169 [EventQueue-OpenPipelineForHealthyPipelineSafeModeRule] INFO  safemode.SCMSafeModeManager (HealthyPipelineSafeModeRule.java:process(124)) - SCM in safe mode. Healthy pipelines reported count is 0, required healthy pipeline reported count is 1
2021-10-05 13:25:05,169 [b668fbba-0931-4533-8c87-c6849aaa836f@group-16677137C488-LeaderElection17] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.write.byte-limit = 1024 M (=1073741824) (custom)
2021-10-05 13:25:05,169 [b668fbba-0931-4533-8c87-c6849aaa836f@group-16677137C488-LeaderElection17] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.watch.timeout = 180s (custom)
2021-10-05 13:25:05,169 [b668fbba-0931-4533-8c87-c6849aaa836f@group-16677137C488-LeaderElection17] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.watch.timeout.denomination = 1s (default)
2021-10-05 13:25:05,169 [b668fbba-0931-4533-8c87-c6849aaa836f@group-16677137C488-LeaderElection17] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.watch.element-limit = 65536 (default)
2021-10-05 13:25:05,170 [b668fbba-0931-4533-8c87-c6849aaa836f@group-16677137C488-LeaderElection17] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(130)) - b668fbba-0931-4533-8c87-c6849aaa836f: start b668fbba-0931-4533-8c87-c6849aaa836f@group-16677137C488-LeaderStateImpl
2021-10-05 13:25:05,170 [b668fbba-0931-4533-8c87-c6849aaa836f@group-16677137C488-LeaderElection17] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:startLogSegment(394)) - b668fbba-0931-4533-8c87-c6849aaa836f@group-16677137C488-SegmentedRaftLogWorker: Starting segment from index:0
2021-10-05 13:25:05,171 [b668fbba-0931-4533-8c87-c6849aaa836f@group-16677137C488-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(601)) - b668fbba-0931-4533-8c87-c6849aaa836f@group-16677137C488-SegmentedRaftLogWorker: created new log segment /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-36b87918-66c6-4e2c-9c49-5aa8dab94a1f/datanode-0/data/ratis/fb43a933-1c8b-4815-9314-16677137c488/current/log_inprogress_0
2021-10-05 13:25:05,181 [b668fbba-0931-4533-8c87-c6849aaa836f@group-16677137C488-LeaderElection17] INFO  server.RaftServer$Division (ServerState.java:setRaftConf(387)) - b668fbba-0931-4533-8c87-c6849aaa836f@group-16677137C488: set configuration 0: [b668fbba-0931-4533-8c87-c6849aaa836f|rpc:127.0.0.1:40511|dataStream:|priority:1], old=null
2021-10-05 13:25:05,280 [9cad18a2-4b78-4cb8-813e-2348ce620e43@group-62F8E1A01D1D-FollowerState] INFO  impl.FollowerState (FollowerState.java:run(134)) - 9cad18a2-4b78-4cb8-813e-2348ce620e43@group-62F8E1A01D1D-FollowerState: change to CANDIDATE, lastRpcElapsedTime:5037014110ns, electionTimeout:5017ms
2021-10-05 13:25:05,280 [9cad18a2-4b78-4cb8-813e-2348ce620e43@group-62F8E1A01D1D-FollowerState] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(108)) - 9cad18a2-4b78-4cb8-813e-2348ce620e43: shutdown 9cad18a2-4b78-4cb8-813e-2348ce620e43@group-62F8E1A01D1D-FollowerState
2021-10-05 13:25:05,280 [9cad18a2-4b78-4cb8-813e-2348ce620e43@group-62F8E1A01D1D-FollowerState] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(285)) - 9cad18a2-4b78-4cb8-813e-2348ce620e43@group-62F8E1A01D1D: changes role from  FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2021-10-05 13:25:05,280 [9cad18a2-4b78-4cb8-813e-2348ce620e43@group-62F8E1A01D1D-FollowerState] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.leaderelection.pre-vote = false (custom)
2021-10-05 13:25:05,280 [9cad18a2-4b78-4cb8-813e-2348ce620e43@group-62F8E1A01D1D-FollowerState] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(130)) - 9cad18a2-4b78-4cb8-813e-2348ce620e43: start 9cad18a2-4b78-4cb8-813e-2348ce620e43@group-62F8E1A01D1D-LeaderElection18
2021-10-05 13:25:05,294 [9cad18a2-4b78-4cb8-813e-2348ce620e43@group-62F8E1A01D1D-LeaderElection18] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(306)) - 9cad18a2-4b78-4cb8-813e-2348ce620e43@group-62F8E1A01D1D-LeaderElection18 ELECTION round 0: submit vote requests at term 1 for -1: [b668fbba-0931-4533-8c87-c6849aaa836f|rpc:127.0.0.1:40511|dataStream:|priority:1, 830d4653-8da7-4c59-a1a4-1cd595539218|rpc:127.0.0.1:42995|dataStream:|priority:0, 9cad18a2-4b78-4cb8-813e-2348ce620e43|rpc:127.0.0.1:34379|dataStream:|priority:0], old=null
2021-10-05 13:25:05,312 [grpc-default-executor-2] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1043)) - b668fbba-0931-4533-8c87-c6849aaa836f@group-62F8E1A01D1D: receive requestVote(ELECTION, 9cad18a2-4b78-4cb8-813e-2348ce620e43, group-62F8E1A01D1D, 1, (t:0, i:0))
2021-10-05 13:25:05,312 [grpc-default-executor-2] INFO  impl.VoteContext (VoteContext.java:log(48)) - b668fbba-0931-4533-8c87-c6849aaa836f@group-62F8E1A01D1D-FOLLOWER: reject ELECTION from 9cad18a2-4b78-4cb8-813e-2348ce620e43: our priority 1 > candidate's priority 0
2021-10-05 13:25:05,312 [grpc-default-executor-2] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(285)) - b668fbba-0931-4533-8c87-c6849aaa836f@group-62F8E1A01D1D: changes role from  FOLLOWER to FOLLOWER at term 1 for candidate:9cad18a2-4b78-4cb8-813e-2348ce620e43
2021-10-05 13:25:05,312 [grpc-default-executor-2] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(108)) - b668fbba-0931-4533-8c87-c6849aaa836f: shutdown b668fbba-0931-4533-8c87-c6849aaa836f@group-62F8E1A01D1D-FollowerState
2021-10-05 13:25:05,319 [grpc-default-executor-2] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(130)) - b668fbba-0931-4533-8c87-c6849aaa836f: start b668fbba-0931-4533-8c87-c6849aaa836f@group-62F8E1A01D1D-FollowerState
2021-10-05 13:25:05,319 [b668fbba-0931-4533-8c87-c6849aaa836f@group-62F8E1A01D1D-FollowerState] INFO  impl.FollowerState (FollowerState.java:run(143)) - b668fbba-0931-4533-8c87-c6849aaa836f@group-62F8E1A01D1D-FollowerState was interrupted: {}
java.lang.InterruptedException: sleep interrupted
	at java.lang.Thread.sleep(Native Method)
	at java.lang.Thread.sleep(Thread.java:340)
	at java.util.concurrent.TimeUnit.sleep(TimeUnit.java:386)
	at org.apache.ratis.util.TimeDuration.sleep(TimeDuration.java:324)
	at org.apache.ratis.util.TimeDuration.sleep(TimeDuration.java:309)
	at org.apache.ratis.server.impl.FollowerState.run(FollowerState.java:118)
2021-10-05 13:25:05,326 [grpc-default-executor-2] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1075)) - b668fbba-0931-4533-8c87-c6849aaa836f@group-62F8E1A01D1D replies to ELECTION vote request: 9cad18a2-4b78-4cb8-813e-2348ce620e43<-b668fbba-0931-4533-8c87-c6849aaa836f#0:FAIL-t1. Peer's state: b668fbba-0931-4533-8c87-c6849aaa836f@group-62F8E1A01D1D:t1, leader=null, voted=null, raftlog=b668fbba-0931-4533-8c87-c6849aaa836f@group-62F8E1A01D1D-SegmentedRaftLog:OPENED:c-1,f-1,i0, conf=-1: [b668fbba-0931-4533-8c87-c6849aaa836f|rpc:127.0.0.1:40511|priority:1, 830d4653-8da7-4c59-a1a4-1cd595539218|rpc:127.0.0.1:42995|priority:0, 9cad18a2-4b78-4cb8-813e-2348ce620e43|rpc:127.0.0.1:34379|priority:0], old=null
2021-10-05 13:25:05,327 [9cad18a2-4b78-4cb8-813e-2348ce620e43@group-62F8E1A01D1D-LeaderElection18] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(89)) - 9cad18a2-4b78-4cb8-813e-2348ce620e43@group-62F8E1A01D1D-LeaderElection18: ELECTION REJECTED received 1 response(s) and 0 exception(s):
2021-10-05 13:25:05,327 [9cad18a2-4b78-4cb8-813e-2348ce620e43@group-62F8E1A01D1D-LeaderElection18] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(93)) -   Response 0: 9cad18a2-4b78-4cb8-813e-2348ce620e43<-b668fbba-0931-4533-8c87-c6849aaa836f#0:FAIL-t1
2021-10-05 13:25:05,327 [9cad18a2-4b78-4cb8-813e-2348ce620e43@group-62F8E1A01D1D-LeaderElection18] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(308)) - 9cad18a2-4b78-4cb8-813e-2348ce620e43@group-62F8E1A01D1D-LeaderElection18 ELECTION round 0: result REJECTED
2021-10-05 13:25:05,327 [9cad18a2-4b78-4cb8-813e-2348ce620e43@group-62F8E1A01D1D-LeaderElection18] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(285)) - 9cad18a2-4b78-4cb8-813e-2348ce620e43@group-62F8E1A01D1D: changes role from CANDIDATE to FOLLOWER at term 1 for REJECTED
2021-10-05 13:25:05,327 [9cad18a2-4b78-4cb8-813e-2348ce620e43@group-62F8E1A01D1D-LeaderElection18] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(121)) - 9cad18a2-4b78-4cb8-813e-2348ce620e43: shutdown 9cad18a2-4b78-4cb8-813e-2348ce620e43@group-62F8E1A01D1D-LeaderElection18
2021-10-05 13:25:05,327 [9cad18a2-4b78-4cb8-813e-2348ce620e43@group-62F8E1A01D1D-LeaderElection18] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(130)) - 9cad18a2-4b78-4cb8-813e-2348ce620e43: start 9cad18a2-4b78-4cb8-813e-2348ce620e43@group-62F8E1A01D1D-FollowerState
2021-10-05 13:25:05,346 [grpc-default-executor-0] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1043)) - 830d4653-8da7-4c59-a1a4-1cd595539218@group-62F8E1A01D1D: receive requestVote(ELECTION, 9cad18a2-4b78-4cb8-813e-2348ce620e43, group-62F8E1A01D1D, 1, (t:0, i:0))
2021-10-05 13:25:05,346 [grpc-default-executor-0] INFO  impl.VoteContext (VoteContext.java:log(48)) - 830d4653-8da7-4c59-a1a4-1cd595539218@group-62F8E1A01D1D-FOLLOWER: accept ELECTION from 9cad18a2-4b78-4cb8-813e-2348ce620e43: our priority 0 <= candidate's priority 0
2021-10-05 13:25:05,346 [grpc-default-executor-0] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(285)) - 830d4653-8da7-4c59-a1a4-1cd595539218@group-62F8E1A01D1D: changes role from  FOLLOWER to FOLLOWER at term 1 for candidate:9cad18a2-4b78-4cb8-813e-2348ce620e43
2021-10-05 13:25:05,346 [grpc-default-executor-0] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(108)) - 830d4653-8da7-4c59-a1a4-1cd595539218: shutdown 830d4653-8da7-4c59-a1a4-1cd595539218@group-62F8E1A01D1D-FollowerState
2021-10-05 13:25:05,346 [grpc-default-executor-0] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(130)) - 830d4653-8da7-4c59-a1a4-1cd595539218: start 830d4653-8da7-4c59-a1a4-1cd595539218@group-62F8E1A01D1D-FollowerState
2021-10-05 13:25:05,349 [830d4653-8da7-4c59-a1a4-1cd595539218@group-62F8E1A01D1D-FollowerState] INFO  impl.FollowerState (FollowerState.java:run(143)) - 830d4653-8da7-4c59-a1a4-1cd595539218@group-62F8E1A01D1D-FollowerState was interrupted: {}
java.lang.InterruptedException: sleep interrupted
	at java.lang.Thread.sleep(Native Method)
	at java.lang.Thread.sleep(Thread.java:340)
	at java.util.concurrent.TimeUnit.sleep(TimeUnit.java:386)
	at org.apache.ratis.util.TimeDuration.sleep(TimeDuration.java:324)
	at org.apache.ratis.util.TimeDuration.sleep(TimeDuration.java:309)
	at org.apache.ratis.server.impl.FollowerState.run(FollowerState.java:118)
2021-10-05 13:25:05,352 [grpc-default-executor-0] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1075)) - 830d4653-8da7-4c59-a1a4-1cd595539218@group-62F8E1A01D1D replies to ELECTION vote request: 9cad18a2-4b78-4cb8-813e-2348ce620e43<-830d4653-8da7-4c59-a1a4-1cd595539218#0:OK-t1. Peer's state: 830d4653-8da7-4c59-a1a4-1cd595539218@group-62F8E1A01D1D:t1, leader=null, voted=9cad18a2-4b78-4cb8-813e-2348ce620e43, raftlog=830d4653-8da7-4c59-a1a4-1cd595539218@group-62F8E1A01D1D-SegmentedRaftLog:OPENED:c-1,f-1,i0, conf=-1: [b668fbba-0931-4533-8c87-c6849aaa836f|rpc:127.0.0.1:40511|dataStream:|priority:1, 830d4653-8da7-4c59-a1a4-1cd595539218|rpc:127.0.0.1:42995|dataStream:|priority:0, 9cad18a2-4b78-4cb8-813e-2348ce620e43|rpc:127.0.0.1:34379|dataStream:|priority:0], old=null
2021-10-05 13:25:05,406 [b668fbba-0931-4533-8c87-c6849aaa836f@group-9360A73A2ABC-FollowerState] INFO  impl.FollowerState (FollowerState.java:run(134)) - b668fbba-0931-4533-8c87-c6849aaa836f@group-9360A73A2ABC-FollowerState: change to CANDIDATE, lastRpcElapsedTime:5028636054ns, electionTimeout:5015ms
2021-10-05 13:25:05,406 [b668fbba-0931-4533-8c87-c6849aaa836f@group-9360A73A2ABC-FollowerState] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(108)) - b668fbba-0931-4533-8c87-c6849aaa836f: shutdown b668fbba-0931-4533-8c87-c6849aaa836f@group-9360A73A2ABC-FollowerState
2021-10-05 13:25:05,406 [b668fbba-0931-4533-8c87-c6849aaa836f@group-9360A73A2ABC-FollowerState] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(285)) - b668fbba-0931-4533-8c87-c6849aaa836f@group-9360A73A2ABC: changes role from  FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2021-10-05 13:25:05,407 [b668fbba-0931-4533-8c87-c6849aaa836f@group-9360A73A2ABC-FollowerState] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.leaderelection.pre-vote = false (custom)
2021-10-05 13:25:05,407 [b668fbba-0931-4533-8c87-c6849aaa836f@group-9360A73A2ABC-FollowerState] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(130)) - b668fbba-0931-4533-8c87-c6849aaa836f: start b668fbba-0931-4533-8c87-c6849aaa836f@group-9360A73A2ABC-LeaderElection19
2021-10-05 13:25:05,423 [b668fbba-0931-4533-8c87-c6849aaa836f@group-9360A73A2ABC-LeaderElection19] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(306)) - b668fbba-0931-4533-8c87-c6849aaa836f@group-9360A73A2ABC-LeaderElection19 ELECTION round 0: submit vote requests at term 1 for -1: [b668fbba-0931-4533-8c87-c6849aaa836f|rpc:127.0.0.1:40511|priority:0, 830d4653-8da7-4c59-a1a4-1cd595539218|rpc:127.0.0.1:42995|priority:0, 9cad18a2-4b78-4cb8-813e-2348ce620e43|rpc:127.0.0.1:34379|priority:1], old=null
2021-10-05 13:25:05,435 [grpc-default-executor-0] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1043)) - 830d4653-8da7-4c59-a1a4-1cd595539218@group-9360A73A2ABC: receive requestVote(ELECTION, b668fbba-0931-4533-8c87-c6849aaa836f, group-9360A73A2ABC, 1, (t:0, i:0))
2021-10-05 13:25:05,435 [grpc-default-executor-0] INFO  impl.VoteContext (VoteContext.java:log(48)) - 830d4653-8da7-4c59-a1a4-1cd595539218@group-9360A73A2ABC-FOLLOWER: accept ELECTION from b668fbba-0931-4533-8c87-c6849aaa836f: our priority 0 <= candidate's priority 0
2021-10-05 13:25:05,435 [grpc-default-executor-0] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(285)) - 830d4653-8da7-4c59-a1a4-1cd595539218@group-9360A73A2ABC: changes role from  FOLLOWER to FOLLOWER at term 1 for candidate:b668fbba-0931-4533-8c87-c6849aaa836f
2021-10-05 13:25:05,435 [grpc-default-executor-0] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(108)) - 830d4653-8da7-4c59-a1a4-1cd595539218: shutdown 830d4653-8da7-4c59-a1a4-1cd595539218@group-9360A73A2ABC-FollowerState
2021-10-05 13:25:05,435 [grpc-default-executor-0] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(130)) - 830d4653-8da7-4c59-a1a4-1cd595539218: start 830d4653-8da7-4c59-a1a4-1cd595539218@group-9360A73A2ABC-FollowerState
2021-10-05 13:25:05,435 [830d4653-8da7-4c59-a1a4-1cd595539218@group-9360A73A2ABC-FollowerState] INFO  impl.FollowerState (FollowerState.java:run(143)) - 830d4653-8da7-4c59-a1a4-1cd595539218@group-9360A73A2ABC-FollowerState was interrupted: {}
java.lang.InterruptedException: sleep interrupted
	at java.lang.Thread.sleep(Native Method)
	at java.lang.Thread.sleep(Thread.java:340)
	at java.util.concurrent.TimeUnit.sleep(TimeUnit.java:386)
	at org.apache.ratis.util.TimeDuration.sleep(TimeDuration.java:324)
	at org.apache.ratis.util.TimeDuration.sleep(TimeDuration.java:309)
	at org.apache.ratis.server.impl.FollowerState.run(FollowerState.java:118)
2021-10-05 13:25:05,440 [grpc-default-executor-0] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1075)) - 830d4653-8da7-4c59-a1a4-1cd595539218@group-9360A73A2ABC replies to ELECTION vote request: b668fbba-0931-4533-8c87-c6849aaa836f<-830d4653-8da7-4c59-a1a4-1cd595539218#0:OK-t1. Peer's state: 830d4653-8da7-4c59-a1a4-1cd595539218@group-9360A73A2ABC:t1, leader=null, voted=b668fbba-0931-4533-8c87-c6849aaa836f, raftlog=830d4653-8da7-4c59-a1a4-1cd595539218@group-9360A73A2ABC-SegmentedRaftLog:OPENED:c-1,f-1,i0, conf=-1: [b668fbba-0931-4533-8c87-c6849aaa836f|rpc:127.0.0.1:40511|dataStream:|priority:0, 830d4653-8da7-4c59-a1a4-1cd595539218|rpc:127.0.0.1:42995|dataStream:|priority:0, 9cad18a2-4b78-4cb8-813e-2348ce620e43|rpc:127.0.0.1:34379|dataStream:|priority:1], old=null
2021-10-05 13:25:05,444 [grpc-default-executor-0] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1043)) - 9cad18a2-4b78-4cb8-813e-2348ce620e43@group-9360A73A2ABC: receive requestVote(ELECTION, b668fbba-0931-4533-8c87-c6849aaa836f, group-9360A73A2ABC, 1, (t:0, i:0))
2021-10-05 13:25:05,444 [grpc-default-executor-0] INFO  impl.VoteContext (VoteContext.java:log(48)) - 9cad18a2-4b78-4cb8-813e-2348ce620e43@group-9360A73A2ABC-FOLLOWER: reject ELECTION from b668fbba-0931-4533-8c87-c6849aaa836f: our priority 1 > candidate's priority 0
2021-10-05 13:25:05,444 [grpc-default-executor-0] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(285)) - 9cad18a2-4b78-4cb8-813e-2348ce620e43@group-9360A73A2ABC: changes role from  FOLLOWER to FOLLOWER at term 1 for candidate:b668fbba-0931-4533-8c87-c6849aaa836f
2021-10-05 13:25:05,444 [grpc-default-executor-0] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(108)) - 9cad18a2-4b78-4cb8-813e-2348ce620e43: shutdown 9cad18a2-4b78-4cb8-813e-2348ce620e43@group-9360A73A2ABC-FollowerState
2021-10-05 13:25:05,444 [grpc-default-executor-0] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(130)) - 9cad18a2-4b78-4cb8-813e-2348ce620e43: start 9cad18a2-4b78-4cb8-813e-2348ce620e43@group-9360A73A2ABC-FollowerState
2021-10-05 13:25:05,445 [9cad18a2-4b78-4cb8-813e-2348ce620e43@group-9360A73A2ABC-FollowerState] INFO  impl.FollowerState (FollowerState.java:run(143)) - 9cad18a2-4b78-4cb8-813e-2348ce620e43@group-9360A73A2ABC-FollowerState was interrupted: {}
java.lang.InterruptedException: sleep interrupted
	at java.lang.Thread.sleep(Native Method)
	at java.lang.Thread.sleep(Thread.java:340)
	at java.util.concurrent.TimeUnit.sleep(TimeUnit.java:386)
	at org.apache.ratis.util.TimeDuration.sleep(TimeDuration.java:324)
	at org.apache.ratis.util.TimeDuration.sleep(TimeDuration.java:309)
	at org.apache.ratis.server.impl.FollowerState.run(FollowerState.java:118)
2021-10-05 13:25:05,455 [grpc-default-executor-0] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1075)) - 9cad18a2-4b78-4cb8-813e-2348ce620e43@group-9360A73A2ABC replies to ELECTION vote request: b668fbba-0931-4533-8c87-c6849aaa836f<-9cad18a2-4b78-4cb8-813e-2348ce620e43#0:FAIL-t1. Peer's state: 9cad18a2-4b78-4cb8-813e-2348ce620e43@group-9360A73A2ABC:t1, leader=null, voted=null, raftlog=9cad18a2-4b78-4cb8-813e-2348ce620e43@group-9360A73A2ABC-SegmentedRaftLog:OPENED:c-1,f-1,i0, conf=-1: [b668fbba-0931-4533-8c87-c6849aaa836f|rpc:127.0.0.1:40511|dataStream:|priority:0, 830d4653-8da7-4c59-a1a4-1cd595539218|rpc:127.0.0.1:42995|dataStream:|priority:0, 9cad18a2-4b78-4cb8-813e-2348ce620e43|rpc:127.0.0.1:34379|dataStream:|priority:1], old=null
2021-10-05 13:25:05,464 [b668fbba-0931-4533-8c87-c6849aaa836f@group-9360A73A2ABC-LeaderElection19] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(89)) - b668fbba-0931-4533-8c87-c6849aaa836f@group-9360A73A2ABC-LeaderElection19: ELECTION REJECTED received 2 response(s) and 0 exception(s):
2021-10-05 13:25:05,464 [b668fbba-0931-4533-8c87-c6849aaa836f@group-9360A73A2ABC-LeaderElection19] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(93)) -   Response 0: b668fbba-0931-4533-8c87-c6849aaa836f<-830d4653-8da7-4c59-a1a4-1cd595539218#0:OK-t1
2021-10-05 13:25:05,464 [b668fbba-0931-4533-8c87-c6849aaa836f@group-9360A73A2ABC-LeaderElection19] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(93)) -   Response 1: b668fbba-0931-4533-8c87-c6849aaa836f<-9cad18a2-4b78-4cb8-813e-2348ce620e43#0:FAIL-t1
2021-10-05 13:25:05,464 [b668fbba-0931-4533-8c87-c6849aaa836f@group-9360A73A2ABC-LeaderElection19] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(308)) - b668fbba-0931-4533-8c87-c6849aaa836f@group-9360A73A2ABC-LeaderElection19 ELECTION round 0: result REJECTED
2021-10-05 13:25:05,464 [b668fbba-0931-4533-8c87-c6849aaa836f@group-9360A73A2ABC-LeaderElection19] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(285)) - b668fbba-0931-4533-8c87-c6849aaa836f@group-9360A73A2ABC: changes role from CANDIDATE to FOLLOWER at term 1 for REJECTED
2021-10-05 13:25:05,464 [b668fbba-0931-4533-8c87-c6849aaa836f@group-9360A73A2ABC-LeaderElection19] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(121)) - b668fbba-0931-4533-8c87-c6849aaa836f: shutdown b668fbba-0931-4533-8c87-c6849aaa836f@group-9360A73A2ABC-LeaderElection19
2021-10-05 13:25:05,464 [b668fbba-0931-4533-8c87-c6849aaa836f@group-9360A73A2ABC-LeaderElection19] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(130)) - b668fbba-0931-4533-8c87-c6849aaa836f: start b668fbba-0931-4533-8c87-c6849aaa836f@group-9360A73A2ABC-FollowerState
2021-10-05 13:25:05,719 [830d4653-8da7-4c59-a1a4-1cd595539218@group-8307C7C0D048-FollowerState] INFO  impl.FollowerState (FollowerState.java:run(134)) - 830d4653-8da7-4c59-a1a4-1cd595539218@group-8307C7C0D048-FollowerState: change to CANDIDATE, lastRpcElapsedTime:5196103943ns, electionTimeout:5191ms
2021-10-05 13:25:05,719 [830d4653-8da7-4c59-a1a4-1cd595539218@group-8307C7C0D048-FollowerState] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(108)) - 830d4653-8da7-4c59-a1a4-1cd595539218: shutdown 830d4653-8da7-4c59-a1a4-1cd595539218@group-8307C7C0D048-FollowerState
2021-10-05 13:25:05,719 [830d4653-8da7-4c59-a1a4-1cd595539218@group-8307C7C0D048-FollowerState] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(285)) - 830d4653-8da7-4c59-a1a4-1cd595539218@group-8307C7C0D048: changes role from  FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2021-10-05 13:25:05,721 [830d4653-8da7-4c59-a1a4-1cd595539218@group-8307C7C0D048-FollowerState] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.leaderelection.pre-vote = false (custom)
2021-10-05 13:25:05,721 [830d4653-8da7-4c59-a1a4-1cd595539218@group-8307C7C0D048-FollowerState] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(130)) - 830d4653-8da7-4c59-a1a4-1cd595539218: start 830d4653-8da7-4c59-a1a4-1cd595539218@group-8307C7C0D048-LeaderElection20
2021-10-05 13:25:05,736 [830d4653-8da7-4c59-a1a4-1cd595539218@group-8307C7C0D048-LeaderElection20] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(306)) - 830d4653-8da7-4c59-a1a4-1cd595539218@group-8307C7C0D048-LeaderElection20 ELECTION round 0: submit vote requests at term 1 for -1: [830d4653-8da7-4c59-a1a4-1cd595539218|rpc:127.0.0.1:42995|priority:1], old=null
2021-10-05 13:25:05,736 [830d4653-8da7-4c59-a1a4-1cd595539218@group-8307C7C0D048-LeaderElection20] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(308)) - 830d4653-8da7-4c59-a1a4-1cd595539218@group-8307C7C0D048-LeaderElection20 ELECTION round 0: result PASSED (term=1)
2021-10-05 13:25:05,736 [830d4653-8da7-4c59-a1a4-1cd595539218@group-8307C7C0D048-LeaderElection20] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(121)) - 830d4653-8da7-4c59-a1a4-1cd595539218: shutdown 830d4653-8da7-4c59-a1a4-1cd595539218@group-8307C7C0D048-LeaderElection20
2021-10-05 13:25:05,736 [830d4653-8da7-4c59-a1a4-1cd595539218@group-8307C7C0D048-LeaderElection20] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(285)) - 830d4653-8da7-4c59-a1a4-1cd595539218@group-8307C7C0D048: changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2021-10-05 13:25:05,736 [830d4653-8da7-4c59-a1a4-1cd595539218@group-8307C7C0D048-LeaderElection20] INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:handleLeaderChangedNotification(861)) - Leader change notification received for group: group-8307C7C0D048 with new leaderId: 830d4653-8da7-4c59-a1a4-1cd595539218
2021-10-05 13:25:05,736 [830d4653-8da7-4c59-a1a4-1cd595539218@group-8307C7C0D048-LeaderElection20] INFO  server.RaftServer$Division (ServerState.java:setLeader(285)) - 830d4653-8da7-4c59-a1a4-1cd595539218@group-8307C7C0D048: change Leader from null to 830d4653-8da7-4c59-a1a4-1cd595539218 at term 1 for becomeLeader, leader elected after 5226ms
2021-10-05 13:25:05,736 [830d4653-8da7-4c59-a1a4-1cd595539218@group-8307C7C0D048-LeaderElection20] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.staging.catchup.gap = 1000 (default)
2021-10-05 13:25:05,740 [EventQueue-OpenPipelineForHealthyPipelineSafeModeRule] INFO  safemode.SCMSafeModeManager (HealthyPipelineSafeModeRule.java:process(124)) - SCM in safe mode. Healthy pipelines reported count is 0, required healthy pipeline reported count is 1
2021-10-05 13:25:05,740 [EventQueue-OpenPipelineForHealthyPipelineSafeModeRule] INFO  safemode.SCMSafeModeManager (HealthyPipelineSafeModeRule.java:process(124)) - SCM in safe mode. Healthy pipelines reported count is 0, required healthy pipeline reported count is 1
2021-10-05 13:25:05,743 [830d4653-8da7-4c59-a1a4-1cd595539218@group-8307C7C0D048-LeaderElection20] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.write.element-limit = 1024 (custom)
2021-10-05 13:25:05,743 [830d4653-8da7-4c59-a1a4-1cd595539218@group-8307C7C0D048-LeaderElection20] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.write.byte-limit = 1024 M (=1073741824) (custom)
2021-10-05 13:25:05,743 [830d4653-8da7-4c59-a1a4-1cd595539218@group-8307C7C0D048-LeaderElection20] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.watch.timeout = 180s (custom)
2021-10-05 13:25:05,743 [830d4653-8da7-4c59-a1a4-1cd595539218@group-8307C7C0D048-LeaderElection20] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.watch.timeout.denomination = 1s (default)
2021-10-05 13:25:05,743 [830d4653-8da7-4c59-a1a4-1cd595539218@group-8307C7C0D048-LeaderElection20] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.watch.element-limit = 65536 (default)
2021-10-05 13:25:05,743 [830d4653-8da7-4c59-a1a4-1cd595539218@group-8307C7C0D048-LeaderElection20] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(130)) - 830d4653-8da7-4c59-a1a4-1cd595539218: start 830d4653-8da7-4c59-a1a4-1cd595539218@group-8307C7C0D048-LeaderStateImpl
2021-10-05 13:25:05,743 [830d4653-8da7-4c59-a1a4-1cd595539218@group-8307C7C0D048-LeaderElection20] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:startLogSegment(394)) - 830d4653-8da7-4c59-a1a4-1cd595539218@group-8307C7C0D048-SegmentedRaftLogWorker: Starting segment from index:0
2021-10-05 13:25:05,745 [EndpointStateMachine task thread for /127.0.0.1:15041 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15041. Already tried 12 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:05,751 [830d4653-8da7-4c59-a1a4-1cd595539218@group-8307C7C0D048-LeaderElection20] INFO  server.RaftServer$Division (ServerState.java:setRaftConf(387)) - 830d4653-8da7-4c59-a1a4-1cd595539218@group-8307C7C0D048: set configuration 0: [830d4653-8da7-4c59-a1a4-1cd595539218|rpc:127.0.0.1:42995|dataStream:|priority:1], old=null
2021-10-05 13:25:05,755 [830d4653-8da7-4c59-a1a4-1cd595539218@group-8307C7C0D048-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(601)) - 830d4653-8da7-4c59-a1a4-1cd595539218@group-8307C7C0D048-SegmentedRaftLogWorker: created new log segment /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-36b87918-66c6-4e2c-9c49-5aa8dab94a1f/datanode-1/data/ratis/41685362-6c68-4243-9411-8307c7c0d048/current/log_inprogress_0
2021-10-05 13:25:05,756 [Listener at 127.0.0.1/13296] INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(235)) - Nodes are ready. Got 3 of 3 DN Heartbeats.
2021-10-05 13:25:05,756 [Listener at 127.0.0.1/13296] INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(238)) - Waiting for cluster to exit safe mode
2021-10-05 13:25:05,756 [Listener at 127.0.0.1/13296] INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(240)) - SCM became leader
2021-10-05 13:25:05,800 [EndpointStateMachine task thread for /127.0.0.1:15021 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15021. Already tried 1 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:05,806 [EndpointStateMachine task thread for /127.0.0.1:15031 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15031. Already tried 1 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:05,866 [9cad18a2-4b78-4cb8-813e-2348ce620e43@group-9BC7FBF74007-FollowerState] INFO  impl.FollowerState (FollowerState.java:run(134)) - 9cad18a2-4b78-4cb8-813e-2348ce620e43@group-9BC7FBF74007-FollowerState: change to CANDIDATE, lastRpcElapsedTime:5065875735ns, electionTimeout:5065ms
2021-10-05 13:25:05,866 [9cad18a2-4b78-4cb8-813e-2348ce620e43@group-9BC7FBF74007-FollowerState] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(108)) - 9cad18a2-4b78-4cb8-813e-2348ce620e43: shutdown 9cad18a2-4b78-4cb8-813e-2348ce620e43@group-9BC7FBF74007-FollowerState
2021-10-05 13:25:05,866 [9cad18a2-4b78-4cb8-813e-2348ce620e43@group-9BC7FBF74007-FollowerState] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(285)) - 9cad18a2-4b78-4cb8-813e-2348ce620e43@group-9BC7FBF74007: changes role from  FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2021-10-05 13:25:05,866 [9cad18a2-4b78-4cb8-813e-2348ce620e43@group-9BC7FBF74007-FollowerState] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.leaderelection.pre-vote = false (custom)
2021-10-05 13:25:05,866 [9cad18a2-4b78-4cb8-813e-2348ce620e43@group-9BC7FBF74007-FollowerState] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(130)) - 9cad18a2-4b78-4cb8-813e-2348ce620e43: start 9cad18a2-4b78-4cb8-813e-2348ce620e43@group-9BC7FBF74007-LeaderElection21
2021-10-05 13:25:05,878 [9cad18a2-4b78-4cb8-813e-2348ce620e43@group-9BC7FBF74007-LeaderElection21] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(306)) - 9cad18a2-4b78-4cb8-813e-2348ce620e43@group-9BC7FBF74007-LeaderElection21 ELECTION round 0: submit vote requests at term 1 for -1: [9cad18a2-4b78-4cb8-813e-2348ce620e43|rpc:127.0.0.1:34379|priority:1], old=null
2021-10-05 13:25:05,878 [9cad18a2-4b78-4cb8-813e-2348ce620e43@group-9BC7FBF74007-LeaderElection21] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(308)) - 9cad18a2-4b78-4cb8-813e-2348ce620e43@group-9BC7FBF74007-LeaderElection21 ELECTION round 0: result PASSED (term=1)
2021-10-05 13:25:05,878 [9cad18a2-4b78-4cb8-813e-2348ce620e43@group-9BC7FBF74007-LeaderElection21] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(121)) - 9cad18a2-4b78-4cb8-813e-2348ce620e43: shutdown 9cad18a2-4b78-4cb8-813e-2348ce620e43@group-9BC7FBF74007-LeaderElection21
2021-10-05 13:25:05,878 [9cad18a2-4b78-4cb8-813e-2348ce620e43@group-9BC7FBF74007-LeaderElection21] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(285)) - 9cad18a2-4b78-4cb8-813e-2348ce620e43@group-9BC7FBF74007: changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2021-10-05 13:25:05,878 [9cad18a2-4b78-4cb8-813e-2348ce620e43@group-9BC7FBF74007-LeaderElection21] INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:handleLeaderChangedNotification(861)) - Leader change notification received for group: group-9BC7FBF74007 with new leaderId: 9cad18a2-4b78-4cb8-813e-2348ce620e43
2021-10-05 13:25:05,879 [9cad18a2-4b78-4cb8-813e-2348ce620e43@group-9BC7FBF74007-LeaderElection21] INFO  server.RaftServer$Division (ServerState.java:setLeader(285)) - 9cad18a2-4b78-4cb8-813e-2348ce620e43@group-9BC7FBF74007: change Leader from null to 9cad18a2-4b78-4cb8-813e-2348ce620e43 at term 1 for becomeLeader, leader elected after 5095ms
2021-10-05 13:25:05,879 [9cad18a2-4b78-4cb8-813e-2348ce620e43@group-9BC7FBF74007-LeaderElection21] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.staging.catchup.gap = 1000 (default)
2021-10-05 13:25:05,880 [9cad18a2-4b78-4cb8-813e-2348ce620e43@group-9BC7FBF74007-LeaderElection21] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.write.element-limit = 1024 (custom)
2021-10-05 13:25:05,880 [9cad18a2-4b78-4cb8-813e-2348ce620e43@group-9BC7FBF74007-LeaderElection21] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.write.byte-limit = 1024 M (=1073741824) (custom)
2021-10-05 13:25:05,880 [9cad18a2-4b78-4cb8-813e-2348ce620e43@group-9BC7FBF74007-LeaderElection21] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.watch.timeout = 180s (custom)
2021-10-05 13:25:05,880 [9cad18a2-4b78-4cb8-813e-2348ce620e43@group-9BC7FBF74007-LeaderElection21] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.watch.timeout.denomination = 1s (default)
2021-10-05 13:25:05,880 [9cad18a2-4b78-4cb8-813e-2348ce620e43@group-9BC7FBF74007-LeaderElection21] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.watch.element-limit = 65536 (default)
2021-10-05 13:25:05,880 [9cad18a2-4b78-4cb8-813e-2348ce620e43@group-9BC7FBF74007-LeaderElection21] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(130)) - 9cad18a2-4b78-4cb8-813e-2348ce620e43: start 9cad18a2-4b78-4cb8-813e-2348ce620e43@group-9BC7FBF74007-LeaderStateImpl
2021-10-05 13:25:05,881 [9cad18a2-4b78-4cb8-813e-2348ce620e43@group-9BC7FBF74007-LeaderElection21] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:startLogSegment(394)) - 9cad18a2-4b78-4cb8-813e-2348ce620e43@group-9BC7FBF74007-SegmentedRaftLogWorker: Starting segment from index:0
2021-10-05 13:25:05,885 [9cad18a2-4b78-4cb8-813e-2348ce620e43@group-9BC7FBF74007-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(601)) - 9cad18a2-4b78-4cb8-813e-2348ce620e43@group-9BC7FBF74007-SegmentedRaftLogWorker: created new log segment /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-36b87918-66c6-4e2c-9c49-5aa8dab94a1f/datanode-2/data/ratis/698a69f9-cff2-4881-8cc2-9bc7fbf74007/current/log_inprogress_0
2021-10-05 13:25:05,894 [9cad18a2-4b78-4cb8-813e-2348ce620e43@group-9BC7FBF74007-LeaderElection21] INFO  server.RaftServer$Division (ServerState.java:setRaftConf(387)) - 9cad18a2-4b78-4cb8-813e-2348ce620e43@group-9BC7FBF74007: set configuration 0: [9cad18a2-4b78-4cb8-813e-2348ce620e43|rpc:127.0.0.1:34379|dataStream:|priority:1], old=null
2021-10-05 13:25:05,896 [EventQueue-OpenPipelineForHealthyPipelineSafeModeRule] INFO  safemode.SCMSafeModeManager (HealthyPipelineSafeModeRule.java:process(124)) - SCM in safe mode. Healthy pipelines reported count is 0, required healthy pipeline reported count is 1
2021-10-05 13:25:05,901 [EventQueue-OpenPipelineForHealthyPipelineSafeModeRule] INFO  safemode.SCMSafeModeManager (HealthyPipelineSafeModeRule.java:process(124)) - SCM in safe mode. Healthy pipelines reported count is 0, required healthy pipeline reported count is 1
2021-10-05 13:25:06,745 [EndpointStateMachine task thread for /127.0.0.1:15041 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15041. Already tried 13 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:06,756 [Listener at 127.0.0.1/13296] INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(235)) - Nodes are ready. Got 3 of 3 DN Heartbeats.
2021-10-05 13:25:06,756 [Listener at 127.0.0.1/13296] INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(238)) - Waiting for cluster to exit safe mode
2021-10-05 13:25:06,756 [Listener at 127.0.0.1/13296] INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(240)) - SCM became leader
2021-10-05 13:25:06,801 [EndpointStateMachine task thread for /127.0.0.1:15021 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15021. Already tried 2 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:06,807 [EndpointStateMachine task thread for /127.0.0.1:15031 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15031. Already tried 2 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:07,167 [Datanode State Machine Thread - 0] ERROR datanode.RunningDatanodeState (RunningDatanodeState.java:computeNextContainerState(199)) - Error in executing end point task.
java.util.concurrent.ExecutionException: java.util.concurrent.TimeoutException
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.hadoop.ozone.container.common.states.datanode.RunningDatanodeState.computeNextContainerState(RunningDatanodeState.java:191)
	at org.apache.hadoop.ozone.container.common.states.datanode.RunningDatanodeState.await(RunningDatanodeState.java:231)
	at org.apache.hadoop.ozone.container.common.states.datanode.RunningDatanodeState.await(RunningDatanodeState.java:50)
	at org.apache.hadoop.ozone.container.common.statemachine.StateContext.execute(StateContext.java:629)
	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.start(DatanodeStateMachine.java:270)
	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.lambda$startDaemon$0(DatanodeStateMachine.java:457)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.util.concurrent.TimeoutException
	at java.util.concurrent.FutureTask.get(FutureTask.java:205)
	at org.apache.hadoop.ozone.container.common.states.datanode.RunningDatanodeState.lambda$execute$0(RunningDatanodeState.java:149)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
2021-10-05 13:25:07,746 [EndpointStateMachine task thread for /127.0.0.1:15041 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15041. Already tried 14 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:07,757 [Listener at 127.0.0.1/13296] INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(235)) - Nodes are ready. Got 3 of 3 DN Heartbeats.
2021-10-05 13:25:07,757 [Listener at 127.0.0.1/13296] INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(238)) - Waiting for cluster to exit safe mode
2021-10-05 13:25:07,757 [Listener at 127.0.0.1/13296] INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(240)) - SCM became leader
2021-10-05 13:25:07,801 [EndpointStateMachine task thread for /127.0.0.1:15021 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15021. Already tried 3 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:07,807 [EndpointStateMachine task thread for /127.0.0.1:15031 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15031. Already tried 3 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:08,746 [EndpointStateMachine task thread for /127.0.0.1:15041 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15041. Already tried 0 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:08,757 [Listener at 127.0.0.1/13296] INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(235)) - Nodes are ready. Got 3 of 3 DN Heartbeats.
2021-10-05 13:25:08,758 [Listener at 127.0.0.1/13296] INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(238)) - Waiting for cluster to exit safe mode
2021-10-05 13:25:08,758 [Listener at 127.0.0.1/13296] INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(240)) - SCM became leader
2021-10-05 13:25:08,801 [EndpointStateMachine task thread for /127.0.0.1:15021 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15021. Already tried 4 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:08,807 [EndpointStateMachine task thread for /127.0.0.1:15031 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15031. Already tried 4 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:09,747 [EndpointStateMachine task thread for /127.0.0.1:15041 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15041. Already tried 1 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:09,758 [Listener at 127.0.0.1/13296] INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(235)) - Nodes are ready. Got 3 of 3 DN Heartbeats.
2021-10-05 13:25:09,758 [Listener at 127.0.0.1/13296] INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(238)) - Waiting for cluster to exit safe mode
2021-10-05 13:25:09,758 [Listener at 127.0.0.1/13296] INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(240)) - SCM became leader
2021-10-05 13:25:09,802 [EndpointStateMachine task thread for /127.0.0.1:15021 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15021. Already tried 5 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:09,808 [EndpointStateMachine task thread for /127.0.0.1:15031 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15031. Already tried 5 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:09,879 [Datanode State Machine Thread - 0] ERROR datanode.RunningDatanodeState (RunningDatanodeState.java:computeNextContainerState(199)) - Error in executing end point task.
java.util.concurrent.ExecutionException: java.util.concurrent.TimeoutException
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.hadoop.ozone.container.common.states.datanode.RunningDatanodeState.computeNextContainerState(RunningDatanodeState.java:191)
	at org.apache.hadoop.ozone.container.common.states.datanode.RunningDatanodeState.await(RunningDatanodeState.java:231)
	at org.apache.hadoop.ozone.container.common.states.datanode.RunningDatanodeState.await(RunningDatanodeState.java:50)
	at org.apache.hadoop.ozone.container.common.statemachine.StateContext.execute(StateContext.java:629)
	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.start(DatanodeStateMachine.java:270)
	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.lambda$startDaemon$0(DatanodeStateMachine.java:457)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.util.concurrent.TimeoutException
	at java.util.concurrent.FutureTask.get(FutureTask.java:205)
	at org.apache.hadoop.ozone.container.common.states.datanode.RunningDatanodeState.lambda$execute$0(RunningDatanodeState.java:149)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
2021-10-05 13:25:10,368 [b668fbba-0931-4533-8c87-c6849aaa836f@group-62F8E1A01D1D-FollowerState] INFO  impl.FollowerState (FollowerState.java:run(134)) - b668fbba-0931-4533-8c87-c6849aaa836f@group-62F8E1A01D1D-FollowerState: change to CANDIDATE, lastRpcElapsedTime:5049419116ns, electionTimeout:5029ms
2021-10-05 13:25:10,368 [b668fbba-0931-4533-8c87-c6849aaa836f@group-62F8E1A01D1D-FollowerState] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(108)) - b668fbba-0931-4533-8c87-c6849aaa836f: shutdown b668fbba-0931-4533-8c87-c6849aaa836f@group-62F8E1A01D1D-FollowerState
2021-10-05 13:25:10,369 [b668fbba-0931-4533-8c87-c6849aaa836f@group-62F8E1A01D1D-FollowerState] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(285)) - b668fbba-0931-4533-8c87-c6849aaa836f@group-62F8E1A01D1D: changes role from  FOLLOWER to CANDIDATE at term 1 for changeToCandidate
2021-10-05 13:25:10,369 [b668fbba-0931-4533-8c87-c6849aaa836f@group-62F8E1A01D1D-FollowerState] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.leaderelection.pre-vote = false (custom)
2021-10-05 13:25:10,369 [b668fbba-0931-4533-8c87-c6849aaa836f@group-62F8E1A01D1D-FollowerState] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(130)) - b668fbba-0931-4533-8c87-c6849aaa836f: start b668fbba-0931-4533-8c87-c6849aaa836f@group-62F8E1A01D1D-LeaderElection22
2021-10-05 13:25:10,380 [b668fbba-0931-4533-8c87-c6849aaa836f@group-62F8E1A01D1D-LeaderElection22] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(306)) - b668fbba-0931-4533-8c87-c6849aaa836f@group-62F8E1A01D1D-LeaderElection22 ELECTION round 0: submit vote requests at term 2 for -1: [b668fbba-0931-4533-8c87-c6849aaa836f|rpc:127.0.0.1:40511|priority:1, 830d4653-8da7-4c59-a1a4-1cd595539218|rpc:127.0.0.1:42995|priority:0, 9cad18a2-4b78-4cb8-813e-2348ce620e43|rpc:127.0.0.1:34379|priority:0], old=null
2021-10-05 13:25:10,386 [grpc-default-executor-0] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1043)) - 830d4653-8da7-4c59-a1a4-1cd595539218@group-62F8E1A01D1D: receive requestVote(ELECTION, b668fbba-0931-4533-8c87-c6849aaa836f, group-62F8E1A01D1D, 2, (t:0, i:0))
2021-10-05 13:25:10,386 [grpc-default-executor-0] INFO  impl.VoteContext (VoteContext.java:log(48)) - 830d4653-8da7-4c59-a1a4-1cd595539218@group-62F8E1A01D1D-FOLLOWER: accept ELECTION from b668fbba-0931-4533-8c87-c6849aaa836f: our priority 0 <= candidate's priority 1
2021-10-05 13:25:10,386 [grpc-default-executor-0] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(285)) - 830d4653-8da7-4c59-a1a4-1cd595539218@group-62F8E1A01D1D: changes role from  FOLLOWER to FOLLOWER at term 2 for candidate:b668fbba-0931-4533-8c87-c6849aaa836f
2021-10-05 13:25:10,386 [grpc-default-executor-0] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(108)) - 830d4653-8da7-4c59-a1a4-1cd595539218: shutdown 830d4653-8da7-4c59-a1a4-1cd595539218@group-62F8E1A01D1D-FollowerState
2021-10-05 13:25:10,392 [830d4653-8da7-4c59-a1a4-1cd595539218@group-62F8E1A01D1D-FollowerState] INFO  impl.FollowerState (FollowerState.java:run(143)) - 830d4653-8da7-4c59-a1a4-1cd595539218@group-62F8E1A01D1D-FollowerState was interrupted: {}
java.lang.InterruptedException: sleep interrupted
	at java.lang.Thread.sleep(Native Method)
	at java.lang.Thread.sleep(Thread.java:340)
	at java.util.concurrent.TimeUnit.sleep(TimeUnit.java:386)
	at org.apache.ratis.util.TimeDuration.sleep(TimeDuration.java:324)
	at org.apache.ratis.util.TimeDuration.sleep(TimeDuration.java:309)
	at org.apache.ratis.server.impl.FollowerState.run(FollowerState.java:118)
2021-10-05 13:25:10,392 [grpc-default-executor-0] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(130)) - 830d4653-8da7-4c59-a1a4-1cd595539218: start 830d4653-8da7-4c59-a1a4-1cd595539218@group-62F8E1A01D1D-FollowerState
2021-10-05 13:25:10,394 [grpc-default-executor-2] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1043)) - 9cad18a2-4b78-4cb8-813e-2348ce620e43@group-62F8E1A01D1D: receive requestVote(ELECTION, b668fbba-0931-4533-8c87-c6849aaa836f, group-62F8E1A01D1D, 2, (t:0, i:0))
2021-10-05 13:25:10,395 [grpc-default-executor-2] INFO  impl.VoteContext (VoteContext.java:log(48)) - 9cad18a2-4b78-4cb8-813e-2348ce620e43@group-62F8E1A01D1D-FOLLOWER: accept ELECTION from b668fbba-0931-4533-8c87-c6849aaa836f: our priority 0 <= candidate's priority 1
2021-10-05 13:25:10,395 [grpc-default-executor-2] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(285)) - 9cad18a2-4b78-4cb8-813e-2348ce620e43@group-62F8E1A01D1D: changes role from  FOLLOWER to FOLLOWER at term 2 for candidate:b668fbba-0931-4533-8c87-c6849aaa836f
2021-10-05 13:25:10,395 [grpc-default-executor-2] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(108)) - 9cad18a2-4b78-4cb8-813e-2348ce620e43: shutdown 9cad18a2-4b78-4cb8-813e-2348ce620e43@group-62F8E1A01D1D-FollowerState
2021-10-05 13:25:10,400 [grpc-default-executor-2] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(130)) - 9cad18a2-4b78-4cb8-813e-2348ce620e43: start 9cad18a2-4b78-4cb8-813e-2348ce620e43@group-62F8E1A01D1D-FollowerState
2021-10-05 13:25:10,400 [9cad18a2-4b78-4cb8-813e-2348ce620e43@group-62F8E1A01D1D-FollowerState] INFO  impl.FollowerState (FollowerState.java:run(143)) - 9cad18a2-4b78-4cb8-813e-2348ce620e43@group-62F8E1A01D1D-FollowerState was interrupted: {}
java.lang.InterruptedException: sleep interrupted
	at java.lang.Thread.sleep(Native Method)
	at java.lang.Thread.sleep(Thread.java:340)
	at java.util.concurrent.TimeUnit.sleep(TimeUnit.java:386)
	at org.apache.ratis.util.TimeDuration.sleep(TimeDuration.java:324)
	at org.apache.ratis.util.TimeDuration.sleep(TimeDuration.java:309)
	at org.apache.ratis.server.impl.FollowerState.run(FollowerState.java:118)
2021-10-05 13:25:10,411 [grpc-default-executor-0] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1075)) - 830d4653-8da7-4c59-a1a4-1cd595539218@group-62F8E1A01D1D replies to ELECTION vote request: b668fbba-0931-4533-8c87-c6849aaa836f<-830d4653-8da7-4c59-a1a4-1cd595539218#0:OK-t2. Peer's state: 830d4653-8da7-4c59-a1a4-1cd595539218@group-62F8E1A01D1D:t2, leader=null, voted=b668fbba-0931-4533-8c87-c6849aaa836f, raftlog=830d4653-8da7-4c59-a1a4-1cd595539218@group-62F8E1A01D1D-SegmentedRaftLog:OPENED:c-1,f-1,i0, conf=-1: [b668fbba-0931-4533-8c87-c6849aaa836f|rpc:127.0.0.1:40511|dataStream:|priority:1, 830d4653-8da7-4c59-a1a4-1cd595539218|rpc:127.0.0.1:42995|dataStream:|priority:0, 9cad18a2-4b78-4cb8-813e-2348ce620e43|rpc:127.0.0.1:34379|dataStream:|priority:0], old=null
2021-10-05 13:25:10,413 [b668fbba-0931-4533-8c87-c6849aaa836f@group-62F8E1A01D1D-LeaderElection22] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(89)) - b668fbba-0931-4533-8c87-c6849aaa836f@group-62F8E1A01D1D-LeaderElection22: ELECTION PASSED received 1 response(s) and 0 exception(s):
2021-10-05 13:25:10,413 [b668fbba-0931-4533-8c87-c6849aaa836f@group-62F8E1A01D1D-LeaderElection22] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(93)) -   Response 0: b668fbba-0931-4533-8c87-c6849aaa836f<-830d4653-8da7-4c59-a1a4-1cd595539218#0:OK-t2
2021-10-05 13:25:10,413 [b668fbba-0931-4533-8c87-c6849aaa836f@group-62F8E1A01D1D-LeaderElection22] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(308)) - b668fbba-0931-4533-8c87-c6849aaa836f@group-62F8E1A01D1D-LeaderElection22 ELECTION round 0: result PASSED
2021-10-05 13:25:10,413 [b668fbba-0931-4533-8c87-c6849aaa836f@group-62F8E1A01D1D-LeaderElection22] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(121)) - b668fbba-0931-4533-8c87-c6849aaa836f: shutdown b668fbba-0931-4533-8c87-c6849aaa836f@group-62F8E1A01D1D-LeaderElection22
2021-10-05 13:25:10,413 [b668fbba-0931-4533-8c87-c6849aaa836f@group-62F8E1A01D1D-LeaderElection22] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(285)) - b668fbba-0931-4533-8c87-c6849aaa836f@group-62F8E1A01D1D: changes role from CANDIDATE to LEADER at term 2 for changeToLeader
2021-10-05 13:25:10,413 [b668fbba-0931-4533-8c87-c6849aaa836f@group-62F8E1A01D1D-LeaderElection22] INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:handleLeaderChangedNotification(861)) - Leader change notification received for group: group-62F8E1A01D1D with new leaderId: b668fbba-0931-4533-8c87-c6849aaa836f
2021-10-05 13:25:10,413 [b668fbba-0931-4533-8c87-c6849aaa836f@group-62F8E1A01D1D-LeaderElection22] INFO  server.RaftServer$Division (ServerState.java:setLeader(285)) - b668fbba-0931-4533-8c87-c6849aaa836f@group-62F8E1A01D1D: change Leader from null to b668fbba-0931-4533-8c87-c6849aaa836f at term 2 for becomeLeader, leader elected after 10252ms
2021-10-05 13:25:10,413 [b668fbba-0931-4533-8c87-c6849aaa836f@group-62F8E1A01D1D-LeaderElection22] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.staging.catchup.gap = 1000 (default)
2021-10-05 13:25:10,413 [b668fbba-0931-4533-8c87-c6849aaa836f@group-62F8E1A01D1D-LeaderElection22] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.write.element-limit = 1024 (custom)
2021-10-05 13:25:10,413 [b668fbba-0931-4533-8c87-c6849aaa836f@group-62F8E1A01D1D-LeaderElection22] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.write.byte-limit = 1024 M (=1073741824) (custom)
2021-10-05 13:25:10,414 [b668fbba-0931-4533-8c87-c6849aaa836f@group-62F8E1A01D1D-LeaderElection22] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.watch.timeout = 180s (custom)
2021-10-05 13:25:10,414 [b668fbba-0931-4533-8c87-c6849aaa836f@group-62F8E1A01D1D-LeaderElection22] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.watch.timeout.denomination = 1s (default)
2021-10-05 13:25:10,414 [b668fbba-0931-4533-8c87-c6849aaa836f@group-62F8E1A01D1D-LeaderElection22] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.watch.element-limit = 65536 (default)
2021-10-05 13:25:10,414 [b668fbba-0931-4533-8c87-c6849aaa836f@group-62F8E1A01D1D-LeaderElection22] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2021-10-05 13:25:10,414 [b668fbba-0931-4533-8c87-c6849aaa836f@group-62F8E1A01D1D-LeaderElection22] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2021-10-05 13:25:10,414 [b668fbba-0931-4533-8c87-c6849aaa836f@group-62F8E1A01D1D-LeaderElection22] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.appender.buffer.element-limit = 1 (custom)
2021-10-05 13:25:10,414 [b668fbba-0931-4533-8c87-c6849aaa836f@group-62F8E1A01D1D-LeaderElection22] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(44)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2021-10-05 13:25:10,414 [b668fbba-0931-4533-8c87-c6849aaa836f@group-62F8E1A01D1D-LeaderElection22] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.request.timeout = 60s (custom)
2021-10-05 13:25:10,414 [b668fbba-0931-4533-8c87-c6849aaa836f@group-62F8E1A01D1D-LeaderElection22] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.appender.install.snapshot.enabled = false (custom)
2021-10-05 13:25:10,415 [b668fbba-0931-4533-8c87-c6849aaa836f@group-62F8E1A01D1D-LeaderElection22] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2021-10-05 13:25:10,415 [b668fbba-0931-4533-8c87-c6849aaa836f@group-62F8E1A01D1D-LeaderElection22] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2021-10-05 13:25:10,420 [grpc-default-executor-2] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1075)) - 9cad18a2-4b78-4cb8-813e-2348ce620e43@group-62F8E1A01D1D replies to ELECTION vote request: b668fbba-0931-4533-8c87-c6849aaa836f<-9cad18a2-4b78-4cb8-813e-2348ce620e43#0:OK-t2. Peer's state: 9cad18a2-4b78-4cb8-813e-2348ce620e43@group-62F8E1A01D1D:t2, leader=null, voted=b668fbba-0931-4533-8c87-c6849aaa836f, raftlog=9cad18a2-4b78-4cb8-813e-2348ce620e43@group-62F8E1A01D1D-SegmentedRaftLog:OPENED:c-1,f-1,i0, conf=-1: [b668fbba-0931-4533-8c87-c6849aaa836f|rpc:127.0.0.1:40511|dataStream:|priority:1, 830d4653-8da7-4c59-a1a4-1cd595539218|rpc:127.0.0.1:42995|dataStream:|priority:0, 9cad18a2-4b78-4cb8-813e-2348ce620e43|rpc:127.0.0.1:34379|dataStream:|priority:0], old=null
2021-10-05 13:25:10,416 [EventQueue-OpenPipelineForHealthyPipelineSafeModeRule] INFO  safemode.SCMSafeModeManager (HealthyPipelineSafeModeRule.java:process(124)) - SCM in safe mode. Healthy pipelines reported count is 0, required healthy pipeline reported count is 1
2021-10-05 13:25:10,421 [b668fbba-0931-4533-8c87-c6849aaa836f@group-62F8E1A01D1D-LeaderElection22] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.appender.buffer.element-limit = 1 (custom)
2021-10-05 13:25:10,421 [b668fbba-0931-4533-8c87-c6849aaa836f@group-62F8E1A01D1D-LeaderElection22] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(44)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2021-10-05 13:25:10,416 [EventQueue-PipelineReportForPipelineReportHandler] INFO  pipeline.PipelineManagerImpl (PipelineManagerImpl.java:openPipeline(282)) - Pipeline Pipeline[ Id: 5cfa055b-4c5c-4f3c-a5c0-62f8e1a01d1d, Nodes: 9cad18a2-4b78-4cb8-813e-2348ce620e43{ip: 127.0.0.1, host: localhost, ports: [REPLICATION=45905, RATIS=34379, RATIS_ADMIN=34379, RATIS_SERVER=34379, STANDALONE=41383], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}b668fbba-0931-4533-8c87-c6849aaa836f{ip: 127.0.0.1, host: localhost, ports: [REPLICATION=42285, RATIS=40511, RATIS_ADMIN=40511, RATIS_SERVER=40511, STANDALONE=44361], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}830d4653-8da7-4c59-a1a4-1cd595539218{ip: 127.0.0.1, host: localhost, ports: [REPLICATION=34867, RATIS=42995, RATIS_ADMIN=42995, RATIS_SERVER=42995, STANDALONE=44359], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}, ReplicationConfig: RATIS/THREE, State:ALLOCATED, leaderId:b668fbba-0931-4533-8c87-c6849aaa836f, CreationTimestamp2021-10-05T13:24:57.784Z[Etc/UTC]] moved to OPEN state
2021-10-05 13:25:10,416 [EventQueue-OpenPipelineForHealthyPipelineSafeModeRule] INFO  safemode.SCMSafeModeManager (HealthyPipelineSafeModeRule.java:process(124)) - SCM in safe mode. Healthy pipelines reported count is 0, required healthy pipeline reported count is 1
2021-10-05 13:25:10,416 [EventQueue-PipelineReportForPipelineReportHandler] INFO  pipeline.PipelineManagerImpl (PipelineManagerImpl.java:openPipeline(282)) - Pipeline Pipeline[ Id: 5cfa055b-4c5c-4f3c-a5c0-62f8e1a01d1d, Nodes: 9cad18a2-4b78-4cb8-813e-2348ce620e43{ip: 127.0.0.1, host: localhost, ports: [REPLICATION=45905, RATIS=34379, RATIS_ADMIN=34379, RATIS_SERVER=34379, STANDALONE=41383], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}b668fbba-0931-4533-8c87-c6849aaa836f{ip: 127.0.0.1, host: localhost, ports: [REPLICATION=42285, RATIS=40511, RATIS_ADMIN=40511, RATIS_SERVER=40511, STANDALONE=44361], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}830d4653-8da7-4c59-a1a4-1cd595539218{ip: 127.0.0.1, host: localhost, ports: [REPLICATION=34867, RATIS=42995, RATIS_ADMIN=42995, RATIS_SERVER=42995, STANDALONE=44359], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}, ReplicationConfig: RATIS/THREE, State:ALLOCATED, leaderId:b668fbba-0931-4533-8c87-c6849aaa836f, CreationTimestamp2021-10-05T13:24:57.784Z[Etc/UTC]] moved to OPEN state
2021-10-05 13:25:10,421 [EventQueue-PipelineReportForPipelineReportHandler] INFO  ha.SCMHAInvocationHandler (SCMHAInvocationHandler.java:invokeRatis(113)) - Invoking method public abstract void org.apache.hadoop.hdds.scm.pipeline.PipelineStateManager.updatePipelineState(org.apache.hadoop.hdds.protocol.proto.HddsProtos$PipelineID,org.apache.hadoop.hdds.protocol.proto.HddsProtos$PipelineState) throws java.io.IOException on target org.apache.hadoop.hdds.scm.ha.SCMRatisServerImpl@7c75acaa, cost 214.921us
2021-10-05 13:25:10,421 [b668fbba-0931-4533-8c87-c6849aaa836f@group-62F8E1A01D1D-LeaderElection22] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.request.timeout = 60s (custom)
2021-10-05 13:25:10,422 [b668fbba-0931-4533-8c87-c6849aaa836f@group-62F8E1A01D1D-LeaderElection22] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.appender.install.snapshot.enabled = false (custom)
2021-10-05 13:25:10,423 [b668fbba-0931-4533-8c87-c6849aaa836f@group-62F8E1A01D1D-LeaderElection22] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(130)) - b668fbba-0931-4533-8c87-c6849aaa836f: start b668fbba-0931-4533-8c87-c6849aaa836f@group-62F8E1A01D1D-LeaderStateImpl
2021-10-05 13:25:10,423 [b668fbba-0931-4533-8c87-c6849aaa836f@group-62F8E1A01D1D-LeaderElection22] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:startLogSegment(394)) - b668fbba-0931-4533-8c87-c6849aaa836f@group-62F8E1A01D1D-SegmentedRaftLogWorker: Starting segment from index:0
2021-10-05 13:25:10,426 [b668fbba-0931-4533-8c87-c6849aaa836f@group-62F8E1A01D1D-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(601)) - b668fbba-0931-4533-8c87-c6849aaa836f@group-62F8E1A01D1D-SegmentedRaftLogWorker: created new log segment /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-36b87918-66c6-4e2c-9c49-5aa8dab94a1f/datanode-0/data/ratis/5cfa055b-4c5c-4f3c-a5c0-62f8e1a01d1d/current/log_inprogress_0
2021-10-05 13:25:10,447 [grpc-default-executor-2] INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:handleLeaderChangedNotification(861)) - Leader change notification received for group: group-62F8E1A01D1D with new leaderId: b668fbba-0931-4533-8c87-c6849aaa836f
2021-10-05 13:25:10,447 [grpc-default-executor-2] INFO  server.RaftServer$Division (ServerState.java:setLeader(285)) - 830d4653-8da7-4c59-a1a4-1cd595539218@group-62F8E1A01D1D: change Leader from null to b668fbba-0931-4533-8c87-c6849aaa836f at term 2 for appendEntries, leader elected after 10127ms
2021-10-05 13:25:10,448 [21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F-StateMachineUpdater] INFO  safemode.HealthyPipelineSafeModeRule (HealthyPipelineSafeModeRule.java:initializeRule(152)) - Refreshed total pipeline count is 1, healthy pipeline threshold count is 1
2021-10-05 13:25:10,448 [EventQueue-PipelineReportForPipelineReportHandler] INFO  ha.SCMHAInvocationHandler (SCMHAInvocationHandler.java:invokeRatis(113)) - Invoking method public abstract void org.apache.hadoop.hdds.scm.pipeline.PipelineStateManager.updatePipelineState(org.apache.hadoop.hdds.protocol.proto.HddsProtos$PipelineID,org.apache.hadoop.hdds.protocol.proto.HddsProtos$PipelineState) throws java.io.IOException on target org.apache.hadoop.hdds.scm.ha.SCMRatisServerImpl@7efc167c, cost 27477.104us
2021-10-05 13:25:10,449 [EventQueue-OpenPipelineForHealthyPipelineSafeModeRule] INFO  safemode.SCMSafeModeManager (HealthyPipelineSafeModeRule.java:process(124)) - SCM in safe mode. Healthy pipelines reported count is 1, required healthy pipeline reported count is 1
2021-10-05 13:25:10,449 [EventQueue-OpenPipelineForHealthyPipelineSafeModeRule] INFO  safemode.SCMSafeModeManager (SCMSafeModeManager.java:validateSafeModeExitRules(204)) - HealthyPipelineSafeModeRule rule is successfully validated
2021-10-05 13:25:10,449 [EventQueue-OpenPipelineForHealthyPipelineSafeModeRule] INFO  safemode.SCMSafeModeManager (SCMSafeModeManager.java:validateSafeModeExitRules(219)) - ScmSafeModeManager, all rules are successfully validated
2021-10-05 13:25:10,449 [EventQueue-OpenPipelineForHealthyPipelineSafeModeRule] INFO  safemode.SCMSafeModeManager (SCMSafeModeManager.java:exitSafeMode(248)) - SCM exiting safe mode.
2021-10-05 13:25:10,449 [EventQueue-OpenPipelineForHealthyPipelineSafeModeRule] WARN  events.EventQueue (EventQueue.java:fireEvent(194)) - No event handler registered for event TypedEvent{payloadType=SafeModeStatus, name='Safe mode status'}
2021-10-05 13:25:10,449 [EventQueue-OpenPipelineForHealthyPipelineSafeModeRule] INFO  ha.SCMContext (SCMContext.java:updateSafeModeStatus(205)) - Update SafeModeStatus from SafeModeStatus{safeModeStatus=true, preCheckPassed=true} to SafeModeStatus{safeModeStatus=false, preCheckPassed=true}.
2021-10-05 13:25:10,449 [EventQueue-OpenPipelineForHealthyPipelineSafeModeRule] INFO  container.ReplicationManager (ReplicationManager.java:notifyStatusChanged(1743)) - Service ReplicationManager transitions to RUNNING.
2021-10-05 13:25:10,451 [b668fbba-0931-4533-8c87-c6849aaa836f@group-62F8E1A01D1D-LeaderElection22] INFO  server.RaftServer$Division (ServerState.java:setRaftConf(387)) - b668fbba-0931-4533-8c87-c6849aaa836f@group-62F8E1A01D1D: set configuration 0: [b668fbba-0931-4533-8c87-c6849aaa836f|rpc:127.0.0.1:40511|dataStream:|priority:1, 830d4653-8da7-4c59-a1a4-1cd595539218|rpc:127.0.0.1:42995|dataStream:|priority:0, 9cad18a2-4b78-4cb8-813e-2348ce620e43|rpc:127.0.0.1:34379|dataStream:|priority:0], old=null
2021-10-05 13:25:10,464 [grpc-default-executor-3] INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:handleLeaderChangedNotification(861)) - Leader change notification received for group: group-62F8E1A01D1D with new leaderId: b668fbba-0931-4533-8c87-c6849aaa836f
2021-10-05 13:25:10,464 [grpc-default-executor-3] INFO  server.RaftServer$Division (ServerState.java:setLeader(285)) - 9cad18a2-4b78-4cb8-813e-2348ce620e43@group-62F8E1A01D1D: change Leader from null to b668fbba-0931-4533-8c87-c6849aaa836f at term 2 for appendEntries, leader elected after 10239ms
2021-10-05 13:25:10,464 [grpc-default-executor-3] INFO  server.RaftServer$Division (ServerState.java:setRaftConf(387)) - 9cad18a2-4b78-4cb8-813e-2348ce620e43@group-62F8E1A01D1D: set configuration 0: [b668fbba-0931-4533-8c87-c6849aaa836f|rpc:127.0.0.1:40511|dataStream:|priority:1, 830d4653-8da7-4c59-a1a4-1cd595539218|rpc:127.0.0.1:42995|dataStream:|priority:0, 9cad18a2-4b78-4cb8-813e-2348ce620e43|rpc:127.0.0.1:34379|dataStream:|priority:0], old=null
2021-10-05 13:25:10,465 [grpc-default-executor-3] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:startLogSegment(394)) - 9cad18a2-4b78-4cb8-813e-2348ce620e43@group-62F8E1A01D1D-SegmentedRaftLogWorker: Starting segment from index:0
2021-10-05 13:25:10,469 [9cad18a2-4b78-4cb8-813e-2348ce620e43@group-62F8E1A01D1D-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(601)) - 9cad18a2-4b78-4cb8-813e-2348ce620e43@group-62F8E1A01D1D-SegmentedRaftLogWorker: created new log segment /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-36b87918-66c6-4e2c-9c49-5aa8dab94a1f/datanode-2/data/ratis/5cfa055b-4c5c-4f3c-a5c0-62f8e1a01d1d/current/log_inprogress_0
2021-10-05 13:25:10,480 [grpc-default-executor-0] INFO  server.RaftServer$Division (ServerState.java:setRaftConf(387)) - 830d4653-8da7-4c59-a1a4-1cd595539218@group-62F8E1A01D1D: set configuration 0: [b668fbba-0931-4533-8c87-c6849aaa836f|rpc:127.0.0.1:40511|dataStream:|priority:1, 830d4653-8da7-4c59-a1a4-1cd595539218|rpc:127.0.0.1:42995|dataStream:|priority:0, 9cad18a2-4b78-4cb8-813e-2348ce620e43|rpc:127.0.0.1:34379|dataStream:|priority:0], old=null
2021-10-05 13:25:10,480 [grpc-default-executor-0] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:startLogSegment(394)) - 830d4653-8da7-4c59-a1a4-1cd595539218@group-62F8E1A01D1D-SegmentedRaftLogWorker: Starting segment from index:0
2021-10-05 13:25:10,483 [830d4653-8da7-4c59-a1a4-1cd595539218@group-62F8E1A01D1D-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(601)) - 830d4653-8da7-4c59-a1a4-1cd595539218@group-62F8E1A01D1D-SegmentedRaftLogWorker: created new log segment /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-36b87918-66c6-4e2c-9c49-5aa8dab94a1f/datanode-1/data/ratis/5cfa055b-4c5c-4f3c-a5c0-62f8e1a01d1d/current/log_inprogress_0
2021-10-05 13:25:10,496 [6d234f4d-474a-4c74-a9e9-8f3885fce584@group-5AA8DAB94A1F-StateMachineUpdater] INFO  safemode.HealthyPipelineSafeModeRule (HealthyPipelineSafeModeRule.java:initializeRule(152)) - Refreshed total pipeline count is 1, healthy pipeline threshold count is 1
2021-10-05 13:25:10,541 [b668fbba-0931-4533-8c87-c6849aaa836f@group-9360A73A2ABC-FollowerState] INFO  impl.FollowerState (FollowerState.java:run(134)) - b668fbba-0931-4533-8c87-c6849aaa836f@group-9360A73A2ABC-FollowerState: change to CANDIDATE, lastRpcElapsedTime:5076488548ns, electionTimeout:5067ms
2021-10-05 13:25:10,541 [b668fbba-0931-4533-8c87-c6849aaa836f@group-9360A73A2ABC-FollowerState] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(108)) - b668fbba-0931-4533-8c87-c6849aaa836f: shutdown b668fbba-0931-4533-8c87-c6849aaa836f@group-9360A73A2ABC-FollowerState
2021-10-05 13:25:10,541 [b668fbba-0931-4533-8c87-c6849aaa836f@group-9360A73A2ABC-FollowerState] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(285)) - b668fbba-0931-4533-8c87-c6849aaa836f@group-9360A73A2ABC: changes role from  FOLLOWER to CANDIDATE at term 1 for changeToCandidate
2021-10-05 13:25:10,541 [b668fbba-0931-4533-8c87-c6849aaa836f@group-9360A73A2ABC-FollowerState] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.leaderelection.pre-vote = false (custom)
2021-10-05 13:25:10,541 [b668fbba-0931-4533-8c87-c6849aaa836f@group-9360A73A2ABC-FollowerState] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(130)) - b668fbba-0931-4533-8c87-c6849aaa836f: start b668fbba-0931-4533-8c87-c6849aaa836f@group-9360A73A2ABC-LeaderElection23
2021-10-05 13:25:10,559 [b668fbba-0931-4533-8c87-c6849aaa836f@group-9360A73A2ABC-LeaderElection23] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(306)) - b668fbba-0931-4533-8c87-c6849aaa836f@group-9360A73A2ABC-LeaderElection23 ELECTION round 0: submit vote requests at term 2 for -1: [b668fbba-0931-4533-8c87-c6849aaa836f|rpc:127.0.0.1:40511|priority:0, 830d4653-8da7-4c59-a1a4-1cd595539218|rpc:127.0.0.1:42995|priority:0, 9cad18a2-4b78-4cb8-813e-2348ce620e43|rpc:127.0.0.1:34379|priority:1], old=null
2021-10-05 13:25:10,563 [grpc-default-executor-2] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1043)) - 830d4653-8da7-4c59-a1a4-1cd595539218@group-9360A73A2ABC: receive requestVote(ELECTION, b668fbba-0931-4533-8c87-c6849aaa836f, group-9360A73A2ABC, 2, (t:0, i:0))
2021-10-05 13:25:10,575 [grpc-default-executor-2] INFO  impl.VoteContext (VoteContext.java:log(48)) - 830d4653-8da7-4c59-a1a4-1cd595539218@group-9360A73A2ABC-FOLLOWER: accept ELECTION from b668fbba-0931-4533-8c87-c6849aaa836f: our priority 0 <= candidate's priority 0
2021-10-05 13:25:10,575 [grpc-default-executor-2] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(285)) - 830d4653-8da7-4c59-a1a4-1cd595539218@group-9360A73A2ABC: changes role from  FOLLOWER to FOLLOWER at term 2 for candidate:b668fbba-0931-4533-8c87-c6849aaa836f
2021-10-05 13:25:10,575 [grpc-default-executor-2] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(108)) - 830d4653-8da7-4c59-a1a4-1cd595539218: shutdown 830d4653-8da7-4c59-a1a4-1cd595539218@group-9360A73A2ABC-FollowerState
2021-10-05 13:25:10,575 [grpc-default-executor-2] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(130)) - 830d4653-8da7-4c59-a1a4-1cd595539218: start 830d4653-8da7-4c59-a1a4-1cd595539218@group-9360A73A2ABC-FollowerState
2021-10-05 13:25:10,575 [830d4653-8da7-4c59-a1a4-1cd595539218@group-9360A73A2ABC-FollowerState] INFO  impl.FollowerState (FollowerState.java:run(143)) - 830d4653-8da7-4c59-a1a4-1cd595539218@group-9360A73A2ABC-FollowerState was interrupted: {}
java.lang.InterruptedException: sleep interrupted
	at java.lang.Thread.sleep(Native Method)
	at java.lang.Thread.sleep(Thread.java:340)
	at java.util.concurrent.TimeUnit.sleep(TimeUnit.java:386)
	at org.apache.ratis.util.TimeDuration.sleep(TimeDuration.java:324)
	at org.apache.ratis.util.TimeDuration.sleep(TimeDuration.java:309)
	at org.apache.ratis.server.impl.FollowerState.run(FollowerState.java:118)
2021-10-05 13:25:10,578 [grpc-default-executor-2] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1075)) - 830d4653-8da7-4c59-a1a4-1cd595539218@group-9360A73A2ABC replies to ELECTION vote request: b668fbba-0931-4533-8c87-c6849aaa836f<-830d4653-8da7-4c59-a1a4-1cd595539218#0:OK-t2. Peer's state: 830d4653-8da7-4c59-a1a4-1cd595539218@group-9360A73A2ABC:t2, leader=null, voted=b668fbba-0931-4533-8c87-c6849aaa836f, raftlog=830d4653-8da7-4c59-a1a4-1cd595539218@group-9360A73A2ABC-SegmentedRaftLog:OPENED:c-1,f-1,i0, conf=-1: [b668fbba-0931-4533-8c87-c6849aaa836f|rpc:127.0.0.1:40511|dataStream:|priority:0, 830d4653-8da7-4c59-a1a4-1cd595539218|rpc:127.0.0.1:42995|dataStream:|priority:0, 9cad18a2-4b78-4cb8-813e-2348ce620e43|rpc:127.0.0.1:34379|dataStream:|priority:1], old=null
2021-10-05 13:25:10,581 [grpc-default-executor-2] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1043)) - 9cad18a2-4b78-4cb8-813e-2348ce620e43@group-9360A73A2ABC: receive requestVote(ELECTION, b668fbba-0931-4533-8c87-c6849aaa836f, group-9360A73A2ABC, 2, (t:0, i:0))
2021-10-05 13:25:10,583 [grpc-default-executor-2] INFO  impl.VoteContext (VoteContext.java:log(48)) - 9cad18a2-4b78-4cb8-813e-2348ce620e43@group-9360A73A2ABC-FOLLOWER: reject ELECTION from b668fbba-0931-4533-8c87-c6849aaa836f: our priority 1 > candidate's priority 0
2021-10-05 13:25:10,583 [grpc-default-executor-2] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(285)) - 9cad18a2-4b78-4cb8-813e-2348ce620e43@group-9360A73A2ABC: changes role from  FOLLOWER to FOLLOWER at term 2 for candidate:b668fbba-0931-4533-8c87-c6849aaa836f
2021-10-05 13:25:10,583 [grpc-default-executor-2] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(108)) - 9cad18a2-4b78-4cb8-813e-2348ce620e43: shutdown 9cad18a2-4b78-4cb8-813e-2348ce620e43@group-9360A73A2ABC-FollowerState
2021-10-05 13:25:10,583 [grpc-default-executor-2] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(130)) - 9cad18a2-4b78-4cb8-813e-2348ce620e43: start 9cad18a2-4b78-4cb8-813e-2348ce620e43@group-9360A73A2ABC-FollowerState
2021-10-05 13:25:10,583 [9cad18a2-4b78-4cb8-813e-2348ce620e43@group-9360A73A2ABC-FollowerState] INFO  impl.FollowerState (FollowerState.java:run(143)) - 9cad18a2-4b78-4cb8-813e-2348ce620e43@group-9360A73A2ABC-FollowerState was interrupted: {}
java.lang.InterruptedException: sleep interrupted
	at java.lang.Thread.sleep(Native Method)
	at java.lang.Thread.sleep(Thread.java:340)
	at java.util.concurrent.TimeUnit.sleep(TimeUnit.java:386)
	at org.apache.ratis.util.TimeDuration.sleep(TimeDuration.java:324)
	at org.apache.ratis.util.TimeDuration.sleep(TimeDuration.java:309)
	at org.apache.ratis.server.impl.FollowerState.run(FollowerState.java:118)
2021-10-05 13:25:10,588 [grpc-default-executor-2] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1075)) - 9cad18a2-4b78-4cb8-813e-2348ce620e43@group-9360A73A2ABC replies to ELECTION vote request: b668fbba-0931-4533-8c87-c6849aaa836f<-9cad18a2-4b78-4cb8-813e-2348ce620e43#0:FAIL-t2. Peer's state: 9cad18a2-4b78-4cb8-813e-2348ce620e43@group-9360A73A2ABC:t2, leader=null, voted=null, raftlog=9cad18a2-4b78-4cb8-813e-2348ce620e43@group-9360A73A2ABC-SegmentedRaftLog:OPENED:c-1,f-1,i0, conf=-1: [b668fbba-0931-4533-8c87-c6849aaa836f|rpc:127.0.0.1:40511|dataStream:|priority:0, 830d4653-8da7-4c59-a1a4-1cd595539218|rpc:127.0.0.1:42995|dataStream:|priority:0, 9cad18a2-4b78-4cb8-813e-2348ce620e43|rpc:127.0.0.1:34379|dataStream:|priority:1], old=null
2021-10-05 13:25:10,601 [b668fbba-0931-4533-8c87-c6849aaa836f@group-9360A73A2ABC-LeaderElection23] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(89)) - b668fbba-0931-4533-8c87-c6849aaa836f@group-9360A73A2ABC-LeaderElection23: ELECTION REJECTED received 2 response(s) and 0 exception(s):
2021-10-05 13:25:10,601 [b668fbba-0931-4533-8c87-c6849aaa836f@group-9360A73A2ABC-LeaderElection23] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(93)) -   Response 0: b668fbba-0931-4533-8c87-c6849aaa836f<-830d4653-8da7-4c59-a1a4-1cd595539218#0:OK-t2
2021-10-05 13:25:10,601 [b668fbba-0931-4533-8c87-c6849aaa836f@group-9360A73A2ABC-LeaderElection23] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(93)) -   Response 1: b668fbba-0931-4533-8c87-c6849aaa836f<-9cad18a2-4b78-4cb8-813e-2348ce620e43#0:FAIL-t2
2021-10-05 13:25:10,601 [b668fbba-0931-4533-8c87-c6849aaa836f@group-9360A73A2ABC-LeaderElection23] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(308)) - b668fbba-0931-4533-8c87-c6849aaa836f@group-9360A73A2ABC-LeaderElection23 ELECTION round 0: result REJECTED
2021-10-05 13:25:10,601 [b668fbba-0931-4533-8c87-c6849aaa836f@group-9360A73A2ABC-LeaderElection23] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(285)) - b668fbba-0931-4533-8c87-c6849aaa836f@group-9360A73A2ABC: changes role from CANDIDATE to FOLLOWER at term 2 for REJECTED
2021-10-05 13:25:10,601 [b668fbba-0931-4533-8c87-c6849aaa836f@group-9360A73A2ABC-LeaderElection23] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(121)) - b668fbba-0931-4533-8c87-c6849aaa836f: shutdown b668fbba-0931-4533-8c87-c6849aaa836f@group-9360A73A2ABC-LeaderElection23
2021-10-05 13:25:10,601 [b668fbba-0931-4533-8c87-c6849aaa836f@group-9360A73A2ABC-LeaderElection23] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(130)) - b668fbba-0931-4533-8c87-c6849aaa836f: start b668fbba-0931-4533-8c87-c6849aaa836f@group-9360A73A2ABC-FollowerState
2021-10-05 13:25:10,747 [EndpointStateMachine task thread for /127.0.0.1:15041 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15041. Already tried 2 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:10,758 [Listener at 127.0.0.1/13296] INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(235)) - Nodes are ready. Got 3 of 3 DN Heartbeats.
2021-10-05 13:25:10,759 [Listener at 127.0.0.1/13296] INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(238)) - Cluster exits safe mode
2021-10-05 13:25:10,759 [Listener at 127.0.0.1/13296] INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(240)) - SCM became leader
2021-10-05 13:25:10,759 [Listener at 127.0.0.1/13296] INFO  server.StorageContainerManager (StorageContainerManager.java:start(1303)) - StorageContainerLocationProtocol RPC server is listening at /0.0.0.0:13551
2021-10-05 13:25:10,759 [Listener at 127.0.0.1/13296] INFO  ha.SCMRatisServerImpl (SCMRatisServerImpl.java:start(177)) - starting ratis server 0.0.0.0:13548
2021-10-05 13:25:10,760 [Listener at 127.0.0.1/13296] INFO  server.RaftServer$Division (RaftServerImpl.java:start(299)) - b6de9022-5a0e-4aec-a94e-4e214b276ef3@group-5AA8DAB94A1F: start with initializing state, conf=-1: [], old=null
2021-10-05 13:25:10,760 [Listener at 127.0.0.1/13296] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(285)) - b6de9022-5a0e-4aec-a94e-4e214b276ef3@group-5AA8DAB94A1F: changes role from      null to FOLLOWER at term 0 for startInitializing
2021-10-05 13:25:10,760 [Listener at 127.0.0.1/13296] INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-5AA8DAB94A1F,id=b6de9022-5a0e-4aec-a94e-4e214b276ef3
2021-10-05 13:25:10,762 [Listener at 127.0.0.1/13296] INFO  server.RaftServer (RaftServerProxy.java:lambda$start$5(374)) - b6de9022-5a0e-4aec-a94e-4e214b276ef3: start RPC server
2021-10-05 13:25:10,763 [Listener at 127.0.0.1/13296] INFO  server.GrpcService (GrpcService.java:startImpl(253)) - b6de9022-5a0e-4aec-a94e-4e214b276ef3: GrpcService started, listening on 13548
2021-10-05 13:25:10,768 [Listener at 127.0.0.1/13296] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.client.port appended with serviceId and nodeId
2021-10-05 13:25:10,768 [Listener at 127.0.0.1/13296] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.block.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.block.client.port appended with serviceId and nodeId
2021-10-05 13:25:10,768 [Listener at 127.0.0.1/13296] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.datanode.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.datanode.port appended with serviceId and nodeId
2021-10-05 13:25:10,769 [Listener at 127.0.0.1/13296] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.client.port appended with serviceId and nodeId
2021-10-05 13:25:10,769 [Listener at 127.0.0.1/13296] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.block.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.block.client.port appended with serviceId and nodeId
2021-10-05 13:25:10,769 [Listener at 127.0.0.1/13296] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.datanode.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.datanode.port appended with serviceId and nodeId
2021-10-05 13:25:10,769 [Listener at 127.0.0.1/13296] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.client.port appended with serviceId and nodeId
2021-10-05 13:25:10,769 [Listener at 127.0.0.1/13296] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.block.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.block.client.port appended with serviceId and nodeId
2021-10-05 13:25:10,769 [Listener at 127.0.0.1/13296] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.datanode.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.datanode.port appended with serviceId and nodeId
2021-10-05 13:25:10,770 [org.apache.ratis.util.JvmPauseMonitor$$Lambda$499/1586779822@1520485a] INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(103)) - JvmPauseMonitor-b6de9022-5a0e-4aec-a94e-4e214b276ef3: Started
2021-10-05 13:25:10,783 [IPC Server handler 2 on default port 13530] INFO  ha.SCMRatisServerImpl (SCMRatisServerImpl.java:addSCM(291)) - 21490b65-0a55-46f3-b94a-dd719a327c14: Submitting SetConfiguration request to Ratis server with new SCM peers list: [21490b65-0a55-46f3-b94a-dd719a327c14|rpc:localhost:13528|admin:|client:|dataStream:|priority:0, 6d234f4d-474a-4c74-a9e9-8f3885fce584|rpc:localhost:13538|priority:0, b6de9022-5a0e-4aec-a94e-4e214b276ef3|rpc:localhost:13548|priority:0]
2021-10-05 13:25:10,783 [IPC Server handler 2 on default port 13530] INFO  server.RaftServer$Division (RaftServerImpl.java:setConfigurationAsync(971)) - 21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F: receive setConfiguration SetConfigurationRequest:client-474D5F38DF1B->21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F, cid=10, seq=0, RW, null, peers:[21490b65-0a55-46f3-b94a-dd719a327c14|rpc:localhost:13528|admin:|client:|dataStream:|priority:0, 6d234f4d-474a-4c74-a9e9-8f3885fce584|rpc:localhost:13538|priority:0, b6de9022-5a0e-4aec-a94e-4e214b276ef3|rpc:localhost:13548|priority:0]
2021-10-05 13:25:10,783 [IPC Server handler 2 on default port 13530] INFO  server.RaftServer$Division (LeaderStateImpl.java:startSetConfiguration(345)) - 21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F-LeaderStateImpl: startSetConfiguration SetConfigurationRequest:client-474D5F38DF1B->21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F, cid=10, seq=0, RW, null, peers:[21490b65-0a55-46f3-b94a-dd719a327c14|rpc:localhost:13528|admin:|client:|dataStream:|priority:0, 6d234f4d-474a-4c74-a9e9-8f3885fce584|rpc:localhost:13538|priority:0, b6de9022-5a0e-4aec-a94e-4e214b276ef3|rpc:localhost:13548|priority:0]
2021-10-05 13:25:10,783 [IPC Server handler 2 on default port 13530] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2021-10-05 13:25:10,783 [IPC Server handler 2 on default port 13530] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2021-10-05 13:25:10,783 [IPC Server handler 2 on default port 13530] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.appender.buffer.element-limit = 1024 (custom)
2021-10-05 13:25:10,784 [IPC Server handler 2 on default port 13530] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(44)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2021-10-05 13:25:10,784 [IPC Server handler 2 on default port 13530] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.request.timeout = 30000ms (custom)
2021-10-05 13:25:10,784 [IPC Server handler 2 on default port 13530] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.appender.install.snapshot.enabled = false (custom)
2021-10-05 13:25:10,786 [21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F->b6de9022-5a0e-4aec-a94e-4e214b276ef3-GrpcLogAppender-LogAppenderDaemon] INFO  server.GrpcLogAppender (GrpcLogAppender.java:installSnapshot(524)) - 21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F->b6de9022-5a0e-4aec-a94e-4e214b276ef3-GrpcLogAppender: followerNextIndex = 0 but logStartIndex = 1, notify follower to install snapshot-(t:2, i:1)
2021-10-05 13:25:10,786 [21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F->b6de9022-5a0e-4aec-a94e-4e214b276ef3-GrpcLogAppender-LogAppenderDaemon] INFO  server.GrpcLogAppender (GrpcLogAppender.java:installSnapshot(532)) - 21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F->b6de9022-5a0e-4aec-a94e-4e214b276ef3-GrpcLogAppender: send 21490b65-0a55-46f3-b94a-dd719a327c14->b6de9022-5a0e-4aec-a94e-4e214b276ef3#0-t2,notify:(t:2, i:1)
2021-10-05 13:25:10,803 [EndpointStateMachine task thread for /127.0.0.1:15021 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15021. Already tried 6 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:10,804 [grpc-default-executor-2] INFO  server.RaftServer$Division (RaftServerImpl.java:installSnapshot(1329)) - b6de9022-5a0e-4aec-a94e-4e214b276ef3@group-5AA8DAB94A1F: receive installSnapshot: 21490b65-0a55-46f3-b94a-dd719a327c14->b6de9022-5a0e-4aec-a94e-4e214b276ef3#0-t2,notify:(t:2, i:1)
2021-10-05 13:25:10,808 [EndpointStateMachine task thread for /127.0.0.1:15031 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15031. Already tried 6 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:10,810 [grpc-default-executor-2] INFO  ha.SCMStateMachine (SCMStateMachine.java:notifyLeaderChanged(248)) - leader changed, yet current SCM is still follower.
2021-10-05 13:25:10,810 [grpc-default-executor-2] INFO  server.RaftServer$Division (ServerState.java:setLeader(285)) - b6de9022-5a0e-4aec-a94e-4e214b276ef3@group-5AA8DAB94A1F: change Leader from null to 21490b65-0a55-46f3-b94a-dd719a327c14 at term 2 for installSnapshot, leader elected after 19347ms
2021-10-05 13:25:10,810 [grpc-default-executor-2] INFO  server.RaftServer$Division (RaftServerImpl.java:notifyStateMachineToInstallSnapshot(1581)) - b6de9022-5a0e-4aec-a94e-4e214b276ef3@group-5AA8DAB94A1F: notifyInstallSnapshot: nextIndex is 0 but the leader's first available index is 1.
2021-10-05 13:25:10,810 [grpc-default-executor-2] INFO  ha.SCMStateMachine (SCMStateMachine.java:notifyInstallSnapshotFromLeader(212)) - Received install snapshot notification from SCM leader: localhost:13528 with term index: (t:2, i:1)
2021-10-05 13:25:10,811 [grpc-default-executor-2] INFO  server.RaftServer$Division (RaftServerImpl.java:installSnapshotImpl(1459)) - b6de9022-5a0e-4aec-a94e-4e214b276ef3@group-5AA8DAB94A1F: set new configuration index: 5
configurationEntry {
  peers {
    id: "21490b65-0a55-46f3-b94a-dd719a327c14"
    address: "localhost:13528"
  }
  peers {
    id: "6d234f4d-474a-4c74-a9e9-8f3885fce584"
    address: "localhost:13538"
  }
}
 from snapshot
2021-10-05 13:25:10,811 [grpc-default-executor-2] INFO  server.RaftServer$Division (ServerState.java:setRaftConf(387)) - b6de9022-5a0e-4aec-a94e-4e214b276ef3@group-5AA8DAB94A1F: set configuration 5: [21490b65-0a55-46f3-b94a-dd719a327c14|rpc:localhost:13528|admin:|client:|dataStream:|priority:0, 6d234f4d-474a-4c74-a9e9-8f3885fce584|rpc:localhost:13538|admin:|client:|dataStream:|priority:0], old=null
2021-10-05 13:25:10,812 [grpc-default-executor-2] INFO  server.RaftServer$Division (RaftServerImpl.java:installSnapshot(1340)) - b6de9022-5a0e-4aec-a94e-4e214b276ef3@group-5AA8DAB94A1F: reply installSnapshot: 21490b65-0a55-46f3-b94a-dd719a327c14<-b6de9022-5a0e-4aec-a94e-4e214b276ef3#0:FAIL-t0,IN_PROGRESS
2021-10-05 13:25:10,812 [grpc-default-executor-2] INFO  server.GrpcServerProtocolService (GrpcServerProtocolService.java:onCompleted(140)) - b6de9022-5a0e-4aec-a94e-4e214b276ef3: Completed INSTALL_SNAPSHOT, lastRequest: 21490b65-0a55-46f3-b94a-dd719a327c14->b6de9022-5a0e-4aec-a94e-4e214b276ef3#0-t2,notify:(t:2, i:1)
2021-10-05 13:25:10,813 [grpc-default-executor-2] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onNext(400)) - 21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F->b6de9022-5a0e-4aec-a94e-4e214b276ef3-InstallSnapshotResponseHandler: received the first reply 21490b65-0a55-46f3-b94a-dd719a327c14<-b6de9022-5a0e-4aec-a94e-4e214b276ef3#0:FAIL-t0,IN_PROGRESS
2021-10-05 13:25:10,813 [grpc-default-executor-2] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onNext(417)) - 21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F->b6de9022-5a0e-4aec-a94e-4e214b276ef3-InstallSnapshotResponseHandler: InstallSnapshot in progress.
2021-10-05 13:25:10,815 [pool-228-thread-1] INFO  ha.SCMHAManagerImpl (SCMHAManagerImpl.java:getDBCheckpointFromLeader(206)) - Downloading checkpoint from leader SCM scmNode-1 and reloading state from the checkpoint.
2021-10-05 13:25:10,817 [grpc-default-executor-2] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(130)) - b6de9022-5a0e-4aec-a94e-4e214b276ef3: start b6de9022-5a0e-4aec-a94e-4e214b276ef3@group-5AA8DAB94A1F-FollowerState
2021-10-05 13:25:10,816 [21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F->b6de9022-5a0e-4aec-a94e-4e214b276ef3-GrpcLogAppender-LogAppenderDaemon] INFO  server.GrpcLogAppender (GrpcLogAppender.java:installSnapshot(524)) - 21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F->b6de9022-5a0e-4aec-a94e-4e214b276ef3-GrpcLogAppender: followerNextIndex = 0 but logStartIndex = 1, notify follower to install snapshot-(t:2, i:1)
2021-10-05 13:25:10,820 [21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F->b6de9022-5a0e-4aec-a94e-4e214b276ef3-GrpcLogAppender-LogAppenderDaemon] INFO  server.GrpcLogAppender (GrpcLogAppender.java:installSnapshot(532)) - 21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F->b6de9022-5a0e-4aec-a94e-4e214b276ef3-GrpcLogAppender: send 21490b65-0a55-46f3-b94a-dd719a327c14->b6de9022-5a0e-4aec-a94e-4e214b276ef3#0-t2,notify:(t:2, i:1)
2021-10-05 13:25:10,821 [grpc-default-executor-3] INFO  server.RaftServer$Division (RaftServerImpl.java:installSnapshot(1329)) - b6de9022-5a0e-4aec-a94e-4e214b276ef3@group-5AA8DAB94A1F: receive installSnapshot: 21490b65-0a55-46f3-b94a-dd719a327c14->b6de9022-5a0e-4aec-a94e-4e214b276ef3#0-t2,notify:(t:2, i:1)
2021-10-05 13:25:10,823 [grpc-default-executor-2] INFO  server.RaftServer$Division (RaftServerImpl.java:checkInconsistentAppendEntries(1293)) - b6de9022-5a0e-4aec-a94e-4e214b276ef3@group-5AA8DAB94A1F: Failed appendEntries as snapshot ((t:2, i:1)) installation is in progress
2021-10-05 13:25:10,823 [grpc-default-executor-2] INFO  server.RaftServer$Division (RaftServerImpl.java:checkInconsistentAppendEntries(1285)) - b6de9022-5a0e-4aec-a94e-4e214b276ef3@group-5AA8DAB94A1F: inconsistency entries. Reply:21490b65-0a55-46f3-b94a-dd719a327c14<-b6de9022-5a0e-4aec-a94e-4e214b276ef3#0:FAIL-t2,INCONSISTENCY,nextIndex=0,followerCommit=-1
2021-10-05 13:25:10,827 [grpc-default-executor-2] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(46)) - 21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F->b6de9022-5a0e-4aec-a94e-4e214b276ef3: nextIndex: updateUnconditionally 0 -> 0
2021-10-05 13:25:10,835 [grpc-default-executor-3] INFO  server.RaftServer$Division (RaftServerImpl.java:notifyStateMachineToInstallSnapshot(1611)) - b6de9022-5a0e-4aec-a94e-4e214b276ef3@group-5AA8DAB94A1F: Snapshot Installation by StateMachine is in progress.
2021-10-05 13:25:10,835 [grpc-default-executor-3] INFO  server.RaftServer$Division (RaftServerImpl.java:installSnapshotImpl(1459)) - b6de9022-5a0e-4aec-a94e-4e214b276ef3@group-5AA8DAB94A1F: set new configuration index: 5
configurationEntry {
  peers {
    id: "21490b65-0a55-46f3-b94a-dd719a327c14"
    address: "localhost:13528"
  }
  peers {
    id: "6d234f4d-474a-4c74-a9e9-8f3885fce584"
    address: "localhost:13538"
  }
}
 from snapshot
2021-10-05 13:25:10,838 [grpc-default-executor-3] INFO  server.RaftServer$Division (ServerState.java:setRaftConf(387)) - b6de9022-5a0e-4aec-a94e-4e214b276ef3@group-5AA8DAB94A1F: set configuration 5: [21490b65-0a55-46f3-b94a-dd719a327c14|rpc:localhost:13528|admin:|client:|dataStream:|priority:0, 6d234f4d-474a-4c74-a9e9-8f3885fce584|rpc:localhost:13538|admin:|client:|dataStream:|priority:0], old=null
2021-10-05 13:25:10,838 [grpc-default-executor-3] INFO  server.RaftServer$Division (RaftServerImpl.java:installSnapshot(1340)) - b6de9022-5a0e-4aec-a94e-4e214b276ef3@group-5AA8DAB94A1F: reply installSnapshot: 21490b65-0a55-46f3-b94a-dd719a327c14<-b6de9022-5a0e-4aec-a94e-4e214b276ef3#0:FAIL-t2,IN_PROGRESS
2021-10-05 13:25:10,838 [grpc-default-executor-3] INFO  server.GrpcServerProtocolService (GrpcServerProtocolService.java:onCompleted(140)) - b6de9022-5a0e-4aec-a94e-4e214b276ef3: Completed INSTALL_SNAPSHOT, lastRequest: 21490b65-0a55-46f3-b94a-dd719a327c14->b6de9022-5a0e-4aec-a94e-4e214b276ef3#0-t2,notify:(t:2, i:1)
2021-10-05 13:25:10,847 [grpc-default-executor-3] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onNext(400)) - 21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F->b6de9022-5a0e-4aec-a94e-4e214b276ef3-InstallSnapshotResponseHandler: received a reply 21490b65-0a55-46f3-b94a-dd719a327c14<-b6de9022-5a0e-4aec-a94e-4e214b276ef3#0:FAIL-t2,IN_PROGRESS
2021-10-05 13:25:10,847 [grpc-default-executor-3] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onNext(417)) - 21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F->b6de9022-5a0e-4aec-a94e-4e214b276ef3-InstallSnapshotResponseHandler: InstallSnapshot in progress.
2021-10-05 13:25:10,851 [21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F->b6de9022-5a0e-4aec-a94e-4e214b276ef3-GrpcLogAppender-LogAppenderDaemon] INFO  server.GrpcLogAppender (GrpcLogAppender.java:installSnapshot(524)) - 21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F->b6de9022-5a0e-4aec-a94e-4e214b276ef3-GrpcLogAppender: followerNextIndex = 0 but logStartIndex = 1, notify follower to install snapshot-(t:2, i:1)
2021-10-05 13:25:10,851 [21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F->b6de9022-5a0e-4aec-a94e-4e214b276ef3-GrpcLogAppender-LogAppenderDaemon] INFO  server.GrpcLogAppender (GrpcLogAppender.java:installSnapshot(532)) - 21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F->b6de9022-5a0e-4aec-a94e-4e214b276ef3-GrpcLogAppender: send 21490b65-0a55-46f3-b94a-dd719a327c14->b6de9022-5a0e-4aec-a94e-4e214b276ef3#0-t2,notify:(t:2, i:1)
2021-10-05 13:25:10,854 [grpc-default-executor-0] INFO  server.RaftServer$Division (RaftServerImpl.java:installSnapshot(1329)) - b6de9022-5a0e-4aec-a94e-4e214b276ef3@group-5AA8DAB94A1F: receive installSnapshot: 21490b65-0a55-46f3-b94a-dd719a327c14->b6de9022-5a0e-4aec-a94e-4e214b276ef3#0-t2,notify:(t:2, i:1)
2021-10-05 13:25:10,854 [grpc-default-executor-0] INFO  server.RaftServer$Division (RaftServerImpl.java:notifyStateMachineToInstallSnapshot(1611)) - b6de9022-5a0e-4aec-a94e-4e214b276ef3@group-5AA8DAB94A1F: Snapshot Installation by StateMachine is in progress.
2021-10-05 13:25:10,854 [grpc-default-executor-0] INFO  server.RaftServer$Division (RaftServerImpl.java:installSnapshotImpl(1459)) - b6de9022-5a0e-4aec-a94e-4e214b276ef3@group-5AA8DAB94A1F: set new configuration index: 5
configurationEntry {
  peers {
    id: "21490b65-0a55-46f3-b94a-dd719a327c14"
    address: "localhost:13528"
  }
  peers {
    id: "6d234f4d-474a-4c74-a9e9-8f3885fce584"
    address: "localhost:13538"
  }
}
 from snapshot
2021-10-05 13:25:10,855 [grpc-default-executor-0] INFO  server.RaftServer$Division (ServerState.java:setRaftConf(387)) - b6de9022-5a0e-4aec-a94e-4e214b276ef3@group-5AA8DAB94A1F: set configuration 5: [21490b65-0a55-46f3-b94a-dd719a327c14|rpc:localhost:13528|admin:|client:|dataStream:|priority:0, 6d234f4d-474a-4c74-a9e9-8f3885fce584|rpc:localhost:13538|admin:|client:|dataStream:|priority:0], old=null
2021-10-05 13:25:10,855 [grpc-default-executor-1] INFO  server.RaftServer$Division (RaftServerImpl.java:checkInconsistentAppendEntries(1293)) - b6de9022-5a0e-4aec-a94e-4e214b276ef3@group-5AA8DAB94A1F: Failed appendEntries as snapshot ((t:2, i:1)) installation is in progress
2021-10-05 13:25:10,855 [grpc-default-executor-0] INFO  server.RaftServer$Division (RaftServerImpl.java:installSnapshot(1340)) - b6de9022-5a0e-4aec-a94e-4e214b276ef3@group-5AA8DAB94A1F: reply installSnapshot: 21490b65-0a55-46f3-b94a-dd719a327c14<-b6de9022-5a0e-4aec-a94e-4e214b276ef3#0:FAIL-t2,IN_PROGRESS
2021-10-05 13:25:10,855 [grpc-default-executor-1] INFO  server.RaftServer$Division (RaftServerImpl.java:checkInconsistentAppendEntries(1285)) - b6de9022-5a0e-4aec-a94e-4e214b276ef3@group-5AA8DAB94A1F: inconsistency entries. Reply:21490b65-0a55-46f3-b94a-dd719a327c14<-b6de9022-5a0e-4aec-a94e-4e214b276ef3#1:FAIL-t2,INCONSISTENCY,nextIndex=0,followerCommit=-1
2021-10-05 13:25:10,855 [grpc-default-executor-0] INFO  server.GrpcServerProtocolService (GrpcServerProtocolService.java:onCompleted(140)) - b6de9022-5a0e-4aec-a94e-4e214b276ef3: Completed INSTALL_SNAPSHOT, lastRequest: 21490b65-0a55-46f3-b94a-dd719a327c14->b6de9022-5a0e-4aec-a94e-4e214b276ef3#0-t2,notify:(t:2, i:1)
2021-10-05 13:25:10,857 [grpc-default-executor-2] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onNext(400)) - 21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F->b6de9022-5a0e-4aec-a94e-4e214b276ef3-InstallSnapshotResponseHandler: received a reply 21490b65-0a55-46f3-b94a-dd719a327c14<-b6de9022-5a0e-4aec-a94e-4e214b276ef3#0:FAIL-t2,IN_PROGRESS
2021-10-05 13:25:10,857 [grpc-default-executor-2] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onNext(417)) - 21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F->b6de9022-5a0e-4aec-a94e-4e214b276ef3-InstallSnapshotResponseHandler: InstallSnapshot in progress.
2021-10-05 13:25:10,858 [grpc-default-executor-0] INFO  ha.SCMDBCheckpointProvider (SCMDBCheckpointProvider.java:writeDBCheckPointToSream(48)) - Received request to obtain SCM DB checkpoint snapshot
2021-10-05 13:25:10,864 [21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F->b6de9022-5a0e-4aec-a94e-4e214b276ef3-GrpcLogAppender-LogAppenderDaemon] INFO  server.GrpcLogAppender (GrpcLogAppender.java:installSnapshot(524)) - 21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F->b6de9022-5a0e-4aec-a94e-4e214b276ef3-GrpcLogAppender: followerNextIndex = 0 but logStartIndex = 1, notify follower to install snapshot-(t:2, i:1)
2021-10-05 13:25:10,864 [21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F->b6de9022-5a0e-4aec-a94e-4e214b276ef3-GrpcLogAppender-LogAppenderDaemon] INFO  server.GrpcLogAppender (GrpcLogAppender.java:installSnapshot(532)) - 21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F->b6de9022-5a0e-4aec-a94e-4e214b276ef3-GrpcLogAppender: send 21490b65-0a55-46f3-b94a-dd719a327c14->b6de9022-5a0e-4aec-a94e-4e214b276ef3#0-t2,notify:(t:2, i:1)
2021-10-05 13:25:10,868 [grpc-default-executor-1] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(46)) - 21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F->b6de9022-5a0e-4aec-a94e-4e214b276ef3: nextIndex: updateUnconditionally 0 -> 0
2021-10-05 13:25:10,876 [grpc-default-executor-1] INFO  server.RaftServer$Division (RaftServerImpl.java:installSnapshot(1329)) - b6de9022-5a0e-4aec-a94e-4e214b276ef3@group-5AA8DAB94A1F: receive installSnapshot: 21490b65-0a55-46f3-b94a-dd719a327c14->b6de9022-5a0e-4aec-a94e-4e214b276ef3#0-t2,notify:(t:2, i:1)
2021-10-05 13:25:10,876 [grpc-default-executor-1] INFO  server.RaftServer$Division (RaftServerImpl.java:notifyStateMachineToInstallSnapshot(1611)) - b6de9022-5a0e-4aec-a94e-4e214b276ef3@group-5AA8DAB94A1F: Snapshot Installation by StateMachine is in progress.
2021-10-05 13:25:10,876 [grpc-default-executor-1] INFO  server.RaftServer$Division (RaftServerImpl.java:installSnapshotImpl(1459)) - b6de9022-5a0e-4aec-a94e-4e214b276ef3@group-5AA8DAB94A1F: set new configuration index: 5
configurationEntry {
  peers {
    id: "21490b65-0a55-46f3-b94a-dd719a327c14"
    address: "localhost:13528"
  }
  peers {
    id: "6d234f4d-474a-4c74-a9e9-8f3885fce584"
    address: "localhost:13538"
  }
}
 from snapshot
2021-10-05 13:25:10,876 [grpc-default-executor-1] INFO  server.RaftServer$Division (ServerState.java:setRaftConf(387)) - b6de9022-5a0e-4aec-a94e-4e214b276ef3@group-5AA8DAB94A1F: set configuration 5: [21490b65-0a55-46f3-b94a-dd719a327c14|rpc:localhost:13528|admin:|client:|dataStream:|priority:0, 6d234f4d-474a-4c74-a9e9-8f3885fce584|rpc:localhost:13538|admin:|client:|dataStream:|priority:0], old=null
2021-10-05 13:25:10,877 [grpc-default-executor-1] INFO  server.RaftServer$Division (RaftServerImpl.java:installSnapshot(1340)) - b6de9022-5a0e-4aec-a94e-4e214b276ef3@group-5AA8DAB94A1F: reply installSnapshot: 21490b65-0a55-46f3-b94a-dd719a327c14<-b6de9022-5a0e-4aec-a94e-4e214b276ef3#0:FAIL-t2,IN_PROGRESS
2021-10-05 13:25:10,877 [grpc-default-executor-1] INFO  server.GrpcServerProtocolService (GrpcServerProtocolService.java:onCompleted(140)) - b6de9022-5a0e-4aec-a94e-4e214b276ef3: Completed INSTALL_SNAPSHOT, lastRequest: 21490b65-0a55-46f3-b94a-dd719a327c14->b6de9022-5a0e-4aec-a94e-4e214b276ef3#0-t2,notify:(t:2, i:1)
2021-10-05 13:25:10,879 [grpc-default-executor-2] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onNext(400)) - 21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F->b6de9022-5a0e-4aec-a94e-4e214b276ef3-InstallSnapshotResponseHandler: received a reply 21490b65-0a55-46f3-b94a-dd719a327c14<-b6de9022-5a0e-4aec-a94e-4e214b276ef3#0:FAIL-t2,IN_PROGRESS
2021-10-05 13:25:10,879 [grpc-default-executor-2] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onNext(417)) - 21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F->b6de9022-5a0e-4aec-a94e-4e214b276ef3-InstallSnapshotResponseHandler: InstallSnapshot in progress.
2021-10-05 13:25:10,880 [21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F->b6de9022-5a0e-4aec-a94e-4e214b276ef3-GrpcLogAppender-LogAppenderDaemon] INFO  server.GrpcLogAppender (GrpcLogAppender.java:installSnapshot(524)) - 21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F->b6de9022-5a0e-4aec-a94e-4e214b276ef3-GrpcLogAppender: followerNextIndex = 0 but logStartIndex = 1, notify follower to install snapshot-(t:2, i:1)
2021-10-05 13:25:10,880 [21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F->b6de9022-5a0e-4aec-a94e-4e214b276ef3-GrpcLogAppender-LogAppenderDaemon] INFO  server.GrpcLogAppender (GrpcLogAppender.java:installSnapshot(532)) - 21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F->b6de9022-5a0e-4aec-a94e-4e214b276ef3-GrpcLogAppender: send 21490b65-0a55-46f3-b94a-dd719a327c14->b6de9022-5a0e-4aec-a94e-4e214b276ef3#0-t2,notify:(t:2, i:1)
2021-10-05 13:25:10,882 [grpc-default-executor-1] INFO  server.RaftServer$Division (RaftServerImpl.java:installSnapshot(1329)) - b6de9022-5a0e-4aec-a94e-4e214b276ef3@group-5AA8DAB94A1F: receive installSnapshot: 21490b65-0a55-46f3-b94a-dd719a327c14->b6de9022-5a0e-4aec-a94e-4e214b276ef3#0-t2,notify:(t:2, i:1)
2021-10-05 13:25:10,882 [grpc-default-executor-1] INFO  server.RaftServer$Division (RaftServerImpl.java:notifyStateMachineToInstallSnapshot(1611)) - b6de9022-5a0e-4aec-a94e-4e214b276ef3@group-5AA8DAB94A1F: Snapshot Installation by StateMachine is in progress.
2021-10-05 13:25:10,883 [grpc-default-executor-1] INFO  server.RaftServer$Division (RaftServerImpl.java:installSnapshotImpl(1459)) - b6de9022-5a0e-4aec-a94e-4e214b276ef3@group-5AA8DAB94A1F: set new configuration index: 5
configurationEntry {
  peers {
    id: "21490b65-0a55-46f3-b94a-dd719a327c14"
    address: "localhost:13528"
  }
  peers {
    id: "6d234f4d-474a-4c74-a9e9-8f3885fce584"
    address: "localhost:13538"
  }
}
 from snapshot
2021-10-05 13:25:10,883 [grpc-default-executor-1] INFO  server.RaftServer$Division (ServerState.java:setRaftConf(387)) - b6de9022-5a0e-4aec-a94e-4e214b276ef3@group-5AA8DAB94A1F: set configuration 5: [21490b65-0a55-46f3-b94a-dd719a327c14|rpc:localhost:13528|admin:|client:|dataStream:|priority:0, 6d234f4d-474a-4c74-a9e9-8f3885fce584|rpc:localhost:13538|admin:|client:|dataStream:|priority:0], old=null
2021-10-05 13:25:10,883 [grpc-default-executor-1] INFO  server.RaftServer$Division (RaftServerImpl.java:installSnapshot(1340)) - b6de9022-5a0e-4aec-a94e-4e214b276ef3@group-5AA8DAB94A1F: reply installSnapshot: 21490b65-0a55-46f3-b94a-dd719a327c14<-b6de9022-5a0e-4aec-a94e-4e214b276ef3#0:FAIL-t2,IN_PROGRESS
2021-10-05 13:25:10,883 [grpc-default-executor-1] INFO  server.GrpcServerProtocolService (GrpcServerProtocolService.java:onCompleted(140)) - b6de9022-5a0e-4aec-a94e-4e214b276ef3: Completed INSTALL_SNAPSHOT, lastRequest: 21490b65-0a55-46f3-b94a-dd719a327c14->b6de9022-5a0e-4aec-a94e-4e214b276ef3#0-t2,notify:(t:2, i:1)
2021-10-05 13:25:10,884 [grpc-default-executor-2] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onNext(400)) - 21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F->b6de9022-5a0e-4aec-a94e-4e214b276ef3-InstallSnapshotResponseHandler: received a reply 21490b65-0a55-46f3-b94a-dd719a327c14<-b6de9022-5a0e-4aec-a94e-4e214b276ef3#0:FAIL-t2,IN_PROGRESS
2021-10-05 13:25:10,884 [grpc-default-executor-2] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onNext(417)) - 21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F->b6de9022-5a0e-4aec-a94e-4e214b276ef3-InstallSnapshotResponseHandler: InstallSnapshot in progress.
2021-10-05 13:25:10,891 [grpc-default-executor-5] INFO  server.RaftServer$Division (RaftServerImpl.java:checkInconsistentAppendEntries(1293)) - b6de9022-5a0e-4aec-a94e-4e214b276ef3@group-5AA8DAB94A1F: Failed appendEntries as snapshot ((t:2, i:1)) installation is in progress
2021-10-05 13:25:10,891 [grpc-default-executor-5] INFO  server.RaftServer$Division (RaftServerImpl.java:checkInconsistentAppendEntries(1285)) - b6de9022-5a0e-4aec-a94e-4e214b276ef3@group-5AA8DAB94A1F: inconsistency entries. Reply:21490b65-0a55-46f3-b94a-dd719a327c14<-b6de9022-5a0e-4aec-a94e-4e214b276ef3#2:FAIL-t2,INCONSISTENCY,nextIndex=0,followerCommit=-1
2021-10-05 13:25:10,892 [grpc-default-executor-2] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(46)) - 21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F->b6de9022-5a0e-4aec-a94e-4e214b276ef3: nextIndex: updateUnconditionally 0 -> 0
2021-10-05 13:25:10,892 [grpc-default-executor-5] INFO  server.RaftServer$Division (RaftServerImpl.java:checkInconsistentAppendEntries(1293)) - b6de9022-5a0e-4aec-a94e-4e214b276ef3@group-5AA8DAB94A1F: Failed appendEntries as snapshot ((t:2, i:1)) installation is in progress
2021-10-05 13:25:10,892 [grpc-default-executor-5] INFO  server.RaftServer$Division (RaftServerImpl.java:checkInconsistentAppendEntries(1285)) - b6de9022-5a0e-4aec-a94e-4e214b276ef3@group-5AA8DAB94A1F: inconsistency entries. Reply:21490b65-0a55-46f3-b94a-dd719a327c14<-b6de9022-5a0e-4aec-a94e-4e214b276ef3#3:FAIL-t2,INCONSISTENCY,nextIndex=0,followerCommit=-1
2021-10-05 13:25:10,893 [grpc-default-executor-5] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(46)) - 21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F->b6de9022-5a0e-4aec-a94e-4e214b276ef3: nextIndex: updateUnconditionally 0 -> 0
2021-10-05 13:25:10,895 [21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F->b6de9022-5a0e-4aec-a94e-4e214b276ef3-GrpcLogAppender-LogAppenderDaemon] INFO  server.GrpcLogAppender (GrpcLogAppender.java:installSnapshot(524)) - 21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F->b6de9022-5a0e-4aec-a94e-4e214b276ef3-GrpcLogAppender: followerNextIndex = 0 but logStartIndex = 1, notify follower to install snapshot-(t:2, i:1)
2021-10-05 13:25:10,895 [21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F->b6de9022-5a0e-4aec-a94e-4e214b276ef3-GrpcLogAppender-LogAppenderDaemon] INFO  server.GrpcLogAppender (GrpcLogAppender.java:installSnapshot(532)) - 21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F->b6de9022-5a0e-4aec-a94e-4e214b276ef3-GrpcLogAppender: send 21490b65-0a55-46f3-b94a-dd719a327c14->b6de9022-5a0e-4aec-a94e-4e214b276ef3#0-t2,notify:(t:2, i:1)
2021-10-05 13:25:10,893 [grpc-default-executor-0] INFO  db.RDBCheckpointManager (RDBCheckpointManager.java:createCheckpoint(86)) - Created checkpoint at /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-36b87918-66c6-4e2c-9c49-5aa8dab94a1f/scmNode-1/db.checkpoints/scm.db_checkpoint_1633440310863 in 30 milliseconds
2021-10-05 13:25:10,896 [grpc-default-executor-5] INFO  server.RaftServer$Division (RaftServerImpl.java:checkInconsistentAppendEntries(1293)) - b6de9022-5a0e-4aec-a94e-4e214b276ef3@group-5AA8DAB94A1F: Failed appendEntries as snapshot ((t:2, i:1)) installation is in progress
2021-10-05 13:25:10,896 [grpc-default-executor-5] INFO  server.RaftServer$Division (RaftServerImpl.java:checkInconsistentAppendEntries(1285)) - b6de9022-5a0e-4aec-a94e-4e214b276ef3@group-5AA8DAB94A1F: inconsistency entries. Reply:21490b65-0a55-46f3-b94a-dd719a327c14<-b6de9022-5a0e-4aec-a94e-4e214b276ef3#4:FAIL-t2,INCONSISTENCY,nextIndex=0,followerCommit=-1
2021-10-05 13:25:10,896 [grpc-default-executor-2] INFO  server.RaftServer$Division (RaftServerImpl.java:installSnapshot(1329)) - b6de9022-5a0e-4aec-a94e-4e214b276ef3@group-5AA8DAB94A1F: receive installSnapshot: 21490b65-0a55-46f3-b94a-dd719a327c14->b6de9022-5a0e-4aec-a94e-4e214b276ef3#0-t2,notify:(t:2, i:1)
2021-10-05 13:25:10,896 [grpc-default-executor-2] INFO  server.RaftServer$Division (RaftServerImpl.java:notifyStateMachineToInstallSnapshot(1611)) - b6de9022-5a0e-4aec-a94e-4e214b276ef3@group-5AA8DAB94A1F: Snapshot Installation by StateMachine is in progress.
2021-10-05 13:25:10,896 [grpc-default-executor-2] INFO  server.RaftServer$Division (RaftServerImpl.java:installSnapshotImpl(1459)) - b6de9022-5a0e-4aec-a94e-4e214b276ef3@group-5AA8DAB94A1F: set new configuration index: 5
configurationEntry {
  peers {
    id: "21490b65-0a55-46f3-b94a-dd719a327c14"
    address: "localhost:13528"
  }
  peers {
    id: "6d234f4d-474a-4c74-a9e9-8f3885fce584"
    address: "localhost:13538"
  }
}
 from snapshot
2021-10-05 13:25:10,896 [grpc-default-executor-2] INFO  server.RaftServer$Division (ServerState.java:setRaftConf(387)) - b6de9022-5a0e-4aec-a94e-4e214b276ef3@group-5AA8DAB94A1F: set configuration 5: [21490b65-0a55-46f3-b94a-dd719a327c14|rpc:localhost:13528|admin:|client:|dataStream:|priority:0, 6d234f4d-474a-4c74-a9e9-8f3885fce584|rpc:localhost:13538|admin:|client:|dataStream:|priority:0], old=null
2021-10-05 13:25:10,896 [grpc-default-executor-2] INFO  server.RaftServer$Division (RaftServerImpl.java:installSnapshot(1340)) - b6de9022-5a0e-4aec-a94e-4e214b276ef3@group-5AA8DAB94A1F: reply installSnapshot: 21490b65-0a55-46f3-b94a-dd719a327c14<-b6de9022-5a0e-4aec-a94e-4e214b276ef3#0:FAIL-t2,IN_PROGRESS
2021-10-05 13:25:10,897 [grpc-default-executor-2] INFO  server.GrpcServerProtocolService (GrpcServerProtocolService.java:onCompleted(140)) - b6de9022-5a0e-4aec-a94e-4e214b276ef3: Completed INSTALL_SNAPSHOT, lastRequest: 21490b65-0a55-46f3-b94a-dd719a327c14->b6de9022-5a0e-4aec-a94e-4e214b276ef3#0-t2,notify:(t:2, i:1)
2021-10-05 13:25:10,898 [grpc-default-executor-2] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onNext(400)) - 21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F->b6de9022-5a0e-4aec-a94e-4e214b276ef3-InstallSnapshotResponseHandler: received a reply 21490b65-0a55-46f3-b94a-dd719a327c14<-b6de9022-5a0e-4aec-a94e-4e214b276ef3#0:FAIL-t2,IN_PROGRESS
2021-10-05 13:25:10,898 [grpc-default-executor-2] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onNext(417)) - 21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F->b6de9022-5a0e-4aec-a94e-4e214b276ef3-InstallSnapshotResponseHandler: InstallSnapshot in progress.
2021-10-05 13:25:10,897 [grpc-default-executor-0] INFO  ha.SCMGrpcOutputStream (SCMGrpcOutputStream.java:close(111)) - Sent 6065 bytes for cluster 36b87918-66c6-4e2c-9c49-5aa8dab94a1f
2021-10-05 13:25:10,905 [grpc-default-executor-0] INFO  ha.SCMDBCheckpointProvider (SCMDBCheckpointProvider.java:writeDBCheckPointToSream(73)) - Time taken to write the checkpoint to response output stream: 10 milliseconds
2021-10-05 13:25:10,906 [21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F->b6de9022-5a0e-4aec-a94e-4e214b276ef3-GrpcLogAppender-LogAppenderDaemon] INFO  server.GrpcLogAppender (GrpcLogAppender.java:installSnapshot(524)) - 21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F->b6de9022-5a0e-4aec-a94e-4e214b276ef3-GrpcLogAppender: followerNextIndex = 0 but logStartIndex = 1, notify follower to install snapshot-(t:2, i:1)
2021-10-05 13:25:10,906 [21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F->b6de9022-5a0e-4aec-a94e-4e214b276ef3-GrpcLogAppender-LogAppenderDaemon] INFO  server.GrpcLogAppender (GrpcLogAppender.java:installSnapshot(532)) - 21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F->b6de9022-5a0e-4aec-a94e-4e214b276ef3-GrpcLogAppender: send 21490b65-0a55-46f3-b94a-dd719a327c14->b6de9022-5a0e-4aec-a94e-4e214b276ef3#0-t2,notify:(t:2, i:1)
2021-10-05 13:25:10,907 [grpc-default-executor-4] INFO  server.RaftServer$Division (RaftServerImpl.java:checkInconsistentAppendEntries(1293)) - b6de9022-5a0e-4aec-a94e-4e214b276ef3@group-5AA8DAB94A1F: Failed appendEntries as snapshot ((t:2, i:1)) installation is in progress
2021-10-05 13:25:10,907 [grpc-default-executor-4] INFO  server.RaftServer$Division (RaftServerImpl.java:checkInconsistentAppendEntries(1285)) - b6de9022-5a0e-4aec-a94e-4e214b276ef3@group-5AA8DAB94A1F: inconsistency entries. Reply:21490b65-0a55-46f3-b94a-dd719a327c14<-b6de9022-5a0e-4aec-a94e-4e214b276ef3#5:FAIL-t2,INCONSISTENCY,nextIndex=0,followerCommit=-1
2021-10-05 13:25:10,907 [grpc-default-executor-4] INFO  server.RaftServer$Division (RaftServerImpl.java:installSnapshot(1329)) - b6de9022-5a0e-4aec-a94e-4e214b276ef3@group-5AA8DAB94A1F: receive installSnapshot: 21490b65-0a55-46f3-b94a-dd719a327c14->b6de9022-5a0e-4aec-a94e-4e214b276ef3#0-t2,notify:(t:2, i:1)
2021-10-05 13:25:10,907 [grpc-default-executor-4] INFO  server.RaftServer$Division (RaftServerImpl.java:notifyStateMachineToInstallSnapshot(1611)) - b6de9022-5a0e-4aec-a94e-4e214b276ef3@group-5AA8DAB94A1F: Snapshot Installation by StateMachine is in progress.
2021-10-05 13:25:10,907 [grpc-default-executor-4] INFO  server.RaftServer$Division (RaftServerImpl.java:installSnapshotImpl(1459)) - b6de9022-5a0e-4aec-a94e-4e214b276ef3@group-5AA8DAB94A1F: set new configuration index: 5
configurationEntry {
  peers {
    id: "21490b65-0a55-46f3-b94a-dd719a327c14"
    address: "localhost:13528"
  }
  peers {
    id: "6d234f4d-474a-4c74-a9e9-8f3885fce584"
    address: "localhost:13538"
  }
}
 from snapshot
2021-10-05 13:25:10,908 [grpc-default-executor-4] INFO  server.RaftServer$Division (ServerState.java:setRaftConf(387)) - b6de9022-5a0e-4aec-a94e-4e214b276ef3@group-5AA8DAB94A1F: set configuration 5: [21490b65-0a55-46f3-b94a-dd719a327c14|rpc:localhost:13528|admin:|client:|dataStream:|priority:0, 6d234f4d-474a-4c74-a9e9-8f3885fce584|rpc:localhost:13538|admin:|client:|dataStream:|priority:0], old=null
2021-10-05 13:25:10,908 [grpc-default-executor-4] INFO  server.RaftServer$Division (RaftServerImpl.java:installSnapshot(1340)) - b6de9022-5a0e-4aec-a94e-4e214b276ef3@group-5AA8DAB94A1F: reply installSnapshot: 21490b65-0a55-46f3-b94a-dd719a327c14<-b6de9022-5a0e-4aec-a94e-4e214b276ef3#0:FAIL-t2,IN_PROGRESS
2021-10-05 13:25:10,908 [grpc-default-executor-4] INFO  server.GrpcServerProtocolService (GrpcServerProtocolService.java:onCompleted(140)) - b6de9022-5a0e-4aec-a94e-4e214b276ef3: Completed INSTALL_SNAPSHOT, lastRequest: 21490b65-0a55-46f3-b94a-dd719a327c14->b6de9022-5a0e-4aec-a94e-4e214b276ef3#0-t2,notify:(t:2, i:1)
2021-10-05 13:25:10,909 [grpc-default-executor-4] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onNext(400)) - 21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F->b6de9022-5a0e-4aec-a94e-4e214b276ef3-InstallSnapshotResponseHandler: received a reply 21490b65-0a55-46f3-b94a-dd719a327c14<-b6de9022-5a0e-4aec-a94e-4e214b276ef3#0:FAIL-t2,IN_PROGRESS
2021-10-05 13:25:10,909 [grpc-default-executor-4] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onNext(417)) - 21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F->b6de9022-5a0e-4aec-a94e-4e214b276ef3-InstallSnapshotResponseHandler: InstallSnapshot in progress.
2021-10-05 13:25:10,910 [Datanode State Machine Thread - 0] ERROR datanode.RunningDatanodeState (RunningDatanodeState.java:computeNextContainerState(199)) - Error in executing end point task.
java.util.concurrent.ExecutionException: java.util.concurrent.TimeoutException
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.hadoop.ozone.container.common.states.datanode.RunningDatanodeState.computeNextContainerState(RunningDatanodeState.java:191)
	at org.apache.hadoop.ozone.container.common.states.datanode.RunningDatanodeState.await(RunningDatanodeState.java:231)
	at org.apache.hadoop.ozone.container.common.states.datanode.RunningDatanodeState.await(RunningDatanodeState.java:50)
	at org.apache.hadoop.ozone.container.common.statemachine.StateContext.execute(StateContext.java:629)
	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.start(DatanodeStateMachine.java:270)
	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.lambda$startDaemon$0(DatanodeStateMachine.java:457)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.util.concurrent.TimeoutException
	at java.util.concurrent.FutureTask.get(FutureTask.java:205)
	at org.apache.hadoop.ozone.container.common.states.datanode.RunningDatanodeState.lambda$execute$0(RunningDatanodeState.java:149)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
2021-10-05 13:25:10,905 [grpc-default-executor-0] INFO  db.RocksDBCheckpoint (RocksDBCheckpoint.java:cleanupCheckpoint(78)) - Cleaning up RocksDB checkpoint at /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-36b87918-66c6-4e2c-9c49-5aa8dab94a1f/scmNode-1/db.checkpoints/scm.db_checkpoint_1633440310863
2021-10-05 13:25:10,915 [grpc-default-executor-1] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(46)) - 21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F->b6de9022-5a0e-4aec-a94e-4e214b276ef3: nextIndex: updateUnconditionally 0 -> 0
2021-10-05 13:25:10,922 [21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F->b6de9022-5a0e-4aec-a94e-4e214b276ef3-GrpcLogAppender-LogAppenderDaemon] INFO  server.GrpcLogAppender (GrpcLogAppender.java:installSnapshot(524)) - 21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F->b6de9022-5a0e-4aec-a94e-4e214b276ef3-GrpcLogAppender: followerNextIndex = 0 but logStartIndex = 1, notify follower to install snapshot-(t:2, i:1)
2021-10-05 13:25:10,922 [21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F->b6de9022-5a0e-4aec-a94e-4e214b276ef3-GrpcLogAppender-LogAppenderDaemon] INFO  server.GrpcLogAppender (GrpcLogAppender.java:installSnapshot(532)) - 21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F->b6de9022-5a0e-4aec-a94e-4e214b276ef3-GrpcLogAppender: send 21490b65-0a55-46f3-b94a-dd719a327c14->b6de9022-5a0e-4aec-a94e-4e214b276ef3#0-t2,notify:(t:2, i:1)
2021-10-05 13:25:10,923 [grpc-default-executor-2] INFO  server.RaftServer$Division (RaftServerImpl.java:checkInconsistentAppendEntries(1293)) - b6de9022-5a0e-4aec-a94e-4e214b276ef3@group-5AA8DAB94A1F: Failed appendEntries as snapshot ((t:2, i:1)) installation is in progress
2021-10-05 13:25:10,923 [grpc-default-executor-0] INFO  server.RaftServer$Division (RaftServerImpl.java:installSnapshot(1329)) - b6de9022-5a0e-4aec-a94e-4e214b276ef3@group-5AA8DAB94A1F: receive installSnapshot: 21490b65-0a55-46f3-b94a-dd719a327c14->b6de9022-5a0e-4aec-a94e-4e214b276ef3#0-t2,notify:(t:2, i:1)
2021-10-05 13:25:10,923 [grpc-default-executor-2] INFO  server.RaftServer$Division (RaftServerImpl.java:checkInconsistentAppendEntries(1285)) - b6de9022-5a0e-4aec-a94e-4e214b276ef3@group-5AA8DAB94A1F: inconsistency entries. Reply:21490b65-0a55-46f3-b94a-dd719a327c14<-b6de9022-5a0e-4aec-a94e-4e214b276ef3#6:FAIL-t2,INCONSISTENCY,nextIndex=0,followerCommit=-1
2021-10-05 13:25:10,923 [grpc-default-executor-0] INFO  server.RaftServer$Division (RaftServerImpl.java:notifyStateMachineToInstallSnapshot(1611)) - b6de9022-5a0e-4aec-a94e-4e214b276ef3@group-5AA8DAB94A1F: Snapshot Installation by StateMachine is in progress.
2021-10-05 13:25:10,923 [grpc-default-executor-0] INFO  server.RaftServer$Division (RaftServerImpl.java:installSnapshotImpl(1459)) - b6de9022-5a0e-4aec-a94e-4e214b276ef3@group-5AA8DAB94A1F: set new configuration index: 5
configurationEntry {
  peers {
    id: "21490b65-0a55-46f3-b94a-dd719a327c14"
    address: "localhost:13528"
  }
  peers {
    id: "6d234f4d-474a-4c74-a9e9-8f3885fce584"
    address: "localhost:13538"
  }
}
 from snapshot
2021-10-05 13:25:10,924 [grpc-default-executor-0] INFO  server.RaftServer$Division (ServerState.java:setRaftConf(387)) - b6de9022-5a0e-4aec-a94e-4e214b276ef3@group-5AA8DAB94A1F: set configuration 5: [21490b65-0a55-46f3-b94a-dd719a327c14|rpc:localhost:13528|admin:|client:|dataStream:|priority:0, 6d234f4d-474a-4c74-a9e9-8f3885fce584|rpc:localhost:13538|admin:|client:|dataStream:|priority:0], old=null
2021-10-05 13:25:10,924 [grpc-default-executor-0] INFO  server.RaftServer$Division (RaftServerImpl.java:installSnapshot(1340)) - b6de9022-5a0e-4aec-a94e-4e214b276ef3@group-5AA8DAB94A1F: reply installSnapshot: 21490b65-0a55-46f3-b94a-dd719a327c14<-b6de9022-5a0e-4aec-a94e-4e214b276ef3#0:FAIL-t2,IN_PROGRESS
2021-10-05 13:25:10,924 [grpc-default-executor-0] INFO  server.GrpcServerProtocolService (GrpcServerProtocolService.java:onCompleted(140)) - b6de9022-5a0e-4aec-a94e-4e214b276ef3: Completed INSTALL_SNAPSHOT, lastRequest: 21490b65-0a55-46f3-b94a-dd719a327c14->b6de9022-5a0e-4aec-a94e-4e214b276ef3#0-t2,notify:(t:2, i:1)
2021-10-05 13:25:10,923 [grpc-default-executor-1] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(46)) - 21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F->b6de9022-5a0e-4aec-a94e-4e214b276ef3: nextIndex: updateUnconditionally 0 -> 0
2021-10-05 13:25:10,919 [grpc-default-executor-5] INFO  ha.InterSCMGrpcClient (InterSCMGrpcClient.java:onCompleted(173)) - Checkpoint is downloaded to /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-36b87918-66c6-4e2c-9c49-5aa8dab94a1f/scmNode-3/snapshot/scm.db-scmNode-1-1633440310818.tar.gz
2021-10-05 13:25:10,934 [grpc-default-executor-0] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(46)) - 21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F->b6de9022-5a0e-4aec-a94e-4e214b276ef3: nextIndex: updateUnconditionally 0 -> 0
2021-10-05 13:25:10,934 [grpc-default-executor-1] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onNext(400)) - 21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F->b6de9022-5a0e-4aec-a94e-4e214b276ef3-InstallSnapshotResponseHandler: received a reply 21490b65-0a55-46f3-b94a-dd719a327c14<-b6de9022-5a0e-4aec-a94e-4e214b276ef3#0:FAIL-t2,IN_PROGRESS
2021-10-05 13:25:10,934 [grpc-default-executor-1] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onNext(417)) - 21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F->b6de9022-5a0e-4aec-a94e-4e214b276ef3-InstallSnapshotResponseHandler: InstallSnapshot in progress.
2021-10-05 13:25:10,935 [21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F->b6de9022-5a0e-4aec-a94e-4e214b276ef3-GrpcLogAppender-LogAppenderDaemon] INFO  server.GrpcLogAppender (GrpcLogAppender.java:installSnapshot(524)) - 21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F->b6de9022-5a0e-4aec-a94e-4e214b276ef3-GrpcLogAppender: followerNextIndex = 0 but logStartIndex = 1, notify follower to install snapshot-(t:2, i:1)
2021-10-05 13:25:10,935 [21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F->b6de9022-5a0e-4aec-a94e-4e214b276ef3-GrpcLogAppender-LogAppenderDaemon] INFO  server.GrpcLogAppender (GrpcLogAppender.java:installSnapshot(532)) - 21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F->b6de9022-5a0e-4aec-a94e-4e214b276ef3-GrpcLogAppender: send 21490b65-0a55-46f3-b94a-dd719a327c14->b6de9022-5a0e-4aec-a94e-4e214b276ef3#0-t2,notify:(t:2, i:1)
2021-10-05 13:25:10,935 [grpc-default-executor-1] INFO  server.RaftServer$Division (RaftServerImpl.java:checkInconsistentAppendEntries(1293)) - b6de9022-5a0e-4aec-a94e-4e214b276ef3@group-5AA8DAB94A1F: Failed appendEntries as snapshot ((t:2, i:1)) installation is in progress
2021-10-05 13:25:10,935 [grpc-default-executor-1] INFO  server.RaftServer$Division (RaftServerImpl.java:checkInconsistentAppendEntries(1285)) - b6de9022-5a0e-4aec-a94e-4e214b276ef3@group-5AA8DAB94A1F: inconsistency entries. Reply:21490b65-0a55-46f3-b94a-dd719a327c14<-b6de9022-5a0e-4aec-a94e-4e214b276ef3#7:FAIL-t2,INCONSISTENCY,nextIndex=0,followerCommit=-1
2021-10-05 13:25:10,936 [grpc-default-executor-1] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(46)) - 21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F->b6de9022-5a0e-4aec-a94e-4e214b276ef3: nextIndex: updateUnconditionally 0 -> 0
2021-10-05 13:25:10,944 [grpc-default-executor-0] INFO  server.RaftServer$Division (RaftServerImpl.java:installSnapshot(1329)) - b6de9022-5a0e-4aec-a94e-4e214b276ef3@group-5AA8DAB94A1F: receive installSnapshot: 21490b65-0a55-46f3-b94a-dd719a327c14->b6de9022-5a0e-4aec-a94e-4e214b276ef3#0-t2,notify:(t:2, i:1)
2021-10-05 13:25:10,944 [grpc-default-executor-0] INFO  server.RaftServer$Division (RaftServerImpl.java:notifyStateMachineToInstallSnapshot(1611)) - b6de9022-5a0e-4aec-a94e-4e214b276ef3@group-5AA8DAB94A1F: Snapshot Installation by StateMachine is in progress.
2021-10-05 13:25:10,944 [grpc-default-executor-0] INFO  server.RaftServer$Division (RaftServerImpl.java:installSnapshotImpl(1459)) - b6de9022-5a0e-4aec-a94e-4e214b276ef3@group-5AA8DAB94A1F: set new configuration index: 5
configurationEntry {
  peers {
    id: "21490b65-0a55-46f3-b94a-dd719a327c14"
    address: "localhost:13528"
  }
  peers {
    id: "6d234f4d-474a-4c74-a9e9-8f3885fce584"
    address: "localhost:13538"
  }
}
 from snapshot
2021-10-05 13:25:10,944 [grpc-default-executor-0] INFO  server.RaftServer$Division (ServerState.java:setRaftConf(387)) - b6de9022-5a0e-4aec-a94e-4e214b276ef3@group-5AA8DAB94A1F: set configuration 5: [21490b65-0a55-46f3-b94a-dd719a327c14|rpc:localhost:13528|admin:|client:|dataStream:|priority:0, 6d234f4d-474a-4c74-a9e9-8f3885fce584|rpc:localhost:13538|admin:|client:|dataStream:|priority:0], old=null
2021-10-05 13:25:10,944 [grpc-default-executor-0] INFO  server.RaftServer$Division (RaftServerImpl.java:installSnapshot(1340)) - b6de9022-5a0e-4aec-a94e-4e214b276ef3@group-5AA8DAB94A1F: reply installSnapshot: 21490b65-0a55-46f3-b94a-dd719a327c14<-b6de9022-5a0e-4aec-a94e-4e214b276ef3#0:FAIL-t2,IN_PROGRESS
2021-10-05 13:25:10,944 [grpc-default-executor-0] INFO  server.GrpcServerProtocolService (GrpcServerProtocolService.java:onCompleted(140)) - b6de9022-5a0e-4aec-a94e-4e214b276ef3: Completed INSTALL_SNAPSHOT, lastRequest: 21490b65-0a55-46f3-b94a-dd719a327c14->b6de9022-5a0e-4aec-a94e-4e214b276ef3#0-t2,notify:(t:2, i:1)
2021-10-05 13:25:10,945 [grpc-default-executor-0] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onNext(400)) - 21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F->b6de9022-5a0e-4aec-a94e-4e214b276ef3-InstallSnapshotResponseHandler: received a reply 21490b65-0a55-46f3-b94a-dd719a327c14<-b6de9022-5a0e-4aec-a94e-4e214b276ef3#0:FAIL-t2,IN_PROGRESS
2021-10-05 13:25:10,945 [grpc-default-executor-0] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onNext(417)) - 21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F->b6de9022-5a0e-4aec-a94e-4e214b276ef3-InstallSnapshotResponseHandler: InstallSnapshot in progress.
2021-10-05 13:25:10,954 [21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F->b6de9022-5a0e-4aec-a94e-4e214b276ef3-GrpcLogAppender-LogAppenderDaemon] INFO  server.GrpcLogAppender (GrpcLogAppender.java:installSnapshot(524)) - 21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F->b6de9022-5a0e-4aec-a94e-4e214b276ef3-GrpcLogAppender: followerNextIndex = 0 but logStartIndex = 1, notify follower to install snapshot-(t:2, i:1)
2021-10-05 13:25:10,954 [21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F->b6de9022-5a0e-4aec-a94e-4e214b276ef3-GrpcLogAppender-LogAppenderDaemon] INFO  server.GrpcLogAppender (GrpcLogAppender.java:installSnapshot(532)) - 21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F->b6de9022-5a0e-4aec-a94e-4e214b276ef3-GrpcLogAppender: send 21490b65-0a55-46f3-b94a-dd719a327c14->b6de9022-5a0e-4aec-a94e-4e214b276ef3#0-t2,notify:(t:2, i:1)
2021-10-05 13:25:10,955 [grpc-default-executor-0] INFO  server.RaftServer$Division (RaftServerImpl.java:checkInconsistentAppendEntries(1293)) - b6de9022-5a0e-4aec-a94e-4e214b276ef3@group-5AA8DAB94A1F: Failed appendEntries as snapshot ((t:2, i:1)) installation is in progress
2021-10-05 13:25:10,955 [grpc-default-executor-0] INFO  server.RaftServer$Division (RaftServerImpl.java:checkInconsistentAppendEntries(1285)) - b6de9022-5a0e-4aec-a94e-4e214b276ef3@group-5AA8DAB94A1F: inconsistency entries. Reply:21490b65-0a55-46f3-b94a-dd719a327c14<-b6de9022-5a0e-4aec-a94e-4e214b276ef3#8:FAIL-t2,INCONSISTENCY,nextIndex=0,followerCommit=-1
2021-10-05 13:25:10,957 [pool-228-thread-1] INFO  ha.SCMSnapshotProvider (SCMSnapshotProvider.java:getSCMDBSnapshot(131)) - Successfully downloaded latest checkpoint from leader SCM: scmNode-1 path /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-36b87918-66c6-4e2c-9c49-5aa8dab94a1f/scmNode-3/snapshot/scm.db-scmNode-1-1633440310818
2021-10-05 13:25:10,958 [pool-228-thread-1] INFO  ha.SCMHAManagerImpl (SCMHAManagerImpl.java:downloadCheckpointFromLeader(158)) - Downloaded checkpoint from Leader scmNode-1 to the location /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-36b87918-66c6-4e2c-9c49-5aa8dab94a1f/scmNode-3/snapshot/scm.db-scmNode-1-1633440310818
2021-10-05 13:25:10,962 [grpc-default-executor-1] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(46)) - 21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F->b6de9022-5a0e-4aec-a94e-4e214b276ef3: nextIndex: updateUnconditionally 0 -> 0
2021-10-05 13:25:10,962 [grpc-default-executor-0] INFO  server.RaftServer$Division (RaftServerImpl.java:installSnapshot(1329)) - b6de9022-5a0e-4aec-a94e-4e214b276ef3@group-5AA8DAB94A1F: receive installSnapshot: 21490b65-0a55-46f3-b94a-dd719a327c14->b6de9022-5a0e-4aec-a94e-4e214b276ef3#0-t2,notify:(t:2, i:1)
2021-10-05 13:25:10,962 [grpc-default-executor-0] INFO  server.RaftServer$Division (RaftServerImpl.java:notifyStateMachineToInstallSnapshot(1611)) - b6de9022-5a0e-4aec-a94e-4e214b276ef3@group-5AA8DAB94A1F: Snapshot Installation by StateMachine is in progress.
2021-10-05 13:25:10,962 [grpc-default-executor-0] INFO  server.RaftServer$Division (RaftServerImpl.java:installSnapshotImpl(1459)) - b6de9022-5a0e-4aec-a94e-4e214b276ef3@group-5AA8DAB94A1F: set new configuration index: 5
configurationEntry {
  peers {
    id: "21490b65-0a55-46f3-b94a-dd719a327c14"
    address: "localhost:13528"
  }
  peers {
    id: "6d234f4d-474a-4c74-a9e9-8f3885fce584"
    address: "localhost:13538"
  }
}
 from snapshot
2021-10-05 13:25:10,962 [grpc-default-executor-0] INFO  server.RaftServer$Division (ServerState.java:setRaftConf(387)) - b6de9022-5a0e-4aec-a94e-4e214b276ef3@group-5AA8DAB94A1F: set configuration 5: [21490b65-0a55-46f3-b94a-dd719a327c14|rpc:localhost:13528|admin:|client:|dataStream:|priority:0, 6d234f4d-474a-4c74-a9e9-8f3885fce584|rpc:localhost:13538|admin:|client:|dataStream:|priority:0], old=null
2021-10-05 13:25:10,963 [grpc-default-executor-0] INFO  server.RaftServer$Division (RaftServerImpl.java:installSnapshot(1340)) - b6de9022-5a0e-4aec-a94e-4e214b276ef3@group-5AA8DAB94A1F: reply installSnapshot: 21490b65-0a55-46f3-b94a-dd719a327c14<-b6de9022-5a0e-4aec-a94e-4e214b276ef3#0:FAIL-t2,IN_PROGRESS
2021-10-05 13:25:10,963 [grpc-default-executor-0] INFO  server.GrpcServerProtocolService (GrpcServerProtocolService.java:onCompleted(140)) - b6de9022-5a0e-4aec-a94e-4e214b276ef3: Completed INSTALL_SNAPSHOT, lastRequest: 21490b65-0a55-46f3-b94a-dd719a327c14->b6de9022-5a0e-4aec-a94e-4e214b276ef3#0-t2,notify:(t:2, i:1)
2021-10-05 13:25:10,963 [grpc-default-executor-1] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onNext(400)) - 21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F->b6de9022-5a0e-4aec-a94e-4e214b276ef3-InstallSnapshotResponseHandler: received a reply 21490b65-0a55-46f3-b94a-dd719a327c14<-b6de9022-5a0e-4aec-a94e-4e214b276ef3#0:FAIL-t2,IN_PROGRESS
2021-10-05 13:25:10,964 [grpc-default-executor-1] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onNext(417)) - 21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F->b6de9022-5a0e-4aec-a94e-4e214b276ef3-InstallSnapshotResponseHandler: InstallSnapshot in progress.
2021-10-05 13:25:10,965 [21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F->b6de9022-5a0e-4aec-a94e-4e214b276ef3-GrpcLogAppender-LogAppenderDaemon] INFO  server.GrpcLogAppender (GrpcLogAppender.java:installSnapshot(524)) - 21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F->b6de9022-5a0e-4aec-a94e-4e214b276ef3-GrpcLogAppender: followerNextIndex = 0 but logStartIndex = 1, notify follower to install snapshot-(t:2, i:1)
2021-10-05 13:25:10,965 [grpc-default-executor-1] INFO  server.RaftServer$Division (RaftServerImpl.java:checkInconsistentAppendEntries(1293)) - b6de9022-5a0e-4aec-a94e-4e214b276ef3@group-5AA8DAB94A1F: Failed appendEntries as snapshot ((t:2, i:1)) installation is in progress
2021-10-05 13:25:10,965 [grpc-default-executor-1] INFO  server.RaftServer$Division (RaftServerImpl.java:checkInconsistentAppendEntries(1285)) - b6de9022-5a0e-4aec-a94e-4e214b276ef3@group-5AA8DAB94A1F: inconsistency entries. Reply:21490b65-0a55-46f3-b94a-dd719a327c14<-b6de9022-5a0e-4aec-a94e-4e214b276ef3#9:FAIL-t2,INCONSISTENCY,nextIndex=0,followerCommit=-1
2021-10-05 13:25:10,965 [grpc-default-executor-1] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(46)) - 21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F->b6de9022-5a0e-4aec-a94e-4e214b276ef3: nextIndex: updateUnconditionally 0 -> 0
2021-10-05 13:25:10,967 [21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F->b6de9022-5a0e-4aec-a94e-4e214b276ef3-GrpcLogAppender-LogAppenderDaemon] INFO  server.GrpcLogAppender (GrpcLogAppender.java:installSnapshot(532)) - 21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F->b6de9022-5a0e-4aec-a94e-4e214b276ef3-GrpcLogAppender: send 21490b65-0a55-46f3-b94a-dd719a327c14->b6de9022-5a0e-4aec-a94e-4e214b276ef3#0-t2,notify:(t:2, i:1)
2021-10-05 13:25:10,970 [grpc-default-executor-1] INFO  server.RaftServer$Division (RaftServerImpl.java:installSnapshot(1329)) - b6de9022-5a0e-4aec-a94e-4e214b276ef3@group-5AA8DAB94A1F: receive installSnapshot: 21490b65-0a55-46f3-b94a-dd719a327c14->b6de9022-5a0e-4aec-a94e-4e214b276ef3#0-t2,notify:(t:2, i:1)
2021-10-05 13:25:10,970 [grpc-default-executor-1] INFO  server.RaftServer$Division (RaftServerImpl.java:notifyStateMachineToInstallSnapshot(1611)) - b6de9022-5a0e-4aec-a94e-4e214b276ef3@group-5AA8DAB94A1F: Snapshot Installation by StateMachine is in progress.
2021-10-05 13:25:10,970 [grpc-default-executor-1] INFO  server.RaftServer$Division (RaftServerImpl.java:installSnapshotImpl(1459)) - b6de9022-5a0e-4aec-a94e-4e214b276ef3@group-5AA8DAB94A1F: set new configuration index: 5
configurationEntry {
  peers {
    id: "21490b65-0a55-46f3-b94a-dd719a327c14"
    address: "localhost:13528"
  }
  peers {
    id: "6d234f4d-474a-4c74-a9e9-8f3885fce584"
    address: "localhost:13538"
  }
}
 from snapshot
2021-10-05 13:25:10,971 [grpc-default-executor-1] INFO  server.RaftServer$Division (ServerState.java:setRaftConf(387)) - b6de9022-5a0e-4aec-a94e-4e214b276ef3@group-5AA8DAB94A1F: set configuration 5: [21490b65-0a55-46f3-b94a-dd719a327c14|rpc:localhost:13528|admin:|client:|dataStream:|priority:0, 6d234f4d-474a-4c74-a9e9-8f3885fce584|rpc:localhost:13538|admin:|client:|dataStream:|priority:0], old=null
2021-10-05 13:25:10,971 [grpc-default-executor-1] INFO  server.RaftServer$Division (RaftServerImpl.java:installSnapshot(1340)) - b6de9022-5a0e-4aec-a94e-4e214b276ef3@group-5AA8DAB94A1F: reply installSnapshot: 21490b65-0a55-46f3-b94a-dd719a327c14<-b6de9022-5a0e-4aec-a94e-4e214b276ef3#0:FAIL-t2,IN_PROGRESS
2021-10-05 13:25:10,971 [grpc-default-executor-1] INFO  server.GrpcServerProtocolService (GrpcServerProtocolService.java:onCompleted(140)) - b6de9022-5a0e-4aec-a94e-4e214b276ef3: Completed INSTALL_SNAPSHOT, lastRequest: 21490b65-0a55-46f3-b94a-dd719a327c14->b6de9022-5a0e-4aec-a94e-4e214b276ef3#0-t2,notify:(t:2, i:1)
2021-10-05 13:25:10,972 [grpc-default-executor-0] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onNext(400)) - 21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F->b6de9022-5a0e-4aec-a94e-4e214b276ef3-InstallSnapshotResponseHandler: received a reply 21490b65-0a55-46f3-b94a-dd719a327c14<-b6de9022-5a0e-4aec-a94e-4e214b276ef3#0:FAIL-t2,IN_PROGRESS
2021-10-05 13:25:10,972 [grpc-default-executor-0] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onNext(417)) - 21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F->b6de9022-5a0e-4aec-a94e-4e214b276ef3-InstallSnapshotResponseHandler: InstallSnapshot in progress.
2021-10-05 13:25:10,974 [21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F->b6de9022-5a0e-4aec-a94e-4e214b276ef3-GrpcLogAppender-LogAppenderDaemon] INFO  server.GrpcLogAppender (GrpcLogAppender.java:installSnapshot(524)) - 21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F->b6de9022-5a0e-4aec-a94e-4e214b276ef3-GrpcLogAppender: followerNextIndex = 0 but logStartIndex = 1, notify follower to install snapshot-(t:2, i:1)
2021-10-05 13:25:10,974 [21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F->b6de9022-5a0e-4aec-a94e-4e214b276ef3-GrpcLogAppender-LogAppenderDaemon] INFO  server.GrpcLogAppender (GrpcLogAppender.java:installSnapshot(532)) - 21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F->b6de9022-5a0e-4aec-a94e-4e214b276ef3-GrpcLogAppender: send 21490b65-0a55-46f3-b94a-dd719a327c14->b6de9022-5a0e-4aec-a94e-4e214b276ef3#0-t2,notify:(t:2, i:1)
2021-10-05 13:25:10,975 [grpc-default-executor-0] INFO  server.RaftServer$Division (RaftServerImpl.java:installSnapshot(1329)) - b6de9022-5a0e-4aec-a94e-4e214b276ef3@group-5AA8DAB94A1F: receive installSnapshot: 21490b65-0a55-46f3-b94a-dd719a327c14->b6de9022-5a0e-4aec-a94e-4e214b276ef3#0-t2,notify:(t:2, i:1)
2021-10-05 13:25:10,975 [grpc-default-executor-0] INFO  server.RaftServer$Division (RaftServerImpl.java:notifyStateMachineToInstallSnapshot(1611)) - b6de9022-5a0e-4aec-a94e-4e214b276ef3@group-5AA8DAB94A1F: Snapshot Installation by StateMachine is in progress.
2021-10-05 13:25:10,975 [grpc-default-executor-0] INFO  server.RaftServer$Division (RaftServerImpl.java:installSnapshotImpl(1459)) - b6de9022-5a0e-4aec-a94e-4e214b276ef3@group-5AA8DAB94A1F: set new configuration index: 5
configurationEntry {
  peers {
    id: "21490b65-0a55-46f3-b94a-dd719a327c14"
    address: "localhost:13528"
  }
  peers {
    id: "6d234f4d-474a-4c74-a9e9-8f3885fce584"
    address: "localhost:13538"
  }
}
 from snapshot
2021-10-05 13:25:10,975 [grpc-default-executor-0] INFO  server.RaftServer$Division (ServerState.java:setRaftConf(387)) - b6de9022-5a0e-4aec-a94e-4e214b276ef3@group-5AA8DAB94A1F: set configuration 5: [21490b65-0a55-46f3-b94a-dd719a327c14|rpc:localhost:13528|admin:|client:|dataStream:|priority:0, 6d234f4d-474a-4c74-a9e9-8f3885fce584|rpc:localhost:13538|admin:|client:|dataStream:|priority:0], old=null
2021-10-05 13:25:10,975 [grpc-default-executor-0] INFO  server.RaftServer$Division (RaftServerImpl.java:installSnapshot(1340)) - b6de9022-5a0e-4aec-a94e-4e214b276ef3@group-5AA8DAB94A1F: reply installSnapshot: 21490b65-0a55-46f3-b94a-dd719a327c14<-b6de9022-5a0e-4aec-a94e-4e214b276ef3#0:FAIL-t2,IN_PROGRESS
2021-10-05 13:25:10,976 [grpc-default-executor-0] INFO  server.GrpcServerProtocolService (GrpcServerProtocolService.java:onCompleted(140)) - b6de9022-5a0e-4aec-a94e-4e214b276ef3: Completed INSTALL_SNAPSHOT, lastRequest: 21490b65-0a55-46f3-b94a-dd719a327c14->b6de9022-5a0e-4aec-a94e-4e214b276ef3#0-t2,notify:(t:2, i:1)
2021-10-05 13:25:10,976 [grpc-default-executor-5] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onNext(400)) - 21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F->b6de9022-5a0e-4aec-a94e-4e214b276ef3-InstallSnapshotResponseHandler: received a reply 21490b65-0a55-46f3-b94a-dd719a327c14<-b6de9022-5a0e-4aec-a94e-4e214b276ef3#0:FAIL-t2,IN_PROGRESS
2021-10-05 13:25:10,976 [grpc-default-executor-5] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onNext(417)) - 21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F->b6de9022-5a0e-4aec-a94e-4e214b276ef3-InstallSnapshotResponseHandler: InstallSnapshot in progress.
2021-10-05 13:25:10,977 [21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F->b6de9022-5a0e-4aec-a94e-4e214b276ef3-GrpcLogAppender-LogAppenderDaemon] INFO  server.GrpcLogAppender (GrpcLogAppender.java:installSnapshot(524)) - 21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F->b6de9022-5a0e-4aec-a94e-4e214b276ef3-GrpcLogAppender: followerNextIndex = 0 but logStartIndex = 1, notify follower to install snapshot-(t:2, i:1)
2021-10-05 13:25:10,977 [21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F->b6de9022-5a0e-4aec-a94e-4e214b276ef3-GrpcLogAppender-LogAppenderDaemon] INFO  server.GrpcLogAppender (GrpcLogAppender.java:installSnapshot(532)) - 21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F->b6de9022-5a0e-4aec-a94e-4e214b276ef3-GrpcLogAppender: send 21490b65-0a55-46f3-b94a-dd719a327c14->b6de9022-5a0e-4aec-a94e-4e214b276ef3#0-t2,notify:(t:2, i:1)
2021-10-05 13:25:10,978 [grpc-default-executor-5] INFO  server.RaftServer$Division (RaftServerImpl.java:installSnapshot(1329)) - b6de9022-5a0e-4aec-a94e-4e214b276ef3@group-5AA8DAB94A1F: receive installSnapshot: 21490b65-0a55-46f3-b94a-dd719a327c14->b6de9022-5a0e-4aec-a94e-4e214b276ef3#0-t2,notify:(t:2, i:1)
2021-10-05 13:25:10,978 [grpc-default-executor-5] INFO  server.RaftServer$Division (RaftServerImpl.java:notifyStateMachineToInstallSnapshot(1611)) - b6de9022-5a0e-4aec-a94e-4e214b276ef3@group-5AA8DAB94A1F: Snapshot Installation by StateMachine is in progress.
2021-10-05 13:25:10,978 [grpc-default-executor-5] INFO  server.RaftServer$Division (RaftServerImpl.java:installSnapshotImpl(1459)) - b6de9022-5a0e-4aec-a94e-4e214b276ef3@group-5AA8DAB94A1F: set new configuration index: 5
configurationEntry {
  peers {
    id: "21490b65-0a55-46f3-b94a-dd719a327c14"
    address: "localhost:13528"
  }
  peers {
    id: "6d234f4d-474a-4c74-a9e9-8f3885fce584"
    address: "localhost:13538"
  }
}
 from snapshot
2021-10-05 13:25:10,978 [grpc-default-executor-5] INFO  server.RaftServer$Division (ServerState.java:setRaftConf(387)) - b6de9022-5a0e-4aec-a94e-4e214b276ef3@group-5AA8DAB94A1F: set configuration 5: [21490b65-0a55-46f3-b94a-dd719a327c14|rpc:localhost:13528|admin:|client:|dataStream:|priority:0, 6d234f4d-474a-4c74-a9e9-8f3885fce584|rpc:localhost:13538|admin:|client:|dataStream:|priority:0], old=null
2021-10-05 13:25:10,979 [grpc-default-executor-5] INFO  server.RaftServer$Division (RaftServerImpl.java:installSnapshot(1340)) - b6de9022-5a0e-4aec-a94e-4e214b276ef3@group-5AA8DAB94A1F: reply installSnapshot: 21490b65-0a55-46f3-b94a-dd719a327c14<-b6de9022-5a0e-4aec-a94e-4e214b276ef3#0:FAIL-t2,IN_PROGRESS
2021-10-05 13:25:10,979 [grpc-default-executor-5] INFO  server.GrpcServerProtocolService (GrpcServerProtocolService.java:onCompleted(140)) - b6de9022-5a0e-4aec-a94e-4e214b276ef3: Completed INSTALL_SNAPSHOT, lastRequest: 21490b65-0a55-46f3-b94a-dd719a327c14->b6de9022-5a0e-4aec-a94e-4e214b276ef3#0-t2,notify:(t:2, i:1)
2021-10-05 13:25:10,979 [grpc-default-executor-1] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onNext(400)) - 21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F->b6de9022-5a0e-4aec-a94e-4e214b276ef3-InstallSnapshotResponseHandler: received a reply 21490b65-0a55-46f3-b94a-dd719a327c14<-b6de9022-5a0e-4aec-a94e-4e214b276ef3#0:FAIL-t2,IN_PROGRESS
2021-10-05 13:25:10,979 [grpc-default-executor-1] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onNext(417)) - 21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F->b6de9022-5a0e-4aec-a94e-4e214b276ef3-InstallSnapshotResponseHandler: InstallSnapshot in progress.
2021-10-05 13:25:10,985 [21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F->b6de9022-5a0e-4aec-a94e-4e214b276ef3-GrpcLogAppender-LogAppenderDaemon] INFO  server.GrpcLogAppender (GrpcLogAppender.java:installSnapshot(524)) - 21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F->b6de9022-5a0e-4aec-a94e-4e214b276ef3-GrpcLogAppender: followerNextIndex = 0 but logStartIndex = 1, notify follower to install snapshot-(t:2, i:1)
2021-10-05 13:25:10,985 [21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F->b6de9022-5a0e-4aec-a94e-4e214b276ef3-GrpcLogAppender-LogAppenderDaemon] INFO  server.GrpcLogAppender (GrpcLogAppender.java:installSnapshot(532)) - 21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F->b6de9022-5a0e-4aec-a94e-4e214b276ef3-GrpcLogAppender: send 21490b65-0a55-46f3-b94a-dd719a327c14->b6de9022-5a0e-4aec-a94e-4e214b276ef3#0-t2,notify:(t:2, i:1)
2021-10-05 13:25:10,986 [grpc-default-executor-1] INFO  server.RaftServer$Division (RaftServerImpl.java:installSnapshot(1329)) - b6de9022-5a0e-4aec-a94e-4e214b276ef3@group-5AA8DAB94A1F: receive installSnapshot: 21490b65-0a55-46f3-b94a-dd719a327c14->b6de9022-5a0e-4aec-a94e-4e214b276ef3#0-t2,notify:(t:2, i:1)
2021-10-05 13:25:10,986 [grpc-default-executor-1] INFO  server.RaftServer$Division (RaftServerImpl.java:notifyStateMachineToInstallSnapshot(1611)) - b6de9022-5a0e-4aec-a94e-4e214b276ef3@group-5AA8DAB94A1F: Snapshot Installation by StateMachine is in progress.
2021-10-05 13:25:10,986 [grpc-default-executor-1] INFO  server.RaftServer$Division (RaftServerImpl.java:installSnapshotImpl(1459)) - b6de9022-5a0e-4aec-a94e-4e214b276ef3@group-5AA8DAB94A1F: set new configuration index: 5
configurationEntry {
  peers {
    id: "21490b65-0a55-46f3-b94a-dd719a327c14"
    address: "localhost:13528"
  }
  peers {
    id: "6d234f4d-474a-4c74-a9e9-8f3885fce584"
    address: "localhost:13538"
  }
}
 from snapshot
2021-10-05 13:25:10,986 [grpc-default-executor-1] INFO  server.RaftServer$Division (ServerState.java:setRaftConf(387)) - b6de9022-5a0e-4aec-a94e-4e214b276ef3@group-5AA8DAB94A1F: set configuration 5: [21490b65-0a55-46f3-b94a-dd719a327c14|rpc:localhost:13528|admin:|client:|dataStream:|priority:0, 6d234f4d-474a-4c74-a9e9-8f3885fce584|rpc:localhost:13538|admin:|client:|dataStream:|priority:0], old=null
2021-10-05 13:25:10,986 [grpc-default-executor-1] INFO  server.RaftServer$Division (RaftServerImpl.java:installSnapshot(1340)) - b6de9022-5a0e-4aec-a94e-4e214b276ef3@group-5AA8DAB94A1F: reply installSnapshot: 21490b65-0a55-46f3-b94a-dd719a327c14<-b6de9022-5a0e-4aec-a94e-4e214b276ef3#0:FAIL-t2,IN_PROGRESS
2021-10-05 13:25:10,986 [grpc-default-executor-1] INFO  server.GrpcServerProtocolService (GrpcServerProtocolService.java:onCompleted(140)) - b6de9022-5a0e-4aec-a94e-4e214b276ef3: Completed INSTALL_SNAPSHOT, lastRequest: 21490b65-0a55-46f3-b94a-dd719a327c14->b6de9022-5a0e-4aec-a94e-4e214b276ef3#0-t2,notify:(t:2, i:1)
2021-10-05 13:25:10,987 [grpc-default-executor-4] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onNext(400)) - 21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F->b6de9022-5a0e-4aec-a94e-4e214b276ef3-InstallSnapshotResponseHandler: received a reply 21490b65-0a55-46f3-b94a-dd719a327c14<-b6de9022-5a0e-4aec-a94e-4e214b276ef3#0:FAIL-t2,IN_PROGRESS
2021-10-05 13:25:10,987 [grpc-default-executor-4] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onNext(417)) - 21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F->b6de9022-5a0e-4aec-a94e-4e214b276ef3-InstallSnapshotResponseHandler: InstallSnapshot in progress.
2021-10-05 13:25:10,988 [grpc-default-executor-2] INFO  server.RaftServer$Division (RaftServerImpl.java:checkInconsistentAppendEntries(1293)) - b6de9022-5a0e-4aec-a94e-4e214b276ef3@group-5AA8DAB94A1F: Failed appendEntries as snapshot ((t:2, i:1)) installation is in progress
2021-10-05 13:25:10,988 [grpc-default-executor-2] INFO  server.RaftServer$Division (RaftServerImpl.java:checkInconsistentAppendEntries(1285)) - b6de9022-5a0e-4aec-a94e-4e214b276ef3@group-5AA8DAB94A1F: inconsistency entries. Reply:21490b65-0a55-46f3-b94a-dd719a327c14<-b6de9022-5a0e-4aec-a94e-4e214b276ef3#10:FAIL-t2,INCONSISTENCY,nextIndex=0,followerCommit=-1
2021-10-05 13:25:10,988 [21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F->b6de9022-5a0e-4aec-a94e-4e214b276ef3-GrpcLogAppender-LogAppenderDaemon] INFO  server.GrpcLogAppender (GrpcLogAppender.java:installSnapshot(524)) - 21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F->b6de9022-5a0e-4aec-a94e-4e214b276ef3-GrpcLogAppender: followerNextIndex = 0 but logStartIndex = 1, notify follower to install snapshot-(t:2, i:1)
2021-10-05 13:25:10,989 [21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F->b6de9022-5a0e-4aec-a94e-4e214b276ef3-GrpcLogAppender-LogAppenderDaemon] INFO  server.GrpcLogAppender (GrpcLogAppender.java:installSnapshot(532)) - 21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F->b6de9022-5a0e-4aec-a94e-4e214b276ef3-GrpcLogAppender: send 21490b65-0a55-46f3-b94a-dd719a327c14->b6de9022-5a0e-4aec-a94e-4e214b276ef3#0-t2,notify:(t:2, i:1)
2021-10-05 13:25:10,990 [grpc-default-executor-0] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(46)) - 21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F->b6de9022-5a0e-4aec-a94e-4e214b276ef3: nextIndex: updateUnconditionally 0 -> 0
2021-10-05 13:25:10,990 [grpc-default-executor-2] INFO  server.RaftServer$Division (RaftServerImpl.java:checkInconsistentAppendEntries(1293)) - b6de9022-5a0e-4aec-a94e-4e214b276ef3@group-5AA8DAB94A1F: Failed appendEntries as snapshot ((t:2, i:1)) installation is in progress
2021-10-05 13:25:10,990 [grpc-default-executor-2] INFO  server.RaftServer$Division (RaftServerImpl.java:checkInconsistentAppendEntries(1285)) - b6de9022-5a0e-4aec-a94e-4e214b276ef3@group-5AA8DAB94A1F: inconsistency entries. Reply:21490b65-0a55-46f3-b94a-dd719a327c14<-b6de9022-5a0e-4aec-a94e-4e214b276ef3#11:FAIL-t2,INCONSISTENCY,nextIndex=0,followerCommit=-1
2021-10-05 13:25:10,990 [grpc-default-executor-4] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(46)) - 21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F->b6de9022-5a0e-4aec-a94e-4e214b276ef3: nextIndex: updateUnconditionally 0 -> 0
2021-10-05 13:25:10,990 [grpc-default-executor-2] INFO  server.RaftServer$Division (RaftServerImpl.java:checkInconsistentAppendEntries(1293)) - b6de9022-5a0e-4aec-a94e-4e214b276ef3@group-5AA8DAB94A1F: Failed appendEntries as snapshot ((t:2, i:1)) installation is in progress
2021-10-05 13:25:10,991 [grpc-default-executor-2] INFO  server.RaftServer$Division (RaftServerImpl.java:checkInconsistentAppendEntries(1285)) - b6de9022-5a0e-4aec-a94e-4e214b276ef3@group-5AA8DAB94A1F: inconsistency entries. Reply:21490b65-0a55-46f3-b94a-dd719a327c14<-b6de9022-5a0e-4aec-a94e-4e214b276ef3#12:FAIL-t2,INCONSISTENCY,nextIndex=0,followerCommit=-1
2021-10-05 13:25:10,991 [grpc-default-executor-3] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(46)) - 21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F->b6de9022-5a0e-4aec-a94e-4e214b276ef3: nextIndex: updateUnconditionally 0 -> 0
2021-10-05 13:25:10,991 [grpc-default-executor-2] INFO  server.RaftServer$Division (RaftServerImpl.java:installSnapshot(1329)) - b6de9022-5a0e-4aec-a94e-4e214b276ef3@group-5AA8DAB94A1F: receive installSnapshot: 21490b65-0a55-46f3-b94a-dd719a327c14->b6de9022-5a0e-4aec-a94e-4e214b276ef3#0-t2,notify:(t:2, i:1)
2021-10-05 13:25:10,991 [grpc-default-executor-4] INFO  server.RaftServer$Division (RaftServerImpl.java:checkInconsistentAppendEntries(1293)) - b6de9022-5a0e-4aec-a94e-4e214b276ef3@group-5AA8DAB94A1F: Failed appendEntries as snapshot ((t:2, i:1)) installation is in progress
2021-10-05 13:25:10,991 [grpc-default-executor-4] INFO  server.RaftServer$Division (RaftServerImpl.java:checkInconsistentAppendEntries(1285)) - b6de9022-5a0e-4aec-a94e-4e214b276ef3@group-5AA8DAB94A1F: inconsistency entries. Reply:21490b65-0a55-46f3-b94a-dd719a327c14<-b6de9022-5a0e-4aec-a94e-4e214b276ef3#13:FAIL-t2,INCONSISTENCY,nextIndex=0,followerCommit=-1
2021-10-05 13:25:10,991 [grpc-default-executor-2] INFO  server.RaftServer$Division (RaftServerImpl.java:notifyStateMachineToInstallSnapshot(1611)) - b6de9022-5a0e-4aec-a94e-4e214b276ef3@group-5AA8DAB94A1F: Snapshot Installation by StateMachine is in progress.
2021-10-05 13:25:10,992 [grpc-default-executor-2] INFO  server.RaftServer$Division (RaftServerImpl.java:installSnapshotImpl(1459)) - b6de9022-5a0e-4aec-a94e-4e214b276ef3@group-5AA8DAB94A1F: set new configuration index: 5
configurationEntry {
  peers {
    id: "21490b65-0a55-46f3-b94a-dd719a327c14"
    address: "localhost:13528"
  }
  peers {
    id: "6d234f4d-474a-4c74-a9e9-8f3885fce584"
    address: "localhost:13538"
  }
}
 from snapshot
2021-10-05 13:25:10,992 [grpc-default-executor-2] INFO  server.RaftServer$Division (ServerState.java:setRaftConf(387)) - b6de9022-5a0e-4aec-a94e-4e214b276ef3@group-5AA8DAB94A1F: set configuration 5: [21490b65-0a55-46f3-b94a-dd719a327c14|rpc:localhost:13528|admin:|client:|dataStream:|priority:0, 6d234f4d-474a-4c74-a9e9-8f3885fce584|rpc:localhost:13538|admin:|client:|dataStream:|priority:0], old=null
2021-10-05 13:25:10,992 [grpc-default-executor-2] INFO  server.RaftServer$Division (RaftServerImpl.java:installSnapshot(1340)) - b6de9022-5a0e-4aec-a94e-4e214b276ef3@group-5AA8DAB94A1F: reply installSnapshot: 21490b65-0a55-46f3-b94a-dd719a327c14<-b6de9022-5a0e-4aec-a94e-4e214b276ef3#0:FAIL-t2,IN_PROGRESS
2021-10-05 13:25:10,992 [grpc-default-executor-2] INFO  server.GrpcServerProtocolService (GrpcServerProtocolService.java:onCompleted(140)) - b6de9022-5a0e-4aec-a94e-4e214b276ef3: Completed INSTALL_SNAPSHOT, lastRequest: 21490b65-0a55-46f3-b94a-dd719a327c14->b6de9022-5a0e-4aec-a94e-4e214b276ef3#0-t2,notify:(t:2, i:1)
2021-10-05 13:25:10,992 [grpc-default-executor-3] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(46)) - 21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F->b6de9022-5a0e-4aec-a94e-4e214b276ef3: nextIndex: updateUnconditionally 0 -> 0
2021-10-05 13:25:10,992 [grpc-default-executor-4] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onNext(400)) - 21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F->b6de9022-5a0e-4aec-a94e-4e214b276ef3-InstallSnapshotResponseHandler: received a reply 21490b65-0a55-46f3-b94a-dd719a327c14<-b6de9022-5a0e-4aec-a94e-4e214b276ef3#0:FAIL-t2,IN_PROGRESS
2021-10-05 13:25:10,993 [grpc-default-executor-4] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onNext(417)) - 21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F->b6de9022-5a0e-4aec-a94e-4e214b276ef3-InstallSnapshotResponseHandler: InstallSnapshot in progress.
2021-10-05 13:25:10,999 [21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F->b6de9022-5a0e-4aec-a94e-4e214b276ef3-GrpcLogAppender-LogAppenderDaemon] INFO  server.GrpcLogAppender (GrpcLogAppender.java:installSnapshot(524)) - 21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F->b6de9022-5a0e-4aec-a94e-4e214b276ef3-GrpcLogAppender: followerNextIndex = 0 but logStartIndex = 1, notify follower to install snapshot-(t:2, i:1)
2021-10-05 13:25:10,999 [21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F->b6de9022-5a0e-4aec-a94e-4e214b276ef3-GrpcLogAppender-LogAppenderDaemon] INFO  server.GrpcLogAppender (GrpcLogAppender.java:installSnapshot(532)) - 21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F->b6de9022-5a0e-4aec-a94e-4e214b276ef3-GrpcLogAppender: send 21490b65-0a55-46f3-b94a-dd719a327c14->b6de9022-5a0e-4aec-a94e-4e214b276ef3#0-t2,notify:(t:2, i:1)
2021-10-05 13:25:11,008 [grpc-default-executor-4] INFO  server.RaftServer$Division (RaftServerImpl.java:checkInconsistentAppendEntries(1293)) - b6de9022-5a0e-4aec-a94e-4e214b276ef3@group-5AA8DAB94A1F: Failed appendEntries as snapshot ((t:2, i:1)) installation is in progress
2021-10-05 13:25:11,008 [grpc-default-executor-4] INFO  server.RaftServer$Division (RaftServerImpl.java:checkInconsistentAppendEntries(1285)) - b6de9022-5a0e-4aec-a94e-4e214b276ef3@group-5AA8DAB94A1F: inconsistency entries. Reply:21490b65-0a55-46f3-b94a-dd719a327c14<-b6de9022-5a0e-4aec-a94e-4e214b276ef3#14:FAIL-t2,INCONSISTENCY,nextIndex=0,followerCommit=-1
2021-10-05 13:25:11,008 [grpc-default-executor-4] INFO  server.RaftServer$Division (RaftServerImpl.java:installSnapshot(1329)) - b6de9022-5a0e-4aec-a94e-4e214b276ef3@group-5AA8DAB94A1F: receive installSnapshot: 21490b65-0a55-46f3-b94a-dd719a327c14->b6de9022-5a0e-4aec-a94e-4e214b276ef3#0-t2,notify:(t:2, i:1)
2021-10-05 13:25:11,008 [grpc-default-executor-4] INFO  server.RaftServer$Division (RaftServerImpl.java:notifyStateMachineToInstallSnapshot(1611)) - b6de9022-5a0e-4aec-a94e-4e214b276ef3@group-5AA8DAB94A1F: Snapshot Installation by StateMachine is in progress.
2021-10-05 13:25:11,008 [grpc-default-executor-4] INFO  server.RaftServer$Division (RaftServerImpl.java:installSnapshotImpl(1459)) - b6de9022-5a0e-4aec-a94e-4e214b276ef3@group-5AA8DAB94A1F: set new configuration index: 5
configurationEntry {
  peers {
    id: "21490b65-0a55-46f3-b94a-dd719a327c14"
    address: "localhost:13528"
  }
  peers {
    id: "6d234f4d-474a-4c74-a9e9-8f3885fce584"
    address: "localhost:13538"
  }
}
 from snapshot
2021-10-05 13:25:11,009 [grpc-default-executor-4] INFO  server.RaftServer$Division (ServerState.java:setRaftConf(387)) - b6de9022-5a0e-4aec-a94e-4e214b276ef3@group-5AA8DAB94A1F: set configuration 5: [21490b65-0a55-46f3-b94a-dd719a327c14|rpc:localhost:13528|admin:|client:|dataStream:|priority:0, 6d234f4d-474a-4c74-a9e9-8f3885fce584|rpc:localhost:13538|admin:|client:|dataStream:|priority:0], old=null
2021-10-05 13:25:11,009 [grpc-default-executor-4] INFO  server.RaftServer$Division (RaftServerImpl.java:installSnapshot(1340)) - b6de9022-5a0e-4aec-a94e-4e214b276ef3@group-5AA8DAB94A1F: reply installSnapshot: 21490b65-0a55-46f3-b94a-dd719a327c14<-b6de9022-5a0e-4aec-a94e-4e214b276ef3#0:FAIL-t2,IN_PROGRESS
2021-10-05 13:25:11,009 [grpc-default-executor-4] INFO  server.GrpcServerProtocolService (GrpcServerProtocolService.java:onCompleted(140)) - b6de9022-5a0e-4aec-a94e-4e214b276ef3: Completed INSTALL_SNAPSHOT, lastRequest: 21490b65-0a55-46f3-b94a-dd719a327c14->b6de9022-5a0e-4aec-a94e-4e214b276ef3#0-t2,notify:(t:2, i:1)
2021-10-05 13:25:11,009 [grpc-default-executor-2] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(46)) - 21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F->b6de9022-5a0e-4aec-a94e-4e214b276ef3: nextIndex: updateUnconditionally 0 -> 0
2021-10-05 13:25:11,010 [grpc-default-executor-4] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onNext(400)) - 21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F->b6de9022-5a0e-4aec-a94e-4e214b276ef3-InstallSnapshotResponseHandler: received a reply 21490b65-0a55-46f3-b94a-dd719a327c14<-b6de9022-5a0e-4aec-a94e-4e214b276ef3#0:FAIL-t2,IN_PROGRESS
2021-10-05 13:25:11,010 [grpc-default-executor-4] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onNext(417)) - 21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F->b6de9022-5a0e-4aec-a94e-4e214b276ef3-InstallSnapshotResponseHandler: InstallSnapshot in progress.
2021-10-05 13:25:11,012 [21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F->b6de9022-5a0e-4aec-a94e-4e214b276ef3-GrpcLogAppender-LogAppenderDaemon] INFO  server.GrpcLogAppender (GrpcLogAppender.java:installSnapshot(524)) - 21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F->b6de9022-5a0e-4aec-a94e-4e214b276ef3-GrpcLogAppender: followerNextIndex = 0 but logStartIndex = 1, notify follower to install snapshot-(t:2, i:1)
2021-10-05 13:25:11,013 [21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F->b6de9022-5a0e-4aec-a94e-4e214b276ef3-GrpcLogAppender-LogAppenderDaemon] INFO  server.GrpcLogAppender (GrpcLogAppender.java:installSnapshot(532)) - 21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F->b6de9022-5a0e-4aec-a94e-4e214b276ef3-GrpcLogAppender: send 21490b65-0a55-46f3-b94a-dd719a327c14->b6de9022-5a0e-4aec-a94e-4e214b276ef3#0-t2,notify:(t:2, i:1)
2021-10-05 13:25:11,014 [grpc-default-executor-2] INFO  server.RaftServer$Division (RaftServerImpl.java:checkInconsistentAppendEntries(1293)) - b6de9022-5a0e-4aec-a94e-4e214b276ef3@group-5AA8DAB94A1F: Failed appendEntries as snapshot ((t:2, i:1)) installation is in progress
2021-10-05 13:25:11,014 [grpc-default-executor-2] INFO  server.RaftServer$Division (RaftServerImpl.java:checkInconsistentAppendEntries(1285)) - b6de9022-5a0e-4aec-a94e-4e214b276ef3@group-5AA8DAB94A1F: inconsistency entries. Reply:21490b65-0a55-46f3-b94a-dd719a327c14<-b6de9022-5a0e-4aec-a94e-4e214b276ef3#15:FAIL-t2,INCONSISTENCY,nextIndex=0,followerCommit=-1
2021-10-05 13:25:11,014 [grpc-default-executor-2] INFO  server.RaftServer$Division (RaftServerImpl.java:installSnapshot(1329)) - b6de9022-5a0e-4aec-a94e-4e214b276ef3@group-5AA8DAB94A1F: receive installSnapshot: 21490b65-0a55-46f3-b94a-dd719a327c14->b6de9022-5a0e-4aec-a94e-4e214b276ef3#0-t2,notify:(t:2, i:1)
2021-10-05 13:25:11,014 [grpc-default-executor-2] INFO  server.RaftServer$Division (RaftServerImpl.java:notifyStateMachineToInstallSnapshot(1611)) - b6de9022-5a0e-4aec-a94e-4e214b276ef3@group-5AA8DAB94A1F: Snapshot Installation by StateMachine is in progress.
2021-10-05 13:25:11,014 [grpc-default-executor-2] INFO  server.RaftServer$Division (RaftServerImpl.java:installSnapshotImpl(1459)) - b6de9022-5a0e-4aec-a94e-4e214b276ef3@group-5AA8DAB94A1F: set new configuration index: 5
configurationEntry {
  peers {
    id: "21490b65-0a55-46f3-b94a-dd719a327c14"
    address: "localhost:13528"
  }
  peers {
    id: "6d234f4d-474a-4c74-a9e9-8f3885fce584"
    address: "localhost:13538"
  }
}
 from snapshot
2021-10-05 13:25:11,014 [grpc-default-executor-2] INFO  server.RaftServer$Division (ServerState.java:setRaftConf(387)) - b6de9022-5a0e-4aec-a94e-4e214b276ef3@group-5AA8DAB94A1F: set configuration 5: [21490b65-0a55-46f3-b94a-dd719a327c14|rpc:localhost:13528|admin:|client:|dataStream:|priority:0, 6d234f4d-474a-4c74-a9e9-8f3885fce584|rpc:localhost:13538|admin:|client:|dataStream:|priority:0], old=null
2021-10-05 13:25:11,015 [grpc-default-executor-2] INFO  server.RaftServer$Division (RaftServerImpl.java:installSnapshot(1340)) - b6de9022-5a0e-4aec-a94e-4e214b276ef3@group-5AA8DAB94A1F: reply installSnapshot: 21490b65-0a55-46f3-b94a-dd719a327c14<-b6de9022-5a0e-4aec-a94e-4e214b276ef3#0:FAIL-t2,IN_PROGRESS
2021-10-05 13:25:11,015 [grpc-default-executor-2] INFO  server.GrpcServerProtocolService (GrpcServerProtocolService.java:onCompleted(140)) - b6de9022-5a0e-4aec-a94e-4e214b276ef3: Completed INSTALL_SNAPSHOT, lastRequest: 21490b65-0a55-46f3-b94a-dd719a327c14->b6de9022-5a0e-4aec-a94e-4e214b276ef3#0-t2,notify:(t:2, i:1)
2021-10-05 13:25:11,015 [grpc-default-executor-4] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(46)) - 21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F->b6de9022-5a0e-4aec-a94e-4e214b276ef3: nextIndex: updateUnconditionally 0 -> 0
2021-10-05 13:25:11,016 [grpc-default-executor-4] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onNext(400)) - 21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F->b6de9022-5a0e-4aec-a94e-4e214b276ef3-InstallSnapshotResponseHandler: received a reply 21490b65-0a55-46f3-b94a-dd719a327c14<-b6de9022-5a0e-4aec-a94e-4e214b276ef3#0:FAIL-t2,IN_PROGRESS
2021-10-05 13:25:11,016 [grpc-default-executor-4] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onNext(417)) - 21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F->b6de9022-5a0e-4aec-a94e-4e214b276ef3-InstallSnapshotResponseHandler: InstallSnapshot in progress.
2021-10-05 13:25:11,023 [21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F->b6de9022-5a0e-4aec-a94e-4e214b276ef3-GrpcLogAppender-LogAppenderDaemon] INFO  server.GrpcLogAppender (GrpcLogAppender.java:installSnapshot(524)) - 21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F->b6de9022-5a0e-4aec-a94e-4e214b276ef3-GrpcLogAppender: followerNextIndex = 0 but logStartIndex = 1, notify follower to install snapshot-(t:2, i:1)
2021-10-05 13:25:11,023 [21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F->b6de9022-5a0e-4aec-a94e-4e214b276ef3-GrpcLogAppender-LogAppenderDaemon] INFO  server.GrpcLogAppender (GrpcLogAppender.java:installSnapshot(532)) - 21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F->b6de9022-5a0e-4aec-a94e-4e214b276ef3-GrpcLogAppender: send 21490b65-0a55-46f3-b94a-dd719a327c14->b6de9022-5a0e-4aec-a94e-4e214b276ef3#0-t2,notify:(t:2, i:1)
2021-10-05 13:25:11,024 [grpc-default-executor-5] INFO  server.RaftServer$Division (RaftServerImpl.java:checkInconsistentAppendEntries(1293)) - b6de9022-5a0e-4aec-a94e-4e214b276ef3@group-5AA8DAB94A1F: Failed appendEntries as snapshot ((t:2, i:1)) installation is in progress
2021-10-05 13:25:11,024 [grpc-default-executor-5] INFO  server.RaftServer$Division (RaftServerImpl.java:checkInconsistentAppendEntries(1285)) - b6de9022-5a0e-4aec-a94e-4e214b276ef3@group-5AA8DAB94A1F: inconsistency entries. Reply:21490b65-0a55-46f3-b94a-dd719a327c14<-b6de9022-5a0e-4aec-a94e-4e214b276ef3#16:FAIL-t2,INCONSISTENCY,nextIndex=0,followerCommit=-1
2021-10-05 13:25:11,024 [grpc-default-executor-2] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(46)) - 21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F->b6de9022-5a0e-4aec-a94e-4e214b276ef3: nextIndex: updateUnconditionally 0 -> 0
2021-10-05 13:25:11,025 [grpc-default-executor-4] INFO  server.RaftServer$Division (RaftServerImpl.java:installSnapshot(1329)) - b6de9022-5a0e-4aec-a94e-4e214b276ef3@group-5AA8DAB94A1F: receive installSnapshot: 21490b65-0a55-46f3-b94a-dd719a327c14->b6de9022-5a0e-4aec-a94e-4e214b276ef3#0-t2,notify:(t:2, i:1)
2021-10-05 13:25:11,025 [grpc-default-executor-4] INFO  server.RaftServer$Division (RaftServerImpl.java:notifyStateMachineToInstallSnapshot(1611)) - b6de9022-5a0e-4aec-a94e-4e214b276ef3@group-5AA8DAB94A1F: Snapshot Installation by StateMachine is in progress.
2021-10-05 13:25:11,025 [grpc-default-executor-4] INFO  server.RaftServer$Division (RaftServerImpl.java:installSnapshotImpl(1459)) - b6de9022-5a0e-4aec-a94e-4e214b276ef3@group-5AA8DAB94A1F: set new configuration index: 5
configurationEntry {
  peers {
    id: "21490b65-0a55-46f3-b94a-dd719a327c14"
    address: "localhost:13528"
  }
  peers {
    id: "6d234f4d-474a-4c74-a9e9-8f3885fce584"
    address: "localhost:13538"
  }
}
 from snapshot
2021-10-05 13:25:11,025 [grpc-default-executor-4] INFO  server.RaftServer$Division (ServerState.java:setRaftConf(387)) - b6de9022-5a0e-4aec-a94e-4e214b276ef3@group-5AA8DAB94A1F: set configuration 5: [21490b65-0a55-46f3-b94a-dd719a327c14|rpc:localhost:13528|admin:|client:|dataStream:|priority:0, 6d234f4d-474a-4c74-a9e9-8f3885fce584|rpc:localhost:13538|admin:|client:|dataStream:|priority:0], old=null
2021-10-05 13:25:11,025 [grpc-default-executor-4] INFO  server.RaftServer$Division (RaftServerImpl.java:installSnapshot(1340)) - b6de9022-5a0e-4aec-a94e-4e214b276ef3@group-5AA8DAB94A1F: reply installSnapshot: 21490b65-0a55-46f3-b94a-dd719a327c14<-b6de9022-5a0e-4aec-a94e-4e214b276ef3#0:FAIL-t2,IN_PROGRESS
2021-10-05 13:25:11,025 [grpc-default-executor-4] INFO  server.GrpcServerProtocolService (GrpcServerProtocolService.java:onCompleted(140)) - b6de9022-5a0e-4aec-a94e-4e214b276ef3: Completed INSTALL_SNAPSHOT, lastRequest: 21490b65-0a55-46f3-b94a-dd719a327c14->b6de9022-5a0e-4aec-a94e-4e214b276ef3#0-t2,notify:(t:2, i:1)
2021-10-05 13:25:11,026 [grpc-default-executor-2] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onNext(400)) - 21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F->b6de9022-5a0e-4aec-a94e-4e214b276ef3-InstallSnapshotResponseHandler: received a reply 21490b65-0a55-46f3-b94a-dd719a327c14<-b6de9022-5a0e-4aec-a94e-4e214b276ef3#0:FAIL-t2,IN_PROGRESS
2021-10-05 13:25:11,026 [grpc-default-executor-2] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onNext(417)) - 21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F->b6de9022-5a0e-4aec-a94e-4e214b276ef3-InstallSnapshotResponseHandler: InstallSnapshot in progress.
2021-10-05 13:25:11,039 [pool-228-thread-1] INFO  ha.SCMHAManagerImpl (SCMHAManagerImpl.java:verifyCheckpointFromLeader(172)) - Installing checkpoint with SCMTransactionInfo 2#24
2021-10-05 13:25:11,039 [21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F->b6de9022-5a0e-4aec-a94e-4e214b276ef3-GrpcLogAppender-LogAppenderDaemon] INFO  server.GrpcLogAppender (GrpcLogAppender.java:installSnapshot(524)) - 21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F->b6de9022-5a0e-4aec-a94e-4e214b276ef3-GrpcLogAppender: followerNextIndex = 0 but logStartIndex = 1, notify follower to install snapshot-(t:2, i:1)
2021-10-05 13:25:11,039 [21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F->b6de9022-5a0e-4aec-a94e-4e214b276ef3-GrpcLogAppender-LogAppenderDaemon] INFO  server.GrpcLogAppender (GrpcLogAppender.java:installSnapshot(532)) - 21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F->b6de9022-5a0e-4aec-a94e-4e214b276ef3-GrpcLogAppender: send 21490b65-0a55-46f3-b94a-dd719a327c14->b6de9022-5a0e-4aec-a94e-4e214b276ef3#0-t2,notify:(t:2, i:1)
2021-10-05 13:25:11,040 [grpc-default-executor-5] INFO  server.RaftServer$Division (RaftServerImpl.java:checkInconsistentAppendEntries(1293)) - b6de9022-5a0e-4aec-a94e-4e214b276ef3@group-5AA8DAB94A1F: Failed appendEntries as snapshot ((t:2, i:1)) installation is in progress
2021-10-05 13:25:11,040 [grpc-default-executor-5] INFO  server.RaftServer$Division (RaftServerImpl.java:checkInconsistentAppendEntries(1285)) - b6de9022-5a0e-4aec-a94e-4e214b276ef3@group-5AA8DAB94A1F: inconsistency entries. Reply:21490b65-0a55-46f3-b94a-dd719a327c14<-b6de9022-5a0e-4aec-a94e-4e214b276ef3#17:FAIL-t2,INCONSISTENCY,nextIndex=0,followerCommit=-1
2021-10-05 13:25:11,041 [grpc-default-executor-2] INFO  server.RaftServer$Division (RaftServerImpl.java:installSnapshot(1329)) - b6de9022-5a0e-4aec-a94e-4e214b276ef3@group-5AA8DAB94A1F: receive installSnapshot: 21490b65-0a55-46f3-b94a-dd719a327c14->b6de9022-5a0e-4aec-a94e-4e214b276ef3#0-t2,notify:(t:2, i:1)
2021-10-05 13:25:11,041 [grpc-default-executor-2] INFO  server.RaftServer$Division (RaftServerImpl.java:notifyStateMachineToInstallSnapshot(1611)) - b6de9022-5a0e-4aec-a94e-4e214b276ef3@group-5AA8DAB94A1F: Snapshot Installation by StateMachine is in progress.
2021-10-05 13:25:11,041 [grpc-default-executor-2] INFO  server.RaftServer$Division (RaftServerImpl.java:installSnapshotImpl(1459)) - b6de9022-5a0e-4aec-a94e-4e214b276ef3@group-5AA8DAB94A1F: set new configuration index: 5
configurationEntry {
  peers {
    id: "21490b65-0a55-46f3-b94a-dd719a327c14"
    address: "localhost:13528"
  }
  peers {
    id: "6d234f4d-474a-4c74-a9e9-8f3885fce584"
    address: "localhost:13538"
  }
}
 from snapshot
2021-10-05 13:25:11,041 [grpc-default-executor-2] INFO  server.RaftServer$Division (ServerState.java:setRaftConf(387)) - b6de9022-5a0e-4aec-a94e-4e214b276ef3@group-5AA8DAB94A1F: set configuration 5: [21490b65-0a55-46f3-b94a-dd719a327c14|rpc:localhost:13528|admin:|client:|dataStream:|priority:0, 6d234f4d-474a-4c74-a9e9-8f3885fce584|rpc:localhost:13538|admin:|client:|dataStream:|priority:0], old=null
2021-10-05 13:25:11,041 [grpc-default-executor-2] INFO  server.RaftServer$Division (RaftServerImpl.java:installSnapshot(1340)) - b6de9022-5a0e-4aec-a94e-4e214b276ef3@group-5AA8DAB94A1F: reply installSnapshot: 21490b65-0a55-46f3-b94a-dd719a327c14<-b6de9022-5a0e-4aec-a94e-4e214b276ef3#0:FAIL-t2,IN_PROGRESS
2021-10-05 13:25:11,042 [grpc-default-executor-2] INFO  server.GrpcServerProtocolService (GrpcServerProtocolService.java:onCompleted(140)) - b6de9022-5a0e-4aec-a94e-4e214b276ef3: Completed INSTALL_SNAPSHOT, lastRequest: 21490b65-0a55-46f3-b94a-dd719a327c14->b6de9022-5a0e-4aec-a94e-4e214b276ef3#0-t2,notify:(t:2, i:1)
2021-10-05 13:25:11,042 [grpc-default-executor-5] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(46)) - 21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F->b6de9022-5a0e-4aec-a94e-4e214b276ef3: nextIndex: updateUnconditionally 0 -> 0
2021-10-05 13:25:11,042 [pool-228-thread-1] INFO  server.RaftServer$Division (RaftServerImpl.java:lambda$notifyStateMachineToInstallSnapshot$30(1594)) - b6de9022-5a0e-4aec-a94e-4e214b276ef3@group-5AA8DAB94A1F: StateMachine successfully installed snapshot index 24. Reloading the StateMachine.
2021-10-05 13:25:11,042 [pool-228-thread-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:lambda$new$0(133)) - b6de9022-5a0e-4aec-a94e-4e214b276ef3@group-5AA8DAB94A1F-SegmentedRaftLogWorker: flushIndex: setUnconditionally -1 -> 24
2021-10-05 13:25:11,043 [pool-228-thread-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:lambda$new$0(133)) - b6de9022-5a0e-4aec-a94e-4e214b276ef3@group-5AA8DAB94A1F-SegmentedRaftLogWorker: safeCacheEvictIndex: setUnconditionally -1 -> 24
2021-10-05 13:25:11,043 [pool-228-thread-1] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - b6de9022-5a0e-4aec-a94e-4e214b276ef3@group-5AA8DAB94A1F-SegmentedRaftLog: snapshotIndex: updateIncreasingly -1 -> 24
2021-10-05 13:25:11,043 [grpc-default-executor-2] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onNext(400)) - 21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F->b6de9022-5a0e-4aec-a94e-4e214b276ef3-InstallSnapshotResponseHandler: received a reply 21490b65-0a55-46f3-b94a-dd719a327c14<-b6de9022-5a0e-4aec-a94e-4e214b276ef3#0:FAIL-t2,IN_PROGRESS
2021-10-05 13:25:11,043 [grpc-default-executor-2] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onNext(417)) - 21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F->b6de9022-5a0e-4aec-a94e-4e214b276ef3-InstallSnapshotResponseHandler: InstallSnapshot in progress.
2021-10-05 13:25:11,048 [21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F->b6de9022-5a0e-4aec-a94e-4e214b276ef3-GrpcLogAppender-LogAppenderDaemon] INFO  server.GrpcLogAppender (GrpcLogAppender.java:installSnapshot(524)) - 21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F->b6de9022-5a0e-4aec-a94e-4e214b276ef3-GrpcLogAppender: followerNextIndex = 0 but logStartIndex = 1, notify follower to install snapshot-(t:2, i:1)
2021-10-05 13:25:11,048 [21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F->b6de9022-5a0e-4aec-a94e-4e214b276ef3-GrpcLogAppender-LogAppenderDaemon] INFO  server.GrpcLogAppender (GrpcLogAppender.java:installSnapshot(532)) - 21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F->b6de9022-5a0e-4aec-a94e-4e214b276ef3-GrpcLogAppender: send 21490b65-0a55-46f3-b94a-dd719a327c14->b6de9022-5a0e-4aec-a94e-4e214b276ef3#0-t2,notify:(t:2, i:1)
2021-10-05 13:25:11,049 [grpc-default-executor-5] INFO  server.RaftServer$Division (RaftServerImpl.java:installSnapshot(1329)) - b6de9022-5a0e-4aec-a94e-4e214b276ef3@group-5AA8DAB94A1F: receive installSnapshot: 21490b65-0a55-46f3-b94a-dd719a327c14->b6de9022-5a0e-4aec-a94e-4e214b276ef3#0-t2,notify:(t:2, i:1)
2021-10-05 13:25:11,049 [grpc-default-executor-5] INFO  server.RaftServer$Division (RaftServerImpl.java:notifyStateMachineToInstallSnapshot(1560)) - b6de9022-5a0e-4aec-a94e-4e214b276ef3@group-5AA8DAB94A1F: StateMachine snapshotIndex is 24
2021-10-05 13:25:11,049 [grpc-default-executor-5] INFO  server.RaftServer$Division (RaftServerImpl.java:installSnapshotImpl(1459)) - b6de9022-5a0e-4aec-a94e-4e214b276ef3@group-5AA8DAB94A1F: set new configuration index: 5
configurationEntry {
  peers {
    id: "21490b65-0a55-46f3-b94a-dd719a327c14"
    address: "localhost:13528"
  }
  peers {
    id: "6d234f4d-474a-4c74-a9e9-8f3885fce584"
    address: "localhost:13538"
  }
}
 from snapshot
2021-10-05 13:25:11,049 [grpc-default-executor-5] INFO  server.RaftServer$Division (ServerState.java:setRaftConf(387)) - b6de9022-5a0e-4aec-a94e-4e214b276ef3@group-5AA8DAB94A1F: set configuration 5: [21490b65-0a55-46f3-b94a-dd719a327c14|rpc:localhost:13528|admin:|client:|dataStream:|priority:0, 6d234f4d-474a-4c74-a9e9-8f3885fce584|rpc:localhost:13538|admin:|client:|dataStream:|priority:0], old=null
2021-10-05 13:25:11,049 [grpc-default-executor-5] INFO  server.RaftServer$Division (RaftServerImpl.java:installSnapshot(1340)) - b6de9022-5a0e-4aec-a94e-4e214b276ef3@group-5AA8DAB94A1F: reply installSnapshot: 21490b65-0a55-46f3-b94a-dd719a327c14<-b6de9022-5a0e-4aec-a94e-4e214b276ef3#0:FAIL-t2,ALREADY_INSTALLED,snapshotIndex=24
2021-10-05 13:25:11,050 [grpc-default-executor-5] INFO  server.GrpcServerProtocolService (GrpcServerProtocolService.java:onCompleted(140)) - b6de9022-5a0e-4aec-a94e-4e214b276ef3: Completed INSTALL_SNAPSHOT, lastRequest: 21490b65-0a55-46f3-b94a-dd719a327c14->b6de9022-5a0e-4aec-a94e-4e214b276ef3#0-t2,notify:(t:2, i:1)
2021-10-05 13:25:11,050 [grpc-default-executor-5] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onNext(400)) - 21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F->b6de9022-5a0e-4aec-a94e-4e214b276ef3-InstallSnapshotResponseHandler: received a reply 21490b65-0a55-46f3-b94a-dd719a327c14<-b6de9022-5a0e-4aec-a94e-4e214b276ef3#0:FAIL-t2,ALREADY_INSTALLED,snapshotIndex=24
2021-10-05 13:25:11,050 [grpc-default-executor-5] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onNext(422)) - 21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F->b6de9022-5a0e-4aec-a94e-4e214b276ef3-InstallSnapshotResponseHandler: Already Installed Snapshot Index 24.
2021-10-05 13:25:11,050 [grpc-default-executor-5] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(46)) - 21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F->b6de9022-5a0e-4aec-a94e-4e214b276ef3: snapshotIndex: setUnconditionally 0 -> 24
2021-10-05 13:25:11,050 [grpc-default-executor-5] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(46)) - 21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F->b6de9022-5a0e-4aec-a94e-4e214b276ef3: matchIndex: setUnconditionally 0 -> 24
2021-10-05 13:25:11,050 [grpc-default-executor-5] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(46)) - 21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F->b6de9022-5a0e-4aec-a94e-4e214b276ef3: nextIndex: setUnconditionally 0 -> 25
2021-10-05 13:25:11,050 [grpc-default-executor-5] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(46)) - 21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F->b6de9022-5a0e-4aec-a94e-4e214b276ef3: nextIndex: updateToMax old=25, new=25, updated? false
2021-10-05 13:25:11,110 [b6de9022-5a0e-4aec-a94e-4e214b276ef3@group-5AA8DAB94A1F-StateMachineUpdater] INFO  ha.SCMHAManagerImpl (SCMHAManagerImpl.java:installCheckpoint(227)) - Installing checkpoint with SCMTransactionInfo 2#24
2021-10-05 13:25:11,112 [b6de9022-5a0e-4aec-a94e-4e214b276ef3@group-5AA8DAB94A1F-StateMachineUpdater] INFO  ha.SCMHAManagerImpl (SCMHAManagerImpl.java:installCheckpoint(266)) - Replaced DB with checkpoint, term: 2, index: 24
2021-10-05 13:25:11,115 [b6de9022-5a0e-4aec-a94e-4e214b276ef3@group-5AA8DAB94A1F-StateMachineUpdater] WARN  utils.HAUtils (HAUtils.java:getMetaDir(342)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2021-10-05 13:25:11,116 [b6de9022-5a0e-4aec-a94e-4e214b276ef3@group-5AA8DAB94A1F-StateMachineUpdater] WARN  db.DBStoreBuilder (DBStoreBuilder.java:applyDBDefinition(145)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2021-10-05 13:25:11,164 [b6de9022-5a0e-4aec-a94e-4e214b276ef3@group-5AA8DAB94A1F-StateMachineUpdater] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:reinitialize(166)) - reinitialize SequenceIdGenerator.
2021-10-05 13:25:11,168 [b6de9022-5a0e-4aec-a94e-4e214b276ef3@group-5AA8DAB94A1F-StateMachineUpdater] INFO  ha.SCMHAManagerImpl (SCMHAManagerImpl.java:installCheckpoint(277)) - Reloaded SCM state with Term: 2 and Index: 24
2021-10-05 13:25:11,169 [b6de9022-5a0e-4aec-a94e-4e214b276ef3@group-5AA8DAB94A1F-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:lambda$new$0(89)) - b6de9022-5a0e-4aec-a94e-4e214b276ef3@group-5AA8DAB94A1F-StateMachineUpdater: snapshotIndex: setUnconditionally -1 -> 24
2021-10-05 13:25:11,170 [b6de9022-5a0e-4aec-a94e-4e214b276ef3@group-5AA8DAB94A1F-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:lambda$new$0(89)) - b6de9022-5a0e-4aec-a94e-4e214b276ef3@group-5AA8DAB94A1F-StateMachineUpdater: appliedIndex: setUnconditionally -1 -> 24
2021-10-05 13:25:11,748 [EndpointStateMachine task thread for /127.0.0.1:15041 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15041. Already tried 3 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:11,807 [EndpointStateMachine task thread for /127.0.0.1:15021 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15021. Already tried 7 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:11,808 [EndpointStateMachine task thread for /127.0.0.1:15031 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15031. Already tried 7 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:12,748 [EndpointStateMachine task thread for /127.0.0.1:15041 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15041. Already tried 4 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:12,809 [EndpointStateMachine task thread for /127.0.0.1:15031 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15031. Already tried 8 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:12,812 [EndpointStateMachine task thread for /127.0.0.1:15021 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15021. Already tried 8 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:13,739 [Datanode State Machine Thread - 0] ERROR datanode.RunningDatanodeState (RunningDatanodeState.java:computeNextContainerState(199)) - Error in executing end point task.
java.util.concurrent.ExecutionException: java.util.concurrent.TimeoutException
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.hadoop.ozone.container.common.states.datanode.RunningDatanodeState.computeNextContainerState(RunningDatanodeState.java:191)
	at org.apache.hadoop.ozone.container.common.states.datanode.RunningDatanodeState.await(RunningDatanodeState.java:231)
	at org.apache.hadoop.ozone.container.common.states.datanode.RunningDatanodeState.await(RunningDatanodeState.java:50)
	at org.apache.hadoop.ozone.container.common.statemachine.StateContext.execute(StateContext.java:629)
	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.start(DatanodeStateMachine.java:270)
	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.lambda$startDaemon$0(DatanodeStateMachine.java:457)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.util.concurrent.TimeoutException
	at java.util.concurrent.FutureTask.get(FutureTask.java:205)
	at org.apache.hadoop.ozone.container.common.states.datanode.RunningDatanodeState.lambda$execute$0(RunningDatanodeState.java:149)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
2021-10-05 13:25:13,749 [EndpointStateMachine task thread for /127.0.0.1:15041 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15041. Already tried 5 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:13,809 [EndpointStateMachine task thread for /127.0.0.1:15031 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15031. Already tried 9 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:13,817 [EndpointStateMachine task thread for /127.0.0.1:15021 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15021. Already tried 9 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:13,920 [Datanode State Machine Thread - 0] ERROR datanode.RunningDatanodeState (RunningDatanodeState.java:computeNextContainerState(199)) - Error in executing end point task.
java.util.concurrent.ExecutionException: java.util.concurrent.TimeoutException
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.hadoop.ozone.container.common.states.datanode.RunningDatanodeState.computeNextContainerState(RunningDatanodeState.java:191)
	at org.apache.hadoop.ozone.container.common.states.datanode.RunningDatanodeState.await(RunningDatanodeState.java:231)
	at org.apache.hadoop.ozone.container.common.states.datanode.RunningDatanodeState.await(RunningDatanodeState.java:50)
	at org.apache.hadoop.ozone.container.common.statemachine.StateContext.execute(StateContext.java:629)
	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.start(DatanodeStateMachine.java:270)
	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.lambda$startDaemon$0(DatanodeStateMachine.java:457)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.util.concurrent.TimeoutException
	at java.util.concurrent.FutureTask.get(FutureTask.java:205)
	at org.apache.hadoop.ozone.container.common.states.datanode.RunningDatanodeState.lambda$execute$0(RunningDatanodeState.java:149)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
2021-10-05 13:25:14,749 [EndpointStateMachine task thread for /127.0.0.1:15041 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15041. Already tried 6 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:14,810 [EndpointStateMachine task thread for /127.0.0.1:15031 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15031. Already tried 10 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:14,817 [EndpointStateMachine task thread for /127.0.0.1:15021 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15021. Already tried 10 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:15,698 [21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F-LeaderStateImpl] INFO  server.RaftServer$Division (ServerState.java:setRaftConf(387)) - 21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F: set configuration 25: [b6de9022-5a0e-4aec-a94e-4e214b276ef3|rpc:localhost:13548|priority:0, 21490b65-0a55-46f3-b94a-dd719a327c14|rpc:localhost:13528|admin:|client:|dataStream:|priority:0, 6d234f4d-474a-4c74-a9e9-8f3885fce584|rpc:localhost:13538|priority:0], old=[21490b65-0a55-46f3-b94a-dd719a327c14|rpc:localhost:13528|admin:|client:|dataStream:|priority:0, 6d234f4d-474a-4c74-a9e9-8f3885fce584|rpc:localhost:13538|priority:0]
2021-10-05 13:25:15,699 [grpc-default-executor-5] INFO  server.RaftServer$Division (ServerState.java:setRaftConf(387)) - 6d234f4d-474a-4c74-a9e9-8f3885fce584@group-5AA8DAB94A1F: set configuration 25: [b6de9022-5a0e-4aec-a94e-4e214b276ef3|rpc:localhost:13548|admin:|client:|dataStream:|priority:0, 21490b65-0a55-46f3-b94a-dd719a327c14|rpc:localhost:13528|admin:|client:|dataStream:|priority:0, 6d234f4d-474a-4c74-a9e9-8f3885fce584|rpc:localhost:13538|admin:|client:|dataStream:|priority:0], old=[21490b65-0a55-46f3-b94a-dd719a327c14|rpc:localhost:13528|admin:|client:|dataStream:|priority:0, 6d234f4d-474a-4c74-a9e9-8f3885fce584|rpc:localhost:13538|admin:|client:|dataStream:|priority:0]
2021-10-05 13:25:15,699 [grpc-default-executor-4] INFO  server.RaftServer$Division (ServerState.java:setRaftConf(387)) - b6de9022-5a0e-4aec-a94e-4e214b276ef3@group-5AA8DAB94A1F: set configuration 25: [b6de9022-5a0e-4aec-a94e-4e214b276ef3|rpc:localhost:13548|admin:|client:|dataStream:|priority:0, 21490b65-0a55-46f3-b94a-dd719a327c14|rpc:localhost:13528|admin:|client:|dataStream:|priority:0, 6d234f4d-474a-4c74-a9e9-8f3885fce584|rpc:localhost:13538|admin:|client:|dataStream:|priority:0], old=[21490b65-0a55-46f3-b94a-dd719a327c14|rpc:localhost:13528|admin:|client:|dataStream:|priority:0, 6d234f4d-474a-4c74-a9e9-8f3885fce584|rpc:localhost:13538|admin:|client:|dataStream:|priority:0]
2021-10-05 13:25:15,699 [grpc-default-executor-4] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:startLogSegment(394)) - b6de9022-5a0e-4aec-a94e-4e214b276ef3@group-5AA8DAB94A1F-SegmentedRaftLogWorker: Starting segment from index:25
2021-10-05 13:25:15,703 [b6de9022-5a0e-4aec-a94e-4e214b276ef3@group-5AA8DAB94A1F-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(601)) - b6de9022-5a0e-4aec-a94e-4e214b276ef3@group-5AA8DAB94A1F-SegmentedRaftLogWorker: created new log segment /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-36b87918-66c6-4e2c-9c49-5aa8dab94a1f/scmNode-3/scm-ha/36b87918-66c6-4e2c-9c49-5aa8dab94a1f/current/log_inprogress_25
2021-10-05 13:25:15,709 [21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F-StateMachineUpdater] INFO  ha.SCMStateMachine (SCMStateMachine.java:takeSnapshot(290)) - Current Snapshot Index 25, takeSnapshot took 0 ms
2021-10-05 13:25:15,709 [21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:takeSnapshot(281)) - 21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F-StateMachineUpdater: Took a snapshot at index 25
2021-10-05 13:25:15,709 [21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:lambda$new$0(89)) - 21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F-StateMachineUpdater: snapshotIndex: updateIncreasingly 20 -> 25
2021-10-05 13:25:15,709 [21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:purge(306)) - 21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F-SegmentedRaftLog: purge 25
2021-10-05 13:25:15,712 [21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F-LeaderStateImpl] INFO  server.RaftServer$Division (ServerState.java:setRaftConf(387)) - 21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F: set configuration 27: [b6de9022-5a0e-4aec-a94e-4e214b276ef3|rpc:localhost:13548|priority:0, 21490b65-0a55-46f3-b94a-dd719a327c14|rpc:localhost:13528|admin:|client:|dataStream:|priority:0, 6d234f4d-474a-4c74-a9e9-8f3885fce584|rpc:localhost:13538|priority:0], old=null
2021-10-05 13:25:15,712 [21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - 21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F-SegmentedRaftLog: snapshotIndex: updateIncreasingly 20 -> 25
2021-10-05 13:25:15,712 [21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - 21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F-SegmentedRaftLog: purgeIndex: updateToMax old=20, new=25, updated? true
2021-10-05 13:25:15,714 [grpc-default-executor-5] INFO  server.RaftServer$Division (ServerState.java:setRaftConf(387)) - b6de9022-5a0e-4aec-a94e-4e214b276ef3@group-5AA8DAB94A1F: set configuration 27: [b6de9022-5a0e-4aec-a94e-4e214b276ef3|rpc:localhost:13548|admin:|client:|dataStream:|priority:0, 21490b65-0a55-46f3-b94a-dd719a327c14|rpc:localhost:13528|admin:|client:|dataStream:|priority:0, 6d234f4d-474a-4c74-a9e9-8f3885fce584|rpc:localhost:13538|admin:|client:|dataStream:|priority:0], old=null
2021-10-05 13:25:15,714 [grpc-default-executor-4] INFO  server.RaftServer$Division (ServerState.java:setRaftConf(387)) - 6d234f4d-474a-4c74-a9e9-8f3885fce584@group-5AA8DAB94A1F: set configuration 27: [b6de9022-5a0e-4aec-a94e-4e214b276ef3|rpc:localhost:13548|admin:|client:|dataStream:|priority:0, 21490b65-0a55-46f3-b94a-dd719a327c14|rpc:localhost:13528|admin:|client:|dataStream:|priority:0, 6d234f4d-474a-4c74-a9e9-8f3885fce584|rpc:localhost:13538|admin:|client:|dataStream:|priority:0], old=null
2021-10-05 13:25:15,719 [6d234f4d-474a-4c74-a9e9-8f3885fce584@group-5AA8DAB94A1F-StateMachineUpdater] INFO  ha.SCMStateMachine (SCMStateMachine.java:takeSnapshot(290)) - Current Snapshot Index 25, takeSnapshot took 0 ms
2021-10-05 13:25:15,719 [6d234f4d-474a-4c74-a9e9-8f3885fce584@group-5AA8DAB94A1F-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:takeSnapshot(281)) - 6d234f4d-474a-4c74-a9e9-8f3885fce584@group-5AA8DAB94A1F-StateMachineUpdater: Took a snapshot at index 25
2021-10-05 13:25:15,720 [6d234f4d-474a-4c74-a9e9-8f3885fce584@group-5AA8DAB94A1F-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:lambda$new$0(89)) - 6d234f4d-474a-4c74-a9e9-8f3885fce584@group-5AA8DAB94A1F-StateMachineUpdater: snapshotIndex: updateIncreasingly 20 -> 25
2021-10-05 13:25:15,720 [6d234f4d-474a-4c74-a9e9-8f3885fce584@group-5AA8DAB94A1F-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:purge(306)) - 6d234f4d-474a-4c74-a9e9-8f3885fce584@group-5AA8DAB94A1F-SegmentedRaftLog: purge 25
2021-10-05 13:25:15,720 [6d234f4d-474a-4c74-a9e9-8f3885fce584@group-5AA8DAB94A1F-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - 6d234f4d-474a-4c74-a9e9-8f3885fce584@group-5AA8DAB94A1F-SegmentedRaftLog: snapshotIndex: updateIncreasingly 20 -> 25
2021-10-05 13:25:15,720 [6d234f4d-474a-4c74-a9e9-8f3885fce584@group-5AA8DAB94A1F-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - 6d234f4d-474a-4c74-a9e9-8f3885fce584@group-5AA8DAB94A1F-SegmentedRaftLog: purgeIndex: updateToMax old=20, new=25, updated? true
2021-10-05 13:25:15,720 [IPC Server handler 2 on default port 13530] INFO  ha.SCMRatisServerImpl (SCMRatisServerImpl.java:addSCM(302)) - Successfully added new SCM: b6de9022-5a0e-4aec-a94e-4e214b276ef3.
2021-10-05 13:25:15,721 [Listener at 127.0.0.1/13296] INFO  ha.SCMHAManagerImpl (SCMHAManagerImpl.java:start(116)) - Successfully added SCM scmNode-3 to group group-5AA8DAB94A1F:[b6de9022-5a0e-4aec-a94e-4e214b276ef3|rpc:localhost:13548|admin:|client:|dataStream:|priority:0, 21490b65-0a55-46f3-b94a-dd719a327c14|rpc:localhost:13528|admin:|client:|dataStream:|priority:0, 6d234f4d-474a-4c74-a9e9-8f3885fce584|rpc:localhost:13538|admin:|client:|dataStream:|priority:0]
2021-10-05 13:25:15,721 [Listener at 127.0.0.1/13296] INFO  ha.InterSCMGrpcService (InterSCMGrpcProtocolService.java:start(94)) - Starting SCM Grpc Service at port 13552
2021-10-05 13:25:15,723 [Listener at 127.0.0.1/13296] INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:init(158)) - StorageContainerManager metrics system started (again)
2021-10-05 13:25:15,741 [b6de9022-5a0e-4aec-a94e-4e214b276ef3@group-5AA8DAB94A1F-StateMachineUpdater] INFO  safemode.HealthyPipelineSafeModeRule (HealthyPipelineSafeModeRule.java:initializeRule(152)) - Refreshed total pipeline count is 1, healthy pipeline threshold count is 1
2021-10-05 13:25:15,742 [b6de9022-5a0e-4aec-a94e-4e214b276ef3@group-5AA8DAB94A1F-StateMachineUpdater] INFO  safemode.ContainerSafeModeRule (ContainerSafeModeRule.java:reInitializeRule(177)) - Refreshed one replica container threshold 0, currentThreshold 0
2021-10-05 13:25:15,742 [b6de9022-5a0e-4aec-a94e-4e214b276ef3@group-5AA8DAB94A1F-StateMachineUpdater] INFO  safemode.OneReplicaPipelineSafeModeRule (OneReplicaPipelineSafeModeRule.java:initializeRule(176)) - Refreshed Total pipeline count is 1, pipeline's with at least one datanode reported threshold count is 1
2021-10-05 13:25:15,742 [b6de9022-5a0e-4aec-a94e-4e214b276ef3@group-5AA8DAB94A1F-StateMachineUpdater] INFO  server.SCMDatanodeProtocolServer (SCMDatanodeProtocolServer.java:start(181)) - RPC server for DataNodes is listening at /0.0.0.0:13549
2021-10-05 13:25:15,750 [EndpointStateMachine task thread for /127.0.0.1:15041 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15041. Already tried 7 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:15,752 [9cad18a2-4b78-4cb8-813e-2348ce620e43@group-9360A73A2ABC-FollowerState] INFO  impl.FollowerState (FollowerState.java:run(134)) - 9cad18a2-4b78-4cb8-813e-2348ce620e43@group-9360A73A2ABC-FollowerState: change to CANDIDATE, lastRpcElapsedTime:5169289041ns, electionTimeout:5165ms
2021-10-05 13:25:15,753 [9cad18a2-4b78-4cb8-813e-2348ce620e43@group-9360A73A2ABC-FollowerState] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(108)) - 9cad18a2-4b78-4cb8-813e-2348ce620e43: shutdown 9cad18a2-4b78-4cb8-813e-2348ce620e43@group-9360A73A2ABC-FollowerState
2021-10-05 13:25:15,753 [9cad18a2-4b78-4cb8-813e-2348ce620e43@group-9360A73A2ABC-FollowerState] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(285)) - 9cad18a2-4b78-4cb8-813e-2348ce620e43@group-9360A73A2ABC: changes role from  FOLLOWER to CANDIDATE at term 2 for changeToCandidate
2021-10-05 13:25:15,753 [9cad18a2-4b78-4cb8-813e-2348ce620e43@group-9360A73A2ABC-FollowerState] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.leaderelection.pre-vote = false (custom)
2021-10-05 13:25:15,753 [9cad18a2-4b78-4cb8-813e-2348ce620e43@group-9360A73A2ABC-FollowerState] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(130)) - 9cad18a2-4b78-4cb8-813e-2348ce620e43: start 9cad18a2-4b78-4cb8-813e-2348ce620e43@group-9360A73A2ABC-LeaderElection24
2021-10-05 13:25:15,757 [830d4653-8da7-4c59-a1a4-1cd595539218@group-9360A73A2ABC-FollowerState] INFO  impl.FollowerState (FollowerState.java:run(134)) - 830d4653-8da7-4c59-a1a4-1cd595539218@group-9360A73A2ABC-FollowerState: change to CANDIDATE, lastRpcElapsedTime:5178814378ns, electionTimeout:5174ms
2021-10-05 13:25:15,757 [830d4653-8da7-4c59-a1a4-1cd595539218@group-9360A73A2ABC-FollowerState] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(108)) - 830d4653-8da7-4c59-a1a4-1cd595539218: shutdown 830d4653-8da7-4c59-a1a4-1cd595539218@group-9360A73A2ABC-FollowerState
2021-10-05 13:25:15,757 [830d4653-8da7-4c59-a1a4-1cd595539218@group-9360A73A2ABC-FollowerState] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(285)) - 830d4653-8da7-4c59-a1a4-1cd595539218@group-9360A73A2ABC: changes role from  FOLLOWER to CANDIDATE at term 2 for changeToCandidate
2021-10-05 13:25:15,765 [IPC Server Responder] INFO  ipc.Server (Server.java:run(1507)) - IPC Server Responder: starting
2021-10-05 13:25:15,772 [830d4653-8da7-4c59-a1a4-1cd595539218@group-9360A73A2ABC-FollowerState] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.leaderelection.pre-vote = false (custom)
2021-10-05 13:25:15,772 [830d4653-8da7-4c59-a1a4-1cd595539218@group-9360A73A2ABC-FollowerState] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(130)) - 830d4653-8da7-4c59-a1a4-1cd595539218: start 830d4653-8da7-4c59-a1a4-1cd595539218@group-9360A73A2ABC-LeaderElection25
2021-10-05 13:25:15,772 [IPC Server listener on 13549] INFO  ipc.Server (Server.java:run(1344)) - IPC Server listener on 13549: starting
2021-10-05 13:25:15,784 [9cad18a2-4b78-4cb8-813e-2348ce620e43@group-9360A73A2ABC-LeaderElection24] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(306)) - 9cad18a2-4b78-4cb8-813e-2348ce620e43@group-9360A73A2ABC-LeaderElection24 ELECTION round 0: submit vote requests at term 3 for -1: [b668fbba-0931-4533-8c87-c6849aaa836f|rpc:127.0.0.1:40511|dataStream:|priority:0, 830d4653-8da7-4c59-a1a4-1cd595539218|rpc:127.0.0.1:42995|dataStream:|priority:0, 9cad18a2-4b78-4cb8-813e-2348ce620e43|rpc:127.0.0.1:34379|dataStream:|priority:1], old=null
2021-10-05 13:25:15,791 [b668fbba-0931-4533-8c87-c6849aaa836f@group-9360A73A2ABC-FollowerState] INFO  impl.FollowerState (FollowerState.java:run(134)) - b668fbba-0931-4533-8c87-c6849aaa836f@group-9360A73A2ABC-FollowerState: change to CANDIDATE, lastRpcElapsedTime:5189990970ns, electionTimeout:5182ms
2021-10-05 13:25:15,791 [b668fbba-0931-4533-8c87-c6849aaa836f@group-9360A73A2ABC-FollowerState] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(108)) - b668fbba-0931-4533-8c87-c6849aaa836f: shutdown b668fbba-0931-4533-8c87-c6849aaa836f@group-9360A73A2ABC-FollowerState
2021-10-05 13:25:15,792 [b668fbba-0931-4533-8c87-c6849aaa836f@group-9360A73A2ABC-FollowerState] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(285)) - b668fbba-0931-4533-8c87-c6849aaa836f@group-9360A73A2ABC: changes role from  FOLLOWER to CANDIDATE at term 2 for changeToCandidate
2021-10-05 13:25:15,792 [Listener at 127.0.0.1/13296] INFO  server.SCMClientProtocolServer (SCMClientProtocolServer.java:start(164)) - RPC server for Client  is listening at /0.0.0.0:13551
2021-10-05 13:25:15,795 [IPC Server Responder] INFO  ipc.Server (Server.java:run(1507)) - IPC Server Responder: starting
2021-10-05 13:25:15,803 [IPC Server listener on 13551] INFO  ipc.Server (Server.java:run(1344)) - IPC Server listener on 13551: starting
2021-10-05 13:25:15,810 [EndpointStateMachine task thread for /127.0.0.1:15031 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15031. Already tried 11 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:15,817 [EndpointStateMachine task thread for /127.0.0.1:15021 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15021. Already tried 11 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:15,840 [Listener at 127.0.0.1/13296] INFO  server.StorageContainerManager (StorageContainerManager.java:start(1318)) - ScmBlockLocationProtocol RPC server is listening at /0.0.0.0:13550
2021-10-05 13:25:15,840 [Listener at 127.0.0.1/13296] INFO  server.SCMBlockProtocolServer (SCMBlockProtocolServer.java:start(151)) - RPC server for Block Protocol is listening at /0.0.0.0:13550
2021-10-05 13:25:15,841 [IPC Server Responder] INFO  ipc.Server (Server.java:run(1507)) - IPC Server Responder: starting
2021-10-05 13:25:15,841 [IPC Server listener on 13550] INFO  ipc.Server (Server.java:run(1344)) - IPC Server listener on 13550: starting
2021-10-05 13:25:15,842 [Listener at 127.0.0.1/13296] INFO  server.StorageContainerManager (StorageContainerManager.java:start(1324)) - ScmDatanodeProtocl RPC server is listening at /0.0.0.0:13549
2021-10-05 13:25:15,852 [Listener at 127.0.0.1/13296] INFO  http.BaseHttpServer (BaseHttpServer.java:newHttpServer2BuilderForOzone(209)) - Starting Web-server for scm at: http://0.0.0.0:13546
2021-10-05 13:25:15,852 [Listener at 127.0.0.1/13296] INFO  http.BaseHttpServer (BaseHttpServer.java:<init>(107)) - Hadoop Security Enabled: false Ozone Security Enabled: false Ozone HTTP Security Enabled: false 
2021-10-05 13:25:15,853 [Listener at 127.0.0.1/13296] INFO  server.AuthenticationFilter (AuthenticationFilter.java:constructSecretProvider(240)) - Unable to initialize FileSignerSecretProvider, falling back to use random secrets.
2021-10-05 13:25:15,859 [b668fbba-0931-4533-8c87-c6849aaa836f@group-9360A73A2ABC-FollowerState] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.leaderelection.pre-vote = false (custom)
2021-10-05 13:25:15,859 [b668fbba-0931-4533-8c87-c6849aaa836f@group-9360A73A2ABC-FollowerState] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(130)) - b668fbba-0931-4533-8c87-c6849aaa836f: start b668fbba-0931-4533-8c87-c6849aaa836f@group-9360A73A2ABC-LeaderElection26
2021-10-05 13:25:15,867 [org.apache.hadoop.util.JvmPauseMonitor$Monitor@3466cba1] INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(188)) - Starting JVM pause monitor
2021-10-05 13:25:15,875 [grpc-default-executor-4] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1043)) - b668fbba-0931-4533-8c87-c6849aaa836f@group-9360A73A2ABC: receive requestVote(ELECTION, 9cad18a2-4b78-4cb8-813e-2348ce620e43, group-9360A73A2ABC, 3, (t:0, i:0))
2021-10-05 13:25:15,883 [830d4653-8da7-4c59-a1a4-1cd595539218@group-9360A73A2ABC-LeaderElection25] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(306)) - 830d4653-8da7-4c59-a1a4-1cd595539218@group-9360A73A2ABC-LeaderElection25 ELECTION round 0: submit vote requests at term 3 for -1: [b668fbba-0931-4533-8c87-c6849aaa836f|rpc:127.0.0.1:40511|dataStream:|priority:0, 830d4653-8da7-4c59-a1a4-1cd595539218|rpc:127.0.0.1:42995|dataStream:|priority:0, 9cad18a2-4b78-4cb8-813e-2348ce620e43|rpc:127.0.0.1:34379|dataStream:|priority:1], old=null
2021-10-05 13:25:15,886 [grpc-default-executor-5] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1043)) - 830d4653-8da7-4c59-a1a4-1cd595539218@group-9360A73A2ABC: receive requestVote(ELECTION, 9cad18a2-4b78-4cb8-813e-2348ce620e43, group-9360A73A2ABC, 3, (t:0, i:0))
2021-10-05 13:25:15,887 [grpc-default-executor-5] INFO  impl.VoteContext (VoteContext.java:log(48)) - 830d4653-8da7-4c59-a1a4-1cd595539218@group-9360A73A2ABC-CANDIDATE: reject ELECTION from 9cad18a2-4b78-4cb8-813e-2348ce620e43: already has voted for 830d4653-8da7-4c59-a1a4-1cd595539218 at current term 3
2021-10-05 13:25:15,887 [grpc-default-executor-5] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1075)) - 830d4653-8da7-4c59-a1a4-1cd595539218@group-9360A73A2ABC replies to ELECTION vote request: 9cad18a2-4b78-4cb8-813e-2348ce620e43<-830d4653-8da7-4c59-a1a4-1cd595539218#0:FAIL-t3. Peer's state: 830d4653-8da7-4c59-a1a4-1cd595539218@group-9360A73A2ABC:t3, leader=null, voted=830d4653-8da7-4c59-a1a4-1cd595539218, raftlog=830d4653-8da7-4c59-a1a4-1cd595539218@group-9360A73A2ABC-SegmentedRaftLog:OPENED:c-1,f-1,i0, conf=-1: [b668fbba-0931-4533-8c87-c6849aaa836f|rpc:127.0.0.1:40511|dataStream:|priority:0, 830d4653-8da7-4c59-a1a4-1cd595539218|rpc:127.0.0.1:42995|dataStream:|priority:0, 9cad18a2-4b78-4cb8-813e-2348ce620e43|rpc:127.0.0.1:34379|dataStream:|priority:1], old=null
2021-10-05 13:25:15,888 [Listener at 127.0.0.1/13296] WARN  http.HttpRequestLog (HttpRequestLog.java:getRequestLog(103)) - Jetty request log can only be enabled using Log4j
2021-10-05 13:25:15,889 [Listener at 127.0.0.1/13296] INFO  http.HttpServer2 (HttpServer2.java:addGlobalFilter(1030)) - Added global filter 'safety' (class=org.apache.hadoop.hdds.server.http.HttpServer2$QuotingInputFilter)
2021-10-05 13:25:15,889 [Listener at 127.0.0.1/13296] INFO  http.HttpServer2 (HttpServer2.java:addFilter(1006)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context scm
2021-10-05 13:25:15,890 [Listener at 127.0.0.1/13296] INFO  http.HttpServer2 (HttpServer2.java:addFilter(1014)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context static
2021-10-05 13:25:15,890 [Listener at 127.0.0.1/13296] INFO  http.HttpServer2 (HttpServer2.java:addFilter(1014)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context logs
2021-10-05 13:25:15,890 [Listener at 127.0.0.1/13296] INFO  http.HttpServer2 (HttpServer2.java:bindListener(1249)) - Jetty bound to port 13546
2021-10-05 13:25:15,890 [Listener at 127.0.0.1/13296] INFO  server.Server (Server.java:doStart(375)) - jetty-9.4.43.v20210629; built: 2021-06-30T11:07:22.254Z; git: 526006ecfa3af7f1a27ef3a288e2bef7ea9dd7e8; jvm 1.8.0_292-b10
2021-10-05 13:25:15,902 [Listener at 127.0.0.1/13296] INFO  server.session (DefaultSessionIdManager.java:doStart(334)) - DefaultSessionIdManager workerName=node0
2021-10-05 13:25:15,902 [Listener at 127.0.0.1/13296] INFO  server.session (DefaultSessionIdManager.java:doStart(339)) - No SessionScavenger set, using defaults
2021-10-05 13:25:15,902 [Listener at 127.0.0.1/13296] INFO  server.session (HouseKeeper.java:startScavenging(132)) - node0 Scavenging every 660000ms
2021-10-05 13:25:15,903 [Listener at 127.0.0.1/13296] INFO  handler.ContextHandler (ContextHandler.java:doStart(915)) - Started o.e.j.s.ServletContextHandler@64ac6960{logs,/logs,file:///home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/log,AVAILABLE}
2021-10-05 13:25:15,904 [Listener at 127.0.0.1/13296] INFO  handler.ContextHandler (ContextHandler.java:doStart(915)) - Started o.e.j.s.ServletContextHandler@57c7e57{static,/static,file:///home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-classes/webapps/static,AVAILABLE}
2021-10-05 13:25:15,908 [Listener at 127.0.0.1/13296] INFO  handler.ContextHandler (ContextHandler.java:doStart(915)) - Started o.e.j.w.WebAppContext@1b01a0b4{scm,/,file:///home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-classes/webapps/scm/,AVAILABLE}{file:/home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-classes/webapps/scm}
2021-10-05 13:25:15,908 [grpc-default-executor-4] INFO  impl.VoteContext (VoteContext.java:log(48)) - b668fbba-0931-4533-8c87-c6849aaa836f@group-9360A73A2ABC-CANDIDATE: accept ELECTION from 9cad18a2-4b78-4cb8-813e-2348ce620e43: our priority 0 <= candidate's priority 1
2021-10-05 13:25:15,909 [grpc-default-executor-4] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(285)) - b668fbba-0931-4533-8c87-c6849aaa836f@group-9360A73A2ABC: changes role from CANDIDATE to FOLLOWER at term 3 for candidate:9cad18a2-4b78-4cb8-813e-2348ce620e43
2021-10-05 13:25:15,909 [grpc-default-executor-4] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(121)) - b668fbba-0931-4533-8c87-c6849aaa836f: shutdown b668fbba-0931-4533-8c87-c6849aaa836f@group-9360A73A2ABC-LeaderElection26
2021-10-05 13:25:15,909 [grpc-default-executor-4] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(130)) - b668fbba-0931-4533-8c87-c6849aaa836f: start b668fbba-0931-4533-8c87-c6849aaa836f@group-9360A73A2ABC-FollowerState
2021-10-05 13:25:15,909 [b668fbba-0931-4533-8c87-c6849aaa836f@group-9360A73A2ABC-LeaderElection26] INFO  impl.LeaderElection (LeaderElection.java:run(230)) - b668fbba-0931-4533-8c87-c6849aaa836f@group-9360A73A2ABC-LeaderElection26: skip running since this is already CLOSING
2021-10-05 13:25:15,911 [grpc-default-executor-4] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1075)) - b668fbba-0931-4533-8c87-c6849aaa836f@group-9360A73A2ABC replies to ELECTION vote request: 9cad18a2-4b78-4cb8-813e-2348ce620e43<-b668fbba-0931-4533-8c87-c6849aaa836f#0:OK-t3. Peer's state: b668fbba-0931-4533-8c87-c6849aaa836f@group-9360A73A2ABC:t3, leader=null, voted=9cad18a2-4b78-4cb8-813e-2348ce620e43, raftlog=b668fbba-0931-4533-8c87-c6849aaa836f@group-9360A73A2ABC-SegmentedRaftLog:OPENED:c-1,f-1,i0, conf=-1: [b668fbba-0931-4533-8c87-c6849aaa836f|rpc:127.0.0.1:40511|priority:0, 830d4653-8da7-4c59-a1a4-1cd595539218|rpc:127.0.0.1:42995|priority:0, 9cad18a2-4b78-4cb8-813e-2348ce620e43|rpc:127.0.0.1:34379|priority:1], old=null
2021-10-05 13:25:15,914 [IPC Server handler 0 on default port 13549] INFO  ipc.Server (Server.java:run(1026)) - IPC Server handler 0 on default port 13549: skipped Call#317 Retry#0 org.apache.hadoop.ozone.protocol.StorageContainerDatanodeProtocol.submitRequest from 127.0.0.1:47908
2021-10-05 13:25:15,915 [IPC Server handler 0 on default port 13549] INFO  ipc.Server (Server.java:run(1026)) - IPC Server handler 0 on default port 13549: skipped Call#272 Retry#0 org.apache.hadoop.ozone.protocol.StorageContainerDatanodeProtocol.submitRequest from 127.0.0.1:47858
2021-10-05 13:25:15,915 [IPC Server handler 0 on default port 13549] INFO  ipc.Server (Server.java:run(1026)) - IPC Server handler 0 on default port 13549: skipped Call#249 Retry#0 org.apache.hadoop.ozone.protocol.StorageContainerDatanodeProtocol.submitRequest from 127.0.0.1:47820
2021-10-05 13:25:15,915 [IPC Server handler 2 on default port 13549] INFO  ipc.Server (Server.java:run(1026)) - IPC Server handler 2 on default port 13549: skipped Call#355 Retry#0 org.apache.hadoop.ozone.protocol.StorageContainerDatanodeProtocol.submitRequest from 127.0.0.1:47960
2021-10-05 13:25:15,916 [IPC Server handler 2 on default port 13549] INFO  ipc.Server (Server.java:run(1026)) - IPC Server handler 2 on default port 13549: skipped Call#318 Retry#0 org.apache.hadoop.ozone.protocol.StorageContainerDatanodeProtocol.submitRequest from 127.0.0.1:47908
2021-10-05 13:25:15,916 [IPC Server handler 2 on default port 13549] INFO  ipc.Server (Server.java:run(1026)) - IPC Server handler 2 on default port 13549: skipped Call#273 Retry#0 org.apache.hadoop.ozone.protocol.StorageContainerDatanodeProtocol.submitRequest from 127.0.0.1:47858
2021-10-05 13:25:15,916 [IPC Server handler 2 on default port 13549] INFO  ipc.Server (Server.java:run(1026)) - IPC Server handler 2 on default port 13549: skipped Call#252 Retry#0 org.apache.hadoop.ozone.protocol.StorageContainerDatanodeProtocol.submitRequest from 127.0.0.1:47820
2021-10-05 13:25:15,921 [Listener at 127.0.0.1/13296] INFO  server.AbstractConnector (AbstractConnector.java:doStart(331)) - Started ServerConnector@119940b4{HTTP/1.1, (http/1.1)}{0.0.0.0:13546}
2021-10-05 13:25:15,921 [Listener at 127.0.0.1/13296] INFO  server.Server (Server.java:doStart(415)) - Started @109580ms
2021-10-05 13:25:15,921 [Listener at 127.0.0.1/13296] WARN  impl.MetricsSystemImpl (MetricsSystemImpl.java:register(279)) - Sink prometheus already exists!
2021-10-05 13:25:15,922 [IPC Server handler 0 on default port 13549] INFO  ipc.Server (Server.java:run(1026)) - IPC Server handler 0 on default port 13549: skipped Call#356 Retry#0 org.apache.hadoop.ozone.protocol.StorageContainerDatanodeProtocol.submitRequest from 127.0.0.1:47960
2021-10-05 13:25:15,922 [IPC Server handler 0 on default port 13549] INFO  ipc.Server (Server.java:run(1026)) - IPC Server handler 0 on default port 13549: skipped Call#319 Retry#0 org.apache.hadoop.ozone.protocol.StorageContainerDatanodeProtocol.submitRequest from 127.0.0.1:47908
2021-10-05 13:25:15,922 [IPC Server handler 0 on default port 13549] INFO  ipc.Server (Server.java:run(1026)) - IPC Server handler 0 on default port 13549: skipped Call#274 Retry#0 org.apache.hadoop.ozone.protocol.StorageContainerDatanodeProtocol.submitRequest from 127.0.0.1:47858
2021-10-05 13:25:15,923 [IPC Server handler 0 on default port 13549] INFO  ipc.Server (Server.java:run(1026)) - IPC Server handler 0 on default port 13549: skipped Call#255 Retry#0 org.apache.hadoop.ozone.protocol.StorageContainerDatanodeProtocol.submitRequest from 127.0.0.1:47820
2021-10-05 13:25:15,923 [IPC Server handler 0 on default port 13549] INFO  ipc.Server (Server.java:run(1026)) - IPC Server handler 0 on default port 13549: skipped Call#357 Retry#0 org.apache.hadoop.ozone.protocol.StorageContainerDatanodeProtocol.submitRequest from 127.0.0.1:47960
2021-10-05 13:25:15,924 [EndpointStateMachine task thread for /127.0.0.1:13549 - 0 ] INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(300)) - Ignore. OzoneContainer already started.
2021-10-05 13:25:15,924 [Listener at 127.0.0.1/13296] INFO  http.BaseHttpServer (BaseHttpServer.java:updateConnectorAddress(329)) - HTTP server of scm listening at http://0.0.0.0:13546
2021-10-05 13:25:15,924 [Listener at 127.0.0.1/13296] INFO  safemode.SCMSafeModeManager (SCMSafeModeManager.java:exitSafeMode(248)) - SCM exiting safe mode.
2021-10-05 13:25:15,924 [Listener at 127.0.0.1/13296] WARN  events.EventQueue (EventQueue.java:fireEvent(194)) - No event handler registered for event TypedEvent{payloadType=SafeModeStatus, name='Safe mode status'}
2021-10-05 13:25:15,924 [Listener at 127.0.0.1/13296] INFO  ha.SCMContext (SCMContext.java:updateSafeModeStatus(205)) - Update SafeModeStatus from SafeModeStatus{safeModeStatus=true, preCheckPassed=false} to SafeModeStatus{safeModeStatus=false, preCheckPassed=true}.
2021-10-05 13:25:15,925 [EndpointStateMachine task thread for /127.0.0.1:13549 - 0 ] INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(300)) - Ignore. OzoneContainer already started.
2021-10-05 13:25:15,927 [EndpointStateMachine task thread for /127.0.0.1:13549 - 0 ] INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(300)) - Ignore. OzoneContainer already started.
2021-10-05 13:25:15,929 [9cad18a2-4b78-4cb8-813e-2348ce620e43@group-9360A73A2ABC-LeaderElection24] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(89)) - 9cad18a2-4b78-4cb8-813e-2348ce620e43@group-9360A73A2ABC-LeaderElection24: ELECTION PASSED received 2 response(s) and 0 exception(s):
2021-10-05 13:25:15,929 [9cad18a2-4b78-4cb8-813e-2348ce620e43@group-9360A73A2ABC-LeaderElection24] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(93)) -   Response 0: 9cad18a2-4b78-4cb8-813e-2348ce620e43<-b668fbba-0931-4533-8c87-c6849aaa836f#0:OK-t3
2021-10-05 13:25:15,929 [9cad18a2-4b78-4cb8-813e-2348ce620e43@group-9360A73A2ABC-LeaderElection24] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(93)) -   Response 1: 9cad18a2-4b78-4cb8-813e-2348ce620e43<-830d4653-8da7-4c59-a1a4-1cd595539218#0:FAIL-t3
2021-10-05 13:25:15,929 [9cad18a2-4b78-4cb8-813e-2348ce620e43@group-9360A73A2ABC-LeaderElection24] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(308)) - 9cad18a2-4b78-4cb8-813e-2348ce620e43@group-9360A73A2ABC-LeaderElection24 ELECTION round 0: result PASSED
2021-10-05 13:25:15,929 [9cad18a2-4b78-4cb8-813e-2348ce620e43@group-9360A73A2ABC-LeaderElection24] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(121)) - 9cad18a2-4b78-4cb8-813e-2348ce620e43: shutdown 9cad18a2-4b78-4cb8-813e-2348ce620e43@group-9360A73A2ABC-LeaderElection24
2021-10-05 13:25:15,929 [9cad18a2-4b78-4cb8-813e-2348ce620e43@group-9360A73A2ABC-LeaderElection24] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(285)) - 9cad18a2-4b78-4cb8-813e-2348ce620e43@group-9360A73A2ABC: changes role from CANDIDATE to LEADER at term 3 for changeToLeader
2021-10-05 13:25:15,929 [9cad18a2-4b78-4cb8-813e-2348ce620e43@group-9360A73A2ABC-LeaderElection24] INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:handleLeaderChangedNotification(861)) - Leader change notification received for group: group-9360A73A2ABC with new leaderId: 9cad18a2-4b78-4cb8-813e-2348ce620e43
2021-10-05 13:25:15,929 [9cad18a2-4b78-4cb8-813e-2348ce620e43@group-9360A73A2ABC-LeaderElection24] INFO  server.RaftServer$Division (ServerState.java:setLeader(285)) - 9cad18a2-4b78-4cb8-813e-2348ce620e43@group-9360A73A2ABC: change Leader from null to 9cad18a2-4b78-4cb8-813e-2348ce620e43 at term 3 for becomeLeader, leader elected after 15472ms
2021-10-05 13:25:15,929 [grpc-default-executor-4] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1043)) - b668fbba-0931-4533-8c87-c6849aaa836f@group-9360A73A2ABC: receive requestVote(ELECTION, 830d4653-8da7-4c59-a1a4-1cd595539218, group-9360A73A2ABC, 3, (t:0, i:0))
2021-10-05 13:25:15,929 [grpc-default-executor-4] INFO  impl.VoteContext (VoteContext.java:log(48)) - b668fbba-0931-4533-8c87-c6849aaa836f@group-9360A73A2ABC-FOLLOWER: reject ELECTION from 830d4653-8da7-4c59-a1a4-1cd595539218: already has voted for 9cad18a2-4b78-4cb8-813e-2348ce620e43 at current term 3
2021-10-05 13:25:15,929 [grpc-default-executor-4] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1075)) - b668fbba-0931-4533-8c87-c6849aaa836f@group-9360A73A2ABC replies to ELECTION vote request: 830d4653-8da7-4c59-a1a4-1cd595539218<-b668fbba-0931-4533-8c87-c6849aaa836f#0:FAIL-t3. Peer's state: b668fbba-0931-4533-8c87-c6849aaa836f@group-9360A73A2ABC:t3, leader=null, voted=9cad18a2-4b78-4cb8-813e-2348ce620e43, raftlog=b668fbba-0931-4533-8c87-c6849aaa836f@group-9360A73A2ABC-SegmentedRaftLog:OPENED:c-1,f-1,i0, conf=-1: [b668fbba-0931-4533-8c87-c6849aaa836f|rpc:127.0.0.1:40511|priority:0, 830d4653-8da7-4c59-a1a4-1cd595539218|rpc:127.0.0.1:42995|priority:0, 9cad18a2-4b78-4cb8-813e-2348ce620e43|rpc:127.0.0.1:34379|priority:1], old=null
2021-10-05 13:25:15,929 [9cad18a2-4b78-4cb8-813e-2348ce620e43@group-9360A73A2ABC-LeaderElection24] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.staging.catchup.gap = 1000 (default)
2021-10-05 13:25:15,930 [9cad18a2-4b78-4cb8-813e-2348ce620e43@group-9360A73A2ABC-LeaderElection24] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.write.element-limit = 1024 (custom)
2021-10-05 13:25:15,930 [9cad18a2-4b78-4cb8-813e-2348ce620e43@group-9360A73A2ABC-LeaderElection24] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.write.byte-limit = 1024 M (=1073741824) (custom)
2021-10-05 13:25:15,930 [9cad18a2-4b78-4cb8-813e-2348ce620e43@group-9360A73A2ABC-LeaderElection24] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.watch.timeout = 180s (custom)
2021-10-05 13:25:15,930 [9cad18a2-4b78-4cb8-813e-2348ce620e43@group-9360A73A2ABC-LeaderElection24] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.watch.timeout.denomination = 1s (default)
2021-10-05 13:25:15,930 [9cad18a2-4b78-4cb8-813e-2348ce620e43@group-9360A73A2ABC-LeaderElection24] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.watch.element-limit = 65536 (default)
2021-10-05 13:25:15,930 [9cad18a2-4b78-4cb8-813e-2348ce620e43@group-9360A73A2ABC-LeaderElection24] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2021-10-05 13:25:15,931 [9cad18a2-4b78-4cb8-813e-2348ce620e43@group-9360A73A2ABC-LeaderElection24] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2021-10-05 13:25:15,931 [9cad18a2-4b78-4cb8-813e-2348ce620e43@group-9360A73A2ABC-LeaderElection24] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.appender.buffer.element-limit = 1 (custom)
2021-10-05 13:25:15,931 [9cad18a2-4b78-4cb8-813e-2348ce620e43@group-9360A73A2ABC-LeaderElection24] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(44)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2021-10-05 13:25:15,931 [9cad18a2-4b78-4cb8-813e-2348ce620e43@group-9360A73A2ABC-LeaderElection24] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.request.timeout = 60s (custom)
2021-10-05 13:25:15,931 [9cad18a2-4b78-4cb8-813e-2348ce620e43@group-9360A73A2ABC-LeaderElection24] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.appender.install.snapshot.enabled = false (custom)
2021-10-05 13:25:15,933 [9cad18a2-4b78-4cb8-813e-2348ce620e43@group-9360A73A2ABC-LeaderElection24] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2021-10-05 13:25:15,933 [9cad18a2-4b78-4cb8-813e-2348ce620e43@group-9360A73A2ABC-LeaderElection24] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2021-10-05 13:25:15,933 [9cad18a2-4b78-4cb8-813e-2348ce620e43@group-9360A73A2ABC-LeaderElection24] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.appender.buffer.element-limit = 1 (custom)
2021-10-05 13:25:15,933 [9cad18a2-4b78-4cb8-813e-2348ce620e43@group-9360A73A2ABC-LeaderElection24] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(44)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2021-10-05 13:25:15,933 [9cad18a2-4b78-4cb8-813e-2348ce620e43@group-9360A73A2ABC-LeaderElection24] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.request.timeout = 60s (custom)
2021-10-05 13:25:15,933 [9cad18a2-4b78-4cb8-813e-2348ce620e43@group-9360A73A2ABC-LeaderElection24] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.appender.install.snapshot.enabled = false (custom)
2021-10-05 13:25:15,934 [9cad18a2-4b78-4cb8-813e-2348ce620e43@group-9360A73A2ABC-LeaderElection24] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(130)) - 9cad18a2-4b78-4cb8-813e-2348ce620e43: start 9cad18a2-4b78-4cb8-813e-2348ce620e43@group-9360A73A2ABC-LeaderStateImpl
2021-10-05 13:25:15,935 [9cad18a2-4b78-4cb8-813e-2348ce620e43@group-9360A73A2ABC-LeaderElection24] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:startLogSegment(394)) - 9cad18a2-4b78-4cb8-813e-2348ce620e43@group-9360A73A2ABC-SegmentedRaftLogWorker: Starting segment from index:0
2021-10-05 13:25:15,938 [9cad18a2-4b78-4cb8-813e-2348ce620e43@group-9360A73A2ABC-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(601)) - 9cad18a2-4b78-4cb8-813e-2348ce620e43@group-9360A73A2ABC-SegmentedRaftLogWorker: created new log segment /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-36b87918-66c6-4e2c-9c49-5aa8dab94a1f/datanode-2/data/ratis/1cc8aba1-0118-4460-9a8d-9360a73a2abc/current/log_inprogress_0
2021-10-05 13:25:15,938 [Listener at 127.0.0.1/13296] INFO  db.RDBCheckpointManager (RDBCheckpointManager.java:createCheckpoint(86)) - Created checkpoint at /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-36b87918-66c6-4e2c-9c49-5aa8dab94a1f/scmNode-1/db.checkpoints/scm.db_checkpoint_1633440315924 in 14 milliseconds
2021-10-05 13:25:15,942 [grpc-default-executor-4] INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:handleLeaderChangedNotification(861)) - Leader change notification received for group: group-9360A73A2ABC with new leaderId: 9cad18a2-4b78-4cb8-813e-2348ce620e43
2021-10-05 13:25:15,942 [grpc-default-executor-4] INFO  server.RaftServer$Division (ServerState.java:setLeader(285)) - b668fbba-0931-4533-8c87-c6849aaa836f@group-9360A73A2ABC: change Leader from null to 9cad18a2-4b78-4cb8-813e-2348ce620e43 at term 3 for appendEntries, leader elected after 15581ms
2021-10-05 13:25:15,942 [9cad18a2-4b78-4cb8-813e-2348ce620e43@group-9360A73A2ABC-LeaderElection24] INFO  server.RaftServer$Division (ServerState.java:setRaftConf(387)) - 9cad18a2-4b78-4cb8-813e-2348ce620e43@group-9360A73A2ABC: set configuration 0: [b668fbba-0931-4533-8c87-c6849aaa836f|rpc:127.0.0.1:40511|dataStream:|priority:0, 830d4653-8da7-4c59-a1a4-1cd595539218|rpc:127.0.0.1:42995|dataStream:|priority:0, 9cad18a2-4b78-4cb8-813e-2348ce620e43|rpc:127.0.0.1:34379|dataStream:|priority:1], old=null
2021-10-05 13:25:15,967 [EventQueue-PipelineReportForPipelineReportHandler] INFO  pipeline.PipelineManagerImpl (PipelineManagerImpl.java:openPipeline(282)) - Pipeline Pipeline[ Id: 1cc8aba1-0118-4460-9a8d-9360a73a2abc, Nodes: b668fbba-0931-4533-8c87-c6849aaa836f{ip: 127.0.0.1, host: localhost, ports: [REPLICATION=42285, RATIS=40511, RATIS_ADMIN=40511, RATIS_SERVER=40511, STANDALONE=44361], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}830d4653-8da7-4c59-a1a4-1cd595539218{ip: 127.0.0.1, host: localhost, ports: [REPLICATION=34867, RATIS=42995, RATIS_ADMIN=42995, RATIS_SERVER=42995, STANDALONE=44359], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}9cad18a2-4b78-4cb8-813e-2348ce620e43{ip: 127.0.0.1, host: localhost, ports: [REPLICATION=45905, RATIS=34379, RATIS_ADMIN=34379, RATIS_SERVER=34379, STANDALONE=41383], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}, ReplicationConfig: RATIS/THREE, State:ALLOCATED, leaderId:9cad18a2-4b78-4cb8-813e-2348ce620e43, CreationTimestamp2021-10-05T13:24:57.798Z[Etc/UTC]] moved to OPEN state
2021-10-05 13:25:15,967 [EventQueue-PipelineReportForPipelineReportHandler] INFO  pipeline.PipelineManagerImpl (PipelineManagerImpl.java:openPipeline(282)) - Pipeline Pipeline[ Id: 1cc8aba1-0118-4460-9a8d-9360a73a2abc, Nodes: b668fbba-0931-4533-8c87-c6849aaa836f{ip: 127.0.0.1, host: localhost, ports: [REPLICATION=42285, RATIS=40511, RATIS_ADMIN=40511, RATIS_SERVER=40511, STANDALONE=44361], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}830d4653-8da7-4c59-a1a4-1cd595539218{ip: 127.0.0.1, host: localhost, ports: [REPLICATION=34867, RATIS=42995, RATIS_ADMIN=42995, RATIS_SERVER=42995, STANDALONE=44359], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}9cad18a2-4b78-4cb8-813e-2348ce620e43{ip: 127.0.0.1, host: localhost, ports: [REPLICATION=45905, RATIS=34379, RATIS_ADMIN=34379, RATIS_SERVER=34379, STANDALONE=41383], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}, ReplicationConfig: RATIS/THREE, State:ALLOCATED, leaderId:9cad18a2-4b78-4cb8-813e-2348ce620e43, CreationTimestamp2021-10-05T13:24:57.798Z[Etc/UTC]] moved to OPEN state
2021-10-05 13:25:15,967 [EventQueue-PipelineReportForPipelineReportHandler] INFO  ha.SCMHAInvocationHandler (SCMHAInvocationHandler.java:invokeRatis(113)) - Invoking method public abstract void org.apache.hadoop.hdds.scm.pipeline.PipelineStateManager.updatePipelineState(org.apache.hadoop.hdds.protocol.proto.HddsProtos$PipelineID,org.apache.hadoop.hdds.protocol.proto.HddsProtos$PipelineState) throws java.io.IOException on target org.apache.hadoop.hdds.scm.ha.SCMRatisServerImpl@7c75acaa, cost 246.824us
2021-10-05 13:25:15,967 [EventQueue-OpenPipelineForHealthyPipelineSafeModeRule] INFO  safemode.SCMSafeModeManager (HealthyPipelineSafeModeRule.java:process(124)) - SCM in safe mode. Healthy pipelines reported count is 1, required healthy pipeline reported count is 1
2021-10-05 13:25:15,967 [EventQueue-OpenPipelineForHealthyPipelineSafeModeRule] INFO  safemode.SCMSafeModeManager (SCMSafeModeManager.java:validateSafeModeExitRules(204)) - HealthyPipelineSafeModeRule rule is successfully validated
2021-10-05 13:25:15,967 [EventQueue-OpenPipelineForHealthyPipelineSafeModeRule] INFO  safemode.SCMSafeModeManager (SCMSafeModeManager.java:validateSafeModeExitRules(219)) - ScmSafeModeManager, all rules are successfully validated
2021-10-05 13:25:15,967 [EventQueue-OpenPipelineForHealthyPipelineSafeModeRule] INFO  safemode.SCMSafeModeManager (SCMSafeModeManager.java:exitSafeMode(248)) - SCM exiting safe mode.
2021-10-05 13:25:15,967 [EventQueue-OpenPipelineForHealthyPipelineSafeModeRule] WARN  events.EventQueue (EventQueue.java:fireEvent(194)) - No event handler registered for event TypedEvent{payloadType=SafeModeStatus, name='Safe mode status'}
2021-10-05 13:25:15,967 [EventQueue-OpenPipelineForHealthyPipelineSafeModeRule] INFO  ha.SCMContext (SCMContext.java:updateSafeModeStatus(205)) - Update SafeModeStatus from SafeModeStatus{safeModeStatus=true, preCheckPassed=true} to SafeModeStatus{safeModeStatus=false, preCheckPassed=true}.
2021-10-05 13:25:15,970 [grpc-default-executor-2] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(285)) - 830d4653-8da7-4c59-a1a4-1cd595539218@group-9360A73A2ABC: changes role from CANDIDATE to FOLLOWER at term 3 for appendEntries
2021-10-05 13:25:15,970 [grpc-default-executor-2] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(121)) - 830d4653-8da7-4c59-a1a4-1cd595539218: shutdown 830d4653-8da7-4c59-a1a4-1cd595539218@group-9360A73A2ABC-LeaderElection25
2021-10-05 13:25:15,973 [grpc-default-executor-2] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(130)) - 830d4653-8da7-4c59-a1a4-1cd595539218: start 830d4653-8da7-4c59-a1a4-1cd595539218@group-9360A73A2ABC-FollowerState
2021-10-05 13:25:15,974 [grpc-default-executor-4] INFO  server.RaftServer$Division (ServerState.java:setRaftConf(387)) - b668fbba-0931-4533-8c87-c6849aaa836f@group-9360A73A2ABC: set configuration 0: [b668fbba-0931-4533-8c87-c6849aaa836f|rpc:127.0.0.1:40511|dataStream:|priority:0, 830d4653-8da7-4c59-a1a4-1cd595539218|rpc:127.0.0.1:42995|dataStream:|priority:0, 9cad18a2-4b78-4cb8-813e-2348ce620e43|rpc:127.0.0.1:34379|dataStream:|priority:1], old=null
2021-10-05 13:25:15,974 [grpc-default-executor-4] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:startLogSegment(394)) - b668fbba-0931-4533-8c87-c6849aaa836f@group-9360A73A2ABC-SegmentedRaftLogWorker: Starting segment from index:0
2021-10-05 13:25:15,975 [grpc-default-executor-2] INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:handleLeaderChangedNotification(861)) - Leader change notification received for group: group-9360A73A2ABC with new leaderId: 9cad18a2-4b78-4cb8-813e-2348ce620e43
2021-10-05 13:25:15,975 [grpc-default-executor-2] INFO  server.RaftServer$Division (ServerState.java:setLeader(285)) - 830d4653-8da7-4c59-a1a4-1cd595539218@group-9360A73A2ABC: change Leader from null to 9cad18a2-4b78-4cb8-813e-2348ce620e43 at term 3 for appendEntries, leader elected after 15564ms
2021-10-05 13:25:15,976 [IPC Server handler 16 on default port 13549] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/9cad18a2-4b78-4cb8-813e-2348ce620e43
2021-10-05 13:25:15,977 [IPC Server handler 16 on default port 13549] INFO  node.SCMNodeManager (SCMNodeManager.java:register(389)) - Registered Data node : 9cad18a2-4b78-4cb8-813e-2348ce620e43{ip: 127.0.0.1, host: localhost, ports: [REPLICATION=45905, RATIS=34379, RATIS_ADMIN=34379, RATIS_SERVER=34379, STANDALONE=41383], networkLocation: /default-rack, certSerialId: null, persistedOpState: null, persistedOpStateExpiryEpochSec: 0}
2021-10-05 13:25:15,980 [grpc-default-executor-2] INFO  server.RaftServer$Division (ServerState.java:setRaftConf(387)) - 830d4653-8da7-4c59-a1a4-1cd595539218@group-9360A73A2ABC: set configuration 0: [b668fbba-0931-4533-8c87-c6849aaa836f|rpc:127.0.0.1:40511|dataStream:|priority:0, 830d4653-8da7-4c59-a1a4-1cd595539218|rpc:127.0.0.1:42995|dataStream:|priority:0, 9cad18a2-4b78-4cb8-813e-2348ce620e43|rpc:127.0.0.1:34379|dataStream:|priority:1], old=null
2021-10-05 13:25:15,981 [b668fbba-0931-4533-8c87-c6849aaa836f@group-9360A73A2ABC-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(601)) - b668fbba-0931-4533-8c87-c6849aaa836f@group-9360A73A2ABC-SegmentedRaftLogWorker: created new log segment /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-36b87918-66c6-4e2c-9c49-5aa8dab94a1f/datanode-0/data/ratis/1cc8aba1-0118-4460-9a8d-9360a73a2abc/current/log_inprogress_0
2021-10-05 13:25:15,982 [grpc-default-executor-2] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:startLogSegment(394)) - 830d4653-8da7-4c59-a1a4-1cd595539218@group-9360A73A2ABC-SegmentedRaftLogWorker: Starting segment from index:0
2021-10-05 13:25:15,986 [grpc-default-executor-1] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1043)) - 9cad18a2-4b78-4cb8-813e-2348ce620e43@group-9360A73A2ABC: receive requestVote(ELECTION, 830d4653-8da7-4c59-a1a4-1cd595539218, group-9360A73A2ABC, 3, (t:0, i:0))
2021-10-05 13:25:15,986 [grpc-default-executor-1] INFO  impl.VoteContext (VoteContext.java:log(48)) - 9cad18a2-4b78-4cb8-813e-2348ce620e43@group-9360A73A2ABC-LEADER: reject ELECTION from 830d4653-8da7-4c59-a1a4-1cd595539218: already has voted for 9cad18a2-4b78-4cb8-813e-2348ce620e43 at current term 3
2021-10-05 13:25:15,986 [grpc-default-executor-1] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1075)) - 9cad18a2-4b78-4cb8-813e-2348ce620e43@group-9360A73A2ABC replies to ELECTION vote request: 830d4653-8da7-4c59-a1a4-1cd595539218<-9cad18a2-4b78-4cb8-813e-2348ce620e43#0:FAIL-t3. Peer's state: 9cad18a2-4b78-4cb8-813e-2348ce620e43@group-9360A73A2ABC:t3, leader=9cad18a2-4b78-4cb8-813e-2348ce620e43, voted=9cad18a2-4b78-4cb8-813e-2348ce620e43, raftlog=9cad18a2-4b78-4cb8-813e-2348ce620e43@group-9360A73A2ABC-SegmentedRaftLog:OPENED:c0,f0,i0, conf=0: [b668fbba-0931-4533-8c87-c6849aaa836f|rpc:127.0.0.1:40511|dataStream:|priority:0, 830d4653-8da7-4c59-a1a4-1cd595539218|rpc:127.0.0.1:42995|dataStream:|priority:0, 9cad18a2-4b78-4cb8-813e-2348ce620e43|rpc:127.0.0.1:34379|dataStream:|priority:1], old=null
2021-10-05 13:25:15,991 [b6de9022-5a0e-4aec-a94e-4e214b276ef3@group-5AA8DAB94A1F-StateMachineUpdater] ERROR impl.StateMachineUpdater (StateMachineUpdater.java:run(191)) - b6de9022-5a0e-4aec-a94e-4e214b276ef3@group-5AA8DAB94A1F-StateMachineUpdater caught a Throwable.
java.lang.IllegalStateException: b6de9022-5a0e-4aec-a94e-4e214b276ef3: Failed updateLastAppliedTermIndex: newTI = (t:2, i:28) < oldTI = (t:2, i:128)
	at org.apache.ratis.util.Preconditions.assertTrue(Preconditions.java:72)
	at org.apache.ratis.statemachine.impl.BaseStateMachine.updateLastAppliedTermIndex(BaseStateMachine.java:142)
	at org.apache.hadoop.hdds.scm.ha.SCMStateMachine.notifyTermIndexUpdated(SCMStateMachine.java:303)
	at org.apache.ratis.server.impl.RaftServerImpl.applyLogToStateMachine(RaftServerImpl.java:1669)
	at org.apache.ratis.server.impl.StateMachineUpdater.applyLog(StateMachineUpdater.java:234)
	at org.apache.ratis.server.impl.StateMachineUpdater.run(StateMachineUpdater.java:179)
	at java.lang.Thread.run(Thread.java:748)
2021-10-05 13:25:15,991 [b6de9022-5a0e-4aec-a94e-4e214b276ef3@group-5AA8DAB94A1F-StateMachineUpdater] INFO  server.RaftServer$Division (RaftServerImpl.java:lambda$close$4(407)) - b6de9022-5a0e-4aec-a94e-4e214b276ef3@group-5AA8DAB94A1F: shutdown
2021-10-05 13:25:15,991 [b6de9022-5a0e-4aec-a94e-4e214b276ef3@group-5AA8DAB94A1F-StateMachineUpdater] INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-5AA8DAB94A1F,id=b6de9022-5a0e-4aec-a94e-4e214b276ef3
2021-10-05 13:25:15,991 [b6de9022-5a0e-4aec-a94e-4e214b276ef3@group-5AA8DAB94A1F-StateMachineUpdater] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(108)) - b6de9022-5a0e-4aec-a94e-4e214b276ef3: shutdown b6de9022-5a0e-4aec-a94e-4e214b276ef3@group-5AA8DAB94A1F-FollowerState
2021-10-05 13:25:16,001 [830d4653-8da7-4c59-a1a4-1cd595539218@group-9360A73A2ABC-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(601)) - 830d4653-8da7-4c59-a1a4-1cd595539218@group-9360A73A2ABC-SegmentedRaftLogWorker: created new log segment /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-36b87918-66c6-4e2c-9c49-5aa8dab94a1f/datanode-1/data/ratis/1cc8aba1-0118-4460-9a8d-9360a73a2abc/current/log_inprogress_0
2021-10-05 13:25:16,007 [830d4653-8da7-4c59-a1a4-1cd595539218@group-9360A73A2ABC-LeaderElection25] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(89)) - 830d4653-8da7-4c59-a1a4-1cd595539218@group-9360A73A2ABC-LeaderElection25: ELECTION REJECTED received 2 response(s) and 0 exception(s):
2021-10-05 13:25:16,007 [830d4653-8da7-4c59-a1a4-1cd595539218@group-9360A73A2ABC-LeaderElection25] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(93)) -   Response 0: 830d4653-8da7-4c59-a1a4-1cd595539218<-b668fbba-0931-4533-8c87-c6849aaa836f#0:FAIL-t3
2021-10-05 13:25:16,007 [830d4653-8da7-4c59-a1a4-1cd595539218@group-9360A73A2ABC-LeaderElection25] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(93)) -   Response 1: 830d4653-8da7-4c59-a1a4-1cd595539218<-9cad18a2-4b78-4cb8-813e-2348ce620e43#0:FAIL-t3
2021-10-05 13:25:16,008 [EventQueue-PipelineReportForPipelineReportHandler] INFO  ha.SCMHAInvocationHandler (SCMHAInvocationHandler.java:invokeRatis(113)) - Invoking method public abstract void org.apache.hadoop.hdds.scm.pipeline.PipelineStateManager.updatePipelineState(org.apache.hadoop.hdds.protocol.proto.HddsProtos$PipelineID,org.apache.hadoop.hdds.protocol.proto.HddsProtos$PipelineState) throws java.io.IOException on target org.apache.hadoop.hdds.scm.ha.SCMRatisServerImpl@7efc167c, cost 41207.748us
2021-10-05 13:25:16,020 [b6de9022-5a0e-4aec-a94e-4e214b276ef3@group-5AA8DAB94A1F-StateMachineUpdater] INFO  server.RaftServer$Division (ServerState.java:close(419)) - b6de9022-5a0e-4aec-a94e-4e214b276ef3@group-5AA8DAB94A1F: closes. applyIndex: 28
2021-10-05 13:25:16,023 [b6de9022-5a0e-4aec-a94e-4e214b276ef3@group-5AA8DAB94A1F-FollowerState] INFO  impl.FollowerState (FollowerState.java:run(143)) - b6de9022-5a0e-4aec-a94e-4e214b276ef3@group-5AA8DAB94A1F-FollowerState was interrupted: {}
java.lang.InterruptedException: sleep interrupted
	at java.lang.Thread.sleep(Native Method)
	at java.lang.Thread.sleep(Thread.java:340)
	at java.util.concurrent.TimeUnit.sleep(TimeUnit.java:386)
	at org.apache.ratis.util.TimeDuration.sleep(TimeDuration.java:324)
	at org.apache.ratis.util.TimeDuration.sleep(TimeDuration.java:309)
	at org.apache.ratis.server.impl.FollowerState.run(FollowerState.java:118)
2021-10-05 13:25:16,029 [EventQueue-NewNodeForNewNodeHandler] INFO  pipeline.BackgroundPipelineCreator (BackgroundPipelineCreatorV2.java:notifyEventTriggered(279)) - ignore, not leader SCM.
2021-10-05 13:25:16,029 [830d4653-8da7-4c59-a1a4-1cd595539218@group-9360A73A2ABC-LeaderElection25] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(308)) - 830d4653-8da7-4c59-a1a4-1cd595539218@group-9360A73A2ABC-LeaderElection25 ELECTION round 0: result REJECTED
2021-10-05 13:25:16,035 [b6de9022-5a0e-4aec-a94e-4e214b276ef3@group-5AA8DAB94A1F-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:run(327)) - b6de9022-5a0e-4aec-a94e-4e214b276ef3@group-5AA8DAB94A1F-SegmentedRaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2021-10-05 13:25:16,038 [b6de9022-5a0e-4aec-a94e-4e214b276ef3@group-5AA8DAB94A1F-StateMachineUpdater] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:close(237)) - b6de9022-5a0e-4aec-a94e-4e214b276ef3@group-5AA8DAB94A1F-SegmentedRaftLogWorker close()
2021-10-05 13:25:16,043 [21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F-StateMachineUpdater] INFO  ha.SCMStateMachine (SCMStateMachine.java:takeSnapshot(290)) - Current Snapshot Index 30, takeSnapshot took 1 ms
2021-10-05 13:25:16,043 [21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:takeSnapshot(281)) - 21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F-StateMachineUpdater: Took a snapshot at index 30
2021-10-05 13:25:16,043 [21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:lambda$new$0(89)) - 21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F-StateMachineUpdater: snapshotIndex: updateIncreasingly 25 -> 30
2021-10-05 13:25:16,043 [21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:purge(306)) - 21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F-SegmentedRaftLog: purge 30
2021-10-05 13:25:16,043 [21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - 21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F-SegmentedRaftLog: snapshotIndex: updateIncreasingly 25 -> 30
2021-10-05 13:25:16,043 [21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - 21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F-SegmentedRaftLog: purgeIndex: updateToMax old=25, new=30, updated? true
2021-10-05 13:25:16,054 [Listener at 127.0.0.1/13296] INFO  ha.SCMHAManagerImpl (SCMHAManagerImpl.java:installCheckpoint(227)) - Installing checkpoint with SCMTransactionInfo 2#25
2021-10-05 13:25:16,055 [Listener at 127.0.0.1/13296] WARN  ha.SCMHAManagerImpl (SCMHAManagerImpl.java:installCheckpoint(240)) - Cannot proceed with InstallSnapshot as SCM is at TermIndex (t:2, i:28) and checkpoint has lower TermIndex (t:2, i:25). Reloading old state of SCM.
2021-10-05 13:25:16,060 [Listener at 127.0.0.1/13296] INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:shutdown(453)) - Shutting down the Mini Ozone Cluster
2021-10-05 13:25:16,060 [Listener at 127.0.0.1/13296] INFO  ozone.MiniOzoneHAClusterImpl (MiniOzoneHAClusterImpl.java:stop(298)) - Stopping the OzoneManager omNode-1
2021-10-05 13:25:16,060 [Listener at 127.0.0.1/13296] INFO  om.OzoneManager (OzoneManager.java:stop(1644)) - Stopping Ozone Manager
2021-10-05 13:25:16,061 [Listener at 127.0.0.1/13296] INFO  ipc.Server (Server.java:stop(3414)) - Stopping server on 13296
2021-10-05 13:25:16,062 [IPC Server listener on 13296] INFO  ipc.Server (Server.java:run(1376)) - Stopping IPC Server listener on 13296
2021-10-05 13:25:16,063 [IPC Server Responder] INFO  ipc.Server (Server.java:run(1512)) - Stopping IPC Server Responder
2021-10-05 13:25:16,063 [Listener at 127.0.0.1/13296] INFO  server.RaftServer (RaftServerProxy.java:lambda$close$6(391)) - omNode-1: close
2021-10-05 13:25:16,069 [Listener at 127.0.0.1/13296] INFO  server.RaftServer$Division (RaftServerImpl.java:lambda$close$4(407)) - omNode-1@group-523986131536: shutdown
2021-10-05 13:25:16,069 [Listener at 127.0.0.1/13296] INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-523986131536,id=omNode-1
2021-10-05 13:25:16,069 [Listener at 127.0.0.1/13296] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(91)) - omNode-1: shutdown omNode-1@group-523986131536-LeaderStateImpl
2021-10-05 13:25:16,070 [Listener at 127.0.0.1/13296] INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(282)) - omNode-1@group-523986131536-PendingRequests: sendNotLeaderResponses
2021-10-05 13:25:16,070 [omNode-1@group-523986131536-StateMachineUpdater] INFO  ratis.OzoneManagerStateMachine (OzoneManagerStateMachine.java:takeSnapshot(417)) - Current Snapshot Index (t:1, i:0)
2021-10-05 13:25:16,070 [omNode-1@group-523986131536-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:takeSnapshot(281)) - omNode-1@group-523986131536-StateMachineUpdater: Took a snapshot at index 0
2021-10-05 13:25:16,071 [omNode-1@group-523986131536-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:lambda$new$0(89)) - omNode-1@group-523986131536-StateMachineUpdater: snapshotIndex: updateIncreasingly -1 -> 0
2021-10-05 13:25:16,071 [omNode-1@group-523986131536-StateMachineUpdater] INFO  ratis.OzoneManagerStateMachine (OzoneManagerStateMachine.java:close(471)) - StateMachine has shutdown. Shutdown OzoneManager if not already shutdown.
2021-10-05 13:25:16,071 [Listener at 127.0.0.1/13296] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(149)) - omNode-1@group-523986131536-StateMachineUpdater: set stopIndex = 0
2021-10-05 13:25:16,071 [Listener at 127.0.0.1/13296] INFO  server.RaftServer$Division (ServerState.java:close(419)) - omNode-1@group-523986131536: closes. applyIndex: 0
2021-10-05 13:25:16,071 [omNode-1@group-523986131536-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:run(327)) - omNode-1@group-523986131536-SegmentedRaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2021-10-05 13:25:16,074 [Listener at 127.0.0.1/13296] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:close(237)) - omNode-1@group-523986131536-SegmentedRaftLogWorker close()
2021-10-05 13:25:16,076 [Listener at 127.0.0.1/13296] INFO  server.GrpcService (GrpcService.java:closeImpl(262)) - omNode-1: shutdown server with port 13300 now
2021-10-05 13:25:16,079 [Listener at 127.0.0.1/13296] INFO  server.GrpcService (GrpcService.java:closeImpl(271)) - omNode-1: shutdown server with port 13300 successfully
2021-10-05 13:25:16,082 [org.apache.ratis.util.JvmPauseMonitor$$Lambda$499/1586779822@7f4358b8] INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(109)) - JvmPauseMonitor-omNode-1: Stopped
2021-10-05 13:25:16,082 [Listener at 127.0.0.1/13296] INFO  ratis.OzoneManagerDoubleBuffer (OzoneManagerDoubleBuffer.java:stop(437)) - Stopping OMDoubleBuffer flush thread
2021-10-05 13:25:16,082 [OMDoubleBufferFlushThread] INFO  ratis.OzoneManagerDoubleBuffer (OzoneManagerDoubleBuffer.java:flushTransactions(356)) - OMDoubleBuffer flush thread OMDoubleBufferFlushThread is interrupted and will exit. OMDoubleBufferFlushThread
2021-10-05 13:25:16,083 [Listener at 127.0.0.1/13296] INFO  utils.BackgroundService (BackgroundService.java:shutdown(132)) - Shutting down service KeyDeletingService
2021-10-05 13:25:16,083 [Listener at 127.0.0.1/13296] INFO  utils.BackgroundService (BackgroundService.java:shutdown(132)) - Shutting down service DirectoryDeletingService
2021-10-05 13:25:16,087 [Listener at 127.0.0.1/13296] INFO  handler.ContextHandler (ContextHandler.java:doStop(1153)) - Stopped o.e.j.w.WebAppContext@5f3f31df{ozoneManager,/,null,STOPPED}{file:/home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-classes/webapps/ozoneManager}
2021-10-05 13:25:16,089 [Listener at 127.0.0.1/13296] INFO  server.AbstractConnector (AbstractConnector.java:doStop(381)) - Stopped ServerConnector@403eab3{HTTP/1.1, (http/1.1)}{0.0.0.0:13298}
2021-10-05 13:25:16,089 [Listener at 127.0.0.1/13296] INFO  server.session (HouseKeeper.java:stopScavenging(149)) - node0 Stopped scavenging
2021-10-05 13:25:16,090 [Listener at 127.0.0.1/13296] INFO  handler.ContextHandler (ContextHandler.java:doStop(1153)) - Stopped o.e.j.s.ServletContextHandler@3dfabb85{static,/static,file:///home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-classes/webapps/static,STOPPED}
2021-10-05 13:25:16,090 [Listener at 127.0.0.1/13296] INFO  handler.ContextHandler (ContextHandler.java:doStop(1153)) - Stopped o.e.j.s.ServletContextHandler@25dc4d01{logs,/logs,file:///home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/log,STOPPED}
2021-10-05 13:25:16,096 [Listener at 127.0.0.1/13296] INFO  ozone.MiniOzoneHAClusterImpl (MiniOzoneHAClusterImpl.java:stop(306)) - Stopping the StorageContainerManager b6de9022-5a0e-4aec-a94e-4e214b276ef3
2021-10-05 13:25:16,096 [Listener at 127.0.0.1/13296] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1395)) - Stopping Container Balancer service.
2021-10-05 13:25:16,096 [Listener at 127.0.0.1/13296] INFO  balancer.ContainerBalancer (ContainerBalancer.java:stop(742)) - Container Balancer is not running.
2021-10-05 13:25:16,096 [Listener at 127.0.0.1/13296] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1402)) - Stopping Replication Manager Service.
2021-10-05 13:25:16,096 [Listener at 127.0.0.1/13296] INFO  container.ReplicationManager (ReplicationManager.java:stop(350)) - Stopping Replication Monitor Thread.
2021-10-05 13:25:16,096 [Listener at 127.0.0.1/13296] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1409)) - Stopping the Datanode Admin Monitor.
2021-10-05 13:25:16,096 [Listener at 127.0.0.1/13296] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1416)) - Stopping Lease Manager of the command watchers
2021-10-05 13:25:16,097 [Listener at 127.0.0.1/13296] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1423)) - Stopping datanode service RPC server
2021-10-05 13:25:16,097 [Listener at 127.0.0.1/13296] INFO  server.SCMDatanodeProtocolServer (SCMDatanodeProtocolServer.java:stop(389)) - Stopping the RPC server for DataNodes
2021-10-05 13:25:16,097 [Listener at 127.0.0.1/13296] INFO  ipc.Server (Server.java:stop(3414)) - Stopping server on 13549
2021-10-05 13:25:16,099 [IPC Server listener on 13549] INFO  ipc.Server (Server.java:run(1376)) - Stopping IPC Server listener on 13549
2021-10-05 13:25:16,106 [IPC Server Responder] INFO  ipc.Server (Server.java:run(1512)) - Stopping IPC Server Responder
2021-10-05 13:25:16,142 [SCM Heartbeat Processing Thread - 0] WARN  node.NodeStateManager (NodeStateManager.java:scheduleNextHealthCheck(799)) - Current Thread is interrupted, shutting down HB processing thread for Node Manager.
2021-10-05 13:25:16,146 [Listener at 127.0.0.1/13296] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1431)) - Stopping block service RPC server
2021-10-05 13:25:16,146 [Listener at 127.0.0.1/13296] INFO  server.SCMBlockProtocolServer (SCMBlockProtocolServer.java:stop(160)) - Stopping the RPC server for Block Protocol
2021-10-05 13:25:16,146 [Listener at 127.0.0.1/13296] INFO  ipc.Server (Server.java:stop(3414)) - Stopping server on 13550
2021-10-05 13:25:16,148 [IPC Server listener on 13550] INFO  ipc.Server (Server.java:run(1376)) - Stopping IPC Server listener on 13550
2021-10-05 13:25:16,150 [Listener at 127.0.0.1/13296] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1438)) - Stopping the StorageContainerLocationProtocol RPC server
2021-10-05 13:25:16,150 [Listener at 127.0.0.1/13296] INFO  server.SCMClientProtocolServer (SCMClientProtocolServer.java:stop(173)) - Stopping the RPC server for Client Protocol
2021-10-05 13:25:16,150 [Listener at 127.0.0.1/13296] INFO  ipc.Server (Server.java:stop(3414)) - Stopping server on 13551
2021-10-05 13:25:16,151 [IPC Server Responder] INFO  ipc.Server (Server.java:run(1512)) - Stopping IPC Server Responder
2021-10-05 13:25:16,156 [Listener at 127.0.0.1/13296] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1445)) - Stopping Storage Container Manager HTTP server.
2021-10-05 13:25:16,157 [Listener at 127.0.0.1/13296] INFO  handler.ContextHandler (ContextHandler.java:doStop(1153)) - Stopped o.e.j.w.WebAppContext@1b01a0b4{scm,/,null,STOPPED}{file:/home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-classes/webapps/scm}
2021-10-05 13:25:16,157 [IPC Server listener on 13551] INFO  ipc.Server (Server.java:run(1376)) - Stopping IPC Server listener on 13551
2021-10-05 13:25:16,157 [IPC Server Responder] INFO  ipc.Server (Server.java:run(1512)) - Stopping IPC Server Responder
2021-10-05 13:25:16,158 [Listener at 127.0.0.1/13296] INFO  server.AbstractConnector (AbstractConnector.java:doStop(381)) - Stopped ServerConnector@119940b4{HTTP/1.1, (http/1.1)}{0.0.0.0:13546}
2021-10-05 13:25:16,159 [Listener at 127.0.0.1/13296] INFO  server.session (HouseKeeper.java:stopScavenging(149)) - node0 Stopped scavenging
2021-10-05 13:25:16,159 [Listener at 127.0.0.1/13296] INFO  handler.ContextHandler (ContextHandler.java:doStop(1153)) - Stopped o.e.j.s.ServletContextHandler@57c7e57{static,/static,file:///home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-classes/webapps/static,STOPPED}
2021-10-05 13:25:16,159 [Listener at 127.0.0.1/13296] INFO  handler.ContextHandler (ContextHandler.java:doStop(1153)) - Stopped o.e.j.s.ServletContextHandler@64ac6960{logs,/logs,file:///home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/log,STOPPED}
2021-10-05 13:25:16,160 [Listener at 127.0.0.1/13296] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1456)) - Stopping Block Manager Service.
2021-10-05 13:25:16,160 [Listener at 127.0.0.1/13296] INFO  utils.BackgroundService (BackgroundService.java:shutdown(132)) - Shutting down service SCMBlockDeletingService
2021-10-05 13:25:16,161 [Listener at 127.0.0.1/13296] INFO  utils.BackgroundService (BackgroundService.java:shutdown(132)) - Shutting down service SCMBlockDeletingService
2021-10-05 13:25:16,161 [Listener at 127.0.0.1/13296] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1483)) - Stopping SCM Event Queue.
2021-10-05 13:25:16,162 [Listener at 127.0.0.1/13296] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1494)) - Stopping SCM HA services.
2021-10-05 13:25:16,162 [Listener at 127.0.0.1/13296] INFO  ha.SCMRatisServerImpl (SCMRatisServerImpl.java:stop(236)) - stopping ratis server 0.0.0.0:13548
2021-10-05 13:25:16,163 [Listener at 127.0.0.1/13296] INFO  server.RaftServer (RaftServerProxy.java:lambda$close$6(391)) - b6de9022-5a0e-4aec-a94e-4e214b276ef3: close
2021-10-05 13:25:16,163 [Listener at 127.0.0.1/13296] INFO  server.GrpcService (GrpcService.java:closeImpl(262)) - b6de9022-5a0e-4aec-a94e-4e214b276ef3: shutdown server with port 13548 now
2021-10-05 13:25:16,178 [grpc-default-executor-2] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(122)) - b6de9022-5a0e-4aec-a94e-4e214b276ef3: installSnapshot onError, lastRequest: 21490b65-0a55-46f3-b94a-dd719a327c14->b6de9022-5a0e-4aec-a94e-4e214b276ef3#53-t2,previous=(t:2, i:29),leaderCommit=29,initializing? true,entries: size=1, first=(t:2, i:30), METADATAENTRY(c:29): org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2021-10-05 13:25:16,179 [Listener at 127.0.0.1/13296] INFO  server.GrpcService (GrpcService.java:closeImpl(271)) - b6de9022-5a0e-4aec-a94e-4e214b276ef3: shutdown server with port 13548 successfully
2021-10-05 13:25:16,179 [grpc-default-executor-1] WARN  server.GrpcLogAppender (LogUtils.java:warn(122)) - 21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F->b6de9022-5a0e-4aec-a94e-4e214b276ef3-AppendLogResponseHandler: Failed appendEntries: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: HTTP/2 error code: CANCEL
Received Rst Stream
2021-10-05 13:25:16,179 [org.apache.ratis.util.JvmPauseMonitor$$Lambda$499/1586779822@1520485a] INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(109)) - JvmPauseMonitor-b6de9022-5a0e-4aec-a94e-4e214b276ef3: Stopped
2021-10-05 13:25:16,179 [grpc-default-executor-1] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(46)) - 21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F->b6de9022-5a0e-4aec-a94e-4e214b276ef3: nextIndex: updateUnconditionally 31 -> 30
2021-10-05 13:25:16,182 [grpc-default-executor-2] WARN  server.GrpcLogAppender (LogUtils.java:warn(122)) - 21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F->b6de9022-5a0e-4aec-a94e-4e214b276ef3-AppendLogResponseHandler: Failed appendEntries: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
2021-10-05 13:25:16,182 [grpc-default-executor-2] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(46)) - 21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F->b6de9022-5a0e-4aec-a94e-4e214b276ef3: nextIndex: updateUnconditionally 31 -> 30
2021-10-05 13:25:16,186 [Listener at 127.0.0.1/13296] INFO  pipeline.BackgroundPipelineCreator (BackgroundPipelineCreatorV2.java:stop(158)) - Stopping RatisPipelineUtilsThread.
2021-10-05 13:25:16,186 [Listener at 127.0.0.1/13296] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1504)) - Stopping SCM MetadataStore.
2021-10-05 13:25:16,188 [Listener at 127.0.0.1/13296] INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:stop(210)) - Stopping StorageContainerManager metrics system...
2021-10-05 13:25:16,193 [prometheus] INFO  impl.MetricsSinkAdapter (MetricsSinkAdapter.java:publishMetricsFromQueue(141)) - prometheus thread interrupted.
2021-10-05 13:25:16,203 [Listener at 127.0.0.1/13296] INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:stop(216)) - StorageContainerManager metrics system stopped.
2021-10-05 13:25:16,203 [Listener at 127.0.0.1/13296] INFO  ozone.MiniOzoneHAClusterImpl (MiniOzoneHAClusterImpl.java:stop(306)) - Stopping the StorageContainerManager 21490b65-0a55-46f3-b94a-dd719a327c14
2021-10-05 13:25:16,204 [Listener at 127.0.0.1/13296] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1395)) - Stopping Container Balancer service.
2021-10-05 13:25:16,204 [Listener at 127.0.0.1/13296] INFO  balancer.ContainerBalancer (ContainerBalancer.java:stop(742)) - Container Balancer is not running.
2021-10-05 13:25:16,204 [Listener at 127.0.0.1/13296] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1402)) - Stopping Replication Manager Service.
2021-10-05 13:25:16,204 [Listener at 127.0.0.1/13296] INFO  container.ReplicationManager (ReplicationManager.java:stop(350)) - Stopping Replication Monitor Thread.
2021-10-05 13:25:16,204 [Listener at 127.0.0.1/13296] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1409)) - Stopping the Datanode Admin Monitor.
2021-10-05 13:25:16,204 [Listener at 127.0.0.1/13296] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1416)) - Stopping Lease Manager of the command watchers
2021-10-05 13:25:16,204 [Listener at 127.0.0.1/13296] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1423)) - Stopping datanode service RPC server
2021-10-05 13:25:16,204 [Listener at 127.0.0.1/13296] INFO  server.SCMDatanodeProtocolServer (SCMDatanodeProtocolServer.java:stop(389)) - Stopping the RPC server for DataNodes
2021-10-05 13:25:16,204 [Listener at 127.0.0.1/13296] INFO  ipc.Server (Server.java:stop(3414)) - Stopping server on 13529
2021-10-05 13:25:16,220 [IPC Server listener on 13529] INFO  ipc.Server (Server.java:run(1376)) - Stopping IPC Server listener on 13529
2021-10-05 13:25:16,221 [IPC Server Responder] INFO  ipc.Server (Server.java:run(1512)) - Stopping IPC Server Responder
2021-10-05 13:25:16,419 [EndpointStateMachine task thread for /127.0.0.1:13529 - 0 ] WARN  statemachine.EndpointStateMachine (EndpointStateMachine.java:logIfNeeded(236)) - Unable to communicate to SCM server at localhost:13529 for past 0 seconds.
java.io.EOFException: End of File Exception between local host is: "fv-az270-324/10.1.0.10"; destination host is: "localhost":13529; : java.io.EOFException; For more details see:  http://wiki.apache.org/hadoop/EOFException
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.hadoop.net.NetUtils.wrapWithMessage(NetUtils.java:913)
	at org.apache.hadoop.net.NetUtils.wrapException(NetUtils.java:862)
	at org.apache.hadoop.ipc.Client.getRpcResponse(Client.java:1577)
	at org.apache.hadoop.ipc.Client.call(Client.java:1519)
	at org.apache.hadoop.ipc.Client.call(Client.java:1416)
	at org.apache.hadoop.ipc.ProtobufRpcEngine$Invoker.invoke(ProtobufRpcEngine.java:236)
	at org.apache.hadoop.ipc.ProtobufRpcEngine$Invoker.invoke(ProtobufRpcEngine.java:123)
	at com.sun.proxy.$Proxy48.submitRequest(Unknown Source)
	at org.apache.hadoop.ozone.protocolPB.StorageContainerDatanodeProtocolClientSideTranslatorPB.submitRequest(StorageContainerDatanodeProtocolClientSideTranslatorPB.java:117)
	at org.apache.hadoop.ozone.protocolPB.StorageContainerDatanodeProtocolClientSideTranslatorPB.sendHeartbeat(StorageContainerDatanodeProtocolClientSideTranslatorPB.java:149)
	at org.apache.hadoop.ozone.container.common.states.endpoint.HeartbeatEndpointTask.call(HeartbeatEndpointTask.java:179)
	at org.apache.hadoop.ozone.container.common.states.endpoint.HeartbeatEndpointTask.call(HeartbeatEndpointTask.java:82)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.io.EOFException
	at java.io.DataInputStream.readInt(DataInputStream.java:392)
	at org.apache.hadoop.ipc.Client$IpcStreams.readResponse(Client.java:1892)
	at org.apache.hadoop.ipc.Client$Connection.receiveRpcResponse(Client.java:1202)
	at org.apache.hadoop.ipc.Client$Connection.run(Client.java:1098)
2021-10-05 13:25:16,427 [EndpointStateMachine task thread for /127.0.0.1:13549 - 0 ] WARN  statemachine.EndpointStateMachine (EndpointStateMachine.java:logIfNeeded(236)) - Unable to communicate to SCM server at localhost:13549 for past 0 seconds.
java.io.EOFException: End of File Exception between local host is: "fv-az270-324/10.1.0.10"; destination host is: "localhost":13549; : java.io.EOFException; For more details see:  http://wiki.apache.org/hadoop/EOFException
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.hadoop.net.NetUtils.wrapWithMessage(NetUtils.java:913)
	at org.apache.hadoop.net.NetUtils.wrapException(NetUtils.java:862)
	at org.apache.hadoop.ipc.Client.getRpcResponse(Client.java:1577)
	at org.apache.hadoop.ipc.Client.call(Client.java:1519)
	at org.apache.hadoop.ipc.Client.call(Client.java:1416)
	at org.apache.hadoop.ipc.ProtobufRpcEngine$Invoker.invoke(ProtobufRpcEngine.java:236)
	at org.apache.hadoop.ipc.ProtobufRpcEngine$Invoker.invoke(ProtobufRpcEngine.java:123)
	at com.sun.proxy.$Proxy48.submitRequest(Unknown Source)
	at org.apache.hadoop.ozone.protocolPB.StorageContainerDatanodeProtocolClientSideTranslatorPB.submitRequest(StorageContainerDatanodeProtocolClientSideTranslatorPB.java:117)
	at org.apache.hadoop.ozone.protocolPB.StorageContainerDatanodeProtocolClientSideTranslatorPB.register(StorageContainerDatanodeProtocolClientSideTranslatorPB.java:180)
	at org.apache.hadoop.ozone.container.common.states.endpoint.RegisterEndpointTask.call(RegisterEndpointTask.java:158)
	at org.apache.hadoop.ozone.container.common.states.endpoint.RegisterEndpointTask.call(RegisterEndpointTask.java:52)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.io.EOFException
	at java.io.DataInputStream.readInt(DataInputStream.java:392)
	at org.apache.hadoop.ipc.Client$IpcStreams.readResponse(Client.java:1892)
	at org.apache.hadoop.ipc.Client$Connection.receiveRpcResponse(Client.java:1202)
	at org.apache.hadoop.ipc.Client$Connection.run(Client.java:1098)
2021-10-05 13:25:16,751 [EndpointStateMachine task thread for /127.0.0.1:15041 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15041. Already tried 8 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:16,800 [SCM Heartbeat Processing Thread - 0] WARN  node.NodeStateManager (NodeStateManager.java:scheduleNextHealthCheck(799)) - Current Thread is interrupted, shutting down HB processing thread for Node Manager.
2021-10-05 13:25:16,800 [Listener at 127.0.0.1/13296] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1431)) - Stopping block service RPC server
2021-10-05 13:25:16,800 [Listener at 127.0.0.1/13296] INFO  server.SCMBlockProtocolServer (SCMBlockProtocolServer.java:stop(160)) - Stopping the RPC server for Block Protocol
2021-10-05 13:25:16,801 [Listener at 127.0.0.1/13296] INFO  ipc.Server (Server.java:stop(3414)) - Stopping server on 13530
2021-10-05 13:25:16,805 [IPC Server listener on 13530] INFO  ipc.Server (Server.java:run(1376)) - Stopping IPC Server listener on 13530
2021-10-05 13:25:16,805 [Listener at 127.0.0.1/13296] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1438)) - Stopping the StorageContainerLocationProtocol RPC server
2021-10-05 13:25:16,805 [Listener at 127.0.0.1/13296] INFO  server.SCMClientProtocolServer (SCMClientProtocolServer.java:stop(173)) - Stopping the RPC server for Client Protocol
2021-10-05 13:25:16,805 [Listener at 127.0.0.1/13296] INFO  ipc.Server (Server.java:stop(3414)) - Stopping server on 13531
2021-10-05 13:25:16,805 [IPC Server Responder] INFO  ipc.Server (Server.java:run(1512)) - Stopping IPC Server Responder
2021-10-05 13:25:16,811 [EndpointStateMachine task thread for /127.0.0.1:15031 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15031. Already tried 12 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:16,818 [EndpointStateMachine task thread for /127.0.0.1:15021 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15021. Already tried 12 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:16,820 [IPC Server listener on 13531] INFO  ipc.Server (Server.java:run(1376)) - Stopping IPC Server listener on 13531
2021-10-05 13:25:16,820 [Listener at 127.0.0.1/13296] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1445)) - Stopping Storage Container Manager HTTP server.
2021-10-05 13:25:16,820 [IPC Server Responder] INFO  ipc.Server (Server.java:run(1512)) - Stopping IPC Server Responder
2021-10-05 13:25:16,821 [Listener at 127.0.0.1/13296] INFO  handler.ContextHandler (ContextHandler.java:doStop(1153)) - Stopped o.e.j.w.WebAppContext@9d7522{scm,/,null,STOPPED}{file:/home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-classes/webapps/scm}
2021-10-05 13:25:16,822 [Listener at 127.0.0.1/13296] INFO  server.AbstractConnector (AbstractConnector.java:doStop(381)) - Stopped ServerConnector@66b46edd{HTTP/1.1, (http/1.1)}{0.0.0.0:13526}
2021-10-05 13:25:16,822 [Listener at 127.0.0.1/13296] INFO  server.session (HouseKeeper.java:stopScavenging(149)) - node0 Stopped scavenging
2021-10-05 13:25:16,822 [Listener at 127.0.0.1/13296] INFO  handler.ContextHandler (ContextHandler.java:doStop(1153)) - Stopped o.e.j.s.ServletContextHandler@36d61bbf{static,/static,file:///home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-classes/webapps/static,STOPPED}
2021-10-05 13:25:16,822 [Listener at 127.0.0.1/13296] INFO  handler.ContextHandler (ContextHandler.java:doStop(1153)) - Stopped o.e.j.s.ServletContextHandler@27d74f45{logs,/logs,file:///home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/log,STOPPED}
2021-10-05 13:25:16,823 [Listener at 127.0.0.1/13296] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1456)) - Stopping Block Manager Service.
2021-10-05 13:25:16,824 [Listener at 127.0.0.1/13296] INFO  utils.BackgroundService (BackgroundService.java:shutdown(132)) - Shutting down service SCMBlockDeletingService
2021-10-05 13:25:16,824 [Listener at 127.0.0.1/13296] INFO  utils.BackgroundService (BackgroundService.java:shutdown(132)) - Shutting down service SCMBlockDeletingService
2021-10-05 13:25:16,824 [Listener at 127.0.0.1/13296] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1483)) - Stopping SCM Event Queue.
2021-10-05 13:25:16,826 [Listener at 127.0.0.1/13296] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1494)) - Stopping SCM HA services.
2021-10-05 13:25:16,826 [Listener at 127.0.0.1/13296] INFO  ha.SCMRatisServerImpl (SCMRatisServerImpl.java:stop(236)) - stopping ratis server 0.0.0.0:13528
2021-10-05 13:25:16,827 [Listener at 127.0.0.1/13296] INFO  server.RaftServer (RaftServerProxy.java:lambda$close$6(391)) - 21490b65-0a55-46f3-b94a-dd719a327c14: close
2021-10-05 13:25:16,827 [Listener at 127.0.0.1/13296] INFO  server.RaftServer$Division (RaftServerImpl.java:lambda$close$4(407)) - 21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F: shutdown
2021-10-05 13:25:16,827 [Listener at 127.0.0.1/13296] INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-5AA8DAB94A1F,id=21490b65-0a55-46f3-b94a-dd719a327c14
2021-10-05 13:25:16,828 [Listener at 127.0.0.1/13296] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(91)) - 21490b65-0a55-46f3-b94a-dd719a327c14: shutdown 21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F-LeaderStateImpl
2021-10-05 13:25:16,829 [21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F->6d234f4d-474a-4c74-a9e9-8f3885fce584-GrpcLogAppender-LogAppenderDaemon] WARN  server.GrpcLogAppender (GrpcLogAppender.java:mayWait(175)) - 21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F->6d234f4d-474a-4c74-a9e9-8f3885fce584-GrpcLogAppender: Wait interrupted by java.lang.InterruptedException
2021-10-05 13:25:16,829 [Listener at 127.0.0.1/13296] INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(282)) - 21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F-PendingRequests: sendNotLeaderResponses
2021-10-05 13:25:16,829 [grpc-default-executor-2] INFO  server.GrpcServerProtocolService (GrpcServerProtocolService.java:onCompleted(140)) - 6d234f4d-474a-4c74-a9e9-8f3885fce584: Completed APPEND_ENTRIES, lastRequest: 21490b65-0a55-46f3-b94a-dd719a327c14->6d234f4d-474a-4c74-a9e9-8f3885fce584#1160-t2,previous=(t:2, i:29),leaderCommit=29,initializing? true,entries: size=1, first=(t:2, i:30), METADATAENTRY(c:29)
2021-10-05 13:25:16,829 [21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F->b6de9022-5a0e-4aec-a94e-4e214b276ef3-GrpcLogAppender-LogAppenderDaemon] WARN  server.GrpcLogAppender (GrpcLogAppender.java:mayWait(175)) - 21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F->b6de9022-5a0e-4aec-a94e-4e214b276ef3-GrpcLogAppender: Wait interrupted by java.lang.InterruptedException
2021-10-05 13:25:16,830 [Listener at 127.0.0.1/13296] INFO  ha.SCMStateMachine (SCMStateMachine.java:notifyNotLeader(183)) - current leader SCM steps down.
2021-10-05 13:25:16,830 [Listener at 127.0.0.1/13296] INFO  ha.SCMContext (SCMContext.java:updateLeaderAndTerm(88)) - update <isLeader,term> from <true,2> to <false,0>
2021-10-05 13:25:16,830 [Listener at 127.0.0.1/13296] INFO  ha.SCMContext (SCMContext.java:updateLeaderAndTerm(95)) - update <isLeaderReady> from <false> to <false>
2021-10-05 13:25:16,833 [grpc-default-executor-2] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onCompleted(344)) - 21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F->6d234f4d-474a-4c74-a9e9-8f3885fce584-AppendLogResponseHandler: follower responses appendEntries COMPLETED
2021-10-05 13:25:16,833 [grpc-default-executor-2] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(46)) - 21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F->6d234f4d-474a-4c74-a9e9-8f3885fce584: nextIndex: updateUnconditionally 31 -> 30
2021-10-05 13:25:16,836 [Listener at 127.0.0.1/13296] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(149)) - 21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F-StateMachineUpdater: set stopIndex = 30
2021-10-05 13:25:16,836 [Listener at 127.0.0.1/13296] INFO  server.RaftServer$Division (ServerState.java:close(419)) - 21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F: closes. applyIndex: 30
2021-10-05 13:25:16,836 [21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:run(327)) - 21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F-SegmentedRaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2021-10-05 13:25:16,837 [Listener at 127.0.0.1/13296] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:close(237)) - 21490b65-0a55-46f3-b94a-dd719a327c14@group-5AA8DAB94A1F-SegmentedRaftLogWorker close()
2021-10-05 13:25:16,841 [Listener at 127.0.0.1/13296] INFO  server.GrpcService (GrpcService.java:closeImpl(262)) - 21490b65-0a55-46f3-b94a-dd719a327c14: shutdown server with port 13528 now
2021-10-05 13:25:16,849 [Listener at 127.0.0.1/13296] INFO  server.GrpcService (GrpcService.java:closeImpl(271)) - 21490b65-0a55-46f3-b94a-dd719a327c14: shutdown server with port 13528 successfully
2021-10-05 13:25:16,850 [org.apache.ratis.util.JvmPauseMonitor$$Lambda$499/1586779822@561d0389] INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(109)) - JvmPauseMonitor-21490b65-0a55-46f3-b94a-dd719a327c14: Stopped
2021-10-05 13:25:16,851 [Listener at 127.0.0.1/13296] INFO  pipeline.BackgroundPipelineCreator (BackgroundPipelineCreatorV2.java:stop(158)) - Stopping RatisPipelineUtilsThread.
2021-10-05 13:25:16,851 [Listener at 127.0.0.1/13296] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1504)) - Stopping SCM MetadataStore.
2021-10-05 13:25:16,852 [Listener at 127.0.0.1/13296] INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:stop(205)) - StorageContainerManager metrics system stopped (again)
2021-10-05 13:25:16,852 [Listener at 127.0.0.1/13296] INFO  ozone.MiniOzoneHAClusterImpl (MiniOzoneHAClusterImpl.java:stop(306)) - Stopping the StorageContainerManager 6d234f4d-474a-4c74-a9e9-8f3885fce584
2021-10-05 13:25:16,852 [Listener at 127.0.0.1/13296] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1395)) - Stopping Container Balancer service.
2021-10-05 13:25:16,852 [Listener at 127.0.0.1/13296] INFO  balancer.ContainerBalancer (ContainerBalancer.java:stop(742)) - Container Balancer is not running.
2021-10-05 13:25:16,852 [Listener at 127.0.0.1/13296] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1402)) - Stopping Replication Manager Service.
2021-10-05 13:25:16,852 [Listener at 127.0.0.1/13296] INFO  container.ReplicationManager (ReplicationManager.java:stop(350)) - Stopping Replication Monitor Thread.
2021-10-05 13:25:16,852 [Listener at 127.0.0.1/13296] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1409)) - Stopping the Datanode Admin Monitor.
2021-10-05 13:25:16,853 [Listener at 127.0.0.1/13296] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1416)) - Stopping Lease Manager of the command watchers
2021-10-05 13:25:16,853 [Listener at 127.0.0.1/13296] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1423)) - Stopping datanode service RPC server
2021-10-05 13:25:16,855 [Listener at 127.0.0.1/13296] INFO  server.SCMDatanodeProtocolServer (SCMDatanodeProtocolServer.java:stop(389)) - Stopping the RPC server for DataNodes
2021-10-05 13:25:16,855 [Listener at 127.0.0.1/13296] INFO  ipc.Server (Server.java:stop(3414)) - Stopping server on 13539
2021-10-05 13:25:16,858 [IPC Server listener on 13539] INFO  ipc.Server (Server.java:run(1376)) - Stopping IPC Server listener on 13539
2021-10-05 13:25:16,858 [IPC Server Responder] INFO  ipc.Server (Server.java:run(1512)) - Stopping IPC Server Responder
2021-10-05 13:25:16,926 [SCM Heartbeat Processing Thread - 0] WARN  node.NodeStateManager (NodeStateManager.java:scheduleNextHealthCheck(799)) - Current Thread is interrupted, shutting down HB processing thread for Node Manager.
2021-10-05 13:25:16,926 [Listener at 127.0.0.1/13296] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1431)) - Stopping block service RPC server
2021-10-05 13:25:16,926 [Listener at 127.0.0.1/13296] INFO  server.SCMBlockProtocolServer (SCMBlockProtocolServer.java:stop(160)) - Stopping the RPC server for Block Protocol
2021-10-05 13:25:16,926 [Listener at 127.0.0.1/13296] INFO  ipc.Server (Server.java:stop(3414)) - Stopping server on 13540
2021-10-05 13:25:16,935 [IPC Server listener on 13540] INFO  ipc.Server (Server.java:run(1376)) - Stopping IPC Server listener on 13540
2021-10-05 13:25:16,935 [Listener at 127.0.0.1/13296] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1438)) - Stopping the StorageContainerLocationProtocol RPC server
2021-10-05 13:25:16,935 [Listener at 127.0.0.1/13296] INFO  server.SCMClientProtocolServer (SCMClientProtocolServer.java:stop(173)) - Stopping the RPC server for Client Protocol
2021-10-05 13:25:16,935 [Listener at 127.0.0.1/13296] INFO  ipc.Server (Server.java:stop(3414)) - Stopping server on 13541
2021-10-05 13:25:16,936 [IPC Server Responder] INFO  ipc.Server (Server.java:run(1512)) - Stopping IPC Server Responder
2021-10-05 13:25:16,941 [IPC Server Responder] INFO  ipc.Server (Server.java:run(1512)) - Stopping IPC Server Responder
2021-10-05 13:25:16,941 [IPC Server listener on 13541] INFO  ipc.Server (Server.java:run(1376)) - Stopping IPC Server listener on 13541
2021-10-05 13:25:16,944 [EndpointStateMachine task thread for /127.0.0.1:13539 - 0 ] WARN  statemachine.EndpointStateMachine (EndpointStateMachine.java:logIfNeeded(236)) - Unable to communicate to SCM server at 127.0.0.1:13539 for past 0 seconds.
java.io.EOFException: End of File Exception between local host is: "fv-az270-324/10.1.0.10"; destination host is: "localhost":13539; : java.io.EOFException; For more details see:  http://wiki.apache.org/hadoop/EOFException
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.hadoop.net.NetUtils.wrapWithMessage(NetUtils.java:913)
	at org.apache.hadoop.net.NetUtils.wrapException(NetUtils.java:862)
	at org.apache.hadoop.ipc.Client.getRpcResponse(Client.java:1577)
	at org.apache.hadoop.ipc.Client.call(Client.java:1519)
	at org.apache.hadoop.ipc.Client.call(Client.java:1416)
	at org.apache.hadoop.ipc.ProtobufRpcEngine$Invoker.invoke(ProtobufRpcEngine.java:236)
	at org.apache.hadoop.ipc.ProtobufRpcEngine$Invoker.invoke(ProtobufRpcEngine.java:123)
	at com.sun.proxy.$Proxy48.submitRequest(Unknown Source)
	at org.apache.hadoop.ozone.protocolPB.StorageContainerDatanodeProtocolClientSideTranslatorPB.submitRequest(StorageContainerDatanodeProtocolClientSideTranslatorPB.java:117)
	at org.apache.hadoop.ozone.protocolPB.StorageContainerDatanodeProtocolClientSideTranslatorPB.sendHeartbeat(StorageContainerDatanodeProtocolClientSideTranslatorPB.java:149)
	at org.apache.hadoop.ozone.container.common.states.endpoint.HeartbeatEndpointTask.call(HeartbeatEndpointTask.java:179)
	at org.apache.hadoop.ozone.container.common.states.endpoint.HeartbeatEndpointTask.call(HeartbeatEndpointTask.java:82)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.io.EOFException
	at java.io.DataInputStream.readInt(DataInputStream.java:392)
	at org.apache.hadoop.ipc.Client$IpcStreams.readResponse(Client.java:1892)
	at org.apache.hadoop.ipc.Client$Connection.receiveRpcResponse(Client.java:1202)
	at org.apache.hadoop.ipc.Client$Connection.run(Client.java:1098)
2021-10-05 13:25:16,947 [Listener at 127.0.0.1/13296] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1445)) - Stopping Storage Container Manager HTTP server.
2021-10-05 13:25:16,948 [Listener at 127.0.0.1/13296] INFO  handler.ContextHandler (ContextHandler.java:doStop(1153)) - Stopped o.e.j.w.WebAppContext@14c4b3e1{scm,/,null,STOPPED}{file:/home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-classes/webapps/scm}
2021-10-05 13:25:16,949 [Listener at 127.0.0.1/13296] INFO  server.AbstractConnector (AbstractConnector.java:doStop(381)) - Stopped ServerConnector@4dfb114e{HTTP/1.1, (http/1.1)}{0.0.0.0:13536}
2021-10-05 13:25:16,949 [Listener at 127.0.0.1/13296] INFO  server.session (HouseKeeper.java:stopScavenging(149)) - node0 Stopped scavenging
2021-10-05 13:25:16,950 [Listener at 127.0.0.1/13296] INFO  handler.ContextHandler (ContextHandler.java:doStop(1153)) - Stopped o.e.j.s.ServletContextHandler@48cea80f{static,/static,file:///home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-classes/webapps/static,STOPPED}
2021-10-05 13:25:16,950 [Listener at 127.0.0.1/13296] INFO  handler.ContextHandler (ContextHandler.java:doStop(1153)) - Stopped o.e.j.s.ServletContextHandler@76838ab3{logs,/logs,file:///home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/log,STOPPED}
2021-10-05 13:25:16,951 [Listener at 127.0.0.1/13296] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1456)) - Stopping Block Manager Service.
2021-10-05 13:25:16,952 [Listener at 127.0.0.1/13296] INFO  utils.BackgroundService (BackgroundService.java:shutdown(132)) - Shutting down service SCMBlockDeletingService
2021-10-05 13:25:16,952 [Listener at 127.0.0.1/13296] INFO  utils.BackgroundService (BackgroundService.java:shutdown(132)) - Shutting down service SCMBlockDeletingService
2021-10-05 13:25:16,952 [Listener at 127.0.0.1/13296] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1483)) - Stopping SCM Event Queue.
2021-10-05 13:25:16,953 [Listener at 127.0.0.1/13296] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1494)) - Stopping SCM HA services.
2021-10-05 13:25:16,953 [Listener at 127.0.0.1/13296] INFO  ha.SCMRatisServerImpl (SCMRatisServerImpl.java:stop(236)) - stopping ratis server 0.0.0.0:13538
2021-10-05 13:25:16,953 [Listener at 127.0.0.1/13296] INFO  server.RaftServer (RaftServerProxy.java:lambda$close$6(391)) - 6d234f4d-474a-4c74-a9e9-8f3885fce584: close
2021-10-05 13:25:16,954 [Listener at 127.0.0.1/13296] INFO  server.RaftServer$Division (RaftServerImpl.java:lambda$close$4(407)) - 6d234f4d-474a-4c74-a9e9-8f3885fce584@group-5AA8DAB94A1F: shutdown
2021-10-05 13:25:16,954 [Listener at 127.0.0.1/13296] INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-5AA8DAB94A1F,id=6d234f4d-474a-4c74-a9e9-8f3885fce584
2021-10-05 13:25:16,954 [Listener at 127.0.0.1/13296] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(108)) - 6d234f4d-474a-4c74-a9e9-8f3885fce584: shutdown 6d234f4d-474a-4c74-a9e9-8f3885fce584@group-5AA8DAB94A1F-FollowerState
2021-10-05 13:25:16,954 [6d234f4d-474a-4c74-a9e9-8f3885fce584@group-5AA8DAB94A1F-FollowerState] INFO  impl.FollowerState (FollowerState.java:run(143)) - 6d234f4d-474a-4c74-a9e9-8f3885fce584@group-5AA8DAB94A1F-FollowerState was interrupted: {}
java.lang.InterruptedException: sleep interrupted
	at java.lang.Thread.sleep(Native Method)
	at java.lang.Thread.sleep(Thread.java:340)
	at java.util.concurrent.TimeUnit.sleep(TimeUnit.java:386)
	at org.apache.ratis.util.TimeDuration.sleep(TimeDuration.java:324)
	at org.apache.ratis.util.TimeDuration.sleep(TimeDuration.java:309)
	at org.apache.ratis.server.impl.FollowerState.run(FollowerState.java:118)
2021-10-05 13:25:16,955 [6d234f4d-474a-4c74-a9e9-8f3885fce584@group-5AA8DAB94A1F-StateMachineUpdater] INFO  ha.SCMStateMachine (SCMStateMachine.java:takeSnapshot(290)) - Current Snapshot Index 29, takeSnapshot took 0 ms
2021-10-05 13:25:16,955 [6d234f4d-474a-4c74-a9e9-8f3885fce584@group-5AA8DAB94A1F-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:takeSnapshot(281)) - 6d234f4d-474a-4c74-a9e9-8f3885fce584@group-5AA8DAB94A1F-StateMachineUpdater: Took a snapshot at index 29
2021-10-05 13:25:16,955 [6d234f4d-474a-4c74-a9e9-8f3885fce584@group-5AA8DAB94A1F-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:lambda$new$0(89)) - 6d234f4d-474a-4c74-a9e9-8f3885fce584@group-5AA8DAB94A1F-StateMachineUpdater: snapshotIndex: updateIncreasingly 25 -> 29
2021-10-05 13:25:16,955 [Listener at 127.0.0.1/13296] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(149)) - 6d234f4d-474a-4c74-a9e9-8f3885fce584@group-5AA8DAB94A1F-StateMachineUpdater: set stopIndex = 29
2021-10-05 13:25:16,955 [Listener at 127.0.0.1/13296] INFO  server.RaftServer$Division (ServerState.java:close(419)) - 6d234f4d-474a-4c74-a9e9-8f3885fce584@group-5AA8DAB94A1F: closes. applyIndex: 28
2021-10-05 13:25:16,956 [6d234f4d-474a-4c74-a9e9-8f3885fce584@group-5AA8DAB94A1F-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:run(327)) - 6d234f4d-474a-4c74-a9e9-8f3885fce584@group-5AA8DAB94A1F-SegmentedRaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2021-10-05 13:25:16,956 [Listener at 127.0.0.1/13296] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:close(237)) - 6d234f4d-474a-4c74-a9e9-8f3885fce584@group-5AA8DAB94A1F-SegmentedRaftLogWorker close()
2021-10-05 13:25:16,957 [Listener at 127.0.0.1/13296] INFO  server.GrpcService (GrpcService.java:closeImpl(262)) - 6d234f4d-474a-4c74-a9e9-8f3885fce584: shutdown server with port 13538 now
2021-10-05 13:25:16,961 [Listener at 127.0.0.1/13296] INFO  server.GrpcService (GrpcService.java:closeImpl(271)) - 6d234f4d-474a-4c74-a9e9-8f3885fce584: shutdown server with port 13538 successfully
2021-10-05 13:25:16,961 [org.apache.ratis.util.JvmPauseMonitor$$Lambda$499/1586779822@d2df0f5] INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(109)) - JvmPauseMonitor-6d234f4d-474a-4c74-a9e9-8f3885fce584: Stopped
2021-10-05 13:25:16,961 [Listener at 127.0.0.1/13296] INFO  pipeline.BackgroundPipelineCreator (BackgroundPipelineCreatorV2.java:stop(158)) - Stopping RatisPipelineUtilsThread.
2021-10-05 13:25:16,962 [Listener at 127.0.0.1/13296] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1504)) - Stopping SCM MetadataStore.
2021-10-05 13:25:16,964 [Listener at 127.0.0.1/13296] INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:stop(205)) - StorageContainerManager metrics system stopped (again)
2021-10-05 13:25:16,965 [Listener at 127.0.0.1/13296] INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:stop(468)) - Stopping the Mini Ozone Cluster
2021-10-05 13:25:16,965 [Listener at 127.0.0.1/13296] INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:stopDatanodes(527)) - Stopping the HddsDatanodes
2021-10-05 13:25:17,742 [Datanode State Machine Thread - 0] WARN  statemachine.StateContext (StateContext.java:setState(246)) - Ignore disallowed transition from SHUTDOWN to RUNNING
2021-10-05 13:25:17,742 [EndpointStateMachine task thread for /127.0.0.1:13529 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:13529. Already tried 0 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:17,743 [EndpointStateMachine task thread for /127.0.0.1:13549 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:13549. Already tried 0 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:17,751 [EndpointStateMachine task thread for /127.0.0.1:15041 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15041. Already tried 9 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:17,811 [EndpointStateMachine task thread for /127.0.0.1:15031 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15031. Already tried 13 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:17,818 [EndpointStateMachine task thread for /127.0.0.1:15021 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15021. Already tried 13 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:18,743 [EndpointStateMachine task thread for /127.0.0.1:13529 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:13529. Already tried 1 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:18,744 [EndpointStateMachine task thread for /127.0.0.1:13549 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:13549. Already tried 1 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:18,751 [EndpointStateMachine task thread for /127.0.0.1:15041 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15041. Already tried 10 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:18,811 [EndpointStateMachine task thread for /127.0.0.1:15031 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15031. Already tried 14 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:18,819 [EndpointStateMachine task thread for /127.0.0.1:15021 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15021. Already tried 14 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:18,943 [EndpointStateMachine task thread for /127.0.0.1:13539 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:13539. Already tried 0 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:19,744 [EndpointStateMachine task thread for /127.0.0.1:13529 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:13529. Already tried 2 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:19,744 [EndpointStateMachine task thread for /127.0.0.1:13549 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:13549. Already tried 2 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:19,752 [EndpointStateMachine task thread for /127.0.0.1:15041 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15041. Already tried 11 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:19,813 [EndpointStateMachine task thread for /127.0.0.1:15031 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15031. Already tried 0 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:19,820 [EndpointStateMachine task thread for /127.0.0.1:15021 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15021. Already tried 0 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:19,943 [EndpointStateMachine task thread for /127.0.0.1:13539 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:13539. Already tried 1 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:20,744 [EndpointStateMachine task thread for /127.0.0.1:13529 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:13529. Already tried 3 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:20,745 [EndpointStateMachine task thread for /127.0.0.1:13549 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:13549. Already tried 3 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:20,752 [EndpointStateMachine task thread for /127.0.0.1:15041 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15041. Already tried 12 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:20,813 [EndpointStateMachine task thread for /127.0.0.1:15031 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15031. Already tried 1 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:20,820 [EndpointStateMachine task thread for /127.0.0.1:15021 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15021. Already tried 1 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:20,944 [EndpointStateMachine task thread for /127.0.0.1:13539 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:13539. Already tried 2 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:21,745 [EndpointStateMachine task thread for /127.0.0.1:13529 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:13529. Already tried 4 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:21,745 [EndpointStateMachine task thread for /127.0.0.1:13549 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:13549. Already tried 4 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:21,752 [EndpointStateMachine task thread for /127.0.0.1:15041 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15041. Already tried 13 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:21,813 [EndpointStateMachine task thread for /127.0.0.1:15031 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15031. Already tried 2 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:21,820 [EndpointStateMachine task thread for /127.0.0.1:15021 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15021. Already tried 2 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:21,944 [EndpointStateMachine task thread for /127.0.0.1:13539 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:13539. Already tried 3 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:21,965 [Listener at 127.0.0.1/13296] INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(325)) - Attempting to stop container services.
2021-10-05 13:25:21,966 [ForkJoinPool.commonPool-worker-0] INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(325)) - Attempting to stop container services.
2021-10-05 13:25:21,967 [Listener at 127.0.0.1/13296] INFO  server.RaftServer (RaftServerProxy.java:lambda$close$6(391)) - 830d4653-8da7-4c59-a1a4-1cd595539218: close
2021-10-05 13:25:21,967 [ForkJoinPool.commonPool-worker-0] INFO  server.RaftServer (RaftServerProxy.java:lambda$close$6(391)) - b668fbba-0931-4533-8c87-c6849aaa836f: close
2021-10-05 13:25:21,967 [Listener at 127.0.0.1/13296] INFO  server.RaftServer$Division (RaftServerImpl.java:lambda$close$4(407)) - 830d4653-8da7-4c59-a1a4-1cd595539218@group-62F8E1A01D1D: shutdown
2021-10-05 13:25:21,967 [ForkJoinPool.commonPool-worker-0] INFO  server.RaftServer$Division (RaftServerImpl.java:lambda$close$4(407)) - b668fbba-0931-4533-8c87-c6849aaa836f@group-16677137C488: shutdown
2021-10-05 13:25:21,967 [Listener at 127.0.0.1/13296] INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-62F8E1A01D1D,id=830d4653-8da7-4c59-a1a4-1cd595539218
2021-10-05 13:25:21,967 [ForkJoinPool.commonPool-worker-0] INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-16677137C488,id=b668fbba-0931-4533-8c87-c6849aaa836f
2021-10-05 13:25:21,967 [ForkJoinPool.commonPool-worker-0] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(91)) - b668fbba-0931-4533-8c87-c6849aaa836f: shutdown b668fbba-0931-4533-8c87-c6849aaa836f@group-16677137C488-LeaderStateImpl
2021-10-05 13:25:21,967 [Listener at 127.0.0.1/13296] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(108)) - 830d4653-8da7-4c59-a1a4-1cd595539218: shutdown 830d4653-8da7-4c59-a1a4-1cd595539218@group-62F8E1A01D1D-FollowerState
2021-10-05 13:25:21,968 [ForkJoinPool.commonPool-worker-0] INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(282)) - b668fbba-0931-4533-8c87-c6849aaa836f@group-16677137C488-PendingRequests: sendNotLeaderResponses
2021-10-05 13:25:21,968 [830d4653-8da7-4c59-a1a4-1cd595539218@group-62F8E1A01D1D-StateMachineUpdater] INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(292)) - group-62F8E1A01D1D: Taking a snapshot at:(t:2, i:0) file /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-36b87918-66c6-4e2c-9c49-5aa8dab94a1f/datanode-1/data/ratis/5cfa055b-4c5c-4f3c-a5c0-62f8e1a01d1d/sm/snapshot.2_0
2021-10-05 13:25:21,968 [ForkJoinPool.commonPool-worker-0] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(149)) - b668fbba-0931-4533-8c87-c6849aaa836f@group-16677137C488-StateMachineUpdater: set stopIndex = 0
2021-10-05 13:25:21,968 [830d4653-8da7-4c59-a1a4-1cd595539218@group-62F8E1A01D1D-FollowerState] INFO  impl.FollowerState (FollowerState.java:run(143)) - 830d4653-8da7-4c59-a1a4-1cd595539218@group-62F8E1A01D1D-FollowerState was interrupted: {}
java.lang.InterruptedException: sleep interrupted
	at java.lang.Thread.sleep(Native Method)
	at java.lang.Thread.sleep(Thread.java:340)
	at java.util.concurrent.TimeUnit.sleep(TimeUnit.java:386)
	at org.apache.ratis.util.TimeDuration.sleep(TimeDuration.java:324)
	at org.apache.ratis.util.TimeDuration.sleep(TimeDuration.java:309)
	at org.apache.ratis.server.impl.FollowerState.run(FollowerState.java:118)
2021-10-05 13:25:21,968 [b668fbba-0931-4533-8c87-c6849aaa836f@group-16677137C488-StateMachineUpdater] INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(292)) - group-16677137C488: Taking a snapshot at:(t:1, i:0) file /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-36b87918-66c6-4e2c-9c49-5aa8dab94a1f/datanode-0/data/ratis/fb43a933-1c8b-4815-9314-16677137c488/sm/snapshot.1_0
2021-10-05 13:25:21,968 [Listener at 127.0.0.1/13296] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(149)) - 830d4653-8da7-4c59-a1a4-1cd595539218@group-62F8E1A01D1D-StateMachineUpdater: set stopIndex = 0
2021-10-05 13:25:21,971 [830d4653-8da7-4c59-a1a4-1cd595539218@group-62F8E1A01D1D-StateMachineUpdater] INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(303)) - group-62F8E1A01D1D: Finished taking a snapshot at:(t:2, i:0) file:/home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-36b87918-66c6-4e2c-9c49-5aa8dab94a1f/datanode-1/data/ratis/5cfa055b-4c5c-4f3c-a5c0-62f8e1a01d1d/sm/snapshot.2_0 took: 4 ms
2021-10-05 13:25:21,971 [830d4653-8da7-4c59-a1a4-1cd595539218@group-62F8E1A01D1D-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:takeSnapshot(281)) - 830d4653-8da7-4c59-a1a4-1cd595539218@group-62F8E1A01D1D-StateMachineUpdater: Took a snapshot at index 0
2021-10-05 13:25:21,971 [830d4653-8da7-4c59-a1a4-1cd595539218@group-62F8E1A01D1D-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:lambda$new$0(89)) - 830d4653-8da7-4c59-a1a4-1cd595539218@group-62F8E1A01D1D-StateMachineUpdater: snapshotIndex: updateIncreasingly -1 -> 0
2021-10-05 13:25:21,972 [b668fbba-0931-4533-8c87-c6849aaa836f@group-16677137C488-StateMachineUpdater] INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(303)) - group-16677137C488: Finished taking a snapshot at:(t:1, i:0) file:/home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-36b87918-66c6-4e2c-9c49-5aa8dab94a1f/datanode-0/data/ratis/fb43a933-1c8b-4815-9314-16677137c488/sm/snapshot.1_0 took: 3 ms
2021-10-05 13:25:21,972 [b668fbba-0931-4533-8c87-c6849aaa836f@group-16677137C488-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:takeSnapshot(281)) - b668fbba-0931-4533-8c87-c6849aaa836f@group-16677137C488-StateMachineUpdater: Took a snapshot at index 0
2021-10-05 13:25:21,972 [b668fbba-0931-4533-8c87-c6849aaa836f@group-16677137C488-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:lambda$new$0(89)) - b668fbba-0931-4533-8c87-c6849aaa836f@group-16677137C488-StateMachineUpdater: snapshotIndex: updateIncreasingly -1 -> 0
2021-10-05 13:25:21,972 [ForkJoinPool.commonPool-worker-0] INFO  server.RaftServer$Division (ServerState.java:close(419)) - b668fbba-0931-4533-8c87-c6849aaa836f@group-16677137C488: closes. applyIndex: 0
2021-10-05 13:25:21,973 [b668fbba-0931-4533-8c87-c6849aaa836f@group-16677137C488-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:run(327)) - b668fbba-0931-4533-8c87-c6849aaa836f@group-16677137C488-SegmentedRaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2021-10-05 13:25:21,973 [Listener at 127.0.0.1/13296] INFO  server.RaftServer$Division (ServerState.java:close(419)) - 830d4653-8da7-4c59-a1a4-1cd595539218@group-62F8E1A01D1D: closes. applyIndex: 0
2021-10-05 13:25:21,974 [830d4653-8da7-4c59-a1a4-1cd595539218@group-62F8E1A01D1D-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:run(327)) - 830d4653-8da7-4c59-a1a4-1cd595539218@group-62F8E1A01D1D-SegmentedRaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2021-10-05 13:25:21,973 [ForkJoinPool.commonPool-worker-0] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:close(237)) - b668fbba-0931-4533-8c87-c6849aaa836f@group-16677137C488-SegmentedRaftLogWorker close()
2021-10-05 13:25:21,975 [ForkJoinPool.commonPool-worker-0] INFO  server.RaftServer$Division (RaftServerImpl.java:lambda$close$4(407)) - b668fbba-0931-4533-8c87-c6849aaa836f@group-62F8E1A01D1D: shutdown
2021-10-05 13:25:21,975 [ForkJoinPool.commonPool-worker-0] INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-62F8E1A01D1D,id=b668fbba-0931-4533-8c87-c6849aaa836f
2021-10-05 13:25:21,975 [ForkJoinPool.commonPool-worker-0] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(91)) - b668fbba-0931-4533-8c87-c6849aaa836f: shutdown b668fbba-0931-4533-8c87-c6849aaa836f@group-62F8E1A01D1D-LeaderStateImpl
2021-10-05 13:25:21,975 [b668fbba-0931-4533-8c87-c6849aaa836f@group-62F8E1A01D1D->9cad18a2-4b78-4cb8-813e-2348ce620e43-GrpcLogAppender-LogAppenderDaemon] WARN  server.GrpcLogAppender (GrpcLogAppender.java:mayWait(175)) - b668fbba-0931-4533-8c87-c6849aaa836f@group-62F8E1A01D1D->9cad18a2-4b78-4cb8-813e-2348ce620e43-GrpcLogAppender: Wait interrupted by java.lang.InterruptedException
2021-10-05 13:25:21,975 [b668fbba-0931-4533-8c87-c6849aaa836f@group-62F8E1A01D1D->830d4653-8da7-4c59-a1a4-1cd595539218-GrpcLogAppender-LogAppenderDaemon] WARN  server.GrpcLogAppender (GrpcLogAppender.java:mayWait(175)) - b668fbba-0931-4533-8c87-c6849aaa836f@group-62F8E1A01D1D->830d4653-8da7-4c59-a1a4-1cd595539218-GrpcLogAppender: Wait interrupted by java.lang.InterruptedException
2021-10-05 13:25:21,976 [grpc-default-executor-2] INFO  server.GrpcServerProtocolService (GrpcServerProtocolService.java:onCompleted(140)) - 9cad18a2-4b78-4cb8-813e-2348ce620e43: Completed APPEND_ENTRIES, lastRequest: b668fbba-0931-4533-8c87-c6849aaa836f->9cad18a2-4b78-4cb8-813e-2348ce620e43#1-t2,previous=(t:0, i:0),leaderCommit=0,initializing? true,entries: size=1, first=(t:2, i:0), CONFIGURATIONENTRY
2021-10-05 13:25:21,977 [grpc-default-executor-1] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onCompleted(344)) - b668fbba-0931-4533-8c87-c6849aaa836f@group-62F8E1A01D1D->9cad18a2-4b78-4cb8-813e-2348ce620e43-AppendLogResponseHandler: follower responses appendEntries COMPLETED
2021-10-05 13:25:21,977 [grpc-default-executor-1] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(46)) - b668fbba-0931-4533-8c87-c6849aaa836f@group-62F8E1A01D1D->9cad18a2-4b78-4cb8-813e-2348ce620e43: nextIndex: updateUnconditionally 1 -> 0
2021-10-05 13:25:21,977 [grpc-default-executor-2] INFO  server.GrpcServerProtocolService (GrpcServerProtocolService.java:onCompleted(140)) - 830d4653-8da7-4c59-a1a4-1cd595539218: Completed APPEND_ENTRIES, lastRequest: b668fbba-0931-4533-8c87-c6849aaa836f->830d4653-8da7-4c59-a1a4-1cd595539218#1-t2,previous=(t:0, i:0),leaderCommit=-1,initializing? true,entries: size=1, first=(t:2, i:0), CONFIGURATIONENTRY
2021-10-05 13:25:21,975 [ForkJoinPool.commonPool-worker-0] INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(282)) - b668fbba-0931-4533-8c87-c6849aaa836f@group-62F8E1A01D1D-PendingRequests: sendNotLeaderResponses
2021-10-05 13:25:21,978 [ForkJoinPool.commonPool-worker-0] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(149)) - b668fbba-0931-4533-8c87-c6849aaa836f@group-62F8E1A01D1D-StateMachineUpdater: set stopIndex = 0
2021-10-05 13:25:21,978 [b668fbba-0931-4533-8c87-c6849aaa836f@group-62F8E1A01D1D-StateMachineUpdater] INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(292)) - group-62F8E1A01D1D: Taking a snapshot at:(t:2, i:0) file /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-36b87918-66c6-4e2c-9c49-5aa8dab94a1f/datanode-0/data/ratis/5cfa055b-4c5c-4f3c-a5c0-62f8e1a01d1d/sm/snapshot.2_0
2021-10-05 13:25:21,978 [grpc-default-executor-1] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onCompleted(344)) - b668fbba-0931-4533-8c87-c6849aaa836f@group-62F8E1A01D1D->830d4653-8da7-4c59-a1a4-1cd595539218-AppendLogResponseHandler: follower responses appendEntries COMPLETED
2021-10-05 13:25:21,979 [grpc-default-executor-1] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(46)) - b668fbba-0931-4533-8c87-c6849aaa836f@group-62F8E1A01D1D->830d4653-8da7-4c59-a1a4-1cd595539218: nextIndex: updateUnconditionally 1 -> 0
2021-10-05 13:25:21,982 [Listener at 127.0.0.1/13296] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:close(237)) - 830d4653-8da7-4c59-a1a4-1cd595539218@group-62F8E1A01D1D-SegmentedRaftLogWorker close()
2021-10-05 13:25:21,983 [b668fbba-0931-4533-8c87-c6849aaa836f@group-62F8E1A01D1D-StateMachineUpdater] INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(303)) - group-62F8E1A01D1D: Finished taking a snapshot at:(t:2, i:0) file:/home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-36b87918-66c6-4e2c-9c49-5aa8dab94a1f/datanode-0/data/ratis/5cfa055b-4c5c-4f3c-a5c0-62f8e1a01d1d/sm/snapshot.2_0 took: 4 ms
2021-10-05 13:25:21,983 [b668fbba-0931-4533-8c87-c6849aaa836f@group-62F8E1A01D1D-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:takeSnapshot(281)) - b668fbba-0931-4533-8c87-c6849aaa836f@group-62F8E1A01D1D-StateMachineUpdater: Took a snapshot at index 0
2021-10-05 13:25:21,983 [b668fbba-0931-4533-8c87-c6849aaa836f@group-62F8E1A01D1D-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:lambda$new$0(89)) - b668fbba-0931-4533-8c87-c6849aaa836f@group-62F8E1A01D1D-StateMachineUpdater: snapshotIndex: updateIncreasingly -1 -> 0
2021-10-05 13:25:21,983 [ForkJoinPool.commonPool-worker-0] INFO  server.RaftServer$Division (ServerState.java:close(419)) - b668fbba-0931-4533-8c87-c6849aaa836f@group-62F8E1A01D1D: closes. applyIndex: 0
2021-10-05 13:25:21,983 [b668fbba-0931-4533-8c87-c6849aaa836f@group-62F8E1A01D1D-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:run(327)) - b668fbba-0931-4533-8c87-c6849aaa836f@group-62F8E1A01D1D-SegmentedRaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2021-10-05 13:25:21,985 [Listener at 127.0.0.1/13296] INFO  server.RaftServer$Division (RaftServerImpl.java:lambda$close$4(407)) - 830d4653-8da7-4c59-a1a4-1cd595539218@group-9360A73A2ABC: shutdown
2021-10-05 13:25:21,986 [Listener at 127.0.0.1/13296] INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-9360A73A2ABC,id=830d4653-8da7-4c59-a1a4-1cd595539218
2021-10-05 13:25:21,986 [Listener at 127.0.0.1/13296] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(108)) - 830d4653-8da7-4c59-a1a4-1cd595539218: shutdown 830d4653-8da7-4c59-a1a4-1cd595539218@group-9360A73A2ABC-FollowerState
2021-10-05 13:25:21,986 [Listener at 127.0.0.1/13296] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(149)) - 830d4653-8da7-4c59-a1a4-1cd595539218@group-9360A73A2ABC-StateMachineUpdater: set stopIndex = 0
2021-10-05 13:25:21,986 [830d4653-8da7-4c59-a1a4-1cd595539218@group-9360A73A2ABC-StateMachineUpdater] INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(292)) - group-9360A73A2ABC: Taking a snapshot at:(t:3, i:0) file /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-36b87918-66c6-4e2c-9c49-5aa8dab94a1f/datanode-1/data/ratis/1cc8aba1-0118-4460-9a8d-9360a73a2abc/sm/snapshot.3_0
2021-10-05 13:25:21,986 [830d4653-8da7-4c59-a1a4-1cd595539218@group-9360A73A2ABC-FollowerState] INFO  impl.FollowerState (FollowerState.java:run(143)) - 830d4653-8da7-4c59-a1a4-1cd595539218@group-9360A73A2ABC-FollowerState was interrupted: {}
java.lang.InterruptedException: sleep interrupted
	at java.lang.Thread.sleep(Native Method)
	at java.lang.Thread.sleep(Thread.java:340)
	at java.util.concurrent.TimeUnit.sleep(TimeUnit.java:386)
	at org.apache.ratis.util.TimeDuration.sleep(TimeDuration.java:324)
	at org.apache.ratis.util.TimeDuration.sleep(TimeDuration.java:309)
	at org.apache.ratis.server.impl.FollowerState.run(FollowerState.java:118)
2021-10-05 13:25:21,986 [ForkJoinPool.commonPool-worker-0] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:close(237)) - b668fbba-0931-4533-8c87-c6849aaa836f@group-62F8E1A01D1D-SegmentedRaftLogWorker close()
2021-10-05 13:25:21,987 [830d4653-8da7-4c59-a1a4-1cd595539218@group-9360A73A2ABC-StateMachineUpdater] INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(303)) - group-9360A73A2ABC: Finished taking a snapshot at:(t:3, i:0) file:/home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-36b87918-66c6-4e2c-9c49-5aa8dab94a1f/datanode-1/data/ratis/1cc8aba1-0118-4460-9a8d-9360a73a2abc/sm/snapshot.3_0 took: 1 ms
2021-10-05 13:25:21,987 [830d4653-8da7-4c59-a1a4-1cd595539218@group-9360A73A2ABC-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:takeSnapshot(281)) - 830d4653-8da7-4c59-a1a4-1cd595539218@group-9360A73A2ABC-StateMachineUpdater: Took a snapshot at index 0
2021-10-05 13:25:21,987 [830d4653-8da7-4c59-a1a4-1cd595539218@group-9360A73A2ABC-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:lambda$new$0(89)) - 830d4653-8da7-4c59-a1a4-1cd595539218@group-9360A73A2ABC-StateMachineUpdater: snapshotIndex: updateIncreasingly -1 -> 0
2021-10-05 13:25:21,988 [Listener at 127.0.0.1/13296] INFO  server.RaftServer$Division (ServerState.java:close(419)) - 830d4653-8da7-4c59-a1a4-1cd595539218@group-9360A73A2ABC: closes. applyIndex: 0
2021-10-05 13:25:21,988 [830d4653-8da7-4c59-a1a4-1cd595539218@group-9360A73A2ABC-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:run(327)) - 830d4653-8da7-4c59-a1a4-1cd595539218@group-9360A73A2ABC-SegmentedRaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2021-10-05 13:25:21,991 [Listener at 127.0.0.1/13296] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:close(237)) - 830d4653-8da7-4c59-a1a4-1cd595539218@group-9360A73A2ABC-SegmentedRaftLogWorker close()
2021-10-05 13:25:21,991 [ForkJoinPool.commonPool-worker-0] INFO  server.RaftServer$Division (RaftServerImpl.java:lambda$close$4(407)) - b668fbba-0931-4533-8c87-c6849aaa836f@group-9360A73A2ABC: shutdown
2021-10-05 13:25:21,992 [ForkJoinPool.commonPool-worker-0] INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-9360A73A2ABC,id=b668fbba-0931-4533-8c87-c6849aaa836f
2021-10-05 13:25:21,992 [ForkJoinPool.commonPool-worker-0] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(108)) - b668fbba-0931-4533-8c87-c6849aaa836f: shutdown b668fbba-0931-4533-8c87-c6849aaa836f@group-9360A73A2ABC-FollowerState
2021-10-05 13:25:21,992 [ForkJoinPool.commonPool-worker-0] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(149)) - b668fbba-0931-4533-8c87-c6849aaa836f@group-9360A73A2ABC-StateMachineUpdater: set stopIndex = 0
2021-10-05 13:25:21,992 [b668fbba-0931-4533-8c87-c6849aaa836f@group-9360A73A2ABC-FollowerState] INFO  impl.FollowerState (FollowerState.java:run(143)) - b668fbba-0931-4533-8c87-c6849aaa836f@group-9360A73A2ABC-FollowerState was interrupted: {}
java.lang.InterruptedException: sleep interrupted
	at java.lang.Thread.sleep(Native Method)
	at java.lang.Thread.sleep(Thread.java:340)
	at java.util.concurrent.TimeUnit.sleep(TimeUnit.java:386)
	at org.apache.ratis.util.TimeDuration.sleep(TimeDuration.java:324)
	at org.apache.ratis.util.TimeDuration.sleep(TimeDuration.java:309)
	at org.apache.ratis.server.impl.FollowerState.run(FollowerState.java:118)
2021-10-05 13:25:21,992 [Listener at 127.0.0.1/13296] INFO  server.RaftServer$Division (RaftServerImpl.java:lambda$close$4(407)) - 830d4653-8da7-4c59-a1a4-1cd595539218@group-8307C7C0D048: shutdown
2021-10-05 13:25:21,993 [Listener at 127.0.0.1/13296] INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-8307C7C0D048,id=830d4653-8da7-4c59-a1a4-1cd595539218
2021-10-05 13:25:21,993 [Listener at 127.0.0.1/13296] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(91)) - 830d4653-8da7-4c59-a1a4-1cd595539218: shutdown 830d4653-8da7-4c59-a1a4-1cd595539218@group-8307C7C0D048-LeaderStateImpl
2021-10-05 13:25:21,993 [Listener at 127.0.0.1/13296] INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(282)) - 830d4653-8da7-4c59-a1a4-1cd595539218@group-8307C7C0D048-PendingRequests: sendNotLeaderResponses
2021-10-05 13:25:21,994 [Listener at 127.0.0.1/13296] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(149)) - 830d4653-8da7-4c59-a1a4-1cd595539218@group-8307C7C0D048-StateMachineUpdater: set stopIndex = 0
2021-10-05 13:25:21,992 [b668fbba-0931-4533-8c87-c6849aaa836f@group-9360A73A2ABC-StateMachineUpdater] INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(292)) - group-9360A73A2ABC: Taking a snapshot at:(t:3, i:0) file /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-36b87918-66c6-4e2c-9c49-5aa8dab94a1f/datanode-0/data/ratis/1cc8aba1-0118-4460-9a8d-9360a73a2abc/sm/snapshot.3_0
2021-10-05 13:25:21,994 [830d4653-8da7-4c59-a1a4-1cd595539218@group-8307C7C0D048-StateMachineUpdater] INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(292)) - group-8307C7C0D048: Taking a snapshot at:(t:1, i:0) file /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-36b87918-66c6-4e2c-9c49-5aa8dab94a1f/datanode-1/data/ratis/41685362-6c68-4243-9411-8307c7c0d048/sm/snapshot.1_0
2021-10-05 13:25:21,995 [b668fbba-0931-4533-8c87-c6849aaa836f@group-9360A73A2ABC-StateMachineUpdater] INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(303)) - group-9360A73A2ABC: Finished taking a snapshot at:(t:3, i:0) file:/home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-36b87918-66c6-4e2c-9c49-5aa8dab94a1f/datanode-0/data/ratis/1cc8aba1-0118-4460-9a8d-9360a73a2abc/sm/snapshot.3_0 took: 2 ms
2021-10-05 13:25:21,995 [b668fbba-0931-4533-8c87-c6849aaa836f@group-9360A73A2ABC-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:takeSnapshot(281)) - b668fbba-0931-4533-8c87-c6849aaa836f@group-9360A73A2ABC-StateMachineUpdater: Took a snapshot at index 0
2021-10-05 13:25:21,995 [b668fbba-0931-4533-8c87-c6849aaa836f@group-9360A73A2ABC-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:lambda$new$0(89)) - b668fbba-0931-4533-8c87-c6849aaa836f@group-9360A73A2ABC-StateMachineUpdater: snapshotIndex: updateIncreasingly -1 -> 0
2021-10-05 13:25:21,995 [ForkJoinPool.commonPool-worker-0] INFO  server.RaftServer$Division (ServerState.java:close(419)) - b668fbba-0931-4533-8c87-c6849aaa836f@group-9360A73A2ABC: closes. applyIndex: 0
2021-10-05 13:25:21,996 [b668fbba-0931-4533-8c87-c6849aaa836f@group-9360A73A2ABC-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:run(327)) - b668fbba-0931-4533-8c87-c6849aaa836f@group-9360A73A2ABC-SegmentedRaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2021-10-05 13:25:21,996 [830d4653-8da7-4c59-a1a4-1cd595539218@group-8307C7C0D048-StateMachineUpdater] INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(303)) - group-8307C7C0D048: Finished taking a snapshot at:(t:1, i:0) file:/home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-36b87918-66c6-4e2c-9c49-5aa8dab94a1f/datanode-1/data/ratis/41685362-6c68-4243-9411-8307c7c0d048/sm/snapshot.1_0 took: 3 ms
2021-10-05 13:25:21,996 [ForkJoinPool.commonPool-worker-0] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:close(237)) - b668fbba-0931-4533-8c87-c6849aaa836f@group-9360A73A2ABC-SegmentedRaftLogWorker close()
2021-10-05 13:25:21,997 [ForkJoinPool.commonPool-worker-0] INFO  server.GrpcService (GrpcService.java:closeImpl(262)) - b668fbba-0931-4533-8c87-c6849aaa836f: shutdown server with port 40511 now
2021-10-05 13:25:22,000 [830d4653-8da7-4c59-a1a4-1cd595539218@group-8307C7C0D048-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:takeSnapshot(281)) - 830d4653-8da7-4c59-a1a4-1cd595539218@group-8307C7C0D048-StateMachineUpdater: Took a snapshot at index 0
2021-10-05 13:25:22,000 [830d4653-8da7-4c59-a1a4-1cd595539218@group-8307C7C0D048-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:lambda$new$0(89)) - 830d4653-8da7-4c59-a1a4-1cd595539218@group-8307C7C0D048-StateMachineUpdater: snapshotIndex: updateIncreasingly -1 -> 0
2021-10-05 13:25:22,000 [Listener at 127.0.0.1/13296] INFO  server.RaftServer$Division (ServerState.java:close(419)) - 830d4653-8da7-4c59-a1a4-1cd595539218@group-8307C7C0D048: closes. applyIndex: 0
2021-10-05 13:25:22,000 [830d4653-8da7-4c59-a1a4-1cd595539218@group-8307C7C0D048-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:run(327)) - 830d4653-8da7-4c59-a1a4-1cd595539218@group-8307C7C0D048-SegmentedRaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2021-10-05 13:25:22,002 [grpc-default-executor-1] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(122)) - b668fbba-0931-4533-8c87-c6849aaa836f: installSnapshot onError, lastRequest: 9cad18a2-4b78-4cb8-813e-2348ce620e43->b668fbba-0931-4533-8c87-c6849aaa836f#1-t3,previous=(t:0, i:0),leaderCommit=-1,initializing? true,entries: size=1, first=(t:3, i:0), CONFIGURATIONENTRY: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2021-10-05 13:25:22,003 [grpc-default-executor-1] WARN  server.GrpcLogAppender (LogUtils.java:warn(122)) - 9cad18a2-4b78-4cb8-813e-2348ce620e43@group-9360A73A2ABC->b668fbba-0931-4533-8c87-c6849aaa836f-AppendLogResponseHandler: Failed appendEntries: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: HTTP/2 error code: CANCEL
Received Rst Stream
2021-10-05 13:25:22,004 [grpc-default-executor-1] WARN  server.GrpcLogAppender (GrpcLogAppender.java:resetClient(111)) - 9cad18a2-4b78-4cb8-813e-2348ce620e43@group-9360A73A2ABC->b668fbba-0931-4533-8c87-c6849aaa836f-GrpcLogAppender: Leader has not got in touch with Follower 9cad18a2-4b78-4cb8-813e-2348ce620e43@group-9360A73A2ABC->b668fbba-0931-4533-8c87-c6849aaa836f(c0,m0,n1, attendVote=true, lastRpcSendTime=983, lastRpcResponseTime=975) yet, just keep nextIndex unchanged and retry.
2021-10-05 13:25:22,024 [Listener at 127.0.0.1/13296] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:close(237)) - 830d4653-8da7-4c59-a1a4-1cd595539218@group-8307C7C0D048-SegmentedRaftLogWorker close()
2021-10-05 13:25:22,025 [ForkJoinPool.commonPool-worker-0] INFO  server.GrpcService (GrpcService.java:closeImpl(271)) - b668fbba-0931-4533-8c87-c6849aaa836f: shutdown server with port 40511 successfully
2021-10-05 13:25:22,025 [org.apache.ratis.util.JvmPauseMonitor$$Lambda$499/1586779822@12ddb026] INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(109)) - JvmPauseMonitor-b668fbba-0931-4533-8c87-c6849aaa836f: Stopped
2021-10-05 13:25:22,032 [Listener at 127.0.0.1/13296] INFO  server.GrpcService (GrpcService.java:closeImpl(262)) - 830d4653-8da7-4c59-a1a4-1cd595539218: shutdown server with port 42995 now
2021-10-05 13:25:22,033 [grpc-default-executor-4] WARN  server.GrpcLogAppender (LogUtils.java:warn(122)) - 9cad18a2-4b78-4cb8-813e-2348ce620e43@group-9360A73A2ABC->830d4653-8da7-4c59-a1a4-1cd595539218-AppendLogResponseHandler: Failed appendEntries: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: HTTP/2 error code: CANCEL
Received Rst Stream
2021-10-05 13:25:22,033 [grpc-default-executor-4] WARN  server.GrpcLogAppender (GrpcLogAppender.java:resetClient(111)) - 9cad18a2-4b78-4cb8-813e-2348ce620e43@group-9360A73A2ABC->830d4653-8da7-4c59-a1a4-1cd595539218-GrpcLogAppender: Leader has not got in touch with Follower 9cad18a2-4b78-4cb8-813e-2348ce620e43@group-9360A73A2ABC->830d4653-8da7-4c59-a1a4-1cd595539218(c0,m0,n1, attendVote=true, lastRpcSendTime=983, lastRpcResponseTime=979) yet, just keep nextIndex unchanged and retry.
2021-10-05 13:25:22,033 [grpc-default-executor-2] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(122)) - 830d4653-8da7-4c59-a1a4-1cd595539218: installSnapshot onError, lastRequest: 9cad18a2-4b78-4cb8-813e-2348ce620e43->830d4653-8da7-4c59-a1a4-1cd595539218#1-t3,previous=(t:0, i:0),leaderCommit=0,initializing? true,entries: size=1, first=(t:3, i:0), CONFIGURATIONENTRY: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2021-10-05 13:25:22,043 [ForkJoinPool.commonPool-worker-0] INFO  utils.BackgroundService (BackgroundService.java:shutdown(132)) - Shutting down service BlockDeletingService
2021-10-05 13:25:22,047 [Listener at 127.0.0.1/13296] INFO  server.GrpcService (GrpcService.java:closeImpl(271)) - 830d4653-8da7-4c59-a1a4-1cd595539218: shutdown server with port 42995 successfully
2021-10-05 13:25:22,047 [org.apache.ratis.util.JvmPauseMonitor$$Lambda$499/1586779822@2b7b94bd] INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(109)) - JvmPauseMonitor-830d4653-8da7-4c59-a1a4-1cd595539218: Stopped
2021-10-05 13:25:22,048 [Listener at 127.0.0.1/13296] INFO  utils.BackgroundService (BackgroundService.java:shutdown(132)) - Shutting down service BlockDeletingService
2021-10-05 13:25:22,749 [EndpointStateMachine task thread for /127.0.0.1:13549 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:13549. Already tried 5 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:22,750 [EndpointStateMachine task thread for /127.0.0.1:13529 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:13529. Already tried 5 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:22,753 [EndpointStateMachine task thread for /127.0.0.1:15041 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15041. Already tried 14 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:22,814 [EndpointStateMachine task thread for /127.0.0.1:15031 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15031. Already tried 3 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:22,821 [EndpointStateMachine task thread for /127.0.0.1:15021 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15021. Already tried 3 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:22,945 [EndpointStateMachine task thread for /127.0.0.1:13539 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:13539. Already tried 4 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:23,562 [grpc-default-executor-1] WARN  server.GrpcLogAppender (LogUtils.java:warn(122)) - 9cad18a2-4b78-4cb8-813e-2348ce620e43@group-9360A73A2ABC->830d4653-8da7-4c59-a1a4-1cd595539218-AppendLogResponseHandler: Failed appendEntries: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
2021-10-05 13:25:23,563 [grpc-default-executor-1] WARN  server.GrpcLogAppender (GrpcLogAppender.java:resetClient(111)) - 9cad18a2-4b78-4cb8-813e-2348ce620e43@group-9360A73A2ABC->830d4653-8da7-4c59-a1a4-1cd595539218-GrpcLogAppender: Leader has not got in touch with Follower 9cad18a2-4b78-4cb8-813e-2348ce620e43@group-9360A73A2ABC->830d4653-8da7-4c59-a1a4-1cd595539218(c0,m0,n1, attendVote=true, lastRpcSendTime=1, lastRpcResponseTime=2508) yet, just keep nextIndex unchanged and retry.
2021-10-05 13:25:23,565 [grpc-default-executor-1] WARN  server.GrpcLogAppender (LogUtils.java:warn(122)) - 9cad18a2-4b78-4cb8-813e-2348ce620e43@group-9360A73A2ABC->b668fbba-0931-4533-8c87-c6849aaa836f-AppendLogResponseHandler: Failed appendEntries: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
2021-10-05 13:25:23,566 [grpc-default-executor-1] WARN  server.GrpcLogAppender (GrpcLogAppender.java:resetClient(111)) - 9cad18a2-4b78-4cb8-813e-2348ce620e43@group-9360A73A2ABC->b668fbba-0931-4533-8c87-c6849aaa836f-GrpcLogAppender: Leader has not got in touch with Follower 9cad18a2-4b78-4cb8-813e-2348ce620e43@group-9360A73A2ABC->b668fbba-0931-4533-8c87-c6849aaa836f(c0,m0,n1, attendVote=true, lastRpcSendTime=0, lastRpcResponseTime=2537) yet, just keep nextIndex unchanged and retry.
2021-10-05 13:25:23,750 [EndpointStateMachine task thread for /127.0.0.1:13549 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:13549. Already tried 6 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:23,750 [EndpointStateMachine task thread for /127.0.0.1:13529 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:13529. Already tried 6 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:23,754 [EndpointStateMachine task thread for /127.0.0.1:15041 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15041. Already tried 0 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:23,814 [EndpointStateMachine task thread for /127.0.0.1:15031 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15031. Already tried 4 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:23,821 [EndpointStateMachine task thread for /127.0.0.1:15021 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15021. Already tried 4 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:23,945 [EndpointStateMachine task thread for /127.0.0.1:13539 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:13539. Already tried 5 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:24,750 [EndpointStateMachine task thread for /127.0.0.1:13549 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:13549. Already tried 7 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:24,751 [EndpointStateMachine task thread for /127.0.0.1:13529 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:13529. Already tried 7 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:24,755 [EndpointStateMachine task thread for /127.0.0.1:15041 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15041. Already tried 1 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:24,827 [EndpointStateMachine task thread for /127.0.0.1:15021 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15021. Already tried 5 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:24,827 [EndpointStateMachine task thread for /127.0.0.1:15031 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15031. Already tried 5 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:24,946 [EndpointStateMachine task thread for /127.0.0.1:13539 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:13539. Already tried 6 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:25,063 [ForkJoinPool.commonPool-worker-0] INFO  statemachine.DatanodeStateMachine (DatanodeStateMachine.java:stopDaemon(515)) - Ozone container server stopped.
2021-10-05 13:25:25,077 [ForkJoinPool.commonPool-worker-0] INFO  handler.ContextHandler (ContextHandler.java:doStop(1153)) - Stopped o.e.j.w.WebAppContext@20afcc5c{hddsDatanode,/,null,STOPPED}{jar:file:/home/runner/.m2/repository/org/apache/ozone/hdds-container-service/1.2.0-SNAPSHOT/hdds-container-service-1.2.0-SNAPSHOT.jar!/webapps/hddsDatanode}
2021-10-05 13:25:25,079 [ForkJoinPool.commonPool-worker-0] INFO  server.AbstractConnector (AbstractConnector.java:doStop(381)) - Stopped ServerConnector@4a314ae4{HTTP/1.1, (http/1.1)}{0.0.0.0:0}
2021-10-05 13:25:25,080 [ForkJoinPool.commonPool-worker-0] INFO  server.session (HouseKeeper.java:stopScavenging(149)) - node0 Stopped scavenging
2021-10-05 13:25:25,083 [ForkJoinPool.commonPool-worker-0] INFO  handler.ContextHandler (ContextHandler.java:doStop(1153)) - Stopped o.e.j.s.ServletContextHandler@5af08862{static,/static,jar:file:/home/runner/.m2/repository/org/apache/ozone/hdds-container-service/1.2.0-SNAPSHOT/hdds-container-service-1.2.0-SNAPSHOT.jar!/webapps/static,STOPPED}
2021-10-05 13:25:25,087 [Listener at 127.0.0.1/13296] INFO  statemachine.DatanodeStateMachine (DatanodeStateMachine.java:stopDaemon(515)) - Ozone container server stopped.
2021-10-05 13:25:25,088 [Listener at 127.0.0.1/13296] INFO  handler.ContextHandler (ContextHandler.java:doStop(1153)) - Stopped o.e.j.w.WebAppContext@59412c{hddsDatanode,/,null,STOPPED}{jar:file:/home/runner/.m2/repository/org/apache/ozone/hdds-container-service/1.2.0-SNAPSHOT/hdds-container-service-1.2.0-SNAPSHOT.jar!/webapps/hddsDatanode}
2021-10-05 13:25:25,088 [ForkJoinPool.commonPool-worker-0] INFO  handler.ContextHandler (ContextHandler.java:doStop(1153)) - Stopped o.e.j.s.ServletContextHandler@544f5414{logs,/logs,file:///home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/log,STOPPED}
2021-10-05 13:25:25,107 [Listener at 127.0.0.1/13296] INFO  server.AbstractConnector (AbstractConnector.java:doStop(381)) - Stopped ServerConnector@46c805be{HTTP/1.1, (http/1.1)}{0.0.0.0:0}
2021-10-05 13:25:25,108 [Listener at 127.0.0.1/13296] INFO  server.session (HouseKeeper.java:stopScavenging(149)) - node0 Stopped scavenging
2021-10-05 13:25:25,108 [Listener at 127.0.0.1/13296] INFO  handler.ContextHandler (ContextHandler.java:doStop(1153)) - Stopped o.e.j.s.ServletContextHandler@70163ce4{static,/static,jar:file:/home/runner/.m2/repository/org/apache/ozone/hdds-container-service/1.2.0-SNAPSHOT/hdds-container-service-1.2.0-SNAPSHOT.jar!/webapps/static,STOPPED}
2021-10-05 13:25:25,108 [Listener at 127.0.0.1/13296] INFO  handler.ContextHandler (ContextHandler.java:doStop(1153)) - Stopped o.e.j.s.ServletContextHandler@3b111f64{logs,/logs,file:///home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/log,STOPPED}
2021-10-05 13:25:25,663 [9cad18a2-4b78-4cb8-813e-2348ce620e43@group-62F8E1A01D1D-FollowerState] INFO  impl.FollowerState (FollowerState.java:run(134)) - 9cad18a2-4b78-4cb8-813e-2348ce620e43@group-62F8E1A01D1D-FollowerState: change to CANDIDATE, lastRpcElapsedTime:5148057279ns, electionTimeout:5089ms
2021-10-05 13:25:25,664 [9cad18a2-4b78-4cb8-813e-2348ce620e43@group-62F8E1A01D1D-FollowerState] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(108)) - 9cad18a2-4b78-4cb8-813e-2348ce620e43: shutdown 9cad18a2-4b78-4cb8-813e-2348ce620e43@group-62F8E1A01D1D-FollowerState
2021-10-05 13:25:25,664 [9cad18a2-4b78-4cb8-813e-2348ce620e43@group-62F8E1A01D1D-FollowerState] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(285)) - 9cad18a2-4b78-4cb8-813e-2348ce620e43@group-62F8E1A01D1D: changes role from  FOLLOWER to CANDIDATE at term 2 for changeToCandidate
2021-10-05 13:25:25,664 [9cad18a2-4b78-4cb8-813e-2348ce620e43@group-62F8E1A01D1D-FollowerState] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.leaderelection.pre-vote = false (custom)
2021-10-05 13:25:25,664 [9cad18a2-4b78-4cb8-813e-2348ce620e43@group-62F8E1A01D1D-FollowerState] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(130)) - 9cad18a2-4b78-4cb8-813e-2348ce620e43: start 9cad18a2-4b78-4cb8-813e-2348ce620e43@group-62F8E1A01D1D-LeaderElection27
2021-10-05 13:25:25,667 [9cad18a2-4b78-4cb8-813e-2348ce620e43@group-62F8E1A01D1D-LeaderElection27] INFO  server.RaftServer$Division (ServerState.java:setLeader(285)) - 9cad18a2-4b78-4cb8-813e-2348ce620e43@group-62F8E1A01D1D: change Leader from b668fbba-0931-4533-8c87-c6849aaa836f to null at term 2 for ELECTION
2021-10-05 13:25:25,676 [9cad18a2-4b78-4cb8-813e-2348ce620e43@group-62F8E1A01D1D-LeaderElection27] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(306)) - 9cad18a2-4b78-4cb8-813e-2348ce620e43@group-62F8E1A01D1D-LeaderElection27 ELECTION round 0: submit vote requests at term 3 for 0: [b668fbba-0931-4533-8c87-c6849aaa836f|rpc:127.0.0.1:40511|dataStream:|priority:1, 830d4653-8da7-4c59-a1a4-1cd595539218|rpc:127.0.0.1:42995|dataStream:|priority:0, 9cad18a2-4b78-4cb8-813e-2348ce620e43|rpc:127.0.0.1:34379|dataStream:|priority:0], old=null
2021-10-05 13:25:25,711 [9cad18a2-4b78-4cb8-813e-2348ce620e43@group-62F8E1A01D1D-LeaderElection27] INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(137)) - 9cad18a2-4b78-4cb8-813e-2348ce620e43@group-62F8E1A01D1D-LeaderElection27 got exception when requesting votes: java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
2021-10-05 13:25:25,712 [9cad18a2-4b78-4cb8-813e-2348ce620e43@group-62F8E1A01D1D-LeaderElection27] INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(137)) - 9cad18a2-4b78-4cb8-813e-2348ce620e43@group-62F8E1A01D1D-LeaderElection27 got exception when requesting votes: java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
2021-10-05 13:25:25,712 [9cad18a2-4b78-4cb8-813e-2348ce620e43@group-62F8E1A01D1D-LeaderElection27] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(89)) - 9cad18a2-4b78-4cb8-813e-2348ce620e43@group-62F8E1A01D1D-LeaderElection27: ELECTION REJECTED received 0 response(s) and 2 exception(s):
2021-10-05 13:25:25,712 [9cad18a2-4b78-4cb8-813e-2348ce620e43@group-62F8E1A01D1D-LeaderElection27] INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(137)) -   Exception 0: java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
2021-10-05 13:25:25,712 [9cad18a2-4b78-4cb8-813e-2348ce620e43@group-62F8E1A01D1D-LeaderElection27] INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(137)) -   Exception 1: java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
2021-10-05 13:25:25,712 [9cad18a2-4b78-4cb8-813e-2348ce620e43@group-62F8E1A01D1D-LeaderElection27] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(308)) - 9cad18a2-4b78-4cb8-813e-2348ce620e43@group-62F8E1A01D1D-LeaderElection27 ELECTION round 0: result REJECTED
2021-10-05 13:25:25,712 [9cad18a2-4b78-4cb8-813e-2348ce620e43@group-62F8E1A01D1D-LeaderElection27] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(285)) - 9cad18a2-4b78-4cb8-813e-2348ce620e43@group-62F8E1A01D1D: changes role from CANDIDATE to FOLLOWER at term 3 for REJECTED
2021-10-05 13:25:25,712 [9cad18a2-4b78-4cb8-813e-2348ce620e43@group-62F8E1A01D1D-LeaderElection27] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(121)) - 9cad18a2-4b78-4cb8-813e-2348ce620e43: shutdown 9cad18a2-4b78-4cb8-813e-2348ce620e43@group-62F8E1A01D1D-LeaderElection27
2021-10-05 13:25:25,712 [9cad18a2-4b78-4cb8-813e-2348ce620e43@group-62F8E1A01D1D-LeaderElection27] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(130)) - 9cad18a2-4b78-4cb8-813e-2348ce620e43: start 9cad18a2-4b78-4cb8-813e-2348ce620e43@group-62F8E1A01D1D-FollowerState
2021-10-05 13:25:25,759 [EndpointStateMachine task thread for /127.0.0.1:15041 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15041. Already tried 2 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:25,774 [EndpointStateMachine task thread for /127.0.0.1:13529 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:13529. Already tried 8 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:25,774 [EndpointStateMachine task thread for /127.0.0.1:13549 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:13549. Already tried 8 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:25,828 [EndpointStateMachine task thread for /127.0.0.1:15021 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15021. Already tried 6 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:25,828 [EndpointStateMachine task thread for /127.0.0.1:15031 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15031. Already tried 6 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:25,943 [Datanode State Machine Thread - 0] WARN  statemachine.StateContext (StateContext.java:setState(246)) - Ignore disallowed transition from SHUTDOWN to RUNNING
2021-10-05 13:25:25,946 [EndpointStateMachine task thread for /127.0.0.1:13539 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:13539. Already tried 7 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:26,062 [grpc-default-executor-1] WARN  server.GrpcLogAppender (LogUtils.java:warn(122)) - 9cad18a2-4b78-4cb8-813e-2348ce620e43@group-9360A73A2ABC->830d4653-8da7-4c59-a1a4-1cd595539218-AppendLogResponseHandler: Failed appendEntries: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
2021-10-05 13:25:26,064 [grpc-default-executor-1] WARN  server.GrpcLogAppender (GrpcLogAppender.java:resetClient(111)) - 9cad18a2-4b78-4cb8-813e-2348ce620e43@group-9360A73A2ABC->830d4653-8da7-4c59-a1a4-1cd595539218-GrpcLogAppender: Leader has not got in touch with Follower 9cad18a2-4b78-4cb8-813e-2348ce620e43@group-9360A73A2ABC->830d4653-8da7-4c59-a1a4-1cd595539218(c0,m0,n1, attendVote=true, lastRpcSendTime=2502, lastRpcResponseTime=5009) yet, just keep nextIndex unchanged and retry.
2021-10-05 13:25:26,074 [grpc-default-executor-1] WARN  server.GrpcLogAppender (LogUtils.java:warn(122)) - 9cad18a2-4b78-4cb8-813e-2348ce620e43@group-9360A73A2ABC->b668fbba-0931-4533-8c87-c6849aaa836f-AppendLogResponseHandler: Failed appendEntries: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
2021-10-05 13:25:26,074 [grpc-default-executor-1] WARN  server.GrpcLogAppender (GrpcLogAppender.java:resetClient(111)) - 9cad18a2-4b78-4cb8-813e-2348ce620e43@group-9360A73A2ABC->b668fbba-0931-4533-8c87-c6849aaa836f-GrpcLogAppender: Leader has not got in touch with Follower 9cad18a2-4b78-4cb8-813e-2348ce620e43@group-9360A73A2ABC->b668fbba-0931-4533-8c87-c6849aaa836f(c0,m0,n1, attendVote=true, lastRpcSendTime=0, lastRpcResponseTime=5046) yet, just keep nextIndex unchanged and retry.
2021-10-05 13:25:26,363 [9cad18a2-4b78-4cb8-813e-2348ce620e43@group-9360A73A2ABC-LeaderStateImpl] WARN  server.RaftServer$Division (LeaderStateImpl.java:checkLeadership(944)) - 9cad18a2-4b78-4cb8-813e-2348ce620e43@group-9360A73A2ABC-LeaderStateImpl: Lost leadership on term: 3. Election timeout: 5200ms. In charge for: 10434ms. Conf: 0: [b668fbba-0931-4533-8c87-c6849aaa836f|rpc:127.0.0.1:40511|dataStream:|priority:0, 830d4653-8da7-4c59-a1a4-1cd595539218|rpc:127.0.0.1:42995|dataStream:|priority:0, 9cad18a2-4b78-4cb8-813e-2348ce620e43|rpc:127.0.0.1:34379|dataStream:|priority:1], old=null
2021-10-05 13:25:26,363 [9cad18a2-4b78-4cb8-813e-2348ce620e43@group-9360A73A2ABC-LeaderStateImpl] WARN  server.RaftServer$Division (LeaderStateImpl.java:lambda$checkLeadership$15(948)) - Follower 9cad18a2-4b78-4cb8-813e-2348ce620e43@group-9360A73A2ABC->b668fbba-0931-4533-8c87-c6849aaa836f(c0,m0,n1, attendVote=true, lastRpcSendTime=289, lastRpcResponseTime=5335)
2021-10-05 13:25:26,363 [9cad18a2-4b78-4cb8-813e-2348ce620e43@group-9360A73A2ABC-LeaderStateImpl] WARN  server.RaftServer$Division (LeaderStateImpl.java:lambda$checkLeadership$15(948)) - Follower 9cad18a2-4b78-4cb8-813e-2348ce620e43@group-9360A73A2ABC->830d4653-8da7-4c59-a1a4-1cd595539218(c0,m0,n1, attendVote=true, lastRpcSendTime=298, lastRpcResponseTime=5309)
2021-10-05 13:25:26,363 [9cad18a2-4b78-4cb8-813e-2348ce620e43@group-9360A73A2ABC-LeaderStateImpl] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(285)) - 9cad18a2-4b78-4cb8-813e-2348ce620e43@group-9360A73A2ABC: changes role from    LEADER to FOLLOWER at term 3 for StepDownReason:LOST_MAJORITY_HEARTBEATS
2021-10-05 13:25:26,364 [9cad18a2-4b78-4cb8-813e-2348ce620e43@group-9360A73A2ABC-LeaderStateImpl] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(91)) - 9cad18a2-4b78-4cb8-813e-2348ce620e43: shutdown 9cad18a2-4b78-4cb8-813e-2348ce620e43@group-9360A73A2ABC-LeaderStateImpl
2021-10-05 13:25:26,364 [9cad18a2-4b78-4cb8-813e-2348ce620e43@group-9360A73A2ABC-LeaderStateImpl] INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(282)) - 9cad18a2-4b78-4cb8-813e-2348ce620e43@group-9360A73A2ABC-PendingRequests: sendNotLeaderResponses
2021-10-05 13:25:26,364 [9cad18a2-4b78-4cb8-813e-2348ce620e43@group-9360A73A2ABC-LeaderStateImpl] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(130)) - 9cad18a2-4b78-4cb8-813e-2348ce620e43: start 9cad18a2-4b78-4cb8-813e-2348ce620e43@group-9360A73A2ABC-FollowerState
2021-10-05 13:25:26,760 [EndpointStateMachine task thread for /127.0.0.1:15041 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15041. Already tried 3 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:26,787 [EndpointStateMachine task thread for /127.0.0.1:13549 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:13549. Already tried 9 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:26,787 [EndpointStateMachine task thread for /127.0.0.1:13529 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:13529. Already tried 9 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:26,828 [EndpointStateMachine task thread for /127.0.0.1:15021 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15021. Already tried 7 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:26,829 [EndpointStateMachine task thread for /127.0.0.1:15031 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15031. Already tried 7 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:26,948 [EndpointStateMachine task thread for /127.0.0.1:13539 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:13539. Already tried 8 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:27,760 [EndpointStateMachine task thread for /127.0.0.1:15041 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15041. Already tried 4 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:27,788 [EndpointStateMachine task thread for /127.0.0.1:13549 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:13549. Already tried 10 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:27,788 [EndpointStateMachine task thread for /127.0.0.1:13529 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:13529. Already tried 10 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:27,829 [EndpointStateMachine task thread for /127.0.0.1:15021 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15021. Already tried 8 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:27,829 [EndpointStateMachine task thread for /127.0.0.1:15031 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15031. Already tried 8 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:27,948 [EndpointStateMachine task thread for /127.0.0.1:13539 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:13539. Already tried 9 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:28,761 [EndpointStateMachine task thread for /127.0.0.1:15041 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15041. Already tried 5 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:28,788 [EndpointStateMachine task thread for /127.0.0.1:13549 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:13549. Already tried 11 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:28,788 [EndpointStateMachine task thread for /127.0.0.1:13529 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:13529. Already tried 11 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:28,829 [EndpointStateMachine task thread for /127.0.0.1:15021 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15021. Already tried 9 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:28,829 [EndpointStateMachine task thread for /127.0.0.1:15031 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15031. Already tried 9 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:28,948 [EndpointStateMachine task thread for /127.0.0.1:13539 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:13539. Already tried 10 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:29,762 [EndpointStateMachine task thread for /127.0.0.1:15041 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15041. Already tried 6 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:29,788 [EndpointStateMachine task thread for /127.0.0.1:13549 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:13549. Already tried 12 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:29,789 [EndpointStateMachine task thread for /127.0.0.1:13529 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:13529. Already tried 12 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:29,829 [EndpointStateMachine task thread for /127.0.0.1:15021 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15021. Already tried 10 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:29,830 [EndpointStateMachine task thread for /127.0.0.1:15031 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15031. Already tried 10 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:29,949 [EndpointStateMachine task thread for /127.0.0.1:13539 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:13539. Already tried 11 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:30,092 [ForkJoinPool.commonPool-worker-0] INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(325)) - Attempting to stop container services.
2021-10-05 13:25:30,095 [ForkJoinPool.commonPool-worker-0] INFO  server.RaftServer (RaftServerProxy.java:lambda$close$6(391)) - 9cad18a2-4b78-4cb8-813e-2348ce620e43: close
2021-10-05 13:25:30,095 [ForkJoinPool.commonPool-worker-0] INFO  server.RaftServer$Division (RaftServerImpl.java:lambda$close$4(407)) - 9cad18a2-4b78-4cb8-813e-2348ce620e43@group-62F8E1A01D1D: shutdown
2021-10-05 13:25:30,095 [ForkJoinPool.commonPool-worker-0] INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-62F8E1A01D1D,id=9cad18a2-4b78-4cb8-813e-2348ce620e43
2021-10-05 13:25:30,095 [ForkJoinPool.commonPool-worker-0] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(108)) - 9cad18a2-4b78-4cb8-813e-2348ce620e43: shutdown 9cad18a2-4b78-4cb8-813e-2348ce620e43@group-62F8E1A01D1D-FollowerState
2021-10-05 13:25:30,096 [ForkJoinPool.commonPool-worker-0] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(149)) - 9cad18a2-4b78-4cb8-813e-2348ce620e43@group-62F8E1A01D1D-StateMachineUpdater: set stopIndex = 0
2021-10-05 13:25:30,096 [9cad18a2-4b78-4cb8-813e-2348ce620e43@group-62F8E1A01D1D-FollowerState] INFO  impl.FollowerState (FollowerState.java:run(143)) - 9cad18a2-4b78-4cb8-813e-2348ce620e43@group-62F8E1A01D1D-FollowerState was interrupted: {}
java.lang.InterruptedException: sleep interrupted
	at java.lang.Thread.sleep(Native Method)
	at java.lang.Thread.sleep(Thread.java:340)
	at java.util.concurrent.TimeUnit.sleep(TimeUnit.java:386)
	at org.apache.ratis.util.TimeDuration.sleep(TimeDuration.java:324)
	at org.apache.ratis.util.TimeDuration.sleep(TimeDuration.java:309)
	at org.apache.ratis.server.impl.FollowerState.run(FollowerState.java:118)
2021-10-05 13:25:30,096 [9cad18a2-4b78-4cb8-813e-2348ce620e43@group-62F8E1A01D1D-StateMachineUpdater] INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(292)) - group-62F8E1A01D1D: Taking a snapshot at:(t:2, i:0) file /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-36b87918-66c6-4e2c-9c49-5aa8dab94a1f/datanode-2/data/ratis/5cfa055b-4c5c-4f3c-a5c0-62f8e1a01d1d/sm/snapshot.2_0
2021-10-05 13:25:30,097 [9cad18a2-4b78-4cb8-813e-2348ce620e43@group-62F8E1A01D1D-StateMachineUpdater] INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(303)) - group-62F8E1A01D1D: Finished taking a snapshot at:(t:2, i:0) file:/home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-36b87918-66c6-4e2c-9c49-5aa8dab94a1f/datanode-2/data/ratis/5cfa055b-4c5c-4f3c-a5c0-62f8e1a01d1d/sm/snapshot.2_0 took: 1 ms
2021-10-05 13:25:30,097 [9cad18a2-4b78-4cb8-813e-2348ce620e43@group-62F8E1A01D1D-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:takeSnapshot(281)) - 9cad18a2-4b78-4cb8-813e-2348ce620e43@group-62F8E1A01D1D-StateMachineUpdater: Took a snapshot at index 0
2021-10-05 13:25:30,097 [9cad18a2-4b78-4cb8-813e-2348ce620e43@group-62F8E1A01D1D-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:lambda$new$0(89)) - 9cad18a2-4b78-4cb8-813e-2348ce620e43@group-62F8E1A01D1D-StateMachineUpdater: snapshotIndex: updateIncreasingly -1 -> 0
2021-10-05 13:25:30,099 [ForkJoinPool.commonPool-worker-0] INFO  server.RaftServer$Division (ServerState.java:close(419)) - 9cad18a2-4b78-4cb8-813e-2348ce620e43@group-62F8E1A01D1D: closes. applyIndex: 0
2021-10-05 13:25:30,099 [9cad18a2-4b78-4cb8-813e-2348ce620e43@group-62F8E1A01D1D-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:run(327)) - 9cad18a2-4b78-4cb8-813e-2348ce620e43@group-62F8E1A01D1D-SegmentedRaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2021-10-05 13:25:30,100 [ForkJoinPool.commonPool-worker-0] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:close(237)) - 9cad18a2-4b78-4cb8-813e-2348ce620e43@group-62F8E1A01D1D-SegmentedRaftLogWorker close()
2021-10-05 13:25:30,100 [ForkJoinPool.commonPool-worker-0] INFO  server.RaftServer$Division (RaftServerImpl.java:lambda$close$4(407)) - 9cad18a2-4b78-4cb8-813e-2348ce620e43@group-9BC7FBF74007: shutdown
2021-10-05 13:25:30,100 [ForkJoinPool.commonPool-worker-0] INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-9BC7FBF74007,id=9cad18a2-4b78-4cb8-813e-2348ce620e43
2021-10-05 13:25:30,100 [ForkJoinPool.commonPool-worker-0] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(91)) - 9cad18a2-4b78-4cb8-813e-2348ce620e43: shutdown 9cad18a2-4b78-4cb8-813e-2348ce620e43@group-9BC7FBF74007-LeaderStateImpl
2021-10-05 13:25:30,100 [ForkJoinPool.commonPool-worker-0] INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(282)) - 9cad18a2-4b78-4cb8-813e-2348ce620e43@group-9BC7FBF74007-PendingRequests: sendNotLeaderResponses
2021-10-05 13:25:30,102 [9cad18a2-4b78-4cb8-813e-2348ce620e43@group-9BC7FBF74007-StateMachineUpdater] INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(292)) - group-9BC7FBF74007: Taking a snapshot at:(t:1, i:0) file /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-36b87918-66c6-4e2c-9c49-5aa8dab94a1f/datanode-2/data/ratis/698a69f9-cff2-4881-8cc2-9bc7fbf74007/sm/snapshot.1_0
2021-10-05 13:25:30,102 [ForkJoinPool.commonPool-worker-0] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(149)) - 9cad18a2-4b78-4cb8-813e-2348ce620e43@group-9BC7FBF74007-StateMachineUpdater: set stopIndex = 0
2021-10-05 13:25:30,105 [9cad18a2-4b78-4cb8-813e-2348ce620e43@group-9BC7FBF74007-StateMachineUpdater] INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(303)) - group-9BC7FBF74007: Finished taking a snapshot at:(t:1, i:0) file:/home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-36b87918-66c6-4e2c-9c49-5aa8dab94a1f/datanode-2/data/ratis/698a69f9-cff2-4881-8cc2-9bc7fbf74007/sm/snapshot.1_0 took: 4 ms
2021-10-05 13:25:30,105 [9cad18a2-4b78-4cb8-813e-2348ce620e43@group-9BC7FBF74007-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:takeSnapshot(281)) - 9cad18a2-4b78-4cb8-813e-2348ce620e43@group-9BC7FBF74007-StateMachineUpdater: Took a snapshot at index 0
2021-10-05 13:25:30,105 [9cad18a2-4b78-4cb8-813e-2348ce620e43@group-9BC7FBF74007-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:lambda$new$0(89)) - 9cad18a2-4b78-4cb8-813e-2348ce620e43@group-9BC7FBF74007-StateMachineUpdater: snapshotIndex: updateIncreasingly -1 -> 0
2021-10-05 13:25:30,106 [ForkJoinPool.commonPool-worker-0] INFO  server.RaftServer$Division (ServerState.java:close(419)) - 9cad18a2-4b78-4cb8-813e-2348ce620e43@group-9BC7FBF74007: closes. applyIndex: 0
2021-10-05 13:25:30,106 [9cad18a2-4b78-4cb8-813e-2348ce620e43@group-9BC7FBF74007-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:run(327)) - 9cad18a2-4b78-4cb8-813e-2348ce620e43@group-9BC7FBF74007-SegmentedRaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2021-10-05 13:25:30,106 [ForkJoinPool.commonPool-worker-0] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:close(237)) - 9cad18a2-4b78-4cb8-813e-2348ce620e43@group-9BC7FBF74007-SegmentedRaftLogWorker close()
2021-10-05 13:25:30,109 [ForkJoinPool.commonPool-worker-0] INFO  server.RaftServer$Division (RaftServerImpl.java:lambda$close$4(407)) - 9cad18a2-4b78-4cb8-813e-2348ce620e43@group-9360A73A2ABC: shutdown
2021-10-05 13:25:30,109 [ForkJoinPool.commonPool-worker-0] INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-9360A73A2ABC,id=9cad18a2-4b78-4cb8-813e-2348ce620e43
2021-10-05 13:25:30,109 [ForkJoinPool.commonPool-worker-0] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(108)) - 9cad18a2-4b78-4cb8-813e-2348ce620e43: shutdown 9cad18a2-4b78-4cb8-813e-2348ce620e43@group-9360A73A2ABC-FollowerState
2021-10-05 13:25:30,109 [9cad18a2-4b78-4cb8-813e-2348ce620e43@group-9360A73A2ABC-FollowerState] INFO  impl.FollowerState (FollowerState.java:run(143)) - 9cad18a2-4b78-4cb8-813e-2348ce620e43@group-9360A73A2ABC-FollowerState was interrupted: {}
java.lang.InterruptedException: sleep interrupted
	at java.lang.Thread.sleep(Native Method)
	at java.lang.Thread.sleep(Thread.java:340)
	at java.util.concurrent.TimeUnit.sleep(TimeUnit.java:386)
	at org.apache.ratis.util.TimeDuration.sleep(TimeDuration.java:324)
	at org.apache.ratis.util.TimeDuration.sleep(TimeDuration.java:309)
	at org.apache.ratis.server.impl.FollowerState.run(FollowerState.java:118)
2021-10-05 13:25:30,110 [ForkJoinPool.commonPool-worker-0] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(149)) - 9cad18a2-4b78-4cb8-813e-2348ce620e43@group-9360A73A2ABC-StateMachineUpdater: set stopIndex = 0
2021-10-05 13:25:30,116 [9cad18a2-4b78-4cb8-813e-2348ce620e43@group-9360A73A2ABC-StateMachineUpdater] INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(292)) - group-9360A73A2ABC: Taking a snapshot at:(t:3, i:0) file /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-36b87918-66c6-4e2c-9c49-5aa8dab94a1f/datanode-2/data/ratis/1cc8aba1-0118-4460-9a8d-9360a73a2abc/sm/snapshot.3_0
2021-10-05 13:25:30,117 [9cad18a2-4b78-4cb8-813e-2348ce620e43@group-9360A73A2ABC-StateMachineUpdater] INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(303)) - group-9360A73A2ABC: Finished taking a snapshot at:(t:3, i:0) file:/home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-36b87918-66c6-4e2c-9c49-5aa8dab94a1f/datanode-2/data/ratis/1cc8aba1-0118-4460-9a8d-9360a73a2abc/sm/snapshot.3_0 took: 1 ms
2021-10-05 13:25:30,117 [9cad18a2-4b78-4cb8-813e-2348ce620e43@group-9360A73A2ABC-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:takeSnapshot(281)) - 9cad18a2-4b78-4cb8-813e-2348ce620e43@group-9360A73A2ABC-StateMachineUpdater: Took a snapshot at index 0
2021-10-05 13:25:30,117 [9cad18a2-4b78-4cb8-813e-2348ce620e43@group-9360A73A2ABC-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:lambda$new$0(89)) - 9cad18a2-4b78-4cb8-813e-2348ce620e43@group-9360A73A2ABC-StateMachineUpdater: snapshotIndex: updateIncreasingly -1 -> 0
2021-10-05 13:25:30,118 [ForkJoinPool.commonPool-worker-0] INFO  server.RaftServer$Division (ServerState.java:close(419)) - 9cad18a2-4b78-4cb8-813e-2348ce620e43@group-9360A73A2ABC: closes. applyIndex: 0
2021-10-05 13:25:30,118 [9cad18a2-4b78-4cb8-813e-2348ce620e43@group-9360A73A2ABC-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:run(327)) - 9cad18a2-4b78-4cb8-813e-2348ce620e43@group-9360A73A2ABC-SegmentedRaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2021-10-05 13:25:30,118 [ForkJoinPool.commonPool-worker-0] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:close(237)) - 9cad18a2-4b78-4cb8-813e-2348ce620e43@group-9360A73A2ABC-SegmentedRaftLogWorker close()
2021-10-05 13:25:30,118 [ForkJoinPool.commonPool-worker-0] INFO  server.GrpcService (GrpcService.java:closeImpl(262)) - 9cad18a2-4b78-4cb8-813e-2348ce620e43: shutdown server with port 34379 now
2021-10-05 13:25:30,136 [ForkJoinPool.commonPool-worker-0] INFO  server.GrpcService (GrpcService.java:closeImpl(271)) - 9cad18a2-4b78-4cb8-813e-2348ce620e43: shutdown server with port 34379 successfully
2021-10-05 13:25:30,136 [org.apache.ratis.util.JvmPauseMonitor$$Lambda$499/1586779822@6e58f4d1] INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(109)) - JvmPauseMonitor-9cad18a2-4b78-4cb8-813e-2348ce620e43: Stopped
2021-10-05 13:25:30,140 [ForkJoinPool.commonPool-worker-0] INFO  utils.BackgroundService (BackgroundService.java:shutdown(132)) - Shutting down service BlockDeletingService
2021-10-05 13:25:30,764 [EndpointStateMachine task thread for /127.0.0.1:15041 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15041. Already tried 7 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:30,789 [EndpointStateMachine task thread for /127.0.0.1:13549 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:13549. Already tried 13 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:30,789 [EndpointStateMachine task thread for /127.0.0.1:13529 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:13529. Already tried 13 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:30,830 [EndpointStateMachine task thread for /127.0.0.1:15021 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15021. Already tried 11 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:30,830 [EndpointStateMachine task thread for /127.0.0.1:15031 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15031. Already tried 11 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:30,949 [EndpointStateMachine task thread for /127.0.0.1:13539 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:13539. Already tried 12 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:31,764 [EndpointStateMachine task thread for /127.0.0.1:15041 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15041. Already tried 8 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:31,793 [EndpointStateMachine task thread for /127.0.0.1:13529 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:13529. Already tried 14 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:31,793 [EndpointStateMachine task thread for /127.0.0.1:13529 - 0 ] WARN  statemachine.EndpointStateMachine (EndpointStateMachine.java:logIfNeeded(236)) - Unable to communicate to SCM server at localhost:13529 for past 0 seconds.
java.net.ConnectException: Call From fv-az270-324/10.1.0.10 to localhost:13529 failed on connection exception: java.net.ConnectException: Connection refused; For more details see:  http://wiki.apache.org/hadoop/ConnectionRefused
	at sun.reflect.GeneratedConstructorAccessor42.newInstance(Unknown Source)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.hadoop.net.NetUtils.wrapWithMessage(NetUtils.java:913)
	at org.apache.hadoop.net.NetUtils.wrapException(NetUtils.java:828)
	at org.apache.hadoop.ipc.Client.getRpcResponse(Client.java:1577)
	at org.apache.hadoop.ipc.Client.call(Client.java:1519)
	at org.apache.hadoop.ipc.Client.call(Client.java:1416)
	at org.apache.hadoop.ipc.ProtobufRpcEngine$Invoker.invoke(ProtobufRpcEngine.java:236)
	at org.apache.hadoop.ipc.ProtobufRpcEngine$Invoker.invoke(ProtobufRpcEngine.java:123)
	at com.sun.proxy.$Proxy48.submitRequest(Unknown Source)
	at org.apache.hadoop.ozone.protocolPB.StorageContainerDatanodeProtocolClientSideTranslatorPB.submitRequest(StorageContainerDatanodeProtocolClientSideTranslatorPB.java:117)
	at org.apache.hadoop.ozone.protocolPB.StorageContainerDatanodeProtocolClientSideTranslatorPB.sendHeartbeat(StorageContainerDatanodeProtocolClientSideTranslatorPB.java:149)
	at org.apache.hadoop.ozone.container.common.states.endpoint.HeartbeatEndpointTask.call(HeartbeatEndpointTask.java:179)
	at org.apache.hadoop.ozone.container.common.states.endpoint.HeartbeatEndpointTask.call(HeartbeatEndpointTask.java:82)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.net.ConnectException: Connection refused
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:716)
	at org.apache.hadoop.net.SocketIOWithTimeout.connect(SocketIOWithTimeout.java:206)
	at org.apache.hadoop.net.NetUtils.connect(NetUtils.java:586)
	at org.apache.hadoop.ipc.Client$Connection.setupConnection(Client.java:701)
	at org.apache.hadoop.ipc.Client$Connection.setupIOstreams(Client.java:822)
	at org.apache.hadoop.ipc.Client$Connection.access$3800(Client.java:414)
	at org.apache.hadoop.ipc.Client.getConnection(Client.java:1647)
	at org.apache.hadoop.ipc.Client.call(Client.java:1463)
	... 12 more
2021-10-05 13:25:31,794 [EndpointStateMachine task thread for /127.0.0.1:13549 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:13549. Already tried 14 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:31,794 [EndpointStateMachine task thread for /127.0.0.1:13549 - 0 ] WARN  statemachine.EndpointStateMachine (EndpointStateMachine.java:logIfNeeded(236)) - Unable to communicate to SCM server at localhost:13549 for past 0 seconds.
java.net.ConnectException: Call From fv-az270-324/10.1.0.10 to localhost:13549 failed on connection exception: java.net.ConnectException: Connection refused; For more details see:  http://wiki.apache.org/hadoop/ConnectionRefused
	at sun.reflect.GeneratedConstructorAccessor42.newInstance(Unknown Source)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.hadoop.net.NetUtils.wrapWithMessage(NetUtils.java:913)
	at org.apache.hadoop.net.NetUtils.wrapException(NetUtils.java:828)
	at org.apache.hadoop.ipc.Client.getRpcResponse(Client.java:1577)
	at org.apache.hadoop.ipc.Client.call(Client.java:1519)
	at org.apache.hadoop.ipc.Client.call(Client.java:1416)
	at org.apache.hadoop.ipc.ProtobufRpcEngine$Invoker.invoke(ProtobufRpcEngine.java:236)
	at org.apache.hadoop.ipc.ProtobufRpcEngine$Invoker.invoke(ProtobufRpcEngine.java:123)
	at com.sun.proxy.$Proxy48.submitRequest(Unknown Source)
	at org.apache.hadoop.ozone.protocolPB.StorageContainerDatanodeProtocolClientSideTranslatorPB.submitRequest(StorageContainerDatanodeProtocolClientSideTranslatorPB.java:117)
	at org.apache.hadoop.ozone.protocolPB.StorageContainerDatanodeProtocolClientSideTranslatorPB.register(StorageContainerDatanodeProtocolClientSideTranslatorPB.java:180)
	at org.apache.hadoop.ozone.container.common.states.endpoint.RegisterEndpointTask.call(RegisterEndpointTask.java:158)
	at org.apache.hadoop.ozone.container.common.states.endpoint.RegisterEndpointTask.call(RegisterEndpointTask.java:52)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.net.ConnectException: Connection refused
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:716)
	at org.apache.hadoop.net.SocketIOWithTimeout.connect(SocketIOWithTimeout.java:206)
	at org.apache.hadoop.net.NetUtils.connect(NetUtils.java:586)
	at org.apache.hadoop.ipc.Client$Connection.setupConnection(Client.java:701)
	at org.apache.hadoop.ipc.Client$Connection.setupIOstreams(Client.java:822)
	at org.apache.hadoop.ipc.Client$Connection.access$3800(Client.java:414)
	at org.apache.hadoop.ipc.Client.getConnection(Client.java:1647)
	at org.apache.hadoop.ipc.Client.call(Client.java:1463)
	... 12 more
2021-10-05 13:25:31,830 [EndpointStateMachine task thread for /127.0.0.1:15021 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15021. Already tried 12 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:31,830 [EndpointStateMachine task thread for /127.0.0.1:15031 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15031. Already tried 12 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:31,950 [EndpointStateMachine task thread for /127.0.0.1:13539 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:13539. Already tried 13 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:32,765 [EndpointStateMachine task thread for /127.0.0.1:15041 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15041. Already tried 9 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:32,794 [EndpointStateMachine task thread for /127.0.0.1:13529 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:13529. Already tried 0 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:32,795 [EndpointStateMachine task thread for /127.0.0.1:13549 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:13549. Already tried 0 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:32,830 [EndpointStateMachine task thread for /127.0.0.1:15021 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15021. Already tried 13 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:32,831 [EndpointStateMachine task thread for /127.0.0.1:15031 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15031. Already tried 13 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:32,950 [EndpointStateMachine task thread for /127.0.0.1:13539 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:13539. Already tried 14 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:33,141 [ForkJoinPool.commonPool-worker-0] INFO  statemachine.DatanodeStateMachine (DatanodeStateMachine.java:stopDaemon(515)) - Ozone container server stopped.
2021-10-05 13:25:33,143 [ForkJoinPool.commonPool-worker-0] INFO  handler.ContextHandler (ContextHandler.java:doStop(1153)) - Stopped o.e.j.w.WebAppContext@3989e022{hddsDatanode,/,null,STOPPED}{jar:file:/home/runner/.m2/repository/org/apache/ozone/hdds-container-service/1.2.0-SNAPSHOT/hdds-container-service-1.2.0-SNAPSHOT.jar!/webapps/hddsDatanode}
2021-10-05 13:25:33,148 [ForkJoinPool.commonPool-worker-0] INFO  server.AbstractConnector (AbstractConnector.java:doStop(381)) - Stopped ServerConnector@3b2a3542{HTTP/1.1, (http/1.1)}{0.0.0.0:0}
2021-10-05 13:25:33,148 [ForkJoinPool.commonPool-worker-0] INFO  server.session (HouseKeeper.java:stopScavenging(149)) - node0 Stopped scavenging
2021-10-05 13:25:33,151 [ForkJoinPool.commonPool-worker-0] INFO  handler.ContextHandler (ContextHandler.java:doStop(1153)) - Stopped o.e.j.s.ServletContextHandler@6834f33a{static,/static,jar:file:/home/runner/.m2/repository/org/apache/ozone/hdds-container-service/1.2.0-SNAPSHOT/hdds-container-service-1.2.0-SNAPSHOT.jar!/webapps/static,STOPPED}
2021-10-05 13:25:33,152 [ForkJoinPool.commonPool-worker-0] INFO  handler.ContextHandler (ContextHandler.java:doStop(1153)) - Stopped o.e.j.s.ServletContextHandler@430bcbd4{logs,/logs,file:///home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/log,STOPPED}
2021-10-05 13:25:33,296 [Listener at 127.0.0.1/13296] WARN  server.ServerUtils (ServerUtils.java:getScmDbDir(148)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2021-10-05 13:25:33,296 [Listener at 127.0.0.1/13296] INFO  ha.SCMHANodeDetails (SCMHANodeDetails.java:loadSCMHAConfig(157)) - ServiceID for StorageContainerManager is scm-service-test1
2021-10-05 13:25:33,296 [Listener at 127.0.0.1/13296] INFO  ha.SCMHANodeDetails (SCMHANodeDetails.java:loadSCMHAConfig(168)) - ServiceID for StorageContainerManager is scm-service-test1
2021-10-05 13:25:33,296 [Listener at 127.0.0.1/13296] WARN  scm.ScmUtils (ScmUtils.java:logWarn(179)) - ConfigKey ozone.scm.block.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.block.client.port appended with serviceId and nodeId. If want to configure same port configure ozone.scm.block.client.port
2021-10-05 13:25:33,297 [Listener at 127.0.0.1/13296] WARN  scm.ScmUtils (ScmUtils.java:logWarn(179)) - ConfigKey ozone.scm.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.client.port appended with serviceId and nodeId. If want to configure same port configure ozone.scm.client.port
2021-10-05 13:25:33,297 [Listener at 127.0.0.1/13296] WARN  scm.ScmUtils (ScmUtils.java:logWarn(179)) - ConfigKey ozone.scm.datanode.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.datanode.port appended with serviceId and nodeId. If want to configure same port configure ozone.scm.datanode.port
2021-10-05 13:25:33,297 [Listener at 127.0.0.1/13296] WARN  scm.ScmUtils (ScmUtils.java:logWarn(179)) - ConfigKey ozone.scm.block.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.block.client.port appended with serviceId and nodeId. If want to configure same port configure ozone.scm.block.client.port
2021-10-05 13:25:33,297 [Listener at 127.0.0.1/13296] WARN  scm.ScmUtils (ScmUtils.java:logWarn(179)) - ConfigKey ozone.scm.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.client.port appended with serviceId and nodeId. If want to configure same port configure ozone.scm.client.port
2021-10-05 13:25:33,297 [Listener at 127.0.0.1/13296] WARN  scm.ScmUtils (ScmUtils.java:logWarn(179)) - ConfigKey ozone.scm.datanode.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.datanode.port appended with serviceId and nodeId. If want to configure same port configure ozone.scm.datanode.port
2021-10-05 13:25:33,297 [Listener at 127.0.0.1/13296] INFO  ha.SCMHANodeDetails (SCMHANodeDetails.java:loadSCMHAConfig(250)) - Found matching SCM address with SCMServiceId: scm-service-test1, SCMNodeId: scmNode-1, RPC Address: localhost:12120 and Ratis port: 12120
2021-10-05 13:25:33,297 [Listener at 127.0.0.1/13296] INFO  ha.SCMHANodeDetails (ConfUtils.java:setNodeSpecificConfigs(108)) - Setting configuration key ozone.scm.datanode.address with value of key ozone.scm.datanode.address.scm-service-test1.scmNode-1: 127.0.0.1:12121
2021-10-05 13:25:33,298 [Listener at 127.0.0.1/13296] INFO  ha.SCMHANodeDetails (ConfUtils.java:setNodeSpecificConfigs(108)) - Setting configuration key ozone.scm.block.client.address with value of key ozone.scm.block.client.address.scm-service-test1.scmNode-1: 127.0.0.1:12122
2021-10-05 13:25:33,298 [Listener at 127.0.0.1/13296] INFO  ha.SCMHANodeDetails (ConfUtils.java:setNodeSpecificConfigs(108)) - Setting configuration key ozone.scm.client.address with value of key ozone.scm.client.address.scm-service-test1.scmNode-1: 127.0.0.1:12123
2021-10-05 13:25:33,298 [Listener at 127.0.0.1/13296] INFO  ha.SCMHANodeDetails (ConfUtils.java:setNodeSpecificConfigs(108)) - Setting configuration key ozone.scm.ratis.port with value of key ozone.scm.ratis.port.scm-service-test1.scmNode-1: 12120
2021-10-05 13:25:33,298 [Listener at 127.0.0.1/13296] INFO  ha.SCMHANodeDetails (ConfUtils.java:setNodeSpecificConfigs(108)) - Setting configuration key ozone.scm.grpc.port with value of key ozone.scm.grpc.port.scm-service-test1.scmNode-1: 12124
2021-10-05 13:25:33,298 [Listener at 127.0.0.1/13296] INFO  ha.SCMHANodeDetails (ConfUtils.java:setNodeSpecificConfigs(108)) - Setting configuration key ozone.scm.http-address with value of key ozone.scm.http-address.scm-service-test1.scmNode-1: 127.0.0.1:12118
2021-10-05 13:25:33,298 [Listener at 127.0.0.1/13296] INFO  ha.SCMHANodeDetails (ConfUtils.java:setNodeSpecificConfigs(108)) - Setting configuration key ozone.scm.https-address with value of key ozone.scm.https-address.scm-service-test1.scmNode-1: 127.0.0.1:12119
2021-10-05 13:25:33,298 [Listener at 127.0.0.1/13296] INFO  ha.SCMHANodeDetails (ConfUtils.java:setNodeSpecificConfigs(108)) - Setting configuration key ozone.scm.address with value of key ozone.scm.address.scm-service-test1.scmNode-1: 127.0.0.1
2021-10-05 13:25:33,298 [Listener at 127.0.0.1/13296] WARN  scm.ScmUtils (ScmUtils.java:logWarn(179)) - ConfigKey ozone.scm.block.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.block.client.port appended with serviceId and nodeId. If want to configure same port configure ozone.scm.block.client.port
2021-10-05 13:25:33,298 [Listener at 127.0.0.1/13296] WARN  scm.ScmUtils (ScmUtils.java:logWarn(179)) - ConfigKey ozone.scm.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.client.port appended with serviceId and nodeId. If want to configure same port configure ozone.scm.client.port
2021-10-05 13:25:33,298 [Listener at 127.0.0.1/13296] WARN  scm.ScmUtils (ScmUtils.java:logWarn(179)) - ConfigKey ozone.scm.datanode.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.datanode.port appended with serviceId and nodeId. If want to configure same port configure ozone.scm.datanode.port
2021-10-05 13:25:33,321 [Listener at 127.0.0.1/13296] INFO  server.RaftServer (ConfUtils.java:logGet(44)) - raft.rpc.type = GRPC (default)
2021-10-05 13:25:33,322 [Listener at 127.0.0.1/13296] INFO  grpc.GrpcFactory (GrpcFactory.java:checkPooledByteBufAllocatorUseCacheForAllThreads(48)) - PERFORMANCE WARNING: useCacheForAllThreads is true that may cause Netty to create a lot garbage objects and, as a result, trigger GC.
	It is recommended to disable useCacheForAllThreads by setting -Dorg.apache.ratis.thirdparty.io.netty.allocator.useCacheForAllThreads=false in command line.
2021-10-05 13:25:33,324 [Listener at 127.0.0.1/13296] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(44)) - raft.grpc.admin.port = -1 (default)
2021-10-05 13:25:33,324 [Listener at 127.0.0.1/13296] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(44)) - raft.grpc.server.port = 12120 (custom)
2021-10-05 13:25:33,324 [Listener at 127.0.0.1/13296] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(44)) - raft.grpc.client.port = -1 (default)
2021-10-05 13:25:33,324 [Listener at 127.0.0.1/13296] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(44)) - raft.grpc.server.port = 12120 (custom)
2021-10-05 13:25:33,324 [Listener at 127.0.0.1/13296] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(44)) - raft.grpc.server.port = 12120 (custom)
2021-10-05 13:25:33,326 [Listener at 127.0.0.1/13296] INFO  server.GrpcService (ConfUtils.java:logGet(44)) - raft.grpc.message.size.max = 32m (=33554432) (custom)
2021-10-05 13:25:33,326 [Listener at 127.0.0.1/13296] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2021-10-05 13:25:33,326 [Listener at 127.0.0.1/13296] INFO  server.GrpcService (ConfUtils.java:logGet(44)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2021-10-05 13:25:33,327 [Listener at 127.0.0.1/13296] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.request.timeout = 30000ms (custom)
2021-10-05 13:25:33,329 [Listener at 127.0.0.1/13296] INFO  impl.DataStreamServerImpl (ConfUtils.java:logGet(44)) - raft.datastream.type = DISABLED (default)
2021-10-05 13:25:33,332 [Listener at 127.0.0.1/13296] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.slowness.timeout = 120000ms (custom)
2021-10-05 13:25:33,332 [Listener at 127.0.0.1/13296] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.leaderelection.leader.step-down.wait-time = 10s (default)
2021-10-05 13:25:33,332 [Listener at 127.0.0.1/13296] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.storage.dir = [/home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-62d231c0-d845-4dcd-88aa-c082e017c57e/scmNode-1/scm-ha] (custom)
2021-10-05 13:25:33,338 [Listener at 127.0.0.1/13296] INFO  server.RaftServer (RaftServerProxy.java:addNew(95)) - 61371ea4-f7c9-4e51-8ebe-bd324b8103e3: addNew group-C082E017C57E:[61371ea4-f7c9-4e51-8ebe-bd324b8103e3|rpc:localhost:12120|priority:0] returns group-C082E017C57E:java.util.concurrent.CompletableFuture@2a89db92[Not completed]
2021-10-05 13:25:33,338 [pool-343-thread-1] INFO  server.RaftServer$Division (RaftServerImpl.java:<init>(181)) - 61371ea4-f7c9-4e51-8ebe-bd324b8103e3: new RaftServerImpl for group-C082E017C57E:[61371ea4-f7c9-4e51-8ebe-bd324b8103e3|rpc:localhost:12120|priority:0] with SCMStateMachine:uninitialized
2021-10-05 13:25:33,351 [pool-343-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.timeout.min = 5000ms (custom)
2021-10-05 13:25:33,351 [pool-343-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.timeout.max = 5200ms (custom)
2021-10-05 13:25:33,351 [pool-343-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.sleep.time = 25ms (default)
2021-10-05 13:25:33,351 [pool-343-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.slowness.timeout = 120000ms (custom)
2021-10-05 13:25:33,351 [pool-343-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.leaderelection.leader.step-down.wait-time = 10s (default)
2021-10-05 13:25:33,351 [pool-343-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.sleep.deviation.threshold = 300ms (default)
2021-10-05 13:25:33,351 [pool-343-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.appender.install.snapshot.enabled = false (custom)
2021-10-05 13:25:33,351 [pool-343-thread-1] INFO  server.RaftServer$Division (ServerState.java:<init>(105)) - 61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E: ConfigurationManager, init=-1: [61371ea4-f7c9-4e51-8ebe-bd324b8103e3|rpc:localhost:12120|priority:0], old=null, confs=<EMPTY_MAP>
2021-10-05 13:25:33,351 [pool-343-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.storage.dir = [/home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-62d231c0-d845-4dcd-88aa-c082e017c57e/scmNode-1/scm-ha] (custom)
2021-10-05 13:25:33,352 [pool-343-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.corruption.policy = EXCEPTION (default)
2021-10-05 13:25:33,352 [pool-343-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.storage.free-space.min = 0MB (=0) (default)
2021-10-05 13:25:33,352 [pool-343-thread-1] INFO  storage.RaftStorageDirectory (RaftStorageDirectoryImpl.java:analyzeStorage(135)) - The storage directory /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-62d231c0-d845-4dcd-88aa-c082e017c57e/scmNode-1/scm-ha/62d231c0-d845-4dcd-88aa-c082e017c57e does not exist. Creating ...
2021-10-05 13:25:33,353 [pool-343-thread-1] INFO  storage.RaftStorageDirectory (RaftStorageDirectoryImpl.java:tryLock(230)) - Lock on /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-62d231c0-d845-4dcd-88aa-c082e017c57e/scmNode-1/scm-ha/62d231c0-d845-4dcd-88aa-c082e017c57e/in_use.lock acquired by nodename 17451@fv-az270-324
2021-10-05 13:25:33,355 [pool-343-thread-1] INFO  storage.RaftStorage (RaftStorageImpl.java:format(89)) - Storage directory /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-62d231c0-d845-4dcd-88aa-c082e017c57e/scmNode-1/scm-ha/62d231c0-d845-4dcd-88aa-c082e017c57e has been successfully formatted.
2021-10-05 13:25:33,355 [pool-343-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.notification.no-leader.timeout = 60s (default)
2021-10-05 13:25:33,355 [pool-343-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.use.memory = false (default)
2021-10-05 13:25:33,355 [pool-343-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.purge.gap = 5 (custom)
2021-10-05 13:25:33,355 [pool-343-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2021-10-05 13:25:33,356 [pool-343-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.segment.size.max = 16384 (custom)
2021-10-05 13:25:33,356 [pool-343-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.segment.cache.num.max = 2 (custom)
2021-10-05 13:25:33,356 [pool-343-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.segment.cache.size.max = 200MB (=209715200) (default)
2021-10-05 13:25:33,356 [pool-343-thread-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:<init>(182)) - new 61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-SegmentedRaftLogWorker for RaftStorageImpl:Storage Directory /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-62d231c0-d845-4dcd-88aa-c082e017c57e/scmNode-1/scm-ha/62d231c0-d845-4dcd-88aa-c082e017c57e
2021-10-05 13:25:33,356 [pool-343-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.queue.byte-limit = 64MB (=67108864) (default)
2021-10-05 13:25:33,356 [pool-343-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.queue.element-limit = 4096 (default)
2021-10-05 13:25:33,356 [pool-343-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.segment.size.max = 16384 (custom)
2021-10-05 13:25:33,356 [pool-343-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.preallocated.size = 16384 (custom)
2021-10-05 13:25:33,356 [pool-343-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.force.sync.num = 128 (default)
2021-10-05 13:25:33,357 [pool-343-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.statemachine.data.sync = true (default)
2021-10-05 13:25:33,357 [pool-343-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2021-10-05 13:25:33,357 [pool-343-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2021-10-05 13:25:33,357 [pool-343-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.write.buffer.size = 64KB (=65536) (default)
2021-10-05 13:25:33,357 [pool-343-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.statemachine.data.caching.enabled = false (default)
2021-10-05 13:25:33,357 [pool-343-thread-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:lambda$new$0(133)) - 61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-SegmentedRaftLogWorker: flushIndex: setUnconditionally 0 -> -1
2021-10-05 13:25:33,357 [pool-343-thread-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:lambda$new$0(133)) - 61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-SegmentedRaftLogWorker: safeCacheEvictIndex: setUnconditionally 0 -> -1
2021-10-05 13:25:33,363 [pool-343-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2021-10-05 13:25:33,363 [pool-343-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.snapshot.auto.trigger.threshold = 5 (custom)
2021-10-05 13:25:33,363 [pool-343-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.snapshot.retention.file.num = -1 (default)
2021-10-05 13:25:33,363 [pool-343-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.purge.upto.snapshot.index = true (custom)
2021-10-05 13:25:33,363 [pool-343-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.retrycache.expirytime = 60000ms (default)
2021-10-05 13:25:33,363 [pool-343-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.retrycache.statistics.expirytime = 100μs (default)
2021-10-05 13:25:33,365 [Listener at 127.0.0.1/13296] INFO  server.RaftServer$Division (RaftServerImpl.java:start(296)) - 61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E: start as a follower, conf=-1: [61371ea4-f7c9-4e51-8ebe-bd324b8103e3|rpc:localhost:12120|priority:0], old=null
2021-10-05 13:25:33,365 [Listener at 127.0.0.1/13296] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(285)) - 61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E: changes role from      null to FOLLOWER at term 0 for startAsFollower
2021-10-05 13:25:33,365 [Listener at 127.0.0.1/13296] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(130)) - 61371ea4-f7c9-4e51-8ebe-bd324b8103e3: start 61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-FollowerState
2021-10-05 13:25:33,373 [Listener at 127.0.0.1/13296] INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-C082E017C57E,id=61371ea4-f7c9-4e51-8ebe-bd324b8103e3
2021-10-05 13:25:33,373 [Listener at 127.0.0.1/13296] INFO  server.RaftServer (RaftServerProxy.java:lambda$start$5(374)) - 61371ea4-f7c9-4e51-8ebe-bd324b8103e3: start RPC server
2021-10-05 13:25:33,374 [Listener at 127.0.0.1/13296] INFO  server.GrpcService (GrpcService.java:startImpl(253)) - 61371ea4-f7c9-4e51-8ebe-bd324b8103e3: GrpcService started, listening on 12120
2021-10-05 13:25:33,375 [org.apache.ratis.util.JvmPauseMonitor$$Lambda$499/1586779822@1936fe56] INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(103)) - JvmPauseMonitor-61371ea4-f7c9-4e51-8ebe-bd324b8103e3: Started
2021-10-05 13:25:33,765 [EndpointStateMachine task thread for /127.0.0.1:15041 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15041. Already tried 10 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:33,794 [EndpointStateMachine task thread for /127.0.0.1:13529 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:13529. Already tried 1 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:33,795 [EndpointStateMachine task thread for /127.0.0.1:13549 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:13549. Already tried 1 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:33,831 [EndpointStateMachine task thread for /127.0.0.1:15021 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15021. Already tried 14 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:33,831 [EndpointStateMachine task thread for /127.0.0.1:15031 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15031. Already tried 14 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:33,951 [EndpointStateMachine task thread for /127.0.0.1:13539 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:13539. Already tried 0 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:34,766 [EndpointStateMachine task thread for /127.0.0.1:15041 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15041. Already tried 11 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:34,795 [EndpointStateMachine task thread for /127.0.0.1:13529 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:13529. Already tried 2 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:34,796 [EndpointStateMachine task thread for /127.0.0.1:13549 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:13549. Already tried 2 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:34,832 [EndpointStateMachine task thread for /127.0.0.1:15031 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15031. Already tried 0 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:34,833 [EndpointStateMachine task thread for /127.0.0.1:15021 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15021. Already tried 0 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:34,951 [EndpointStateMachine task thread for /127.0.0.1:13539 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:13539. Already tried 1 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:35,767 [EndpointStateMachine task thread for /127.0.0.1:15041 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15041. Already tried 12 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:35,795 [EndpointStateMachine task thread for /127.0.0.1:13529 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:13529. Already tried 3 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:35,796 [EndpointStateMachine task thread for /127.0.0.1:13549 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:13549. Already tried 3 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:35,832 [EndpointStateMachine task thread for /127.0.0.1:15031 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15031. Already tried 1 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:35,834 [EndpointStateMachine task thread for /127.0.0.1:15021 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15021. Already tried 1 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:35,952 [EndpointStateMachine task thread for /127.0.0.1:13539 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:13539. Already tried 2 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:36,767 [EndpointStateMachine task thread for /127.0.0.1:15041 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15041. Already tried 13 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:36,797 [EndpointStateMachine task thread for /127.0.0.1:13529 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:13529. Already tried 4 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:36,798 [EndpointStateMachine task thread for /127.0.0.1:13549 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:13549. Already tried 4 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:36,833 [EndpointStateMachine task thread for /127.0.0.1:15031 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15031. Already tried 2 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:36,834 [EndpointStateMachine task thread for /127.0.0.1:15021 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15021. Already tried 2 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:36,952 [EndpointStateMachine task thread for /127.0.0.1:13539 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:13539. Already tried 3 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:37,768 [EndpointStateMachine task thread for /127.0.0.1:15041 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15041. Already tried 14 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:37,798 [EndpointStateMachine task thread for /127.0.0.1:13529 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:13529. Already tried 5 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:37,798 [EndpointStateMachine task thread for /127.0.0.1:13549 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:13549. Already tried 5 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:37,833 [EndpointStateMachine task thread for /127.0.0.1:15031 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15031. Already tried 3 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:37,843 [EndpointStateMachine task thread for /127.0.0.1:15021 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15021. Already tried 3 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:37,952 [EndpointStateMachine task thread for /127.0.0.1:13539 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:13539. Already tried 4 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:38,417 [61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-FollowerState] INFO  impl.FollowerState (FollowerState.java:run(134)) - 61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-FollowerState: change to CANDIDATE, lastRpcElapsedTime:5052570038ns, electionTimeout:5044ms
2021-10-05 13:25:38,418 [61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-FollowerState] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(108)) - 61371ea4-f7c9-4e51-8ebe-bd324b8103e3: shutdown 61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-FollowerState
2021-10-05 13:25:38,418 [61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-FollowerState] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(285)) - 61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E: changes role from  FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2021-10-05 13:25:38,418 [61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-FollowerState] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.leaderelection.pre-vote = false (custom)
2021-10-05 13:25:38,418 [61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-FollowerState] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(130)) - 61371ea4-f7c9-4e51-8ebe-bd324b8103e3: start 61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-LeaderElection28
2021-10-05 13:25:38,448 [61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-LeaderElection28] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(306)) - 61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-LeaderElection28 ELECTION round 0: submit vote requests at term 1 for -1: [61371ea4-f7c9-4e51-8ebe-bd324b8103e3|rpc:localhost:12120|priority:0], old=null
2021-10-05 13:25:38,448 [61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-LeaderElection28] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(308)) - 61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-LeaderElection28 ELECTION round 0: result PASSED (term=1)
2021-10-05 13:25:38,448 [61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-LeaderElection28] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(121)) - 61371ea4-f7c9-4e51-8ebe-bd324b8103e3: shutdown 61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-LeaderElection28
2021-10-05 13:25:38,448 [61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-LeaderElection28] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(285)) - 61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E: changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2021-10-05 13:25:38,448 [61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-LeaderElection28] INFO  server.RaftServer$Division (ServerState.java:setLeader(285)) - 61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E: change Leader from null to 61371ea4-f7c9-4e51-8ebe-bd324b8103e3 at term 1 for becomeLeader, leader elected after 5092ms
2021-10-05 13:25:38,448 [61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-LeaderElection28] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.staging.catchup.gap = 1000 (default)
2021-10-05 13:25:38,448 [61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-LeaderElection28] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.write.element-limit = 4096 (default)
2021-10-05 13:25:38,448 [61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-LeaderElection28] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.write.byte-limit = 64MB (=67108864) (default)
2021-10-05 13:25:38,449 [61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-LeaderElection28] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.watch.timeout = 10s (default)
2021-10-05 13:25:38,449 [61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-LeaderElection28] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.watch.timeout.denomination = 1s (default)
2021-10-05 13:25:38,449 [61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-LeaderElection28] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.watch.element-limit = 65536 (default)
2021-10-05 13:25:38,449 [61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-LeaderElection28] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(130)) - 61371ea4-f7c9-4e51-8ebe-bd324b8103e3: start 61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-LeaderStateImpl
2021-10-05 13:25:38,449 [61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-LeaderElection28] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:startLogSegment(394)) - 61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-SegmentedRaftLogWorker: Starting segment from index:0
2021-10-05 13:25:38,453 [61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(601)) - 61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-SegmentedRaftLogWorker: created new log segment /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-62d231c0-d845-4dcd-88aa-c082e017c57e/scmNode-1/scm-ha/62d231c0-d845-4dcd-88aa-c082e017c57e/current/log_inprogress_0
2021-10-05 13:25:38,463 [61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-LeaderElection28] INFO  server.RaftServer$Division (ServerState.java:setRaftConf(387)) - 61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E: set configuration 0: [61371ea4-f7c9-4e51-8ebe-bd324b8103e3|rpc:localhost:12120|admin:|client:|dataStream:|priority:0], old=null
2021-10-05 13:25:38,769 [EndpointStateMachine task thread for /127.0.0.1:15041 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15041. Already tried 0 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:38,798 [EndpointStateMachine task thread for /127.0.0.1:13529 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:13529. Already tried 6 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:38,799 [EndpointStateMachine task thread for /127.0.0.1:13549 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:13549. Already tried 6 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:38,834 [EndpointStateMachine task thread for /127.0.0.1:15031 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15031. Already tried 4 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:38,843 [EndpointStateMachine task thread for /127.0.0.1:15021 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15021. Already tried 4 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:38,953 [EndpointStateMachine task thread for /127.0.0.1:13539 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:13539. Already tried 5 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:39,375 [Listener at 127.0.0.1/13296] INFO  server.RaftServer (RaftServerProxy.java:lambda$close$6(391)) - 61371ea4-f7c9-4e51-8ebe-bd324b8103e3: close
2021-10-05 13:25:39,376 [Listener at 127.0.0.1/13296] INFO  server.RaftServer$Division (RaftServerImpl.java:lambda$close$4(407)) - 61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E: shutdown
2021-10-05 13:25:39,376 [Listener at 127.0.0.1/13296] INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-C082E017C57E,id=61371ea4-f7c9-4e51-8ebe-bd324b8103e3
2021-10-05 13:25:39,376 [Listener at 127.0.0.1/13296] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(91)) - 61371ea4-f7c9-4e51-8ebe-bd324b8103e3: shutdown 61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-LeaderStateImpl
2021-10-05 13:25:39,376 [Listener at 127.0.0.1/13296] INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(282)) - 61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-PendingRequests: sendNotLeaderResponses
2021-10-05 13:25:39,377 [Listener at 127.0.0.1/13296] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(149)) - 61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-StateMachineUpdater: set stopIndex = 0
2021-10-05 13:25:39,377 [61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:takeSnapshot(281)) - 61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-StateMachineUpdater: Took a snapshot at index 0
2021-10-05 13:25:39,377 [61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:lambda$new$0(89)) - 61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-StateMachineUpdater: snapshotIndex: updateIncreasingly -1 -> 0
2021-10-05 13:25:39,377 [Listener at 127.0.0.1/13296] INFO  server.RaftServer$Division (ServerState.java:close(419)) - 61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E: closes. applyIndex: 0
2021-10-05 13:25:39,378 [61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:run(327)) - 61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-SegmentedRaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2021-10-05 13:25:39,378 [Listener at 127.0.0.1/13296] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:close(237)) - 61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-SegmentedRaftLogWorker close()
2021-10-05 13:25:39,379 [Listener at 127.0.0.1/13296] INFO  server.GrpcService (GrpcService.java:closeImpl(262)) - 61371ea4-f7c9-4e51-8ebe-bd324b8103e3: shutdown server with port 12120 now
2021-10-05 13:25:39,380 [Listener at 127.0.0.1/13296] INFO  server.GrpcService (GrpcService.java:closeImpl(271)) - 61371ea4-f7c9-4e51-8ebe-bd324b8103e3: shutdown server with port 12120 successfully
2021-10-05 13:25:39,380 [org.apache.ratis.util.JvmPauseMonitor$$Lambda$499/1586779822@1936fe56] INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(109)) - JvmPauseMonitor-61371ea4-f7c9-4e51-8ebe-bd324b8103e3: Stopped
2021-10-05 13:25:39,380 [Listener at 127.0.0.1/13296] WARN  server.ServerUtils (ServerUtils.java:getScmDbDir(148)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2021-10-05 13:25:39,384 [Listener at 127.0.0.1/13296] INFO  server.StorageContainerManager (StorageContainerManager.java:scmInit(1083)) - SCM initialization succeeded. Current cluster id for sd=/home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-62d231c0-d845-4dcd-88aa-c082e017c57e/scmNode-1/scm; cid=62d231c0-d845-4dcd-88aa-c082e017c57e; layoutVersion=2; scmId=61371ea4-f7c9-4e51-8ebe-bd324b8103e3
2021-10-05 13:25:39,384 [Listener at 127.0.0.1/13296] INFO  ha.SCMHANodeDetails (SCMHANodeDetails.java:loadSCMHAConfig(157)) - ServiceID for StorageContainerManager is scm-service-test1
2021-10-05 13:25:39,384 [Listener at 127.0.0.1/13296] INFO  ha.SCMHANodeDetails (SCMHANodeDetails.java:loadSCMHAConfig(168)) - ServiceID for StorageContainerManager is scm-service-test1
2021-10-05 13:25:39,385 [Listener at 127.0.0.1/13296] WARN  scm.ScmUtils (ScmUtils.java:logWarn(179)) - ConfigKey ozone.scm.block.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.block.client.port appended with serviceId and nodeId. If want to configure same port configure ozone.scm.block.client.port
2021-10-05 13:25:39,385 [Listener at 127.0.0.1/13296] WARN  scm.ScmUtils (ScmUtils.java:logWarn(179)) - ConfigKey ozone.scm.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.client.port appended with serviceId and nodeId. If want to configure same port configure ozone.scm.client.port
2021-10-05 13:25:39,385 [Listener at 127.0.0.1/13296] WARN  scm.ScmUtils (ScmUtils.java:logWarn(179)) - ConfigKey ozone.scm.datanode.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.datanode.port appended with serviceId and nodeId. If want to configure same port configure ozone.scm.datanode.port
2021-10-05 13:25:39,385 [Listener at 127.0.0.1/13296] WARN  scm.ScmUtils (ScmUtils.java:logWarn(179)) - ConfigKey ozone.scm.block.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.block.client.port appended with serviceId and nodeId. If want to configure same port configure ozone.scm.block.client.port
2021-10-05 13:25:39,385 [Listener at 127.0.0.1/13296] WARN  scm.ScmUtils (ScmUtils.java:logWarn(179)) - ConfigKey ozone.scm.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.client.port appended with serviceId and nodeId. If want to configure same port configure ozone.scm.client.port
2021-10-05 13:25:39,385 [Listener at 127.0.0.1/13296] WARN  scm.ScmUtils (ScmUtils.java:logWarn(179)) - ConfigKey ozone.scm.datanode.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.datanode.port appended with serviceId and nodeId. If want to configure same port configure ozone.scm.datanode.port
2021-10-05 13:25:39,385 [Listener at 127.0.0.1/13296] INFO  ha.SCMHANodeDetails (SCMHANodeDetails.java:loadSCMHAConfig(250)) - Found matching SCM address with SCMServiceId: scm-service-test1, SCMNodeId: scmNode-1, RPC Address: localhost:12120 and Ratis port: 12120
2021-10-05 13:25:39,386 [Listener at 127.0.0.1/13296] INFO  ha.SCMHANodeDetails (ConfUtils.java:setNodeSpecificConfigs(108)) - Setting configuration key ozone.scm.datanode.address with value of key ozone.scm.datanode.address.scm-service-test1.scmNode-1: 127.0.0.1:12121
2021-10-05 13:25:39,386 [Listener at 127.0.0.1/13296] INFO  ha.SCMHANodeDetails (ConfUtils.java:setNodeSpecificConfigs(108)) - Setting configuration key ozone.scm.block.client.address with value of key ozone.scm.block.client.address.scm-service-test1.scmNode-1: 127.0.0.1:12122
2021-10-05 13:25:39,386 [Listener at 127.0.0.1/13296] INFO  ha.SCMHANodeDetails (ConfUtils.java:setNodeSpecificConfigs(108)) - Setting configuration key ozone.scm.client.address with value of key ozone.scm.client.address.scm-service-test1.scmNode-1: 127.0.0.1:12123
2021-10-05 13:25:39,386 [Listener at 127.0.0.1/13296] INFO  ha.SCMHANodeDetails (ConfUtils.java:setNodeSpecificConfigs(108)) - Setting configuration key ozone.scm.ratis.port with value of key ozone.scm.ratis.port.scm-service-test1.scmNode-1: 12120
2021-10-05 13:25:39,386 [Listener at 127.0.0.1/13296] INFO  ha.SCMHANodeDetails (ConfUtils.java:setNodeSpecificConfigs(108)) - Setting configuration key ozone.scm.grpc.port with value of key ozone.scm.grpc.port.scm-service-test1.scmNode-1: 12124
2021-10-05 13:25:39,386 [Listener at 127.0.0.1/13296] INFO  ha.SCMHANodeDetails (ConfUtils.java:setNodeSpecificConfigs(108)) - Setting configuration key ozone.scm.http-address with value of key ozone.scm.http-address.scm-service-test1.scmNode-1: 127.0.0.1:12118
2021-10-05 13:25:39,386 [Listener at 127.0.0.1/13296] INFO  ha.SCMHANodeDetails (ConfUtils.java:setNodeSpecificConfigs(108)) - Setting configuration key ozone.scm.https-address with value of key ozone.scm.https-address.scm-service-test1.scmNode-1: 127.0.0.1:12119
2021-10-05 13:25:39,386 [Listener at 127.0.0.1/13296] INFO  ha.SCMHANodeDetails (ConfUtils.java:setNodeSpecificConfigs(108)) - Setting configuration key ozone.scm.address with value of key ozone.scm.address.scm-service-test1.scmNode-1: 127.0.0.1
2021-10-05 13:25:39,387 [Listener at 127.0.0.1/13296] WARN  scm.ScmUtils (ScmUtils.java:logWarn(179)) - ConfigKey ozone.scm.block.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.block.client.port appended with serviceId and nodeId. If want to configure same port configure ozone.scm.block.client.port
2021-10-05 13:25:39,387 [Listener at 127.0.0.1/13296] WARN  scm.ScmUtils (ScmUtils.java:logWarn(179)) - ConfigKey ozone.scm.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.client.port appended with serviceId and nodeId. If want to configure same port configure ozone.scm.client.port
2021-10-05 13:25:39,387 [Listener at 127.0.0.1/13296] WARN  scm.ScmUtils (ScmUtils.java:logWarn(179)) - ConfigKey ozone.scm.datanode.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.datanode.port appended with serviceId and nodeId. If want to configure same port configure ozone.scm.datanode.port
2021-10-05 13:25:39,387 [Listener at 127.0.0.1/13296] WARN  server.ServerUtils (ServerUtils.java:getScmDbDir(148)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2021-10-05 13:25:39,387 [Listener at 127.0.0.1/13296] INFO  upgrade.AbstractLayoutVersionManager (AbstractLayoutVersionManager.java:init(79)) - Initializing Layout version manager with metadata layout = SCM_HA (version = 2), software layout = SCM_HA (version = 2)
2021-10-05 13:25:39,455 [Listener at 127.0.0.1/13296] INFO  reflections.Reflections (Reflections.java:scan(232)) - Reflections took 66 ms to scan 7 urls, producing 119 keys and 275 values 
2021-10-05 13:25:39,457 [Listener at 127.0.0.1/13296] WARN  utils.HAUtils (HAUtils.java:getMetaDir(342)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2021-10-05 13:25:39,458 [Listener at 127.0.0.1/13296] WARN  db.DBStoreBuilder (DBStoreBuilder.java:applyDBDefinition(145)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2021-10-05 13:25:39,619 [Listener at 127.0.0.1/13296] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchemaFromFile(129)) - Loading schema from [jar:file:/home/runner/.m2/repository/org/apache/ozone/hdds-common/1.2.0-SNAPSHOT/hdds-common-1.2.0-SNAPSHOT.jar!/network-topology-default.xml]
2021-10-05 13:25:39,620 [Listener at 127.0.0.1/13296] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchema(176)) - Loading network topology layer schema file
2021-10-05 13:25:39,628 [Listener at 127.0.0.1/13296] INFO  ha.SCMRatisServerImpl (SCMRatisServerImpl.java:<init>(87)) - starting Raft server for scm:61371ea4-f7c9-4e51-8ebe-bd324b8103e3
2021-10-05 13:25:39,629 [Listener at 127.0.0.1/13296] INFO  server.RaftServer (ConfUtils.java:logGet(44)) - raft.rpc.type = GRPC (default)
2021-10-05 13:25:39,629 [Listener at 127.0.0.1/13296] INFO  grpc.GrpcFactory (GrpcFactory.java:checkPooledByteBufAllocatorUseCacheForAllThreads(48)) - PERFORMANCE WARNING: useCacheForAllThreads is true that may cause Netty to create a lot garbage objects and, as a result, trigger GC.
	It is recommended to disable useCacheForAllThreads by setting -Dorg.apache.ratis.thirdparty.io.netty.allocator.useCacheForAllThreads=false in command line.
2021-10-05 13:25:39,629 [Listener at 127.0.0.1/13296] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(44)) - raft.grpc.admin.port = -1 (default)
2021-10-05 13:25:39,630 [Listener at 127.0.0.1/13296] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(44)) - raft.grpc.server.port = 12120 (custom)
2021-10-05 13:25:39,630 [Listener at 127.0.0.1/13296] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(44)) - raft.grpc.client.port = -1 (default)
2021-10-05 13:25:39,630 [Listener at 127.0.0.1/13296] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(44)) - raft.grpc.server.port = 12120 (custom)
2021-10-05 13:25:39,630 [Listener at 127.0.0.1/13296] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(44)) - raft.grpc.server.port = 12120 (custom)
2021-10-05 13:25:39,630 [Listener at 127.0.0.1/13296] INFO  server.GrpcService (ConfUtils.java:logGet(44)) - raft.grpc.message.size.max = 32m (=33554432) (custom)
2021-10-05 13:25:39,630 [Listener at 127.0.0.1/13296] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2021-10-05 13:25:39,630 [Listener at 127.0.0.1/13296] INFO  server.GrpcService (ConfUtils.java:logGet(44)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2021-10-05 13:25:39,631 [Listener at 127.0.0.1/13296] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.request.timeout = 30000ms (custom)
2021-10-05 13:25:39,632 [Listener at 127.0.0.1/13296] INFO  impl.DataStreamServerImpl (ConfUtils.java:logGet(44)) - raft.datastream.type = DISABLED (default)
2021-10-05 13:25:39,635 [Listener at 127.0.0.1/13296] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.slowness.timeout = 120000ms (custom)
2021-10-05 13:25:39,635 [Listener at 127.0.0.1/13296] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.leaderelection.leader.step-down.wait-time = 10s (default)
2021-10-05 13:25:39,635 [Listener at 127.0.0.1/13296] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.storage.dir = [/home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-62d231c0-d845-4dcd-88aa-c082e017c57e/scmNode-1/scm-ha] (custom)
2021-10-05 13:25:39,636 [Listener at 127.0.0.1/13296] INFO  server.RaftServer (RaftServerProxy.java:lambda$null$1(235)) - 61371ea4-f7c9-4e51-8ebe-bd324b8103e3: found a subdirectory /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-62d231c0-d845-4dcd-88aa-c082e017c57e/scmNode-1/scm-ha/62d231c0-d845-4dcd-88aa-c082e017c57e
2021-10-05 13:25:39,646 [Listener at 127.0.0.1/13296] INFO  server.RaftServer (RaftServerProxy.java:addNew(95)) - 61371ea4-f7c9-4e51-8ebe-bd324b8103e3: addNew group-C082E017C57E:[] returns group-C082E017C57E:java.util.concurrent.CompletableFuture@3c1aede3[Not completed]
2021-10-05 13:25:39,646 [pool-358-thread-1] INFO  server.RaftServer$Division (RaftServerImpl.java:<init>(181)) - 61371ea4-f7c9-4e51-8ebe-bd324b8103e3: new RaftServerImpl for group-C082E017C57E:[] with SCMStateMachine:uninitialized
2021-10-05 13:25:39,658 [pool-358-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.timeout.min = 5000ms (custom)
2021-10-05 13:25:39,659 [pool-358-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.timeout.max = 5200ms (custom)
2021-10-05 13:25:39,659 [pool-358-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.sleep.time = 25ms (default)
2021-10-05 13:25:39,659 [pool-358-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.slowness.timeout = 120000ms (custom)
2021-10-05 13:25:39,659 [pool-358-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.leaderelection.leader.step-down.wait-time = 10s (default)
2021-10-05 13:25:39,659 [pool-358-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.sleep.deviation.threshold = 300ms (default)
2021-10-05 13:25:39,659 [pool-358-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.appender.install.snapshot.enabled = false (custom)
2021-10-05 13:25:39,659 [pool-358-thread-1] INFO  server.RaftServer$Division (ServerState.java:<init>(105)) - 61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E: ConfigurationManager, init=-1: [], old=null, confs=<EMPTY_MAP>
2021-10-05 13:25:39,659 [pool-358-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.storage.dir = [/home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-62d231c0-d845-4dcd-88aa-c082e017c57e/scmNode-1/scm-ha] (custom)
2021-10-05 13:25:39,659 [pool-358-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.corruption.policy = EXCEPTION (default)
2021-10-05 13:25:39,659 [pool-358-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.storage.free-space.min = 0MB (=0) (default)
2021-10-05 13:25:39,667 [pool-358-thread-1] INFO  storage.RaftStorageDirectory (RaftStorageDirectoryImpl.java:tryLock(230)) - Lock on /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-62d231c0-d845-4dcd-88aa-c082e017c57e/scmNode-1/scm-ha/62d231c0-d845-4dcd-88aa-c082e017c57e/in_use.lock acquired by nodename 17451@fv-az270-324
2021-10-05 13:25:39,668 [pool-358-thread-1] INFO  storage.RaftStorage (RaftStorageImpl.java:analyzeAndRecoverStorage(110)) - Read RaftStorageMetadata{term=1, votedFor=61371ea4-f7c9-4e51-8ebe-bd324b8103e3} from /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-62d231c0-d845-4dcd-88aa-c082e017c57e/scmNode-1/scm-ha/62d231c0-d845-4dcd-88aa-c082e017c57e/current/raft-meta
2021-10-05 13:25:39,668 [pool-358-thread-1] INFO  server.RaftServer$Division (ServerState.java:setRaftConf(387)) - 61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E: set configuration 0: [61371ea4-f7c9-4e51-8ebe-bd324b8103e3|rpc:localhost:12120|admin:|client:|dataStream:|priority:0], old=null
2021-10-05 13:25:39,668 [pool-358-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.notification.no-leader.timeout = 60s (default)
2021-10-05 13:25:39,668 [pool-358-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.use.memory = false (default)
2021-10-05 13:25:39,668 [pool-358-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.purge.gap = 5 (custom)
2021-10-05 13:25:39,668 [pool-358-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2021-10-05 13:25:39,668 [pool-358-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.segment.size.max = 16384 (custom)
2021-10-05 13:25:39,669 [pool-358-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.segment.cache.num.max = 2 (custom)
2021-10-05 13:25:39,669 [pool-358-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.segment.cache.size.max = 200MB (=209715200) (default)
2021-10-05 13:25:39,669 [pool-358-thread-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:<init>(182)) - new 61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-SegmentedRaftLogWorker for RaftStorageImpl:Storage Directory /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-62d231c0-d845-4dcd-88aa-c082e017c57e/scmNode-1/scm-ha/62d231c0-d845-4dcd-88aa-c082e017c57e
2021-10-05 13:25:39,669 [pool-358-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.queue.byte-limit = 64MB (=67108864) (default)
2021-10-05 13:25:39,669 [pool-358-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.queue.element-limit = 4096 (default)
2021-10-05 13:25:39,669 [pool-358-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.segment.size.max = 16384 (custom)
2021-10-05 13:25:39,669 [pool-358-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.preallocated.size = 16384 (custom)
2021-10-05 13:25:39,669 [pool-358-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.force.sync.num = 128 (default)
2021-10-05 13:25:39,669 [pool-358-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.statemachine.data.sync = true (default)
2021-10-05 13:25:39,669 [pool-358-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2021-10-05 13:25:39,669 [pool-358-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2021-10-05 13:25:39,669 [pool-358-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.write.buffer.size = 64KB (=65536) (default)
2021-10-05 13:25:39,669 [pool-358-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.statemachine.data.caching.enabled = false (default)
2021-10-05 13:25:39,670 [pool-358-thread-1] INFO  server.RaftServer$Division (ServerState.java:setRaftConf(387)) - 61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E: set configuration 0: [61371ea4-f7c9-4e51-8ebe-bd324b8103e3|rpc:localhost:12120|admin:|client:|dataStream:|priority:0], old=null
2021-10-05 13:25:39,670 [pool-358-thread-1] INFO  segmented.LogSegment (LogSegment.java:loadSegment(173)) - Successfully read 1 entries from segment file /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-62d231c0-d845-4dcd-88aa-c082e017c57e/scmNode-1/scm-ha/62d231c0-d845-4dcd-88aa-c082e017c57e/current/log_inprogress_0
2021-10-05 13:25:39,683 [pool-358-thread-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:lambda$new$0(133)) - 61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-SegmentedRaftLogWorker: flushIndex: setUnconditionally 0 -> 0
2021-10-05 13:25:39,683 [pool-358-thread-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:lambda$new$0(133)) - 61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-SegmentedRaftLogWorker: safeCacheEvictIndex: setUnconditionally 0 -> -1
2021-10-05 13:25:39,689 [pool-358-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2021-10-05 13:25:39,689 [pool-358-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.snapshot.auto.trigger.threshold = 5 (custom)
2021-10-05 13:25:39,689 [pool-358-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.snapshot.retention.file.num = -1 (default)
2021-10-05 13:25:39,689 [pool-358-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.purge.upto.snapshot.index = true (custom)
2021-10-05 13:25:39,689 [pool-358-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.retrycache.expirytime = 60000ms (default)
2021-10-05 13:25:39,689 [pool-358-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.retrycache.statistics.expirytime = 100μs (default)
2021-10-05 13:25:39,690 [Listener at 127.0.0.1/13296] INFO  ha.SCMSnapshotProvider (SCMSnapshotProvider.java:<init>(66)) - Initializing SCM Snapshot Provider
2021-10-05 13:25:39,690 [Listener at 127.0.0.1/13296] WARN  server.ServerUtils (ServerUtils.java:getDefaultRatisDirectory(237)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2021-10-05 13:25:39,690 [Listener at 127.0.0.1/13296] WARN  ha.SCMHAUtils (SCMHAUtils.java:getSCMRatisSnapshotDirectory(146)) - SCM snapshot dir is not configured. Falling back to ozone.metadata.dirs config
2021-10-05 13:25:39,692 [Listener at 127.0.0.1/13296] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:upgradeToSequenceId(347)) - upgrade localId to 107544261427200000
2021-10-05 13:25:39,692 [Listener at 127.0.0.1/13296] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:upgradeToSequenceId(357)) - upgrade delTxnId to 0
2021-10-05 13:25:39,693 [Listener at 127.0.0.1/13296] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:upgradeToSequenceId(371)) - upgrade containerId to 0
2021-10-05 13:25:39,693 [Listener at 127.0.0.1/13296] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:<init>(218)) - Init the HA SequenceIdGenerator.
2021-10-05 13:25:39,700 [Listener at 127.0.0.1/13296] INFO  node.SCMNodeManager (SCMNodeManager.java:<init>(144)) - Entering startup safe mode.
2021-10-05 13:25:39,701 [Listener at 127.0.0.1/13296] INFO  algorithms.ContainerPlacementPolicyFactory (ContainerPlacementPolicyFactory.java:getPolicy(60)) - Create container placement policy of type org.apache.hadoop.hdds.scm.container.placement.algorithms.SCMContainerPlacementRandom
2021-10-05 13:25:39,701 [Listener at 127.0.0.1/13296] INFO  pipeline.PipelineStateManagerImpl (PipelineStateManagerImpl.java:initialize(78)) - No pipeline exists in current db
2021-10-05 13:25:39,702 [Listener at 127.0.0.1/13296] INFO  algorithms.LeaderChoosePolicyFactory (LeaderChoosePolicyFactory.java:getPolicy(57)) - Create leader choose policy of type org.apache.hadoop.hdds.scm.pipeline.leader.choose.algorithms.MinLeaderCountChoosePolicy
2021-10-05 13:25:39,702 [Listener at 127.0.0.1/13296] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(43)) - Registering service BackgroundPipelineCreator.
2021-10-05 13:25:39,702 [Listener at 127.0.0.1/13296] INFO  pipeline.BackgroundPipelineCreator (BackgroundPipelineCreatorV2.java:start(130)) - Starting RatisPipelineUtilsThread.
2021-10-05 13:25:39,719 [Listener at 127.0.0.1/13296] INFO  algorithms.PipelineChoosePolicyFactory (PipelineChoosePolicyFactory.java:createPipelineChoosePolicyFromClass(73)) - Create pipeline choose policy of type org.apache.hadoop.hdds.scm.pipeline.choose.algorithms.RandomPipelineChoosePolicy
2021-10-05 13:25:39,720 [Listener at 127.0.0.1/13296] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(43)) - Registering service SCMBlockDeletingService.
2021-10-05 13:25:39,720 [Listener at 127.0.0.1/13296] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(43)) - Registering service ReplicationManager.
2021-10-05 13:25:39,720 [Listener at 127.0.0.1/13296] INFO  container.ReplicationManager (ReplicationManager.java:start(319)) - Starting Replication Monitor Thread.
2021-10-05 13:25:39,721 [Listener at 127.0.0.1/13296] INFO  safemode.ContainerSafeModeRule (ContainerSafeModeRule.java:<init>(89)) - containers with one replica threshold count 0
2021-10-05 13:25:39,721 [Listener at 127.0.0.1/13296] INFO  safemode.HealthyPipelineSafeModeRule (HealthyPipelineSafeModeRule.java:initializeRule(156)) - Total pipeline count is 0, healthy pipeline threshold count is 1
2021-10-05 13:25:39,722 [Listener at 127.0.0.1/13296] INFO  safemode.OneReplicaPipelineSafeModeRule (OneReplicaPipelineSafeModeRule.java:initializeRule(180)) - Total pipeline count is 0, pipeline's with at least one datanode reported threshold count is 0
2021-10-05 13:25:39,735 [ReplicationMonitor] INFO  container.ReplicationManager (ReplicationManager.java:processAll(371)) - Replication Monitor Thread took 0 milliseconds for processing 0 containers.
2021-10-05 13:25:39,737 [Listener at 127.0.0.1/13296] INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(90)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 10000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false.
2021-10-05 13:25:39,747 [Socket Reader #1 for port 12121] INFO  ipc.Server (Server.java:run(1265)) - Starting Socket Reader #1 for port 12121
2021-10-05 13:25:39,748 [Listener at 0.0.0.0/12121] INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(90)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 10000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false.
2021-10-05 13:25:39,756 [Socket Reader #1 for port 12122] INFO  ipc.Server (Server.java:run(1265)) - Starting Socket Reader #1 for port 12122
2021-10-05 13:25:39,756 [Listener at 0.0.0.0/12122] INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(90)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 10000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false.
2021-10-05 13:25:39,771 [EndpointStateMachine task thread for /127.0.0.1:15041 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15041. Already tried 1 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:39,779 [Socket Reader #1 for port 12123] INFO  ipc.Server (Server.java:run(1265)) - Starting Socket Reader #1 for port 12123
2021-10-05 13:25:39,799 [EndpointStateMachine task thread for /127.0.0.1:13529 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:13529. Already tried 7 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:39,799 [EndpointStateMachine task thread for /127.0.0.1:13549 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:13549. Already tried 7 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:39,834 [EndpointStateMachine task thread for /127.0.0.1:15031 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15031. Already tried 5 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:39,844 [EndpointStateMachine task thread for /127.0.0.1:15021 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15021. Already tried 5 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:39,849 [Listener at 0.0.0.0/12123] INFO  algorithms.ContainerPlacementPolicyFactory (ContainerPlacementPolicyFactory.java:getPolicy(60)) - Create container placement policy of type org.apache.hadoop.hdds.scm.container.placement.algorithms.SCMContainerPlacementRandom
2021-10-05 13:25:39,857 [Listener at 0.0.0.0/12123] INFO  server.StorageContainerManager (StorageContainerManager.java:<init>(388)) - 
Container Balancer status:
Key                            Value
Running                        false
Container Balancer Configuration values:
Key                                                Value
Threshold                                          0.1
Max Datanodes to Involve per Iteration(ratio)      0.2
Max Size to Move per Iteration                     32212254720B

2021-10-05 13:25:39,857 [Listener at 0.0.0.0/12123] WARN  events.EventQueue (EventQueue.java:fireEvent(194)) - No event handler registered for event TypedEvent{payloadType=SafeModeStatus, name='Safe mode status'}
2021-10-05 13:25:39,857 [Listener at 0.0.0.0/12123] INFO  ha.SCMContext (SCMContext.java:updateSafeModeStatus(205)) - Update SafeModeStatus from SafeModeStatus{safeModeStatus=true, preCheckPassed=false} to SafeModeStatus{safeModeStatus=true, preCheckPassed=false}.
2021-10-05 13:25:39,858 [Listener at 0.0.0.0/12123] INFO  server.StorageContainerManager (StorageContainerManager.java:start(1303)) - StorageContainerLocationProtocol RPC server is listening at /0.0.0.0:12123
2021-10-05 13:25:39,858 [Listener at 0.0.0.0/12123] INFO  ha.SCMRatisServerImpl (SCMRatisServerImpl.java:start(177)) - starting ratis server 0.0.0.0:12120
2021-10-05 13:25:39,858 [Listener at 0.0.0.0/12123] INFO  server.RaftServer$Division (RaftServerImpl.java:start(296)) - 61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E: start as a follower, conf=0: [61371ea4-f7c9-4e51-8ebe-bd324b8103e3|rpc:localhost:12120|admin:|client:|dataStream:|priority:0], old=null
2021-10-05 13:25:39,859 [Listener at 0.0.0.0/12123] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(285)) - 61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E: changes role from      null to FOLLOWER at term 1 for startAsFollower
2021-10-05 13:25:39,859 [Listener at 0.0.0.0/12123] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(130)) - 61371ea4-f7c9-4e51-8ebe-bd324b8103e3: start 61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-FollowerState
2021-10-05 13:25:39,875 [Listener at 0.0.0.0/12123] INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-C082E017C57E,id=61371ea4-f7c9-4e51-8ebe-bd324b8103e3
2021-10-05 13:25:39,876 [Listener at 0.0.0.0/12123] INFO  server.RaftServer (RaftServerProxy.java:lambda$start$5(374)) - 61371ea4-f7c9-4e51-8ebe-bd324b8103e3: start RPC server
2021-10-05 13:25:39,877 [Listener at 0.0.0.0/12123] INFO  server.GrpcService (GrpcService.java:startImpl(253)) - 61371ea4-f7c9-4e51-8ebe-bd324b8103e3: GrpcService started, listening on 12120
2021-10-05 13:25:39,890 [Listener at 0.0.0.0/12123] INFO  ha.SCMHAManagerImpl (SCMHAManagerImpl.java:start(120)) -  scm role is FOLLOWER peers [61371ea4-f7c9-4e51-8ebe-bd324b8103e3|rpc:localhost:12120|admin:|client:|dataStream:|priority:0]
2021-10-05 13:25:39,890 [Listener at 0.0.0.0/12123] INFO  ha.InterSCMGrpcService (InterSCMGrpcProtocolService.java:start(94)) - Starting SCM Grpc Service at port 12124
2021-10-05 13:25:39,892 [Listener at 0.0.0.0/12123] WARN  impl.MetricsConfig (MetricsConfig.java:loadFirst(136)) - Cannot locate configuration: tried hadoop-metrics2-storagecontainermanager.properties,hadoop-metrics2.properties
2021-10-05 13:25:39,894 [org.apache.ratis.util.JvmPauseMonitor$$Lambda$499/1586779822@1abf7c9d] INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(103)) - JvmPauseMonitor-61371ea4-f7c9-4e51-8ebe-bd324b8103e3: Started
2021-10-05 13:25:39,899 [Listener at 0.0.0.0/12123] INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:startTimer(378)) - Scheduled Metric snapshot period at 10 second(s).
2021-10-05 13:25:39,899 [Listener at 0.0.0.0/12123] INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:start(191)) - StorageContainerManager metrics system started
2021-10-05 13:25:39,902 [Listener at 0.0.0.0/12123] INFO  impl.MetricsSinkAdapter (MetricsSinkAdapter.java:start(204)) - Sink prometheus started
2021-10-05 13:25:39,903 [Listener at 0.0.0.0/12123] INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:registerSink(305)) - Registered sink prometheus
2021-10-05 13:25:39,939 [Listener at 0.0.0.0/12123] INFO  server.SCMClientProtocolServer (SCMClientProtocolServer.java:start(164)) - RPC server for Client  is listening at /0.0.0.0:12123
2021-10-05 13:25:39,946 [IPC Server Responder] INFO  ipc.Server (Server.java:run(1507)) - IPC Server Responder: starting
2021-10-05 13:25:39,955 [EndpointStateMachine task thread for /127.0.0.1:13539 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:13539. Already tried 6 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:39,958 [IPC Server listener on 12123] INFO  ipc.Server (Server.java:run(1344)) - IPC Server listener on 12123: starting
2021-10-05 13:25:40,015 [Listener at 0.0.0.0/12123] INFO  server.StorageContainerManager (StorageContainerManager.java:start(1318)) - ScmBlockLocationProtocol RPC server is listening at /0.0.0.0:12122
2021-10-05 13:25:40,016 [Listener at 0.0.0.0/12123] INFO  server.SCMBlockProtocolServer (SCMBlockProtocolServer.java:start(151)) - RPC server for Block Protocol is listening at /0.0.0.0:12122
2021-10-05 13:25:40,018 [IPC Server Responder] INFO  ipc.Server (Server.java:run(1507)) - IPC Server Responder: starting
2021-10-05 13:25:40,024 [IPC Server listener on 12122] INFO  ipc.Server (Server.java:run(1344)) - IPC Server listener on 12122: starting
2021-10-05 13:25:40,032 [Listener at 0.0.0.0/12123] INFO  server.StorageContainerManager (StorageContainerManager.java:start(1324)) - ScmDatanodeProtocl RPC server is listening at /0.0.0.0:12121
2021-10-05 13:25:40,033 [Listener at 0.0.0.0/12123] INFO  http.BaseHttpServer (BaseHttpServer.java:newHttpServer2BuilderForOzone(209)) - Starting Web-server for scm at: http://0.0.0.0:12118
2021-10-05 13:25:40,034 [Listener at 0.0.0.0/12123] INFO  http.BaseHttpServer (BaseHttpServer.java:<init>(107)) - Hadoop Security Enabled: false Ozone Security Enabled: false Ozone HTTP Security Enabled: false 
2021-10-05 13:25:40,035 [Listener at 0.0.0.0/12123] INFO  server.AuthenticationFilter (AuthenticationFilter.java:constructSecretProvider(240)) - Unable to initialize FileSignerSecretProvider, falling back to use random secrets.
2021-10-05 13:25:40,035 [Listener at 0.0.0.0/12123] WARN  http.HttpRequestLog (HttpRequestLog.java:getRequestLog(103)) - Jetty request log can only be enabled using Log4j
2021-10-05 13:25:40,056 [org.apache.hadoop.util.JvmPauseMonitor$Monitor@5ea7ad41] INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(188)) - Starting JVM pause monitor
2021-10-05 13:25:40,060 [Listener at 0.0.0.0/12123] INFO  http.HttpServer2 (HttpServer2.java:addGlobalFilter(1030)) - Added global filter 'safety' (class=org.apache.hadoop.hdds.server.http.HttpServer2$QuotingInputFilter)
2021-10-05 13:25:40,061 [Listener at 0.0.0.0/12123] INFO  http.HttpServer2 (HttpServer2.java:addFilter(1006)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context scm
2021-10-05 13:25:40,061 [Listener at 0.0.0.0/12123] INFO  http.HttpServer2 (HttpServer2.java:addFilter(1014)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context logs
2021-10-05 13:25:40,061 [Listener at 0.0.0.0/12123] INFO  http.HttpServer2 (HttpServer2.java:addFilter(1014)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context static
2021-10-05 13:25:40,062 [Listener at 0.0.0.0/12123] INFO  http.HttpServer2 (HttpServer2.java:bindListener(1249)) - Jetty bound to port 12118
2021-10-05 13:25:40,062 [Listener at 0.0.0.0/12123] INFO  server.Server (Server.java:doStart(375)) - jetty-9.4.43.v20210629; built: 2021-06-30T11:07:22.254Z; git: 526006ecfa3af7f1a27ef3a288e2bef7ea9dd7e8; jvm 1.8.0_292-b10
2021-10-05 13:25:40,092 [Listener at 0.0.0.0/12123] INFO  server.session (DefaultSessionIdManager.java:doStart(334)) - DefaultSessionIdManager workerName=node0
2021-10-05 13:25:40,092 [Listener at 0.0.0.0/12123] INFO  server.session (DefaultSessionIdManager.java:doStart(339)) - No SessionScavenger set, using defaults
2021-10-05 13:25:40,092 [Listener at 0.0.0.0/12123] INFO  server.session (HouseKeeper.java:startScavenging(132)) - node0 Scavenging every 660000ms
2021-10-05 13:25:40,093 [Listener at 0.0.0.0/12123] INFO  handler.ContextHandler (ContextHandler.java:doStart(915)) - Started o.e.j.s.ServletContextHandler@4770430{logs,/logs,file:///home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/log,AVAILABLE}
2021-10-05 13:25:40,093 [Listener at 0.0.0.0/12123] INFO  handler.ContextHandler (ContextHandler.java:doStart(915)) - Started o.e.j.s.ServletContextHandler@45d9fe80{static,/static,file:///home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-classes/webapps/static,AVAILABLE}
2021-10-05 13:25:40,111 [Listener at 0.0.0.0/12123] INFO  handler.ContextHandler (ContextHandler.java:doStart(915)) - Started o.e.j.w.WebAppContext@151f0053{scm,/,file:///home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-classes/webapps/scm/,AVAILABLE}{file:/home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-classes/webapps/scm}
2021-10-05 13:25:40,123 [Listener at 0.0.0.0/12123] INFO  server.AbstractConnector (AbstractConnector.java:doStart(331)) - Started ServerConnector@535b24b5{HTTP/1.1, (http/1.1)}{0.0.0.0:12118}
2021-10-05 13:25:40,124 [Listener at 0.0.0.0/12123] INFO  server.Server (Server.java:doStart(415)) - Started @133783ms
2021-10-05 13:25:40,124 [Listener at 0.0.0.0/12123] WARN  impl.MetricsSystemImpl (MetricsSystemImpl.java:register(279)) - Sink prometheus already exists!
2021-10-05 13:25:40,144 [Listener at 0.0.0.0/12123] INFO  http.BaseHttpServer (BaseHttpServer.java:updateConnectorAddress(329)) - HTTP server of scm listening at http://0.0.0.0:12118
2021-10-05 13:25:40,144 [Listener at 0.0.0.0/12123] INFO  ozone.MiniOzoneHAClusterImpl (MiniOzoneHAClusterImpl.java:createSCMService(564)) - Started SCM RPC server at org.apache.hadoop.hdds.scm.server.SCMClientProtocolServer@2076a6af
2021-10-05 13:25:40,144 [Listener at 0.0.0.0/12123] INFO  ha.SCMHANodeDetails (SCMHANodeDetails.java:loadSCMHAConfig(157)) - ServiceID for StorageContainerManager is scm-service-test1
2021-10-05 13:25:40,144 [Listener at 0.0.0.0/12123] INFO  ha.SCMHANodeDetails (SCMHANodeDetails.java:loadSCMHAConfig(168)) - ServiceID for StorageContainerManager is scm-service-test1
2021-10-05 13:25:40,144 [Listener at 0.0.0.0/12123] WARN  scm.ScmUtils (ScmUtils.java:logWarn(179)) - ConfigKey ozone.scm.block.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.block.client.port appended with serviceId and nodeId. If want to configure same port configure ozone.scm.block.client.port
2021-10-05 13:25:40,145 [Listener at 0.0.0.0/12123] WARN  scm.ScmUtils (ScmUtils.java:logWarn(179)) - ConfigKey ozone.scm.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.client.port appended with serviceId and nodeId. If want to configure same port configure ozone.scm.client.port
2021-10-05 13:25:40,145 [Listener at 0.0.0.0/12123] WARN  scm.ScmUtils (ScmUtils.java:logWarn(179)) - ConfigKey ozone.scm.datanode.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.datanode.port appended with serviceId and nodeId. If want to configure same port configure ozone.scm.datanode.port
2021-10-05 13:25:40,145 [Listener at 0.0.0.0/12123] WARN  scm.ScmUtils (ScmUtils.java:logWarn(179)) - ConfigKey ozone.scm.block.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.block.client.port appended with serviceId and nodeId. If want to configure same port configure ozone.scm.block.client.port
2021-10-05 13:25:40,145 [Listener at 0.0.0.0/12123] WARN  scm.ScmUtils (ScmUtils.java:logWarn(179)) - ConfigKey ozone.scm.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.client.port appended with serviceId and nodeId. If want to configure same port configure ozone.scm.client.port
2021-10-05 13:25:40,145 [Listener at 0.0.0.0/12123] WARN  scm.ScmUtils (ScmUtils.java:logWarn(179)) - ConfigKey ozone.scm.datanode.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.datanode.port appended with serviceId and nodeId. If want to configure same port configure ozone.scm.datanode.port
2021-10-05 13:25:40,146 [Listener at 0.0.0.0/12123] INFO  ha.SCMHANodeDetails (SCMHANodeDetails.java:loadSCMHAConfig(250)) - Found matching SCM address with SCMServiceId: scm-service-test1, SCMNodeId: scmNode-2, RPC Address: localhost:12130 and Ratis port: 12130
2021-10-05 13:25:40,154 [Listener at 0.0.0.0/12123] INFO  ha.SCMHANodeDetails (ConfUtils.java:setNodeSpecificConfigs(108)) - Setting configuration key ozone.scm.datanode.address with value of key ozone.scm.datanode.address.scm-service-test1.scmNode-2: 127.0.0.1:12131
2021-10-05 13:25:40,154 [Listener at 0.0.0.0/12123] INFO  ha.SCMHANodeDetails (ConfUtils.java:setNodeSpecificConfigs(108)) - Setting configuration key ozone.scm.block.client.address with value of key ozone.scm.block.client.address.scm-service-test1.scmNode-2: 127.0.0.1:12132
2021-10-05 13:25:40,154 [Listener at 0.0.0.0/12123] INFO  ha.SCMHANodeDetails (ConfUtils.java:setNodeSpecificConfigs(108)) - Setting configuration key ozone.scm.client.address with value of key ozone.scm.client.address.scm-service-test1.scmNode-2: 127.0.0.1:12133
2021-10-05 13:25:40,154 [Listener at 0.0.0.0/12123] INFO  ha.SCMHANodeDetails (ConfUtils.java:setNodeSpecificConfigs(108)) - Setting configuration key ozone.scm.ratis.port with value of key ozone.scm.ratis.port.scm-service-test1.scmNode-2: 12130
2021-10-05 13:25:40,154 [Listener at 0.0.0.0/12123] INFO  ha.SCMHANodeDetails (ConfUtils.java:setNodeSpecificConfigs(108)) - Setting configuration key ozone.scm.grpc.port with value of key ozone.scm.grpc.port.scm-service-test1.scmNode-2: 12134
2021-10-05 13:25:40,154 [Listener at 0.0.0.0/12123] INFO  ha.SCMHANodeDetails (ConfUtils.java:setNodeSpecificConfigs(108)) - Setting configuration key ozone.scm.http-address with value of key ozone.scm.http-address.scm-service-test1.scmNode-2: 127.0.0.1:12128
2021-10-05 13:25:40,154 [Listener at 0.0.0.0/12123] INFO  ha.SCMHANodeDetails (ConfUtils.java:setNodeSpecificConfigs(108)) - Setting configuration key ozone.scm.https-address with value of key ozone.scm.https-address.scm-service-test1.scmNode-2: 127.0.0.1:12129
2021-10-05 13:25:40,154 [Listener at 0.0.0.0/12123] INFO  ha.SCMHANodeDetails (ConfUtils.java:setNodeSpecificConfigs(108)) - Setting configuration key ozone.scm.address with value of key ozone.scm.address.scm-service-test1.scmNode-2: 127.0.0.1
2021-10-05 13:25:40,155 [Listener at 0.0.0.0/12123] WARN  scm.ScmUtils (ScmUtils.java:logWarn(179)) - ConfigKey ozone.scm.block.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.block.client.port appended with serviceId and nodeId. If want to configure same port configure ozone.scm.block.client.port
2021-10-05 13:25:40,155 [Listener at 0.0.0.0/12123] WARN  scm.ScmUtils (ScmUtils.java:logWarn(179)) - ConfigKey ozone.scm.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.client.port appended with serviceId and nodeId. If want to configure same port configure ozone.scm.client.port
2021-10-05 13:25:40,155 [Listener at 0.0.0.0/12123] WARN  scm.ScmUtils (ScmUtils.java:logWarn(179)) - ConfigKey ozone.scm.datanode.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.datanode.port appended with serviceId and nodeId. If want to configure same port configure ozone.scm.datanode.port
2021-10-05 13:25:40,155 [Listener at 0.0.0.0/12123] WARN  server.ServerUtils (ServerUtils.java:getScmDbDir(148)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2021-10-05 13:25:40,180 [Listener at 0.0.0.0/12123] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.client.port appended with serviceId and nodeId
2021-10-05 13:25:40,180 [Listener at 0.0.0.0/12123] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.block.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.block.client.port appended with serviceId and nodeId
2021-10-05 13:25:40,180 [Listener at 0.0.0.0/12123] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.datanode.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.datanode.port appended with serviceId and nodeId
2021-10-05 13:25:40,180 [Listener at 0.0.0.0/12123] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.client.port appended with serviceId and nodeId
2021-10-05 13:25:40,180 [Listener at 0.0.0.0/12123] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.block.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.block.client.port appended with serviceId and nodeId
2021-10-05 13:25:40,181 [Listener at 0.0.0.0/12123] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.datanode.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.datanode.port appended with serviceId and nodeId
2021-10-05 13:25:40,181 [Listener at 0.0.0.0/12123] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.client.port appended with serviceId and nodeId
2021-10-05 13:25:40,181 [Listener at 0.0.0.0/12123] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.block.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.block.client.port appended with serviceId and nodeId
2021-10-05 13:25:40,181 [Listener at 0.0.0.0/12123] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.datanode.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.datanode.port appended with serviceId and nodeId
2021-10-05 13:25:40,772 [EndpointStateMachine task thread for /127.0.0.1:15041 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15041. Already tried 2 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:40,799 [EndpointStateMachine task thread for /127.0.0.1:13549 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:13549. Already tried 8 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:40,800 [EndpointStateMachine task thread for /127.0.0.1:13529 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:13529. Already tried 8 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:40,835 [EndpointStateMachine task thread for /127.0.0.1:15031 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15031. Already tried 6 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:40,844 [EndpointStateMachine task thread for /127.0.0.1:15021 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15021. Already tried 6 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:40,955 [EndpointStateMachine task thread for /127.0.0.1:13539 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:13539. Already tried 7 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:41,775 [EndpointStateMachine task thread for /127.0.0.1:15041 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15041. Already tried 3 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:41,800 [EndpointStateMachine task thread for /127.0.0.1:13549 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:13549. Already tried 9 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:41,800 [EndpointStateMachine task thread for /127.0.0.1:13529 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:13529. Already tried 9 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:41,835 [EndpointStateMachine task thread for /127.0.0.1:15031 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15031. Already tried 7 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:41,844 [EndpointStateMachine task thread for /127.0.0.1:15021 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15021. Already tried 7 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:41,955 [EndpointStateMachine task thread for /127.0.0.1:13539 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:13539. Already tried 8 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:42,206 [Listener at 0.0.0.0/12123] INFO  retry.RetryInvocationHandler (RetryInvocationHandler.java:log(411)) - com.google.protobuf.ServiceException: java.net.ConnectException: Call From fv-az270-324/10.1.0.10 to localhost:12132 failed on connection exception: java.net.ConnectException: Connection refused; For more details see:  http://wiki.apache.org/hadoop/ConnectionRefused, while invoking $Proxy39.send over nodeId=scmNode-2,nodeAddress=/127.0.0.1:12132 after 1 failover attempts. Trying to failover after sleeping for 2000ms.
2021-10-05 13:25:42,776 [EndpointStateMachine task thread for /127.0.0.1:15041 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15041. Already tried 4 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:42,800 [EndpointStateMachine task thread for /127.0.0.1:13549 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:13549. Already tried 10 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:42,801 [EndpointStateMachine task thread for /127.0.0.1:13529 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:13529. Already tried 10 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:42,835 [EndpointStateMachine task thread for /127.0.0.1:15031 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15031. Already tried 8 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:42,845 [EndpointStateMachine task thread for /127.0.0.1:15021 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15021. Already tried 8 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:42,956 [EndpointStateMachine task thread for /127.0.0.1:13539 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:13539. Already tried 9 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:43,776 [EndpointStateMachine task thread for /127.0.0.1:15041 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15041. Already tried 5 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:43,801 [EndpointStateMachine task thread for /127.0.0.1:13549 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:13549. Already tried 11 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:43,801 [EndpointStateMachine task thread for /127.0.0.1:13529 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:13529. Already tried 11 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:43,836 [EndpointStateMachine task thread for /127.0.0.1:15031 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15031. Already tried 9 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:43,845 [EndpointStateMachine task thread for /127.0.0.1:15021 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15021. Already tried 9 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:43,956 [EndpointStateMachine task thread for /127.0.0.1:13539 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:13539. Already tried 10 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:44,207 [Listener at 0.0.0.0/12123] INFO  retry.RetryInvocationHandler (RetryInvocationHandler.java:log(411)) - com.google.protobuf.ServiceException: java.net.ConnectException: Call From fv-az270-324/10.1.0.10 to localhost:12142 failed on connection exception: java.net.ConnectException: Connection refused; For more details see:  http://wiki.apache.org/hadoop/ConnectionRefused, while invoking $Proxy39.send over nodeId=scmNode-3,nodeAddress=/127.0.0.1:12142 after 2 failover attempts. Trying to failover after sleeping for 2000ms.
2021-10-05 13:25:44,777 [EndpointStateMachine task thread for /127.0.0.1:15041 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15041. Already tried 6 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:44,801 [EndpointStateMachine task thread for /127.0.0.1:13549 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:13549. Already tried 12 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:44,802 [EndpointStateMachine task thread for /127.0.0.1:13529 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:13529. Already tried 12 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:44,836 [EndpointStateMachine task thread for /127.0.0.1:15031 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15031. Already tried 10 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:44,845 [EndpointStateMachine task thread for /127.0.0.1:15021 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15021. Already tried 10 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:44,956 [EndpointStateMachine task thread for /127.0.0.1:13539 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:13539. Already tried 11 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:45,009 [61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-FollowerState] INFO  impl.FollowerState (FollowerState.java:run(134)) - 61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-FollowerState: change to CANDIDATE, lastRpcElapsedTime:5149560107ns, electionTimeout:5132ms
2021-10-05 13:25:45,009 [61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-FollowerState] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(108)) - 61371ea4-f7c9-4e51-8ebe-bd324b8103e3: shutdown 61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-FollowerState
2021-10-05 13:25:45,009 [61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-FollowerState] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(285)) - 61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E: changes role from  FOLLOWER to CANDIDATE at term 1 for changeToCandidate
2021-10-05 13:25:45,009 [61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-FollowerState] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.leaderelection.pre-vote = false (custom)
2021-10-05 13:25:45,009 [61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-FollowerState] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(130)) - 61371ea4-f7c9-4e51-8ebe-bd324b8103e3: start 61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-LeaderElection29
2021-10-05 13:25:45,022 [61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-LeaderElection29] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(306)) - 61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-LeaderElection29 ELECTION round 0: submit vote requests at term 2 for 0: [61371ea4-f7c9-4e51-8ebe-bd324b8103e3|rpc:localhost:12120|admin:|client:|dataStream:|priority:0], old=null
2021-10-05 13:25:45,022 [61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-LeaderElection29] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(308)) - 61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-LeaderElection29 ELECTION round 0: result PASSED (term=2)
2021-10-05 13:25:45,022 [61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-LeaderElection29] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(121)) - 61371ea4-f7c9-4e51-8ebe-bd324b8103e3: shutdown 61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-LeaderElection29
2021-10-05 13:25:45,022 [61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-LeaderElection29] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(285)) - 61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E: changes role from CANDIDATE to LEADER at term 2 for changeToLeader
2021-10-05 13:25:45,022 [61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-LeaderElection29] INFO  ha.SCMStateMachine (SCMStateMachine.java:notifyLeaderChanged(252)) - current SCM becomes leader of term 2.
2021-10-05 13:25:45,022 [61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-LeaderElection29] INFO  ha.SCMContext (SCMContext.java:updateLeaderAndTerm(88)) - update <isLeader,term> from <false,0> to <true,2>
2021-10-05 13:25:45,022 [61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-LeaderElection29] INFO  server.RaftServer$Division (ServerState.java:setLeader(285)) - 61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E: change Leader from null to 61371ea4-f7c9-4e51-8ebe-bd324b8103e3 at term 2 for becomeLeader, leader elected after 5354ms
2021-10-05 13:25:45,022 [61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-LeaderElection29] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.staging.catchup.gap = 1000 (default)
2021-10-05 13:25:45,023 [61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-LeaderElection29] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.write.element-limit = 4096 (default)
2021-10-05 13:25:45,023 [61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-LeaderElection29] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.write.byte-limit = 64MB (=67108864) (default)
2021-10-05 13:25:45,023 [61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-LeaderElection29] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.watch.timeout = 10s (default)
2021-10-05 13:25:45,023 [61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-LeaderElection29] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.watch.timeout.denomination = 1s (default)
2021-10-05 13:25:45,023 [61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-LeaderElection29] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.watch.element-limit = 65536 (default)
2021-10-05 13:25:45,023 [61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-LeaderElection29] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(130)) - 61371ea4-f7c9-4e51-8ebe-bd324b8103e3: start 61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-LeaderStateImpl
2021-10-05 13:25:45,023 [61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-LeaderElection29] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:rollLogSegment(399)) - 61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-SegmentedRaftLogWorker: Rolling segment log-0_0 to index:0
2021-10-05 13:25:45,025 [61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(558)) - 61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-SegmentedRaftLogWorker: Rolled log segment from /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-62d231c0-d845-4dcd-88aa-c082e017c57e/scmNode-1/scm-ha/62d231c0-d845-4dcd-88aa-c082e017c57e/current/log_inprogress_0 to /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-62d231c0-d845-4dcd-88aa-c082e017c57e/scmNode-1/scm-ha/62d231c0-d845-4dcd-88aa-c082e017c57e/current/log_0-0
2021-10-05 13:25:45,027 [61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(601)) - 61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-SegmentedRaftLogWorker: created new log segment /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-62d231c0-d845-4dcd-88aa-c082e017c57e/scmNode-1/scm-ha/62d231c0-d845-4dcd-88aa-c082e017c57e/current/log_inprogress_1
2021-10-05 13:25:45,032 [61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-LeaderElection29] INFO  server.RaftServer$Division (ServerState.java:setRaftConf(387)) - 61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E: set configuration 1: [61371ea4-f7c9-4e51-8ebe-bd324b8103e3|rpc:localhost:12120|admin:|client:|dataStream:|priority:0], old=null
2021-10-05 13:25:45,038 [61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-StateMachineUpdater] INFO  ha.SCMContext (SCMContext.java:setLeaderReady(115)) - update <isLeaderReady> from <false> to <true>
2021-10-05 13:25:45,039 [61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-StateMachineUpdater] INFO  pipeline.BackgroundPipelineCreator (BackgroundPipelineCreatorV2.java:notifyStatusChanged(264)) - Service BackgroundPipelineCreator transitions to RUNNING.
2021-10-05 13:25:45,039 [61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-StateMachineUpdater] INFO  safemode.HealthyPipelineSafeModeRule (HealthyPipelineSafeModeRule.java:initializeRule(152)) - Refreshed total pipeline count is 0, healthy pipeline threshold count is 1
2021-10-05 13:25:45,039 [61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-StateMachineUpdater] INFO  safemode.ContainerSafeModeRule (ContainerSafeModeRule.java:reInitializeRule(177)) - Refreshed one replica container threshold 0, currentThreshold 0
2021-10-05 13:25:45,039 [61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-StateMachineUpdater] INFO  safemode.OneReplicaPipelineSafeModeRule (OneReplicaPipelineSafeModeRule.java:initializeRule(176)) - Refreshed Total pipeline count is 0, pipeline's with at least one datanode reported threshold count is 0
2021-10-05 13:25:45,039 [61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-StateMachineUpdater] INFO  server.SCMDatanodeProtocolServer (SCMDatanodeProtocolServer.java:start(181)) - RPC server for DataNodes is listening at /0.0.0.0:12121
2021-10-05 13:25:45,046 [IPC Server listener on 12121] INFO  ipc.Server (Server.java:run(1344)) - IPC Server listener on 12121: starting
2021-10-05 13:25:45,156 [IPC Server Responder] INFO  ipc.Server (Server.java:run(1507)) - IPC Server Responder: starting
2021-10-05 13:25:45,778 [EndpointStateMachine task thread for /127.0.0.1:15041 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15041. Already tried 7 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:45,802 [EndpointStateMachine task thread for /127.0.0.1:13529 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:13529. Already tried 13 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:45,802 [EndpointStateMachine task thread for /127.0.0.1:13549 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:13549. Already tried 13 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:45,845 [EndpointStateMachine task thread for /127.0.0.1:15031 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15031. Already tried 11 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:45,846 [EndpointStateMachine task thread for /127.0.0.1:15021 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15021. Already tried 11 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:45,957 [EndpointStateMachine task thread for /127.0.0.1:13539 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:13539. Already tried 12 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:46,220 [Listener at 0.0.0.0/12123] INFO  server.StorageContainerManager (StorageContainerManager.java:scmBootstrap(987)) - SCM BootStrap  is successful for ClusterID 62d231c0-d845-4dcd-88aa-c082e017c57e, SCMID b915fa46-3b5f-4935-be53-c7cfdbb15e4b
2021-10-05 13:25:46,220 [Listener at 0.0.0.0/12123] INFO  server.StorageContainerManager (StorageContainerManager.java:scmBootstrap(989)) - Primary SCM Node ID 61371ea4-f7c9-4e51-8ebe-bd324b8103e3
2021-10-05 13:25:46,220 [Listener at 0.0.0.0/12123] INFO  ha.SCMHANodeDetails (SCMHANodeDetails.java:loadSCMHAConfig(157)) - ServiceID for StorageContainerManager is scm-service-test1
2021-10-05 13:25:46,220 [Listener at 0.0.0.0/12123] INFO  ha.SCMHANodeDetails (SCMHANodeDetails.java:loadSCMHAConfig(168)) - ServiceID for StorageContainerManager is scm-service-test1
2021-10-05 13:25:46,220 [Listener at 0.0.0.0/12123] WARN  scm.ScmUtils (ScmUtils.java:logWarn(179)) - ConfigKey ozone.scm.block.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.block.client.port appended with serviceId and nodeId. If want to configure same port configure ozone.scm.block.client.port
2021-10-05 13:25:46,220 [Listener at 0.0.0.0/12123] WARN  scm.ScmUtils (ScmUtils.java:logWarn(179)) - ConfigKey ozone.scm.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.client.port appended with serviceId and nodeId. If want to configure same port configure ozone.scm.client.port
2021-10-05 13:25:46,220 [Listener at 0.0.0.0/12123] WARN  scm.ScmUtils (ScmUtils.java:logWarn(179)) - ConfigKey ozone.scm.datanode.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.datanode.port appended with serviceId and nodeId. If want to configure same port configure ozone.scm.datanode.port
2021-10-05 13:25:46,221 [Listener at 0.0.0.0/12123] WARN  scm.ScmUtils (ScmUtils.java:logWarn(179)) - ConfigKey ozone.scm.block.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.block.client.port appended with serviceId and nodeId. If want to configure same port configure ozone.scm.block.client.port
2021-10-05 13:25:46,221 [Listener at 0.0.0.0/12123] WARN  scm.ScmUtils (ScmUtils.java:logWarn(179)) - ConfigKey ozone.scm.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.client.port appended with serviceId and nodeId. If want to configure same port configure ozone.scm.client.port
2021-10-05 13:25:46,221 [Listener at 0.0.0.0/12123] WARN  scm.ScmUtils (ScmUtils.java:logWarn(179)) - ConfigKey ozone.scm.datanode.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.datanode.port appended with serviceId and nodeId. If want to configure same port configure ozone.scm.datanode.port
2021-10-05 13:25:46,221 [Listener at 0.0.0.0/12123] INFO  ha.SCMHANodeDetails (SCMHANodeDetails.java:loadSCMHAConfig(250)) - Found matching SCM address with SCMServiceId: scm-service-test1, SCMNodeId: scmNode-2, RPC Address: localhost:12130 and Ratis port: 12130
2021-10-05 13:25:46,221 [Listener at 0.0.0.0/12123] INFO  ha.SCMHANodeDetails (ConfUtils.java:setNodeSpecificConfigs(108)) - Setting configuration key ozone.scm.datanode.address with value of key ozone.scm.datanode.address.scm-service-test1.scmNode-2: 127.0.0.1:12131
2021-10-05 13:25:46,221 [Listener at 0.0.0.0/12123] INFO  ha.SCMHANodeDetails (ConfUtils.java:setNodeSpecificConfigs(108)) - Setting configuration key ozone.scm.block.client.address with value of key ozone.scm.block.client.address.scm-service-test1.scmNode-2: 127.0.0.1:12132
2021-10-05 13:25:46,221 [Listener at 0.0.0.0/12123] INFO  ha.SCMHANodeDetails (ConfUtils.java:setNodeSpecificConfigs(108)) - Setting configuration key ozone.scm.client.address with value of key ozone.scm.client.address.scm-service-test1.scmNode-2: 127.0.0.1:12133
2021-10-05 13:25:46,221 [Listener at 0.0.0.0/12123] INFO  ha.SCMHANodeDetails (ConfUtils.java:setNodeSpecificConfigs(108)) - Setting configuration key ozone.scm.ratis.port with value of key ozone.scm.ratis.port.scm-service-test1.scmNode-2: 12130
2021-10-05 13:25:46,221 [Listener at 0.0.0.0/12123] INFO  ha.SCMHANodeDetails (ConfUtils.java:setNodeSpecificConfigs(108)) - Setting configuration key ozone.scm.grpc.port with value of key ozone.scm.grpc.port.scm-service-test1.scmNode-2: 12134
2021-10-05 13:25:46,222 [Listener at 0.0.0.0/12123] INFO  ha.SCMHANodeDetails (ConfUtils.java:setNodeSpecificConfigs(108)) - Setting configuration key ozone.scm.http-address with value of key ozone.scm.http-address.scm-service-test1.scmNode-2: 127.0.0.1:12128
2021-10-05 13:25:46,222 [Listener at 0.0.0.0/12123] INFO  ha.SCMHANodeDetails (ConfUtils.java:setNodeSpecificConfigs(108)) - Setting configuration key ozone.scm.https-address with value of key ozone.scm.https-address.scm-service-test1.scmNode-2: 127.0.0.1:12129
2021-10-05 13:25:46,222 [Listener at 0.0.0.0/12123] INFO  ha.SCMHANodeDetails (ConfUtils.java:setNodeSpecificConfigs(108)) - Setting configuration key ozone.scm.address with value of key ozone.scm.address.scm-service-test1.scmNode-2: 127.0.0.1
2021-10-05 13:25:46,222 [Listener at 0.0.0.0/12123] WARN  scm.ScmUtils (ScmUtils.java:logWarn(179)) - ConfigKey ozone.scm.block.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.block.client.port appended with serviceId and nodeId. If want to configure same port configure ozone.scm.block.client.port
2021-10-05 13:25:46,222 [Listener at 0.0.0.0/12123] WARN  scm.ScmUtils (ScmUtils.java:logWarn(179)) - ConfigKey ozone.scm.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.client.port appended with serviceId and nodeId. If want to configure same port configure ozone.scm.client.port
2021-10-05 13:25:46,222 [Listener at 0.0.0.0/12123] WARN  scm.ScmUtils (ScmUtils.java:logWarn(179)) - ConfigKey ozone.scm.datanode.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.datanode.port appended with serviceId and nodeId. If want to configure same port configure ozone.scm.datanode.port
2021-10-05 13:25:46,222 [Listener at 0.0.0.0/12123] WARN  server.ServerUtils (ServerUtils.java:getScmDbDir(148)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2021-10-05 13:25:46,223 [Listener at 0.0.0.0/12123] INFO  upgrade.AbstractLayoutVersionManager (AbstractLayoutVersionManager.java:init(79)) - Initializing Layout version manager with metadata layout = SCM_HA (version = 2), software layout = SCM_HA (version = 2)
2021-10-05 13:25:46,320 [Listener at 0.0.0.0/12123] INFO  reflections.Reflections (Reflections.java:scan(232)) - Reflections took 92 ms to scan 7 urls, producing 119 keys and 275 values 
2021-10-05 13:25:46,332 [Listener at 0.0.0.0/12123] WARN  utils.HAUtils (HAUtils.java:getMetaDir(342)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2021-10-05 13:25:46,333 [Listener at 0.0.0.0/12123] WARN  db.DBStoreBuilder (DBStoreBuilder.java:applyDBDefinition(145)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2021-10-05 13:25:46,462 [Listener at 0.0.0.0/12123] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchemaFromFile(129)) - Loading schema from [jar:file:/home/runner/.m2/repository/org/apache/ozone/hdds-common/1.2.0-SNAPSHOT/hdds-common-1.2.0-SNAPSHOT.jar!/network-topology-default.xml]
2021-10-05 13:25:46,462 [Listener at 0.0.0.0/12123] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchema(176)) - Loading network topology layer schema file
2021-10-05 13:25:46,464 [Listener at 0.0.0.0/12123] WARN  impl.MetricRegistriesImpl (MetricRegistriesImpl.java:addReporterRegistration(111)) - New reporters are added after registries were created. Some metrics will be missing from the reporter. Please add reporter before adding any new registry.
2021-10-05 13:25:46,465 [Listener at 0.0.0.0/12123] WARN  impl.MetricRegistriesImpl (MetricRegistriesImpl.java:addReporterRegistration(111)) - New reporters are added after registries were created. Some metrics will be missing from the reporter. Please add reporter before adding any new registry.
2021-10-05 13:25:46,466 [Listener at 0.0.0.0/12123] INFO  ha.SCMRatisServerImpl (SCMRatisServerImpl.java:<init>(87)) - starting Raft server for scm:b915fa46-3b5f-4935-be53-c7cfdbb15e4b
2021-10-05 13:25:46,466 [Listener at 0.0.0.0/12123] INFO  server.RaftServer (ConfUtils.java:logGet(44)) - raft.rpc.type = GRPC (default)
2021-10-05 13:25:46,466 [Listener at 0.0.0.0/12123] INFO  grpc.GrpcFactory (GrpcFactory.java:checkPooledByteBufAllocatorUseCacheForAllThreads(48)) - PERFORMANCE WARNING: useCacheForAllThreads is true that may cause Netty to create a lot garbage objects and, as a result, trigger GC.
	It is recommended to disable useCacheForAllThreads by setting -Dorg.apache.ratis.thirdparty.io.netty.allocator.useCacheForAllThreads=false in command line.
2021-10-05 13:25:46,467 [Listener at 0.0.0.0/12123] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(44)) - raft.grpc.admin.port = -1 (default)
2021-10-05 13:25:46,467 [Listener at 0.0.0.0/12123] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(44)) - raft.grpc.server.port = 12130 (custom)
2021-10-05 13:25:46,467 [Listener at 0.0.0.0/12123] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(44)) - raft.grpc.client.port = -1 (default)
2021-10-05 13:25:46,467 [Listener at 0.0.0.0/12123] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(44)) - raft.grpc.server.port = 12130 (custom)
2021-10-05 13:25:46,467 [Listener at 0.0.0.0/12123] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(44)) - raft.grpc.server.port = 12130 (custom)
2021-10-05 13:25:46,467 [Listener at 0.0.0.0/12123] INFO  server.GrpcService (ConfUtils.java:logGet(44)) - raft.grpc.message.size.max = 32m (=33554432) (custom)
2021-10-05 13:25:46,467 [Listener at 0.0.0.0/12123] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2021-10-05 13:25:46,468 [Listener at 0.0.0.0/12123] INFO  server.GrpcService (ConfUtils.java:logGet(44)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2021-10-05 13:25:46,468 [Listener at 0.0.0.0/12123] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.request.timeout = 30000ms (custom)
2021-10-05 13:25:46,469 [Listener at 0.0.0.0/12123] INFO  impl.DataStreamServerImpl (ConfUtils.java:logGet(44)) - raft.datastream.type = DISABLED (default)
2021-10-05 13:25:46,469 [Listener at 0.0.0.0/12123] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.slowness.timeout = 120000ms (custom)
2021-10-05 13:25:46,469 [Listener at 0.0.0.0/12123] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.leaderelection.leader.step-down.wait-time = 10s (default)
2021-10-05 13:25:46,469 [Listener at 0.0.0.0/12123] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.storage.dir = [/home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-62d231c0-d845-4dcd-88aa-c082e017c57e/scmNode-2/scm-ha] (custom)
2021-10-05 13:25:46,470 [Listener at 0.0.0.0/12123] INFO  server.RaftServer (RaftServerProxy.java:addNew(95)) - b915fa46-3b5f-4935-be53-c7cfdbb15e4b: addNew group-C082E017C57E:[] returns group-C082E017C57E:java.util.concurrent.CompletableFuture@45ca5faf[Not completed]
2021-10-05 13:25:46,470 [pool-377-thread-1] INFO  server.RaftServer$Division (RaftServerImpl.java:<init>(181)) - b915fa46-3b5f-4935-be53-c7cfdbb15e4b: new RaftServerImpl for group-C082E017C57E:[] with SCMStateMachine:uninitialized
2021-10-05 13:25:46,487 [pool-377-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.timeout.min = 5000ms (custom)
2021-10-05 13:25:46,487 [pool-377-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.timeout.max = 5200ms (custom)
2021-10-05 13:25:46,487 [pool-377-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.sleep.time = 25ms (default)
2021-10-05 13:25:46,487 [pool-377-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.slowness.timeout = 120000ms (custom)
2021-10-05 13:25:46,487 [pool-377-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.leaderelection.leader.step-down.wait-time = 10s (default)
2021-10-05 13:25:46,487 [pool-377-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.sleep.deviation.threshold = 300ms (default)
2021-10-05 13:25:46,488 [pool-377-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.appender.install.snapshot.enabled = false (custom)
2021-10-05 13:25:46,488 [pool-377-thread-1] INFO  server.RaftServer$Division (ServerState.java:<init>(105)) - b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E: ConfigurationManager, init=-1: [], old=null, confs=<EMPTY_MAP>
2021-10-05 13:25:46,488 [pool-377-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.storage.dir = [/home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-62d231c0-d845-4dcd-88aa-c082e017c57e/scmNode-2/scm-ha] (custom)
2021-10-05 13:25:46,488 [pool-377-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.corruption.policy = EXCEPTION (default)
2021-10-05 13:25:46,488 [pool-377-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.storage.free-space.min = 0MB (=0) (default)
2021-10-05 13:25:46,488 [pool-377-thread-1] INFO  storage.RaftStorageDirectory (RaftStorageDirectoryImpl.java:analyzeStorage(135)) - The storage directory /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-62d231c0-d845-4dcd-88aa-c082e017c57e/scmNode-2/scm-ha/62d231c0-d845-4dcd-88aa-c082e017c57e does not exist. Creating ...
2021-10-05 13:25:46,490 [pool-377-thread-1] INFO  storage.RaftStorageDirectory (RaftStorageDirectoryImpl.java:tryLock(230)) - Lock on /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-62d231c0-d845-4dcd-88aa-c082e017c57e/scmNode-2/scm-ha/62d231c0-d845-4dcd-88aa-c082e017c57e/in_use.lock acquired by nodename 17451@fv-az270-324
2021-10-05 13:25:46,492 [pool-377-thread-1] INFO  storage.RaftStorage (RaftStorageImpl.java:format(89)) - Storage directory /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-62d231c0-d845-4dcd-88aa-c082e017c57e/scmNode-2/scm-ha/62d231c0-d845-4dcd-88aa-c082e017c57e has been successfully formatted.
2021-10-05 13:25:46,503 [pool-377-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.notification.no-leader.timeout = 60s (default)
2021-10-05 13:25:46,503 [pool-377-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.use.memory = false (default)
2021-10-05 13:25:46,503 [pool-377-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.purge.gap = 5 (custom)
2021-10-05 13:25:46,503 [pool-377-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2021-10-05 13:25:46,504 [pool-377-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.segment.size.max = 16384 (custom)
2021-10-05 13:25:46,504 [pool-377-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.segment.cache.num.max = 2 (custom)
2021-10-05 13:25:46,504 [pool-377-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.segment.cache.size.max = 200MB (=209715200) (default)
2021-10-05 13:25:46,504 [pool-377-thread-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:<init>(182)) - new b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-SegmentedRaftLogWorker for RaftStorageImpl:Storage Directory /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-62d231c0-d845-4dcd-88aa-c082e017c57e/scmNode-2/scm-ha/62d231c0-d845-4dcd-88aa-c082e017c57e
2021-10-05 13:25:46,504 [pool-377-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.queue.byte-limit = 64MB (=67108864) (default)
2021-10-05 13:25:46,504 [pool-377-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.queue.element-limit = 4096 (default)
2021-10-05 13:25:46,504 [pool-377-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.segment.size.max = 16384 (custom)
2021-10-05 13:25:46,504 [pool-377-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.preallocated.size = 16384 (custom)
2021-10-05 13:25:46,504 [pool-377-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.force.sync.num = 128 (default)
2021-10-05 13:25:46,504 [pool-377-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.statemachine.data.sync = true (default)
2021-10-05 13:25:46,504 [pool-377-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2021-10-05 13:25:46,504 [pool-377-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2021-10-05 13:25:46,505 [pool-377-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.write.buffer.size = 64KB (=65536) (default)
2021-10-05 13:25:46,505 [pool-377-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.statemachine.data.caching.enabled = false (default)
2021-10-05 13:25:46,505 [pool-377-thread-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:lambda$new$0(133)) - b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-SegmentedRaftLogWorker: flushIndex: setUnconditionally 0 -> -1
2021-10-05 13:25:46,505 [pool-377-thread-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:lambda$new$0(133)) - b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-SegmentedRaftLogWorker: safeCacheEvictIndex: setUnconditionally 0 -> -1
2021-10-05 13:25:46,519 [pool-377-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2021-10-05 13:25:46,520 [pool-377-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.snapshot.auto.trigger.threshold = 5 (custom)
2021-10-05 13:25:46,520 [pool-377-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.snapshot.retention.file.num = -1 (default)
2021-10-05 13:25:46,520 [pool-377-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.purge.upto.snapshot.index = true (custom)
2021-10-05 13:25:46,520 [pool-377-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.retrycache.expirytime = 60000ms (default)
2021-10-05 13:25:46,520 [pool-377-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.retrycache.statistics.expirytime = 100μs (default)
2021-10-05 13:25:46,521 [Listener at 0.0.0.0/12123] INFO  ha.SCMSnapshotProvider (SCMSnapshotProvider.java:<init>(66)) - Initializing SCM Snapshot Provider
2021-10-05 13:25:46,521 [Listener at 0.0.0.0/12123] WARN  server.ServerUtils (ServerUtils.java:getDefaultRatisDirectory(237)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2021-10-05 13:25:46,521 [Listener at 0.0.0.0/12123] WARN  ha.SCMHAUtils (SCMHAUtils.java:getSCMRatisSnapshotDirectory(146)) - SCM snapshot dir is not configured. Falling back to ozone.metadata.dirs config
2021-10-05 13:25:46,522 [Listener at 0.0.0.0/12123] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:upgradeToSequenceId(347)) - upgrade localId to 107544261427200000
2021-10-05 13:25:46,523 [Listener at 0.0.0.0/12123] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:upgradeToSequenceId(357)) - upgrade delTxnId to 0
2021-10-05 13:25:46,523 [Listener at 0.0.0.0/12123] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:upgradeToSequenceId(371)) - upgrade containerId to 0
2021-10-05 13:25:46,523 [Listener at 0.0.0.0/12123] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:<init>(218)) - Init the HA SequenceIdGenerator.
2021-10-05 13:25:46,523 [Listener at 0.0.0.0/12123] WARN  server.ServerUtils (ServerUtils.java:sanitizeUserArgs(73)) - ozone.scm.stale.node.interval value = 300000 is larger than max = 100000 based on the key value of ozone.scm.heartbeat.thread.interval, reset to the max value 100000.
2021-10-05 13:25:46,523 [Listener at 0.0.0.0/12123] WARN  server.ServerUtils (ServerUtils.java:sanitizeUserArgs(73)) - ozone.scm.stale.node.interval value = 300000 is larger than max = 100000 based on the key value of ozone.scm.heartbeat.thread.interval, reset to the max value 100000.
2021-10-05 13:25:46,524 [Listener at 0.0.0.0/12123] INFO  node.SCMNodeManager (SCMNodeManager.java:<init>(144)) - Entering startup safe mode.
2021-10-05 13:25:46,524 [Listener at 0.0.0.0/12123] INFO  algorithms.ContainerPlacementPolicyFactory (ContainerPlacementPolicyFactory.java:getPolicy(60)) - Create container placement policy of type org.apache.hadoop.hdds.scm.container.placement.algorithms.SCMContainerPlacementRandom
2021-10-05 13:25:46,525 [Listener at 0.0.0.0/12123] INFO  pipeline.PipelineStateManagerImpl (PipelineStateManagerImpl.java:initialize(78)) - No pipeline exists in current db
2021-10-05 13:25:46,525 [Listener at 0.0.0.0/12123] INFO  algorithms.LeaderChoosePolicyFactory (LeaderChoosePolicyFactory.java:getPolicy(57)) - Create leader choose policy of type org.apache.hadoop.hdds.scm.pipeline.leader.choose.algorithms.MinLeaderCountChoosePolicy
2021-10-05 13:25:46,525 [Listener at 0.0.0.0/12123] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(43)) - Registering service BackgroundPipelineCreator.
2021-10-05 13:25:46,525 [Listener at 0.0.0.0/12123] INFO  pipeline.BackgroundPipelineCreator (BackgroundPipelineCreatorV2.java:start(130)) - Starting RatisPipelineUtilsThread.
2021-10-05 13:25:46,526 [Listener at 0.0.0.0/12123] INFO  algorithms.PipelineChoosePolicyFactory (PipelineChoosePolicyFactory.java:createPipelineChoosePolicyFromClass(73)) - Create pipeline choose policy of type org.apache.hadoop.hdds.scm.pipeline.choose.algorithms.RandomPipelineChoosePolicy
2021-10-05 13:25:46,527 [Listener at 0.0.0.0/12123] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(43)) - Registering service SCMBlockDeletingService.
2021-10-05 13:25:46,527 [Listener at 0.0.0.0/12123] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(43)) - Registering service ReplicationManager.
2021-10-05 13:25:46,527 [Listener at 0.0.0.0/12123] INFO  container.ReplicationManager (ReplicationManager.java:start(319)) - Starting Replication Monitor Thread.
2021-10-05 13:25:46,528 [Listener at 0.0.0.0/12123] INFO  safemode.ContainerSafeModeRule (ContainerSafeModeRule.java:<init>(89)) - containers with one replica threshold count 0
2021-10-05 13:25:46,529 [Listener at 0.0.0.0/12123] INFO  safemode.HealthyPipelineSafeModeRule (HealthyPipelineSafeModeRule.java:initializeRule(156)) - Total pipeline count is 0, healthy pipeline threshold count is 1
2021-10-05 13:25:46,529 [Listener at 0.0.0.0/12123] INFO  safemode.OneReplicaPipelineSafeModeRule (OneReplicaPipelineSafeModeRule.java:initializeRule(180)) - Total pipeline count is 0, pipeline's with at least one datanode reported threshold count is 0
2021-10-05 13:25:46,551 [Listener at 0.0.0.0/12123] INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(90)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 2000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false.
2021-10-05 13:25:46,554 [Socket Reader #1 for port 12131] INFO  ipc.Server (Server.java:run(1265)) - Starting Socket Reader #1 for port 12131
2021-10-05 13:25:46,560 [Listener at 0.0.0.0/12131] INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(90)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 2000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false.
2021-10-05 13:25:46,561 [Socket Reader #1 for port 12132] INFO  ipc.Server (Server.java:run(1265)) - Starting Socket Reader #1 for port 12132
2021-10-05 13:25:46,569 [Listener at 0.0.0.0/12132] INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(90)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 2000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false.
2021-10-05 13:25:46,573 [ReplicationMonitor] INFO  container.ReplicationManager (ReplicationManager.java:processAll(371)) - Replication Monitor Thread took 0 milliseconds for processing 0 containers.
2021-10-05 13:25:46,587 [Socket Reader #1 for port 12133] INFO  ipc.Server (Server.java:run(1265)) - Starting Socket Reader #1 for port 12133
2021-10-05 13:25:46,673 [Listener at 0.0.0.0/12133] INFO  algorithms.ContainerPlacementPolicyFactory (ContainerPlacementPolicyFactory.java:getPolicy(60)) - Create container placement policy of type org.apache.hadoop.hdds.scm.container.placement.algorithms.SCMContainerPlacementRandom
2021-10-05 13:25:46,674 [Listener at 0.0.0.0/12133] INFO  server.StorageContainerManager (StorageContainerManager.java:<init>(388)) - 
Container Balancer status:
Key                            Value
Running                        false
Container Balancer Configuration values:
Key                                                Value
Threshold                                          0.1
Max Datanodes to Involve per Iteration(ratio)      0.2
Max Size to Move per Iteration                     32212254720B

2021-10-05 13:25:46,679 [Listener at 0.0.0.0/12133] WARN  events.EventQueue (EventQueue.java:fireEvent(194)) - No event handler registered for event TypedEvent{payloadType=SafeModeStatus, name='Safe mode status'}
2021-10-05 13:25:46,687 [Listener at 0.0.0.0/12133] INFO  ha.SCMContext (SCMContext.java:updateSafeModeStatus(205)) - Update SafeModeStatus from SafeModeStatus{safeModeStatus=true, preCheckPassed=false} to SafeModeStatus{safeModeStatus=true, preCheckPassed=false}.
2021-10-05 13:25:46,692 [Listener at 0.0.0.0/12133] INFO  server.StorageContainerManager (StorageContainerManager.java:start(1303)) - StorageContainerLocationProtocol RPC server is listening at /0.0.0.0:12133
2021-10-05 13:25:46,692 [Listener at 0.0.0.0/12133] INFO  ha.SCMRatisServerImpl (SCMRatisServerImpl.java:start(177)) - starting ratis server 0.0.0.0:12130
2021-10-05 13:25:46,692 [Listener at 0.0.0.0/12133] INFO  server.RaftServer$Division (RaftServerImpl.java:start(299)) - b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E: start with initializing state, conf=-1: [], old=null
2021-10-05 13:25:46,692 [Listener at 0.0.0.0/12133] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(285)) - b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E: changes role from      null to FOLLOWER at term 0 for startInitializing
2021-10-05 13:25:46,692 [Listener at 0.0.0.0/12133] INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-C082E017C57E,id=b915fa46-3b5f-4935-be53-c7cfdbb15e4b
2021-10-05 13:25:46,703 [Listener at 0.0.0.0/12133] INFO  server.RaftServer (RaftServerProxy.java:lambda$start$5(374)) - b915fa46-3b5f-4935-be53-c7cfdbb15e4b: start RPC server
2021-10-05 13:25:46,707 [Listener at 0.0.0.0/12133] INFO  server.GrpcService (GrpcService.java:startImpl(253)) - b915fa46-3b5f-4935-be53-c7cfdbb15e4b: GrpcService started, listening on 12130
2021-10-05 13:25:46,707 [Listener at 0.0.0.0/12133] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.client.port appended with serviceId and nodeId
2021-10-05 13:25:46,708 [Listener at 0.0.0.0/12133] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.block.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.block.client.port appended with serviceId and nodeId
2021-10-05 13:25:46,708 [Listener at 0.0.0.0/12133] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.datanode.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.datanode.port appended with serviceId and nodeId
2021-10-05 13:25:46,708 [Listener at 0.0.0.0/12133] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.client.port appended with serviceId and nodeId
2021-10-05 13:25:46,708 [Listener at 0.0.0.0/12133] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.block.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.block.client.port appended with serviceId and nodeId
2021-10-05 13:25:46,708 [Listener at 0.0.0.0/12133] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.datanode.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.datanode.port appended with serviceId and nodeId
2021-10-05 13:25:46,708 [Listener at 0.0.0.0/12133] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.client.port appended with serviceId and nodeId
2021-10-05 13:25:46,708 [Listener at 0.0.0.0/12133] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.block.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.block.client.port appended with serviceId and nodeId
2021-10-05 13:25:46,708 [Listener at 0.0.0.0/12133] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.datanode.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.datanode.port appended with serviceId and nodeId
2021-10-05 13:25:46,710 [org.apache.ratis.util.JvmPauseMonitor$$Lambda$499/1586779822@23829a8f] INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(103)) - JvmPauseMonitor-b915fa46-3b5f-4935-be53-c7cfdbb15e4b: Started
2021-10-05 13:25:46,717 [IPC Server handler 3 on default port 12122] INFO  ha.SCMRatisServerImpl (SCMRatisServerImpl.java:addSCM(291)) - 61371ea4-f7c9-4e51-8ebe-bd324b8103e3: Submitting SetConfiguration request to Ratis server with new SCM peers list: [61371ea4-f7c9-4e51-8ebe-bd324b8103e3|rpc:localhost:12120|admin:|client:|dataStream:|priority:0, b915fa46-3b5f-4935-be53-c7cfdbb15e4b|rpc:localhost:12130|priority:0]
2021-10-05 13:25:46,717 [IPC Server handler 3 on default port 12122] INFO  server.RaftServer$Division (RaftServerImpl.java:setConfigurationAsync(971)) - 61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E: receive setConfiguration SetConfigurationRequest:client-A1E2ADAC06A6->61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E, cid=0, seq=0, RW, null, peers:[61371ea4-f7c9-4e51-8ebe-bd324b8103e3|rpc:localhost:12120|admin:|client:|dataStream:|priority:0, b915fa46-3b5f-4935-be53-c7cfdbb15e4b|rpc:localhost:12130|priority:0]
2021-10-05 13:25:46,717 [IPC Server handler 3 on default port 12122] INFO  server.RaftServer$Division (LeaderStateImpl.java:startSetConfiguration(345)) - 61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-LeaderStateImpl: startSetConfiguration SetConfigurationRequest:client-A1E2ADAC06A6->61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E, cid=0, seq=0, RW, null, peers:[61371ea4-f7c9-4e51-8ebe-bd324b8103e3|rpc:localhost:12120|admin:|client:|dataStream:|priority:0, b915fa46-3b5f-4935-be53-c7cfdbb15e4b|rpc:localhost:12130|priority:0]
2021-10-05 13:25:46,717 [IPC Server handler 3 on default port 12122] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2021-10-05 13:25:46,717 [IPC Server handler 3 on default port 12122] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2021-10-05 13:25:46,717 [IPC Server handler 3 on default port 12122] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.appender.buffer.element-limit = 1024 (custom)
2021-10-05 13:25:46,723 [IPC Server handler 3 on default port 12122] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(44)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2021-10-05 13:25:46,723 [IPC Server handler 3 on default port 12122] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.request.timeout = 30000ms (custom)
2021-10-05 13:25:46,723 [IPC Server handler 3 on default port 12122] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.appender.install.snapshot.enabled = false (custom)
2021-10-05 13:25:46,764 [grpc-default-executor-0] INFO  ha.SCMStateMachine (SCMStateMachine.java:notifyLeaderChanged(248)) - leader changed, yet current SCM is still follower.
2021-10-05 13:25:46,764 [grpc-default-executor-0] INFO  server.RaftServer$Division (ServerState.java:setLeader(285)) - b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E: change Leader from null to 61371ea4-f7c9-4e51-8ebe-bd324b8103e3 at term 2 for appendEntries, leader elected after 260ms
2021-10-05 13:25:46,764 [grpc-default-executor-0] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(130)) - b915fa46-3b5f-4935-be53-c7cfdbb15e4b: start b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-FollowerState
2021-10-05 13:25:46,772 [grpc-default-executor-0] INFO  server.RaftServer$Division (ServerState.java:setRaftConf(387)) - b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E: set configuration 0: [61371ea4-f7c9-4e51-8ebe-bd324b8103e3|rpc:localhost:12120|admin:|client:|dataStream:|priority:0], old=null
2021-10-05 13:25:46,772 [grpc-default-executor-0] INFO  server.RaftServer$Division (ServerState.java:setRaftConf(387)) - b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E: set configuration 1: [61371ea4-f7c9-4e51-8ebe-bd324b8103e3|rpc:localhost:12120|admin:|client:|dataStream:|priority:0], old=null
2021-10-05 13:25:46,772 [grpc-default-executor-0] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:startLogSegment(394)) - b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-SegmentedRaftLogWorker: Starting segment from index:0
2021-10-05 13:25:46,772 [grpc-default-executor-0] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:rollLogSegment(399)) - b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-SegmentedRaftLogWorker: Rolling segment log-0_0 to index:0
2021-10-05 13:25:46,773 [b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(601)) - b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-SegmentedRaftLogWorker: created new log segment /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-62d231c0-d845-4dcd-88aa-c082e017c57e/scmNode-2/scm-ha/62d231c0-d845-4dcd-88aa-c082e017c57e/current/log_inprogress_0
2021-10-05 13:25:46,775 [b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(558)) - b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-SegmentedRaftLogWorker: Rolled log segment from /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-62d231c0-d845-4dcd-88aa-c082e017c57e/scmNode-2/scm-ha/62d231c0-d845-4dcd-88aa-c082e017c57e/current/log_inprogress_0 to /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-62d231c0-d845-4dcd-88aa-c082e017c57e/scmNode-2/scm-ha/62d231c0-d845-4dcd-88aa-c082e017c57e/current/log_0-0
2021-10-05 13:25:46,778 [EndpointStateMachine task thread for /127.0.0.1:15041 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15041. Already tried 8 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:46,781 [b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(601)) - b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-SegmentedRaftLogWorker: created new log segment /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-62d231c0-d845-4dcd-88aa-c082e017c57e/scmNode-2/scm-ha/62d231c0-d845-4dcd-88aa-c082e017c57e/current/log_inprogress_1
2021-10-05 13:25:46,802 [EndpointStateMachine task thread for /127.0.0.1:13529 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:13529. Already tried 14 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:46,803 [EndpointStateMachine task thread for /127.0.0.1:13549 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:13549. Already tried 14 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:46,803 [EndpointStateMachine task thread for /127.0.0.1:13549 - 0 ] WARN  statemachine.EndpointStateMachine (EndpointStateMachine.java:logIfNeeded(236)) - Unable to communicate to SCM server at localhost:13549 for past 0 seconds.
java.net.ConnectException: Call From fv-az270-324/10.1.0.10 to localhost:13549 failed on connection exception: java.net.ConnectException: Connection refused; For more details see:  http://wiki.apache.org/hadoop/ConnectionRefused
	at sun.reflect.GeneratedConstructorAccessor42.newInstance(Unknown Source)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.hadoop.net.NetUtils.wrapWithMessage(NetUtils.java:913)
	at org.apache.hadoop.net.NetUtils.wrapException(NetUtils.java:828)
	at org.apache.hadoop.ipc.Client.getRpcResponse(Client.java:1577)
	at org.apache.hadoop.ipc.Client.call(Client.java:1519)
	at org.apache.hadoop.ipc.Client.call(Client.java:1416)
	at org.apache.hadoop.ipc.ProtobufRpcEngine$Invoker.invoke(ProtobufRpcEngine.java:236)
	at org.apache.hadoop.ipc.ProtobufRpcEngine$Invoker.invoke(ProtobufRpcEngine.java:123)
	at com.sun.proxy.$Proxy48.submitRequest(Unknown Source)
	at org.apache.hadoop.ozone.protocolPB.StorageContainerDatanodeProtocolClientSideTranslatorPB.submitRequest(StorageContainerDatanodeProtocolClientSideTranslatorPB.java:117)
	at org.apache.hadoop.ozone.protocolPB.StorageContainerDatanodeProtocolClientSideTranslatorPB.sendHeartbeat(StorageContainerDatanodeProtocolClientSideTranslatorPB.java:149)
	at org.apache.hadoop.ozone.container.common.states.endpoint.HeartbeatEndpointTask.call(HeartbeatEndpointTask.java:179)
	at org.apache.hadoop.ozone.container.common.states.endpoint.HeartbeatEndpointTask.call(HeartbeatEndpointTask.java:82)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.net.ConnectException: Connection refused
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:716)
	at org.apache.hadoop.net.SocketIOWithTimeout.connect(SocketIOWithTimeout.java:206)
	at org.apache.hadoop.net.NetUtils.connect(NetUtils.java:586)
	at org.apache.hadoop.ipc.Client$Connection.setupConnection(Client.java:701)
	at org.apache.hadoop.ipc.Client$Connection.setupIOstreams(Client.java:822)
	at org.apache.hadoop.ipc.Client$Connection.access$3800(Client.java:414)
	at org.apache.hadoop.ipc.Client.getConnection(Client.java:1647)
	at org.apache.hadoop.ipc.Client.call(Client.java:1463)
	... 12 more
2021-10-05 13:25:46,812 [EndpointStateMachine task thread for /127.0.0.1:13529 - 0 ] WARN  statemachine.EndpointStateMachine (EndpointStateMachine.java:logIfNeeded(236)) - Unable to communicate to SCM server at localhost:13529 for past 0 seconds.
java.net.ConnectException: Call From fv-az270-324/10.1.0.10 to localhost:13529 failed on connection exception: java.net.ConnectException: Connection refused; For more details see:  http://wiki.apache.org/hadoop/ConnectionRefused
	at sun.reflect.GeneratedConstructorAccessor42.newInstance(Unknown Source)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.hadoop.net.NetUtils.wrapWithMessage(NetUtils.java:913)
	at org.apache.hadoop.net.NetUtils.wrapException(NetUtils.java:828)
	at org.apache.hadoop.ipc.Client.getRpcResponse(Client.java:1577)
	at org.apache.hadoop.ipc.Client.call(Client.java:1519)
	at org.apache.hadoop.ipc.Client.call(Client.java:1416)
	at org.apache.hadoop.ipc.ProtobufRpcEngine$Invoker.invoke(ProtobufRpcEngine.java:236)
	at org.apache.hadoop.ipc.ProtobufRpcEngine$Invoker.invoke(ProtobufRpcEngine.java:123)
	at com.sun.proxy.$Proxy48.submitRequest(Unknown Source)
	at org.apache.hadoop.ozone.protocolPB.StorageContainerDatanodeProtocolClientSideTranslatorPB.submitRequest(StorageContainerDatanodeProtocolClientSideTranslatorPB.java:117)
	at org.apache.hadoop.ozone.protocolPB.StorageContainerDatanodeProtocolClientSideTranslatorPB.sendHeartbeat(StorageContainerDatanodeProtocolClientSideTranslatorPB.java:149)
	at org.apache.hadoop.ozone.container.common.states.endpoint.HeartbeatEndpointTask.call(HeartbeatEndpointTask.java:179)
	at org.apache.hadoop.ozone.container.common.states.endpoint.HeartbeatEndpointTask.call(HeartbeatEndpointTask.java:82)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.net.ConnectException: Connection refused
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:716)
	at org.apache.hadoop.net.SocketIOWithTimeout.connect(SocketIOWithTimeout.java:206)
	at org.apache.hadoop.net.NetUtils.connect(NetUtils.java:586)
	at org.apache.hadoop.ipc.Client$Connection.setupConnection(Client.java:701)
	at org.apache.hadoop.ipc.Client$Connection.setupIOstreams(Client.java:822)
	at org.apache.hadoop.ipc.Client$Connection.access$3800(Client.java:414)
	at org.apache.hadoop.ipc.Client.getConnection(Client.java:1647)
	at org.apache.hadoop.ipc.Client.call(Client.java:1463)
	... 12 more
2021-10-05 13:25:46,831 [b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-StateMachineUpdater] INFO  safemode.HealthyPipelineSafeModeRule (HealthyPipelineSafeModeRule.java:initializeRule(152)) - Refreshed total pipeline count is 0, healthy pipeline threshold count is 1
2021-10-05 13:25:46,831 [b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-StateMachineUpdater] INFO  safemode.ContainerSafeModeRule (ContainerSafeModeRule.java:reInitializeRule(177)) - Refreshed one replica container threshold 0, currentThreshold 0
2021-10-05 13:25:46,831 [b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-StateMachineUpdater] INFO  safemode.OneReplicaPipelineSafeModeRule (OneReplicaPipelineSafeModeRule.java:initializeRule(176)) - Refreshed Total pipeline count is 0, pipeline's with at least one datanode reported threshold count is 0
2021-10-05 13:25:46,831 [b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-StateMachineUpdater] INFO  server.SCMDatanodeProtocolServer (SCMDatanodeProtocolServer.java:start(181)) - RPC server for DataNodes is listening at /0.0.0.0:12131
2021-10-05 13:25:46,845 [EndpointStateMachine task thread for /127.0.0.1:15031 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15031. Already tried 12 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:46,848 [EndpointStateMachine task thread for /127.0.0.1:15021 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15021. Already tried 12 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:46,853 [IPC Server Responder] INFO  ipc.Server (Server.java:run(1507)) - IPC Server Responder: starting
2021-10-05 13:25:46,854 [61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-LeaderStateImpl] INFO  server.RaftServer$Division (ServerState.java:setRaftConf(387)) - 61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E: set configuration 3: [61371ea4-f7c9-4e51-8ebe-bd324b8103e3|rpc:localhost:12120|admin:|client:|dataStream:|priority:0, b915fa46-3b5f-4935-be53-c7cfdbb15e4b|rpc:localhost:12130|priority:0], old=[61371ea4-f7c9-4e51-8ebe-bd324b8103e3|rpc:localhost:12120|admin:|client:|dataStream:|priority:0]
2021-10-05 13:25:46,859 [grpc-default-executor-0] INFO  server.RaftServer$Division (ServerState.java:setRaftConf(387)) - b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E: set configuration 3: [61371ea4-f7c9-4e51-8ebe-bd324b8103e3|rpc:localhost:12120|admin:|client:|dataStream:|priority:0, b915fa46-3b5f-4935-be53-c7cfdbb15e4b|rpc:localhost:12130|admin:|client:|dataStream:|priority:0], old=[61371ea4-f7c9-4e51-8ebe-bd324b8103e3|rpc:localhost:12120|admin:|client:|dataStream:|priority:0]
2021-10-05 13:25:46,876 [IPC Server listener on 12131] INFO  ipc.Server (Server.java:run(1344)) - IPC Server listener on 12131: starting
2021-10-05 13:25:46,895 [61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-LeaderStateImpl] INFO  server.RaftServer$Division (ServerState.java:setRaftConf(387)) - 61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E: set configuration 5: [61371ea4-f7c9-4e51-8ebe-bd324b8103e3|rpc:localhost:12120|admin:|client:|dataStream:|priority:0, b915fa46-3b5f-4935-be53-c7cfdbb15e4b|rpc:localhost:12130|priority:0], old=null
2021-10-05 13:25:46,896 [grpc-default-executor-0] INFO  server.RaftServer$Division (ServerState.java:setRaftConf(387)) - b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E: set configuration 5: [61371ea4-f7c9-4e51-8ebe-bd324b8103e3|rpc:localhost:12120|admin:|client:|dataStream:|priority:0, b915fa46-3b5f-4935-be53-c7cfdbb15e4b|rpc:localhost:12130|admin:|client:|dataStream:|priority:0], old=null
2021-10-05 13:25:46,902 [IPC Server handler 3 on default port 12122] INFO  ha.SCMRatisServerImpl (SCMRatisServerImpl.java:addSCM(302)) - Successfully added new SCM: b915fa46-3b5f-4935-be53-c7cfdbb15e4b.
2021-10-05 13:25:46,902 [61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-StateMachineUpdater] INFO  ha.SCMStateMachine (SCMStateMachine.java:takeSnapshot(290)) - Current Snapshot Index 5, takeSnapshot took 1 ms
2021-10-05 13:25:46,902 [61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:takeSnapshot(281)) - 61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-StateMachineUpdater: Took a snapshot at index 5
2021-10-05 13:25:46,902 [61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:lambda$new$0(89)) - 61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-StateMachineUpdater: snapshotIndex: updateIncreasingly -1 -> 5
2021-10-05 13:25:46,902 [61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:purge(306)) - 61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-SegmentedRaftLog: purge 5
2021-10-05 13:25:46,902 [61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - 61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-SegmentedRaftLog: snapshotIndex: updateIncreasingly -1 -> 5
2021-10-05 13:25:46,902 [Listener at 0.0.0.0/12133] INFO  ha.SCMHAManagerImpl (SCMHAManagerImpl.java:start(116)) - Successfully added SCM scmNode-2 to group group-C082E017C57E:[61371ea4-f7c9-4e51-8ebe-bd324b8103e3|rpc:localhost:12120|admin:|client:|dataStream:|priority:0, b915fa46-3b5f-4935-be53-c7cfdbb15e4b|rpc:localhost:12130|admin:|client:|dataStream:|priority:0]
2021-10-05 13:25:46,902 [Listener at 0.0.0.0/12133] INFO  ha.InterSCMGrpcService (InterSCMGrpcProtocolService.java:start(94)) - Starting SCM Grpc Service at port 12134
2021-10-05 13:25:46,903 [Listener at 0.0.0.0/12133] INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:init(158)) - StorageContainerManager metrics system started (again)
2021-10-05 13:25:46,904 [61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-SegmentedRaftLogWorker] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - 61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-SegmentedRaftLog: purgeIndex: updateToMax old=-1, new=0, updated? true
2021-10-05 13:25:46,919 [b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-StateMachineUpdater] INFO  ha.SCMStateMachine (SCMStateMachine.java:takeSnapshot(290)) - Current Snapshot Index 5, takeSnapshot took 0 ms
2021-10-05 13:25:46,919 [b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:takeSnapshot(281)) - b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-StateMachineUpdater: Took a snapshot at index 5
2021-10-05 13:25:46,920 [b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:lambda$new$0(89)) - b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-StateMachineUpdater: snapshotIndex: updateIncreasingly -1 -> 5
2021-10-05 13:25:46,920 [b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:purge(306)) - b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-SegmentedRaftLog: purge 5
2021-10-05 13:25:46,920 [b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-SegmentedRaftLog: snapshotIndex: updateIncreasingly -1 -> 5
2021-10-05 13:25:46,920 [b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-SegmentedRaftLogWorker] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-SegmentedRaftLog: purgeIndex: updateToMax old=-1, new=0, updated? true
2021-10-05 13:25:46,957 [EndpointStateMachine task thread for /127.0.0.1:13539 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:13539. Already tried 13 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:46,962 [Listener at 0.0.0.0/12133] INFO  server.SCMClientProtocolServer (SCMClientProtocolServer.java:start(164)) - RPC server for Client  is listening at /0.0.0.0:12133
2021-10-05 13:25:46,969 [IPC Server Responder] INFO  ipc.Server (Server.java:run(1507)) - IPC Server Responder: starting
2021-10-05 13:25:46,969 [IPC Server listener on 12133] INFO  ipc.Server (Server.java:run(1344)) - IPC Server listener on 12133: starting
2021-10-05 13:25:47,072 [Listener at 0.0.0.0/12133] INFO  server.StorageContainerManager (StorageContainerManager.java:start(1318)) - ScmBlockLocationProtocol RPC server is listening at /0.0.0.0:12132
2021-10-05 13:25:47,072 [Listener at 0.0.0.0/12133] INFO  server.SCMBlockProtocolServer (SCMBlockProtocolServer.java:start(151)) - RPC server for Block Protocol is listening at /0.0.0.0:12132
2021-10-05 13:25:47,073 [IPC Server Responder] INFO  ipc.Server (Server.java:run(1507)) - IPC Server Responder: starting
2021-10-05 13:25:47,073 [IPC Server listener on 12132] INFO  ipc.Server (Server.java:run(1344)) - IPC Server listener on 12132: starting
2021-10-05 13:25:47,155 [Listener at 0.0.0.0/12133] INFO  server.StorageContainerManager (StorageContainerManager.java:start(1324)) - ScmDatanodeProtocl RPC server is listening at /0.0.0.0:12131
2021-10-05 13:25:47,168 [Listener at 0.0.0.0/12133] INFO  http.BaseHttpServer (BaseHttpServer.java:newHttpServer2BuilderForOzone(209)) - Starting Web-server for scm at: http://0.0.0.0:12128
2021-10-05 13:25:47,168 [Listener at 0.0.0.0/12133] INFO  http.BaseHttpServer (BaseHttpServer.java:<init>(107)) - Hadoop Security Enabled: false Ozone Security Enabled: false Ozone HTTP Security Enabled: false 
2021-10-05 13:25:47,169 [Listener at 0.0.0.0/12133] INFO  server.AuthenticationFilter (AuthenticationFilter.java:constructSecretProvider(240)) - Unable to initialize FileSignerSecretProvider, falling back to use random secrets.
2021-10-05 13:25:47,170 [org.apache.hadoop.util.JvmPauseMonitor$Monitor@c4b2c69] INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(188)) - Starting JVM pause monitor
2021-10-05 13:25:47,170 [Listener at 0.0.0.0/12133] WARN  http.HttpRequestLog (HttpRequestLog.java:getRequestLog(103)) - Jetty request log can only be enabled using Log4j
2021-10-05 13:25:47,171 [Listener at 0.0.0.0/12133] INFO  http.HttpServer2 (HttpServer2.java:addGlobalFilter(1030)) - Added global filter 'safety' (class=org.apache.hadoop.hdds.server.http.HttpServer2$QuotingInputFilter)
2021-10-05 13:25:47,172 [Listener at 0.0.0.0/12133] INFO  http.HttpServer2 (HttpServer2.java:addFilter(1006)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context scm
2021-10-05 13:25:47,175 [Listener at 0.0.0.0/12133] INFO  http.HttpServer2 (HttpServer2.java:addFilter(1014)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context logs
2021-10-05 13:25:47,175 [Listener at 0.0.0.0/12133] INFO  http.HttpServer2 (HttpServer2.java:addFilter(1014)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context static
2021-10-05 13:25:47,176 [Listener at 0.0.0.0/12133] INFO  http.HttpServer2 (HttpServer2.java:bindListener(1249)) - Jetty bound to port 12128
2021-10-05 13:25:47,176 [Listener at 0.0.0.0/12133] INFO  server.Server (Server.java:doStart(375)) - jetty-9.4.43.v20210629; built: 2021-06-30T11:07:22.254Z; git: 526006ecfa3af7f1a27ef3a288e2bef7ea9dd7e8; jvm 1.8.0_292-b10
2021-10-05 13:25:47,215 [Listener at 0.0.0.0/12133] INFO  server.session (DefaultSessionIdManager.java:doStart(334)) - DefaultSessionIdManager workerName=node0
2021-10-05 13:25:47,215 [Listener at 0.0.0.0/12133] INFO  server.session (DefaultSessionIdManager.java:doStart(339)) - No SessionScavenger set, using defaults
2021-10-05 13:25:47,215 [Listener at 0.0.0.0/12133] INFO  server.session (HouseKeeper.java:startScavenging(132)) - node0 Scavenging every 600000ms
2021-10-05 13:25:47,220 [Listener at 0.0.0.0/12133] INFO  handler.ContextHandler (ContextHandler.java:doStart(915)) - Started o.e.j.s.ServletContextHandler@47f71f50{logs,/logs,file:///home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/log,AVAILABLE}
2021-10-05 13:25:47,221 [Listener at 0.0.0.0/12133] INFO  handler.ContextHandler (ContextHandler.java:doStart(915)) - Started o.e.j.s.ServletContextHandler@78c3b3ec{static,/static,file:///home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-classes/webapps/static,AVAILABLE}
2021-10-05 13:25:47,227 [Listener at 0.0.0.0/12133] INFO  handler.ContextHandler (ContextHandler.java:doStart(915)) - Started o.e.j.w.WebAppContext@7f710b19{scm,/,file:///home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-classes/webapps/scm/,AVAILABLE}{file:/home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-classes/webapps/scm}
2021-10-05 13:25:47,243 [Listener at 0.0.0.0/12133] INFO  server.AbstractConnector (AbstractConnector.java:doStart(331)) - Started ServerConnector@1b1d9369{HTTP/1.1, (http/1.1)}{0.0.0.0:12128}
2021-10-05 13:25:47,244 [Listener at 0.0.0.0/12133] INFO  server.Server (Server.java:doStart(415)) - Started @140903ms
2021-10-05 13:25:47,244 [Listener at 0.0.0.0/12133] WARN  impl.MetricsSystemImpl (MetricsSystemImpl.java:register(279)) - Sink prometheus already exists!
2021-10-05 13:25:47,244 [Listener at 0.0.0.0/12133] INFO  http.BaseHttpServer (BaseHttpServer.java:updateConnectorAddress(329)) - HTTP server of scm listening at http://0.0.0.0:12128
2021-10-05 13:25:47,244 [Listener at 0.0.0.0/12133] INFO  ozone.MiniOzoneHAClusterImpl (MiniOzoneHAClusterImpl.java:createSCMService(564)) - Started SCM RPC server at org.apache.hadoop.hdds.scm.server.SCMClientProtocolServer@4642b0f8
2021-10-05 13:25:47,245 [Listener at 0.0.0.0/12133] INFO  ha.SCMHANodeDetails (SCMHANodeDetails.java:loadSCMHAConfig(157)) - ServiceID for StorageContainerManager is scm-service-test1
2021-10-05 13:25:47,245 [Listener at 0.0.0.0/12133] INFO  ha.SCMHANodeDetails (SCMHANodeDetails.java:loadSCMHAConfig(168)) - ServiceID for StorageContainerManager is scm-service-test1
2021-10-05 13:25:47,245 [Listener at 0.0.0.0/12133] WARN  scm.ScmUtils (ScmUtils.java:logWarn(179)) - ConfigKey ozone.scm.block.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.block.client.port appended with serviceId and nodeId. If want to configure same port configure ozone.scm.block.client.port
2021-10-05 13:25:47,245 [Listener at 0.0.0.0/12133] WARN  scm.ScmUtils (ScmUtils.java:logWarn(179)) - ConfigKey ozone.scm.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.client.port appended with serviceId and nodeId. If want to configure same port configure ozone.scm.client.port
2021-10-05 13:25:47,245 [Listener at 0.0.0.0/12133] WARN  scm.ScmUtils (ScmUtils.java:logWarn(179)) - ConfigKey ozone.scm.datanode.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.datanode.port appended with serviceId and nodeId. If want to configure same port configure ozone.scm.datanode.port
2021-10-05 13:25:47,246 [Listener at 0.0.0.0/12133] WARN  scm.ScmUtils (ScmUtils.java:logWarn(179)) - ConfigKey ozone.scm.block.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.block.client.port appended with serviceId and nodeId. If want to configure same port configure ozone.scm.block.client.port
2021-10-05 13:25:47,246 [Listener at 0.0.0.0/12133] WARN  scm.ScmUtils (ScmUtils.java:logWarn(179)) - ConfigKey ozone.scm.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.client.port appended with serviceId and nodeId. If want to configure same port configure ozone.scm.client.port
2021-10-05 13:25:47,246 [Listener at 0.0.0.0/12133] WARN  scm.ScmUtils (ScmUtils.java:logWarn(179)) - ConfigKey ozone.scm.datanode.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.datanode.port appended with serviceId and nodeId. If want to configure same port configure ozone.scm.datanode.port
2021-10-05 13:25:47,246 [Listener at 0.0.0.0/12133] INFO  ha.SCMHANodeDetails (SCMHANodeDetails.java:loadSCMHAConfig(250)) - Found matching SCM address with SCMServiceId: scm-service-test1, SCMNodeId: scmNode-3, RPC Address: localhost:12140 and Ratis port: 12140
2021-10-05 13:25:47,246 [Listener at 0.0.0.0/12133] INFO  ha.SCMHANodeDetails (ConfUtils.java:setNodeSpecificConfigs(108)) - Setting configuration key ozone.scm.datanode.address with value of key ozone.scm.datanode.address.scm-service-test1.scmNode-3: 127.0.0.1:12141
2021-10-05 13:25:47,246 [Listener at 0.0.0.0/12133] INFO  ha.SCMHANodeDetails (ConfUtils.java:setNodeSpecificConfigs(108)) - Setting configuration key ozone.scm.block.client.address with value of key ozone.scm.block.client.address.scm-service-test1.scmNode-3: 127.0.0.1:12142
2021-10-05 13:25:47,246 [Listener at 0.0.0.0/12133] INFO  ha.SCMHANodeDetails (ConfUtils.java:setNodeSpecificConfigs(108)) - Setting configuration key ozone.scm.client.address with value of key ozone.scm.client.address.scm-service-test1.scmNode-3: 127.0.0.1:12143
2021-10-05 13:25:47,246 [Listener at 0.0.0.0/12133] INFO  ha.SCMHANodeDetails (ConfUtils.java:setNodeSpecificConfigs(108)) - Setting configuration key ozone.scm.ratis.port with value of key ozone.scm.ratis.port.scm-service-test1.scmNode-3: 12140
2021-10-05 13:25:47,247 [Listener at 0.0.0.0/12133] INFO  ha.SCMHANodeDetails (ConfUtils.java:setNodeSpecificConfigs(108)) - Setting configuration key ozone.scm.grpc.port with value of key ozone.scm.grpc.port.scm-service-test1.scmNode-3: 12144
2021-10-05 13:25:47,247 [Listener at 0.0.0.0/12133] INFO  ha.SCMHANodeDetails (ConfUtils.java:setNodeSpecificConfigs(108)) - Setting configuration key ozone.scm.http-address with value of key ozone.scm.http-address.scm-service-test1.scmNode-3: 127.0.0.1:12138
2021-10-05 13:25:47,247 [Listener at 0.0.0.0/12133] INFO  ha.SCMHANodeDetails (ConfUtils.java:setNodeSpecificConfigs(108)) - Setting configuration key ozone.scm.https-address with value of key ozone.scm.https-address.scm-service-test1.scmNode-3: 127.0.0.1:12139
2021-10-05 13:25:47,247 [Listener at 0.0.0.0/12133] INFO  ha.SCMHANodeDetails (ConfUtils.java:setNodeSpecificConfigs(108)) - Setting configuration key ozone.scm.address with value of key ozone.scm.address.scm-service-test1.scmNode-3: 127.0.0.1
2021-10-05 13:25:47,247 [Listener at 0.0.0.0/12133] WARN  scm.ScmUtils (ScmUtils.java:logWarn(179)) - ConfigKey ozone.scm.block.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.block.client.port appended with serviceId and nodeId. If want to configure same port configure ozone.scm.block.client.port
2021-10-05 13:25:47,247 [Listener at 0.0.0.0/12133] WARN  scm.ScmUtils (ScmUtils.java:logWarn(179)) - ConfigKey ozone.scm.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.client.port appended with serviceId and nodeId. If want to configure same port configure ozone.scm.client.port
2021-10-05 13:25:47,247 [Listener at 0.0.0.0/12133] WARN  scm.ScmUtils (ScmUtils.java:logWarn(179)) - ConfigKey ozone.scm.datanode.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.datanode.port appended with serviceId and nodeId. If want to configure same port configure ozone.scm.datanode.port
2021-10-05 13:25:47,247 [Listener at 0.0.0.0/12133] WARN  server.ServerUtils (ServerUtils.java:getScmDbDir(148)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2021-10-05 13:25:47,249 [Listener at 0.0.0.0/12133] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.client.port appended with serviceId and nodeId
2021-10-05 13:25:47,251 [Listener at 0.0.0.0/12133] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.block.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.block.client.port appended with serviceId and nodeId
2021-10-05 13:25:47,251 [Listener at 0.0.0.0/12133] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.datanode.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.datanode.port appended with serviceId and nodeId
2021-10-05 13:25:47,252 [Listener at 0.0.0.0/12133] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.client.port appended with serviceId and nodeId
2021-10-05 13:25:47,252 [Listener at 0.0.0.0/12133] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.block.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.block.client.port appended with serviceId and nodeId
2021-10-05 13:25:47,252 [Listener at 0.0.0.0/12133] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.datanode.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.datanode.port appended with serviceId and nodeId
2021-10-05 13:25:47,252 [Listener at 0.0.0.0/12133] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.client.port appended with serviceId and nodeId
2021-10-05 13:25:47,252 [Listener at 0.0.0.0/12133] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.block.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.block.client.port appended with serviceId and nodeId
2021-10-05 13:25:47,252 [Listener at 0.0.0.0/12133] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.datanode.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.datanode.port appended with serviceId and nodeId
2021-10-05 13:25:47,302 [Listener at 0.0.0.0/12133] INFO  server.StorageContainerManager (StorageContainerManager.java:scmBootstrap(987)) - SCM BootStrap  is successful for ClusterID 62d231c0-d845-4dcd-88aa-c082e017c57e, SCMID c0dc85a0-048d-4f44-9d3e-e7de6885deea
2021-10-05 13:25:47,302 [Listener at 0.0.0.0/12133] INFO  server.StorageContainerManager (StorageContainerManager.java:scmBootstrap(989)) - Primary SCM Node ID 61371ea4-f7c9-4e51-8ebe-bd324b8103e3
2021-10-05 13:25:47,303 [Listener at 0.0.0.0/12133] INFO  ha.SCMHANodeDetails (SCMHANodeDetails.java:loadSCMHAConfig(157)) - ServiceID for StorageContainerManager is scm-service-test1
2021-10-05 13:25:47,303 [Listener at 0.0.0.0/12133] INFO  ha.SCMHANodeDetails (SCMHANodeDetails.java:loadSCMHAConfig(168)) - ServiceID for StorageContainerManager is scm-service-test1
2021-10-05 13:25:47,303 [Listener at 0.0.0.0/12133] WARN  scm.ScmUtils (ScmUtils.java:logWarn(179)) - ConfigKey ozone.scm.block.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.block.client.port appended with serviceId and nodeId. If want to configure same port configure ozone.scm.block.client.port
2021-10-05 13:25:47,303 [Listener at 0.0.0.0/12133] WARN  scm.ScmUtils (ScmUtils.java:logWarn(179)) - ConfigKey ozone.scm.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.client.port appended with serviceId and nodeId. If want to configure same port configure ozone.scm.client.port
2021-10-05 13:25:47,303 [Listener at 0.0.0.0/12133] WARN  scm.ScmUtils (ScmUtils.java:logWarn(179)) - ConfigKey ozone.scm.datanode.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.datanode.port appended with serviceId and nodeId. If want to configure same port configure ozone.scm.datanode.port
2021-10-05 13:25:47,304 [Listener at 0.0.0.0/12133] WARN  scm.ScmUtils (ScmUtils.java:logWarn(179)) - ConfigKey ozone.scm.block.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.block.client.port appended with serviceId and nodeId. If want to configure same port configure ozone.scm.block.client.port
2021-10-05 13:25:47,304 [Listener at 0.0.0.0/12133] WARN  scm.ScmUtils (ScmUtils.java:logWarn(179)) - ConfigKey ozone.scm.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.client.port appended with serviceId and nodeId. If want to configure same port configure ozone.scm.client.port
2021-10-05 13:25:47,304 [Listener at 0.0.0.0/12133] WARN  scm.ScmUtils (ScmUtils.java:logWarn(179)) - ConfigKey ozone.scm.datanode.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.datanode.port appended with serviceId and nodeId. If want to configure same port configure ozone.scm.datanode.port
2021-10-05 13:25:47,304 [Listener at 0.0.0.0/12133] INFO  ha.SCMHANodeDetails (SCMHANodeDetails.java:loadSCMHAConfig(250)) - Found matching SCM address with SCMServiceId: scm-service-test1, SCMNodeId: scmNode-3, RPC Address: localhost:12140 and Ratis port: 12140
2021-10-05 13:25:47,304 [Listener at 0.0.0.0/12133] INFO  ha.SCMHANodeDetails (ConfUtils.java:setNodeSpecificConfigs(108)) - Setting configuration key ozone.scm.datanode.address with value of key ozone.scm.datanode.address.scm-service-test1.scmNode-3: 127.0.0.1:12141
2021-10-05 13:25:47,304 [Listener at 0.0.0.0/12133] INFO  ha.SCMHANodeDetails (ConfUtils.java:setNodeSpecificConfigs(108)) - Setting configuration key ozone.scm.block.client.address with value of key ozone.scm.block.client.address.scm-service-test1.scmNode-3: 127.0.0.1:12142
2021-10-05 13:25:47,304 [Listener at 0.0.0.0/12133] INFO  ha.SCMHANodeDetails (ConfUtils.java:setNodeSpecificConfigs(108)) - Setting configuration key ozone.scm.client.address with value of key ozone.scm.client.address.scm-service-test1.scmNode-3: 127.0.0.1:12143
2021-10-05 13:25:47,304 [Listener at 0.0.0.0/12133] INFO  ha.SCMHANodeDetails (ConfUtils.java:setNodeSpecificConfigs(108)) - Setting configuration key ozone.scm.ratis.port with value of key ozone.scm.ratis.port.scm-service-test1.scmNode-3: 12140
2021-10-05 13:25:47,304 [Listener at 0.0.0.0/12133] INFO  ha.SCMHANodeDetails (ConfUtils.java:setNodeSpecificConfigs(108)) - Setting configuration key ozone.scm.grpc.port with value of key ozone.scm.grpc.port.scm-service-test1.scmNode-3: 12144
2021-10-05 13:25:47,305 [Listener at 0.0.0.0/12133] INFO  ha.SCMHANodeDetails (ConfUtils.java:setNodeSpecificConfigs(108)) - Setting configuration key ozone.scm.http-address with value of key ozone.scm.http-address.scm-service-test1.scmNode-3: 127.0.0.1:12138
2021-10-05 13:25:47,305 [Listener at 0.0.0.0/12133] INFO  ha.SCMHANodeDetails (ConfUtils.java:setNodeSpecificConfigs(108)) - Setting configuration key ozone.scm.https-address with value of key ozone.scm.https-address.scm-service-test1.scmNode-3: 127.0.0.1:12139
2021-10-05 13:25:47,305 [Listener at 0.0.0.0/12133] INFO  ha.SCMHANodeDetails (ConfUtils.java:setNodeSpecificConfigs(108)) - Setting configuration key ozone.scm.address with value of key ozone.scm.address.scm-service-test1.scmNode-3: 127.0.0.1
2021-10-05 13:25:47,306 [Listener at 0.0.0.0/12133] WARN  scm.ScmUtils (ScmUtils.java:logWarn(179)) - ConfigKey ozone.scm.block.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.block.client.port appended with serviceId and nodeId. If want to configure same port configure ozone.scm.block.client.port
2021-10-05 13:25:47,306 [Listener at 0.0.0.0/12133] WARN  scm.ScmUtils (ScmUtils.java:logWarn(179)) - ConfigKey ozone.scm.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.client.port appended with serviceId and nodeId. If want to configure same port configure ozone.scm.client.port
2021-10-05 13:25:47,306 [Listener at 0.0.0.0/12133] WARN  scm.ScmUtils (ScmUtils.java:logWarn(179)) - ConfigKey ozone.scm.datanode.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.datanode.port appended with serviceId and nodeId. If want to configure same port configure ozone.scm.datanode.port
2021-10-05 13:25:47,306 [Listener at 0.0.0.0/12133] WARN  server.ServerUtils (ServerUtils.java:getScmDbDir(148)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2021-10-05 13:25:47,307 [Listener at 0.0.0.0/12133] INFO  upgrade.AbstractLayoutVersionManager (AbstractLayoutVersionManager.java:init(79)) - Initializing Layout version manager with metadata layout = SCM_HA (version = 2), software layout = SCM_HA (version = 2)
2021-10-05 13:25:47,398 [Listener at 0.0.0.0/12133] INFO  reflections.Reflections (Reflections.java:scan(232)) - Reflections took 89 ms to scan 7 urls, producing 119 keys and 275 values 
2021-10-05 13:25:47,399 [Listener at 0.0.0.0/12133] WARN  utils.HAUtils (HAUtils.java:getMetaDir(342)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2021-10-05 13:25:47,399 [Listener at 0.0.0.0/12133] WARN  db.DBStoreBuilder (DBStoreBuilder.java:applyDBDefinition(145)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2021-10-05 13:25:47,546 [Listener at 0.0.0.0/12133] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchemaFromFile(129)) - Loading schema from [jar:file:/home/runner/.m2/repository/org/apache/ozone/hdds-common/1.2.0-SNAPSHOT/hdds-common-1.2.0-SNAPSHOT.jar!/network-topology-default.xml]
2021-10-05 13:25:47,546 [Listener at 0.0.0.0/12133] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchema(176)) - Loading network topology layer schema file
2021-10-05 13:25:47,551 [Listener at 0.0.0.0/12133] WARN  impl.MetricRegistriesImpl (MetricRegistriesImpl.java:addReporterRegistration(111)) - New reporters are added after registries were created. Some metrics will be missing from the reporter. Please add reporter before adding any new registry.
2021-10-05 13:25:47,552 [Listener at 0.0.0.0/12133] WARN  impl.MetricRegistriesImpl (MetricRegistriesImpl.java:addReporterRegistration(111)) - New reporters are added after registries were created. Some metrics will be missing from the reporter. Please add reporter before adding any new registry.
2021-10-05 13:25:47,555 [Listener at 0.0.0.0/12133] INFO  ha.SCMRatisServerImpl (SCMRatisServerImpl.java:<init>(87)) - starting Raft server for scm:c0dc85a0-048d-4f44-9d3e-e7de6885deea
2021-10-05 13:25:47,555 [Listener at 0.0.0.0/12133] INFO  server.RaftServer (ConfUtils.java:logGet(44)) - raft.rpc.type = GRPC (default)
2021-10-05 13:25:47,556 [Listener at 0.0.0.0/12133] INFO  grpc.GrpcFactory (GrpcFactory.java:checkPooledByteBufAllocatorUseCacheForAllThreads(48)) - PERFORMANCE WARNING: useCacheForAllThreads is true that may cause Netty to create a lot garbage objects and, as a result, trigger GC.
	It is recommended to disable useCacheForAllThreads by setting -Dorg.apache.ratis.thirdparty.io.netty.allocator.useCacheForAllThreads=false in command line.
2021-10-05 13:25:47,556 [Listener at 0.0.0.0/12133] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(44)) - raft.grpc.admin.port = -1 (default)
2021-10-05 13:25:47,556 [Listener at 0.0.0.0/12133] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(44)) - raft.grpc.server.port = 12140 (custom)
2021-10-05 13:25:47,556 [Listener at 0.0.0.0/12133] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(44)) - raft.grpc.client.port = -1 (default)
2021-10-05 13:25:47,556 [Listener at 0.0.0.0/12133] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(44)) - raft.grpc.server.port = 12140 (custom)
2021-10-05 13:25:47,557 [Listener at 0.0.0.0/12133] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(44)) - raft.grpc.server.port = 12140 (custom)
2021-10-05 13:25:47,557 [Listener at 0.0.0.0/12133] INFO  server.GrpcService (ConfUtils.java:logGet(44)) - raft.grpc.message.size.max = 32m (=33554432) (custom)
2021-10-05 13:25:47,557 [Listener at 0.0.0.0/12133] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2021-10-05 13:25:47,558 [Listener at 0.0.0.0/12133] INFO  server.GrpcService (ConfUtils.java:logGet(44)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2021-10-05 13:25:47,558 [Listener at 0.0.0.0/12133] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.request.timeout = 30000ms (custom)
2021-10-05 13:25:47,559 [Listener at 0.0.0.0/12133] INFO  impl.DataStreamServerImpl (ConfUtils.java:logGet(44)) - raft.datastream.type = DISABLED (default)
2021-10-05 13:25:47,567 [Listener at 0.0.0.0/12133] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.slowness.timeout = 120000ms (custom)
2021-10-05 13:25:47,567 [Listener at 0.0.0.0/12133] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.leaderelection.leader.step-down.wait-time = 10s (default)
2021-10-05 13:25:47,567 [Listener at 0.0.0.0/12133] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.storage.dir = [/home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-62d231c0-d845-4dcd-88aa-c082e017c57e/scmNode-3/scm-ha] (custom)
2021-10-05 13:25:47,568 [Listener at 0.0.0.0/12133] INFO  server.RaftServer (RaftServerProxy.java:addNew(95)) - c0dc85a0-048d-4f44-9d3e-e7de6885deea: addNew group-C082E017C57E:[] returns group-C082E017C57E:java.util.concurrent.CompletableFuture@dcf0fa4[Not completed]
2021-10-05 13:25:47,568 [pool-396-thread-1] INFO  server.RaftServer$Division (RaftServerImpl.java:<init>(181)) - c0dc85a0-048d-4f44-9d3e-e7de6885deea: new RaftServerImpl for group-C082E017C57E:[] with SCMStateMachine:uninitialized
2021-10-05 13:25:47,578 [pool-396-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.timeout.min = 5000ms (custom)
2021-10-05 13:25:47,578 [pool-396-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.timeout.max = 5200ms (custom)
2021-10-05 13:25:47,578 [pool-396-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.sleep.time = 25ms (default)
2021-10-05 13:25:47,578 [pool-396-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.slowness.timeout = 120000ms (custom)
2021-10-05 13:25:47,579 [pool-396-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.leaderelection.leader.step-down.wait-time = 10s (default)
2021-10-05 13:25:47,579 [pool-396-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.sleep.deviation.threshold = 300ms (default)
2021-10-05 13:25:47,579 [pool-396-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.appender.install.snapshot.enabled = false (custom)
2021-10-05 13:25:47,579 [pool-396-thread-1] INFO  server.RaftServer$Division (ServerState.java:<init>(105)) - c0dc85a0-048d-4f44-9d3e-e7de6885deea@group-C082E017C57E: ConfigurationManager, init=-1: [], old=null, confs=<EMPTY_MAP>
2021-10-05 13:25:47,579 [pool-396-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.storage.dir = [/home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-62d231c0-d845-4dcd-88aa-c082e017c57e/scmNode-3/scm-ha] (custom)
2021-10-05 13:25:47,579 [pool-396-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.corruption.policy = EXCEPTION (default)
2021-10-05 13:25:47,579 [pool-396-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.storage.free-space.min = 0MB (=0) (default)
2021-10-05 13:25:47,579 [pool-396-thread-1] INFO  storage.RaftStorageDirectory (RaftStorageDirectoryImpl.java:analyzeStorage(135)) - The storage directory /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-62d231c0-d845-4dcd-88aa-c082e017c57e/scmNode-3/scm-ha/62d231c0-d845-4dcd-88aa-c082e017c57e does not exist. Creating ...
2021-10-05 13:25:47,580 [pool-396-thread-1] INFO  storage.RaftStorageDirectory (RaftStorageDirectoryImpl.java:tryLock(230)) - Lock on /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-62d231c0-d845-4dcd-88aa-c082e017c57e/scmNode-3/scm-ha/62d231c0-d845-4dcd-88aa-c082e017c57e/in_use.lock acquired by nodename 17451@fv-az270-324
2021-10-05 13:25:47,581 [pool-396-thread-1] INFO  storage.RaftStorage (RaftStorageImpl.java:format(89)) - Storage directory /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-62d231c0-d845-4dcd-88aa-c082e017c57e/scmNode-3/scm-ha/62d231c0-d845-4dcd-88aa-c082e017c57e has been successfully formatted.
2021-10-05 13:25:47,581 [pool-396-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.notification.no-leader.timeout = 60s (default)
2021-10-05 13:25:47,581 [pool-396-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.use.memory = false (default)
2021-10-05 13:25:47,582 [pool-396-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.purge.gap = 5 (custom)
2021-10-05 13:25:47,582 [pool-396-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2021-10-05 13:25:47,582 [pool-396-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.segment.size.max = 16384 (custom)
2021-10-05 13:25:47,582 [pool-396-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.segment.cache.num.max = 2 (custom)
2021-10-05 13:25:47,582 [pool-396-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.segment.cache.size.max = 200MB (=209715200) (default)
2021-10-05 13:25:47,582 [pool-396-thread-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:<init>(182)) - new c0dc85a0-048d-4f44-9d3e-e7de6885deea@group-C082E017C57E-SegmentedRaftLogWorker for RaftStorageImpl:Storage Directory /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-62d231c0-d845-4dcd-88aa-c082e017c57e/scmNode-3/scm-ha/62d231c0-d845-4dcd-88aa-c082e017c57e
2021-10-05 13:25:47,582 [pool-396-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.queue.byte-limit = 64MB (=67108864) (default)
2021-10-05 13:25:47,582 [pool-396-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.queue.element-limit = 4096 (default)
2021-10-05 13:25:47,582 [pool-396-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.segment.size.max = 16384 (custom)
2021-10-05 13:25:47,583 [pool-396-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.preallocated.size = 16384 (custom)
2021-10-05 13:25:47,583 [pool-396-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.force.sync.num = 128 (default)
2021-10-05 13:25:47,583 [pool-396-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.statemachine.data.sync = true (default)
2021-10-05 13:25:47,583 [pool-396-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2021-10-05 13:25:47,583 [pool-396-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2021-10-05 13:25:47,583 [pool-396-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.write.buffer.size = 64KB (=65536) (default)
2021-10-05 13:25:47,584 [pool-396-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.statemachine.data.caching.enabled = false (default)
2021-10-05 13:25:47,584 [pool-396-thread-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:lambda$new$0(133)) - c0dc85a0-048d-4f44-9d3e-e7de6885deea@group-C082E017C57E-SegmentedRaftLogWorker: flushIndex: setUnconditionally 0 -> -1
2021-10-05 13:25:47,584 [pool-396-thread-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:lambda$new$0(133)) - c0dc85a0-048d-4f44-9d3e-e7de6885deea@group-C082E017C57E-SegmentedRaftLogWorker: safeCacheEvictIndex: setUnconditionally 0 -> -1
2021-10-05 13:25:47,584 [pool-396-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2021-10-05 13:25:47,584 [pool-396-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.snapshot.auto.trigger.threshold = 5 (custom)
2021-10-05 13:25:47,584 [pool-396-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.snapshot.retention.file.num = -1 (default)
2021-10-05 13:25:47,584 [pool-396-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.purge.upto.snapshot.index = true (custom)
2021-10-05 13:25:47,584 [pool-396-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.retrycache.expirytime = 60000ms (default)
2021-10-05 13:25:47,584 [pool-396-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.retrycache.statistics.expirytime = 100μs (default)
2021-10-05 13:25:47,586 [Listener at 0.0.0.0/12133] INFO  ha.SCMSnapshotProvider (SCMSnapshotProvider.java:<init>(66)) - Initializing SCM Snapshot Provider
2021-10-05 13:25:47,586 [Listener at 0.0.0.0/12133] WARN  server.ServerUtils (ServerUtils.java:getDefaultRatisDirectory(237)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2021-10-05 13:25:47,586 [Listener at 0.0.0.0/12133] WARN  ha.SCMHAUtils (SCMHAUtils.java:getSCMRatisSnapshotDirectory(146)) - SCM snapshot dir is not configured. Falling back to ozone.metadata.dirs config
2021-10-05 13:25:47,588 [Listener at 0.0.0.0/12133] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:upgradeToSequenceId(347)) - upgrade localId to 107544261427200000
2021-10-05 13:25:47,588 [Listener at 0.0.0.0/12133] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:upgradeToSequenceId(357)) - upgrade delTxnId to 0
2021-10-05 13:25:47,588 [Listener at 0.0.0.0/12133] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:upgradeToSequenceId(371)) - upgrade containerId to 0
2021-10-05 13:25:47,588 [Listener at 0.0.0.0/12133] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:<init>(218)) - Init the HA SequenceIdGenerator.
2021-10-05 13:25:47,588 [Listener at 0.0.0.0/12133] WARN  server.ServerUtils (ServerUtils.java:sanitizeUserArgs(73)) - ozone.scm.stale.node.interval value = 300000 is larger than max = 100000 based on the key value of ozone.scm.heartbeat.thread.interval, reset to the max value 100000.
2021-10-05 13:25:47,588 [Listener at 0.0.0.0/12133] WARN  server.ServerUtils (ServerUtils.java:sanitizeUserArgs(73)) - ozone.scm.stale.node.interval value = 300000 is larger than max = 100000 based on the key value of ozone.scm.heartbeat.thread.interval, reset to the max value 100000.
2021-10-05 13:25:47,589 [Listener at 0.0.0.0/12133] INFO  node.SCMNodeManager (SCMNodeManager.java:<init>(144)) - Entering startup safe mode.
2021-10-05 13:25:47,590 [Listener at 0.0.0.0/12133] INFO  algorithms.ContainerPlacementPolicyFactory (ContainerPlacementPolicyFactory.java:getPolicy(60)) - Create container placement policy of type org.apache.hadoop.hdds.scm.container.placement.algorithms.SCMContainerPlacementRandom
2021-10-05 13:25:47,590 [Listener at 0.0.0.0/12133] INFO  pipeline.PipelineStateManagerImpl (PipelineStateManagerImpl.java:initialize(78)) - No pipeline exists in current db
2021-10-05 13:25:47,590 [Listener at 0.0.0.0/12133] INFO  algorithms.LeaderChoosePolicyFactory (LeaderChoosePolicyFactory.java:getPolicy(57)) - Create leader choose policy of type org.apache.hadoop.hdds.scm.pipeline.leader.choose.algorithms.MinLeaderCountChoosePolicy
2021-10-05 13:25:47,591 [Listener at 0.0.0.0/12133] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(43)) - Registering service BackgroundPipelineCreator.
2021-10-05 13:25:47,591 [Listener at 0.0.0.0/12133] INFO  pipeline.BackgroundPipelineCreator (BackgroundPipelineCreatorV2.java:start(130)) - Starting RatisPipelineUtilsThread.
2021-10-05 13:25:47,608 [Listener at 0.0.0.0/12133] INFO  algorithms.PipelineChoosePolicyFactory (PipelineChoosePolicyFactory.java:createPipelineChoosePolicyFromClass(73)) - Create pipeline choose policy of type org.apache.hadoop.hdds.scm.pipeline.choose.algorithms.RandomPipelineChoosePolicy
2021-10-05 13:25:47,608 [Listener at 0.0.0.0/12133] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(43)) - Registering service SCMBlockDeletingService.
2021-10-05 13:25:47,608 [Listener at 0.0.0.0/12133] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(43)) - Registering service ReplicationManager.
2021-10-05 13:25:47,608 [Listener at 0.0.0.0/12133] INFO  container.ReplicationManager (ReplicationManager.java:start(319)) - Starting Replication Monitor Thread.
2021-10-05 13:25:47,619 [Listener at 0.0.0.0/12133] INFO  safemode.ContainerSafeModeRule (ContainerSafeModeRule.java:<init>(89)) - containers with one replica threshold count 0
2021-10-05 13:25:47,620 [Listener at 0.0.0.0/12133] INFO  safemode.HealthyPipelineSafeModeRule (HealthyPipelineSafeModeRule.java:initializeRule(156)) - Total pipeline count is 0, healthy pipeline threshold count is 1
2021-10-05 13:25:47,620 [Listener at 0.0.0.0/12133] INFO  safemode.OneReplicaPipelineSafeModeRule (OneReplicaPipelineSafeModeRule.java:initializeRule(180)) - Total pipeline count is 0, pipeline's with at least one datanode reported threshold count is 0
2021-10-05 13:25:47,631 [ReplicationMonitor] INFO  container.ReplicationManager (ReplicationManager.java:processAll(371)) - Replication Monitor Thread took 10 milliseconds for processing 0 containers.
2021-10-05 13:25:47,632 [Listener at 0.0.0.0/12133] INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(90)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 2000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false.
2021-10-05 13:25:47,633 [Socket Reader #1 for port 12141] INFO  ipc.Server (Server.java:run(1265)) - Starting Socket Reader #1 for port 12141
2021-10-05 13:25:47,634 [Listener at 0.0.0.0/12141] INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(90)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 2000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false.
2021-10-05 13:25:47,634 [Socket Reader #1 for port 12142] INFO  ipc.Server (Server.java:run(1265)) - Starting Socket Reader #1 for port 12142
2021-10-05 13:25:47,635 [Listener at 0.0.0.0/12142] INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(90)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 2000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false.
2021-10-05 13:25:47,636 [Socket Reader #1 for port 12143] INFO  ipc.Server (Server.java:run(1265)) - Starting Socket Reader #1 for port 12143
2021-10-05 13:25:47,684 [Listener at 0.0.0.0/12143] INFO  algorithms.ContainerPlacementPolicyFactory (ContainerPlacementPolicyFactory.java:getPolicy(60)) - Create container placement policy of type org.apache.hadoop.hdds.scm.container.placement.algorithms.SCMContainerPlacementRandom
2021-10-05 13:25:47,686 [Listener at 0.0.0.0/12143] INFO  server.StorageContainerManager (StorageContainerManager.java:<init>(388)) - 
Container Balancer status:
Key                            Value
Running                        false
Container Balancer Configuration values:
Key                                                Value
Threshold                                          0.1
Max Datanodes to Involve per Iteration(ratio)      0.2
Max Size to Move per Iteration                     32212254720B

2021-10-05 13:25:47,686 [Listener at 0.0.0.0/12143] WARN  events.EventQueue (EventQueue.java:fireEvent(194)) - No event handler registered for event TypedEvent{payloadType=SafeModeStatus, name='Safe mode status'}
2021-10-05 13:25:47,686 [Listener at 0.0.0.0/12143] INFO  ha.SCMContext (SCMContext.java:updateSafeModeStatus(205)) - Update SafeModeStatus from SafeModeStatus{safeModeStatus=true, preCheckPassed=false} to SafeModeStatus{safeModeStatus=true, preCheckPassed=false}.
2021-10-05 13:25:47,687 [Listener at 0.0.0.0/12143] INFO  ozone.MiniOzoneHAClusterImpl (MiniOzoneHAClusterImpl.java:createSCMService(568)) - Intialized SCM at org.apache.hadoop.hdds.scm.server.SCMClientProtocolServer@4196a44a. This SCM is currently inactive (not running).
2021-10-05 13:25:47,693 [Listener at 0.0.0.0/12143] INFO  ha.OMHANodeDetails (OMHANodeDetails.java:loadOMHAConfig(118)) - ServiceID for OzoneManager is om-service-test1
2021-10-05 13:25:47,699 [Listener at 0.0.0.0/12143] INFO  ha.OMHANodeDetails (OMHANodeDetails.java:loadOMHAConfig(194)) - Found matching OM address with OMServiceId: om-service-test1, OMNodeId: omNode-1, RPC Address: localhost:10516 and Ratis port: 10520
2021-10-05 13:25:47,699 [Listener at 0.0.0.0/12143] INFO  ha.OMHANodeDetails (ConfUtils.java:setNodeSpecificConfigs(108)) - Setting configuration key ozone.om.http-address with value of key ozone.om.http-address.om-service-test1.omNode-1: 127.0.0.1:10518
2021-10-05 13:25:47,699 [Listener at 0.0.0.0/12143] INFO  ha.OMHANodeDetails (ConfUtils.java:setNodeSpecificConfigs(108)) - Setting configuration key ozone.om.https-address with value of key ozone.om.https-address.om-service-test1.omNode-1: 127.0.0.1:10519
2021-10-05 13:25:47,700 [Listener at 0.0.0.0/12143] INFO  ha.OMHANodeDetails (ConfUtils.java:setNodeSpecificConfigs(108)) - Setting configuration key ozone.om.address with value of key ozone.om.address.om-service-test1.omNode-1: 127.0.0.1:10516
2021-10-05 13:25:47,700 [Listener at 0.0.0.0/12143] WARN  server.ServerUtils (ServerUtils.java:getDBPath(225)) - ozone.om.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2021-10-05 13:25:47,700 [Listener at 0.0.0.0/12143] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.client.port appended with serviceId and nodeId
2021-10-05 13:25:47,701 [Listener at 0.0.0.0/12143] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.block.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.block.client.port appended with serviceId and nodeId
2021-10-05 13:25:47,701 [Listener at 0.0.0.0/12143] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.datanode.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.datanode.port appended with serviceId and nodeId
2021-10-05 13:25:47,701 [Listener at 0.0.0.0/12143] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.client.port appended with serviceId and nodeId
2021-10-05 13:25:47,701 [Listener at 0.0.0.0/12143] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.block.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.block.client.port appended with serviceId and nodeId
2021-10-05 13:25:47,701 [Listener at 0.0.0.0/12143] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.datanode.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.datanode.port appended with serviceId and nodeId
2021-10-05 13:25:47,701 [Listener at 0.0.0.0/12143] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.client.port appended with serviceId and nodeId
2021-10-05 13:25:47,701 [Listener at 0.0.0.0/12143] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.block.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.block.client.port appended with serviceId and nodeId
2021-10-05 13:25:47,701 [Listener at 0.0.0.0/12143] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.datanode.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.datanode.port appended with serviceId and nodeId
OM initialization succeeded.Current cluster id for sd=/home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-62d231c0-d845-4dcd-88aa-c082e017c57e/omNode-1/om;cid=62d231c0-d845-4dcd-88aa-c082e017c57e;layoutVersion=0
2021-10-05 13:25:47,726 [Listener at 0.0.0.0/12143] INFO  ha.OMHANodeDetails (OMHANodeDetails.java:loadOMHAConfig(118)) - ServiceID for OzoneManager is om-service-test1
2021-10-05 13:25:47,726 [Listener at 0.0.0.0/12143] INFO  ha.OMHANodeDetails (OMHANodeDetails.java:loadOMHAConfig(194)) - Found matching OM address with OMServiceId: om-service-test1, OMNodeId: omNode-1, RPC Address: localhost:10516 and Ratis port: 10520
2021-10-05 13:25:47,727 [Listener at 0.0.0.0/12143] INFO  ha.OMHANodeDetails (ConfUtils.java:setNodeSpecificConfigs(108)) - Setting configuration key ozone.om.http-address with value of key ozone.om.http-address.om-service-test1.omNode-1: 127.0.0.1:10518
2021-10-05 13:25:47,731 [Listener at 0.0.0.0/12143] INFO  ha.OMHANodeDetails (ConfUtils.java:setNodeSpecificConfigs(108)) - Setting configuration key ozone.om.https-address with value of key ozone.om.https-address.om-service-test1.omNode-1: 127.0.0.1:10519
2021-10-05 13:25:47,731 [Listener at 0.0.0.0/12143] INFO  ha.OMHANodeDetails (ConfUtils.java:setNodeSpecificConfigs(108)) - Setting configuration key ozone.om.address with value of key ozone.om.address.om-service-test1.omNode-1: 127.0.0.1:10516
2021-10-05 13:25:47,731 [Listener at 0.0.0.0/12143] WARN  server.ServerUtils (ServerUtils.java:getDBPath(225)) - ozone.om.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2021-10-05 13:25:47,732 [Listener at 0.0.0.0/12143] INFO  upgrade.AbstractLayoutVersionManager (AbstractLayoutVersionManager.java:init(79)) - Initializing Layout version manager with metadata layout = INITIAL_VERSION (version = 0), software layout = INITIAL_VERSION (version = 0)
2021-10-05 13:25:47,779 [EndpointStateMachine task thread for /127.0.0.1:15041 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15041. Already tried 9 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:47,810 [EndpointStateMachine task thread for /127.0.0.1:13549 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:13549. Already tried 0 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:47,813 [EndpointStateMachine task thread for /127.0.0.1:13529 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:13529. Already tried 0 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:47,843 [Listener at 0.0.0.0/12143] INFO  reflections.Reflections (Reflections.java:scan(232)) - Reflections took 110 ms to scan 2 urls, producing 131 keys and 342 values [using 2 cores]
2021-10-05 13:25:47,843 [Listener at 0.0.0.0/12143] INFO  upgrade.OMLayoutVersionManager (OMLayoutVersionManager.java:lambda$0(115)) - Skipping Upgrade Action MockOmUpgradeAction since it has been finalized.
2021-10-05 13:25:47,844 [Listener at 0.0.0.0/12143] WARN  server.ServerUtils (ServerUtils.java:getDBPath(225)) - ozone.om.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2021-10-05 13:25:47,844 [Listener at 0.0.0.0/12143] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.client.port appended with serviceId and nodeId
2021-10-05 13:25:47,844 [Listener at 0.0.0.0/12143] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.block.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.block.client.port appended with serviceId and nodeId
2021-10-05 13:25:47,844 [Listener at 0.0.0.0/12143] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.datanode.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.datanode.port appended with serviceId and nodeId
2021-10-05 13:25:47,844 [Listener at 0.0.0.0/12143] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.client.port appended with serviceId and nodeId
2021-10-05 13:25:47,844 [Listener at 0.0.0.0/12143] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.block.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.block.client.port appended with serviceId and nodeId
2021-10-05 13:25:47,844 [Listener at 0.0.0.0/12143] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.datanode.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.datanode.port appended with serviceId and nodeId
2021-10-05 13:25:47,844 [Listener at 0.0.0.0/12143] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.client.port appended with serviceId and nodeId
2021-10-05 13:25:47,844 [Listener at 0.0.0.0/12143] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.block.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.block.client.port appended with serviceId and nodeId
2021-10-05 13:25:47,845 [Listener at 0.0.0.0/12143] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.datanode.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.datanode.port appended with serviceId and nodeId
2021-10-05 13:25:47,845 [Listener at 0.0.0.0/12143] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.client.port appended with serviceId and nodeId
2021-10-05 13:25:47,845 [Listener at 0.0.0.0/12143] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.block.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.block.client.port appended with serviceId and nodeId
2021-10-05 13:25:47,845 [Listener at 0.0.0.0/12143] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.datanode.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.datanode.port appended with serviceId and nodeId
2021-10-05 13:25:47,845 [Listener at 0.0.0.0/12143] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.client.port appended with serviceId and nodeId
2021-10-05 13:25:47,845 [Listener at 0.0.0.0/12143] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.block.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.block.client.port appended with serviceId and nodeId
2021-10-05 13:25:47,845 [EndpointStateMachine task thread for /127.0.0.1:15031 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15031. Already tried 13 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:47,845 [Listener at 0.0.0.0/12143] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.datanode.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.datanode.port appended with serviceId and nodeId
2021-10-05 13:25:47,845 [Listener at 0.0.0.0/12143] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.client.port appended with serviceId and nodeId
2021-10-05 13:25:47,846 [Listener at 0.0.0.0/12143] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.block.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.block.client.port appended with serviceId and nodeId
2021-10-05 13:25:47,846 [Listener at 0.0.0.0/12143] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.datanode.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.datanode.port appended with serviceId and nodeId
2021-10-05 13:25:47,846 [Listener at 0.0.0.0/12143] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.client.port appended with serviceId and nodeId
2021-10-05 13:25:47,846 [Listener at 0.0.0.0/12143] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.block.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.block.client.port appended with serviceId and nodeId
2021-10-05 13:25:47,847 [Listener at 0.0.0.0/12143] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.datanode.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.datanode.port appended with serviceId and nodeId
2021-10-05 13:25:47,847 [Listener at 0.0.0.0/12143] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.client.port appended with serviceId and nodeId
2021-10-05 13:25:47,847 [Listener at 0.0.0.0/12143] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.block.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.block.client.port appended with serviceId and nodeId
2021-10-05 13:25:47,847 [Listener at 0.0.0.0/12143] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.datanode.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.datanode.port appended with serviceId and nodeId
2021-10-05 13:25:47,847 [Listener at 0.0.0.0/12143] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.client.port appended with serviceId and nodeId
2021-10-05 13:25:47,847 [Listener at 0.0.0.0/12143] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.block.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.block.client.port appended with serviceId and nodeId
2021-10-05 13:25:47,847 [Listener at 0.0.0.0/12143] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.datanode.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.datanode.port appended with serviceId and nodeId
2021-10-05 13:25:47,848 [EndpointStateMachine task thread for /127.0.0.1:15021 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15021. Already tried 13 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:47,879 [Listener at 0.0.0.0/12143] WARN  server.ServerUtils (ServerUtils.java:getDBPath(225)) - ozone.om.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2021-10-05 13:25:47,880 [Listener at 0.0.0.0/12143] INFO  codec.OmKeyInfoCodec (OmKeyInfoCodec.java:<init>(51)) - OmKeyInfoCodec ignorePipeline = true
2021-10-05 13:25:47,880 [Listener at 0.0.0.0/12143] INFO  codec.RepeatedOmKeyInfoCodec (RepeatedOmKeyInfoCodec.java:<init>(42)) - RepeatedOmKeyInfoCodec ignorePipeline = true
2021-10-05 13:25:47,958 [EndpointStateMachine task thread for /127.0.0.1:13539 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:13539. Already tried 14 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:48,164 [Listener at 0.0.0.0/12143] INFO  om.OzoneManager (OzoneManager.java:addS3GVolumeToDB(4127)) - Created Volume s3v With Owner runner required for S3Gateway operations.
2021-10-05 13:25:48,164 [Listener at 0.0.0.0/12143] WARN  server.ServerUtils (ServerUtils.java:getDefaultRatisDirectory(237)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2021-10-05 13:25:48,165 [Listener at 0.0.0.0/12143] WARN  utils.OzoneManagerRatisUtils (OzoneManagerRatisUtils.java:getOMRatisSnapshotDirectory(435)) - ozone.om.ratis.snapshot.dir is not configured. Falling back to ozone.metadata.dirs config
2021-10-05 13:25:48,165 [Listener at 0.0.0.0/12143] WARN  impl.MetricRegistriesImpl (MetricRegistriesImpl.java:addReporterRegistration(111)) - New reporters are added after registries were created. Some metrics will be missing from the reporter. Please add reporter before adding any new registry.
2021-10-05 13:25:48,165 [Listener at 0.0.0.0/12143] WARN  impl.MetricRegistriesImpl (MetricRegistriesImpl.java:addReporterRegistration(111)) - New reporters are added after registries were created. Some metrics will be missing from the reporter. Please add reporter before adding any new registry.
2021-10-05 13:25:48,165 [Listener at 0.0.0.0/12143] WARN  server.ServerUtils (ServerUtils.java:getDefaultRatisDirectory(237)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2021-10-05 13:25:48,166 [Listener at 0.0.0.0/12143] INFO  ratis.OzoneManagerRatisServer (OzoneManagerRatisServer.java:<init>(158)) - Instantiating OM Ratis server with groupID: om-service-test1 and peers: localhost:10520
2021-10-05 13:25:48,167 [Listener at 0.0.0.0/12143] INFO  ratis.OzoneManagerStateMachine (OzoneManagerStateMachine.java:loadSnapshotInfoFromDB(605)) - LastAppliedIndex is set from TransactionInfo from OM DB as (t:0, i:~)
2021-10-05 13:25:48,172 [Listener at 0.0.0.0/12143] INFO  server.RaftServer (ConfUtils.java:logGet(44)) - raft.rpc.type = GRPC (default)
2021-10-05 13:25:48,172 [Listener at 0.0.0.0/12143] INFO  grpc.GrpcFactory (GrpcFactory.java:checkPooledByteBufAllocatorUseCacheForAllThreads(48)) - PERFORMANCE WARNING: useCacheForAllThreads is true that may cause Netty to create a lot garbage objects and, as a result, trigger GC.
	It is recommended to disable useCacheForAllThreads by setting -Dorg.apache.ratis.thirdparty.io.netty.allocator.useCacheForAllThreads=false in command line.
2021-10-05 13:25:48,172 [Listener at 0.0.0.0/12143] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(44)) - raft.grpc.admin.port = -1 (default)
2021-10-05 13:25:48,172 [Listener at 0.0.0.0/12143] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(44)) - raft.grpc.server.port = 10520 (custom)
2021-10-05 13:25:48,172 [Listener at 0.0.0.0/12143] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(44)) - raft.grpc.client.port = -1 (default)
2021-10-05 13:25:48,172 [Listener at 0.0.0.0/12143] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(44)) - raft.grpc.server.port = 10520 (custom)
2021-10-05 13:25:48,173 [Listener at 0.0.0.0/12143] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(44)) - raft.grpc.server.port = 10520 (custom)
2021-10-05 13:25:48,173 [Listener at 0.0.0.0/12143] INFO  server.GrpcService (ConfUtils.java:logGet(44)) - raft.grpc.message.size.max = 33554432 (custom)
2021-10-05 13:25:48,173 [Listener at 0.0.0.0/12143] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2021-10-05 13:25:48,173 [Listener at 0.0.0.0/12143] INFO  server.GrpcService (ConfUtils.java:logGet(44)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2021-10-05 13:25:48,173 [Listener at 0.0.0.0/12143] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.request.timeout = 3000ms (default)
2021-10-05 13:25:48,174 [Listener at 0.0.0.0/12143] INFO  impl.DataStreamServerImpl (ConfUtils.java:logGet(44)) - raft.datastream.type = DISABLED (default)
2021-10-05 13:25:48,175 [Listener at 0.0.0.0/12143] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.slowness.timeout = 2s (custom)
2021-10-05 13:25:48,175 [Listener at 0.0.0.0/12143] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.leaderelection.leader.step-down.wait-time = 10s (default)
2021-10-05 13:25:48,175 [Listener at 0.0.0.0/12143] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.storage.dir = [/home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-62d231c0-d845-4dcd-88aa-c082e017c57e/omNode-1/ratis] (custom)
2021-10-05 13:25:48,180 [Listener at 0.0.0.0/12143] INFO  server.RaftServer (RaftServerProxy.java:addNew(95)) - omNode-1: addNew group-523986131536:[omNode-1|rpc:localhost:10520|priority:0] returns group-523986131536:java.util.concurrent.CompletableFuture@77e7e759[Not completed]
2021-10-05 13:25:48,180 [Listener at 0.0.0.0/12143] INFO  om.OzoneManager (OzoneManager.java:initializeRatisServer(1585)) - OzoneManager Ratis server initialized at port 10520
2021-10-05 13:25:48,181 [Listener at 0.0.0.0/12143] INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(90)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 2000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false.
2021-10-05 13:25:48,182 [pool-420-thread-1] INFO  server.RaftServer$Division (RaftServerImpl.java:<init>(181)) - omNode-1: new RaftServerImpl for group-523986131536:[omNode-1|rpc:localhost:10520|priority:0] with OzoneManagerStateMachine:uninitialized
2021-10-05 13:25:48,187 [pool-420-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.timeout.min = 1s (custom)
2021-10-05 13:25:48,188 [pool-420-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.timeout.max = 1200ms (custom)
2021-10-05 13:25:48,188 [pool-420-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.sleep.time = 25ms (default)
2021-10-05 13:25:48,188 [pool-420-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.slowness.timeout = 2s (custom)
2021-10-05 13:25:48,188 [pool-420-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.leaderelection.leader.step-down.wait-time = 10s (default)
2021-10-05 13:25:48,188 [pool-420-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.sleep.deviation.threshold = 300ms (default)
2021-10-05 13:25:48,188 [pool-420-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.appender.install.snapshot.enabled = false (custom)
2021-10-05 13:25:48,188 [pool-420-thread-1] INFO  server.RaftServer$Division (ServerState.java:<init>(105)) - omNode-1@group-523986131536: ConfigurationManager, init=-1: [omNode-1|rpc:localhost:10520|priority:0], old=null, confs=<EMPTY_MAP>
2021-10-05 13:25:48,188 [pool-420-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.storage.dir = [/home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-62d231c0-d845-4dcd-88aa-c082e017c57e/omNode-1/ratis] (custom)
2021-10-05 13:25:48,188 [pool-420-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.corruption.policy = EXCEPTION (default)
2021-10-05 13:25:48,188 [pool-420-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.storage.free-space.min = 0MB (=0) (default)
2021-10-05 13:25:48,188 [pool-420-thread-1] INFO  storage.RaftStorageDirectory (RaftStorageDirectoryImpl.java:analyzeStorage(135)) - The storage directory /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-62d231c0-d845-4dcd-88aa-c082e017c57e/omNode-1/ratis/c9bc4cf4-3bc3-3c60-a66b-523986131536 does not exist. Creating ...
2021-10-05 13:25:48,190 [Socket Reader #1 for port 10516] INFO  ipc.Server (Server.java:run(1265)) - Starting Socket Reader #1 for port 10516
2021-10-05 13:25:48,191 [pool-420-thread-1] INFO  storage.RaftStorageDirectory (RaftStorageDirectoryImpl.java:tryLock(230)) - Lock on /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-62d231c0-d845-4dcd-88aa-c082e017c57e/omNode-1/ratis/c9bc4cf4-3bc3-3c60-a66b-523986131536/in_use.lock acquired by nodename 17451@fv-az270-324
2021-10-05 13:25:48,192 [pool-420-thread-1] INFO  storage.RaftStorage (RaftStorageImpl.java:format(89)) - Storage directory /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-62d231c0-d845-4dcd-88aa-c082e017c57e/omNode-1/ratis/c9bc4cf4-3bc3-3c60-a66b-523986131536 has been successfully formatted.
2021-10-05 13:25:48,197 [pool-420-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.notification.no-leader.timeout = 2s (custom)
2021-10-05 13:25:48,197 [pool-420-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.use.memory = false (default)
2021-10-05 13:25:48,197 [pool-420-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.purge.gap = 1000000 (custom)
2021-10-05 13:25:48,197 [pool-420-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2021-10-05 13:25:48,197 [pool-420-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.segment.size.max = 4194304 (custom)
2021-10-05 13:25:48,198 [pool-420-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.segment.cache.num.max = 2 (custom)
2021-10-05 13:25:48,198 [pool-420-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.segment.cache.size.max = 200MB (=209715200) (default)
2021-10-05 13:25:48,198 [pool-420-thread-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:<init>(182)) - new omNode-1@group-523986131536-SegmentedRaftLogWorker for RaftStorageImpl:Storage Directory /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-62d231c0-d845-4dcd-88aa-c082e017c57e/omNode-1/ratis/c9bc4cf4-3bc3-3c60-a66b-523986131536
2021-10-05 13:25:48,198 [pool-420-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.queue.byte-limit = 64MB (=67108864) (default)
2021-10-05 13:25:48,198 [pool-420-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.queue.element-limit = 4096 (default)
2021-10-05 13:25:48,198 [pool-420-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.segment.size.max = 4194304 (custom)
2021-10-05 13:25:48,198 [pool-420-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.preallocated.size = 4194304 (custom)
2021-10-05 13:25:48,198 [pool-420-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.force.sync.num = 128 (default)
2021-10-05 13:25:48,198 [pool-420-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.statemachine.data.sync = true (default)
2021-10-05 13:25:48,198 [pool-420-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2021-10-05 13:25:48,198 [pool-420-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2021-10-05 13:25:48,204 [pool-420-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.write.buffer.size = 64KB (=65536) (default)
2021-10-05 13:25:48,204 [pool-420-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.statemachine.data.caching.enabled = false (default)
2021-10-05 13:25:48,207 [pool-420-thread-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:lambda$new$0(133)) - omNode-1@group-523986131536-SegmentedRaftLogWorker: flushIndex: setUnconditionally 0 -> -1
2021-10-05 13:25:48,207 [pool-420-thread-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:lambda$new$0(133)) - omNode-1@group-523986131536-SegmentedRaftLogWorker: safeCacheEvictIndex: setUnconditionally 0 -> -1
2021-10-05 13:25:48,227 [pool-420-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2021-10-05 13:25:48,227 [pool-420-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.snapshot.auto.trigger.threshold = 400000 (default)
2021-10-05 13:25:48,227 [pool-420-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.snapshot.retention.file.num = -1 (default)
2021-10-05 13:25:48,227 [pool-420-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.purge.upto.snapshot.index = true (custom)
2021-10-05 13:25:48,227 [pool-420-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.retrycache.expirytime = 300s (custom)
2021-10-05 13:25:48,227 [pool-420-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.retrycache.statistics.expirytime = 100μs (default)
2021-10-05 13:25:48,245 [Listener at 127.0.0.1/10516] INFO  om.OzoneManager (OzoneManager.java:initFSOLayout(4333)) - Configured ozone.om.metadata.layout=SIMPLE and disabled optimized OM FS operations
2021-10-05 13:25:48,246 [Listener at 127.0.0.1/10516] INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:init(158)) - OzoneManager metrics system started (again)
2021-10-05 13:25:48,267 [Listener at 127.0.0.1/10516] INFO  om.OzoneManager (OzoneManager.java:start(1281)) - OzoneManager RPC server is listening at localhost/127.0.0.1:10516
2021-10-05 13:25:48,271 [Listener at 127.0.0.1/10516] INFO  ratis.OzoneManagerRatisServer (OzoneManagerRatisServer.java:start(516)) - Starting OzoneManagerRatisServer omNode-1 at port 10520
2021-10-05 13:25:48,271 [Listener at 127.0.0.1/10516] INFO  server.RaftServer$Division (RaftServerImpl.java:start(296)) - omNode-1@group-523986131536: start as a follower, conf=-1: [omNode-1|rpc:localhost:10520|priority:0], old=null
2021-10-05 13:25:48,271 [Listener at 127.0.0.1/10516] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(285)) - omNode-1@group-523986131536: changes role from      null to FOLLOWER at term 0 for startAsFollower
2021-10-05 13:25:48,271 [Listener at 127.0.0.1/10516] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(130)) - omNode-1: start omNode-1@group-523986131536-FollowerState
2021-10-05 13:25:48,272 [Listener at 127.0.0.1/10516] INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-523986131536,id=omNode-1
2021-10-05 13:25:48,272 [Listener at 127.0.0.1/10516] INFO  server.RaftServer (RaftServerProxy.java:lambda$start$5(374)) - omNode-1: start RPC server
2021-10-05 13:25:48,276 [Listener at 127.0.0.1/10516] INFO  server.GrpcService (GrpcService.java:startImpl(253)) - omNode-1: GrpcService started, listening on 10520
2021-10-05 13:25:48,287 [Listener at 127.0.0.1/10516] INFO  om.OzoneManager (OzoneManager.java:start(1299)) - Version File has different layout version (0) than OM DB (null). That is expected if this OM has never been finalized to a newer layout version.
2021-10-05 13:25:48,287 [org.apache.ratis.util.JvmPauseMonitor$$Lambda$499/1586779822@37107ea0] INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(103)) - JvmPauseMonitor-omNode-1: Started
2021-10-05 13:25:48,293 [Listener at 127.0.0.1/10516] INFO  http.BaseHttpServer (BaseHttpServer.java:newHttpServer2BuilderForOzone(209)) - Starting Web-server for ozoneManager at: http://0.0.0.0:10518
2021-10-05 13:25:48,293 [Listener at 127.0.0.1/10516] INFO  http.BaseHttpServer (BaseHttpServer.java:<init>(107)) - Hadoop Security Enabled: false Ozone Security Enabled: false Ozone HTTP Security Enabled: false 
2021-10-05 13:25:48,294 [Listener at 127.0.0.1/10516] INFO  server.AuthenticationFilter (AuthenticationFilter.java:constructSecretProvider(240)) - Unable to initialize FileSignerSecretProvider, falling back to use random secrets.
2021-10-05 13:25:48,317 [Listener at 127.0.0.1/10516] WARN  http.HttpRequestLog (HttpRequestLog.java:getRequestLog(103)) - Jetty request log can only be enabled using Log4j
2021-10-05 13:25:48,318 [Listener at 127.0.0.1/10516] INFO  http.HttpServer2 (HttpServer2.java:addGlobalFilter(1030)) - Added global filter 'safety' (class=org.apache.hadoop.hdds.server.http.HttpServer2$QuotingInputFilter)
2021-10-05 13:25:48,319 [Listener at 127.0.0.1/10516] INFO  http.HttpServer2 (HttpServer2.java:addFilter(1006)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context ozoneManager
2021-10-05 13:25:48,319 [Listener at 127.0.0.1/10516] INFO  http.HttpServer2 (HttpServer2.java:addFilter(1014)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context logs
2021-10-05 13:25:48,319 [Listener at 127.0.0.1/10516] INFO  http.HttpServer2 (HttpServer2.java:addFilter(1014)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context static
2021-10-05 13:25:48,319 [Listener at 127.0.0.1/10516] INFO  http.HttpServer2 (HttpServer2.java:bindListener(1249)) - Jetty bound to port 10518
2021-10-05 13:25:48,320 [Listener at 127.0.0.1/10516] INFO  server.Server (Server.java:doStart(375)) - jetty-9.4.43.v20210629; built: 2021-06-30T11:07:22.254Z; git: 526006ecfa3af7f1a27ef3a288e2bef7ea9dd7e8; jvm 1.8.0_292-b10
2021-10-05 13:25:48,325 [Listener at 127.0.0.1/10516] INFO  server.session (DefaultSessionIdManager.java:doStart(334)) - DefaultSessionIdManager workerName=node0
2021-10-05 13:25:48,325 [Listener at 127.0.0.1/10516] INFO  server.session (DefaultSessionIdManager.java:doStart(339)) - No SessionScavenger set, using defaults
2021-10-05 13:25:48,325 [Listener at 127.0.0.1/10516] INFO  server.session (HouseKeeper.java:startScavenging(132)) - node0 Scavenging every 600000ms
2021-10-05 13:25:48,326 [Listener at 127.0.0.1/10516] INFO  handler.ContextHandler (ContextHandler.java:doStart(915)) - Started o.e.j.s.ServletContextHandler@6b86a5a4{logs,/logs,file:///home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/log,AVAILABLE}
2021-10-05 13:25:48,326 [Listener at 127.0.0.1/10516] INFO  handler.ContextHandler (ContextHandler.java:doStart(915)) - Started o.e.j.s.ServletContextHandler@305c8bf{static,/static,file:///home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-classes/webapps/static,AVAILABLE}
2021-10-05 13:25:48,329 [Listener at 127.0.0.1/10516] INFO  handler.ContextHandler (ContextHandler.java:doStart(915)) - Started o.e.j.w.WebAppContext@79b5a9e6{ozoneManager,/,file:///home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-classes/webapps/ozoneManager/,AVAILABLE}{file:/home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-classes/webapps/ozoneManager}
2021-10-05 13:25:48,347 [Listener at 127.0.0.1/10516] INFO  server.AbstractConnector (AbstractConnector.java:doStart(331)) - Started ServerConnector@2fdece0e{HTTP/1.1, (http/1.1)}{0.0.0.0:10518}
2021-10-05 13:25:48,347 [Listener at 127.0.0.1/10516] INFO  server.Server (Server.java:doStart(415)) - Started @142007ms
2021-10-05 13:25:48,348 [Listener at 127.0.0.1/10516] WARN  impl.MetricsSystemImpl (MetricsSystemImpl.java:register(279)) - Sink prometheus already exists!
2021-10-05 13:25:48,351 [Listener at 127.0.0.1/10516] INFO  http.BaseHttpServer (BaseHttpServer.java:updateConnectorAddress(329)) - HTTP server of ozoneManager listening at http://0.0.0.0:10518
2021-10-05 13:25:48,355 [IPC Server Responder] INFO  ipc.Server (Server.java:run(1507)) - IPC Server Responder: starting
2021-10-05 13:25:48,369 [IPC Server listener on 10516] INFO  ipc.Server (Server.java:run(1344)) - IPC Server listener on 10516: starting
2021-10-05 13:25:48,409 [Listener at 127.0.0.1/10516] INFO  om.OzoneManager (OzoneManager.java:startTrashEmptier(1543)) - Trash Interval set to 0. Files deleted will not move to trash
2021-10-05 13:25:48,427 [Listener at 127.0.0.1/10516] INFO  ozone.MiniOzoneHAClusterImpl (MiniOzoneHAClusterImpl.java:createOMService(485)) - Started OzoneManager omNode-1 RPC server at localhost/127.0.0.1:10516
2021-10-05 13:25:48,449 [Listener at 127.0.0.1/10516] WARN  impl.MetricRegistriesImpl (MetricRegistriesImpl.java:addReporterRegistration(111)) - New reporters are added after registries were created. Some metrics will be missing from the reporter. Please add reporter before adding any new registry.
2021-10-05 13:25:48,450 [Listener at 127.0.0.1/10516] WARN  impl.MetricRegistriesImpl (MetricRegistriesImpl.java:addReporterRegistration(111)) - New reporters are added after registries were created. Some metrics will be missing from the reporter. Please add reporter before adding any new registry.
2021-10-05 13:25:48,455 [Listener at 127.0.0.1/10516] INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:init(158)) - HddsDatanode metrics system started (again)
2021-10-05 13:25:48,449 [org.apache.hadoop.util.JvmPauseMonitor$Monitor@54bb5dd0] INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(188)) - Starting JVM pause monitor
2021-10-05 13:25:48,470 [Listener at 127.0.0.1/10516] INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:start(234)) - HddsDatanodeService host:fv-az270-324.tacnzluakwdehk1hpragurqkma.bx.internal.cloudapp.net ip:10.1.0.10
2021-10-05 13:25:48,521 [Listener at 127.0.0.1/10516] INFO  upgrade.AbstractLayoutVersionManager (AbstractLayoutVersionManager.java:init(79)) - Initializing Layout version manager with metadata layout = SCM_HA (version = 2), software layout = SCM_HA (version = 2)
2021-10-05 13:25:48,562 [Listener at 127.0.0.1/10516] INFO  reflections.Reflections (Reflections.java:scan(232)) - Reflections took 40 ms to scan 7 urls, producing 119 keys and 275 values 
2021-10-05 13:25:48,564 [Listener at 127.0.0.1/10516] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.client.port appended with serviceId and nodeId
2021-10-05 13:25:48,564 [Listener at 127.0.0.1/10516] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.block.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.block.client.port appended with serviceId and nodeId
2021-10-05 13:25:48,564 [Listener at 127.0.0.1/10516] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.datanode.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.datanode.port appended with serviceId and nodeId
2021-10-05 13:25:48,564 [Listener at 127.0.0.1/10516] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.client.port appended with serviceId and nodeId
2021-10-05 13:25:48,564 [Listener at 127.0.0.1/10516] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.block.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.block.client.port appended with serviceId and nodeId
2021-10-05 13:25:48,564 [Listener at 127.0.0.1/10516] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.datanode.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.datanode.port appended with serviceId and nodeId
2021-10-05 13:25:48,564 [Listener at 127.0.0.1/10516] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.client.port appended with serviceId and nodeId
2021-10-05 13:25:48,564 [Listener at 127.0.0.1/10516] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.block.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.block.client.port appended with serviceId and nodeId
2021-10-05 13:25:48,564 [Listener at 127.0.0.1/10516] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.datanode.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.datanode.port appended with serviceId and nodeId
2021-10-05 13:25:48,565 [Listener at 127.0.0.1/10516] INFO  volume.HddsVolume (HddsVolume.java:<init>(120)) - Creating HddsVolume: /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-62d231c0-d845-4dcd-88aa-c082e017c57e/datanode-0/data-0/containers/hdds of storage type : DISK capacity : 9223372036854775807
2021-10-05 13:25:48,566 [Listener at 127.0.0.1/10516] INFO  volume.MutableVolumeSet (MutableVolumeSet.java:initializeVolumeSet(168)) - Added Volume : /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-62d231c0-d845-4dcd-88aa-c082e017c57e/datanode-0/data-0/containers/hdds to VolumeSet
2021-10-05 13:25:48,566 [Listener at 127.0.0.1/10516] INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(141)) - Scheduling a check for /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-62d231c0-d845-4dcd-88aa-c082e017c57e/datanode-0/data-0/containers/hdds
2021-10-05 13:25:48,566 [Listener at 127.0.0.1/10516] INFO  volume.StorageVolumeChecker (StorageVolumeChecker.java:checkAllVolumes(202)) - Scheduled health check for volume /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-62d231c0-d845-4dcd-88aa-c082e017c57e/datanode-0/data-0/containers/hdds
2021-10-05 13:25:48,578 [Listener at 127.0.0.1/10516] INFO  volume.MutableVolumeSet (MutableVolumeSet.java:initializeVolumeSet(168)) - Added Volume : /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-62d231c0-d845-4dcd-88aa-c082e017c57e/datanode-0/data/ratis to VolumeSet
2021-10-05 13:25:48,578 [Listener at 127.0.0.1/10516] INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(141)) - Scheduling a check for /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-62d231c0-d845-4dcd-88aa-c082e017c57e/datanode-0/data/ratis
2021-10-05 13:25:48,587 [Listener at 127.0.0.1/10516] INFO  volume.StorageVolumeChecker (StorageVolumeChecker.java:checkAllVolumes(202)) - Scheduled health check for volume /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-62d231c0-d845-4dcd-88aa-c082e017c57e/datanode-0/data/ratis
2021-10-05 13:25:48,599 [Thread-2245] INFO  ozoneimpl.ContainerReader (ContainerReader.java:readVolume(172)) - Finish verifying containers on volume /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-62d231c0-d845-4dcd-88aa-c082e017c57e/datanode-0/data-0/containers/hdds
2021-10-05 13:25:48,600 [Listener at 127.0.0.1/10516] INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:buildContainerSet(236)) - Build ContainerSet costs 0s
2021-10-05 13:25:48,601 [Listener at 127.0.0.1/10516] INFO  server.RaftServer (ConfUtils.java:logGet(44)) - raft.rpc.type = GRPC (default)
2021-10-05 13:25:48,602 [Listener at 127.0.0.1/10516] INFO  grpc.GrpcFactory (GrpcFactory.java:checkPooledByteBufAllocatorUseCacheForAllThreads(48)) - PERFORMANCE WARNING: useCacheForAllThreads is true that may cause Netty to create a lot garbage objects and, as a result, trigger GC.
	It is recommended to disable useCacheForAllThreads by setting -Dorg.apache.ratis.thirdparty.io.netty.allocator.useCacheForAllThreads=false in command line.
2021-10-05 13:25:48,602 [Listener at 127.0.0.1/10516] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(44)) - raft.grpc.admin.port = 0 (custom)
2021-10-05 13:25:48,602 [Listener at 127.0.0.1/10516] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(44)) - raft.grpc.client.port = 0 (custom)
2021-10-05 13:25:48,602 [Listener at 127.0.0.1/10516] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(44)) - raft.grpc.server.port = 0 (default)
2021-10-05 13:25:48,602 [Listener at 127.0.0.1/10516] INFO  server.GrpcService (ConfUtils.java:logGet(44)) - raft.grpc.message.size.max = 32MB (=33554432) (custom)
2021-10-05 13:25:48,602 [Listener at 127.0.0.1/10516] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2021-10-05 13:25:48,602 [Listener at 127.0.0.1/10516] INFO  server.GrpcService (ConfUtils.java:logGet(44)) - raft.grpc.flow.control.window = 5MB (=5242880) (custom)
2021-10-05 13:25:48,603 [Listener at 127.0.0.1/10516] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.request.timeout = 60s (custom)
2021-10-05 13:25:48,608 [Listener at 127.0.0.1/10516] INFO  impl.DataStreamServerImpl (ConfUtils.java:logGet(44)) - raft.datastream.type = DISABLED (default)
2021-10-05 13:25:48,608 [Listener at 127.0.0.1/10516] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.slowness.timeout = 300s (custom)
2021-10-05 13:25:48,608 [Listener at 127.0.0.1/10516] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.leaderelection.leader.step-down.wait-time = 10s (default)
2021-10-05 13:25:48,608 [Listener at 127.0.0.1/10516] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.storage.dir = [/home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-62d231c0-d845-4dcd-88aa-c082e017c57e/datanode-0/data/ratis] (custom)
2021-10-05 13:25:48,617 [Listener at 127.0.0.1/10516] INFO  http.BaseHttpServer (BaseHttpServer.java:newHttpServer2BuilderForOzone(209)) - Starting Web-server for hddsDatanode at: http://0.0.0.0:0
2021-10-05 13:25:48,617 [Listener at 127.0.0.1/10516] INFO  http.BaseHttpServer (BaseHttpServer.java:<init>(107)) - Hadoop Security Enabled: false Ozone Security Enabled: false Ozone HTTP Security Enabled: false 
2021-10-05 13:25:48,618 [Listener at 127.0.0.1/10516] INFO  server.AuthenticationFilter (AuthenticationFilter.java:constructSecretProvider(240)) - Unable to initialize FileSignerSecretProvider, falling back to use random secrets.
2021-10-05 13:25:48,619 [Listener at 127.0.0.1/10516] WARN  http.HttpRequestLog (HttpRequestLog.java:getRequestLog(103)) - Jetty request log can only be enabled using Log4j
2021-10-05 13:25:48,621 [Listener at 127.0.0.1/10516] INFO  http.HttpServer2 (HttpServer2.java:addGlobalFilter(1030)) - Added global filter 'safety' (class=org.apache.hadoop.hdds.server.http.HttpServer2$QuotingInputFilter)
2021-10-05 13:25:48,621 [Listener at 127.0.0.1/10516] INFO  http.HttpServer2 (HttpServer2.java:addFilter(1006)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context hddsDatanode
2021-10-05 13:25:48,622 [Listener at 127.0.0.1/10516] INFO  http.HttpServer2 (HttpServer2.java:addFilter(1014)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context logs
2021-10-05 13:25:48,622 [Listener at 127.0.0.1/10516] INFO  http.HttpServer2 (HttpServer2.java:addFilter(1014)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context static
2021-10-05 13:25:48,622 [Listener at 127.0.0.1/10516] INFO  http.HttpServer2 (HttpServer2.java:bindListener(1249)) - Jetty bound to port 35857
2021-10-05 13:25:48,622 [Listener at 127.0.0.1/10516] INFO  server.Server (Server.java:doStart(375)) - jetty-9.4.43.v20210629; built: 2021-06-30T11:07:22.254Z; git: 526006ecfa3af7f1a27ef3a288e2bef7ea9dd7e8; jvm 1.8.0_292-b10
2021-10-05 13:25:48,652 [Listener at 127.0.0.1/10516] INFO  server.session (DefaultSessionIdManager.java:doStart(334)) - DefaultSessionIdManager workerName=node0
2021-10-05 13:25:48,652 [Listener at 127.0.0.1/10516] INFO  server.session (DefaultSessionIdManager.java:doStart(339)) - No SessionScavenger set, using defaults
2021-10-05 13:25:48,652 [Listener at 127.0.0.1/10516] INFO  server.session (HouseKeeper.java:startScavenging(132)) - node0 Scavenging every 660000ms
2021-10-05 13:25:48,653 [Listener at 127.0.0.1/10516] INFO  handler.ContextHandler (ContextHandler.java:doStart(915)) - Started o.e.j.s.ServletContextHandler@1fbbc139{logs,/logs,file:///home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/log,AVAILABLE}
2021-10-05 13:25:48,654 [Listener at 127.0.0.1/10516] INFO  handler.ContextHandler (ContextHandler.java:doStart(915)) - Started o.e.j.s.ServletContextHandler@210b558d{static,/static,jar:file:/home/runner/.m2/repository/org/apache/ozone/hdds-container-service/1.2.0-SNAPSHOT/hdds-container-service-1.2.0-SNAPSHOT.jar!/webapps/static,AVAILABLE}
2021-10-05 13:25:48,749 [Listener at 127.0.0.1/10516] INFO  handler.ContextHandler (ContextHandler.java:doStart(915)) - Started o.e.j.w.WebAppContext@2b96d5ea{hddsDatanode,/,file:///tmp/jetty-0_0_0_0-35857-hdds-container-service-1_2_0-SNAPSHOT_jar-_-any-6682128934842722788/webapp/,AVAILABLE}{jar:file:/home/runner/.m2/repository/org/apache/ozone/hdds-container-service/1.2.0-SNAPSHOT/hdds-container-service-1.2.0-SNAPSHOT.jar!/webapps/hddsDatanode}
2021-10-05 13:25:48,752 [Listener at 127.0.0.1/10516] INFO  server.AbstractConnector (AbstractConnector.java:doStart(331)) - Started ServerConnector@3deec5a0{HTTP/1.1, (http/1.1)}{0.0.0.0:35857}
2021-10-05 13:25:48,752 [Listener at 127.0.0.1/10516] INFO  server.Server (Server.java:doStart(415)) - Started @142411ms
2021-10-05 13:25:48,752 [Listener at 127.0.0.1/10516] WARN  impl.MetricsSystemImpl (MetricsSystemImpl.java:register(279)) - Sink prometheus already exists!
2021-10-05 13:25:48,752 [Listener at 127.0.0.1/10516] INFO  http.BaseHttpServer (BaseHttpServer.java:updateConnectorAddress(329)) - HTTP server of hddsDatanode listening at http://0.0.0.0:35857
2021-10-05 13:25:48,753 [Listener at 127.0.0.1/10516] WARN  impl.MetricRegistriesImpl (MetricRegistriesImpl.java:addReporterRegistration(111)) - New reporters are added after registries were created. Some metrics will be missing from the reporter. Please add reporter before adding any new registry.
2021-10-05 13:25:48,753 [Listener at 127.0.0.1/10516] WARN  impl.MetricRegistriesImpl (MetricRegistriesImpl.java:addReporterRegistration(111)) - New reporters are added after registries were created. Some metrics will be missing from the reporter. Please add reporter before adding any new registry.
2021-10-05 13:25:48,753 [Listener at 127.0.0.1/10516] INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:init(158)) - HddsDatanode metrics system started (again)
2021-10-05 13:25:48,756 [Datanode State Machine Thread - 0] INFO  statemachine.DatanodeStateMachine (DatanodeStateMachine.java:lambda$startDaemon$0(456)) - Ozone container server started.
2021-10-05 13:25:48,779 [EndpointStateMachine task thread for /127.0.0.1:15041 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15041. Already tried 10 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:48,791 [Listener at 127.0.0.1/10516] INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:start(234)) - HddsDatanodeService host:fv-az270-324.tacnzluakwdehk1hpragurqkma.bx.internal.cloudapp.net ip:10.1.0.10
2021-10-05 13:25:48,810 [EndpointStateMachine task thread for /127.0.0.1:13549 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:13549. Already tried 1 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:48,813 [EndpointStateMachine task thread for /127.0.0.1:13529 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:13529. Already tried 1 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:48,824 [org.apache.hadoop.util.JvmPauseMonitor$Monitor@789c8a0d] INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(188)) - Starting JVM pause monitor
2021-10-05 13:25:48,824 [Datanode State Machine Task Thread - 0] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.client.port appended with serviceId and nodeId
2021-10-05 13:25:48,824 [Datanode State Machine Task Thread - 0] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.block.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.block.client.port appended with serviceId and nodeId
2021-10-05 13:25:48,824 [Datanode State Machine Task Thread - 0] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.datanode.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.datanode.port appended with serviceId and nodeId
2021-10-05 13:25:48,835 [Datanode State Machine Task Thread - 0] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.client.port appended with serviceId and nodeId
2021-10-05 13:25:48,835 [Datanode State Machine Task Thread - 0] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.block.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.block.client.port appended with serviceId and nodeId
2021-10-05 13:25:48,835 [Datanode State Machine Task Thread - 0] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.datanode.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.datanode.port appended with serviceId and nodeId
2021-10-05 13:25:48,835 [Datanode State Machine Task Thread - 0] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.client.port appended with serviceId and nodeId
2021-10-05 13:25:48,835 [Datanode State Machine Task Thread - 0] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.block.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.block.client.port appended with serviceId and nodeId
2021-10-05 13:25:48,835 [Datanode State Machine Task Thread - 0] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.datanode.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.datanode.port appended with serviceId and nodeId
2021-10-05 13:25:48,847 [Datanode State Machine Task Thread - 0] INFO  datanode.InitDatanodeState (InitDatanodeState.java:persistContainerDatanodeDetails(145)) - DatanodeDetails is persisted to /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-62d231c0-d845-4dcd-88aa-c082e017c57e/datanode-0/meta/datanode.id
2021-10-05 13:25:48,849 [EndpointStateMachine task thread for /127.0.0.1:15021 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15021. Already tried 14 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:48,852 [EndpointStateMachine task thread for /127.0.0.1:15031 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15031. Already tried 14 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:48,868 [Listener at 127.0.0.1/10516] INFO  upgrade.AbstractLayoutVersionManager (AbstractLayoutVersionManager.java:init(79)) - Initializing Layout version manager with metadata layout = SCM_HA (version = 2), software layout = SCM_HA (version = 2)
2021-10-05 13:25:48,940 [Listener at 127.0.0.1/10516] INFO  reflections.Reflections (Reflections.java:scan(232)) - Reflections took 71 ms to scan 7 urls, producing 119 keys and 275 values 
2021-10-05 13:25:48,948 [Listener at 127.0.0.1/10516] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.client.port appended with serviceId and nodeId
2021-10-05 13:25:48,948 [Listener at 127.0.0.1/10516] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.block.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.block.client.port appended with serviceId and nodeId
2021-10-05 13:25:48,948 [Listener at 127.0.0.1/10516] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.datanode.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.datanode.port appended with serviceId and nodeId
2021-10-05 13:25:48,949 [Listener at 127.0.0.1/10516] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.client.port appended with serviceId and nodeId
2021-10-05 13:25:48,949 [Listener at 127.0.0.1/10516] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.block.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.block.client.port appended with serviceId and nodeId
2021-10-05 13:25:48,949 [Listener at 127.0.0.1/10516] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.datanode.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.datanode.port appended with serviceId and nodeId
2021-10-05 13:25:48,949 [Listener at 127.0.0.1/10516] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.client.port appended with serviceId and nodeId
2021-10-05 13:25:48,949 [Listener at 127.0.0.1/10516] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.block.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.block.client.port appended with serviceId and nodeId
2021-10-05 13:25:48,949 [Listener at 127.0.0.1/10516] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.datanode.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.datanode.port appended with serviceId and nodeId
2021-10-05 13:25:48,950 [Listener at 127.0.0.1/10516] INFO  volume.HddsVolume (HddsVolume.java:<init>(120)) - Creating HddsVolume: /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-62d231c0-d845-4dcd-88aa-c082e017c57e/datanode-1/data-0/containers/hdds of storage type : DISK capacity : 9223372036854775807
2021-10-05 13:25:48,951 [Listener at 127.0.0.1/10516] INFO  volume.MutableVolumeSet (MutableVolumeSet.java:initializeVolumeSet(168)) - Added Volume : /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-62d231c0-d845-4dcd-88aa-c082e017c57e/datanode-1/data-0/containers/hdds to VolumeSet
2021-10-05 13:25:48,951 [Listener at 127.0.0.1/10516] INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(141)) - Scheduling a check for /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-62d231c0-d845-4dcd-88aa-c082e017c57e/datanode-1/data-0/containers/hdds
2021-10-05 13:25:48,955 [Listener at 127.0.0.1/10516] INFO  volume.StorageVolumeChecker (StorageVolumeChecker.java:checkAllVolumes(202)) - Scheduled health check for volume /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-62d231c0-d845-4dcd-88aa-c082e017c57e/datanode-1/data-0/containers/hdds
2021-10-05 13:25:48,958 [EndpointStateMachine task thread for /127.0.0.1:13539 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:13539. Already tried 0 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:48,970 [Listener at 127.0.0.1/10516] INFO  volume.MutableVolumeSet (MutableVolumeSet.java:initializeVolumeSet(168)) - Added Volume : /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-62d231c0-d845-4dcd-88aa-c082e017c57e/datanode-1/data/ratis to VolumeSet
2021-10-05 13:25:48,970 [Listener at 127.0.0.1/10516] INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(141)) - Scheduling a check for /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-62d231c0-d845-4dcd-88aa-c082e017c57e/datanode-1/data/ratis
2021-10-05 13:25:48,971 [Listener at 127.0.0.1/10516] INFO  volume.StorageVolumeChecker (StorageVolumeChecker.java:checkAllVolumes(202)) - Scheduled health check for volume /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-62d231c0-d845-4dcd-88aa-c082e017c57e/datanode-1/data/ratis
2021-10-05 13:25:48,990 [Thread-2259] INFO  ozoneimpl.ContainerReader (ContainerReader.java:readVolume(172)) - Finish verifying containers on volume /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-62d231c0-d845-4dcd-88aa-c082e017c57e/datanode-1/data-0/containers/hdds
2021-10-05 13:25:48,990 [Listener at 127.0.0.1/10516] INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:buildContainerSet(236)) - Build ContainerSet costs 0s
2021-10-05 13:25:48,999 [Listener at 127.0.0.1/10516] INFO  server.RaftServer (ConfUtils.java:logGet(44)) - raft.rpc.type = GRPC (default)
2021-10-05 13:25:49,000 [Listener at 127.0.0.1/10516] INFO  grpc.GrpcFactory (GrpcFactory.java:checkPooledByteBufAllocatorUseCacheForAllThreads(48)) - PERFORMANCE WARNING: useCacheForAllThreads is true that may cause Netty to create a lot garbage objects and, as a result, trigger GC.
	It is recommended to disable useCacheForAllThreads by setting -Dorg.apache.ratis.thirdparty.io.netty.allocator.useCacheForAllThreads=false in command line.
2021-10-05 13:25:49,000 [Listener at 127.0.0.1/10516] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(44)) - raft.grpc.admin.port = 0 (custom)
2021-10-05 13:25:49,000 [Listener at 127.0.0.1/10516] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(44)) - raft.grpc.client.port = 0 (custom)
2021-10-05 13:25:49,000 [Listener at 127.0.0.1/10516] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(44)) - raft.grpc.server.port = 0 (default)
2021-10-05 13:25:49,000 [Listener at 127.0.0.1/10516] INFO  server.GrpcService (ConfUtils.java:logGet(44)) - raft.grpc.message.size.max = 32MB (=33554432) (custom)
2021-10-05 13:25:49,000 [Listener at 127.0.0.1/10516] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2021-10-05 13:25:49,000 [Listener at 127.0.0.1/10516] INFO  server.GrpcService (ConfUtils.java:logGet(44)) - raft.grpc.flow.control.window = 5MB (=5242880) (custom)
2021-10-05 13:25:49,001 [Listener at 127.0.0.1/10516] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.request.timeout = 60s (custom)
2021-10-05 13:25:49,002 [Listener at 127.0.0.1/10516] INFO  impl.DataStreamServerImpl (ConfUtils.java:logGet(44)) - raft.datastream.type = DISABLED (default)
2021-10-05 13:25:49,002 [Listener at 127.0.0.1/10516] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.slowness.timeout = 300s (custom)
2021-10-05 13:25:49,002 [Listener at 127.0.0.1/10516] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.leaderelection.leader.step-down.wait-time = 10s (default)
2021-10-05 13:25:49,002 [Listener at 127.0.0.1/10516] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.storage.dir = [/home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-62d231c0-d845-4dcd-88aa-c082e017c57e/datanode-1/data/ratis] (custom)
2021-10-05 13:25:49,014 [Listener at 127.0.0.1/10516] INFO  http.BaseHttpServer (BaseHttpServer.java:newHttpServer2BuilderForOzone(209)) - Starting Web-server for hddsDatanode at: http://0.0.0.0:0
2021-10-05 13:25:49,014 [Listener at 127.0.0.1/10516] INFO  http.BaseHttpServer (BaseHttpServer.java:<init>(107)) - Hadoop Security Enabled: false Ozone Security Enabled: false Ozone HTTP Security Enabled: false 
2021-10-05 13:25:49,015 [Listener at 127.0.0.1/10516] INFO  server.AuthenticationFilter (AuthenticationFilter.java:constructSecretProvider(240)) - Unable to initialize FileSignerSecretProvider, falling back to use random secrets.
2021-10-05 13:25:49,025 [Listener at 127.0.0.1/10516] WARN  http.HttpRequestLog (HttpRequestLog.java:getRequestLog(103)) - Jetty request log can only be enabled using Log4j
2021-10-05 13:25:49,026 [Listener at 127.0.0.1/10516] INFO  http.HttpServer2 (HttpServer2.java:addGlobalFilter(1030)) - Added global filter 'safety' (class=org.apache.hadoop.hdds.server.http.HttpServer2$QuotingInputFilter)
2021-10-05 13:25:49,026 [Listener at 127.0.0.1/10516] INFO  http.HttpServer2 (HttpServer2.java:addFilter(1006)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context hddsDatanode
2021-10-05 13:25:49,026 [Listener at 127.0.0.1/10516] INFO  http.HttpServer2 (HttpServer2.java:addFilter(1014)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context logs
2021-10-05 13:25:49,027 [Listener at 127.0.0.1/10516] INFO  http.HttpServer2 (HttpServer2.java:addFilter(1014)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context static
2021-10-05 13:25:49,029 [Listener at 127.0.0.1/10516] INFO  http.HttpServer2 (HttpServer2.java:bindListener(1249)) - Jetty bound to port 41649
2021-10-05 13:25:49,029 [Listener at 127.0.0.1/10516] INFO  server.Server (Server.java:doStart(375)) - jetty-9.4.43.v20210629; built: 2021-06-30T11:07:22.254Z; git: 526006ecfa3af7f1a27ef3a288e2bef7ea9dd7e8; jvm 1.8.0_292-b10
2021-10-05 13:25:49,062 [Listener at 127.0.0.1/10516] INFO  server.session (DefaultSessionIdManager.java:doStart(334)) - DefaultSessionIdManager workerName=node0
2021-10-05 13:25:49,062 [Listener at 127.0.0.1/10516] INFO  server.session (DefaultSessionIdManager.java:doStart(339)) - No SessionScavenger set, using defaults
2021-10-05 13:25:49,063 [Listener at 127.0.0.1/10516] INFO  server.session (HouseKeeper.java:startScavenging(132)) - node0 Scavenging every 600000ms
2021-10-05 13:25:49,064 [Listener at 127.0.0.1/10516] INFO  handler.ContextHandler (ContextHandler.java:doStart(915)) - Started o.e.j.s.ServletContextHandler@2838f58c{logs,/logs,file:///home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/log,AVAILABLE}
2021-10-05 13:25:49,064 [Listener at 127.0.0.1/10516] INFO  handler.ContextHandler (ContextHandler.java:doStart(915)) - Started o.e.j.s.ServletContextHandler@6c3921{static,/static,jar:file:/home/runner/.m2/repository/org/apache/ozone/hdds-container-service/1.2.0-SNAPSHOT/hdds-container-service-1.2.0-SNAPSHOT.jar!/webapps/static,AVAILABLE}
2021-10-05 13:25:49,161 [Listener at 127.0.0.1/10516] INFO  handler.ContextHandler (ContextHandler.java:doStart(915)) - Started o.e.j.w.WebAppContext@7f448d3d{hddsDatanode,/,file:///tmp/jetty-0_0_0_0-41649-hdds-container-service-1_2_0-SNAPSHOT_jar-_-any-663768550041106488/webapp/,AVAILABLE}{jar:file:/home/runner/.m2/repository/org/apache/ozone/hdds-container-service/1.2.0-SNAPSHOT/hdds-container-service-1.2.0-SNAPSHOT.jar!/webapps/hddsDatanode}
2021-10-05 13:25:49,163 [Listener at 127.0.0.1/10516] INFO  server.AbstractConnector (AbstractConnector.java:doStart(331)) - Started ServerConnector@2da64c8d{HTTP/1.1, (http/1.1)}{0.0.0.0:41649}
2021-10-05 13:25:49,163 [Listener at 127.0.0.1/10516] INFO  server.Server (Server.java:doStart(415)) - Started @142822ms
2021-10-05 13:25:49,163 [Listener at 127.0.0.1/10516] WARN  impl.MetricsSystemImpl (MetricsSystemImpl.java:register(279)) - Sink prometheus already exists!
2021-10-05 13:25:49,166 [Listener at 127.0.0.1/10516] INFO  http.BaseHttpServer (BaseHttpServer.java:updateConnectorAddress(329)) - HTTP server of hddsDatanode listening at http://0.0.0.0:41649
2021-10-05 13:25:49,171 [Listener at 127.0.0.1/10516] WARN  impl.MetricRegistriesImpl (MetricRegistriesImpl.java:addReporterRegistration(111)) - New reporters are added after registries were created. Some metrics will be missing from the reporter. Please add reporter before adding any new registry.
2021-10-05 13:25:49,171 [Listener at 127.0.0.1/10516] WARN  impl.MetricRegistriesImpl (MetricRegistriesImpl.java:addReporterRegistration(111)) - New reporters are added after registries were created. Some metrics will be missing from the reporter. Please add reporter before adding any new registry.
2021-10-05 13:25:49,172 [Listener at 127.0.0.1/10516] INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:init(158)) - HddsDatanode metrics system started (again)
2021-10-05 13:25:49,175 [Datanode State Machine Thread - 0] INFO  statemachine.DatanodeStateMachine (DatanodeStateMachine.java:lambda$startDaemon$0(456)) - Ozone container server started.
2021-10-05 13:25:49,197 [Listener at 127.0.0.1/10516] INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:start(234)) - HddsDatanodeService host:fv-az270-324.tacnzluakwdehk1hpragurqkma.bx.internal.cloudapp.net ip:10.1.0.10
2021-10-05 13:25:49,227 [org.apache.hadoop.util.JvmPauseMonitor$Monitor@427b0043] INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(188)) - Starting JVM pause monitor
2021-10-05 13:25:49,229 [Datanode State Machine Task Thread - 0] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.client.port appended with serviceId and nodeId
2021-10-05 13:25:49,229 [Datanode State Machine Task Thread - 0] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.block.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.block.client.port appended with serviceId and nodeId
2021-10-05 13:25:49,229 [Datanode State Machine Task Thread - 0] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.datanode.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.datanode.port appended with serviceId and nodeId
2021-10-05 13:25:49,229 [Datanode State Machine Task Thread - 0] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.client.port appended with serviceId and nodeId
2021-10-05 13:25:49,229 [Datanode State Machine Task Thread - 0] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.block.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.block.client.port appended with serviceId and nodeId
2021-10-05 13:25:49,229 [Datanode State Machine Task Thread - 0] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.datanode.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.datanode.port appended with serviceId and nodeId
2021-10-05 13:25:49,229 [Datanode State Machine Task Thread - 0] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.client.port appended with serviceId and nodeId
2021-10-05 13:25:49,230 [Datanode State Machine Task Thread - 0] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.block.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.block.client.port appended with serviceId and nodeId
2021-10-05 13:25:49,230 [Datanode State Machine Task Thread - 0] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.datanode.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.datanode.port appended with serviceId and nodeId
2021-10-05 13:25:49,238 [Datanode State Machine Task Thread - 0] INFO  datanode.InitDatanodeState (InitDatanodeState.java:persistContainerDatanodeDetails(145)) - DatanodeDetails is persisted to /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-62d231c0-d845-4dcd-88aa-c082e017c57e/datanode-1/meta/datanode.id
2021-10-05 13:25:49,246 [Listener at 127.0.0.1/10516] INFO  upgrade.AbstractLayoutVersionManager (AbstractLayoutVersionManager.java:init(79)) - Initializing Layout version manager with metadata layout = SCM_HA (version = 2), software layout = SCM_HA (version = 2)
2021-10-05 13:25:49,282 [omNode-1@group-523986131536-FollowerState] INFO  impl.FollowerState (FollowerState.java:run(134)) - omNode-1@group-523986131536-FollowerState: change to CANDIDATE, lastRpcElapsedTime:1011177623ns, electionTimeout:1010ms
2021-10-05 13:25:49,283 [omNode-1@group-523986131536-FollowerState] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(108)) - omNode-1: shutdown omNode-1@group-523986131536-FollowerState
2021-10-05 13:25:49,283 [omNode-1@group-523986131536-FollowerState] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(285)) - omNode-1@group-523986131536: changes role from  FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2021-10-05 13:25:49,283 [omNode-1@group-523986131536-FollowerState] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.leaderelection.pre-vote = false (custom)
2021-10-05 13:25:49,283 [omNode-1@group-523986131536-FollowerState] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(130)) - omNode-1: start omNode-1@group-523986131536-LeaderElection30
2021-10-05 13:25:49,318 [omNode-1@group-523986131536-LeaderElection30] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(306)) - omNode-1@group-523986131536-LeaderElection30 ELECTION round 0: submit vote requests at term 1 for -1: [omNode-1|rpc:localhost:10520|priority:0], old=null
2021-10-05 13:25:49,318 [omNode-1@group-523986131536-LeaderElection30] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(308)) - omNode-1@group-523986131536-LeaderElection30 ELECTION round 0: result PASSED (term=1)
2021-10-05 13:25:49,318 [omNode-1@group-523986131536-LeaderElection30] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(121)) - omNode-1: shutdown omNode-1@group-523986131536-LeaderElection30
2021-10-05 13:25:49,318 [omNode-1@group-523986131536-LeaderElection30] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(285)) - omNode-1@group-523986131536: changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2021-10-05 13:25:49,318 [omNode-1@group-523986131536-LeaderElection30] INFO  server.RaftServer$Division (ServerState.java:setLeader(285)) - omNode-1@group-523986131536: change Leader from null to omNode-1 at term 1 for becomeLeader, leader elected after 1121ms
2021-10-05 13:25:49,318 [omNode-1@group-523986131536-LeaderElection30] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.staging.catchup.gap = 1000 (default)
2021-10-05 13:25:49,318 [omNode-1@group-523986131536-LeaderElection30] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.write.element-limit = 4096 (default)
2021-10-05 13:25:49,318 [omNode-1@group-523986131536-LeaderElection30] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.write.byte-limit = 64MB (=67108864) (default)
2021-10-05 13:25:49,319 [omNode-1@group-523986131536-LeaderElection30] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.watch.timeout = 10s (default)
2021-10-05 13:25:49,319 [omNode-1@group-523986131536-LeaderElection30] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.watch.timeout.denomination = 1s (default)
2021-10-05 13:25:49,319 [omNode-1@group-523986131536-LeaderElection30] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.watch.element-limit = 65536 (default)
2021-10-05 13:25:49,319 [omNode-1@group-523986131536-LeaderElection30] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(130)) - omNode-1: start omNode-1@group-523986131536-LeaderStateImpl
2021-10-05 13:25:49,319 [omNode-1@group-523986131536-LeaderElection30] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:startLogSegment(394)) - omNode-1@group-523986131536-SegmentedRaftLogWorker: Starting segment from index:0
2021-10-05 13:25:49,332 [omNode-1@group-523986131536-LeaderElection30] INFO  server.RaftServer$Division (ServerState.java:setRaftConf(387)) - omNode-1@group-523986131536: set configuration 0: [omNode-1|rpc:localhost:10520|admin:|client:|dataStream:|priority:0], old=null
2021-10-05 13:25:49,335 [Listener at 127.0.0.1/10516] INFO  reflections.Reflections (Reflections.java:scan(232)) - Reflections took 87 ms to scan 7 urls, producing 119 keys and 275 values 
2021-10-05 13:25:49,337 [Listener at 127.0.0.1/10516] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.client.port appended with serviceId and nodeId
2021-10-05 13:25:49,337 [Listener at 127.0.0.1/10516] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.block.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.block.client.port appended with serviceId and nodeId
2021-10-05 13:25:49,337 [Listener at 127.0.0.1/10516] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.datanode.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.datanode.port appended with serviceId and nodeId
2021-10-05 13:25:49,337 [Listener at 127.0.0.1/10516] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.client.port appended with serviceId and nodeId
2021-10-05 13:25:49,337 [Listener at 127.0.0.1/10516] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.block.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.block.client.port appended with serviceId and nodeId
2021-10-05 13:25:49,337 [Listener at 127.0.0.1/10516] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.datanode.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.datanode.port appended with serviceId and nodeId
2021-10-05 13:25:49,337 [Listener at 127.0.0.1/10516] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.client.port appended with serviceId and nodeId
2021-10-05 13:25:49,337 [Listener at 127.0.0.1/10516] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.block.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.block.client.port appended with serviceId and nodeId
2021-10-05 13:25:49,337 [Listener at 127.0.0.1/10516] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.datanode.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.datanode.port appended with serviceId and nodeId
2021-10-05 13:25:49,340 [Listener at 127.0.0.1/10516] INFO  volume.HddsVolume (HddsVolume.java:<init>(120)) - Creating HddsVolume: /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-62d231c0-d845-4dcd-88aa-c082e017c57e/datanode-2/data-0/containers/hdds of storage type : DISK capacity : 9223372036854775807
2021-10-05 13:25:49,340 [Listener at 127.0.0.1/10516] INFO  volume.MutableVolumeSet (MutableVolumeSet.java:initializeVolumeSet(168)) - Added Volume : /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-62d231c0-d845-4dcd-88aa-c082e017c57e/datanode-2/data-0/containers/hdds to VolumeSet
2021-10-05 13:25:49,340 [Listener at 127.0.0.1/10516] INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(141)) - Scheduling a check for /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-62d231c0-d845-4dcd-88aa-c082e017c57e/datanode-2/data-0/containers/hdds
2021-10-05 13:25:49,343 [Listener at 127.0.0.1/10516] INFO  volume.StorageVolumeChecker (StorageVolumeChecker.java:checkAllVolumes(202)) - Scheduled health check for volume /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-62d231c0-d845-4dcd-88aa-c082e017c57e/datanode-2/data-0/containers/hdds
2021-10-05 13:25:49,359 [omNode-1@group-523986131536-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(601)) - omNode-1@group-523986131536-SegmentedRaftLogWorker: created new log segment /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-62d231c0-d845-4dcd-88aa-c082e017c57e/omNode-1/ratis/c9bc4cf4-3bc3-3c60-a66b-523986131536/current/log_inprogress_0
2021-10-05 13:25:49,361 [omNode-1@group-523986131536-StateMachineUpdater] INFO  ratis.OzoneManagerStateMachine (OzoneManagerStateMachine.java:notifyConfigurationChanged(188)) - Received Configuration change notification from Ratis. New Peer list:
[id: "omNode-1"
address: "localhost:10520"
]
2021-10-05 13:25:49,367 [Listener at 127.0.0.1/10516] INFO  volume.MutableVolumeSet (MutableVolumeSet.java:initializeVolumeSet(168)) - Added Volume : /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-62d231c0-d845-4dcd-88aa-c082e017c57e/datanode-2/data/ratis to VolumeSet
2021-10-05 13:25:49,367 [Listener at 127.0.0.1/10516] INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(141)) - Scheduling a check for /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-62d231c0-d845-4dcd-88aa-c082e017c57e/datanode-2/data/ratis
2021-10-05 13:25:49,367 [Listener at 127.0.0.1/10516] INFO  volume.StorageVolumeChecker (StorageVolumeChecker.java:checkAllVolumes(202)) - Scheduled health check for volume /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-62d231c0-d845-4dcd-88aa-c082e017c57e/datanode-2/data/ratis
2021-10-05 13:25:49,385 [Thread-2273] INFO  ozoneimpl.ContainerReader (ContainerReader.java:readVolume(172)) - Finish verifying containers on volume /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-62d231c0-d845-4dcd-88aa-c082e017c57e/datanode-2/data-0/containers/hdds
2021-10-05 13:25:49,385 [Listener at 127.0.0.1/10516] INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:buildContainerSet(236)) - Build ContainerSet costs 0s
2021-10-05 13:25:49,387 [Listener at 127.0.0.1/10516] INFO  server.RaftServer (ConfUtils.java:logGet(44)) - raft.rpc.type = GRPC (default)
2021-10-05 13:25:49,387 [Listener at 127.0.0.1/10516] INFO  grpc.GrpcFactory (GrpcFactory.java:checkPooledByteBufAllocatorUseCacheForAllThreads(48)) - PERFORMANCE WARNING: useCacheForAllThreads is true that may cause Netty to create a lot garbage objects and, as a result, trigger GC.
	It is recommended to disable useCacheForAllThreads by setting -Dorg.apache.ratis.thirdparty.io.netty.allocator.useCacheForAllThreads=false in command line.
2021-10-05 13:25:49,396 [Listener at 127.0.0.1/10516] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(44)) - raft.grpc.admin.port = 0 (custom)
2021-10-05 13:25:49,396 [Listener at 127.0.0.1/10516] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(44)) - raft.grpc.client.port = 0 (custom)
2021-10-05 13:25:49,396 [Listener at 127.0.0.1/10516] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(44)) - raft.grpc.server.port = 0 (default)
2021-10-05 13:25:49,397 [Listener at 127.0.0.1/10516] INFO  server.GrpcService (ConfUtils.java:logGet(44)) - raft.grpc.message.size.max = 32MB (=33554432) (custom)
2021-10-05 13:25:49,397 [Listener at 127.0.0.1/10516] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2021-10-05 13:25:49,397 [Listener at 127.0.0.1/10516] INFO  server.GrpcService (ConfUtils.java:logGet(44)) - raft.grpc.flow.control.window = 5MB (=5242880) (custom)
2021-10-05 13:25:49,397 [Listener at 127.0.0.1/10516] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.request.timeout = 60s (custom)
2021-10-05 13:25:49,398 [Listener at 127.0.0.1/10516] INFO  impl.DataStreamServerImpl (ConfUtils.java:logGet(44)) - raft.datastream.type = DISABLED (default)
2021-10-05 13:25:49,398 [Listener at 127.0.0.1/10516] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.slowness.timeout = 300s (custom)
2021-10-05 13:25:49,398 [Listener at 127.0.0.1/10516] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.leaderelection.leader.step-down.wait-time = 10s (default)
2021-10-05 13:25:49,398 [Listener at 127.0.0.1/10516] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.storage.dir = [/home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-62d231c0-d845-4dcd-88aa-c082e017c57e/datanode-2/data/ratis] (custom)
2021-10-05 13:25:49,403 [Listener at 127.0.0.1/10516] INFO  http.BaseHttpServer (BaseHttpServer.java:newHttpServer2BuilderForOzone(209)) - Starting Web-server for hddsDatanode at: http://0.0.0.0:0
2021-10-05 13:25:49,403 [Listener at 127.0.0.1/10516] INFO  http.BaseHttpServer (BaseHttpServer.java:<init>(107)) - Hadoop Security Enabled: false Ozone Security Enabled: false Ozone HTTP Security Enabled: false 
2021-10-05 13:25:49,418 [Listener at 127.0.0.1/10516] INFO  server.AuthenticationFilter (AuthenticationFilter.java:constructSecretProvider(240)) - Unable to initialize FileSignerSecretProvider, falling back to use random secrets.
2021-10-05 13:25:49,419 [Listener at 127.0.0.1/10516] WARN  http.HttpRequestLog (HttpRequestLog.java:getRequestLog(103)) - Jetty request log can only be enabled using Log4j
2021-10-05 13:25:49,419 [Listener at 127.0.0.1/10516] INFO  http.HttpServer2 (HttpServer2.java:addGlobalFilter(1030)) - Added global filter 'safety' (class=org.apache.hadoop.hdds.server.http.HttpServer2$QuotingInputFilter)
2021-10-05 13:25:49,420 [Listener at 127.0.0.1/10516] INFO  http.HttpServer2 (HttpServer2.java:addFilter(1006)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context hddsDatanode
2021-10-05 13:25:49,420 [Listener at 127.0.0.1/10516] INFO  http.HttpServer2 (HttpServer2.java:addFilter(1014)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context static
2021-10-05 13:25:49,420 [Listener at 127.0.0.1/10516] INFO  http.HttpServer2 (HttpServer2.java:addFilter(1014)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context logs
2021-10-05 13:25:49,421 [Listener at 127.0.0.1/10516] INFO  http.HttpServer2 (HttpServer2.java:bindListener(1249)) - Jetty bound to port 45471
2021-10-05 13:25:49,421 [Listener at 127.0.0.1/10516] INFO  server.Server (Server.java:doStart(375)) - jetty-9.4.43.v20210629; built: 2021-06-30T11:07:22.254Z; git: 526006ecfa3af7f1a27ef3a288e2bef7ea9dd7e8; jvm 1.8.0_292-b10
2021-10-05 13:25:49,423 [Listener at 127.0.0.1/10516] INFO  server.session (DefaultSessionIdManager.java:doStart(334)) - DefaultSessionIdManager workerName=node0
2021-10-05 13:25:49,423 [Listener at 127.0.0.1/10516] INFO  server.session (DefaultSessionIdManager.java:doStart(339)) - No SessionScavenger set, using defaults
2021-10-05 13:25:49,426 [Listener at 127.0.0.1/10516] INFO  server.session (HouseKeeper.java:startScavenging(132)) - node0 Scavenging every 600000ms
2021-10-05 13:25:49,426 [Listener at 127.0.0.1/10516] INFO  handler.ContextHandler (ContextHandler.java:doStart(915)) - Started o.e.j.s.ServletContextHandler@1f980706{logs,/logs,file:///home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/log,AVAILABLE}
2021-10-05 13:25:49,427 [Listener at 127.0.0.1/10516] INFO  handler.ContextHandler (ContextHandler.java:doStart(915)) - Started o.e.j.s.ServletContextHandler@11e7bf7b{static,/static,jar:file:/home/runner/.m2/repository/org/apache/ozone/hdds-container-service/1.2.0-SNAPSHOT/hdds-container-service-1.2.0-SNAPSHOT.jar!/webapps/static,AVAILABLE}
2021-10-05 13:25:49,545 [Listener at 127.0.0.1/10516] INFO  handler.ContextHandler (ContextHandler.java:doStart(915)) - Started o.e.j.w.WebAppContext@37904d56{hddsDatanode,/,file:///tmp/jetty-0_0_0_0-45471-hdds-container-service-1_2_0-SNAPSHOT_jar-_-any-1541447665477570930/webapp/,AVAILABLE}{jar:file:/home/runner/.m2/repository/org/apache/ozone/hdds-container-service/1.2.0-SNAPSHOT/hdds-container-service-1.2.0-SNAPSHOT.jar!/webapps/hddsDatanode}
2021-10-05 13:25:49,554 [Listener at 127.0.0.1/10516] INFO  server.AbstractConnector (AbstractConnector.java:doStart(331)) - Started ServerConnector@2eff4e88{HTTP/1.1, (http/1.1)}{0.0.0.0:45471}
2021-10-05 13:25:49,555 [Listener at 127.0.0.1/10516] INFO  server.Server (Server.java:doStart(415)) - Started @143214ms
2021-10-05 13:25:49,555 [Listener at 127.0.0.1/10516] WARN  impl.MetricsSystemImpl (MetricsSystemImpl.java:register(279)) - Sink prometheus already exists!
2021-10-05 13:25:49,559 [Listener at 127.0.0.1/10516] INFO  http.BaseHttpServer (BaseHttpServer.java:updateConnectorAddress(329)) - HTTP server of hddsDatanode listening at http://0.0.0.0:45471
2021-10-05 13:25:49,560 [Listener at 127.0.0.1/10516] INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(235)) - Waiting for nodes to be ready. Got 0 of 3 DN Heartbeats.
2021-10-05 13:25:49,560 [Listener at 127.0.0.1/10516] INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(238)) - Waiting for cluster to exit safe mode
2021-10-05 13:25:49,561 [Listener at 127.0.0.1/10516] INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(240)) - SCM became leader
2021-10-05 13:25:49,563 [Datanode State Machine Thread - 0] INFO  statemachine.DatanodeStateMachine (DatanodeStateMachine.java:lambda$startDaemon$0(456)) - Ozone container server started.
2021-10-05 13:25:49,612 [Datanode State Machine Task Thread - 0] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.client.port appended with serviceId and nodeId
2021-10-05 13:25:49,612 [Datanode State Machine Task Thread - 0] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.block.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.block.client.port appended with serviceId and nodeId
2021-10-05 13:25:49,612 [Datanode State Machine Task Thread - 0] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.datanode.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.datanode.port appended with serviceId and nodeId
2021-10-05 13:25:49,612 [Datanode State Machine Task Thread - 0] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.client.port appended with serviceId and nodeId
2021-10-05 13:25:49,612 [Datanode State Machine Task Thread - 0] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.block.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.block.client.port appended with serviceId and nodeId
2021-10-05 13:25:49,612 [Datanode State Machine Task Thread - 0] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.datanode.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.datanode.port appended with serviceId and nodeId
2021-10-05 13:25:49,612 [Datanode State Machine Task Thread - 0] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.client.port appended with serviceId and nodeId
2021-10-05 13:25:49,612 [Datanode State Machine Task Thread - 0] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.block.client.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.block.client.port appended with serviceId and nodeId
2021-10-05 13:25:49,612 [Datanode State Machine Task Thread - 0] INFO  ha.SCMNodeInfo (SCMNodeInfo.java:getPort(197)) - ConfigKey ozone.scm.datanode.address is deprecated, For configuring different ports for each SCM use PortConfigKey ozone.scm.datanode.port appended with serviceId and nodeId
2021-10-05 13:25:49,615 [org.apache.hadoop.util.JvmPauseMonitor$Monitor@611d7dc0] INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(188)) - Starting JVM pause monitor
2021-10-05 13:25:49,626 [Datanode State Machine Task Thread - 0] INFO  datanode.InitDatanodeState (InitDatanodeState.java:persistContainerDatanodeDetails(145)) - DatanodeDetails is persisted to /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-62d231c0-d845-4dcd-88aa-c082e017c57e/datanode-2/meta/datanode.id
2021-10-05 13:25:49,779 [EndpointStateMachine task thread for /127.0.0.1:15041 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15041. Already tried 11 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:49,811 [EndpointStateMachine task thread for /127.0.0.1:13549 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:13549. Already tried 2 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:49,813 [EndpointStateMachine task thread for /127.0.0.1:13529 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:13529. Already tried 2 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:49,850 [EndpointStateMachine task thread for /127.0.0.1:15021 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15021. Already tried 0 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:49,852 [EndpointStateMachine task thread for /127.0.0.1:15031 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15031. Already tried 0 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:49,959 [EndpointStateMachine task thread for /127.0.0.1:13539 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:13539. Already tried 1 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:50,561 [Listener at 127.0.0.1/10516] INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(235)) - Waiting for nodes to be ready. Got 0 of 3 DN Heartbeats.
2021-10-05 13:25:50,561 [Listener at 127.0.0.1/10516] INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(238)) - Waiting for cluster to exit safe mode
2021-10-05 13:25:50,561 [Listener at 127.0.0.1/10516] INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(240)) - SCM became leader
2021-10-05 13:25:50,780 [EndpointStateMachine task thread for /127.0.0.1:15041 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15041. Already tried 12 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:50,811 [EndpointStateMachine task thread for /127.0.0.1:13549 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:13549. Already tried 3 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:50,817 [EndpointStateMachine task thread for /127.0.0.1:13529 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:13529. Already tried 3 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:50,850 [EndpointStateMachine task thread for /127.0.0.1:15021 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15021. Already tried 1 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:50,853 [EndpointStateMachine task thread for /127.0.0.1:15031 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15031. Already tried 1 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:50,876 [EndpointStateMachine task thread for /127.0.0.1:12131 - 0 ] INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(304)) - Attempting to start container services.
2021-10-05 13:25:50,876 [EndpointStateMachine task thread for /127.0.0.1:12131 - 0 ] INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(249)) - Background container scanner has been disabled.
2021-10-05 13:25:50,884 [EndpointStateMachine task thread for /127.0.0.1:12131 - 0 ] INFO  replication.ReplicationServer (ReplicationServer.java:start(107)) - ReplicationServer is started using port 42707
2021-10-05 13:25:50,888 [EndpointStateMachine task thread for /127.0.0.1:12131 - 0 ] INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(482)) - Starting XceiverServerRatis 2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc
2021-10-05 13:25:50,928 [EndpointStateMachine task thread for /127.0.0.1:12131 - 0 ] INFO  server.RaftServer (RaftServerProxy.java:lambda$start$5(374)) - 2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc: start RPC server
2021-10-05 13:25:50,929 [EndpointStateMachine task thread for /127.0.0.1:12131 - 0 ] INFO  server.GrpcService (GrpcService.java:startImpl(253)) - 2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc: GrpcService started, listening on 45481
2021-10-05 13:25:50,929 [EndpointStateMachine task thread for /127.0.0.1:12131 - 0 ] INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:getRealPort(503)) - XceiverServerRatis 2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc is started using port 45481 for RATIS
2021-10-05 13:25:50,929 [EndpointStateMachine task thread for /127.0.0.1:12131 - 0 ] INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:getRealPort(503)) - XceiverServerRatis 2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc is started using port 45481 for RATIS_ADMIN
2021-10-05 13:25:50,929 [EndpointStateMachine task thread for /127.0.0.1:12131 - 0 ] INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:getRealPort(503)) - XceiverServerRatis 2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc is started using port 45481 for RATIS_SERVER
2021-10-05 13:25:50,930 [EndpointStateMachine task thread for /127.0.0.1:12131 - 0 ] INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:start(135)) - XceiverServerGrpc 2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc is started using port 42383
2021-10-05 13:25:50,939 [EndpointStateMachine task thread for /127.0.0.1:12121 - 0 ] INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(300)) - Ignore. OzoneContainer already started.
2021-10-05 13:25:50,939 [org.apache.ratis.util.JvmPauseMonitor$$Lambda$499/1586779822@77717581] INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(103)) - JvmPauseMonitor-2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc: Started
2021-10-05 13:25:50,959 [EndpointStateMachine task thread for /127.0.0.1:13539 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:13539. Already tried 2 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:51,279 [EndpointStateMachine task thread for /127.0.0.1:12131 - 0 ] INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(304)) - Attempting to start container services.
2021-10-05 13:25:51,279 [EndpointStateMachine task thread for /127.0.0.1:12131 - 0 ] INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(249)) - Background container scanner has been disabled.
2021-10-05 13:25:51,280 [EndpointStateMachine task thread for /127.0.0.1:12131 - 0 ] INFO  replication.ReplicationServer (ReplicationServer.java:start(107)) - ReplicationServer is started using port 38747
2021-10-05 13:25:51,281 [EndpointStateMachine task thread for /127.0.0.1:12131 - 0 ] INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(482)) - Starting XceiverServerRatis 106bb174-548c-482f-98a0-a37141c57762
2021-10-05 13:25:51,282 [EndpointStateMachine task thread for /127.0.0.1:12131 - 0 ] INFO  server.RaftServer (RaftServerProxy.java:lambda$start$5(374)) - 106bb174-548c-482f-98a0-a37141c57762: start RPC server
2021-10-05 13:25:51,283 [EndpointStateMachine task thread for /127.0.0.1:12131 - 0 ] INFO  server.GrpcService (GrpcService.java:startImpl(253)) - 106bb174-548c-482f-98a0-a37141c57762: GrpcService started, listening on 43635
2021-10-05 13:25:51,283 [EndpointStateMachine task thread for /127.0.0.1:12131 - 0 ] INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:getRealPort(503)) - XceiverServerRatis 106bb174-548c-482f-98a0-a37141c57762 is started using port 43635 for RATIS
2021-10-05 13:25:51,283 [EndpointStateMachine task thread for /127.0.0.1:12131 - 0 ] INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:getRealPort(503)) - XceiverServerRatis 106bb174-548c-482f-98a0-a37141c57762 is started using port 43635 for RATIS_ADMIN
2021-10-05 13:25:51,284 [EndpointStateMachine task thread for /127.0.0.1:12131 - 0 ] INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:getRealPort(503)) - XceiverServerRatis 106bb174-548c-482f-98a0-a37141c57762 is started using port 43635 for RATIS_SERVER
2021-10-05 13:25:51,287 [EndpointStateMachine task thread for /127.0.0.1:12131 - 0 ] INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:start(135)) - XceiverServerGrpc 106bb174-548c-482f-98a0-a37141c57762 is started using port 45889
2021-10-05 13:25:51,293 [EndpointStateMachine task thread for /127.0.0.1:12121 - 0 ] INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(300)) - Ignore. OzoneContainer already started.
2021-10-05 13:25:51,293 [org.apache.ratis.util.JvmPauseMonitor$$Lambda$499/1586779822@4e639591] INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(103)) - JvmPauseMonitor-106bb174-548c-482f-98a0-a37141c57762: Started
2021-10-05 13:25:51,561 [Listener at 127.0.0.1/10516] INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(235)) - Waiting for nodes to be ready. Got 0 of 3 DN Heartbeats.
2021-10-05 13:25:51,562 [Listener at 127.0.0.1/10516] INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(238)) - Waiting for cluster to exit safe mode
2021-10-05 13:25:51,562 [Listener at 127.0.0.1/10516] INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(240)) - SCM became leader
2021-10-05 13:25:51,628 [EndpointStateMachine task thread for /127.0.0.1:12121 - 0 ] INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(304)) - Attempting to start container services.
2021-10-05 13:25:51,628 [EndpointStateMachine task thread for /127.0.0.1:12121 - 0 ] INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(249)) - Background container scanner has been disabled.
2021-10-05 13:25:51,629 [EndpointStateMachine task thread for /127.0.0.1:12121 - 0 ] INFO  replication.ReplicationServer (ReplicationServer.java:start(107)) - ReplicationServer is started using port 45329
2021-10-05 13:25:51,630 [EndpointStateMachine task thread for /127.0.0.1:12121 - 0 ] INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(482)) - Starting XceiverServerRatis c2216084-e141-4b27-afe8-b6c5968528ec
2021-10-05 13:25:51,631 [EndpointStateMachine task thread for /127.0.0.1:12121 - 0 ] INFO  server.RaftServer (RaftServerProxy.java:lambda$start$5(374)) - c2216084-e141-4b27-afe8-b6c5968528ec: start RPC server
2021-10-05 13:25:51,635 [EndpointStateMachine task thread for /127.0.0.1:12121 - 0 ] INFO  server.GrpcService (GrpcService.java:startImpl(253)) - c2216084-e141-4b27-afe8-b6c5968528ec: GrpcService started, listening on 39195
2021-10-05 13:25:51,650 [EndpointStateMachine task thread for /127.0.0.1:12121 - 0 ] INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:getRealPort(503)) - XceiverServerRatis c2216084-e141-4b27-afe8-b6c5968528ec is started using port 39195 for RATIS
2021-10-05 13:25:51,650 [EndpointStateMachine task thread for /127.0.0.1:12121 - 0 ] INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:getRealPort(503)) - XceiverServerRatis c2216084-e141-4b27-afe8-b6c5968528ec is started using port 39195 for RATIS_ADMIN
2021-10-05 13:25:51,650 [EndpointStateMachine task thread for /127.0.0.1:12121 - 0 ] INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:getRealPort(503)) - XceiverServerRatis c2216084-e141-4b27-afe8-b6c5968528ec is started using port 39195 for RATIS_SERVER
2021-10-05 13:25:51,650 [org.apache.ratis.util.JvmPauseMonitor$$Lambda$499/1586779822@2c416b29] INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(103)) - JvmPauseMonitor-c2216084-e141-4b27-afe8-b6c5968528ec: Started
2021-10-05 13:25:51,651 [EndpointStateMachine task thread for /127.0.0.1:12121 - 0 ] INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:start(135)) - XceiverServerGrpc c2216084-e141-4b27-afe8-b6c5968528ec is started using port 37211
2021-10-05 13:25:51,681 [EndpointStateMachine task thread for /127.0.0.1:12131 - 0 ] INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(300)) - Ignore. OzoneContainer already started.
2021-10-05 13:25:51,780 [EndpointStateMachine task thread for /127.0.0.1:15041 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15041. Already tried 13 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:51,812 [EndpointStateMachine task thread for /127.0.0.1:13549 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:13549. Already tried 4 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:51,817 [EndpointStateMachine task thread for /127.0.0.1:13529 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:13529. Already tried 4 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:51,851 [EndpointStateMachine task thread for /127.0.0.1:15021 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15021. Already tried 2 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:51,853 [EndpointStateMachine task thread for /127.0.0.1:15031 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15031. Already tried 2 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:51,960 [EndpointStateMachine task thread for /127.0.0.1:13539 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:13539. Already tried 3 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:52,562 [Listener at 127.0.0.1/10516] INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(235)) - Waiting for nodes to be ready. Got 0 of 3 DN Heartbeats.
2021-10-05 13:25:52,562 [Listener at 127.0.0.1/10516] INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(238)) - Waiting for cluster to exit safe mode
2021-10-05 13:25:52,562 [Listener at 127.0.0.1/10516] INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(240)) - SCM became leader
2021-10-05 13:25:52,781 [EndpointStateMachine task thread for /127.0.0.1:15041 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15041. Already tried 14 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:52,839 [EndpointStateMachine task thread for /127.0.0.1:13529 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:13529. Already tried 5 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:52,839 [EndpointStateMachine task thread for /127.0.0.1:13549 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:13549. Already tried 5 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:52,840 [IPC Server handler 11 on default port 12131] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc
2021-10-05 13:25:52,840 [IPC Server handler 11 on default port 12131] INFO  node.SCMNodeManager (SCMNodeManager.java:register(389)) - Registered Data node : 2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc{ip: 127.0.0.1, host: localhost, ports: [REPLICATION=42707, RATIS=45481, RATIS_ADMIN=45481, RATIS_SERVER=45481, STANDALONE=42383], networkLocation: /default-rack, certSerialId: null, persistedOpState: null, persistedOpStateExpiryEpochSec: 0}
2021-10-05 13:25:52,844 [EventQueue-NodeRegistrationContainerReportForDataNodeSafeModeRule] INFO  safemode.SCMSafeModeManager (DataNodeSafeModeRule.java:process(71)) - SCM in safe mode. 1 DataNodes registered, 3 required.
2021-10-05 13:25:52,846 [IPC Server handler 2 on default port 12121] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc
2021-10-05 13:25:52,846 [IPC Server handler 2 on default port 12121] INFO  node.SCMNodeManager (SCMNodeManager.java:register(389)) - Registered Data node : 2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc{ip: 127.0.0.1, host: localhost, ports: [REPLICATION=42707, RATIS=45481, RATIS_ADMIN=45481, RATIS_SERVER=45481, STANDALONE=42383], networkLocation: /default-rack, certSerialId: null, persistedOpState: null, persistedOpStateExpiryEpochSec: 0}
2021-10-05 13:25:52,851 [EndpointStateMachine task thread for /127.0.0.1:15021 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15021. Already tried 3 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:52,853 [EndpointStateMachine task thread for /127.0.0.1:15031 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15031. Already tried 3 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:52,855 [EventQueue-NewNodeForNewNodeHandler] INFO  pipeline.BackgroundPipelineCreator (BackgroundPipelineCreatorV2.java:notifyEventTriggered(279)) - ignore, not leader SCM.
2021-10-05 13:25:52,855 [EventQueue-NodeRegistrationContainerReportForContainerSafeModeRule] INFO  safemode.SCMSafeModeManager (SCMSafeModeManager.java:validateSafeModeExitRules(204)) - ContainerSafeModeRule rule is successfully validated
2021-10-05 13:25:52,863 [EventQueue-NewNodeForNewNodeHandler] INFO  pipeline.BackgroundPipelineCreator (BackgroundPipelineCreatorV2.java:notifyEventTriggered(285)) - trigger a one-shot run on RatisPipelineUtilsThread.
2021-10-05 13:25:52,864 [RatisPipelineUtilsThread - 0] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(183)) - Sending CreatePipelineCommand for pipeline:PipelineID=b98fb588-c6d1-40ce-b522-15090ded4481 to datanode:2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc
2021-10-05 13:25:52,887 [EventQueue-NodeRegistrationContainerReportForDataNodeSafeModeRule] INFO  safemode.SCMSafeModeManager (DataNodeSafeModeRule.java:process(71)) - SCM in safe mode. 1 DataNodes registered, 3 required.
2021-10-05 13:25:52,890 [EventQueue-PipelineReportForOneReplicaPipelineSafeModeRule] INFO  safemode.SCMSafeModeManager (SCMSafeModeManager.java:validateSafeModeExitRules(204)) - AtleastOneDatanodeReportedRule rule is successfully validated
2021-10-05 13:25:52,891 [EventQueue-NodeRegistrationContainerReportForContainerSafeModeRule] INFO  safemode.SCMSafeModeManager (SCMSafeModeManager.java:validateSafeModeExitRules(204)) - ContainerSafeModeRule rule is successfully validated
2021-10-05 13:25:52,912 [EventQueue-PipelineReportForOneReplicaPipelineSafeModeRule] INFO  safemode.SCMSafeModeManager (SCMSafeModeManager.java:validateSafeModeExitRules(204)) - AtleastOneDatanodeReportedRule rule is successfully validated
2021-10-05 13:25:52,934 [61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-StateMachineUpdater] INFO  pipeline.PipelineStateManagerImpl (PipelineStateManagerImpl.java:addPipeline(101)) - Created pipeline Pipeline[ Id: b98fb588-c6d1-40ce-b522-15090ded4481, Nodes: 2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc{ip: 127.0.0.1, host: localhost, ports: [REPLICATION=42707, RATIS=45481, RATIS_ADMIN=45481, RATIS_SERVER=45481, STANDALONE=42383], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}, ReplicationConfig: RATIS/ONE, State:ALLOCATED, leaderId:, CreationTimestamp2021-10-05T13:25:52.864Z[Etc/UTC]].
2021-10-05 13:25:52,935 [61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-StateMachineUpdater] INFO  safemode.HealthyPipelineSafeModeRule (HealthyPipelineSafeModeRule.java:initializeRule(152)) - Refreshed total pipeline count is 0, healthy pipeline threshold count is 1
2021-10-05 13:25:52,943 [RatisPipelineUtilsThread - 0] INFO  ha.SCMHAInvocationHandler (SCMHAInvocationHandler.java:invokeRatis(113)) - Invoking method public abstract void org.apache.hadoop.hdds.scm.pipeline.PipelineStateManager.addPipeline(org.apache.hadoop.hdds.protocol.proto.HddsProtos$Pipeline) throws java.io.IOException on target org.apache.hadoop.hdds.scm.ha.SCMRatisServerImpl@183f041f, cost 52779.803us
2021-10-05 13:25:52,945 [b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-StateMachineUpdater] INFO  pipeline.PipelineStateManagerImpl (PipelineStateManagerImpl.java:addPipeline(101)) - Created pipeline Pipeline[ Id: b98fb588-c6d1-40ce-b522-15090ded4481, Nodes: 2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc{ip: 127.0.0.1, host: localhost, ports: [REPLICATION=42707, RATIS=45481, RATIS_ADMIN=45481, RATIS_SERVER=45481, STANDALONE=42383], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}, ReplicationConfig: RATIS/ONE, State:ALLOCATED, leaderId:, CreationTimestamp2021-10-05T13:25:52.864Z[Etc/UTC]].
2021-10-05 13:25:52,945 [b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-StateMachineUpdater] INFO  safemode.HealthyPipelineSafeModeRule (HealthyPipelineSafeModeRule.java:initializeRule(152)) - Refreshed total pipeline count is 0, healthy pipeline threshold count is 1
2021-10-05 13:25:52,960 [EndpointStateMachine task thread for /127.0.0.1:13539 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:13539. Already tried 4 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:53,241 [Datanode State Machine Thread - 0] ERROR datanode.RunningDatanodeState (RunningDatanodeState.java:computeNextContainerState(199)) - Error in executing end point task.
java.util.concurrent.ExecutionException: java.util.concurrent.TimeoutException
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.hadoop.ozone.container.common.states.datanode.RunningDatanodeState.computeNextContainerState(RunningDatanodeState.java:191)
	at org.apache.hadoop.ozone.container.common.states.datanode.RunningDatanodeState.await(RunningDatanodeState.java:231)
	at org.apache.hadoop.ozone.container.common.states.datanode.RunningDatanodeState.await(RunningDatanodeState.java:50)
	at org.apache.hadoop.ozone.container.common.statemachine.StateContext.execute(StateContext.java:629)
	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.start(DatanodeStateMachine.java:270)
	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.lambda$startDaemon$0(DatanodeStateMachine.java:457)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.util.concurrent.TimeoutException
	at java.util.concurrent.FutureTask.get(FutureTask.java:205)
	at org.apache.hadoop.ozone.container.common.states.datanode.RunningDatanodeState.lambda$execute$0(RunningDatanodeState.java:149)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
2021-10-05 13:25:53,244 [IPC Server handler 9 on default port 12131] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/106bb174-548c-482f-98a0-a37141c57762
2021-10-05 13:25:53,245 [IPC Server handler 9 on default port 12131] INFO  node.SCMNodeManager (SCMNodeManager.java:register(389)) - Registered Data node : 106bb174-548c-482f-98a0-a37141c57762{ip: 127.0.0.1, host: localhost, ports: [REPLICATION=38747, RATIS=43635, RATIS_ADMIN=43635, RATIS_SERVER=43635, STANDALONE=45889], networkLocation: /default-rack, certSerialId: null, persistedOpState: null, persistedOpStateExpiryEpochSec: 0}
2021-10-05 13:25:53,245 [EventQueue-NewNodeForNewNodeHandler] INFO  pipeline.BackgroundPipelineCreator (BackgroundPipelineCreatorV2.java:notifyEventTriggered(279)) - ignore, not leader SCM.
2021-10-05 13:25:53,245 [EventQueue-NodeRegistrationContainerReportForDataNodeSafeModeRule] INFO  safemode.SCMSafeModeManager (DataNodeSafeModeRule.java:process(71)) - SCM in safe mode. 2 DataNodes registered, 3 required.
2021-10-05 13:25:53,253 [IPC Server handler 0 on default port 12121] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/106bb174-548c-482f-98a0-a37141c57762
2021-10-05 13:25:53,253 [IPC Server handler 0 on default port 12121] INFO  node.SCMNodeManager (SCMNodeManager.java:register(389)) - Registered Data node : 106bb174-548c-482f-98a0-a37141c57762{ip: 127.0.0.1, host: localhost, ports: [REPLICATION=38747, RATIS=43635, RATIS_ADMIN=43635, RATIS_SERVER=43635, STANDALONE=45889], networkLocation: /default-rack, certSerialId: null, persistedOpState: null, persistedOpStateExpiryEpochSec: 0}
2021-10-05 13:25:53,253 [EventQueue-NewNodeForNewNodeHandler] INFO  pipeline.BackgroundPipelineCreator (BackgroundPipelineCreatorV2.java:notifyEventTriggered(285)) - trigger a one-shot run on RatisPipelineUtilsThread.
2021-10-05 13:25:53,254 [EventQueue-NodeRegistrationContainerReportForDataNodeSafeModeRule] INFO  safemode.SCMSafeModeManager (DataNodeSafeModeRule.java:process(71)) - SCM in safe mode. 2 DataNodes registered, 3 required.
2021-10-05 13:25:53,262 [RatisPipelineUtilsThread - 0] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(183)) - Sending CreatePipelineCommand for pipeline:PipelineID=b3ab901a-6bcc-4c8d-8b24-5ea95d3f2cf7 to datanode:106bb174-548c-482f-98a0-a37141c57762
2021-10-05 13:25:53,267 [61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-StateMachineUpdater] INFO  pipeline.PipelineStateManagerImpl (PipelineStateManagerImpl.java:addPipeline(101)) - Created pipeline Pipeline[ Id: b3ab901a-6bcc-4c8d-8b24-5ea95d3f2cf7, Nodes: 106bb174-548c-482f-98a0-a37141c57762{ip: 127.0.0.1, host: localhost, ports: [REPLICATION=38747, RATIS=43635, RATIS_ADMIN=43635, RATIS_SERVER=43635, STANDALONE=45889], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}, ReplicationConfig: RATIS/ONE, State:ALLOCATED, leaderId:, CreationTimestamp2021-10-05T13:25:53.262Z[Etc/UTC]].
2021-10-05 13:25:53,268 [61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-StateMachineUpdater] INFO  safemode.HealthyPipelineSafeModeRule (HealthyPipelineSafeModeRule.java:initializeRule(152)) - Refreshed total pipeline count is 0, healthy pipeline threshold count is 1
2021-10-05 13:25:53,268 [RatisPipelineUtilsThread - 0] INFO  ha.SCMHAInvocationHandler (SCMHAInvocationHandler.java:invokeRatis(113)) - Invoking method public abstract void org.apache.hadoop.hdds.scm.pipeline.PipelineStateManager.addPipeline(org.apache.hadoop.hdds.protocol.proto.HddsProtos$Pipeline) throws java.io.IOException on target org.apache.hadoop.hdds.scm.ha.SCMRatisServerImpl@183f041f, cost 5262.509us
2021-10-05 13:25:53,281 [b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-StateMachineUpdater] INFO  pipeline.PipelineStateManagerImpl (PipelineStateManagerImpl.java:addPipeline(101)) - Created pipeline Pipeline[ Id: b3ab901a-6bcc-4c8d-8b24-5ea95d3f2cf7, Nodes: 106bb174-548c-482f-98a0-a37141c57762{ip: 127.0.0.1, host: localhost, ports: [REPLICATION=38747, RATIS=43635, RATIS_ADMIN=43635, RATIS_SERVER=43635, STANDALONE=45889], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}, ReplicationConfig: RATIS/ONE, State:ALLOCATED, leaderId:, CreationTimestamp2021-10-05T13:25:53.262Z[Etc/UTC]].
2021-10-05 13:25:53,281 [b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-StateMachineUpdater] INFO  safemode.HealthyPipelineSafeModeRule (HealthyPipelineSafeModeRule.java:initializeRule(152)) - Refreshed total pipeline count is 0, healthy pipeline threshold count is 1
2021-10-05 13:25:53,283 [61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-StateMachineUpdater] INFO  ha.SCMStateMachine (SCMStateMachine.java:takeSnapshot(290)) - Current Snapshot Index 10, takeSnapshot took 0 ms
2021-10-05 13:25:53,283 [61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:takeSnapshot(281)) - 61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-StateMachineUpdater: Took a snapshot at index 10
2021-10-05 13:25:53,283 [61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:lambda$new$0(89)) - 61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-StateMachineUpdater: snapshotIndex: updateIncreasingly 5 -> 10
2021-10-05 13:25:53,283 [61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:purge(306)) - 61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-SegmentedRaftLog: purge 10
2021-10-05 13:25:53,283 [61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - 61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-SegmentedRaftLog: snapshotIndex: updateIncreasingly 5 -> 10
2021-10-05 13:25:53,284 [61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - 61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-SegmentedRaftLog: purgeIndex: updateToMax old=0, new=10, updated? true
2021-10-05 13:25:53,563 [Listener at 127.0.0.1/10516] INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(235)) - Waiting for nodes to be ready. Got 2 of 3 DN Heartbeats.
2021-10-05 13:25:53,563 [Listener at 127.0.0.1/10516] INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(238)) - Waiting for cluster to exit safe mode
2021-10-05 13:25:53,563 [Listener at 127.0.0.1/10516] INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(240)) - SCM became leader
2021-10-05 13:25:53,622 [IPC Server handler 1 on default port 12121] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/c2216084-e141-4b27-afe8-b6c5968528ec
2021-10-05 13:25:53,622 [IPC Server handler 1 on default port 12121] INFO  node.SCMNodeManager (SCMNodeManager.java:register(389)) - Registered Data node : c2216084-e141-4b27-afe8-b6c5968528ec{ip: 127.0.0.1, host: localhost, ports: [REPLICATION=45329, RATIS=39195, RATIS_ADMIN=39195, RATIS_SERVER=39195, STANDALONE=37211], networkLocation: /default-rack, certSerialId: null, persistedOpState: null, persistedOpStateExpiryEpochSec: 0}
2021-10-05 13:25:53,622 [EventQueue-NewNodeForNewNodeHandler] INFO  pipeline.BackgroundPipelineCreator (BackgroundPipelineCreatorV2.java:notifyEventTriggered(285)) - trigger a one-shot run on RatisPipelineUtilsThread.
2021-10-05 13:25:53,623 [IPC Server handler 10 on default port 12131] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(112)) - Added a new node: /default-rack/c2216084-e141-4b27-afe8-b6c5968528ec
2021-10-05 13:25:53,623 [IPC Server handler 10 on default port 12131] INFO  node.SCMNodeManager (SCMNodeManager.java:register(389)) - Registered Data node : c2216084-e141-4b27-afe8-b6c5968528ec{ip: 127.0.0.1, host: localhost, ports: [REPLICATION=45329, RATIS=39195, RATIS_ADMIN=39195, RATIS_SERVER=39195, STANDALONE=37211], networkLocation: /default-rack, certSerialId: null, persistedOpState: null, persistedOpStateExpiryEpochSec: 0}
2021-10-05 13:25:53,623 [RatisPipelineUtilsThread - 0] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(183)) - Sending CreatePipelineCommand for pipeline:PipelineID=cdefc21d-4d0e-403d-8056-a4888bd7295a to datanode:c2216084-e141-4b27-afe8-b6c5968528ec
2021-10-05 13:25:53,623 [EventQueue-NodeRegistrationContainerReportForDataNodeSafeModeRule] INFO  safemode.SCMSafeModeManager (DataNodeSafeModeRule.java:process(71)) - SCM in safe mode. 3 DataNodes registered, 3 required.
2021-10-05 13:25:53,623 [EventQueue-NodeRegistrationContainerReportForDataNodeSafeModeRule] INFO  safemode.SCMSafeModeManager (SCMSafeModeManager.java:validateSafeModeExitRules(204)) - DataNodeSafeModeRule rule is successfully validated
2021-10-05 13:25:53,623 [EventQueue-NodeRegistrationContainerReportForDataNodeSafeModeRule] INFO  safemode.SCMSafeModeManager (SCMSafeModeManager.java:completePreCheck(233)) - All SCM safe mode pre check rules have passed
2021-10-05 13:25:53,623 [EventQueue-NodeRegistrationContainerReportForDataNodeSafeModeRule] WARN  events.EventQueue (EventQueue.java:fireEvent(194)) - No event handler registered for event TypedEvent{payloadType=SafeModeStatus, name='Safe mode status'}
2021-10-05 13:25:53,623 [EventQueue-NodeRegistrationContainerReportForDataNodeSafeModeRule] INFO  ha.SCMContext (SCMContext.java:updateSafeModeStatus(205)) - Update SafeModeStatus from SafeModeStatus{safeModeStatus=true, preCheckPassed=false} to SafeModeStatus{safeModeStatus=true, preCheckPassed=true}.
2021-10-05 13:25:53,624 [EventQueue-NodeRegistrationContainerReportForDataNodeSafeModeRule] INFO  pipeline.BackgroundPipelineCreator (BackgroundPipelineCreatorV2.java:notifyEventTriggered(285)) - trigger a one-shot run on RatisPipelineUtilsThread.
2021-10-05 13:25:53,624 [EventQueue-NewNodeForNewNodeHandler] INFO  pipeline.BackgroundPipelineCreator (BackgroundPipelineCreatorV2.java:notifyEventTriggered(279)) - ignore, not leader SCM.
2021-10-05 13:25:53,639 [b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-StateMachineUpdater] INFO  ha.SCMStateMachine (SCMStateMachine.java:takeSnapshot(290)) - Current Snapshot Index 10, takeSnapshot took 0 ms
2021-10-05 13:25:53,639 [b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:takeSnapshot(281)) - b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-StateMachineUpdater: Took a snapshot at index 10
2021-10-05 13:25:53,639 [b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:lambda$new$0(89)) - b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-StateMachineUpdater: snapshotIndex: updateIncreasingly 5 -> 10
2021-10-05 13:25:53,639 [b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:purge(306)) - b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-SegmentedRaftLog: purge 10
2021-10-05 13:25:53,640 [b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-SegmentedRaftLog: snapshotIndex: updateIncreasingly 5 -> 10
2021-10-05 13:25:53,640 [b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-SegmentedRaftLog: purgeIndex: updateToMax old=0, new=10, updated? true
2021-10-05 13:25:53,641 [61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-StateMachineUpdater] INFO  pipeline.PipelineStateManagerImpl (PipelineStateManagerImpl.java:addPipeline(101)) - Created pipeline Pipeline[ Id: cdefc21d-4d0e-403d-8056-a4888bd7295a, Nodes: c2216084-e141-4b27-afe8-b6c5968528ec{ip: 127.0.0.1, host: localhost, ports: [REPLICATION=45329, RATIS=39195, RATIS_ADMIN=39195, RATIS_SERVER=39195, STANDALONE=37211], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}, ReplicationConfig: RATIS/ONE, State:ALLOCATED, leaderId:, CreationTimestamp2021-10-05T13:25:53.623Z[Etc/UTC]].
2021-10-05 13:25:53,641 [61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-StateMachineUpdater] INFO  safemode.HealthyPipelineSafeModeRule (HealthyPipelineSafeModeRule.java:initializeRule(152)) - Refreshed total pipeline count is 0, healthy pipeline threshold count is 1
2021-10-05 13:25:53,641 [RatisPipelineUtilsThread - 0] INFO  ha.SCMHAInvocationHandler (SCMHAInvocationHandler.java:invokeRatis(113)) - Invoking method public abstract void org.apache.hadoop.hdds.scm.pipeline.PipelineStateManager.addPipeline(org.apache.hadoop.hdds.protocol.proto.HddsProtos$Pipeline) throws java.io.IOException on target org.apache.hadoop.hdds.scm.ha.SCMRatisServerImpl@183f041f, cost 17948.235us
2021-10-05 13:25:53,641 [RatisPipelineUtilsThread - 0] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(183)) - Sending CreatePipelineCommand for pipeline:PipelineID=70d43e9a-313f-4a40-8629-e674c48a3917 to datanode:2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc
2021-10-05 13:25:53,641 [RatisPipelineUtilsThread - 0] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(183)) - Sending CreatePipelineCommand for pipeline:PipelineID=70d43e9a-313f-4a40-8629-e674c48a3917 to datanode:c2216084-e141-4b27-afe8-b6c5968528ec
2021-10-05 13:25:53,641 [RatisPipelineUtilsThread - 0] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(183)) - Sending CreatePipelineCommand for pipeline:PipelineID=70d43e9a-313f-4a40-8629-e674c48a3917 to datanode:106bb174-548c-482f-98a0-a37141c57762
2021-10-05 13:25:53,647 [EventQueue-NodeRegistrationContainerReportForDataNodeSafeModeRule] INFO  safemode.SCMSafeModeManager (DataNodeSafeModeRule.java:process(71)) - SCM in safe mode. 3 DataNodes registered, 3 required.
2021-10-05 13:25:53,647 [EventQueue-NodeRegistrationContainerReportForDataNodeSafeModeRule] INFO  safemode.SCMSafeModeManager (SCMSafeModeManager.java:validateSafeModeExitRules(204)) - DataNodeSafeModeRule rule is successfully validated
2021-10-05 13:25:53,647 [EventQueue-NodeRegistrationContainerReportForDataNodeSafeModeRule] INFO  safemode.SCMSafeModeManager (SCMSafeModeManager.java:completePreCheck(233)) - All SCM safe mode pre check rules have passed
2021-10-05 13:25:53,647 [EventQueue-NodeRegistrationContainerReportForDataNodeSafeModeRule] WARN  events.EventQueue (EventQueue.java:fireEvent(194)) - No event handler registered for event TypedEvent{payloadType=SafeModeStatus, name='Safe mode status'}
2021-10-05 13:25:53,647 [EventQueue-NodeRegistrationContainerReportForDataNodeSafeModeRule] INFO  ha.SCMContext (SCMContext.java:updateSafeModeStatus(205)) - Update SafeModeStatus from SafeModeStatus{safeModeStatus=true, preCheckPassed=false} to SafeModeStatus{safeModeStatus=true, preCheckPassed=true}.
2021-10-05 13:25:53,647 [EventQueue-NodeRegistrationContainerReportForDataNodeSafeModeRule] INFO  pipeline.BackgroundPipelineCreator (BackgroundPipelineCreatorV2.java:notifyEventTriggered(279)) - ignore, not leader SCM.
2021-10-05 13:25:53,651 [b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-StateMachineUpdater] INFO  pipeline.PipelineStateManagerImpl (PipelineStateManagerImpl.java:addPipeline(101)) - Created pipeline Pipeline[ Id: cdefc21d-4d0e-403d-8056-a4888bd7295a, Nodes: c2216084-e141-4b27-afe8-b6c5968528ec{ip: 127.0.0.1, host: localhost, ports: [REPLICATION=45329, RATIS=39195, RATIS_ADMIN=39195, RATIS_SERVER=39195, STANDALONE=37211], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}, ReplicationConfig: RATIS/ONE, State:ALLOCATED, leaderId:, CreationTimestamp2021-10-05T13:25:53.623Z[Etc/UTC]].
2021-10-05 13:25:53,651 [b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-StateMachineUpdater] INFO  safemode.HealthyPipelineSafeModeRule (HealthyPipelineSafeModeRule.java:initializeRule(152)) - Refreshed total pipeline count is 0, healthy pipeline threshold count is 1
2021-10-05 13:25:53,653 [61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-StateMachineUpdater] INFO  pipeline.PipelineStateManagerImpl (PipelineStateManagerImpl.java:addPipeline(101)) - Created pipeline Pipeline[ Id: 70d43e9a-313f-4a40-8629-e674c48a3917, Nodes: 2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc{ip: 127.0.0.1, host: localhost, ports: [REPLICATION=42707, RATIS=45481, RATIS_ADMIN=45481, RATIS_SERVER=45481, STANDALONE=42383], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}c2216084-e141-4b27-afe8-b6c5968528ec{ip: 127.0.0.1, host: localhost, ports: [REPLICATION=45329, RATIS=39195, RATIS_ADMIN=39195, RATIS_SERVER=39195, STANDALONE=37211], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}106bb174-548c-482f-98a0-a37141c57762{ip: 127.0.0.1, host: localhost, ports: [REPLICATION=38747, RATIS=43635, RATIS_ADMIN=43635, RATIS_SERVER=43635, STANDALONE=45889], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}, ReplicationConfig: RATIS/THREE, State:ALLOCATED, leaderId:, CreationTimestamp2021-10-05T13:25:53.641Z[Etc/UTC]].
2021-10-05 13:25:53,654 [61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-StateMachineUpdater] INFO  safemode.HealthyPipelineSafeModeRule (HealthyPipelineSafeModeRule.java:initializeRule(152)) - Refreshed total pipeline count is 0, healthy pipeline threshold count is 1
2021-10-05 13:25:53,654 [RatisPipelineUtilsThread - 0] INFO  ha.SCMHAInvocationHandler (SCMHAInvocationHandler.java:invokeRatis(113)) - Invoking method public abstract void org.apache.hadoop.hdds.scm.pipeline.PipelineStateManager.addPipeline(org.apache.hadoop.hdds.protocol.proto.HddsProtos$Pipeline) throws java.io.IOException on target org.apache.hadoop.hdds.scm.ha.SCMRatisServerImpl@183f041f, cost 12456.204us
2021-10-05 13:25:53,654 [RatisPipelineUtilsThread - 0] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(183)) - Sending CreatePipelineCommand for pipeline:PipelineID=695b8808-dd40-42c0-a85d-c784995f1f78 to datanode:106bb174-548c-482f-98a0-a37141c57762
2021-10-05 13:25:53,654 [RatisPipelineUtilsThread - 0] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(183)) - Sending CreatePipelineCommand for pipeline:PipelineID=695b8808-dd40-42c0-a85d-c784995f1f78 to datanode:c2216084-e141-4b27-afe8-b6c5968528ec
2021-10-05 13:25:53,654 [RatisPipelineUtilsThread - 0] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(183)) - Sending CreatePipelineCommand for pipeline:PipelineID=695b8808-dd40-42c0-a85d-c784995f1f78 to datanode:2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc
2021-10-05 13:25:53,658 [b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-StateMachineUpdater] INFO  pipeline.PipelineStateManagerImpl (PipelineStateManagerImpl.java:addPipeline(101)) - Created pipeline Pipeline[ Id: 70d43e9a-313f-4a40-8629-e674c48a3917, Nodes: 2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc{ip: 127.0.0.1, host: localhost, ports: [REPLICATION=42707, RATIS=45481, RATIS_ADMIN=45481, RATIS_SERVER=45481, STANDALONE=42383], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}c2216084-e141-4b27-afe8-b6c5968528ec{ip: 127.0.0.1, host: localhost, ports: [REPLICATION=45329, RATIS=39195, RATIS_ADMIN=39195, RATIS_SERVER=39195, STANDALONE=37211], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}106bb174-548c-482f-98a0-a37141c57762{ip: 127.0.0.1, host: localhost, ports: [REPLICATION=38747, RATIS=43635, RATIS_ADMIN=43635, RATIS_SERVER=43635, STANDALONE=45889], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}, ReplicationConfig: RATIS/THREE, State:ALLOCATED, leaderId:, CreationTimestamp2021-10-05T13:25:53.641Z[Etc/UTC]].
2021-10-05 13:25:53,658 [b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-StateMachineUpdater] INFO  safemode.HealthyPipelineSafeModeRule (HealthyPipelineSafeModeRule.java:initializeRule(152)) - Refreshed total pipeline count is 0, healthy pipeline threshold count is 1
2021-10-05 13:25:53,671 [61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-StateMachineUpdater] INFO  pipeline.PipelineStateManagerImpl (PipelineStateManagerImpl.java:addPipeline(101)) - Created pipeline Pipeline[ Id: 695b8808-dd40-42c0-a85d-c784995f1f78, Nodes: 106bb174-548c-482f-98a0-a37141c57762{ip: 127.0.0.1, host: localhost, ports: [REPLICATION=38747, RATIS=43635, RATIS_ADMIN=43635, RATIS_SERVER=43635, STANDALONE=45889], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}c2216084-e141-4b27-afe8-b6c5968528ec{ip: 127.0.0.1, host: localhost, ports: [REPLICATION=45329, RATIS=39195, RATIS_ADMIN=39195, RATIS_SERVER=39195, STANDALONE=37211], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc{ip: 127.0.0.1, host: localhost, ports: [REPLICATION=42707, RATIS=45481, RATIS_ADMIN=45481, RATIS_SERVER=45481, STANDALONE=42383], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}, ReplicationConfig: RATIS/THREE, State:ALLOCATED, leaderId:, CreationTimestamp2021-10-05T13:25:53.654Z[Etc/UTC]].
2021-10-05 13:25:53,671 [61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-StateMachineUpdater] INFO  safemode.HealthyPipelineSafeModeRule (HealthyPipelineSafeModeRule.java:initializeRule(152)) - Refreshed total pipeline count is 0, healthy pipeline threshold count is 1
2021-10-05 13:25:53,671 [RatisPipelineUtilsThread - 0] INFO  ha.SCMHAInvocationHandler (SCMHAInvocationHandler.java:invokeRatis(113)) - Invoking method public abstract void org.apache.hadoop.hdds.scm.pipeline.PipelineStateManager.addPipeline(org.apache.hadoop.hdds.protocol.proto.HddsProtos$Pipeline) throws java.io.IOException on target org.apache.hadoop.hdds.scm.ha.SCMRatisServerImpl@183f041f, cost 16699.014us
2021-10-05 13:25:53,671 [RatisPipelineUtilsThread - 0] INFO  pipeline.PipelineManagerImpl (PipelineManagerImpl.java:recordMetricsForPipeline(613)) - Pipeline: PipelineID=695b8808-dd40-42c0-a85d-c784995f1f78 contains same datanodes as previous pipelines: PipelineID=70d43e9a-313f-4a40-8629-e674c48a3917 nodeIds: 106bb174-548c-482f-98a0-a37141c57762, c2216084-e141-4b27-afe8-b6c5968528ec, 2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc
2021-10-05 13:25:53,673 [61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-StateMachineUpdater] INFO  ha.SCMStateMachine (SCMStateMachine.java:takeSnapshot(290)) - Current Snapshot Index 15, takeSnapshot took 3 ms
2021-10-05 13:25:53,673 [61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:takeSnapshot(281)) - 61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-StateMachineUpdater: Took a snapshot at index 15
2021-10-05 13:25:53,673 [61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:lambda$new$0(89)) - 61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-StateMachineUpdater: snapshotIndex: updateIncreasingly 10 -> 15
2021-10-05 13:25:53,673 [61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:purge(306)) - 61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-SegmentedRaftLog: purge 15
2021-10-05 13:25:53,673 [61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - 61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-SegmentedRaftLog: snapshotIndex: updateIncreasingly 10 -> 15
2021-10-05 13:25:53,674 [61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - 61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-SegmentedRaftLog: purgeIndex: updateToMax old=10, new=15, updated? true
2021-10-05 13:25:53,674 [b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-StateMachineUpdater] INFO  pipeline.PipelineStateManagerImpl (PipelineStateManagerImpl.java:addPipeline(101)) - Created pipeline Pipeline[ Id: 695b8808-dd40-42c0-a85d-c784995f1f78, Nodes: 106bb174-548c-482f-98a0-a37141c57762{ip: 127.0.0.1, host: localhost, ports: [REPLICATION=38747, RATIS=43635, RATIS_ADMIN=43635, RATIS_SERVER=43635, STANDALONE=45889], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}c2216084-e141-4b27-afe8-b6c5968528ec{ip: 127.0.0.1, host: localhost, ports: [REPLICATION=45329, RATIS=39195, RATIS_ADMIN=39195, RATIS_SERVER=39195, STANDALONE=37211], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc{ip: 127.0.0.1, host: localhost, ports: [REPLICATION=42707, RATIS=45481, RATIS_ADMIN=45481, RATIS_SERVER=45481, STANDALONE=42383], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}, ReplicationConfig: RATIS/THREE, State:ALLOCATED, leaderId:, CreationTimestamp2021-10-05T13:25:53.654Z[Etc/UTC]].
2021-10-05 13:25:53,674 [b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-StateMachineUpdater] INFO  safemode.HealthyPipelineSafeModeRule (HealthyPipelineSafeModeRule.java:initializeRule(152)) - Refreshed total pipeline count is 0, healthy pipeline threshold count is 1
2021-10-05 13:25:53,680 [b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-StateMachineUpdater] INFO  ha.SCMStateMachine (SCMStateMachine.java:takeSnapshot(290)) - Current Snapshot Index 15, takeSnapshot took 0 ms
2021-10-05 13:25:53,680 [b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:takeSnapshot(281)) - b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-StateMachineUpdater: Took a snapshot at index 15
2021-10-05 13:25:53,680 [b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:lambda$new$0(89)) - b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-StateMachineUpdater: snapshotIndex: updateIncreasingly 10 -> 15
2021-10-05 13:25:53,680 [b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:purge(306)) - b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-SegmentedRaftLog: purge 15
2021-10-05 13:25:53,680 [b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-SegmentedRaftLog: snapshotIndex: updateIncreasingly 10 -> 15
2021-10-05 13:25:53,680 [b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-SegmentedRaftLog: purgeIndex: updateToMax old=10, new=15, updated? true
2021-10-05 13:25:53,782 [EndpointStateMachine task thread for /127.0.0.1:15041 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15041. Already tried 0 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:53,842 [EndpointStateMachine task thread for /127.0.0.1:13549 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:13549. Already tried 6 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:53,846 [EndpointStateMachine task thread for /127.0.0.1:13529 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:13529. Already tried 6 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:53,852 [EndpointStateMachine task thread for /127.0.0.1:15021 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15021. Already tried 4 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:53,853 [EndpointStateMachine task thread for /127.0.0.1:15031 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15031. Already tried 4 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:53,961 [EndpointStateMachine task thread for /127.0.0.1:13539 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:13539. Already tried 5 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:54,563 [Listener at 127.0.0.1/10516] INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(235)) - Nodes are ready. Got 3 of 3 DN Heartbeats.
2021-10-05 13:25:54,564 [Listener at 127.0.0.1/10516] INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(238)) - Waiting for cluster to exit safe mode
2021-10-05 13:25:54,564 [Listener at 127.0.0.1/10516] INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(240)) - SCM became leader
2021-10-05 13:25:54,782 [EndpointStateMachine task thread for /127.0.0.1:15041 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15041. Already tried 1 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:54,839 [Datanode State Machine Thread - 0] ERROR datanode.RunningDatanodeState (RunningDatanodeState.java:computeNextContainerState(199)) - Error in executing end point task.
java.util.concurrent.ExecutionException: java.util.concurrent.TimeoutException
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.hadoop.ozone.container.common.states.datanode.RunningDatanodeState.computeNextContainerState(RunningDatanodeState.java:191)
	at org.apache.hadoop.ozone.container.common.states.datanode.RunningDatanodeState.await(RunningDatanodeState.java:231)
	at org.apache.hadoop.ozone.container.common.states.datanode.RunningDatanodeState.await(RunningDatanodeState.java:50)
	at org.apache.hadoop.ozone.container.common.statemachine.StateContext.execute(StateContext.java:629)
	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.start(DatanodeStateMachine.java:270)
	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.lambda$startDaemon$0(DatanodeStateMachine.java:457)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.util.concurrent.TimeoutException
	at java.util.concurrent.FutureTask.get(FutureTask.java:205)
	at org.apache.hadoop.ozone.container.common.states.datanode.RunningDatanodeState.lambda$execute$0(RunningDatanodeState.java:149)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
2021-10-05 13:25:54,846 [EndpointStateMachine task thread for /127.0.0.1:13529 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:13529. Already tried 7 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:54,849 [EndpointStateMachine task thread for /127.0.0.1:13549 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:13549. Already tried 7 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:54,852 [EndpointStateMachine task thread for /127.0.0.1:15021 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15021. Already tried 5 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:54,854 [EndpointStateMachine task thread for /127.0.0.1:15031 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15031. Already tried 5 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:54,961 [EndpointStateMachine task thread for /127.0.0.1:13539 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:13539. Already tried 6 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:55,564 [Listener at 127.0.0.1/10516] INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(235)) - Nodes are ready. Got 3 of 3 DN Heartbeats.
2021-10-05 13:25:55,564 [Listener at 127.0.0.1/10516] INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(238)) - Waiting for cluster to exit safe mode
2021-10-05 13:25:55,564 [Listener at 127.0.0.1/10516] INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(240)) - SCM became leader
2021-10-05 13:25:55,783 [EndpointStateMachine task thread for /127.0.0.1:15041 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15041. Already tried 2 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:55,842 [Datanode State Machine Thread - 0] ERROR datanode.RunningDatanodeState (RunningDatanodeState.java:computeNextContainerState(199)) - Error in executing end point task.
java.util.concurrent.ExecutionException: java.util.concurrent.TimeoutException
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.hadoop.ozone.container.common.states.datanode.RunningDatanodeState.computeNextContainerState(RunningDatanodeState.java:191)
	at org.apache.hadoop.ozone.container.common.states.datanode.RunningDatanodeState.await(RunningDatanodeState.java:231)
	at org.apache.hadoop.ozone.container.common.states.datanode.RunningDatanodeState.await(RunningDatanodeState.java:50)
	at org.apache.hadoop.ozone.container.common.statemachine.StateContext.execute(StateContext.java:629)
	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.start(DatanodeStateMachine.java:270)
	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.lambda$startDaemon$0(DatanodeStateMachine.java:457)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.util.concurrent.TimeoutException
	at java.util.concurrent.FutureTask.get(FutureTask.java:205)
	at org.apache.hadoop.ozone.container.common.states.datanode.RunningDatanodeState.lambda$execute$0(RunningDatanodeState.java:149)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
2021-10-05 13:25:55,847 [EndpointStateMachine task thread for /127.0.0.1:13529 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:13529. Already tried 8 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:55,845 [Command processor thread] INFO  server.RaftServer (RaftServerProxy.java:addNew(95)) - 2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc: addNew group-15090DED4481:[2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc|rpc:127.0.0.1:45481|priority:1] returns group-15090DED4481:java.util.concurrent.CompletableFuture@758d3ffd[Not completed]
2021-10-05 13:25:55,858 [EndpointStateMachine task thread for /127.0.0.1:13549 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:13549. Already tried 8 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:55,854 [EndpointStateMachine task thread for /127.0.0.1:15031 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15031. Already tried 6 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:55,854 [EndpointStateMachine task thread for /127.0.0.1:12141 - 0 ] WARN  statemachine.EndpointStateMachine (EndpointStateMachine.java:logIfNeeded(236)) - Unable to communicate to SCM server at 127.0.0.1:12141 for past 0 seconds.
java.net.SocketTimeoutException: Call From fv-az270-324/10.1.0.10 to localhost:12141 failed on socket timeout exception: java.net.SocketTimeoutException: 5000 millis timeout while waiting for channel to be ready for read. ch : java.nio.channels.SocketChannel[connected local=/127.0.0.1:55346 remote=/127.0.0.1:12141]; For more details see:  http://wiki.apache.org/hadoop/SocketTimeout
	at sun.reflect.GeneratedConstructorAccessor31.newInstance(Unknown Source)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.hadoop.net.NetUtils.wrapWithMessage(NetUtils.java:913)
	at org.apache.hadoop.net.NetUtils.wrapException(NetUtils.java:848)
	at org.apache.hadoop.ipc.Client.getRpcResponse(Client.java:1577)
	at org.apache.hadoop.ipc.Client.call(Client.java:1519)
	at org.apache.hadoop.ipc.Client.call(Client.java:1416)
	at org.apache.hadoop.ipc.ProtobufRpcEngine$Invoker.invoke(ProtobufRpcEngine.java:236)
	at org.apache.hadoop.ipc.ProtobufRpcEngine$Invoker.invoke(ProtobufRpcEngine.java:123)
	at com.sun.proxy.$Proxy48.submitRequest(Unknown Source)
	at org.apache.hadoop.ozone.protocolPB.StorageContainerDatanodeProtocolClientSideTranslatorPB.submitRequest(StorageContainerDatanodeProtocolClientSideTranslatorPB.java:117)
	at org.apache.hadoop.ozone.protocolPB.StorageContainerDatanodeProtocolClientSideTranslatorPB.getVersion(StorageContainerDatanodeProtocolClientSideTranslatorPB.java:133)
	at org.apache.hadoop.ozone.container.common.states.endpoint.VersionEndpointTask.call(VersionEndpointTask.java:71)
	at org.apache.hadoop.ozone.container.common.states.endpoint.VersionEndpointTask.call(VersionEndpointTask.java:42)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.net.SocketTimeoutException: 5000 millis timeout while waiting for channel to be ready for read. ch : java.nio.channels.SocketChannel[connected local=/127.0.0.1:55346 remote=/127.0.0.1:12141]
	at org.apache.hadoop.net.SocketIOWithTimeout.doIO(SocketIOWithTimeout.java:164)
	at org.apache.hadoop.net.SocketInputStream.read(SocketInputStream.java:161)
	at org.apache.hadoop.net.SocketInputStream.read(SocketInputStream.java:131)
	at java.io.FilterInputStream.read(FilterInputStream.java:133)
	at java.io.BufferedInputStream.fill(BufferedInputStream.java:246)
	at java.io.BufferedInputStream.read(BufferedInputStream.java:265)
	at java.io.FilterInputStream.read(FilterInputStream.java:83)
	at java.io.FilterInputStream.read(FilterInputStream.java:83)
	at org.apache.hadoop.ipc.Client$Connection$PingInputStream.read(Client.java:563)
	at java.io.DataInputStream.readInt(DataInputStream.java:387)
	at org.apache.hadoop.ipc.Client$IpcStreams.readResponse(Client.java:1892)
	at org.apache.hadoop.ipc.Client$Connection.receiveRpcResponse(Client.java:1202)
	at org.apache.hadoop.ipc.Client$Connection.run(Client.java:1098)
2021-10-05 13:25:55,854 [EndpointStateMachine task thread for /127.0.0.1:12141 - 0 ] WARN  statemachine.EndpointStateMachine (EndpointStateMachine.java:logIfNeeded(236)) - Unable to communicate to SCM server at 127.0.0.1:12141 for past 0 seconds.
java.net.SocketTimeoutException: Call From fv-az270-324/10.1.0.10 to localhost:12141 failed on socket timeout exception: java.net.SocketTimeoutException: 5000 millis timeout while waiting for channel to be ready for read. ch : java.nio.channels.SocketChannel[connected local=/127.0.0.1:55346 remote=/127.0.0.1:12141]; For more details see:  http://wiki.apache.org/hadoop/SocketTimeout
	at sun.reflect.GeneratedConstructorAccessor31.newInstance(Unknown Source)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.hadoop.net.NetUtils.wrapWithMessage(NetUtils.java:913)
	at org.apache.hadoop.net.NetUtils.wrapException(NetUtils.java:848)
	at org.apache.hadoop.ipc.Client.getRpcResponse(Client.java:1577)
	at org.apache.hadoop.ipc.Client.call(Client.java:1519)
	at org.apache.hadoop.ipc.Client.call(Client.java:1416)
	at org.apache.hadoop.ipc.ProtobufRpcEngine$Invoker.invoke(ProtobufRpcEngine.java:236)
	at org.apache.hadoop.ipc.ProtobufRpcEngine$Invoker.invoke(ProtobufRpcEngine.java:123)
	at com.sun.proxy.$Proxy48.submitRequest(Unknown Source)
	at org.apache.hadoop.ozone.protocolPB.StorageContainerDatanodeProtocolClientSideTranslatorPB.submitRequest(StorageContainerDatanodeProtocolClientSideTranslatorPB.java:117)
	at org.apache.hadoop.ozone.protocolPB.StorageContainerDatanodeProtocolClientSideTranslatorPB.getVersion(StorageContainerDatanodeProtocolClientSideTranslatorPB.java:133)
	at org.apache.hadoop.ozone.container.common.states.endpoint.VersionEndpointTask.call(VersionEndpointTask.java:71)
	at org.apache.hadoop.ozone.container.common.states.endpoint.VersionEndpointTask.call(VersionEndpointTask.java:42)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.net.SocketTimeoutException: 5000 millis timeout while waiting for channel to be ready for read. ch : java.nio.channels.SocketChannel[connected local=/127.0.0.1:55346 remote=/127.0.0.1:12141]
	at org.apache.hadoop.net.SocketIOWithTimeout.doIO(SocketIOWithTimeout.java:164)
	at org.apache.hadoop.net.SocketInputStream.read(SocketInputStream.java:161)
	at org.apache.hadoop.net.SocketInputStream.read(SocketInputStream.java:131)
	at java.io.FilterInputStream.read(FilterInputStream.java:133)
	at java.io.BufferedInputStream.fill(BufferedInputStream.java:246)
	at java.io.BufferedInputStream.read(BufferedInputStream.java:265)
	at java.io.FilterInputStream.read(FilterInputStream.java:83)
	at java.io.FilterInputStream.read(FilterInputStream.java:83)
	at org.apache.hadoop.ipc.Client$Connection$PingInputStream.read(Client.java:563)
	at java.io.DataInputStream.readInt(DataInputStream.java:387)
	at org.apache.hadoop.ipc.Client$IpcStreams.readResponse(Client.java:1892)
	at org.apache.hadoop.ipc.Client$Connection.receiveRpcResponse(Client.java:1202)
	at org.apache.hadoop.ipc.Client$Connection.run(Client.java:1098)
2021-10-05 13:25:55,854 [EndpointStateMachine task thread for /127.0.0.1:12141 - 0 ] WARN  statemachine.EndpointStateMachine (EndpointStateMachine.java:logIfNeeded(236)) - Unable to communicate to SCM server at localhost:12141 for past 0 seconds.
java.net.SocketTimeoutException: Call From fv-az270-324/10.1.0.10 to localhost:12141 failed on socket timeout exception: java.net.SocketTimeoutException: 5000 millis timeout while waiting for channel to be ready for read. ch : java.nio.channels.SocketChannel[connected local=/127.0.0.1:55346 remote=/127.0.0.1:12141]; For more details see:  http://wiki.apache.org/hadoop/SocketTimeout
	at sun.reflect.GeneratedConstructorAccessor31.newInstance(Unknown Source)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.hadoop.net.NetUtils.wrapWithMessage(NetUtils.java:913)
	at org.apache.hadoop.net.NetUtils.wrapException(NetUtils.java:848)
	at org.apache.hadoop.ipc.Client.getRpcResponse(Client.java:1577)
	at org.apache.hadoop.ipc.Client.call(Client.java:1519)
	at org.apache.hadoop.ipc.Client.call(Client.java:1416)
	at org.apache.hadoop.ipc.ProtobufRpcEngine$Invoker.invoke(ProtobufRpcEngine.java:236)
	at org.apache.hadoop.ipc.ProtobufRpcEngine$Invoker.invoke(ProtobufRpcEngine.java:123)
	at com.sun.proxy.$Proxy48.submitRequest(Unknown Source)
	at org.apache.hadoop.ozone.protocolPB.StorageContainerDatanodeProtocolClientSideTranslatorPB.submitRequest(StorageContainerDatanodeProtocolClientSideTranslatorPB.java:117)
	at org.apache.hadoop.ozone.protocolPB.StorageContainerDatanodeProtocolClientSideTranslatorPB.getVersion(StorageContainerDatanodeProtocolClientSideTranslatorPB.java:133)
	at org.apache.hadoop.ozone.container.common.states.endpoint.VersionEndpointTask.call(VersionEndpointTask.java:71)
	at org.apache.hadoop.ozone.container.common.states.endpoint.VersionEndpointTask.call(VersionEndpointTask.java:42)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.net.SocketTimeoutException: 5000 millis timeout while waiting for channel to be ready for read. ch : java.nio.channels.SocketChannel[connected local=/127.0.0.1:55346 remote=/127.0.0.1:12141]
	at org.apache.hadoop.net.SocketIOWithTimeout.doIO(SocketIOWithTimeout.java:164)
	at org.apache.hadoop.net.SocketInputStream.read(SocketInputStream.java:161)
	at org.apache.hadoop.net.SocketInputStream.read(SocketInputStream.java:131)
	at java.io.FilterInputStream.read(FilterInputStream.java:133)
	at java.io.BufferedInputStream.fill(BufferedInputStream.java:246)
	at java.io.BufferedInputStream.read(BufferedInputStream.java:265)
	at java.io.FilterInputStream.read(FilterInputStream.java:83)
	at java.io.FilterInputStream.read(FilterInputStream.java:83)
	at org.apache.hadoop.ipc.Client$Connection$PingInputStream.read(Client.java:563)
	at java.io.DataInputStream.readInt(DataInputStream.java:387)
	at org.apache.hadoop.ipc.Client$IpcStreams.readResponse(Client.java:1892)
	at org.apache.hadoop.ipc.Client$Connection.receiveRpcResponse(Client.java:1202)
	at org.apache.hadoop.ipc.Client$Connection.run(Client.java:1098)
2021-10-05 13:25:55,854 [EndpointStateMachine task thread for /127.0.0.1:15021 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15021. Already tried 6 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:55,878 [pool-433-thread-1] INFO  server.RaftServer$Division (RaftServerImpl.java:<init>(181)) - 2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc: new RaftServerImpl for group-15090DED4481:[2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc|rpc:127.0.0.1:45481|priority:1] with ContainerStateMachine:uninitialized
2021-10-05 13:25:55,880 [pool-433-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.timeout.min = 5s (custom)
2021-10-05 13:25:55,880 [pool-433-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.timeout.max = 5200ms (custom)
2021-10-05 13:25:55,880 [pool-433-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.sleep.time = 25ms (default)
2021-10-05 13:25:55,880 [pool-433-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.slowness.timeout = 300s (custom)
2021-10-05 13:25:55,880 [pool-433-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.leaderelection.leader.step-down.wait-time = 10s (default)
2021-10-05 13:25:55,880 [pool-433-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.sleep.deviation.threshold = 300ms (default)
2021-10-05 13:25:55,880 [pool-433-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.appender.install.snapshot.enabled = false (custom)
2021-10-05 13:25:55,880 [pool-433-thread-1] INFO  server.RaftServer$Division (ServerState.java:<init>(105)) - 2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc@group-15090DED4481: ConfigurationManager, init=-1: [2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc|rpc:127.0.0.1:45481|priority:1], old=null, confs=<EMPTY_MAP>
2021-10-05 13:25:55,880 [pool-433-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.storage.dir = [/home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-62d231c0-d845-4dcd-88aa-c082e017c57e/datanode-0/data/ratis] (custom)
2021-10-05 13:25:55,880 [pool-433-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.corruption.policy = EXCEPTION (default)
2021-10-05 13:25:55,880 [pool-433-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.storage.free-space.min = 0MB (=0) (default)
2021-10-05 13:25:55,881 [pool-433-thread-1] INFO  storage.RaftStorageDirectory (RaftStorageDirectoryImpl.java:analyzeStorage(135)) - The storage directory /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-62d231c0-d845-4dcd-88aa-c082e017c57e/datanode-0/data/ratis/b98fb588-c6d1-40ce-b522-15090ded4481 does not exist. Creating ...
2021-10-05 13:25:55,882 [pool-433-thread-1] INFO  storage.RaftStorageDirectory (RaftStorageDirectoryImpl.java:tryLock(230)) - Lock on /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-62d231c0-d845-4dcd-88aa-c082e017c57e/datanode-0/data/ratis/b98fb588-c6d1-40ce-b522-15090ded4481/in_use.lock acquired by nodename 17451@fv-az270-324
2021-10-05 13:25:55,890 [pool-433-thread-1] INFO  storage.RaftStorage (RaftStorageImpl.java:format(89)) - Storage directory /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-62d231c0-d845-4dcd-88aa-c082e017c57e/datanode-0/data/ratis/b98fb588-c6d1-40ce-b522-15090ded4481 has been successfully formatted.
2021-10-05 13:25:55,890 [pool-433-thread-1] INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(224)) - group-15090DED4481: The snapshot info is null. Setting the last applied indexto:(t:0, i:~)
2021-10-05 13:25:55,891 [pool-433-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.notification.no-leader.timeout = 300s (custom)
2021-10-05 13:25:55,891 [pool-433-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.use.memory = false (default)
2021-10-05 13:25:55,891 [pool-433-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.purge.gap = 1000000 (custom)
2021-10-05 13:25:55,891 [EventQueue-PipelineReportForPipelineReportHandler] INFO  pipeline.PipelineManagerImpl (PipelineManagerImpl.java:openPipeline(282)) - Pipeline Pipeline[ Id: b98fb588-c6d1-40ce-b522-15090ded4481, Nodes: 2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc{ip: 127.0.0.1, host: localhost, ports: [REPLICATION=42707, RATIS=45481, RATIS_ADMIN=45481, RATIS_SERVER=45481, STANDALONE=42383], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}, ReplicationConfig: RATIS/ONE, State:ALLOCATED, leaderId:2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc, CreationTimestamp2021-10-05T13:25:52.864Z[Etc/UTC]] moved to OPEN state
2021-10-05 13:25:55,891 [EventQueue-PipelineReportForPipelineReportHandler] INFO  pipeline.PipelineManagerImpl (PipelineManagerImpl.java:openPipeline(282)) - Pipeline Pipeline[ Id: b98fb588-c6d1-40ce-b522-15090ded4481, Nodes: 2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc{ip: 127.0.0.1, host: localhost, ports: [REPLICATION=42707, RATIS=45481, RATIS_ADMIN=45481, RATIS_SERVER=45481, STANDALONE=42383], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}, ReplicationConfig: RATIS/ONE, State:ALLOCATED, leaderId:2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc, CreationTimestamp2021-10-05T13:25:52.864Z[Etc/UTC]] moved to OPEN state
2021-10-05 13:25:55,892 [pool-433-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2021-10-05 13:25:55,892 [pool-433-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.segment.size.max = 1048576 (custom)
2021-10-05 13:25:55,892 [pool-433-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.segment.cache.num.max = 2 (custom)
2021-10-05 13:25:55,892 [pool-433-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.segment.cache.size.max = 200MB (=209715200) (default)
2021-10-05 13:25:55,892 [pool-433-thread-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:<init>(182)) - new 2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc@group-15090DED4481-SegmentedRaftLogWorker for RaftStorageImpl:Storage Directory /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-62d231c0-d845-4dcd-88aa-c082e017c57e/datanode-0/data/ratis/b98fb588-c6d1-40ce-b522-15090ded4481
2021-10-05 13:25:55,892 [pool-433-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2021-10-05 13:25:55,893 [pool-433-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.queue.element-limit = 1024 (custom)
2021-10-05 13:25:55,893 [pool-433-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.segment.size.max = 1048576 (custom)
2021-10-05 13:25:55,893 [pool-433-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.preallocated.size = 16384 (custom)
2021-10-05 13:25:55,893 [pool-433-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.force.sync.num = 128 (default)
2021-10-05 13:25:55,893 [pool-433-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.statemachine.data.sync = true (default)
2021-10-05 13:25:55,893 [pool-433-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2021-10-05 13:25:55,893 [pool-433-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2021-10-05 13:25:55,894 [pool-433-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.write.buffer.size = 1048576 (custom)
2021-10-05 13:25:55,894 [pool-433-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2021-10-05 13:25:55,895 [pool-433-thread-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:lambda$new$0(133)) - 2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc@group-15090DED4481-SegmentedRaftLogWorker: flushIndex: setUnconditionally 0 -> -1
2021-10-05 13:25:55,895 [pool-433-thread-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:lambda$new$0(133)) - 2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc@group-15090DED4481-SegmentedRaftLogWorker: safeCacheEvictIndex: setUnconditionally 0 -> -1
2021-10-05 13:25:55,911 [pool-433-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2021-10-05 13:25:55,911 [pool-433-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2021-10-05 13:25:55,911 [pool-433-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.snapshot.retention.file.num = 5 (custom)
2021-10-05 13:25:55,911 [pool-433-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.purge.upto.snapshot.index = false (default)
2021-10-05 13:25:55,911 [pool-433-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.retrycache.expirytime = 600000ms (custom)
2021-10-05 13:25:55,911 [pool-433-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.retrycache.statistics.expirytime = 100μs (default)
2021-10-05 13:25:55,912 [pool-433-thread-1] INFO  server.RaftServer$Division (RaftServerImpl.java:start(296)) - 2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc@group-15090DED4481: start as a follower, conf=-1: [2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc|rpc:127.0.0.1:45481|priority:1], old=null
2021-10-05 13:25:55,912 [pool-433-thread-1] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(285)) - 2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc@group-15090DED4481: changes role from      null to FOLLOWER at term 0 for startAsFollower
2021-10-05 13:25:55,912 [pool-433-thread-1] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(130)) - 2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc: start 2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc@group-15090DED4481-FollowerState
2021-10-05 13:25:55,923 [EventQueue-PipelineReportForPipelineReportHandler] INFO  ha.SCMHAInvocationHandler (SCMHAInvocationHandler.java:invokeRatis(113)) - Invoking method public abstract void org.apache.hadoop.hdds.scm.pipeline.PipelineStateManager.updatePipelineState(org.apache.hadoop.hdds.protocol.proto.HddsProtos$PipelineID,org.apache.hadoop.hdds.protocol.proto.HddsProtos$PipelineState) throws java.io.IOException on target org.apache.hadoop.hdds.scm.ha.SCMRatisServerImpl@1ffe502, cost 31405.333us
2021-10-05 13:25:55,923 [pool-433-thread-1] INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-15090DED4481,id=2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc
2021-10-05 13:25:55,927 [Command processor thread] INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:addGroup(763)) - Created group PipelineID=b98fb588-c6d1-40ce-b522-15090ded4481
2021-10-05 13:25:55,927 [Command processor thread] INFO  commandhandler.CreatePipelineCommandHandler (CreatePipelineCommandHandler.java:handle(106)) - Created Pipeline RATIS ONE PipelineID=b98fb588-c6d1-40ce-b522-15090ded4481.
2021-10-05 13:25:55,928 [Command processor thread] INFO  server.RaftServer (RaftServerProxy.java:addNew(95)) - 2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc: addNew group-E674C48A3917:[2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc|rpc:127.0.0.1:45481|priority:0, c2216084-e141-4b27-afe8-b6c5968528ec|rpc:127.0.0.1:39195|priority:1, 106bb174-548c-482f-98a0-a37141c57762|rpc:127.0.0.1:43635|priority:0] returns group-E674C48A3917:java.util.concurrent.CompletableFuture@71b2b594[Not completed]
2021-10-05 13:25:55,947 [pool-433-thread-1] INFO  server.RaftServer$Division (RaftServerImpl.java:<init>(181)) - 2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc: new RaftServerImpl for group-E674C48A3917:[2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc|rpc:127.0.0.1:45481|priority:0, c2216084-e141-4b27-afe8-b6c5968528ec|rpc:127.0.0.1:39195|priority:1, 106bb174-548c-482f-98a0-a37141c57762|rpc:127.0.0.1:43635|priority:0] with ContainerStateMachine:uninitialized
2021-10-05 13:25:55,947 [pool-433-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.timeout.min = 5s (custom)
2021-10-05 13:25:55,947 [pool-433-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.timeout.max = 5200ms (custom)
2021-10-05 13:25:55,947 [pool-433-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.sleep.time = 25ms (default)
2021-10-05 13:25:55,947 [pool-433-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.slowness.timeout = 300s (custom)
2021-10-05 13:25:55,947 [pool-433-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.leaderelection.leader.step-down.wait-time = 10s (default)
2021-10-05 13:25:55,947 [pool-433-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.sleep.deviation.threshold = 300ms (default)
2021-10-05 13:25:55,947 [pool-433-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.appender.install.snapshot.enabled = false (custom)
2021-10-05 13:25:55,947 [pool-433-thread-1] INFO  server.RaftServer$Division (ServerState.java:<init>(105)) - 2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc@group-E674C48A3917: ConfigurationManager, init=-1: [2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc|rpc:127.0.0.1:45481|priority:0, c2216084-e141-4b27-afe8-b6c5968528ec|rpc:127.0.0.1:39195|priority:1, 106bb174-548c-482f-98a0-a37141c57762|rpc:127.0.0.1:43635|priority:0], old=null, confs=<EMPTY_MAP>
2021-10-05 13:25:55,947 [pool-433-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.storage.dir = [/home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-62d231c0-d845-4dcd-88aa-c082e017c57e/datanode-0/data/ratis] (custom)
2021-10-05 13:25:55,947 [pool-433-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.corruption.policy = EXCEPTION (default)
2021-10-05 13:25:55,947 [pool-433-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.storage.free-space.min = 0MB (=0) (default)
2021-10-05 13:25:55,947 [pool-433-thread-1] INFO  storage.RaftStorageDirectory (RaftStorageDirectoryImpl.java:analyzeStorage(135)) - The storage directory /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-62d231c0-d845-4dcd-88aa-c082e017c57e/datanode-0/data/ratis/70d43e9a-313f-4a40-8629-e674c48a3917 does not exist. Creating ...
2021-10-05 13:25:55,949 [pool-433-thread-1] INFO  storage.RaftStorageDirectory (RaftStorageDirectoryImpl.java:tryLock(230)) - Lock on /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-62d231c0-d845-4dcd-88aa-c082e017c57e/datanode-0/data/ratis/70d43e9a-313f-4a40-8629-e674c48a3917/in_use.lock acquired by nodename 17451@fv-az270-324
2021-10-05 13:25:55,954 [61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-StateMachineUpdater] INFO  safemode.HealthyPipelineSafeModeRule (HealthyPipelineSafeModeRule.java:initializeRule(152)) - Refreshed total pipeline count is 0, healthy pipeline threshold count is 1
2021-10-05 13:25:55,955 [EventQueue-PipelineReportForPipelineReportHandler] INFO  ha.SCMHAInvocationHandler (SCMHAInvocationHandler.java:invokeRatis(113)) - Invoking method public abstract void org.apache.hadoop.hdds.scm.pipeline.PipelineStateManager.updatePipelineState(org.apache.hadoop.hdds.protocol.proto.HddsProtos$PipelineID,org.apache.hadoop.hdds.protocol.proto.HddsProtos$PipelineState) throws java.io.IOException on target org.apache.hadoop.hdds.scm.ha.SCMRatisServerImpl@183f041f, cost 62946.679us
2021-10-05 13:25:55,961 [EndpointStateMachine task thread for /127.0.0.1:13539 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:13539. Already tried 7 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:55,962 [EventQueue-OpenPipelineForHealthyPipelineSafeModeRule] INFO  safemode.SCMSafeModeManager (HealthyPipelineSafeModeRule.java:process(124)) - SCM in safe mode. Healthy pipelines reported count is 0, required healthy pipeline reported count is 1
2021-10-05 13:25:55,963 [pool-433-thread-1] INFO  storage.RaftStorage (RaftStorageImpl.java:format(89)) - Storage directory /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-62d231c0-d845-4dcd-88aa-c082e017c57e/datanode-0/data/ratis/70d43e9a-313f-4a40-8629-e674c48a3917 has been successfully formatted.
2021-10-05 13:25:55,963 [pool-433-thread-1] INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(224)) - group-E674C48A3917: The snapshot info is null. Setting the last applied indexto:(t:0, i:~)
2021-10-05 13:25:55,964 [pool-433-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.notification.no-leader.timeout = 300s (custom)
2021-10-05 13:25:55,964 [pool-433-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.use.memory = false (default)
2021-10-05 13:25:55,964 [pool-433-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.purge.gap = 1000000 (custom)
2021-10-05 13:25:55,964 [pool-433-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2021-10-05 13:25:55,964 [pool-433-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.segment.size.max = 1048576 (custom)
2021-10-05 13:25:55,964 [pool-433-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.segment.cache.num.max = 2 (custom)
2021-10-05 13:25:55,964 [pool-433-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.segment.cache.size.max = 200MB (=209715200) (default)
2021-10-05 13:25:55,964 [pool-433-thread-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:<init>(182)) - new 2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc@group-E674C48A3917-SegmentedRaftLogWorker for RaftStorageImpl:Storage Directory /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-62d231c0-d845-4dcd-88aa-c082e017c57e/datanode-0/data/ratis/70d43e9a-313f-4a40-8629-e674c48a3917
2021-10-05 13:25:55,964 [pool-433-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2021-10-05 13:25:55,964 [pool-433-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.queue.element-limit = 1024 (custom)
2021-10-05 13:25:55,964 [pool-433-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.segment.size.max = 1048576 (custom)
2021-10-05 13:25:55,964 [pool-433-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.preallocated.size = 16384 (custom)
2021-10-05 13:25:55,964 [pool-433-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.force.sync.num = 128 (default)
2021-10-05 13:25:55,964 [pool-433-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.statemachine.data.sync = true (default)
2021-10-05 13:25:55,964 [pool-433-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2021-10-05 13:25:55,964 [pool-433-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2021-10-05 13:25:55,965 [pool-433-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.write.buffer.size = 1048576 (custom)
2021-10-05 13:25:55,966 [pool-433-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2021-10-05 13:25:55,966 [pool-433-thread-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:lambda$new$0(133)) - 2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc@group-E674C48A3917-SegmentedRaftLogWorker: flushIndex: setUnconditionally 0 -> -1
2021-10-05 13:25:55,966 [pool-433-thread-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:lambda$new$0(133)) - 2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc@group-E674C48A3917-SegmentedRaftLogWorker: safeCacheEvictIndex: setUnconditionally 0 -> -1
2021-10-05 13:25:55,968 [EventQueue-PipelineReportForPipelineReportHandler] INFO  pipeline.PipelineManagerImpl (PipelineManagerImpl.java:openPipeline(282)) - Pipeline Pipeline[ Id: b98fb588-c6d1-40ce-b522-15090ded4481, Nodes: 2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc{ip: 127.0.0.1, host: localhost, ports: [REPLICATION=42707, RATIS=45481, RATIS_ADMIN=45481, RATIS_SERVER=45481, STANDALONE=42383], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}, ReplicationConfig: RATIS/ONE, State:ALLOCATED, leaderId:2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc, CreationTimestamp2021-10-05T13:25:52.864Z[Etc/UTC]] moved to OPEN state
2021-10-05 13:25:55,968 [EventQueue-PipelineReportForPipelineReportHandler] INFO  ha.SCMHAInvocationHandler (SCMHAInvocationHandler.java:invokeRatis(113)) - Invoking method public abstract void org.apache.hadoop.hdds.scm.pipeline.PipelineStateManager.updatePipelineState(org.apache.hadoop.hdds.protocol.proto.HddsProtos$PipelineID,org.apache.hadoop.hdds.protocol.proto.HddsProtos$PipelineState) throws java.io.IOException on target org.apache.hadoop.hdds.scm.ha.SCMRatisServerImpl@1ffe502, cost 168.017us
2021-10-05 13:25:55,985 [pool-433-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2021-10-05 13:25:55,985 [pool-433-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2021-10-05 13:25:55,986 [pool-433-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.snapshot.retention.file.num = 5 (custom)
2021-10-05 13:25:55,986 [pool-433-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.purge.upto.snapshot.index = false (default)
2021-10-05 13:25:55,986 [pool-433-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.retrycache.expirytime = 600000ms (custom)
2021-10-05 13:25:55,986 [pool-433-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.retrycache.statistics.expirytime = 100μs (default)
2021-10-05 13:25:55,987 [pool-433-thread-1] INFO  server.RaftServer$Division (RaftServerImpl.java:start(296)) - 2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc@group-E674C48A3917: start as a follower, conf=-1: [2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc|rpc:127.0.0.1:45481|priority:0, c2216084-e141-4b27-afe8-b6c5968528ec|rpc:127.0.0.1:39195|priority:1, 106bb174-548c-482f-98a0-a37141c57762|rpc:127.0.0.1:43635|priority:0], old=null
2021-10-05 13:25:55,987 [pool-433-thread-1] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(285)) - 2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc@group-E674C48A3917: changes role from      null to FOLLOWER at term 0 for startAsFollower
2021-10-05 13:25:55,987 [pool-433-thread-1] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(130)) - 2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc: start 2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc@group-E674C48A3917-FollowerState
2021-10-05 13:25:55,987 [pool-433-thread-1] INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-E674C48A3917,id=2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc
2021-10-05 13:25:56,003 [b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-StateMachineUpdater] INFO  safemode.HealthyPipelineSafeModeRule (HealthyPipelineSafeModeRule.java:initializeRule(152)) - Refreshed total pipeline count is 0, healthy pipeline threshold count is 1
2021-10-05 13:25:56,004 [Command processor thread] INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:addGroup(763)) - Created group PipelineID=70d43e9a-313f-4a40-8629-e674c48a3917
2021-10-05 13:25:56,011 [EventQueue-OpenPipelineForHealthyPipelineSafeModeRule] INFO  safemode.SCMSafeModeManager (HealthyPipelineSafeModeRule.java:process(124)) - SCM in safe mode. Healthy pipelines reported count is 0, required healthy pipeline reported count is 1
2021-10-05 13:25:56,014 [grpc-default-executor-0] INFO  server.RaftServer (RaftServerProxy.java:addNew(95)) - c2216084-e141-4b27-afe8-b6c5968528ec: addNew group-E674C48A3917:[2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc|rpc:127.0.0.1:45481|dataStream:|priority:0, c2216084-e141-4b27-afe8-b6c5968528ec|rpc:127.0.0.1:39195|dataStream:|priority:1, 106bb174-548c-482f-98a0-a37141c57762|rpc:127.0.0.1:43635|dataStream:|priority:0] returns group-E674C48A3917:java.util.concurrent.CompletableFuture@5591d5cd[Not completed]
2021-10-05 13:25:56,015 [pool-475-thread-1] INFO  server.RaftServer$Division (RaftServerImpl.java:<init>(181)) - c2216084-e141-4b27-afe8-b6c5968528ec: new RaftServerImpl for group-E674C48A3917:[2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc|rpc:127.0.0.1:45481|dataStream:|priority:0, c2216084-e141-4b27-afe8-b6c5968528ec|rpc:127.0.0.1:39195|dataStream:|priority:1, 106bb174-548c-482f-98a0-a37141c57762|rpc:127.0.0.1:43635|dataStream:|priority:0] with ContainerStateMachine:uninitialized
2021-10-05 13:25:56,030 [pool-475-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.timeout.min = 5s (custom)
2021-10-05 13:25:56,030 [pool-475-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.timeout.max = 5200ms (custom)
2021-10-05 13:25:56,030 [pool-475-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.sleep.time = 25ms (default)
2021-10-05 13:25:56,030 [pool-475-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.slowness.timeout = 300s (custom)
2021-10-05 13:25:56,030 [pool-475-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.leaderelection.leader.step-down.wait-time = 10s (default)
2021-10-05 13:25:56,030 [pool-475-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.sleep.deviation.threshold = 300ms (default)
2021-10-05 13:25:56,030 [pool-475-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.appender.install.snapshot.enabled = false (custom)
2021-10-05 13:25:56,030 [pool-475-thread-1] INFO  server.RaftServer$Division (ServerState.java:<init>(105)) - c2216084-e141-4b27-afe8-b6c5968528ec@group-E674C48A3917: ConfigurationManager, init=-1: [2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc|rpc:127.0.0.1:45481|dataStream:|priority:0, c2216084-e141-4b27-afe8-b6c5968528ec|rpc:127.0.0.1:39195|dataStream:|priority:1, 106bb174-548c-482f-98a0-a37141c57762|rpc:127.0.0.1:43635|dataStream:|priority:0], old=null, confs=<EMPTY_MAP>
2021-10-05 13:25:56,030 [pool-475-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.storage.dir = [/home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-62d231c0-d845-4dcd-88aa-c082e017c57e/datanode-2/data/ratis] (custom)
2021-10-05 13:25:56,030 [pool-475-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.corruption.policy = EXCEPTION (default)
2021-10-05 13:25:56,030 [pool-475-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.storage.free-space.min = 0MB (=0) (default)
2021-10-05 13:25:56,030 [pool-475-thread-1] INFO  storage.RaftStorageDirectory (RaftStorageDirectoryImpl.java:analyzeStorage(135)) - The storage directory /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-62d231c0-d845-4dcd-88aa-c082e017c57e/datanode-2/data/ratis/70d43e9a-313f-4a40-8629-e674c48a3917 does not exist. Creating ...
2021-10-05 13:25:56,034 [pool-475-thread-1] INFO  storage.RaftStorageDirectory (RaftStorageDirectoryImpl.java:tryLock(230)) - Lock on /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-62d231c0-d845-4dcd-88aa-c082e017c57e/datanode-2/data/ratis/70d43e9a-313f-4a40-8629-e674c48a3917/in_use.lock acquired by nodename 17451@fv-az270-324
2021-10-05 13:25:56,036 [pool-475-thread-1] INFO  storage.RaftStorage (RaftStorageImpl.java:format(89)) - Storage directory /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-62d231c0-d845-4dcd-88aa-c082e017c57e/datanode-2/data/ratis/70d43e9a-313f-4a40-8629-e674c48a3917 has been successfully formatted.
2021-10-05 13:25:56,036 [pool-475-thread-1] INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(224)) - group-E674C48A3917: The snapshot info is null. Setting the last applied indexto:(t:0, i:~)
2021-10-05 13:25:56,036 [pool-475-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.notification.no-leader.timeout = 300s (custom)
2021-10-05 13:25:56,036 [pool-475-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.use.memory = false (default)
2021-10-05 13:25:56,036 [pool-475-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.purge.gap = 1000000 (custom)
2021-10-05 13:25:56,036 [pool-475-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2021-10-05 13:25:56,037 [pool-475-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.segment.size.max = 1048576 (custom)
2021-10-05 13:25:56,040 [pool-475-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.segment.cache.num.max = 2 (custom)
2021-10-05 13:25:56,040 [pool-475-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.segment.cache.size.max = 200MB (=209715200) (default)
2021-10-05 13:25:56,040 [pool-475-thread-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:<init>(182)) - new c2216084-e141-4b27-afe8-b6c5968528ec@group-E674C48A3917-SegmentedRaftLogWorker for RaftStorageImpl:Storage Directory /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-62d231c0-d845-4dcd-88aa-c082e017c57e/datanode-2/data/ratis/70d43e9a-313f-4a40-8629-e674c48a3917
2021-10-05 13:25:56,040 [pool-475-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2021-10-05 13:25:56,040 [pool-475-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.queue.element-limit = 1024 (custom)
2021-10-05 13:25:56,040 [pool-475-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.segment.size.max = 1048576 (custom)
2021-10-05 13:25:56,040 [pool-475-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.preallocated.size = 16384 (custom)
2021-10-05 13:25:56,040 [pool-475-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.force.sync.num = 128 (default)
2021-10-05 13:25:56,040 [pool-475-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.statemachine.data.sync = true (default)
2021-10-05 13:25:56,040 [pool-475-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2021-10-05 13:25:56,040 [pool-475-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2021-10-05 13:25:56,041 [pool-475-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.write.buffer.size = 1048576 (custom)
2021-10-05 13:25:56,042 [pool-475-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2021-10-05 13:25:56,044 [pool-475-thread-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:lambda$new$0(133)) - c2216084-e141-4b27-afe8-b6c5968528ec@group-E674C48A3917-SegmentedRaftLogWorker: flushIndex: setUnconditionally 0 -> -1
2021-10-05 13:25:56,044 [pool-475-thread-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:lambda$new$0(133)) - c2216084-e141-4b27-afe8-b6c5968528ec@group-E674C48A3917-SegmentedRaftLogWorker: safeCacheEvictIndex: setUnconditionally 0 -> -1
2021-10-05 13:25:56,051 [pool-475-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2021-10-05 13:25:56,051 [pool-475-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2021-10-05 13:25:56,051 [pool-475-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.snapshot.retention.file.num = 5 (custom)
2021-10-05 13:25:56,051 [pool-475-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.purge.upto.snapshot.index = false (default)
2021-10-05 13:25:56,051 [pool-475-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.retrycache.expirytime = 600000ms (custom)
2021-10-05 13:25:56,051 [pool-475-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.retrycache.statistics.expirytime = 100μs (default)
2021-10-05 13:25:56,052 [pool-475-thread-1] INFO  server.RaftServer$Division (RaftServerImpl.java:start(296)) - c2216084-e141-4b27-afe8-b6c5968528ec@group-E674C48A3917: start as a follower, conf=-1: [2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc|rpc:127.0.0.1:45481|dataStream:|priority:0, c2216084-e141-4b27-afe8-b6c5968528ec|rpc:127.0.0.1:39195|dataStream:|priority:1, 106bb174-548c-482f-98a0-a37141c57762|rpc:127.0.0.1:43635|dataStream:|priority:0], old=null
2021-10-05 13:25:56,052 [pool-475-thread-1] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(285)) - c2216084-e141-4b27-afe8-b6c5968528ec@group-E674C48A3917: changes role from      null to FOLLOWER at term 0 for startAsFollower
2021-10-05 13:25:56,052 [pool-475-thread-1] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(130)) - c2216084-e141-4b27-afe8-b6c5968528ec: start c2216084-e141-4b27-afe8-b6c5968528ec@group-E674C48A3917-FollowerState
2021-10-05 13:25:56,056 [pool-475-thread-1] INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-E674C48A3917,id=c2216084-e141-4b27-afe8-b6c5968528ec
2021-10-05 13:25:56,094 [grpc-default-executor-0] INFO  server.RaftServer (RaftServerProxy.java:addNew(95)) - 106bb174-548c-482f-98a0-a37141c57762: addNew group-E674C48A3917:[2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc|rpc:127.0.0.1:45481|dataStream:|priority:0, c2216084-e141-4b27-afe8-b6c5968528ec|rpc:127.0.0.1:39195|dataStream:|priority:1, 106bb174-548c-482f-98a0-a37141c57762|rpc:127.0.0.1:43635|dataStream:|priority:0] returns group-E674C48A3917:java.util.concurrent.CompletableFuture@782bfa05[Not completed]
2021-10-05 13:25:56,113 [pool-454-thread-1] INFO  server.RaftServer$Division (RaftServerImpl.java:<init>(181)) - 106bb174-548c-482f-98a0-a37141c57762: new RaftServerImpl for group-E674C48A3917:[2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc|rpc:127.0.0.1:45481|dataStream:|priority:0, c2216084-e141-4b27-afe8-b6c5968528ec|rpc:127.0.0.1:39195|dataStream:|priority:1, 106bb174-548c-482f-98a0-a37141c57762|rpc:127.0.0.1:43635|dataStream:|priority:0] with ContainerStateMachine:uninitialized
2021-10-05 13:25:56,113 [pool-454-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.timeout.min = 5s (custom)
2021-10-05 13:25:56,113 [pool-454-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.timeout.max = 5200ms (custom)
2021-10-05 13:25:56,113 [pool-454-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.sleep.time = 25ms (default)
2021-10-05 13:25:56,113 [pool-454-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.slowness.timeout = 300s (custom)
2021-10-05 13:25:56,113 [pool-454-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.leaderelection.leader.step-down.wait-time = 10s (default)
2021-10-05 13:25:56,113 [pool-454-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.sleep.deviation.threshold = 300ms (default)
2021-10-05 13:25:56,113 [pool-454-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.appender.install.snapshot.enabled = false (custom)
2021-10-05 13:25:56,113 [pool-454-thread-1] INFO  server.RaftServer$Division (ServerState.java:<init>(105)) - 106bb174-548c-482f-98a0-a37141c57762@group-E674C48A3917: ConfigurationManager, init=-1: [2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc|rpc:127.0.0.1:45481|dataStream:|priority:0, c2216084-e141-4b27-afe8-b6c5968528ec|rpc:127.0.0.1:39195|dataStream:|priority:1, 106bb174-548c-482f-98a0-a37141c57762|rpc:127.0.0.1:43635|dataStream:|priority:0], old=null, confs=<EMPTY_MAP>
2021-10-05 13:25:56,113 [pool-454-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.storage.dir = [/home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-62d231c0-d845-4dcd-88aa-c082e017c57e/datanode-1/data/ratis] (custom)
2021-10-05 13:25:56,117 [pool-454-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.corruption.policy = EXCEPTION (default)
2021-10-05 13:25:56,118 [pool-454-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.storage.free-space.min = 0MB (=0) (default)
2021-10-05 13:25:56,119 [pool-454-thread-1] INFO  storage.RaftStorageDirectory (RaftStorageDirectoryImpl.java:analyzeStorage(135)) - The storage directory /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-62d231c0-d845-4dcd-88aa-c082e017c57e/datanode-1/data/ratis/70d43e9a-313f-4a40-8629-e674c48a3917 does not exist. Creating ...
2021-10-05 13:25:56,121 [pool-454-thread-1] INFO  storage.RaftStorageDirectory (RaftStorageDirectoryImpl.java:tryLock(230)) - Lock on /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-62d231c0-d845-4dcd-88aa-c082e017c57e/datanode-1/data/ratis/70d43e9a-313f-4a40-8629-e674c48a3917/in_use.lock acquired by nodename 17451@fv-az270-324
2021-10-05 13:25:56,127 [pool-454-thread-1] INFO  storage.RaftStorage (RaftStorageImpl.java:format(89)) - Storage directory /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-62d231c0-d845-4dcd-88aa-c082e017c57e/datanode-1/data/ratis/70d43e9a-313f-4a40-8629-e674c48a3917 has been successfully formatted.
2021-10-05 13:25:56,128 [pool-454-thread-1] INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(224)) - group-E674C48A3917: The snapshot info is null. Setting the last applied indexto:(t:0, i:~)
2021-10-05 13:25:56,130 [pool-454-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.notification.no-leader.timeout = 300s (custom)
2021-10-05 13:25:56,130 [pool-454-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.use.memory = false (default)
2021-10-05 13:25:56,130 [pool-454-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.purge.gap = 1000000 (custom)
2021-10-05 13:25:56,130 [pool-454-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2021-10-05 13:25:56,130 [pool-454-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.segment.size.max = 1048576 (custom)
2021-10-05 13:25:56,135 [pool-454-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.segment.cache.num.max = 2 (custom)
2021-10-05 13:25:56,135 [pool-454-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.segment.cache.size.max = 200MB (=209715200) (default)
2021-10-05 13:25:56,135 [pool-454-thread-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:<init>(182)) - new 106bb174-548c-482f-98a0-a37141c57762@group-E674C48A3917-SegmentedRaftLogWorker for RaftStorageImpl:Storage Directory /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-62d231c0-d845-4dcd-88aa-c082e017c57e/datanode-1/data/ratis/70d43e9a-313f-4a40-8629-e674c48a3917
2021-10-05 13:25:56,135 [pool-454-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2021-10-05 13:25:56,136 [pool-454-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.queue.element-limit = 1024 (custom)
2021-10-05 13:25:56,136 [pool-454-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.segment.size.max = 1048576 (custom)
2021-10-05 13:25:56,136 [pool-454-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.preallocated.size = 16384 (custom)
2021-10-05 13:25:56,136 [pool-454-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.force.sync.num = 128 (default)
2021-10-05 13:25:56,136 [pool-454-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.statemachine.data.sync = true (default)
2021-10-05 13:25:56,136 [pool-454-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2021-10-05 13:25:56,136 [pool-454-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2021-10-05 13:25:56,136 [pool-454-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.write.buffer.size = 1048576 (custom)
2021-10-05 13:25:56,137 [pool-454-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2021-10-05 13:25:56,137 [pool-454-thread-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:lambda$new$0(133)) - 106bb174-548c-482f-98a0-a37141c57762@group-E674C48A3917-SegmentedRaftLogWorker: flushIndex: setUnconditionally 0 -> -1
2021-10-05 13:25:56,137 [pool-454-thread-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:lambda$new$0(133)) - 106bb174-548c-482f-98a0-a37141c57762@group-E674C48A3917-SegmentedRaftLogWorker: safeCacheEvictIndex: setUnconditionally 0 -> -1
2021-10-05 13:25:56,149 [pool-454-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2021-10-05 13:25:56,149 [pool-454-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2021-10-05 13:25:56,149 [pool-454-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.snapshot.retention.file.num = 5 (custom)
2021-10-05 13:25:56,149 [pool-454-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.purge.upto.snapshot.index = false (default)
2021-10-05 13:25:56,149 [pool-454-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.retrycache.expirytime = 600000ms (custom)
2021-10-05 13:25:56,149 [pool-454-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.retrycache.statistics.expirytime = 100μs (default)
2021-10-05 13:25:56,150 [pool-454-thread-1] INFO  server.RaftServer$Division (RaftServerImpl.java:start(296)) - 106bb174-548c-482f-98a0-a37141c57762@group-E674C48A3917: start as a follower, conf=-1: [2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc|rpc:127.0.0.1:45481|dataStream:|priority:0, c2216084-e141-4b27-afe8-b6c5968528ec|rpc:127.0.0.1:39195|dataStream:|priority:1, 106bb174-548c-482f-98a0-a37141c57762|rpc:127.0.0.1:43635|dataStream:|priority:0], old=null
2021-10-05 13:25:56,150 [pool-454-thread-1] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(285)) - 106bb174-548c-482f-98a0-a37141c57762@group-E674C48A3917: changes role from      null to FOLLOWER at term 0 for startAsFollower
2021-10-05 13:25:56,150 [pool-454-thread-1] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(130)) - 106bb174-548c-482f-98a0-a37141c57762: start 106bb174-548c-482f-98a0-a37141c57762@group-E674C48A3917-FollowerState
2021-10-05 13:25:56,153 [pool-454-thread-1] INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-E674C48A3917,id=106bb174-548c-482f-98a0-a37141c57762
2021-10-05 13:25:56,170 [Command processor thread] INFO  commandhandler.CreatePipelineCommandHandler (CreatePipelineCommandHandler.java:handle(106)) - Created Pipeline RATIS THREE PipelineID=70d43e9a-313f-4a40-8629-e674c48a3917.
2021-10-05 13:25:56,171 [Command processor thread] INFO  server.RaftServer (RaftServerProxy.java:addNew(95)) - 2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc: addNew group-C784995F1F78:[2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc|rpc:127.0.0.1:45481|priority:0, c2216084-e141-4b27-afe8-b6c5968528ec|rpc:127.0.0.1:39195|priority:0, 106bb174-548c-482f-98a0-a37141c57762|rpc:127.0.0.1:43635|priority:1] returns group-C784995F1F78:java.util.concurrent.CompletableFuture@10495461[Not completed]
2021-10-05 13:25:56,171 [pool-433-thread-1] INFO  server.RaftServer$Division (RaftServerImpl.java:<init>(181)) - 2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc: new RaftServerImpl for group-C784995F1F78:[2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc|rpc:127.0.0.1:45481|priority:0, c2216084-e141-4b27-afe8-b6c5968528ec|rpc:127.0.0.1:39195|priority:0, 106bb174-548c-482f-98a0-a37141c57762|rpc:127.0.0.1:43635|priority:1] with ContainerStateMachine:uninitialized
2021-10-05 13:25:56,171 [pool-433-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.timeout.min = 5s (custom)
2021-10-05 13:25:56,171 [pool-433-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.timeout.max = 5200ms (custom)
2021-10-05 13:25:56,171 [pool-433-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.sleep.time = 25ms (default)
2021-10-05 13:25:56,171 [pool-433-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.slowness.timeout = 300s (custom)
2021-10-05 13:25:56,171 [pool-433-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.leaderelection.leader.step-down.wait-time = 10s (default)
2021-10-05 13:25:56,171 [pool-433-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.sleep.deviation.threshold = 300ms (default)
2021-10-05 13:25:56,172 [pool-433-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.appender.install.snapshot.enabled = false (custom)
2021-10-05 13:25:56,172 [pool-433-thread-1] INFO  server.RaftServer$Division (ServerState.java:<init>(105)) - 2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc@group-C784995F1F78: ConfigurationManager, init=-1: [2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc|rpc:127.0.0.1:45481|priority:0, c2216084-e141-4b27-afe8-b6c5968528ec|rpc:127.0.0.1:39195|priority:0, 106bb174-548c-482f-98a0-a37141c57762|rpc:127.0.0.1:43635|priority:1], old=null, confs=<EMPTY_MAP>
2021-10-05 13:25:56,172 [pool-433-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.storage.dir = [/home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-62d231c0-d845-4dcd-88aa-c082e017c57e/datanode-0/data/ratis] (custom)
2021-10-05 13:25:56,172 [pool-433-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.corruption.policy = EXCEPTION (default)
2021-10-05 13:25:56,172 [pool-433-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.storage.free-space.min = 0MB (=0) (default)
2021-10-05 13:25:56,172 [pool-433-thread-1] INFO  storage.RaftStorageDirectory (RaftStorageDirectoryImpl.java:analyzeStorage(135)) - The storage directory /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-62d231c0-d845-4dcd-88aa-c082e017c57e/datanode-0/data/ratis/695b8808-dd40-42c0-a85d-c784995f1f78 does not exist. Creating ...
2021-10-05 13:25:56,173 [pool-433-thread-1] INFO  storage.RaftStorageDirectory (RaftStorageDirectoryImpl.java:tryLock(230)) - Lock on /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-62d231c0-d845-4dcd-88aa-c082e017c57e/datanode-0/data/ratis/695b8808-dd40-42c0-a85d-c784995f1f78/in_use.lock acquired by nodename 17451@fv-az270-324
2021-10-05 13:25:56,175 [pool-433-thread-1] INFO  storage.RaftStorage (RaftStorageImpl.java:format(89)) - Storage directory /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-62d231c0-d845-4dcd-88aa-c082e017c57e/datanode-0/data/ratis/695b8808-dd40-42c0-a85d-c784995f1f78 has been successfully formatted.
2021-10-05 13:25:56,176 [pool-433-thread-1] INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(224)) - group-C784995F1F78: The snapshot info is null. Setting the last applied indexto:(t:0, i:~)
2021-10-05 13:25:56,177 [pool-433-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.notification.no-leader.timeout = 300s (custom)
2021-10-05 13:25:56,185 [pool-433-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.use.memory = false (default)
2021-10-05 13:25:56,185 [pool-433-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.purge.gap = 1000000 (custom)
2021-10-05 13:25:56,185 [pool-433-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2021-10-05 13:25:56,185 [pool-433-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.segment.size.max = 1048576 (custom)
2021-10-05 13:25:56,185 [pool-433-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.segment.cache.num.max = 2 (custom)
2021-10-05 13:25:56,185 [pool-433-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.segment.cache.size.max = 200MB (=209715200) (default)
2021-10-05 13:25:56,185 [pool-433-thread-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:<init>(182)) - new 2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc@group-C784995F1F78-SegmentedRaftLogWorker for RaftStorageImpl:Storage Directory /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-62d231c0-d845-4dcd-88aa-c082e017c57e/datanode-0/data/ratis/695b8808-dd40-42c0-a85d-c784995f1f78
2021-10-05 13:25:56,185 [pool-433-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2021-10-05 13:25:56,185 [pool-433-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.queue.element-limit = 1024 (custom)
2021-10-05 13:25:56,185 [pool-433-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.segment.size.max = 1048576 (custom)
2021-10-05 13:25:56,185 [pool-433-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.preallocated.size = 16384 (custom)
2021-10-05 13:25:56,185 [pool-433-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.force.sync.num = 128 (default)
2021-10-05 13:25:56,185 [pool-433-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.statemachine.data.sync = true (default)
2021-10-05 13:25:56,185 [pool-433-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2021-10-05 13:25:56,185 [pool-433-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2021-10-05 13:25:56,180 [EventQueue-OpenPipelineForHealthyPipelineSafeModeRule] INFO  safemode.SCMSafeModeManager (HealthyPipelineSafeModeRule.java:process(124)) - SCM in safe mode. Healthy pipelines reported count is 0, required healthy pipeline reported count is 1
2021-10-05 13:25:56,186 [pool-433-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.write.buffer.size = 1048576 (custom)
2021-10-05 13:25:56,187 [pool-433-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2021-10-05 13:25:56,187 [pool-433-thread-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:lambda$new$0(133)) - 2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc@group-C784995F1F78-SegmentedRaftLogWorker: flushIndex: setUnconditionally 0 -> -1
2021-10-05 13:25:56,187 [pool-433-thread-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:lambda$new$0(133)) - 2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc@group-C784995F1F78-SegmentedRaftLogWorker: safeCacheEvictIndex: setUnconditionally 0 -> -1
2021-10-05 13:25:56,187 [EventQueue-OpenPipelineForHealthyPipelineSafeModeRule] INFO  safemode.SCMSafeModeManager (HealthyPipelineSafeModeRule.java:process(124)) - SCM in safe mode. Healthy pipelines reported count is 0, required healthy pipeline reported count is 1
2021-10-05 13:25:56,190 [pool-433-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2021-10-05 13:25:56,190 [pool-433-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2021-10-05 13:25:56,190 [pool-433-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.snapshot.retention.file.num = 5 (custom)
2021-10-05 13:25:56,190 [pool-433-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.purge.upto.snapshot.index = false (default)
2021-10-05 13:25:56,190 [pool-433-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.retrycache.expirytime = 600000ms (custom)
2021-10-05 13:25:56,190 [pool-433-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.retrycache.statistics.expirytime = 100μs (default)
2021-10-05 13:25:56,191 [pool-433-thread-1] INFO  server.RaftServer$Division (RaftServerImpl.java:start(296)) - 2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc@group-C784995F1F78: start as a follower, conf=-1: [2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc|rpc:127.0.0.1:45481|priority:0, c2216084-e141-4b27-afe8-b6c5968528ec|rpc:127.0.0.1:39195|priority:0, 106bb174-548c-482f-98a0-a37141c57762|rpc:127.0.0.1:43635|priority:1], old=null
2021-10-05 13:25:56,191 [pool-433-thread-1] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(285)) - 2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc@group-C784995F1F78: changes role from      null to FOLLOWER at term 0 for startAsFollower
2021-10-05 13:25:56,191 [pool-433-thread-1] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(130)) - 2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc: start 2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc@group-C784995F1F78-FollowerState
2021-10-05 13:25:56,192 [pool-433-thread-1] INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-C784995F1F78,id=2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc
2021-10-05 13:25:56,192 [Command processor thread] INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:addGroup(763)) - Created group PipelineID=695b8808-dd40-42c0-a85d-c784995f1f78
2021-10-05 13:25:56,200 [grpc-default-executor-0] INFO  server.RaftServer (RaftServerProxy.java:addNew(95)) - 106bb174-548c-482f-98a0-a37141c57762: addNew group-C784995F1F78:[2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc|rpc:127.0.0.1:45481|dataStream:|priority:0, c2216084-e141-4b27-afe8-b6c5968528ec|rpc:127.0.0.1:39195|dataStream:|priority:0, 106bb174-548c-482f-98a0-a37141c57762|rpc:127.0.0.1:43635|dataStream:|priority:1] returns group-C784995F1F78:java.util.concurrent.CompletableFuture@5d72669e[Not completed]
2021-10-05 13:25:56,200 [pool-454-thread-1] INFO  server.RaftServer$Division (RaftServerImpl.java:<init>(181)) - 106bb174-548c-482f-98a0-a37141c57762: new RaftServerImpl for group-C784995F1F78:[2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc|rpc:127.0.0.1:45481|dataStream:|priority:0, c2216084-e141-4b27-afe8-b6c5968528ec|rpc:127.0.0.1:39195|dataStream:|priority:0, 106bb174-548c-482f-98a0-a37141c57762|rpc:127.0.0.1:43635|dataStream:|priority:1] with ContainerStateMachine:uninitialized
2021-10-05 13:25:56,201 [pool-454-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.timeout.min = 5s (custom)
2021-10-05 13:25:56,201 [pool-454-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.timeout.max = 5200ms (custom)
2021-10-05 13:25:56,201 [pool-454-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.sleep.time = 25ms (default)
2021-10-05 13:25:56,201 [pool-454-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.slowness.timeout = 300s (custom)
2021-10-05 13:25:56,201 [pool-454-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.leaderelection.leader.step-down.wait-time = 10s (default)
2021-10-05 13:25:56,201 [pool-454-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.sleep.deviation.threshold = 300ms (default)
2021-10-05 13:25:56,201 [pool-454-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.appender.install.snapshot.enabled = false (custom)
2021-10-05 13:25:56,201 [pool-454-thread-1] INFO  server.RaftServer$Division (ServerState.java:<init>(105)) - 106bb174-548c-482f-98a0-a37141c57762@group-C784995F1F78: ConfigurationManager, init=-1: [2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc|rpc:127.0.0.1:45481|dataStream:|priority:0, c2216084-e141-4b27-afe8-b6c5968528ec|rpc:127.0.0.1:39195|dataStream:|priority:0, 106bb174-548c-482f-98a0-a37141c57762|rpc:127.0.0.1:43635|dataStream:|priority:1], old=null, confs=<EMPTY_MAP>
2021-10-05 13:25:56,201 [pool-454-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.storage.dir = [/home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-62d231c0-d845-4dcd-88aa-c082e017c57e/datanode-1/data/ratis] (custom)
2021-10-05 13:25:56,201 [pool-454-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.corruption.policy = EXCEPTION (default)
2021-10-05 13:25:56,201 [pool-454-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.storage.free-space.min = 0MB (=0) (default)
2021-10-05 13:25:56,201 [pool-454-thread-1] INFO  storage.RaftStorageDirectory (RaftStorageDirectoryImpl.java:analyzeStorage(135)) - The storage directory /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-62d231c0-d845-4dcd-88aa-c082e017c57e/datanode-1/data/ratis/695b8808-dd40-42c0-a85d-c784995f1f78 does not exist. Creating ...
2021-10-05 13:25:56,203 [pool-454-thread-1] INFO  storage.RaftStorageDirectory (RaftStorageDirectoryImpl.java:tryLock(230)) - Lock on /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-62d231c0-d845-4dcd-88aa-c082e017c57e/datanode-1/data/ratis/695b8808-dd40-42c0-a85d-c784995f1f78/in_use.lock acquired by nodename 17451@fv-az270-324
2021-10-05 13:25:56,204 [pool-454-thread-1] INFO  storage.RaftStorage (RaftStorageImpl.java:format(89)) - Storage directory /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-62d231c0-d845-4dcd-88aa-c082e017c57e/datanode-1/data/ratis/695b8808-dd40-42c0-a85d-c784995f1f78 has been successfully formatted.
2021-10-05 13:25:56,206 [pool-454-thread-1] INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(224)) - group-C784995F1F78: The snapshot info is null. Setting the last applied indexto:(t:0, i:~)
2021-10-05 13:25:56,206 [pool-454-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.notification.no-leader.timeout = 300s (custom)
2021-10-05 13:25:56,206 [pool-454-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.use.memory = false (default)
2021-10-05 13:25:56,206 [pool-454-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.purge.gap = 1000000 (custom)
2021-10-05 13:25:56,206 [pool-454-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2021-10-05 13:25:56,206 [pool-454-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.segment.size.max = 1048576 (custom)
2021-10-05 13:25:56,207 [pool-454-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.segment.cache.num.max = 2 (custom)
2021-10-05 13:25:56,207 [pool-454-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.segment.cache.size.max = 200MB (=209715200) (default)
2021-10-05 13:25:56,207 [pool-454-thread-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:<init>(182)) - new 106bb174-548c-482f-98a0-a37141c57762@group-C784995F1F78-SegmentedRaftLogWorker for RaftStorageImpl:Storage Directory /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-62d231c0-d845-4dcd-88aa-c082e017c57e/datanode-1/data/ratis/695b8808-dd40-42c0-a85d-c784995f1f78
2021-10-05 13:25:56,207 [pool-454-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2021-10-05 13:25:56,207 [pool-454-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.queue.element-limit = 1024 (custom)
2021-10-05 13:25:56,207 [pool-454-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.segment.size.max = 1048576 (custom)
2021-10-05 13:25:56,207 [pool-454-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.preallocated.size = 16384 (custom)
2021-10-05 13:25:56,207 [pool-454-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.force.sync.num = 128 (default)
2021-10-05 13:25:56,207 [pool-454-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.statemachine.data.sync = true (default)
2021-10-05 13:25:56,207 [pool-454-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2021-10-05 13:25:56,207 [pool-454-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2021-10-05 13:25:56,208 [pool-454-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.write.buffer.size = 1048576 (custom)
2021-10-05 13:25:56,209 [pool-454-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2021-10-05 13:25:56,219 [pool-454-thread-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:lambda$new$0(133)) - 106bb174-548c-482f-98a0-a37141c57762@group-C784995F1F78-SegmentedRaftLogWorker: flushIndex: setUnconditionally 0 -> -1
2021-10-05 13:25:56,220 [pool-454-thread-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:lambda$new$0(133)) - 106bb174-548c-482f-98a0-a37141c57762@group-C784995F1F78-SegmentedRaftLogWorker: safeCacheEvictIndex: setUnconditionally 0 -> -1
2021-10-05 13:25:56,220 [pool-454-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2021-10-05 13:25:56,220 [pool-454-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2021-10-05 13:25:56,221 [pool-454-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.snapshot.retention.file.num = 5 (custom)
2021-10-05 13:25:56,221 [pool-454-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.purge.upto.snapshot.index = false (default)
2021-10-05 13:25:56,221 [pool-454-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.retrycache.expirytime = 600000ms (custom)
2021-10-05 13:25:56,221 [pool-454-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.retrycache.statistics.expirytime = 100μs (default)
2021-10-05 13:25:56,222 [pool-454-thread-1] INFO  server.RaftServer$Division (RaftServerImpl.java:start(296)) - 106bb174-548c-482f-98a0-a37141c57762@group-C784995F1F78: start as a follower, conf=-1: [2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc|rpc:127.0.0.1:45481|dataStream:|priority:0, c2216084-e141-4b27-afe8-b6c5968528ec|rpc:127.0.0.1:39195|dataStream:|priority:0, 106bb174-548c-482f-98a0-a37141c57762|rpc:127.0.0.1:43635|dataStream:|priority:1], old=null
2021-10-05 13:25:56,222 [pool-454-thread-1] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(285)) - 106bb174-548c-482f-98a0-a37141c57762@group-C784995F1F78: changes role from      null to FOLLOWER at term 0 for startAsFollower
2021-10-05 13:25:56,222 [pool-454-thread-1] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(130)) - 106bb174-548c-482f-98a0-a37141c57762: start 106bb174-548c-482f-98a0-a37141c57762@group-C784995F1F78-FollowerState
2021-10-05 13:25:56,235 [pool-454-thread-1] INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-C784995F1F78,id=106bb174-548c-482f-98a0-a37141c57762
2021-10-05 13:25:56,245 [Command processor thread] INFO  server.RaftServer (RaftServerProxy.java:addNew(95)) - 106bb174-548c-482f-98a0-a37141c57762: addNew group-5EA95D3F2CF7:[106bb174-548c-482f-98a0-a37141c57762|rpc:127.0.0.1:43635|priority:1] returns group-5EA95D3F2CF7:java.util.concurrent.CompletableFuture@56c34e1e[Not completed]
2021-10-05 13:25:56,262 [pool-454-thread-1] INFO  server.RaftServer$Division (RaftServerImpl.java:<init>(181)) - 106bb174-548c-482f-98a0-a37141c57762: new RaftServerImpl for group-5EA95D3F2CF7:[106bb174-548c-482f-98a0-a37141c57762|rpc:127.0.0.1:43635|priority:1] with ContainerStateMachine:uninitialized
2021-10-05 13:25:56,262 [pool-454-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.timeout.min = 5s (custom)
2021-10-05 13:25:56,262 [pool-454-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.timeout.max = 5200ms (custom)
2021-10-05 13:25:56,262 [pool-454-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.sleep.time = 25ms (default)
2021-10-05 13:25:56,262 [pool-454-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.slowness.timeout = 300s (custom)
2021-10-05 13:25:56,262 [pool-454-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.leaderelection.leader.step-down.wait-time = 10s (default)
2021-10-05 13:25:56,262 [pool-454-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.sleep.deviation.threshold = 300ms (default)
2021-10-05 13:25:56,262 [pool-454-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.appender.install.snapshot.enabled = false (custom)
2021-10-05 13:25:56,262 [pool-454-thread-1] INFO  server.RaftServer$Division (ServerState.java:<init>(105)) - 106bb174-548c-482f-98a0-a37141c57762@group-5EA95D3F2CF7: ConfigurationManager, init=-1: [106bb174-548c-482f-98a0-a37141c57762|rpc:127.0.0.1:43635|priority:1], old=null, confs=<EMPTY_MAP>
2021-10-05 13:25:56,262 [pool-454-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.storage.dir = [/home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-62d231c0-d845-4dcd-88aa-c082e017c57e/datanode-1/data/ratis] (custom)
2021-10-05 13:25:56,263 [pool-454-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.corruption.policy = EXCEPTION (default)
2021-10-05 13:25:56,263 [pool-454-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.storage.free-space.min = 0MB (=0) (default)
2021-10-05 13:25:56,263 [pool-454-thread-1] INFO  storage.RaftStorageDirectory (RaftStorageDirectoryImpl.java:analyzeStorage(135)) - The storage directory /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-62d231c0-d845-4dcd-88aa-c082e017c57e/datanode-1/data/ratis/b3ab901a-6bcc-4c8d-8b24-5ea95d3f2cf7 does not exist. Creating ...
2021-10-05 13:25:56,265 [pool-454-thread-1] INFO  storage.RaftStorageDirectory (RaftStorageDirectoryImpl.java:tryLock(230)) - Lock on /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-62d231c0-d845-4dcd-88aa-c082e017c57e/datanode-1/data/ratis/b3ab901a-6bcc-4c8d-8b24-5ea95d3f2cf7/in_use.lock acquired by nodename 17451@fv-az270-324
2021-10-05 13:25:56,266 [pool-454-thread-1] INFO  storage.RaftStorage (RaftStorageImpl.java:format(89)) - Storage directory /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-62d231c0-d845-4dcd-88aa-c082e017c57e/datanode-1/data/ratis/b3ab901a-6bcc-4c8d-8b24-5ea95d3f2cf7 has been successfully formatted.
2021-10-05 13:25:56,266 [pool-454-thread-1] INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(224)) - group-5EA95D3F2CF7: The snapshot info is null. Setting the last applied indexto:(t:0, i:~)
2021-10-05 13:25:56,266 [pool-454-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.notification.no-leader.timeout = 300s (custom)
2021-10-05 13:25:56,266 [pool-454-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.use.memory = false (default)
2021-10-05 13:25:56,266 [pool-454-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.purge.gap = 1000000 (custom)
2021-10-05 13:25:56,266 [pool-454-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2021-10-05 13:25:56,267 [pool-454-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.segment.size.max = 1048576 (custom)
2021-10-05 13:25:56,267 [pool-454-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.segment.cache.num.max = 2 (custom)
2021-10-05 13:25:56,267 [pool-454-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.segment.cache.size.max = 200MB (=209715200) (default)
2021-10-05 13:25:56,267 [pool-454-thread-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:<init>(182)) - new 106bb174-548c-482f-98a0-a37141c57762@group-5EA95D3F2CF7-SegmentedRaftLogWorker for RaftStorageImpl:Storage Directory /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-62d231c0-d845-4dcd-88aa-c082e017c57e/datanode-1/data/ratis/b3ab901a-6bcc-4c8d-8b24-5ea95d3f2cf7
2021-10-05 13:25:56,267 [pool-454-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2021-10-05 13:25:56,267 [pool-454-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.queue.element-limit = 1024 (custom)
2021-10-05 13:25:56,267 [pool-454-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.segment.size.max = 1048576 (custom)
2021-10-05 13:25:56,267 [pool-454-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.preallocated.size = 16384 (custom)
2021-10-05 13:25:56,267 [pool-454-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.force.sync.num = 128 (default)
2021-10-05 13:25:56,267 [pool-454-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.statemachine.data.sync = true (default)
2021-10-05 13:25:56,267 [pool-454-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2021-10-05 13:25:56,267 [pool-454-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2021-10-05 13:25:56,268 [pool-454-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.write.buffer.size = 1048576 (custom)
2021-10-05 13:25:56,269 [pool-454-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2021-10-05 13:25:56,269 [pool-454-thread-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:lambda$new$0(133)) - 106bb174-548c-482f-98a0-a37141c57762@group-5EA95D3F2CF7-SegmentedRaftLogWorker: flushIndex: setUnconditionally 0 -> -1
2021-10-05 13:25:56,269 [pool-454-thread-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:lambda$new$0(133)) - 106bb174-548c-482f-98a0-a37141c57762@group-5EA95D3F2CF7-SegmentedRaftLogWorker: safeCacheEvictIndex: setUnconditionally 0 -> -1
2021-10-05 13:25:56,270 [EventQueue-PipelineReportForPipelineReportHandler] INFO  pipeline.PipelineManagerImpl (PipelineManagerImpl.java:openPipeline(282)) - Pipeline Pipeline[ Id: b3ab901a-6bcc-4c8d-8b24-5ea95d3f2cf7, Nodes: 106bb174-548c-482f-98a0-a37141c57762{ip: 127.0.0.1, host: localhost, ports: [REPLICATION=38747, RATIS=43635, RATIS_ADMIN=43635, RATIS_SERVER=43635, STANDALONE=45889], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}, ReplicationConfig: RATIS/ONE, State:ALLOCATED, leaderId:106bb174-548c-482f-98a0-a37141c57762, CreationTimestamp2021-10-05T13:25:53.262Z[Etc/UTC]] moved to OPEN state
2021-10-05 13:25:56,270 [EventQueue-PipelineReportForPipelineReportHandler] INFO  pipeline.PipelineManagerImpl (PipelineManagerImpl.java:openPipeline(282)) - Pipeline Pipeline[ Id: b3ab901a-6bcc-4c8d-8b24-5ea95d3f2cf7, Nodes: 106bb174-548c-482f-98a0-a37141c57762{ip: 127.0.0.1, host: localhost, ports: [REPLICATION=38747, RATIS=43635, RATIS_ADMIN=43635, RATIS_SERVER=43635, STANDALONE=45889], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}, ReplicationConfig: RATIS/ONE, State:ALLOCATED, leaderId:106bb174-548c-482f-98a0-a37141c57762, CreationTimestamp2021-10-05T13:25:53.262Z[Etc/UTC]] moved to OPEN state
2021-10-05 13:25:56,271 [EventQueue-PipelineReportForPipelineReportHandler] INFO  ha.SCMHAInvocationHandler (SCMHAInvocationHandler.java:invokeRatis(113)) - Invoking method public abstract void org.apache.hadoop.hdds.scm.pipeline.PipelineStateManager.updatePipelineState(org.apache.hadoop.hdds.protocol.proto.HddsProtos$PipelineID,org.apache.hadoop.hdds.protocol.proto.HddsProtos$PipelineState) throws java.io.IOException on target org.apache.hadoop.hdds.scm.ha.SCMRatisServerImpl@1ffe502, cost 263.125us
2021-10-05 13:25:56,283 [pool-454-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2021-10-05 13:25:56,283 [pool-454-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2021-10-05 13:25:56,283 [pool-454-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.snapshot.retention.file.num = 5 (custom)
2021-10-05 13:25:56,283 [pool-454-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.purge.upto.snapshot.index = false (default)
2021-10-05 13:25:56,283 [pool-454-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.retrycache.expirytime = 600000ms (custom)
2021-10-05 13:25:56,283 [pool-454-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.retrycache.statistics.expirytime = 100μs (default)
2021-10-05 13:25:56,284 [pool-454-thread-1] INFO  server.RaftServer$Division (RaftServerImpl.java:start(296)) - 106bb174-548c-482f-98a0-a37141c57762@group-5EA95D3F2CF7: start as a follower, conf=-1: [106bb174-548c-482f-98a0-a37141c57762|rpc:127.0.0.1:43635|priority:1], old=null
2021-10-05 13:25:56,284 [pool-454-thread-1] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(285)) - 106bb174-548c-482f-98a0-a37141c57762@group-5EA95D3F2CF7: changes role from      null to FOLLOWER at term 0 for startAsFollower
2021-10-05 13:25:56,284 [pool-454-thread-1] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(130)) - 106bb174-548c-482f-98a0-a37141c57762: start 106bb174-548c-482f-98a0-a37141c57762@group-5EA95D3F2CF7-FollowerState
2021-10-05 13:25:56,287 [pool-454-thread-1] INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-5EA95D3F2CF7,id=106bb174-548c-482f-98a0-a37141c57762
2021-10-05 13:25:56,291 [Command processor thread] INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:addGroup(763)) - Created group PipelineID=b3ab901a-6bcc-4c8d-8b24-5ea95d3f2cf7
2021-10-05 13:25:56,291 [Command processor thread] INFO  commandhandler.CreatePipelineCommandHandler (CreatePipelineCommandHandler.java:handle(106)) - Created Pipeline RATIS ONE PipelineID=b3ab901a-6bcc-4c8d-8b24-5ea95d3f2cf7.
2021-10-05 13:25:56,303 [61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-StateMachineUpdater] INFO  safemode.HealthyPipelineSafeModeRule (HealthyPipelineSafeModeRule.java:initializeRule(152)) - Refreshed total pipeline count is 0, healthy pipeline threshold count is 1
2021-10-05 13:25:56,304 [EventQueue-PipelineReportForPipelineReportHandler] INFO  ha.SCMHAInvocationHandler (SCMHAInvocationHandler.java:invokeRatis(113)) - Invoking method public abstract void org.apache.hadoop.hdds.scm.pipeline.PipelineStateManager.updatePipelineState(org.apache.hadoop.hdds.protocol.proto.HddsProtos$PipelineID,org.apache.hadoop.hdds.protocol.proto.HddsProtos$PipelineState) throws java.io.IOException on target org.apache.hadoop.hdds.scm.ha.SCMRatisServerImpl@183f041f, cost 33417.626us
2021-10-05 13:25:56,304 [EventQueue-OpenPipelineForHealthyPipelineSafeModeRule] INFO  safemode.SCMSafeModeManager (HealthyPipelineSafeModeRule.java:process(124)) - SCM in safe mode. Healthy pipelines reported count is 0, required healthy pipeline reported count is 1
2021-10-05 13:25:56,326 [grpc-default-executor-2] INFO  server.RaftServer (RaftServerProxy.java:addNew(95)) - c2216084-e141-4b27-afe8-b6c5968528ec: addNew group-C784995F1F78:[2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc|rpc:127.0.0.1:45481|dataStream:|priority:0, c2216084-e141-4b27-afe8-b6c5968528ec|rpc:127.0.0.1:39195|dataStream:|priority:0, 106bb174-548c-482f-98a0-a37141c57762|rpc:127.0.0.1:43635|dataStream:|priority:1] returns group-C784995F1F78:java.util.concurrent.CompletableFuture@155fa55a[Not completed]
2021-10-05 13:25:56,326 [pool-475-thread-1] INFO  server.RaftServer$Division (RaftServerImpl.java:<init>(181)) - c2216084-e141-4b27-afe8-b6c5968528ec: new RaftServerImpl for group-C784995F1F78:[2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc|rpc:127.0.0.1:45481|dataStream:|priority:0, c2216084-e141-4b27-afe8-b6c5968528ec|rpc:127.0.0.1:39195|dataStream:|priority:0, 106bb174-548c-482f-98a0-a37141c57762|rpc:127.0.0.1:43635|dataStream:|priority:1] with ContainerStateMachine:uninitialized
2021-10-05 13:25:56,326 [pool-475-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.timeout.min = 5s (custom)
2021-10-05 13:25:56,326 [pool-475-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.timeout.max = 5200ms (custom)
2021-10-05 13:25:56,326 [pool-475-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.sleep.time = 25ms (default)
2021-10-05 13:25:56,327 [pool-475-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.slowness.timeout = 300s (custom)
2021-10-05 13:25:56,327 [pool-475-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.leaderelection.leader.step-down.wait-time = 10s (default)
2021-10-05 13:25:56,327 [pool-475-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.sleep.deviation.threshold = 300ms (default)
2021-10-05 13:25:56,327 [pool-475-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.appender.install.snapshot.enabled = false (custom)
2021-10-05 13:25:56,327 [pool-475-thread-1] INFO  server.RaftServer$Division (ServerState.java:<init>(105)) - c2216084-e141-4b27-afe8-b6c5968528ec@group-C784995F1F78: ConfigurationManager, init=-1: [2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc|rpc:127.0.0.1:45481|dataStream:|priority:0, c2216084-e141-4b27-afe8-b6c5968528ec|rpc:127.0.0.1:39195|dataStream:|priority:0, 106bb174-548c-482f-98a0-a37141c57762|rpc:127.0.0.1:43635|dataStream:|priority:1], old=null, confs=<EMPTY_MAP>
2021-10-05 13:25:56,327 [pool-475-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.storage.dir = [/home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-62d231c0-d845-4dcd-88aa-c082e017c57e/datanode-2/data/ratis] (custom)
2021-10-05 13:25:56,327 [pool-475-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.corruption.policy = EXCEPTION (default)
2021-10-05 13:25:56,327 [pool-475-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.storage.free-space.min = 0MB (=0) (default)
2021-10-05 13:25:56,327 [pool-475-thread-1] INFO  storage.RaftStorageDirectory (RaftStorageDirectoryImpl.java:analyzeStorage(135)) - The storage directory /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-62d231c0-d845-4dcd-88aa-c082e017c57e/datanode-2/data/ratis/695b8808-dd40-42c0-a85d-c784995f1f78 does not exist. Creating ...
2021-10-05 13:25:56,332 [pool-475-thread-1] INFO  storage.RaftStorageDirectory (RaftStorageDirectoryImpl.java:tryLock(230)) - Lock on /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-62d231c0-d845-4dcd-88aa-c082e017c57e/datanode-2/data/ratis/695b8808-dd40-42c0-a85d-c784995f1f78/in_use.lock acquired by nodename 17451@fv-az270-324
2021-10-05 13:25:56,334 [pool-475-thread-1] INFO  storage.RaftStorage (RaftStorageImpl.java:format(89)) - Storage directory /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-62d231c0-d845-4dcd-88aa-c082e017c57e/datanode-2/data/ratis/695b8808-dd40-42c0-a85d-c784995f1f78 has been successfully formatted.
2021-10-05 13:25:56,334 [pool-475-thread-1] INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(224)) - group-C784995F1F78: The snapshot info is null. Setting the last applied indexto:(t:0, i:~)
2021-10-05 13:25:56,335 [b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-StateMachineUpdater] INFO  safemode.HealthyPipelineSafeModeRule (HealthyPipelineSafeModeRule.java:initializeRule(152)) - Refreshed total pipeline count is 0, healthy pipeline threshold count is 1
2021-10-05 13:25:56,336 [pool-475-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.notification.no-leader.timeout = 300s (custom)
2021-10-05 13:25:56,336 [pool-475-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.use.memory = false (default)
2021-10-05 13:25:56,336 [pool-475-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.purge.gap = 1000000 (custom)
2021-10-05 13:25:56,336 [pool-475-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2021-10-05 13:25:56,336 [pool-475-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.segment.size.max = 1048576 (custom)
2021-10-05 13:25:56,337 [pool-475-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.segment.cache.num.max = 2 (custom)
2021-10-05 13:25:56,337 [pool-475-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.segment.cache.size.max = 200MB (=209715200) (default)
2021-10-05 13:25:56,337 [pool-475-thread-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:<init>(182)) - new c2216084-e141-4b27-afe8-b6c5968528ec@group-C784995F1F78-SegmentedRaftLogWorker for RaftStorageImpl:Storage Directory /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-62d231c0-d845-4dcd-88aa-c082e017c57e/datanode-2/data/ratis/695b8808-dd40-42c0-a85d-c784995f1f78
2021-10-05 13:25:56,337 [pool-475-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2021-10-05 13:25:56,337 [pool-475-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.queue.element-limit = 1024 (custom)
2021-10-05 13:25:56,337 [pool-475-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.segment.size.max = 1048576 (custom)
2021-10-05 13:25:56,337 [pool-475-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.preallocated.size = 16384 (custom)
2021-10-05 13:25:56,337 [pool-475-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.force.sync.num = 128 (default)
2021-10-05 13:25:56,337 [pool-475-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.statemachine.data.sync = true (default)
2021-10-05 13:25:56,337 [pool-475-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2021-10-05 13:25:56,337 [pool-475-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2021-10-05 13:25:56,338 [pool-475-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.write.buffer.size = 1048576 (custom)
2021-10-05 13:25:56,339 [pool-475-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2021-10-05 13:25:56,339 [pool-475-thread-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:lambda$new$0(133)) - c2216084-e141-4b27-afe8-b6c5968528ec@group-C784995F1F78-SegmentedRaftLogWorker: flushIndex: setUnconditionally 0 -> -1
2021-10-05 13:25:56,339 [pool-475-thread-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:lambda$new$0(133)) - c2216084-e141-4b27-afe8-b6c5968528ec@group-C784995F1F78-SegmentedRaftLogWorker: safeCacheEvictIndex: setUnconditionally 0 -> -1
2021-10-05 13:25:56,340 [61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-StateMachineUpdater] INFO  ha.SCMStateMachine (SCMStateMachine.java:takeSnapshot(290)) - Current Snapshot Index 20, takeSnapshot took 0 ms
2021-10-05 13:25:56,340 [61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:takeSnapshot(281)) - 61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-StateMachineUpdater: Took a snapshot at index 20
2021-10-05 13:25:56,340 [61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:lambda$new$0(89)) - 61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-StateMachineUpdater: snapshotIndex: updateIncreasingly 15 -> 20
2021-10-05 13:25:56,340 [61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:purge(306)) - 61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-SegmentedRaftLog: purge 20
2021-10-05 13:25:56,340 [61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - 61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-SegmentedRaftLog: snapshotIndex: updateIncreasingly 15 -> 20
2021-10-05 13:25:56,340 [61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - 61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-SegmentedRaftLog: purgeIndex: updateToMax old=15, new=20, updated? true
2021-10-05 13:25:56,347 [pool-475-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2021-10-05 13:25:56,347 [pool-475-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2021-10-05 13:25:56,347 [pool-475-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.snapshot.retention.file.num = 5 (custom)
2021-10-05 13:25:56,347 [pool-475-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.purge.upto.snapshot.index = false (default)
2021-10-05 13:25:56,347 [pool-475-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.retrycache.expirytime = 600000ms (custom)
2021-10-05 13:25:56,347 [pool-475-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.retrycache.statistics.expirytime = 100μs (default)
2021-10-05 13:25:56,348 [pool-475-thread-1] INFO  server.RaftServer$Division (RaftServerImpl.java:start(296)) - c2216084-e141-4b27-afe8-b6c5968528ec@group-C784995F1F78: start as a follower, conf=-1: [2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc|rpc:127.0.0.1:45481|dataStream:|priority:0, c2216084-e141-4b27-afe8-b6c5968528ec|rpc:127.0.0.1:39195|dataStream:|priority:0, 106bb174-548c-482f-98a0-a37141c57762|rpc:127.0.0.1:43635|dataStream:|priority:1], old=null
2021-10-05 13:25:56,348 [pool-475-thread-1] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(285)) - c2216084-e141-4b27-afe8-b6c5968528ec@group-C784995F1F78: changes role from      null to FOLLOWER at term 0 for startAsFollower
2021-10-05 13:25:56,349 [pool-475-thread-1] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(130)) - c2216084-e141-4b27-afe8-b6c5968528ec: start c2216084-e141-4b27-afe8-b6c5968528ec@group-C784995F1F78-FollowerState
2021-10-05 13:25:56,359 [pool-475-thread-1] INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-C784995F1F78,id=c2216084-e141-4b27-afe8-b6c5968528ec
2021-10-05 13:25:56,379 [Command processor thread] INFO  commandhandler.CreatePipelineCommandHandler (CreatePipelineCommandHandler.java:handle(106)) - Created Pipeline RATIS THREE PipelineID=695b8808-dd40-42c0-a85d-c784995f1f78.
2021-10-05 13:25:56,565 [Listener at 127.0.0.1/10516] INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(235)) - Nodes are ready. Got 3 of 3 DN Heartbeats.
2021-10-05 13:25:56,565 [Listener at 127.0.0.1/10516] INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(238)) - Waiting for cluster to exit safe mode
2021-10-05 13:25:56,565 [Listener at 127.0.0.1/10516] INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(240)) - SCM became leader
2021-10-05 13:25:56,620 [Command processor thread] INFO  server.RaftServer (RaftServerProxy.java:addNew(95)) - c2216084-e141-4b27-afe8-b6c5968528ec: addNew group-A4888BD7295A:[c2216084-e141-4b27-afe8-b6c5968528ec|rpc:127.0.0.1:39195|priority:1] returns group-A4888BD7295A:java.util.concurrent.CompletableFuture@722e3871[Not completed]
2021-10-05 13:25:56,621 [pool-475-thread-1] INFO  server.RaftServer$Division (RaftServerImpl.java:<init>(181)) - c2216084-e141-4b27-afe8-b6c5968528ec: new RaftServerImpl for group-A4888BD7295A:[c2216084-e141-4b27-afe8-b6c5968528ec|rpc:127.0.0.1:39195|priority:1] with ContainerStateMachine:uninitialized
2021-10-05 13:25:56,621 [pool-475-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.timeout.min = 5s (custom)
2021-10-05 13:25:56,621 [pool-475-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.timeout.max = 5200ms (custom)
2021-10-05 13:25:56,621 [pool-475-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.sleep.time = 25ms (default)
2021-10-05 13:25:56,621 [pool-475-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.slowness.timeout = 300s (custom)
2021-10-05 13:25:56,621 [pool-475-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.leaderelection.leader.step-down.wait-time = 10s (default)
2021-10-05 13:25:56,621 [pool-475-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.sleep.deviation.threshold = 300ms (default)
2021-10-05 13:25:56,621 [pool-475-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.appender.install.snapshot.enabled = false (custom)
2021-10-05 13:25:56,621 [pool-475-thread-1] INFO  server.RaftServer$Division (ServerState.java:<init>(105)) - c2216084-e141-4b27-afe8-b6c5968528ec@group-A4888BD7295A: ConfigurationManager, init=-1: [c2216084-e141-4b27-afe8-b6c5968528ec|rpc:127.0.0.1:39195|priority:1], old=null, confs=<EMPTY_MAP>
2021-10-05 13:25:56,621 [pool-475-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.storage.dir = [/home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-62d231c0-d845-4dcd-88aa-c082e017c57e/datanode-2/data/ratis] (custom)
2021-10-05 13:25:56,622 [pool-475-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.corruption.policy = EXCEPTION (default)
2021-10-05 13:25:56,622 [pool-475-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.storage.free-space.min = 0MB (=0) (default)
2021-10-05 13:25:56,622 [pool-475-thread-1] INFO  storage.RaftStorageDirectory (RaftStorageDirectoryImpl.java:analyzeStorage(135)) - The storage directory /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-62d231c0-d845-4dcd-88aa-c082e017c57e/datanode-2/data/ratis/cdefc21d-4d0e-403d-8056-a4888bd7295a does not exist. Creating ...
2021-10-05 13:25:56,627 [pool-475-thread-1] INFO  storage.RaftStorageDirectory (RaftStorageDirectoryImpl.java:tryLock(230)) - Lock on /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-62d231c0-d845-4dcd-88aa-c082e017c57e/datanode-2/data/ratis/cdefc21d-4d0e-403d-8056-a4888bd7295a/in_use.lock acquired by nodename 17451@fv-az270-324
2021-10-05 13:25:56,632 [pool-475-thread-1] INFO  storage.RaftStorage (RaftStorageImpl.java:format(89)) - Storage directory /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-62d231c0-d845-4dcd-88aa-c082e017c57e/datanode-2/data/ratis/cdefc21d-4d0e-403d-8056-a4888bd7295a has been successfully formatted.
2021-10-05 13:25:56,632 [pool-475-thread-1] INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(224)) - group-A4888BD7295A: The snapshot info is null. Setting the last applied indexto:(t:0, i:~)
2021-10-05 13:25:56,634 [EventQueue-PipelineReportForPipelineReportHandler] INFO  pipeline.PipelineManagerImpl (PipelineManagerImpl.java:openPipeline(282)) - Pipeline Pipeline[ Id: cdefc21d-4d0e-403d-8056-a4888bd7295a, Nodes: c2216084-e141-4b27-afe8-b6c5968528ec{ip: 127.0.0.1, host: localhost, ports: [REPLICATION=45329, RATIS=39195, RATIS_ADMIN=39195, RATIS_SERVER=39195, STANDALONE=37211], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}, ReplicationConfig: RATIS/ONE, State:ALLOCATED, leaderId:c2216084-e141-4b27-afe8-b6c5968528ec, CreationTimestamp2021-10-05T13:25:53.623Z[Etc/UTC]] moved to OPEN state
2021-10-05 13:25:56,635 [EventQueue-PipelineReportForPipelineReportHandler] INFO  ha.SCMHAInvocationHandler (SCMHAInvocationHandler.java:invokeRatis(113)) - Invoking method public abstract void org.apache.hadoop.hdds.scm.pipeline.PipelineStateManager.updatePipelineState(org.apache.hadoop.hdds.protocol.proto.HddsProtos$PipelineID,org.apache.hadoop.hdds.protocol.proto.HddsProtos$PipelineState) throws java.io.IOException on target org.apache.hadoop.hdds.scm.ha.SCMRatisServerImpl@1ffe502, cost 303.029us
2021-10-05 13:25:56,635 [EventQueue-PipelineReportForPipelineReportHandler] INFO  pipeline.PipelineManagerImpl (PipelineManagerImpl.java:openPipeline(282)) - Pipeline Pipeline[ Id: cdefc21d-4d0e-403d-8056-a4888bd7295a, Nodes: c2216084-e141-4b27-afe8-b6c5968528ec{ip: 127.0.0.1, host: localhost, ports: [REPLICATION=45329, RATIS=39195, RATIS_ADMIN=39195, RATIS_SERVER=39195, STANDALONE=37211], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}, ReplicationConfig: RATIS/ONE, State:ALLOCATED, leaderId:c2216084-e141-4b27-afe8-b6c5968528ec, CreationTimestamp2021-10-05T13:25:53.623Z[Etc/UTC]] moved to OPEN state
2021-10-05 13:25:56,639 [pool-475-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.notification.no-leader.timeout = 300s (custom)
2021-10-05 13:25:56,639 [pool-475-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.use.memory = false (default)
2021-10-05 13:25:56,639 [pool-475-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.purge.gap = 1000000 (custom)
2021-10-05 13:25:56,639 [pool-475-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2021-10-05 13:25:56,640 [pool-475-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.segment.size.max = 1048576 (custom)
2021-10-05 13:25:56,640 [pool-475-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.segment.cache.num.max = 2 (custom)
2021-10-05 13:25:56,640 [pool-475-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.segment.cache.size.max = 200MB (=209715200) (default)
2021-10-05 13:25:56,640 [pool-475-thread-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:<init>(182)) - new c2216084-e141-4b27-afe8-b6c5968528ec@group-A4888BD7295A-SegmentedRaftLogWorker for RaftStorageImpl:Storage Directory /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-62d231c0-d845-4dcd-88aa-c082e017c57e/datanode-2/data/ratis/cdefc21d-4d0e-403d-8056-a4888bd7295a
2021-10-05 13:25:56,640 [pool-475-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2021-10-05 13:25:56,640 [pool-475-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.queue.element-limit = 1024 (custom)
2021-10-05 13:25:56,640 [pool-475-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.segment.size.max = 1048576 (custom)
2021-10-05 13:25:56,640 [pool-475-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.preallocated.size = 16384 (custom)
2021-10-05 13:25:56,640 [pool-475-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.force.sync.num = 128 (default)
2021-10-05 13:25:56,640 [pool-475-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.statemachine.data.sync = true (default)
2021-10-05 13:25:56,640 [pool-475-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2021-10-05 13:25:56,640 [pool-475-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2021-10-05 13:25:56,648 [pool-475-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.write.buffer.size = 1048576 (custom)
2021-10-05 13:25:56,655 [pool-475-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2021-10-05 13:25:56,655 [pool-475-thread-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:lambda$new$0(133)) - c2216084-e141-4b27-afe8-b6c5968528ec@group-A4888BD7295A-SegmentedRaftLogWorker: flushIndex: setUnconditionally 0 -> -1
2021-10-05 13:25:56,655 [pool-475-thread-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:lambda$new$0(133)) - c2216084-e141-4b27-afe8-b6c5968528ec@group-A4888BD7295A-SegmentedRaftLogWorker: safeCacheEvictIndex: setUnconditionally 0 -> -1
2021-10-05 13:25:56,660 [b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-StateMachineUpdater] INFO  ha.SCMStateMachine (SCMStateMachine.java:takeSnapshot(290)) - Current Snapshot Index 20, takeSnapshot took 0 ms
2021-10-05 13:25:56,660 [b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:takeSnapshot(281)) - b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-StateMachineUpdater: Took a snapshot at index 20
2021-10-05 13:25:56,660 [b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:lambda$new$0(89)) - b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-StateMachineUpdater: snapshotIndex: updateIncreasingly 15 -> 20
2021-10-05 13:25:56,660 [b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:purge(306)) - b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-SegmentedRaftLog: purge 20
2021-10-05 13:25:56,660 [b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-SegmentedRaftLog: snapshotIndex: updateIncreasingly 15 -> 20
2021-10-05 13:25:56,660 [b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-SegmentedRaftLog: purgeIndex: updateToMax old=15, new=20, updated? true
2021-10-05 13:25:56,660 [pool-475-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2021-10-05 13:25:56,660 [pool-475-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2021-10-05 13:25:56,660 [pool-475-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.snapshot.retention.file.num = 5 (custom)
2021-10-05 13:25:56,660 [pool-475-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.purge.upto.snapshot.index = false (default)
2021-10-05 13:25:56,660 [pool-475-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.retrycache.expirytime = 600000ms (custom)
2021-10-05 13:25:56,661 [pool-475-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.retrycache.statistics.expirytime = 100μs (default)
2021-10-05 13:25:56,661 [pool-475-thread-1] INFO  server.RaftServer$Division (RaftServerImpl.java:start(296)) - c2216084-e141-4b27-afe8-b6c5968528ec@group-A4888BD7295A: start as a follower, conf=-1: [c2216084-e141-4b27-afe8-b6c5968528ec|rpc:127.0.0.1:39195|priority:1], old=null
2021-10-05 13:25:56,662 [pool-475-thread-1] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(285)) - c2216084-e141-4b27-afe8-b6c5968528ec@group-A4888BD7295A: changes role from      null to FOLLOWER at term 0 for startAsFollower
2021-10-05 13:25:56,662 [pool-475-thread-1] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(130)) - c2216084-e141-4b27-afe8-b6c5968528ec: start c2216084-e141-4b27-afe8-b6c5968528ec@group-A4888BD7295A-FollowerState
2021-10-05 13:25:56,667 [61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-StateMachineUpdater] INFO  safemode.HealthyPipelineSafeModeRule (HealthyPipelineSafeModeRule.java:initializeRule(152)) - Refreshed total pipeline count is 0, healthy pipeline threshold count is 1
2021-10-05 13:25:56,667 [EventQueue-PipelineReportForPipelineReportHandler] INFO  ha.SCMHAInvocationHandler (SCMHAInvocationHandler.java:invokeRatis(113)) - Invoking method public abstract void org.apache.hadoop.hdds.scm.pipeline.PipelineStateManager.updatePipelineState(org.apache.hadoop.hdds.protocol.proto.HddsProtos$PipelineID,org.apache.hadoop.hdds.protocol.proto.HddsProtos$PipelineState) throws java.io.IOException on target org.apache.hadoop.hdds.scm.ha.SCMRatisServerImpl@183f041f, cost 31768.667us
2021-10-05 13:25:56,667 [EventQueue-OpenPipelineForHealthyPipelineSafeModeRule] INFO  safemode.SCMSafeModeManager (HealthyPipelineSafeModeRule.java:process(124)) - SCM in safe mode. Healthy pipelines reported count is 0, required healthy pipeline reported count is 1
2021-10-05 13:25:56,676 [pool-475-thread-1] INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-A4888BD7295A,id=c2216084-e141-4b27-afe8-b6c5968528ec
2021-10-05 13:25:56,692 [Command processor thread] INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:addGroup(763)) - Created group PipelineID=cdefc21d-4d0e-403d-8056-a4888bd7295a
2021-10-05 13:25:56,692 [Command processor thread] INFO  commandhandler.CreatePipelineCommandHandler (CreatePipelineCommandHandler.java:handle(106)) - Created Pipeline RATIS ONE PipelineID=cdefc21d-4d0e-403d-8056-a4888bd7295a.
2021-10-05 13:25:56,696 [b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-StateMachineUpdater] INFO  safemode.HealthyPipelineSafeModeRule (HealthyPipelineSafeModeRule.java:initializeRule(152)) - Refreshed total pipeline count is 0, healthy pipeline threshold count is 1
2021-10-05 13:25:56,784 [EndpointStateMachine task thread for /127.0.0.1:15041 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15041. Already tried 3 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:56,863 [EndpointStateMachine task thread for /127.0.0.1:13529 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:13529. Already tried 9 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:56,867 [EndpointStateMachine task thread for /127.0.0.1:13549 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:13549. Already tried 9 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:56,867 [EndpointStateMachine task thread for /127.0.0.1:15021 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15021. Already tried 7 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:56,867 [EndpointStateMachine task thread for /127.0.0.1:15031 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15031. Already tried 7 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:56,962 [EndpointStateMachine task thread for /127.0.0.1:13539 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:13539. Already tried 8 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:57,565 [Listener at 127.0.0.1/10516] INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(235)) - Nodes are ready. Got 3 of 3 DN Heartbeats.
2021-10-05 13:25:57,565 [Listener at 127.0.0.1/10516] INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(238)) - Waiting for cluster to exit safe mode
2021-10-05 13:25:57,565 [Listener at 127.0.0.1/10516] INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(240)) - SCM became leader
2021-10-05 13:25:57,784 [EndpointStateMachine task thread for /127.0.0.1:15041 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15041. Already tried 4 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:57,864 [EndpointStateMachine task thread for /127.0.0.1:13529 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:13529. Already tried 10 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:57,868 [EndpointStateMachine task thread for /127.0.0.1:15021 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15021. Already tried 8 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:57,868 [EndpointStateMachine task thread for /127.0.0.1:15031 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15031. Already tried 8 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:57,868 [EndpointStateMachine task thread for /127.0.0.1:13549 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:13549. Already tried 10 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:57,962 [EndpointStateMachine task thread for /127.0.0.1:13539 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:13539. Already tried 9 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:58,566 [Listener at 127.0.0.1/10516] INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(235)) - Nodes are ready. Got 3 of 3 DN Heartbeats.
2021-10-05 13:25:58,566 [Listener at 127.0.0.1/10516] INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(238)) - Waiting for cluster to exit safe mode
2021-10-05 13:25:58,566 [Listener at 127.0.0.1/10516] INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(240)) - SCM became leader
2021-10-05 13:25:58,784 [EndpointStateMachine task thread for /127.0.0.1:15041 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15041. Already tried 5 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:58,864 [EndpointStateMachine task thread for /127.0.0.1:13529 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:13529. Already tried 11 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:58,868 [EndpointStateMachine task thread for /127.0.0.1:15021 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15021. Already tried 9 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:58,868 [EndpointStateMachine task thread for /127.0.0.1:15031 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15031. Already tried 9 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:58,868 [EndpointStateMachine task thread for /127.0.0.1:13549 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:13549. Already tried 11 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:58,962 [EndpointStateMachine task thread for /127.0.0.1:13539 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:13539. Already tried 10 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:59,271 [Datanode State Machine Thread - 0] ERROR datanode.RunningDatanodeState (RunningDatanodeState.java:computeNextContainerState(199)) - Error in executing end point task.
java.util.concurrent.ExecutionException: java.util.concurrent.TimeoutException
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.hadoop.ozone.container.common.states.datanode.RunningDatanodeState.computeNextContainerState(RunningDatanodeState.java:191)
	at org.apache.hadoop.ozone.container.common.states.datanode.RunningDatanodeState.await(RunningDatanodeState.java:231)
	at org.apache.hadoop.ozone.container.common.states.datanode.RunningDatanodeState.await(RunningDatanodeState.java:50)
	at org.apache.hadoop.ozone.container.common.statemachine.StateContext.execute(StateContext.java:629)
	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.start(DatanodeStateMachine.java:270)
	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.lambda$startDaemon$0(DatanodeStateMachine.java:457)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.util.concurrent.TimeoutException
	at java.util.concurrent.FutureTask.get(FutureTask.java:205)
	at org.apache.hadoop.ozone.container.common.states.datanode.RunningDatanodeState.lambda$execute$0(RunningDatanodeState.java:149)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
2021-10-05 13:25:59,566 [Listener at 127.0.0.1/10516] INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(235)) - Nodes are ready. Got 3 of 3 DN Heartbeats.
2021-10-05 13:25:59,567 [Listener at 127.0.0.1/10516] INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(238)) - Waiting for cluster to exit safe mode
2021-10-05 13:25:59,567 [Listener at 127.0.0.1/10516] INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(240)) - SCM became leader
2021-10-05 13:25:59,633 [Datanode State Machine Thread - 0] ERROR datanode.RunningDatanodeState (RunningDatanodeState.java:computeNextContainerState(199)) - Error in executing end point task.
java.util.concurrent.ExecutionException: java.util.concurrent.TimeoutException
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.hadoop.ozone.container.common.states.datanode.RunningDatanodeState.computeNextContainerState(RunningDatanodeState.java:191)
	at org.apache.hadoop.ozone.container.common.states.datanode.RunningDatanodeState.await(RunningDatanodeState.java:231)
	at org.apache.hadoop.ozone.container.common.states.datanode.RunningDatanodeState.await(RunningDatanodeState.java:50)
	at org.apache.hadoop.ozone.container.common.statemachine.StateContext.execute(StateContext.java:629)
	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.start(DatanodeStateMachine.java:270)
	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.lambda$startDaemon$0(DatanodeStateMachine.java:457)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.util.concurrent.TimeoutException
	at java.util.concurrent.FutureTask.get(FutureTask.java:205)
	at org.apache.hadoop.ozone.container.common.states.datanode.RunningDatanodeState.lambda$execute$0(RunningDatanodeState.java:149)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
2021-10-05 13:25:59,785 [EndpointStateMachine task thread for /127.0.0.1:15041 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15041. Already tried 6 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:59,865 [EndpointStateMachine task thread for /127.0.0.1:13529 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:13529. Already tried 12 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:59,869 [EndpointStateMachine task thread for /127.0.0.1:15031 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15031. Already tried 10 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:59,869 [EndpointStateMachine task thread for /127.0.0.1:13549 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:13549. Already tried 12 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:59,871 [EndpointStateMachine task thread for /127.0.0.1:15021 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15021. Already tried 10 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:25:59,963 [EndpointStateMachine task thread for /127.0.0.1:13539 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:13539. Already tried 11 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:26:00,177 [Datanode State Machine Thread - 0] ERROR datanode.RunningDatanodeState (RunningDatanodeState.java:computeNextContainerState(199)) - Error in executing end point task.
java.util.concurrent.ExecutionException: java.util.concurrent.TimeoutException
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.hadoop.ozone.container.common.states.datanode.RunningDatanodeState.computeNextContainerState(RunningDatanodeState.java:191)
	at org.apache.hadoop.ozone.container.common.states.datanode.RunningDatanodeState.await(RunningDatanodeState.java:231)
	at org.apache.hadoop.ozone.container.common.states.datanode.RunningDatanodeState.await(RunningDatanodeState.java:50)
	at org.apache.hadoop.ozone.container.common.statemachine.StateContext.execute(StateContext.java:629)
	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.start(DatanodeStateMachine.java:270)
	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.lambda$startDaemon$0(DatanodeStateMachine.java:457)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.util.concurrent.TimeoutException
	at java.util.concurrent.FutureTask.get(FutureTask.java:205)
	at org.apache.hadoop.ozone.container.common.states.datanode.RunningDatanodeState.lambda$execute$0(RunningDatanodeState.java:149)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
2021-10-05 13:26:00,567 [Listener at 127.0.0.1/10516] INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(235)) - Nodes are ready. Got 3 of 3 DN Heartbeats.
2021-10-05 13:26:00,567 [Listener at 127.0.0.1/10516] INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(238)) - Waiting for cluster to exit safe mode
2021-10-05 13:26:00,567 [Listener at 127.0.0.1/10516] INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(240)) - SCM became leader
2021-10-05 13:26:00,786 [EndpointStateMachine task thread for /127.0.0.1:15041 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15041. Already tried 7 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:26:00,865 [EndpointStateMachine task thread for /127.0.0.1:13529 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:13529. Already tried 13 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:26:00,869 [EndpointStateMachine task thread for /127.0.0.1:15031 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15031. Already tried 11 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:26:00,869 [EndpointStateMachine task thread for /127.0.0.1:13549 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:13549. Already tried 13 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:26:00,871 [EndpointStateMachine task thread for /127.0.0.1:15021 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15021. Already tried 11 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:26:00,963 [EndpointStateMachine task thread for /127.0.0.1:13539 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:13539. Already tried 12 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:26:01,084 [2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc@group-15090DED4481-FollowerState] INFO  impl.FollowerState (FollowerState.java:run(134)) - 2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc@group-15090DED4481-FollowerState: change to CANDIDATE, lastRpcElapsedTime:5171985762ns, electionTimeout:5161ms
2021-10-05 13:26:01,085 [2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc@group-15090DED4481-FollowerState] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(108)) - 2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc: shutdown 2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc@group-15090DED4481-FollowerState
2021-10-05 13:26:01,085 [2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc@group-15090DED4481-FollowerState] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(285)) - 2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc@group-15090DED4481: changes role from  FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2021-10-05 13:26:01,085 [2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc@group-15090DED4481-FollowerState] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.leaderelection.pre-vote = false (custom)
2021-10-05 13:26:01,085 [2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc@group-15090DED4481-FollowerState] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(130)) - 2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc: start 2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc@group-15090DED4481-LeaderElection31
2021-10-05 13:26:01,107 [2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc@group-15090DED4481-LeaderElection31] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(306)) - 2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc@group-15090DED4481-LeaderElection31 ELECTION round 0: submit vote requests at term 1 for -1: [2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc|rpc:127.0.0.1:45481|priority:1], old=null
2021-10-05 13:26:01,107 [2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc@group-15090DED4481-LeaderElection31] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(308)) - 2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc@group-15090DED4481-LeaderElection31 ELECTION round 0: result PASSED (term=1)
2021-10-05 13:26:01,107 [2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc@group-15090DED4481-LeaderElection31] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(121)) - 2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc: shutdown 2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc@group-15090DED4481-LeaderElection31
2021-10-05 13:26:01,107 [2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc@group-15090DED4481-LeaderElection31] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(285)) - 2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc@group-15090DED4481: changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2021-10-05 13:26:01,107 [2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc@group-15090DED4481-LeaderElection31] INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:handleLeaderChangedNotification(861)) - Leader change notification received for group: group-15090DED4481 with new leaderId: 2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc
2021-10-05 13:26:01,112 [EventQueue-OpenPipelineForHealthyPipelineSafeModeRule] INFO  safemode.SCMSafeModeManager (HealthyPipelineSafeModeRule.java:process(124)) - SCM in safe mode. Healthy pipelines reported count is 0, required healthy pipeline reported count is 1
2021-10-05 13:26:01,114 [EventQueue-OpenPipelineForHealthyPipelineSafeModeRule] INFO  safemode.SCMSafeModeManager (HealthyPipelineSafeModeRule.java:process(124)) - SCM in safe mode. Healthy pipelines reported count is 0, required healthy pipeline reported count is 1
2021-10-05 13:26:01,114 [2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc@group-15090DED4481-LeaderElection31] INFO  server.RaftServer$Division (ServerState.java:setLeader(285)) - 2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc@group-15090DED4481: change Leader from null to 2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc at term 1 for becomeLeader, leader elected after 5216ms
2021-10-05 13:26:01,114 [2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc@group-15090DED4481-LeaderElection31] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.staging.catchup.gap = 1000 (default)
2021-10-05 13:26:01,114 [2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc@group-15090DED4481-LeaderElection31] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.write.element-limit = 1024 (custom)
2021-10-05 13:26:01,114 [2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc@group-15090DED4481-LeaderElection31] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.write.byte-limit = 1024 M (=1073741824) (custom)
2021-10-05 13:26:01,115 [2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc@group-15090DED4481-LeaderElection31] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.watch.timeout = 180s (custom)
2021-10-05 13:26:01,115 [2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc@group-15090DED4481-LeaderElection31] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.watch.timeout.denomination = 1s (default)
2021-10-05 13:26:01,115 [2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc@group-15090DED4481-LeaderElection31] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.watch.element-limit = 65536 (default)
2021-10-05 13:26:01,115 [2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc@group-15090DED4481-LeaderElection31] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(130)) - 2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc: start 2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc@group-15090DED4481-LeaderStateImpl
2021-10-05 13:26:01,115 [2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc@group-15090DED4481-LeaderElection31] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:startLogSegment(394)) - 2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc@group-15090DED4481-SegmentedRaftLogWorker: Starting segment from index:0
2021-10-05 13:26:01,121 [2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc@group-15090DED4481-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(601)) - 2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc@group-15090DED4481-SegmentedRaftLogWorker: created new log segment /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-62d231c0-d845-4dcd-88aa-c082e017c57e/datanode-0/data/ratis/b98fb588-c6d1-40ce-b522-15090ded4481/current/log_inprogress_0
2021-10-05 13:26:01,137 [2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc@group-15090DED4481-LeaderElection31] INFO  server.RaftServer$Division (ServerState.java:setRaftConf(387)) - 2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc@group-15090DED4481: set configuration 0: [2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc|rpc:127.0.0.1:45481|dataStream:|priority:1], old=null
2021-10-05 13:26:01,145 [c2216084-e141-4b27-afe8-b6c5968528ec@group-E674C48A3917-FollowerState] INFO  impl.FollowerState (FollowerState.java:run(134)) - c2216084-e141-4b27-afe8-b6c5968528ec@group-E674C48A3917-FollowerState: change to CANDIDATE, lastRpcElapsedTime:5093428563ns, electionTimeout:5079ms
2021-10-05 13:26:01,146 [c2216084-e141-4b27-afe8-b6c5968528ec@group-E674C48A3917-FollowerState] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(108)) - c2216084-e141-4b27-afe8-b6c5968528ec: shutdown c2216084-e141-4b27-afe8-b6c5968528ec@group-E674C48A3917-FollowerState
2021-10-05 13:26:01,146 [c2216084-e141-4b27-afe8-b6c5968528ec@group-E674C48A3917-FollowerState] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(285)) - c2216084-e141-4b27-afe8-b6c5968528ec@group-E674C48A3917: changes role from  FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2021-10-05 13:26:01,147 [c2216084-e141-4b27-afe8-b6c5968528ec@group-E674C48A3917-FollowerState] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.leaderelection.pre-vote = false (custom)
2021-10-05 13:26:01,147 [c2216084-e141-4b27-afe8-b6c5968528ec@group-E674C48A3917-FollowerState] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(130)) - c2216084-e141-4b27-afe8-b6c5968528ec: start c2216084-e141-4b27-afe8-b6c5968528ec@group-E674C48A3917-LeaderElection32
2021-10-05 13:26:01,175 [c2216084-e141-4b27-afe8-b6c5968528ec@group-E674C48A3917-LeaderElection32] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(306)) - c2216084-e141-4b27-afe8-b6c5968528ec@group-E674C48A3917-LeaderElection32 ELECTION round 0: submit vote requests at term 1 for -1: [2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc|rpc:127.0.0.1:45481|dataStream:|priority:0, c2216084-e141-4b27-afe8-b6c5968528ec|rpc:127.0.0.1:39195|dataStream:|priority:1, 106bb174-548c-482f-98a0-a37141c57762|rpc:127.0.0.1:43635|dataStream:|priority:0], old=null
2021-10-05 13:26:01,183 [2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc@group-E674C48A3917-FollowerState] INFO  impl.FollowerState (FollowerState.java:run(134)) - 2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc@group-E674C48A3917-FollowerState: change to CANDIDATE, lastRpcElapsedTime:5196260684ns, electionTimeout:5195ms
2021-10-05 13:26:01,183 [2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc@group-E674C48A3917-FollowerState] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(108)) - 2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc: shutdown 2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc@group-E674C48A3917-FollowerState
2021-10-05 13:26:01,183 [2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc@group-E674C48A3917-FollowerState] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(285)) - 2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc@group-E674C48A3917: changes role from  FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2021-10-05 13:26:01,183 [2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc@group-E674C48A3917-FollowerState] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.leaderelection.pre-vote = false (custom)
2021-10-05 13:26:01,183 [2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc@group-E674C48A3917-FollowerState] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(130)) - 2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc: start 2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc@group-E674C48A3917-LeaderElection33
2021-10-05 13:26:01,208 [grpc-default-executor-0] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1043)) - 106bb174-548c-482f-98a0-a37141c57762@group-E674C48A3917: receive requestVote(ELECTION, c2216084-e141-4b27-afe8-b6c5968528ec, group-E674C48A3917, 1, (t:0, i:0))
2021-10-05 13:26:01,208 [grpc-default-executor-0] INFO  impl.VoteContext (VoteContext.java:log(48)) - 106bb174-548c-482f-98a0-a37141c57762@group-E674C48A3917-FOLLOWER: accept ELECTION from c2216084-e141-4b27-afe8-b6c5968528ec: our priority 0 <= candidate's priority 1
2021-10-05 13:26:01,208 [grpc-default-executor-0] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(285)) - 106bb174-548c-482f-98a0-a37141c57762@group-E674C48A3917: changes role from  FOLLOWER to FOLLOWER at term 1 for candidate:c2216084-e141-4b27-afe8-b6c5968528ec
2021-10-05 13:26:01,208 [grpc-default-executor-0] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(108)) - 106bb174-548c-482f-98a0-a37141c57762: shutdown 106bb174-548c-482f-98a0-a37141c57762@group-E674C48A3917-FollowerState
2021-10-05 13:26:01,208 [106bb174-548c-482f-98a0-a37141c57762@group-E674C48A3917-FollowerState] INFO  impl.FollowerState (FollowerState.java:run(143)) - 106bb174-548c-482f-98a0-a37141c57762@group-E674C48A3917-FollowerState was interrupted: {}
java.lang.InterruptedException: sleep interrupted
	at java.lang.Thread.sleep(Native Method)
	at java.lang.Thread.sleep(Thread.java:340)
	at java.util.concurrent.TimeUnit.sleep(TimeUnit.java:386)
	at org.apache.ratis.util.TimeDuration.sleep(TimeDuration.java:324)
	at org.apache.ratis.util.TimeDuration.sleep(TimeDuration.java:309)
	at org.apache.ratis.server.impl.FollowerState.run(FollowerState.java:118)
2021-10-05 13:26:01,208 [grpc-default-executor-0] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(130)) - 106bb174-548c-482f-98a0-a37141c57762: start 106bb174-548c-482f-98a0-a37141c57762@group-E674C48A3917-FollowerState
2021-10-05 13:26:01,234 [grpc-default-executor-0] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1075)) - 106bb174-548c-482f-98a0-a37141c57762@group-E674C48A3917 replies to ELECTION vote request: c2216084-e141-4b27-afe8-b6c5968528ec<-106bb174-548c-482f-98a0-a37141c57762#0:OK-t1. Peer's state: 106bb174-548c-482f-98a0-a37141c57762@group-E674C48A3917:t1, leader=null, voted=c2216084-e141-4b27-afe8-b6c5968528ec, raftlog=106bb174-548c-482f-98a0-a37141c57762@group-E674C48A3917-SegmentedRaftLog:OPENED:c-1,f-1,i0, conf=-1: [2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc|rpc:127.0.0.1:45481|dataStream:|priority:0, c2216084-e141-4b27-afe8-b6c5968528ec|rpc:127.0.0.1:39195|dataStream:|priority:1, 106bb174-548c-482f-98a0-a37141c57762|rpc:127.0.0.1:43635|dataStream:|priority:0], old=null
2021-10-05 13:26:01,235 [c2216084-e141-4b27-afe8-b6c5968528ec@group-E674C48A3917-LeaderElection32] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(89)) - c2216084-e141-4b27-afe8-b6c5968528ec@group-E674C48A3917-LeaderElection32: ELECTION PASSED received 1 response(s) and 0 exception(s):
2021-10-05 13:26:01,235 [c2216084-e141-4b27-afe8-b6c5968528ec@group-E674C48A3917-LeaderElection32] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(93)) -   Response 0: c2216084-e141-4b27-afe8-b6c5968528ec<-106bb174-548c-482f-98a0-a37141c57762#0:OK-t1
2021-10-05 13:26:01,235 [c2216084-e141-4b27-afe8-b6c5968528ec@group-E674C48A3917-LeaderElection32] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(308)) - c2216084-e141-4b27-afe8-b6c5968528ec@group-E674C48A3917-LeaderElection32 ELECTION round 0: result PASSED
2021-10-05 13:26:01,235 [c2216084-e141-4b27-afe8-b6c5968528ec@group-E674C48A3917-LeaderElection32] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(121)) - c2216084-e141-4b27-afe8-b6c5968528ec: shutdown c2216084-e141-4b27-afe8-b6c5968528ec@group-E674C48A3917-LeaderElection32
2021-10-05 13:26:01,235 [c2216084-e141-4b27-afe8-b6c5968528ec@group-E674C48A3917-LeaderElection32] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(285)) - c2216084-e141-4b27-afe8-b6c5968528ec@group-E674C48A3917: changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2021-10-05 13:26:01,235 [c2216084-e141-4b27-afe8-b6c5968528ec@group-E674C48A3917-LeaderElection32] INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:handleLeaderChangedNotification(861)) - Leader change notification received for group: group-E674C48A3917 with new leaderId: c2216084-e141-4b27-afe8-b6c5968528ec
2021-10-05 13:26:01,235 [c2216084-e141-4b27-afe8-b6c5968528ec@group-E674C48A3917-LeaderElection32] INFO  server.RaftServer$Division (ServerState.java:setLeader(285)) - c2216084-e141-4b27-afe8-b6c5968528ec@group-E674C48A3917: change Leader from null to c2216084-e141-4b27-afe8-b6c5968528ec at term 1 for becomeLeader, leader elected after 5198ms
2021-10-05 13:26:01,235 [c2216084-e141-4b27-afe8-b6c5968528ec@group-E674C48A3917-LeaderElection32] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.staging.catchup.gap = 1000 (default)
2021-10-05 13:26:01,236 [c2216084-e141-4b27-afe8-b6c5968528ec@group-E674C48A3917-LeaderElection32] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.write.element-limit = 1024 (custom)
2021-10-05 13:26:01,236 [c2216084-e141-4b27-afe8-b6c5968528ec@group-E674C48A3917-LeaderElection32] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.write.byte-limit = 1024 M (=1073741824) (custom)
2021-10-05 13:26:01,236 [c2216084-e141-4b27-afe8-b6c5968528ec@group-E674C48A3917-LeaderElection32] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.watch.timeout = 180s (custom)
2021-10-05 13:26:01,236 [c2216084-e141-4b27-afe8-b6c5968528ec@group-E674C48A3917-LeaderElection32] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.watch.timeout.denomination = 1s (default)
2021-10-05 13:26:01,236 [c2216084-e141-4b27-afe8-b6c5968528ec@group-E674C48A3917-LeaderElection32] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.watch.element-limit = 65536 (default)
2021-10-05 13:26:01,236 [c2216084-e141-4b27-afe8-b6c5968528ec@group-E674C48A3917-LeaderElection32] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2021-10-05 13:26:01,236 [c2216084-e141-4b27-afe8-b6c5968528ec@group-E674C48A3917-LeaderElection32] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2021-10-05 13:26:01,236 [c2216084-e141-4b27-afe8-b6c5968528ec@group-E674C48A3917-LeaderElection32] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.appender.buffer.element-limit = 1 (custom)
2021-10-05 13:26:01,236 [c2216084-e141-4b27-afe8-b6c5968528ec@group-E674C48A3917-LeaderElection32] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(44)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2021-10-05 13:26:01,236 [c2216084-e141-4b27-afe8-b6c5968528ec@group-E674C48A3917-LeaderElection32] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.request.timeout = 60s (custom)
2021-10-05 13:26:01,236 [c2216084-e141-4b27-afe8-b6c5968528ec@group-E674C48A3917-LeaderElection32] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.appender.install.snapshot.enabled = false (custom)
2021-10-05 13:26:01,237 [c2216084-e141-4b27-afe8-b6c5968528ec@group-E674C48A3917-LeaderElection32] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2021-10-05 13:26:01,237 [c2216084-e141-4b27-afe8-b6c5968528ec@group-E674C48A3917-LeaderElection32] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2021-10-05 13:26:01,237 [c2216084-e141-4b27-afe8-b6c5968528ec@group-E674C48A3917-LeaderElection32] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.appender.buffer.element-limit = 1 (custom)
2021-10-05 13:26:01,237 [c2216084-e141-4b27-afe8-b6c5968528ec@group-E674C48A3917-LeaderElection32] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(44)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2021-10-05 13:26:01,237 [c2216084-e141-4b27-afe8-b6c5968528ec@group-E674C48A3917-LeaderElection32] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.request.timeout = 60s (custom)
2021-10-05 13:26:01,237 [c2216084-e141-4b27-afe8-b6c5968528ec@group-E674C48A3917-LeaderElection32] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.appender.install.snapshot.enabled = false (custom)
2021-10-05 13:26:01,238 [c2216084-e141-4b27-afe8-b6c5968528ec@group-E674C48A3917-LeaderElection32] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(130)) - c2216084-e141-4b27-afe8-b6c5968528ec: start c2216084-e141-4b27-afe8-b6c5968528ec@group-E674C48A3917-LeaderStateImpl
2021-10-05 13:26:01,238 [c2216084-e141-4b27-afe8-b6c5968528ec@group-E674C48A3917-LeaderElection32] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:startLogSegment(394)) - c2216084-e141-4b27-afe8-b6c5968528ec@group-E674C48A3917-SegmentedRaftLogWorker: Starting segment from index:0
2021-10-05 13:26:01,241 [2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc@group-E674C48A3917-LeaderElection33] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(306)) - 2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc@group-E674C48A3917-LeaderElection33 ELECTION round 0: submit vote requests at term 1 for -1: [2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc|rpc:127.0.0.1:45481|priority:0, c2216084-e141-4b27-afe8-b6c5968528ec|rpc:127.0.0.1:39195|priority:1, 106bb174-548c-482f-98a0-a37141c57762|rpc:127.0.0.1:43635|priority:0], old=null
2021-10-05 13:26:01,241 [EventQueue-PipelineReportForPipelineReportHandler] INFO  pipeline.PipelineManagerImpl (PipelineManagerImpl.java:openPipeline(282)) - Pipeline Pipeline[ Id: 70d43e9a-313f-4a40-8629-e674c48a3917, Nodes: 2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc{ip: 127.0.0.1, host: localhost, ports: [REPLICATION=42707, RATIS=45481, RATIS_ADMIN=45481, RATIS_SERVER=45481, STANDALONE=42383], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}c2216084-e141-4b27-afe8-b6c5968528ec{ip: 127.0.0.1, host: localhost, ports: [REPLICATION=45329, RATIS=39195, RATIS_ADMIN=39195, RATIS_SERVER=39195, STANDALONE=37211], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}106bb174-548c-482f-98a0-a37141c57762{ip: 127.0.0.1, host: localhost, ports: [REPLICATION=38747, RATIS=43635, RATIS_ADMIN=43635, RATIS_SERVER=43635, STANDALONE=45889], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}, ReplicationConfig: RATIS/THREE, State:ALLOCATED, leaderId:c2216084-e141-4b27-afe8-b6c5968528ec, CreationTimestamp2021-10-05T13:25:53.641Z[Etc/UTC]] moved to OPEN state
2021-10-05 13:26:01,242 [EventQueue-PipelineReportForPipelineReportHandler] INFO  ha.SCMHAInvocationHandler (SCMHAInvocationHandler.java:invokeRatis(113)) - Invoking method public abstract void org.apache.hadoop.hdds.scm.pipeline.PipelineStateManager.updatePipelineState(org.apache.hadoop.hdds.protocol.proto.HddsProtos$PipelineID,org.apache.hadoop.hdds.protocol.proto.HddsProtos$PipelineState) throws java.io.IOException on target org.apache.hadoop.hdds.scm.ha.SCMRatisServerImpl@1ffe502, cost 202.719us
2021-10-05 13:26:01,242 [EventQueue-PipelineReportForPipelineReportHandler] INFO  pipeline.PipelineManagerImpl (PipelineManagerImpl.java:openPipeline(282)) - Pipeline Pipeline[ Id: 70d43e9a-313f-4a40-8629-e674c48a3917, Nodes: 2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc{ip: 127.0.0.1, host: localhost, ports: [REPLICATION=42707, RATIS=45481, RATIS_ADMIN=45481, RATIS_SERVER=45481, STANDALONE=42383], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}c2216084-e141-4b27-afe8-b6c5968528ec{ip: 127.0.0.1, host: localhost, ports: [REPLICATION=45329, RATIS=39195, RATIS_ADMIN=39195, RATIS_SERVER=39195, STANDALONE=37211], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}106bb174-548c-482f-98a0-a37141c57762{ip: 127.0.0.1, host: localhost, ports: [REPLICATION=38747, RATIS=43635, RATIS_ADMIN=43635, RATIS_SERVER=43635, STANDALONE=45889], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}, ReplicationConfig: RATIS/THREE, State:ALLOCATED, leaderId:c2216084-e141-4b27-afe8-b6c5968528ec, CreationTimestamp2021-10-05T13:25:53.641Z[Etc/UTC]] moved to OPEN state
2021-10-05 13:26:01,242 [EventQueue-OpenPipelineForHealthyPipelineSafeModeRule] INFO  safemode.SCMSafeModeManager (HealthyPipelineSafeModeRule.java:process(124)) - SCM in safe mode. Healthy pipelines reported count is 0, required healthy pipeline reported count is 1
2021-10-05 13:26:01,245 [grpc-default-executor-0] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1043)) - 2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc@group-E674C48A3917: receive requestVote(ELECTION, c2216084-e141-4b27-afe8-b6c5968528ec, group-E674C48A3917, 1, (t:0, i:0))
2021-10-05 13:26:01,245 [grpc-default-executor-0] INFO  impl.VoteContext (VoteContext.java:log(48)) - 2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc@group-E674C48A3917-CANDIDATE: reject ELECTION from c2216084-e141-4b27-afe8-b6c5968528ec: already has voted for 2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc at current term 1
2021-10-05 13:26:01,245 [grpc-default-executor-0] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1075)) - 2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc@group-E674C48A3917 replies to ELECTION vote request: c2216084-e141-4b27-afe8-b6c5968528ec<-2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc#0:FAIL-t1. Peer's state: 2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc@group-E674C48A3917:t1, leader=null, voted=2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc, raftlog=2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc@group-E674C48A3917-SegmentedRaftLog:OPENED:c-1,f-1,i0, conf=-1: [2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc|rpc:127.0.0.1:45481|priority:0, c2216084-e141-4b27-afe8-b6c5968528ec|rpc:127.0.0.1:39195|priority:1, 106bb174-548c-482f-98a0-a37141c57762|rpc:127.0.0.1:43635|priority:0], old=null
2021-10-05 13:26:01,271 [c2216084-e141-4b27-afe8-b6c5968528ec@group-E674C48A3917-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(601)) - c2216084-e141-4b27-afe8-b6c5968528ec@group-E674C48A3917-SegmentedRaftLogWorker: created new log segment /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-62d231c0-d845-4dcd-88aa-c082e017c57e/datanode-2/data/ratis/70d43e9a-313f-4a40-8629-e674c48a3917/current/log_inprogress_0
2021-10-05 13:26:01,272 [2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc@group-C784995F1F78-FollowerState] INFO  impl.FollowerState (FollowerState.java:run(134)) - 2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc@group-C784995F1F78-FollowerState: change to CANDIDATE, lastRpcElapsedTime:5081190257ns, electionTimeout:5080ms
2021-10-05 13:26:01,272 [2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc@group-C784995F1F78-FollowerState] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(108)) - 2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc: shutdown 2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc@group-C784995F1F78-FollowerState
2021-10-05 13:26:01,272 [2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc@group-C784995F1F78-FollowerState] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(285)) - 2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc@group-C784995F1F78: changes role from  FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2021-10-05 13:26:01,275 [61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-StateMachineUpdater] INFO  safemode.HealthyPipelineSafeModeRule (HealthyPipelineSafeModeRule.java:initializeRule(152)) - Refreshed total pipeline count is 1, healthy pipeline threshold count is 1
2021-10-05 13:26:01,275 [EventQueue-PipelineReportForPipelineReportHandler] INFO  ha.SCMHAInvocationHandler (SCMHAInvocationHandler.java:invokeRatis(113)) - Invoking method public abstract void org.apache.hadoop.hdds.scm.pipeline.PipelineStateManager.updatePipelineState(org.apache.hadoop.hdds.protocol.proto.HddsProtos$PipelineID,org.apache.hadoop.hdds.protocol.proto.HddsProtos$PipelineState) throws java.io.IOException on target org.apache.hadoop.hdds.scm.ha.SCMRatisServerImpl@183f041f, cost 33409.918us
2021-10-05 13:26:01,276 [EventQueue-OpenPipelineForHealthyPipelineSafeModeRule] INFO  safemode.SCMSafeModeManager (HealthyPipelineSafeModeRule.java:process(124)) - SCM in safe mode. Healthy pipelines reported count is 1, required healthy pipeline reported count is 1
2021-10-05 13:26:01,276 [EventQueue-OpenPipelineForHealthyPipelineSafeModeRule] INFO  safemode.SCMSafeModeManager (SCMSafeModeManager.java:validateSafeModeExitRules(204)) - HealthyPipelineSafeModeRule rule is successfully validated
2021-10-05 13:26:01,276 [EventQueue-OpenPipelineForHealthyPipelineSafeModeRule] INFO  safemode.SCMSafeModeManager (SCMSafeModeManager.java:validateSafeModeExitRules(219)) - ScmSafeModeManager, all rules are successfully validated
2021-10-05 13:26:01,276 [EventQueue-OpenPipelineForHealthyPipelineSafeModeRule] INFO  safemode.SCMSafeModeManager (SCMSafeModeManager.java:exitSafeMode(248)) - SCM exiting safe mode.
2021-10-05 13:26:01,276 [EventQueue-OpenPipelineForHealthyPipelineSafeModeRule] WARN  events.EventQueue (EventQueue.java:fireEvent(194)) - No event handler registered for event TypedEvent{payloadType=SafeModeStatus, name='Safe mode status'}
2021-10-05 13:26:01,276 [EventQueue-OpenPipelineForHealthyPipelineSafeModeRule] INFO  ha.SCMContext (SCMContext.java:updateSafeModeStatus(205)) - Update SafeModeStatus from SafeModeStatus{safeModeStatus=true, preCheckPassed=true} to SafeModeStatus{safeModeStatus=false, preCheckPassed=true}.
2021-10-05 13:26:01,276 [EventQueue-OpenPipelineForHealthyPipelineSafeModeRule] INFO  container.ReplicationManager (ReplicationManager.java:notifyStatusChanged(1743)) - Service ReplicationManager transitions to RUNNING.
2021-10-05 13:26:01,285 [c2216084-e141-4b27-afe8-b6c5968528ec@group-E674C48A3917-LeaderElection32] INFO  server.RaftServer$Division (ServerState.java:setRaftConf(387)) - c2216084-e141-4b27-afe8-b6c5968528ec@group-E674C48A3917: set configuration 0: [2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc|rpc:127.0.0.1:45481|dataStream:|priority:0, c2216084-e141-4b27-afe8-b6c5968528ec|rpc:127.0.0.1:39195|dataStream:|priority:1, 106bb174-548c-482f-98a0-a37141c57762|rpc:127.0.0.1:43635|dataStream:|priority:0], old=null
2021-10-05 13:26:01,286 [2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc@group-C784995F1F78-FollowerState] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.leaderelection.pre-vote = false (custom)
2021-10-05 13:26:01,286 [2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc@group-C784995F1F78-FollowerState] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(130)) - 2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc: start 2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc@group-C784995F1F78-LeaderElection34
2021-10-05 13:26:01,287 [b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-StateMachineUpdater] INFO  safemode.HealthyPipelineSafeModeRule (HealthyPipelineSafeModeRule.java:initializeRule(152)) - Refreshed total pipeline count is 1, healthy pipeline threshold count is 1
2021-10-05 13:26:01,300 [grpc-default-executor-2] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(285)) - 2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc@group-E674C48A3917: changes role from CANDIDATE to FOLLOWER at term 1 for appendEntries
2021-10-05 13:26:01,300 [grpc-default-executor-2] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(121)) - 2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc: shutdown 2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc@group-E674C48A3917-LeaderElection33
2021-10-05 13:26:01,300 [grpc-default-executor-2] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(130)) - 2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc: start 2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc@group-E674C48A3917-FollowerState
2021-10-05 13:26:01,307 [grpc-default-executor-3] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1043)) - 106bb174-548c-482f-98a0-a37141c57762@group-E674C48A3917: receive requestVote(ELECTION, 2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc, group-E674C48A3917, 1, (t:0, i:0))
2021-10-05 13:26:01,308 [106bb174-548c-482f-98a0-a37141c57762@group-5EA95D3F2CF7-FollowerState] INFO  impl.FollowerState (FollowerState.java:run(134)) - 106bb174-548c-482f-98a0-a37141c57762@group-5EA95D3F2CF7-FollowerState: change to CANDIDATE, lastRpcElapsedTime:5023869317ns, electionTimeout:5021ms
2021-10-05 13:26:01,308 [106bb174-548c-482f-98a0-a37141c57762@group-5EA95D3F2CF7-FollowerState] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(108)) - 106bb174-548c-482f-98a0-a37141c57762: shutdown 106bb174-548c-482f-98a0-a37141c57762@group-5EA95D3F2CF7-FollowerState
2021-10-05 13:26:01,308 [106bb174-548c-482f-98a0-a37141c57762@group-5EA95D3F2CF7-FollowerState] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(285)) - 106bb174-548c-482f-98a0-a37141c57762@group-5EA95D3F2CF7: changes role from  FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2021-10-05 13:26:01,313 [106bb174-548c-482f-98a0-a37141c57762@group-C784995F1F78-FollowerState] INFO  impl.FollowerState (FollowerState.java:run(134)) - 106bb174-548c-482f-98a0-a37141c57762@group-C784995F1F78-FollowerState: change to CANDIDATE, lastRpcElapsedTime:5091020898ns, electionTimeout:5077ms
2021-10-05 13:26:01,313 [106bb174-548c-482f-98a0-a37141c57762@group-C784995F1F78-FollowerState] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(108)) - 106bb174-548c-482f-98a0-a37141c57762: shutdown 106bb174-548c-482f-98a0-a37141c57762@group-C784995F1F78-FollowerState
2021-10-05 13:26:01,313 [106bb174-548c-482f-98a0-a37141c57762@group-C784995F1F78-FollowerState] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(285)) - 106bb174-548c-482f-98a0-a37141c57762@group-C784995F1F78: changes role from  FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2021-10-05 13:26:01,340 [grpc-default-executor-2] INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:handleLeaderChangedNotification(861)) - Leader change notification received for group: group-E674C48A3917 with new leaderId: c2216084-e141-4b27-afe8-b6c5968528ec
2021-10-05 13:26:01,340 [grpc-default-executor-2] INFO  server.RaftServer$Division (ServerState.java:setLeader(285)) - 2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc@group-E674C48A3917: change Leader from null to c2216084-e141-4b27-afe8-b6c5968528ec at term 1 for appendEntries, leader elected after 5376ms
2021-10-05 13:26:01,345 [grpc-default-executor-3] INFO  impl.VoteContext (VoteContext.java:log(48)) - 106bb174-548c-482f-98a0-a37141c57762@group-E674C48A3917-FOLLOWER: reject ELECTION from 2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc: already has voted for c2216084-e141-4b27-afe8-b6c5968528ec at current term 1
2021-10-05 13:26:01,345 [grpc-default-executor-3] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1075)) - 106bb174-548c-482f-98a0-a37141c57762@group-E674C48A3917 replies to ELECTION vote request: 2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc<-106bb174-548c-482f-98a0-a37141c57762#0:FAIL-t1. Peer's state: 106bb174-548c-482f-98a0-a37141c57762@group-E674C48A3917:t1, leader=null, voted=c2216084-e141-4b27-afe8-b6c5968528ec, raftlog=106bb174-548c-482f-98a0-a37141c57762@group-E674C48A3917-SegmentedRaftLog:OPENED:c-1,f-1,i0, conf=-1: [2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc|rpc:127.0.0.1:45481|dataStream:|priority:0, c2216084-e141-4b27-afe8-b6c5968528ec|rpc:127.0.0.1:39195|dataStream:|priority:1, 106bb174-548c-482f-98a0-a37141c57762|rpc:127.0.0.1:43635|dataStream:|priority:0], old=null
2021-10-05 13:26:01,346 [2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc@group-C784995F1F78-LeaderElection34] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(306)) - 2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc@group-C784995F1F78-LeaderElection34 ELECTION round 0: submit vote requests at term 1 for -1: [2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc|rpc:127.0.0.1:45481|priority:0, c2216084-e141-4b27-afe8-b6c5968528ec|rpc:127.0.0.1:39195|priority:0, 106bb174-548c-482f-98a0-a37141c57762|rpc:127.0.0.1:43635|priority:1], old=null
2021-10-05 13:26:01,347 [grpc-default-executor-2] INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:handleLeaderChangedNotification(861)) - Leader change notification received for group: group-E674C48A3917 with new leaderId: c2216084-e141-4b27-afe8-b6c5968528ec
2021-10-05 13:26:01,347 [grpc-default-executor-2] INFO  server.RaftServer$Division (ServerState.java:setLeader(285)) - 106bb174-548c-482f-98a0-a37141c57762@group-E674C48A3917: change Leader from null to c2216084-e141-4b27-afe8-b6c5968528ec at term 1 for appendEntries, leader elected after 5217ms
2021-10-05 13:26:01,366 [106bb174-548c-482f-98a0-a37141c57762@group-5EA95D3F2CF7-FollowerState] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.leaderelection.pre-vote = false (custom)
2021-10-05 13:26:01,366 [106bb174-548c-482f-98a0-a37141c57762@group-5EA95D3F2CF7-FollowerState] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(130)) - 106bb174-548c-482f-98a0-a37141c57762: start 106bb174-548c-482f-98a0-a37141c57762@group-5EA95D3F2CF7-LeaderElection35
2021-10-05 13:26:01,367 [106bb174-548c-482f-98a0-a37141c57762@group-C784995F1F78-FollowerState] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.leaderelection.pre-vote = false (custom)
2021-10-05 13:26:01,367 [grpc-default-executor-0] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1043)) - 106bb174-548c-482f-98a0-a37141c57762@group-C784995F1F78: receive requestVote(ELECTION, 2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc, group-C784995F1F78, 1, (t:0, i:0))
2021-10-05 13:26:01,367 [106bb174-548c-482f-98a0-a37141c57762@group-C784995F1F78-FollowerState] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(130)) - 106bb174-548c-482f-98a0-a37141c57762: start 106bb174-548c-482f-98a0-a37141c57762@group-C784995F1F78-LeaderElection36
2021-10-05 13:26:01,367 [grpc-default-executor-3] INFO  server.RaftServer$Division (ServerState.java:setRaftConf(387)) - 2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc@group-E674C48A3917: set configuration 0: [2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc|rpc:127.0.0.1:45481|dataStream:|priority:0, c2216084-e141-4b27-afe8-b6c5968528ec|rpc:127.0.0.1:39195|dataStream:|priority:1, 106bb174-548c-482f-98a0-a37141c57762|rpc:127.0.0.1:43635|dataStream:|priority:0], old=null
2021-10-05 13:26:01,367 [grpc-default-executor-3] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:startLogSegment(394)) - 2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc@group-E674C48A3917-SegmentedRaftLogWorker: Starting segment from index:0
2021-10-05 13:26:01,392 [grpc-default-executor-0] INFO  impl.VoteContext (VoteContext.java:log(48)) - 106bb174-548c-482f-98a0-a37141c57762@group-C784995F1F78-CANDIDATE: reject ELECTION from 2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc: our priority 1 > candidate's priority 0
2021-10-05 13:26:01,392 [grpc-default-executor-0] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(285)) - 106bb174-548c-482f-98a0-a37141c57762@group-C784995F1F78: changes role from CANDIDATE to FOLLOWER at term 1 for candidate:2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc
2021-10-05 13:26:01,392 [grpc-default-executor-0] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(121)) - 106bb174-548c-482f-98a0-a37141c57762: shutdown 106bb174-548c-482f-98a0-a37141c57762@group-C784995F1F78-LeaderElection36
2021-10-05 13:26:01,392 [grpc-default-executor-0] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(130)) - 106bb174-548c-482f-98a0-a37141c57762: start 106bb174-548c-482f-98a0-a37141c57762@group-C784995F1F78-FollowerState
2021-10-05 13:26:01,392 [2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc@group-E674C48A3917-LeaderElection33] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(89)) - 2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc@group-E674C48A3917-LeaderElection33: ELECTION REJECTED received 1 response(s) and 0 exception(s):
2021-10-05 13:26:01,393 [2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc@group-E674C48A3917-LeaderElection33] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(93)) -   Response 0: 2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc<-106bb174-548c-482f-98a0-a37141c57762#0:FAIL-t1
2021-10-05 13:26:01,393 [106bb174-548c-482f-98a0-a37141c57762@group-C784995F1F78-LeaderElection36] INFO  impl.LeaderElection (LeaderElection.java:run(230)) - 106bb174-548c-482f-98a0-a37141c57762@group-C784995F1F78-LeaderElection36: skip running since this is already CLOSING
2021-10-05 13:26:01,395 [2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc@group-E674C48A3917-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(601)) - 2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc@group-E674C48A3917-SegmentedRaftLogWorker: created new log segment /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-62d231c0-d845-4dcd-88aa-c082e017c57e/datanode-0/data/ratis/70d43e9a-313f-4a40-8629-e674c48a3917/current/log_inprogress_0
2021-10-05 13:26:01,395 [grpc-default-executor-0] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1075)) - 106bb174-548c-482f-98a0-a37141c57762@group-C784995F1F78 replies to ELECTION vote request: 2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc<-106bb174-548c-482f-98a0-a37141c57762#0:FAIL-t1. Peer's state: 106bb174-548c-482f-98a0-a37141c57762@group-C784995F1F78:t1, leader=null, voted=null, raftlog=106bb174-548c-482f-98a0-a37141c57762@group-C784995F1F78-SegmentedRaftLog:OPENED:c-1,f-1,i0, conf=-1: [2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc|rpc:127.0.0.1:45481|dataStream:|priority:0, c2216084-e141-4b27-afe8-b6c5968528ec|rpc:127.0.0.1:39195|dataStream:|priority:0, 106bb174-548c-482f-98a0-a37141c57762|rpc:127.0.0.1:43635|dataStream:|priority:1], old=null
2021-10-05 13:26:01,396 [106bb174-548c-482f-98a0-a37141c57762@group-5EA95D3F2CF7-LeaderElection35] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(306)) - 106bb174-548c-482f-98a0-a37141c57762@group-5EA95D3F2CF7-LeaderElection35 ELECTION round 0: submit vote requests at term 1 for -1: [106bb174-548c-482f-98a0-a37141c57762|rpc:127.0.0.1:43635|priority:1], old=null
2021-10-05 13:26:01,396 [106bb174-548c-482f-98a0-a37141c57762@group-5EA95D3F2CF7-LeaderElection35] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(308)) - 106bb174-548c-482f-98a0-a37141c57762@group-5EA95D3F2CF7-LeaderElection35 ELECTION round 0: result PASSED (term=1)
2021-10-05 13:26:01,396 [106bb174-548c-482f-98a0-a37141c57762@group-5EA95D3F2CF7-LeaderElection35] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(121)) - 106bb174-548c-482f-98a0-a37141c57762: shutdown 106bb174-548c-482f-98a0-a37141c57762@group-5EA95D3F2CF7-LeaderElection35
2021-10-05 13:26:01,396 [106bb174-548c-482f-98a0-a37141c57762@group-5EA95D3F2CF7-LeaderElection35] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(285)) - 106bb174-548c-482f-98a0-a37141c57762@group-5EA95D3F2CF7: changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2021-10-05 13:26:01,396 [106bb174-548c-482f-98a0-a37141c57762@group-5EA95D3F2CF7-LeaderElection35] INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:handleLeaderChangedNotification(861)) - Leader change notification received for group: group-5EA95D3F2CF7 with new leaderId: 106bb174-548c-482f-98a0-a37141c57762
2021-10-05 13:26:01,397 [106bb174-548c-482f-98a0-a37141c57762@group-5EA95D3F2CF7-LeaderElection35] INFO  server.RaftServer$Division (ServerState.java:setLeader(285)) - 106bb174-548c-482f-98a0-a37141c57762@group-5EA95D3F2CF7: change Leader from null to 106bb174-548c-482f-98a0-a37141c57762 at term 1 for becomeLeader, leader elected after 5130ms
2021-10-05 13:26:01,397 [106bb174-548c-482f-98a0-a37141c57762@group-5EA95D3F2CF7-LeaderElection35] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.staging.catchup.gap = 1000 (default)
2021-10-05 13:26:01,399 [2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc@group-C784995F1F78-LeaderElection34] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(89)) - 2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc@group-C784995F1F78-LeaderElection34: ELECTION REJECTED received 1 response(s) and 0 exception(s):
2021-10-05 13:26:01,399 [2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc@group-C784995F1F78-LeaderElection34] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(93)) -   Response 0: 2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc<-106bb174-548c-482f-98a0-a37141c57762#0:FAIL-t1
2021-10-05 13:26:01,401 [EventQueue-OpenPipelineForHealthyPipelineSafeModeRule] INFO  safemode.SCMSafeModeManager (HealthyPipelineSafeModeRule.java:process(124)) - SCM in safe mode. Healthy pipelines reported count is 1, required healthy pipeline reported count is 1
2021-10-05 13:26:01,401 [EventQueue-OpenPipelineForHealthyPipelineSafeModeRule] INFO  safemode.SCMSafeModeManager (SCMSafeModeManager.java:validateSafeModeExitRules(204)) - HealthyPipelineSafeModeRule rule is successfully validated
2021-10-05 13:26:01,401 [EventQueue-OpenPipelineForHealthyPipelineSafeModeRule] INFO  safemode.SCMSafeModeManager (SCMSafeModeManager.java:validateSafeModeExitRules(219)) - ScmSafeModeManager, all rules are successfully validated
2021-10-05 13:26:01,401 [EventQueue-OpenPipelineForHealthyPipelineSafeModeRule] INFO  safemode.SCMSafeModeManager (SCMSafeModeManager.java:exitSafeMode(248)) - SCM exiting safe mode.
2021-10-05 13:26:01,401 [EventQueue-OpenPipelineForHealthyPipelineSafeModeRule] WARN  events.EventQueue (EventQueue.java:fireEvent(194)) - No event handler registered for event TypedEvent{payloadType=SafeModeStatus, name='Safe mode status'}
2021-10-05 13:26:01,401 [EventQueue-OpenPipelineForHealthyPipelineSafeModeRule] INFO  ha.SCMContext (SCMContext.java:updateSafeModeStatus(205)) - Update SafeModeStatus from SafeModeStatus{safeModeStatus=true, preCheckPassed=true} to SafeModeStatus{safeModeStatus=false, preCheckPassed=true}.
2021-10-05 13:26:01,406 [2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc@group-C784995F1F78-LeaderElection34] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(308)) - 2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc@group-C784995F1F78-LeaderElection34 ELECTION round 0: result REJECTED
2021-10-05 13:26:01,406 [2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc@group-C784995F1F78-LeaderElection34] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(285)) - 2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc@group-C784995F1F78: changes role from CANDIDATE to FOLLOWER at term 1 for REJECTED
2021-10-05 13:26:01,406 [2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc@group-C784995F1F78-LeaderElection34] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(121)) - 2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc: shutdown 2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc@group-C784995F1F78-LeaderElection34
2021-10-05 13:26:01,407 [grpc-default-executor-0] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1043)) - c2216084-e141-4b27-afe8-b6c5968528ec@group-C784995F1F78: receive requestVote(ELECTION, 2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc, group-C784995F1F78, 1, (t:0, i:0))
2021-10-05 13:26:01,407 [grpc-default-executor-0] INFO  impl.VoteContext (VoteContext.java:log(48)) - c2216084-e141-4b27-afe8-b6c5968528ec@group-C784995F1F78-FOLLOWER: accept ELECTION from 2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc: our priority 0 <= candidate's priority 0
2021-10-05 13:26:01,407 [grpc-default-executor-0] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(285)) - c2216084-e141-4b27-afe8-b6c5968528ec@group-C784995F1F78: changes role from  FOLLOWER to FOLLOWER at term 1 for candidate:2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc
2021-10-05 13:26:01,407 [grpc-default-executor-0] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(108)) - c2216084-e141-4b27-afe8-b6c5968528ec: shutdown c2216084-e141-4b27-afe8-b6c5968528ec@group-C784995F1F78-FollowerState
2021-10-05 13:26:01,407 [grpc-default-executor-0] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(130)) - c2216084-e141-4b27-afe8-b6c5968528ec: start c2216084-e141-4b27-afe8-b6c5968528ec@group-C784995F1F78-FollowerState
2021-10-05 13:26:01,408 [c2216084-e141-4b27-afe8-b6c5968528ec@group-C784995F1F78-FollowerState] INFO  impl.FollowerState (FollowerState.java:run(143)) - c2216084-e141-4b27-afe8-b6c5968528ec@group-C784995F1F78-FollowerState was interrupted: {}
java.lang.InterruptedException: sleep interrupted
	at java.lang.Thread.sleep(Native Method)
	at java.lang.Thread.sleep(Thread.java:340)
	at java.util.concurrent.TimeUnit.sleep(TimeUnit.java:386)
	at org.apache.ratis.util.TimeDuration.sleep(TimeDuration.java:324)
	at org.apache.ratis.util.TimeDuration.sleep(TimeDuration.java:309)
	at org.apache.ratis.server.impl.FollowerState.run(FollowerState.java:118)
2021-10-05 13:26:01,408 [grpc-default-executor-4] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1043)) - c2216084-e141-4b27-afe8-b6c5968528ec@group-E674C48A3917: receive requestVote(ELECTION, 2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc, group-E674C48A3917, 1, (t:0, i:0))
2021-10-05 13:26:01,409 [grpc-default-executor-4] INFO  impl.VoteContext (VoteContext.java:log(48)) - c2216084-e141-4b27-afe8-b6c5968528ec@group-E674C48A3917-LEADER: reject ELECTION from 2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc: already has voted for c2216084-e141-4b27-afe8-b6c5968528ec at current term 1
2021-10-05 13:26:01,409 [grpc-default-executor-4] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1075)) - c2216084-e141-4b27-afe8-b6c5968528ec@group-E674C48A3917 replies to ELECTION vote request: 2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc<-c2216084-e141-4b27-afe8-b6c5968528ec#0:FAIL-t1. Peer's state: c2216084-e141-4b27-afe8-b6c5968528ec@group-E674C48A3917:t1, leader=c2216084-e141-4b27-afe8-b6c5968528ec, voted=c2216084-e141-4b27-afe8-b6c5968528ec, raftlog=c2216084-e141-4b27-afe8-b6c5968528ec@group-E674C48A3917-SegmentedRaftLog:OPENED:c0,f0,i0, conf=0: [2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc|rpc:127.0.0.1:45481|dataStream:|priority:0, c2216084-e141-4b27-afe8-b6c5968528ec|rpc:127.0.0.1:39195|dataStream:|priority:1, 106bb174-548c-482f-98a0-a37141c57762|rpc:127.0.0.1:43635|dataStream:|priority:0], old=null
2021-10-05 13:26:01,415 [106bb174-548c-482f-98a0-a37141c57762@group-5EA95D3F2CF7-LeaderElection35] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.write.element-limit = 1024 (custom)
2021-10-05 13:26:01,415 [106bb174-548c-482f-98a0-a37141c57762@group-5EA95D3F2CF7-LeaderElection35] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.write.byte-limit = 1024 M (=1073741824) (custom)
2021-10-05 13:26:01,415 [106bb174-548c-482f-98a0-a37141c57762@group-5EA95D3F2CF7-LeaderElection35] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.watch.timeout = 180s (custom)
2021-10-05 13:26:01,417 [106bb174-548c-482f-98a0-a37141c57762@group-5EA95D3F2CF7-LeaderElection35] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.watch.timeout.denomination = 1s (default)
2021-10-05 13:26:01,417 [106bb174-548c-482f-98a0-a37141c57762@group-5EA95D3F2CF7-LeaderElection35] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.watch.element-limit = 65536 (default)
2021-10-05 13:26:01,417 [106bb174-548c-482f-98a0-a37141c57762@group-5EA95D3F2CF7-LeaderElection35] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(130)) - 106bb174-548c-482f-98a0-a37141c57762: start 106bb174-548c-482f-98a0-a37141c57762@group-5EA95D3F2CF7-LeaderStateImpl
2021-10-05 13:26:01,417 [grpc-default-executor-2] INFO  server.RaftServer$Division (ServerState.java:setRaftConf(387)) - 106bb174-548c-482f-98a0-a37141c57762@group-E674C48A3917: set configuration 0: [2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc|rpc:127.0.0.1:45481|dataStream:|priority:0, c2216084-e141-4b27-afe8-b6c5968528ec|rpc:127.0.0.1:39195|dataStream:|priority:1, 106bb174-548c-482f-98a0-a37141c57762|rpc:127.0.0.1:43635|dataStream:|priority:0], old=null
2021-10-05 13:26:01,417 [grpc-default-executor-0] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1075)) - c2216084-e141-4b27-afe8-b6c5968528ec@group-C784995F1F78 replies to ELECTION vote request: 2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc<-c2216084-e141-4b27-afe8-b6c5968528ec#0:OK-t1. Peer's state: c2216084-e141-4b27-afe8-b6c5968528ec@group-C784995F1F78:t1, leader=null, voted=2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc, raftlog=c2216084-e141-4b27-afe8-b6c5968528ec@group-C784995F1F78-SegmentedRaftLog:OPENED:c-1,f-1,i0, conf=-1: [2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc|rpc:127.0.0.1:45481|dataStream:|priority:0, c2216084-e141-4b27-afe8-b6c5968528ec|rpc:127.0.0.1:39195|dataStream:|priority:0, 106bb174-548c-482f-98a0-a37141c57762|rpc:127.0.0.1:43635|dataStream:|priority:1], old=null
2021-10-05 13:26:01,416 [2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc@group-E674C48A3917-LeaderElection33] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(308)) - 2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc@group-E674C48A3917-LeaderElection33 ELECTION round 0: result REJECTED
2021-10-05 13:26:01,427 [2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc@group-C784995F1F78-LeaderElection34] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(130)) - 2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc: start 2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc@group-C784995F1F78-FollowerState
2021-10-05 13:26:01,434 [106bb174-548c-482f-98a0-a37141c57762@group-5EA95D3F2CF7-LeaderElection35] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:startLogSegment(394)) - 106bb174-548c-482f-98a0-a37141c57762@group-5EA95D3F2CF7-SegmentedRaftLogWorker: Starting segment from index:0
2021-10-05 13:26:01,434 [grpc-default-executor-2] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:startLogSegment(394)) - 106bb174-548c-482f-98a0-a37141c57762@group-E674C48A3917-SegmentedRaftLogWorker: Starting segment from index:0
2021-10-05 13:26:01,440 [106bb174-548c-482f-98a0-a37141c57762@group-5EA95D3F2CF7-LeaderElection35] INFO  server.RaftServer$Division (ServerState.java:setRaftConf(387)) - 106bb174-548c-482f-98a0-a37141c57762@group-5EA95D3F2CF7: set configuration 0: [106bb174-548c-482f-98a0-a37141c57762|rpc:127.0.0.1:43635|dataStream:|priority:1], old=null
2021-10-05 13:26:01,441 [106bb174-548c-482f-98a0-a37141c57762@group-5EA95D3F2CF7-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(601)) - 106bb174-548c-482f-98a0-a37141c57762@group-5EA95D3F2CF7-SegmentedRaftLogWorker: created new log segment /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-62d231c0-d845-4dcd-88aa-c082e017c57e/datanode-1/data/ratis/b3ab901a-6bcc-4c8d-8b24-5ea95d3f2cf7/current/log_inprogress_0
2021-10-05 13:26:01,445 [106bb174-548c-482f-98a0-a37141c57762@group-E674C48A3917-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(601)) - 106bb174-548c-482f-98a0-a37141c57762@group-E674C48A3917-SegmentedRaftLogWorker: created new log segment /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-62d231c0-d845-4dcd-88aa-c082e017c57e/datanode-1/data/ratis/70d43e9a-313f-4a40-8629-e674c48a3917/current/log_inprogress_0
2021-10-05 13:26:01,568 [Listener at 127.0.0.1/10516] INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(235)) - Nodes are ready. Got 3 of 3 DN Heartbeats.
2021-10-05 13:26:01,569 [Listener at 127.0.0.1/10516] INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(238)) - Cluster exits safe mode
2021-10-05 13:26:01,569 [Listener at 127.0.0.1/10516] INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(240)) - SCM became leader
2021-10-05 13:26:01,581 [61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-StateMachineUpdater] INFO  ha.SCMStateMachine (SCMStateMachine.java:takeSnapshot(290)) - Current Snapshot Index 25, takeSnapshot took 0 ms
2021-10-05 13:26:01,582 [61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:takeSnapshot(281)) - 61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-StateMachineUpdater: Took a snapshot at index 25
2021-10-05 13:26:01,582 [61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:lambda$new$0(89)) - 61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-StateMachineUpdater: snapshotIndex: updateIncreasingly 20 -> 25
2021-10-05 13:26:01,582 [61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:purge(306)) - 61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-SegmentedRaftLog: purge 25
2021-10-05 13:26:01,582 [61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - 61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-SegmentedRaftLog: snapshotIndex: updateIncreasingly 20 -> 25
2021-10-05 13:26:01,582 [61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - 61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-SegmentedRaftLog: purgeIndex: updateToMax old=20, new=25, updated? true
2021-10-05 13:26:01,582 [Listener at 127.0.0.1/10516] INFO  ha.SCMHAInvocationHandler (SCMHAInvocationHandler.java:invokeRatis(113)) - Invoking method public abstract java.lang.Boolean org.apache.hadoop.hdds.scm.ha.SequenceIdGenerator$StateManager.allocateBatch(java.lang.String,java.lang.Long,java.lang.Long) on target org.apache.hadoop.hdds.scm.ha.SCMRatisServerImpl@183f041f, cost 12510.005us
2021-10-05 13:26:01,582 [Listener at 127.0.0.1/10516] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:getNextId(127)) - Allocate a batch for containerId, change lastId from 0 to 1000.
2021-10-05 13:26:01,593 [b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-StateMachineUpdater] INFO  ha.SCMStateMachine (SCMStateMachine.java:takeSnapshot(290)) - Current Snapshot Index 25, takeSnapshot took 0 ms
2021-10-05 13:26:01,593 [b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:takeSnapshot(281)) - b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-StateMachineUpdater: Took a snapshot at index 25
2021-10-05 13:26:01,593 [b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:lambda$new$0(89)) - b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-StateMachineUpdater: snapshotIndex: updateIncreasingly 20 -> 25
2021-10-05 13:26:01,593 [b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:purge(306)) - b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-SegmentedRaftLog: purge 25
2021-10-05 13:26:01,593 [b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-SegmentedRaftLog: snapshotIndex: updateIncreasingly 20 -> 25
2021-10-05 13:26:01,593 [b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-SegmentedRaftLog: purgeIndex: updateToMax old=20, new=25, updated? true
2021-10-05 13:26:01,594 [Listener at 127.0.0.1/10516] INFO  ha.SCMHAInvocationHandler (SCMHAInvocationHandler.java:invokeRatis(113)) - Invoking method public abstract void org.apache.hadoop.hdds.scm.container.ContainerStateManagerV2.addContainer(org.apache.hadoop.hdds.protocol.proto.HddsProtos$ContainerInfoProto) throws java.io.IOException on target org.apache.hadoop.hdds.scm.ha.SCMRatisServerImpl@183f041f, cost 12254.881us
2021-10-05 13:26:01,702 [Listener at 127.0.0.1/10516] INFO  ha.SCMHAInvocationHandler (SCMHAInvocationHandler.java:invokeRatis(113)) - Invoking method public abstract void org.apache.hadoop.hdds.scm.container.ContainerStateManagerV2.addContainer(org.apache.hadoop.hdds.protocol.proto.HddsProtos$ContainerInfoProto) throws java.io.IOException on target org.apache.hadoop.hdds.scm.ha.SCMRatisServerImpl@183f041f, cost 7289.802us
2021-10-05 13:26:01,709 [61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-StateMachineUpdater] INFO  ha.SCMStateMachine (SCMStateMachine.java:takeSnapshot(290)) - Current Snapshot Index 30, takeSnapshot took 0 ms
2021-10-05 13:26:01,709 [61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:takeSnapshot(281)) - 61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-StateMachineUpdater: Took a snapshot at index 30
2021-10-05 13:26:01,709 [61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:lambda$new$0(89)) - 61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-StateMachineUpdater: snapshotIndex: updateIncreasingly 25 -> 30
2021-10-05 13:26:01,709 [61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:purge(306)) - 61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-SegmentedRaftLog: purge 30
2021-10-05 13:26:01,709 [61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - 61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-SegmentedRaftLog: snapshotIndex: updateIncreasingly 25 -> 30
2021-10-05 13:26:01,709 [61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - 61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-SegmentedRaftLog: purgeIndex: updateToMax old=25, new=30, updated? true
2021-10-05 13:26:01,786 [EndpointStateMachine task thread for /127.0.0.1:15041 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15041. Already tried 8 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:26:01,807 [b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-StateMachineUpdater] INFO  ha.SCMStateMachine (SCMStateMachine.java:takeSnapshot(290)) - Current Snapshot Index 30, takeSnapshot took 0 ms
2021-10-05 13:26:01,807 [b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:takeSnapshot(281)) - b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-StateMachineUpdater: Took a snapshot at index 30
2021-10-05 13:26:01,807 [b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:lambda$new$0(89)) - b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-StateMachineUpdater: snapshotIndex: updateIncreasingly 25 -> 30
2021-10-05 13:26:01,807 [b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:purge(306)) - b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-SegmentedRaftLog: purge 30
2021-10-05 13:26:01,807 [b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-SegmentedRaftLog: snapshotIndex: updateIncreasingly 25 -> 30
2021-10-05 13:26:01,808 [b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-SegmentedRaftLog: purgeIndex: updateToMax old=25, new=30, updated? true
2021-10-05 13:26:01,812 [Listener at 127.0.0.1/10516] INFO  ha.SCMHAInvocationHandler (SCMHAInvocationHandler.java:invokeRatis(113)) - Invoking method public abstract void org.apache.hadoop.hdds.scm.container.ContainerStateManagerV2.addContainer(org.apache.hadoop.hdds.protocol.proto.HddsProtos$ContainerInfoProto) throws java.io.IOException on target org.apache.hadoop.hdds.scm.ha.SCMRatisServerImpl@183f041f, cost 9456.711us
2021-10-05 13:26:01,824 [c2216084-e141-4b27-afe8-b6c5968528ec@group-A4888BD7295A-FollowerState] INFO  impl.FollowerState (FollowerState.java:run(134)) - c2216084-e141-4b27-afe8-b6c5968528ec@group-A4888BD7295A-FollowerState: change to CANDIDATE, lastRpcElapsedTime:5161965046ns, electionTimeout:5147ms
2021-10-05 13:26:01,824 [c2216084-e141-4b27-afe8-b6c5968528ec@group-A4888BD7295A-FollowerState] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(108)) - c2216084-e141-4b27-afe8-b6c5968528ec: shutdown c2216084-e141-4b27-afe8-b6c5968528ec@group-A4888BD7295A-FollowerState
2021-10-05 13:26:01,824 [c2216084-e141-4b27-afe8-b6c5968528ec@group-A4888BD7295A-FollowerState] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(285)) - c2216084-e141-4b27-afe8-b6c5968528ec@group-A4888BD7295A: changes role from  FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2021-10-05 13:26:01,824 [c2216084-e141-4b27-afe8-b6c5968528ec@group-A4888BD7295A-FollowerState] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.leaderelection.pre-vote = false (custom)
2021-10-05 13:26:01,824 [c2216084-e141-4b27-afe8-b6c5968528ec@group-A4888BD7295A-FollowerState] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(130)) - c2216084-e141-4b27-afe8-b6c5968528ec: start c2216084-e141-4b27-afe8-b6c5968528ec@group-A4888BD7295A-LeaderElection37
2021-10-05 13:26:01,842 [c2216084-e141-4b27-afe8-b6c5968528ec@group-A4888BD7295A-LeaderElection37] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(306)) - c2216084-e141-4b27-afe8-b6c5968528ec@group-A4888BD7295A-LeaderElection37 ELECTION round 0: submit vote requests at term 1 for -1: [c2216084-e141-4b27-afe8-b6c5968528ec|rpc:127.0.0.1:39195|priority:1], old=null
2021-10-05 13:26:01,842 [c2216084-e141-4b27-afe8-b6c5968528ec@group-A4888BD7295A-LeaderElection37] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(308)) - c2216084-e141-4b27-afe8-b6c5968528ec@group-A4888BD7295A-LeaderElection37 ELECTION round 0: result PASSED (term=1)
2021-10-05 13:26:01,842 [c2216084-e141-4b27-afe8-b6c5968528ec@group-A4888BD7295A-LeaderElection37] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(121)) - c2216084-e141-4b27-afe8-b6c5968528ec: shutdown c2216084-e141-4b27-afe8-b6c5968528ec@group-A4888BD7295A-LeaderElection37
2021-10-05 13:26:01,842 [c2216084-e141-4b27-afe8-b6c5968528ec@group-A4888BD7295A-LeaderElection37] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(285)) - c2216084-e141-4b27-afe8-b6c5968528ec@group-A4888BD7295A: changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2021-10-05 13:26:01,843 [c2216084-e141-4b27-afe8-b6c5968528ec@group-A4888BD7295A-LeaderElection37] INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:handleLeaderChangedNotification(861)) - Leader change notification received for group: group-A4888BD7295A with new leaderId: c2216084-e141-4b27-afe8-b6c5968528ec
2021-10-05 13:26:01,844 [c2216084-e141-4b27-afe8-b6c5968528ec@group-A4888BD7295A-LeaderElection37] INFO  server.RaftServer$Division (ServerState.java:setLeader(285)) - c2216084-e141-4b27-afe8-b6c5968528ec@group-A4888BD7295A: change Leader from null to c2216084-e141-4b27-afe8-b6c5968528ec at term 1 for becomeLeader, leader elected after 5203ms
2021-10-05 13:26:01,844 [c2216084-e141-4b27-afe8-b6c5968528ec@group-A4888BD7295A-LeaderElection37] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.staging.catchup.gap = 1000 (default)
2021-10-05 13:26:01,844 [c2216084-e141-4b27-afe8-b6c5968528ec@group-A4888BD7295A-LeaderElection37] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.write.element-limit = 1024 (custom)
2021-10-05 13:26:01,846 [c2216084-e141-4b27-afe8-b6c5968528ec@group-A4888BD7295A-LeaderElection37] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.write.byte-limit = 1024 M (=1073741824) (custom)
2021-10-05 13:26:01,847 [c2216084-e141-4b27-afe8-b6c5968528ec@group-A4888BD7295A-LeaderElection37] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.watch.timeout = 180s (custom)
2021-10-05 13:26:01,847 [c2216084-e141-4b27-afe8-b6c5968528ec@group-A4888BD7295A-LeaderElection37] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.watch.timeout.denomination = 1s (default)
2021-10-05 13:26:01,847 [c2216084-e141-4b27-afe8-b6c5968528ec@group-A4888BD7295A-LeaderElection37] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.watch.element-limit = 65536 (default)
2021-10-05 13:26:01,847 [c2216084-e141-4b27-afe8-b6c5968528ec@group-A4888BD7295A-LeaderElection37] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(130)) - c2216084-e141-4b27-afe8-b6c5968528ec: start c2216084-e141-4b27-afe8-b6c5968528ec@group-A4888BD7295A-LeaderStateImpl
2021-10-05 13:26:01,848 [c2216084-e141-4b27-afe8-b6c5968528ec@group-A4888BD7295A-LeaderElection37] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:startLogSegment(394)) - c2216084-e141-4b27-afe8-b6c5968528ec@group-A4888BD7295A-SegmentedRaftLogWorker: Starting segment from index:0
2021-10-05 13:26:01,852 [c2216084-e141-4b27-afe8-b6c5968528ec@group-A4888BD7295A-LeaderElection37] INFO  server.RaftServer$Division (ServerState.java:setRaftConf(387)) - c2216084-e141-4b27-afe8-b6c5968528ec@group-A4888BD7295A: set configuration 0: [c2216084-e141-4b27-afe8-b6c5968528ec|rpc:127.0.0.1:39195|dataStream:|priority:1], old=null
2021-10-05 13:26:01,855 [c2216084-e141-4b27-afe8-b6c5968528ec@group-A4888BD7295A-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(601)) - c2216084-e141-4b27-afe8-b6c5968528ec@group-A4888BD7295A-SegmentedRaftLogWorker: created new log segment /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-62d231c0-d845-4dcd-88aa-c082e017c57e/datanode-2/data/ratis/cdefc21d-4d0e-403d-8056-a4888bd7295a/current/log_inprogress_0
2021-10-05 13:26:01,866 [EndpointStateMachine task thread for /127.0.0.1:13529 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:13529. Already tried 14 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:26:01,870 [EndpointStateMachine task thread for /127.0.0.1:13549 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:13549. Already tried 14 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:26:01,871 [EndpointStateMachine task thread for /127.0.0.1:15031 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15031. Already tried 12 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:26:01,872 [EndpointStateMachine task thread for /127.0.0.1:15021 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15021. Already tried 12 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:26:01,916 [Listener at 127.0.0.1/10516] INFO  ha.SCMHAInvocationHandler (SCMHAInvocationHandler.java:invokeRatis(113)) - Invoking method public abstract void org.apache.hadoop.hdds.scm.container.ContainerStateManagerV2.addContainer(org.apache.hadoop.hdds.protocol.proto.HddsProtos$ContainerInfoProto) throws java.io.IOException on target org.apache.hadoop.hdds.scm.ha.SCMRatisServerImpl@183f041f, cost 4138.099us
2021-10-05 13:26:01,964 [EndpointStateMachine task thread for /127.0.0.1:13539 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:13539. Already tried 13 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:26:02,023 [61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-StateMachineUpdater] INFO  ha.SCMStateMachine (SCMStateMachine.java:takeSnapshot(290)) - Current Snapshot Index 35, takeSnapshot took 0 ms
2021-10-05 13:26:02,023 [61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:takeSnapshot(281)) - 61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-StateMachineUpdater: Took a snapshot at index 35
2021-10-05 13:26:02,023 [61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:lambda$new$0(89)) - 61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-StateMachineUpdater: snapshotIndex: updateIncreasingly 30 -> 35
2021-10-05 13:26:02,023 [61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:purge(306)) - 61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-SegmentedRaftLog: purge 35
2021-10-05 13:26:02,023 [61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - 61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-SegmentedRaftLog: snapshotIndex: updateIncreasingly 30 -> 35
2021-10-05 13:26:02,023 [61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - 61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-SegmentedRaftLog: purgeIndex: updateToMax old=30, new=35, updated? true
2021-10-05 13:26:02,024 [Listener at 127.0.0.1/10516] INFO  ha.SCMHAInvocationHandler (SCMHAInvocationHandler.java:invokeRatis(113)) - Invoking method public abstract void org.apache.hadoop.hdds.scm.container.ContainerStateManagerV2.addContainer(org.apache.hadoop.hdds.protocol.proto.HddsProtos$ContainerInfoProto) throws java.io.IOException on target org.apache.hadoop.hdds.scm.ha.SCMRatisServerImpl@183f041f, cost 7288.302us
2021-10-05 13:26:02,032 [b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-StateMachineUpdater] INFO  ha.SCMStateMachine (SCMStateMachine.java:takeSnapshot(290)) - Current Snapshot Index 35, takeSnapshot took 1 ms
2021-10-05 13:26:02,032 [b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:takeSnapshot(281)) - b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-StateMachineUpdater: Took a snapshot at index 35
2021-10-05 13:26:02,032 [b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:lambda$new$0(89)) - b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-StateMachineUpdater: snapshotIndex: updateIncreasingly 30 -> 35
2021-10-05 13:26:02,032 [b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:purge(306)) - b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-SegmentedRaftLog: purge 35
2021-10-05 13:26:02,032 [b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-SegmentedRaftLog: snapshotIndex: updateIncreasingly 30 -> 35
2021-10-05 13:26:02,032 [b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-SegmentedRaftLog: purgeIndex: updateToMax old=30, new=35, updated? true
2021-10-05 13:26:02,136 [Listener at 127.0.0.1/10516] INFO  ha.SCMHAInvocationHandler (SCMHAInvocationHandler.java:invokeRatis(113)) - Invoking method public abstract void org.apache.hadoop.hdds.scm.container.ContainerStateManagerV2.addContainer(org.apache.hadoop.hdds.protocol.proto.HddsProtos$ContainerInfoProto) throws java.io.IOException on target org.apache.hadoop.hdds.scm.ha.SCMRatisServerImpl@183f041f, cost 11603.717us
2021-10-05 13:26:02,257 [Listener at 127.0.0.1/10516] INFO  ha.SCMHAInvocationHandler (SCMHAInvocationHandler.java:invokeRatis(113)) - Invoking method public abstract void org.apache.hadoop.hdds.scm.container.ContainerStateManagerV2.addContainer(org.apache.hadoop.hdds.protocol.proto.HddsProtos$ContainerInfoProto) throws java.io.IOException on target org.apache.hadoop.hdds.scm.ha.SCMRatisServerImpl@183f041f, cost 19989.125us
2021-10-05 13:26:02,276 [61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-StateMachineUpdater] INFO  ha.SCMStateMachine (SCMStateMachine.java:takeSnapshot(290)) - Current Snapshot Index 40, takeSnapshot took 0 ms
2021-10-05 13:26:02,276 [61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:takeSnapshot(281)) - 61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-StateMachineUpdater: Took a snapshot at index 40
2021-10-05 13:26:02,276 [61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:lambda$new$0(89)) - 61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-StateMachineUpdater: snapshotIndex: updateIncreasingly 35 -> 40
2021-10-05 13:26:02,276 [61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:purge(306)) - 61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-SegmentedRaftLog: purge 40
2021-10-05 13:26:02,276 [61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - 61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-SegmentedRaftLog: snapshotIndex: updateIncreasingly 35 -> 40
2021-10-05 13:26:02,276 [61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - 61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-SegmentedRaftLog: purgeIndex: updateToMax old=35, new=40, updated? true
2021-10-05 13:26:02,363 [b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-StateMachineUpdater] INFO  ha.SCMStateMachine (SCMStateMachine.java:takeSnapshot(290)) - Current Snapshot Index 40, takeSnapshot took 0 ms
2021-10-05 13:26:02,364 [b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:takeSnapshot(281)) - b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-StateMachineUpdater: Took a snapshot at index 40
2021-10-05 13:26:02,364 [b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:lambda$new$0(89)) - b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-StateMachineUpdater: snapshotIndex: updateIncreasingly 35 -> 40
2021-10-05 13:26:02,364 [b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:purge(306)) - b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-SegmentedRaftLog: purge 40
2021-10-05 13:26:02,364 [b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-SegmentedRaftLog: snapshotIndex: updateIncreasingly 35 -> 40
2021-10-05 13:26:02,364 [b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-SegmentedRaftLog: purgeIndex: updateToMax old=35, new=40, updated? true
2021-10-05 13:26:02,366 [Listener at 127.0.0.1/10516] INFO  ha.SCMHAInvocationHandler (SCMHAInvocationHandler.java:invokeRatis(113)) - Invoking method public abstract void org.apache.hadoop.hdds.scm.container.ContainerStateManagerV2.addContainer(org.apache.hadoop.hdds.protocol.proto.HddsProtos$ContainerInfoProto) throws java.io.IOException on target org.apache.hadoop.hdds.scm.ha.SCMRatisServerImpl@183f041f, cost 8436.313us
2021-10-05 13:26:02,475 [Listener at 127.0.0.1/10516] INFO  ha.SCMHAInvocationHandler (SCMHAInvocationHandler.java:invokeRatis(113)) - Invoking method public abstract void org.apache.hadoop.hdds.scm.container.ContainerStateManagerV2.addContainer(org.apache.hadoop.hdds.protocol.proto.HddsProtos$ContainerInfoProto) throws java.io.IOException on target org.apache.hadoop.hdds.scm.ha.SCMRatisServerImpl@183f041f, cost 8876.355us
2021-10-05 13:26:02,588 [61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-StateMachineUpdater] INFO  ha.SCMStateMachine (SCMStateMachine.java:takeSnapshot(290)) - Current Snapshot Index 45, takeSnapshot took 0 ms
2021-10-05 13:26:02,589 [61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:takeSnapshot(281)) - 61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-StateMachineUpdater: Took a snapshot at index 45
2021-10-05 13:26:02,589 [61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:lambda$new$0(89)) - 61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-StateMachineUpdater: snapshotIndex: updateIncreasingly 40 -> 45
2021-10-05 13:26:02,589 [61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:purge(306)) - 61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-SegmentedRaftLog: purge 45
2021-10-05 13:26:02,589 [61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - 61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-SegmentedRaftLog: snapshotIndex: updateIncreasingly 40 -> 45
2021-10-05 13:26:02,589 [61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - 61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-SegmentedRaftLog: purgeIndex: updateToMax old=40, new=45, updated? true
2021-10-05 13:26:02,589 [Listener at 127.0.0.1/10516] INFO  ha.SCMHAInvocationHandler (SCMHAInvocationHandler.java:invokeRatis(113)) - Invoking method public abstract void org.apache.hadoop.hdds.scm.container.ContainerStateManagerV2.addContainer(org.apache.hadoop.hdds.protocol.proto.HddsProtos$ContainerInfoProto) throws java.io.IOException on target org.apache.hadoop.hdds.scm.ha.SCMRatisServerImpl@183f041f, cost 13352.186us
2021-10-05 13:26:02,594 [b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-StateMachineUpdater] INFO  ha.SCMStateMachine (SCMStateMachine.java:takeSnapshot(290)) - Current Snapshot Index 45, takeSnapshot took 0 ms
2021-10-05 13:26:02,594 [b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:takeSnapshot(281)) - b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-StateMachineUpdater: Took a snapshot at index 45
2021-10-05 13:26:02,594 [b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:lambda$new$0(89)) - b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-StateMachineUpdater: snapshotIndex: updateIncreasingly 40 -> 45
2021-10-05 13:26:02,594 [b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:purge(306)) - b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-SegmentedRaftLog: purge 45
2021-10-05 13:26:02,595 [b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-SegmentedRaftLog: snapshotIndex: updateIncreasingly 40 -> 45
2021-10-05 13:26:02,595 [b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-SegmentedRaftLog: purgeIndex: updateToMax old=40, new=45, updated? true
2021-10-05 13:26:02,705 [Listener at 127.0.0.1/10516] INFO  ha.SCMHAInvocationHandler (SCMHAInvocationHandler.java:invokeRatis(113)) - Invoking method public abstract void org.apache.hadoop.hdds.scm.container.ContainerStateManagerV2.addContainer(org.apache.hadoop.hdds.protocol.proto.HddsProtos$ContainerInfoProto) throws java.io.IOException on target org.apache.hadoop.hdds.scm.ha.SCMRatisServerImpl@183f041f, cost 15811.022us
2021-10-05 13:26:02,787 [EndpointStateMachine task thread for /127.0.0.1:15041 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15041. Already tried 9 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:26:02,808 [Listener at 127.0.0.1/10516] INFO  ha.SCMHAInvocationHandler (SCMHAInvocationHandler.java:invokeRatis(113)) - Invoking method public abstract void org.apache.hadoop.hdds.scm.container.ContainerStateManagerV2.addContainer(org.apache.hadoop.hdds.protocol.proto.HddsProtos$ContainerInfoProto) throws java.io.IOException on target org.apache.hadoop.hdds.scm.ha.SCMRatisServerImpl@183f041f, cost 3085.298us
2021-10-05 13:26:02,832 [61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-StateMachineUpdater] INFO  ha.SCMStateMachine (SCMStateMachine.java:takeSnapshot(290)) - Current Snapshot Index 50, takeSnapshot took 0 ms
2021-10-05 13:26:02,832 [61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:takeSnapshot(281)) - 61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-StateMachineUpdater: Took a snapshot at index 50
2021-10-05 13:26:02,832 [61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:lambda$new$0(89)) - 61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-StateMachineUpdater: snapshotIndex: updateIncreasingly 45 -> 50
2021-10-05 13:26:02,832 [61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:purge(306)) - 61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-SegmentedRaftLog: purge 50
2021-10-05 13:26:02,832 [61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - 61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-SegmentedRaftLog: snapshotIndex: updateIncreasingly 45 -> 50
2021-10-05 13:26:02,832 [61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - 61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-SegmentedRaftLog: purgeIndex: updateToMax old=45, new=50, updated? true
2021-10-05 13:26:02,872 [EndpointStateMachine task thread for /127.0.0.1:15031 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15031. Already tried 13 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:26:02,873 [EndpointStateMachine task thread for /127.0.0.1:15021 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15021. Already tried 13 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:26:02,882 [EndpointStateMachine task thread for /127.0.0.1:13549 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:13549. Already tried 0 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:26:02,882 [EndpointStateMachine task thread for /127.0.0.1:13529 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:13529. Already tried 0 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:26:02,913 [b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-StateMachineUpdater] INFO  ha.SCMStateMachine (SCMStateMachine.java:takeSnapshot(290)) - Current Snapshot Index 50, takeSnapshot took 0 ms
2021-10-05 13:26:02,913 [b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:takeSnapshot(281)) - b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-StateMachineUpdater: Took a snapshot at index 50
2021-10-05 13:26:02,913 [b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:lambda$new$0(89)) - b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-StateMachineUpdater: snapshotIndex: updateIncreasingly 45 -> 50
2021-10-05 13:26:02,913 [b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:purge(306)) - b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-SegmentedRaftLog: purge 50
2021-10-05 13:26:02,913 [b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-SegmentedRaftLog: snapshotIndex: updateIncreasingly 45 -> 50
2021-10-05 13:26:02,913 [b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-SegmentedRaftLog: purgeIndex: updateToMax old=45, new=50, updated? true
2021-10-05 13:26:02,915 [Listener at 127.0.0.1/10516] INFO  ha.SCMHAInvocationHandler (SCMHAInvocationHandler.java:invokeRatis(113)) - Invoking method public abstract void org.apache.hadoop.hdds.scm.container.ContainerStateManagerV2.addContainer(org.apache.hadoop.hdds.protocol.proto.HddsProtos$ContainerInfoProto) throws java.io.IOException on target org.apache.hadoop.hdds.scm.ha.SCMRatisServerImpl@183f041f, cost 6602.336us
2021-10-05 13:26:02,964 [EndpointStateMachine task thread for /127.0.0.1:13539 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:13539. Already tried 14 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:26:03,026 [Listener at 127.0.0.1/10516] INFO  ha.SCMHAInvocationHandler (SCMHAInvocationHandler.java:invokeRatis(113)) - Invoking method public abstract void org.apache.hadoop.hdds.scm.container.ContainerStateManagerV2.addContainer(org.apache.hadoop.hdds.protocol.proto.HddsProtos$ContainerInfoProto) throws java.io.IOException on target org.apache.hadoop.hdds.scm.ha.SCMRatisServerImpl@183f041f, cost 6257.103us
2021-10-05 13:26:03,133 [61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-StateMachineUpdater] INFO  ha.SCMStateMachine (SCMStateMachine.java:takeSnapshot(290)) - Current Snapshot Index 55, takeSnapshot took 0 ms
2021-10-05 13:26:03,133 [61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:takeSnapshot(281)) - 61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-StateMachineUpdater: Took a snapshot at index 55
2021-10-05 13:26:03,133 [61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:lambda$new$0(89)) - 61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-StateMachineUpdater: snapshotIndex: updateIncreasingly 50 -> 55
2021-10-05 13:26:03,133 [61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:purge(306)) - 61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-SegmentedRaftLog: purge 55
2021-10-05 13:26:03,133 [61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - 61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-SegmentedRaftLog: snapshotIndex: updateIncreasingly 50 -> 55
2021-10-05 13:26:03,133 [61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - 61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-SegmentedRaftLog: purgeIndex: updateToMax old=50, new=55, updated? true
2021-10-05 13:26:03,133 [Listener at 127.0.0.1/10516] INFO  ha.SCMHAInvocationHandler (SCMHAInvocationHandler.java:invokeRatis(113)) - Invoking method public abstract void org.apache.hadoop.hdds.scm.container.ContainerStateManagerV2.addContainer(org.apache.hadoop.hdds.protocol.proto.HddsProtos$ContainerInfoProto) throws java.io.IOException on target org.apache.hadoop.hdds.scm.ha.SCMRatisServerImpl@183f041f, cost 6351.511us
2021-10-05 13:26:03,142 [b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-StateMachineUpdater] INFO  ha.SCMStateMachine (SCMStateMachine.java:takeSnapshot(290)) - Current Snapshot Index 55, takeSnapshot took 0 ms
2021-10-05 13:26:03,142 [b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:takeSnapshot(281)) - b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-StateMachineUpdater: Took a snapshot at index 55
2021-10-05 13:26:03,142 [b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:lambda$new$0(89)) - b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-StateMachineUpdater: snapshotIndex: updateIncreasingly 50 -> 55
2021-10-05 13:26:03,142 [b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:purge(306)) - b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-SegmentedRaftLog: purge 55
2021-10-05 13:26:03,142 [b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-SegmentedRaftLog: snapshotIndex: updateIncreasingly 50 -> 55
2021-10-05 13:26:03,142 [b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-SegmentedRaftLog: purgeIndex: updateToMax old=50, new=55, updated? true
2021-10-05 13:26:03,240 [Listener at 127.0.0.1/10516] INFO  ha.SCMHAInvocationHandler (SCMHAInvocationHandler.java:invokeRatis(113)) - Invoking method public abstract void org.apache.hadoop.hdds.scm.container.ContainerStateManagerV2.addContainer(org.apache.hadoop.hdds.protocol.proto.HddsProtos$ContainerInfoProto) throws java.io.IOException on target org.apache.hadoop.hdds.scm.ha.SCMRatisServerImpl@183f041f, cost 6962.27us
2021-10-05 13:26:03,348 [Listener at 127.0.0.1/10516] INFO  ha.SCMHAInvocationHandler (SCMHAInvocationHandler.java:invokeRatis(113)) - Invoking method public abstract void org.apache.hadoop.hdds.scm.container.ContainerStateManagerV2.addContainer(org.apache.hadoop.hdds.protocol.proto.HddsProtos$ContainerInfoProto) throws java.io.IOException on target org.apache.hadoop.hdds.scm.ha.SCMRatisServerImpl@183f041f, cost 7360.108us
2021-10-05 13:26:03,356 [61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-StateMachineUpdater] INFO  ha.SCMStateMachine (SCMStateMachine.java:takeSnapshot(290)) - Current Snapshot Index 60, takeSnapshot took 0 ms
2021-10-05 13:26:03,357 [61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:takeSnapshot(281)) - 61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-StateMachineUpdater: Took a snapshot at index 60
2021-10-05 13:26:03,357 [61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:lambda$new$0(89)) - 61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-StateMachineUpdater: snapshotIndex: updateIncreasingly 55 -> 60
2021-10-05 13:26:03,357 [61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:purge(306)) - 61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-SegmentedRaftLog: purge 60
2021-10-05 13:26:03,357 [61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - 61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-SegmentedRaftLog: snapshotIndex: updateIncreasingly 55 -> 60
2021-10-05 13:26:03,357 [61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - 61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-SegmentedRaftLog: purgeIndex: updateToMax old=55, new=60, updated? true
2021-10-05 13:26:03,450 [b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-StateMachineUpdater] INFO  ha.SCMStateMachine (SCMStateMachine.java:takeSnapshot(290)) - Current Snapshot Index 60, takeSnapshot took 0 ms
2021-10-05 13:26:03,450 [b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:takeSnapshot(281)) - b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-StateMachineUpdater: Took a snapshot at index 60
2021-10-05 13:26:03,450 [b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:lambda$new$0(89)) - b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-StateMachineUpdater: snapshotIndex: updateIncreasingly 55 -> 60
2021-10-05 13:26:03,450 [b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:purge(306)) - b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-SegmentedRaftLog: purge 60
2021-10-05 13:26:03,450 [b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-SegmentedRaftLog: snapshotIndex: updateIncreasingly 55 -> 60
2021-10-05 13:26:03,450 [b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-SegmentedRaftLog: purgeIndex: updateToMax old=55, new=60, updated? true
2021-10-05 13:26:03,454 [Listener at 127.0.0.1/10516] INFO  ha.SCMHAInvocationHandler (SCMHAInvocationHandler.java:invokeRatis(113)) - Invoking method public abstract void org.apache.hadoop.hdds.scm.container.ContainerStateManagerV2.addContainer(org.apache.hadoop.hdds.protocol.proto.HddsProtos$ContainerInfoProto) throws java.io.IOException on target org.apache.hadoop.hdds.scm.ha.SCMRatisServerImpl@183f041f, cost 5697.349us
2021-10-05 13:26:03,564 [Listener at 127.0.0.1/10516] INFO  ha.SCMHAInvocationHandler (SCMHAInvocationHandler.java:invokeRatis(113)) - Invoking method public abstract void org.apache.hadoop.hdds.scm.container.ContainerStateManagerV2.addContainer(org.apache.hadoop.hdds.protocol.proto.HddsProtos$ContainerInfoProto) throws java.io.IOException on target org.apache.hadoop.hdds.scm.ha.SCMRatisServerImpl@183f041f, cost 9711.435us
2021-10-05 13:26:03,668 [61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-StateMachineUpdater] INFO  ha.SCMStateMachine (SCMStateMachine.java:takeSnapshot(290)) - Current Snapshot Index 65, takeSnapshot took 1 ms
2021-10-05 13:26:03,668 [61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:takeSnapshot(281)) - 61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-StateMachineUpdater: Took a snapshot at index 65
2021-10-05 13:26:03,668 [61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:lambda$new$0(89)) - 61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-StateMachineUpdater: snapshotIndex: updateIncreasingly 60 -> 65
2021-10-05 13:26:03,668 [61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:purge(306)) - 61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-SegmentedRaftLog: purge 65
2021-10-05 13:26:03,668 [61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - 61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-SegmentedRaftLog: snapshotIndex: updateIncreasingly 60 -> 65
2021-10-05 13:26:03,668 [61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - 61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-SegmentedRaftLog: purgeIndex: updateToMax old=60, new=65, updated? true
2021-10-05 13:26:03,668 [Listener at 127.0.0.1/10516] INFO  ha.SCMHAInvocationHandler (SCMHAInvocationHandler.java:invokeRatis(113)) - Invoking method public abstract void org.apache.hadoop.hdds.scm.container.ContainerStateManagerV2.addContainer(org.apache.hadoop.hdds.protocol.proto.HddsProtos$ContainerInfoProto) throws java.io.IOException on target org.apache.hadoop.hdds.scm.ha.SCMRatisServerImpl@183f041f, cost 3941.579us
2021-10-05 13:26:03,684 [b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-StateMachineUpdater] INFO  ha.SCMStateMachine (SCMStateMachine.java:takeSnapshot(290)) - Current Snapshot Index 65, takeSnapshot took 0 ms
2021-10-05 13:26:03,684 [b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:takeSnapshot(281)) - b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-StateMachineUpdater: Took a snapshot at index 65
2021-10-05 13:26:03,684 [b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:lambda$new$0(89)) - b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-StateMachineUpdater: snapshotIndex: updateIncreasingly 60 -> 65
2021-10-05 13:26:03,684 [b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:purge(306)) - b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-SegmentedRaftLog: purge 65
2021-10-05 13:26:03,684 [b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-SegmentedRaftLog: snapshotIndex: updateIncreasingly 60 -> 65
2021-10-05 13:26:03,684 [b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-SegmentedRaftLog: purgeIndex: updateToMax old=60, new=65, updated? true
2021-10-05 13:26:03,788 [EndpointStateMachine task thread for /127.0.0.1:15041 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15041. Already tried 10 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:26:03,788 [Listener at 127.0.0.1/10516] INFO  ha.SCMHAInvocationHandler (SCMHAInvocationHandler.java:invokeRatis(113)) - Invoking method public abstract void org.apache.hadoop.hdds.scm.container.ContainerStateManagerV2.addContainer(org.apache.hadoop.hdds.protocol.proto.HddsProtos$ContainerInfoProto) throws java.io.IOException on target org.apache.hadoop.hdds.scm.ha.SCMRatisServerImpl@183f041f, cost 19151.043us
2021-10-05 13:26:03,844 [Datanode State Machine Thread - 0] ERROR datanode.RunningDatanodeState (RunningDatanodeState.java:computeNextContainerState(199)) - Error in executing end point task.
java.util.concurrent.ExecutionException: java.util.concurrent.TimeoutException
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.hadoop.ozone.container.common.states.datanode.RunningDatanodeState.computeNextContainerState(RunningDatanodeState.java:191)
	at org.apache.hadoop.ozone.container.common.states.datanode.RunningDatanodeState.await(RunningDatanodeState.java:231)
	at org.apache.hadoop.ozone.container.common.states.datanode.RunningDatanodeState.await(RunningDatanodeState.java:50)
	at org.apache.hadoop.ozone.container.common.statemachine.StateContext.execute(StateContext.java:629)
	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.start(DatanodeStateMachine.java:270)
	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.lambda$startDaemon$0(DatanodeStateMachine.java:457)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.util.concurrent.TimeoutException
	at java.util.concurrent.FutureTask.get(FutureTask.java:205)
	at org.apache.hadoop.ozone.container.common.states.datanode.RunningDatanodeState.lambda$execute$0(RunningDatanodeState.java:149)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
2021-10-05 13:26:03,872 [EndpointStateMachine task thread for /127.0.0.1:15031 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15031. Already tried 14 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:26:03,873 [EndpointStateMachine task thread for /127.0.0.1:15021 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15021. Already tried 14 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:26:03,883 [EndpointStateMachine task thread for /127.0.0.1:13549 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:13549. Already tried 1 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:26:03,883 [EndpointStateMachine task thread for /127.0.0.1:13529 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:13529. Already tried 1 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:26:03,894 [Listener at 127.0.0.1/10516] INFO  ha.SCMHAInvocationHandler (SCMHAInvocationHandler.java:invokeRatis(113)) - Invoking method public abstract void org.apache.hadoop.hdds.scm.container.ContainerStateManagerV2.addContainer(org.apache.hadoop.hdds.protocol.proto.HddsProtos$ContainerInfoProto) throws java.io.IOException on target org.apache.hadoop.hdds.scm.ha.SCMRatisServerImpl@183f041f, cost 5460.125us
2021-10-05 13:26:03,899 [61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-StateMachineUpdater] INFO  ha.SCMStateMachine (SCMStateMachine.java:takeSnapshot(290)) - Current Snapshot Index 70, takeSnapshot took 0 ms
2021-10-05 13:26:03,899 [61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:takeSnapshot(281)) - 61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-StateMachineUpdater: Took a snapshot at index 70
2021-10-05 13:26:03,899 [61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:lambda$new$0(89)) - 61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-StateMachineUpdater: snapshotIndex: updateIncreasingly 65 -> 70
2021-10-05 13:26:03,900 [61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:purge(306)) - 61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-SegmentedRaftLog: purge 70
2021-10-05 13:26:03,900 [61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - 61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-SegmentedRaftLog: snapshotIndex: updateIncreasingly 65 -> 70
2021-10-05 13:26:03,900 [61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - 61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-SegmentedRaftLog: purgeIndex: updateToMax old=65, new=70, updated? true
2021-10-05 13:26:03,965 [EndpointStateMachine task thread for /127.0.0.1:13539 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:13539. Already tried 0 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:26:04,001 [b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-StateMachineUpdater] INFO  ha.SCMStateMachine (SCMStateMachine.java:takeSnapshot(290)) - Current Snapshot Index 70, takeSnapshot took 0 ms
2021-10-05 13:26:04,001 [b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:takeSnapshot(281)) - b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-StateMachineUpdater: Took a snapshot at index 70
2021-10-05 13:26:04,001 [b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:lambda$new$0(89)) - b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-StateMachineUpdater: snapshotIndex: updateIncreasingly 65 -> 70
2021-10-05 13:26:04,001 [b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:purge(306)) - b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-SegmentedRaftLog: purge 70
2021-10-05 13:26:04,001 [b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-SegmentedRaftLog: snapshotIndex: updateIncreasingly 65 -> 70
2021-10-05 13:26:04,002 [b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-SegmentedRaftLog: purgeIndex: updateToMax old=65, new=70, updated? true
2021-10-05 13:26:04,002 [Listener at 127.0.0.1/10516] INFO  ha.SCMHAInvocationHandler (SCMHAInvocationHandler.java:invokeRatis(113)) - Invoking method public abstract void org.apache.hadoop.hdds.scm.container.ContainerStateManagerV2.addContainer(org.apache.hadoop.hdds.protocol.proto.HddsProtos$ContainerInfoProto) throws java.io.IOException on target org.apache.hadoop.hdds.scm.ha.SCMRatisServerImpl@183f041f, cost 8126.982us
2021-10-05 13:26:04,106 [Listener at 127.0.0.1/10516] INFO  ha.SCMHAInvocationHandler (SCMHAInvocationHandler.java:invokeRatis(113)) - Invoking method public abstract void org.apache.hadoop.hdds.scm.container.ContainerStateManagerV2.addContainer(org.apache.hadoop.hdds.protocol.proto.HddsProtos$ContainerInfoProto) throws java.io.IOException on target org.apache.hadoop.hdds.scm.ha.SCMRatisServerImpl@183f041f, cost 3732.159us
2021-10-05 13:26:04,108 [Datanode State Machine Thread - 0] ERROR datanode.RunningDatanodeState (RunningDatanodeState.java:computeNextContainerState(199)) - Error in executing end point task.
java.util.concurrent.ExecutionException: java.util.concurrent.TimeoutException
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.hadoop.ozone.container.common.states.datanode.RunningDatanodeState.computeNextContainerState(RunningDatanodeState.java:191)
	at org.apache.hadoop.ozone.container.common.states.datanode.RunningDatanodeState.await(RunningDatanodeState.java:231)
	at org.apache.hadoop.ozone.container.common.states.datanode.RunningDatanodeState.await(RunningDatanodeState.java:50)
	at org.apache.hadoop.ozone.container.common.statemachine.StateContext.execute(StateContext.java:629)
	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.start(DatanodeStateMachine.java:270)
	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.lambda$startDaemon$0(DatanodeStateMachine.java:457)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.util.concurrent.TimeoutException
	at java.util.concurrent.FutureTask.get(FutureTask.java:205)
	at org.apache.hadoop.ozone.container.common.states.datanode.RunningDatanodeState.lambda$execute$0(RunningDatanodeState.java:149)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
2021-10-05 13:26:04,212 [61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-StateMachineUpdater] INFO  ha.SCMStateMachine (SCMStateMachine.java:takeSnapshot(290)) - Current Snapshot Index 75, takeSnapshot took 0 ms
2021-10-05 13:26:04,212 [61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:takeSnapshot(281)) - 61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-StateMachineUpdater: Took a snapshot at index 75
2021-10-05 13:26:04,212 [61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:lambda$new$0(89)) - 61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-StateMachineUpdater: snapshotIndex: updateIncreasingly 70 -> 75
2021-10-05 13:26:04,212 [61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:purge(306)) - 61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-SegmentedRaftLog: purge 75
2021-10-05 13:26:04,212 [61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - 61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-SegmentedRaftLog: snapshotIndex: updateIncreasingly 70 -> 75
2021-10-05 13:26:04,212 [61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - 61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-SegmentedRaftLog: purgeIndex: updateToMax old=70, new=75, updated? true
2021-10-05 13:26:04,212 [Listener at 127.0.0.1/10516] INFO  ha.SCMHAInvocationHandler (SCMHAInvocationHandler.java:invokeRatis(113)) - Invoking method public abstract void org.apache.hadoop.hdds.scm.container.ContainerStateManagerV2.addContainer(org.apache.hadoop.hdds.protocol.proto.HddsProtos$ContainerInfoProto) throws java.io.IOException on target org.apache.hadoop.hdds.scm.ha.SCMRatisServerImpl@183f041f, cost 5443.524us
2021-10-05 13:26:04,231 [b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-StateMachineUpdater] INFO  ha.SCMStateMachine (SCMStateMachine.java:takeSnapshot(290)) - Current Snapshot Index 75, takeSnapshot took 0 ms
2021-10-05 13:26:04,232 [b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:takeSnapshot(281)) - b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-StateMachineUpdater: Took a snapshot at index 75
2021-10-05 13:26:04,232 [b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:lambda$new$0(89)) - b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-StateMachineUpdater: snapshotIndex: updateIncreasingly 70 -> 75
2021-10-05 13:26:04,232 [b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:purge(306)) - b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-SegmentedRaftLog: purge 75
2021-10-05 13:26:04,232 [b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-SegmentedRaftLog: snapshotIndex: updateIncreasingly 70 -> 75
2021-10-05 13:26:04,232 [b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-SegmentedRaftLog: purgeIndex: updateToMax old=70, new=75, updated? true
2021-10-05 13:26:04,318 [Listener at 127.0.0.1/10516] INFO  ha.SCMHAInvocationHandler (SCMHAInvocationHandler.java:invokeRatis(113)) - Invoking method public abstract void org.apache.hadoop.hdds.scm.container.ContainerStateManagerV2.addContainer(org.apache.hadoop.hdds.protocol.proto.HddsProtos$ContainerInfoProto) throws java.io.IOException on target org.apache.hadoop.hdds.scm.ha.SCMRatisServerImpl@183f041f, cost 5511.43us
2021-10-05 13:26:04,399 [Datanode State Machine Thread - 0] ERROR datanode.RunningDatanodeState (RunningDatanodeState.java:computeNextContainerState(199)) - Error in executing end point task.
java.util.concurrent.ExecutionException: java.util.concurrent.TimeoutException
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.hadoop.ozone.container.common.states.datanode.RunningDatanodeState.computeNextContainerState(RunningDatanodeState.java:191)
	at org.apache.hadoop.ozone.container.common.states.datanode.RunningDatanodeState.await(RunningDatanodeState.java:231)
	at org.apache.hadoop.ozone.container.common.states.datanode.RunningDatanodeState.await(RunningDatanodeState.java:50)
	at org.apache.hadoop.ozone.container.common.statemachine.StateContext.execute(StateContext.java:629)
	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.start(DatanodeStateMachine.java:270)
	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.lambda$startDaemon$0(DatanodeStateMachine.java:457)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.util.concurrent.TimeoutException
	at java.util.concurrent.FutureTask.get(FutureTask.java:205)
	at org.apache.hadoop.ozone.container.common.states.datanode.RunningDatanodeState.lambda$execute$0(RunningDatanodeState.java:149)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
2021-10-05 13:26:04,426 [Listener at 127.0.0.1/10516] INFO  ha.SCMHAInvocationHandler (SCMHAInvocationHandler.java:invokeRatis(113)) - Invoking method public abstract void org.apache.hadoop.hdds.scm.container.ContainerStateManagerV2.addContainer(org.apache.hadoop.hdds.protocol.proto.HddsProtos$ContainerInfoProto) throws java.io.IOException on target org.apache.hadoop.hdds.scm.ha.SCMRatisServerImpl@183f041f, cost 7060.679us
2021-10-05 13:26:04,437 [61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-StateMachineUpdater] INFO  ha.SCMStateMachine (SCMStateMachine.java:takeSnapshot(290)) - Current Snapshot Index 80, takeSnapshot took 0 ms
2021-10-05 13:26:04,437 [61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:takeSnapshot(281)) - 61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-StateMachineUpdater: Took a snapshot at index 80
2021-10-05 13:26:04,437 [61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:lambda$new$0(89)) - 61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-StateMachineUpdater: snapshotIndex: updateIncreasingly 75 -> 80
2021-10-05 13:26:04,438 [61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:purge(306)) - 61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-SegmentedRaftLog: purge 80
2021-10-05 13:26:04,438 [61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - 61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-SegmentedRaftLog: snapshotIndex: updateIncreasingly 75 -> 80
2021-10-05 13:26:04,438 [61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - 61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-SegmentedRaftLog: purgeIndex: updateToMax old=75, new=80, updated? true
2021-10-05 13:26:04,542 [b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-StateMachineUpdater] INFO  ha.SCMStateMachine (SCMStateMachine.java:takeSnapshot(290)) - Current Snapshot Index 80, takeSnapshot took 0 ms
2021-10-05 13:26:04,542 [b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:takeSnapshot(281)) - b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-StateMachineUpdater: Took a snapshot at index 80
2021-10-05 13:26:04,542 [b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:lambda$new$0(89)) - b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-StateMachineUpdater: snapshotIndex: updateIncreasingly 75 -> 80
2021-10-05 13:26:04,542 [b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:purge(306)) - b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-SegmentedRaftLog: purge 80
2021-10-05 13:26:04,542 [b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-SegmentedRaftLog: snapshotIndex: updateIncreasingly 75 -> 80
2021-10-05 13:26:04,542 [b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-SegmentedRaftLog: purgeIndex: updateToMax old=75, new=80, updated? true
2021-10-05 13:26:04,543 [Listener at 127.0.0.1/10516] INFO  ha.SCMHAInvocationHandler (SCMHAInvocationHandler.java:invokeRatis(113)) - Invoking method public abstract void org.apache.hadoop.hdds.scm.container.ContainerStateManagerV2.addContainer(org.apache.hadoop.hdds.protocol.proto.HddsProtos$ContainerInfoProto) throws java.io.IOException on target org.apache.hadoop.hdds.scm.ha.SCMRatisServerImpl@183f041f, cost 16359.375us
2021-10-05 13:26:04,653 [Listener at 127.0.0.1/10516] INFO  ha.SCMHAInvocationHandler (SCMHAInvocationHandler.java:invokeRatis(113)) - Invoking method public abstract void org.apache.hadoop.hdds.scm.container.ContainerStateManagerV2.addContainer(org.apache.hadoop.hdds.protocol.proto.HddsProtos$ContainerInfoProto) throws java.io.IOException on target org.apache.hadoop.hdds.scm.ha.SCMRatisServerImpl@183f041f, cost 9577.021us
2021-10-05 13:26:04,768 [61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-StateMachineUpdater] INFO  ha.SCMStateMachine (SCMStateMachine.java:takeSnapshot(290)) - Current Snapshot Index 85, takeSnapshot took 0 ms
2021-10-05 13:26:04,768 [61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:takeSnapshot(281)) - 61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-StateMachineUpdater: Took a snapshot at index 85
2021-10-05 13:26:04,768 [61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:lambda$new$0(89)) - 61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-StateMachineUpdater: snapshotIndex: updateIncreasingly 80 -> 85
2021-10-05 13:26:04,768 [61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:purge(306)) - 61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-SegmentedRaftLog: purge 85
2021-10-05 13:26:04,769 [61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - 61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-SegmentedRaftLog: snapshotIndex: updateIncreasingly 80 -> 85
2021-10-05 13:26:04,769 [61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - 61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-SegmentedRaftLog: purgeIndex: updateToMax old=80, new=85, updated? true
2021-10-05 13:26:04,769 [Listener at 127.0.0.1/10516] INFO  ha.SCMHAInvocationHandler (SCMHAInvocationHandler.java:invokeRatis(113)) - Invoking method public abstract void org.apache.hadoop.hdds.scm.container.ContainerStateManagerV2.addContainer(org.apache.hadoop.hdds.protocol.proto.HddsProtos$ContainerInfoProto) throws java.io.IOException on target org.apache.hadoop.hdds.scm.ha.SCMRatisServerImpl@183f041f, cost 15721.313us
2021-10-05 13:26:04,788 [b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-StateMachineUpdater] INFO  ha.SCMStateMachine (SCMStateMachine.java:takeSnapshot(290)) - Current Snapshot Index 85, takeSnapshot took 0 ms
2021-10-05 13:26:04,788 [b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:takeSnapshot(281)) - b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-StateMachineUpdater: Took a snapshot at index 85
2021-10-05 13:26:04,788 [b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:lambda$new$0(89)) - b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-StateMachineUpdater: snapshotIndex: updateIncreasingly 80 -> 85
2021-10-05 13:26:04,788 [b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:purge(306)) - b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-SegmentedRaftLog: purge 85
2021-10-05 13:26:04,788 [EndpointStateMachine task thread for /127.0.0.1:15041 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15041. Already tried 11 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:26:04,788 [b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-SegmentedRaftLog: snapshotIndex: updateIncreasingly 80 -> 85
2021-10-05 13:26:04,788 [b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-SegmentedRaftLog: purgeIndex: updateToMax old=80, new=85, updated? true
2021-10-05 13:26:04,874 [EndpointStateMachine task thread for /127.0.0.1:15021 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15021. Already tried 0 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:26:04,874 [Listener at 127.0.0.1/10516] INFO  ha.SCMHAInvocationHandler (SCMHAInvocationHandler.java:invokeRatis(113)) - Invoking method public abstract void org.apache.hadoop.hdds.scm.container.ContainerStateManagerV2.addContainer(org.apache.hadoop.hdds.protocol.proto.HddsProtos$ContainerInfoProto) throws java.io.IOException on target org.apache.hadoop.hdds.scm.ha.SCMRatisServerImpl@183f041f, cost 4684.45us
2021-10-05 13:26:04,874 [EndpointStateMachine task thread for /127.0.0.1:15031 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15031. Already tried 0 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:26:04,883 [EndpointStateMachine task thread for /127.0.0.1:13549 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:13549. Already tried 2 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:26:04,883 [EndpointStateMachine task thread for /127.0.0.1:13529 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:13529. Already tried 2 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:26:04,965 [EndpointStateMachine task thread for /127.0.0.1:13539 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:13539. Already tried 1 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:26:04,983 [Listener at 127.0.0.1/10516] INFO  ha.SCMHAInvocationHandler (SCMHAInvocationHandler.java:invokeRatis(113)) - Invoking method public abstract void org.apache.hadoop.hdds.scm.container.ContainerStateManagerV2.addContainer(org.apache.hadoop.hdds.protocol.proto.HddsProtos$ContainerInfoProto) throws java.io.IOException on target org.apache.hadoop.hdds.scm.ha.SCMRatisServerImpl@183f041f, cost 8335.803us
2021-10-05 13:26:04,992 [61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-StateMachineUpdater] INFO  ha.SCMStateMachine (SCMStateMachine.java:takeSnapshot(290)) - Current Snapshot Index 90, takeSnapshot took 0 ms
2021-10-05 13:26:04,992 [61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:takeSnapshot(281)) - 61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-StateMachineUpdater: Took a snapshot at index 90
2021-10-05 13:26:04,992 [61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:lambda$new$0(89)) - 61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-StateMachineUpdater: snapshotIndex: updateIncreasingly 85 -> 90
2021-10-05 13:26:04,992 [61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:purge(306)) - 61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-SegmentedRaftLog: purge 90
2021-10-05 13:26:04,992 [61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - 61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-SegmentedRaftLog: snapshotIndex: updateIncreasingly 85 -> 90
2021-10-05 13:26:04,992 [61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - 61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-SegmentedRaftLog: purgeIndex: updateToMax old=85, new=90, updated? true
2021-10-05 13:26:05,103 [b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-StateMachineUpdater] INFO  ha.SCMStateMachine (SCMStateMachine.java:takeSnapshot(290)) - Current Snapshot Index 90, takeSnapshot took 0 ms
2021-10-05 13:26:05,103 [b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:takeSnapshot(281)) - b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-StateMachineUpdater: Took a snapshot at index 90
2021-10-05 13:26:05,103 [b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:lambda$new$0(89)) - b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-StateMachineUpdater: snapshotIndex: updateIncreasingly 85 -> 90
2021-10-05 13:26:05,103 [b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:purge(306)) - b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-SegmentedRaftLog: purge 90
2021-10-05 13:26:05,103 [b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-SegmentedRaftLog: snapshotIndex: updateIncreasingly 85 -> 90
2021-10-05 13:26:05,103 [b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-SegmentedRaftLog: purgeIndex: updateToMax old=85, new=90, updated? true
2021-10-05 13:26:05,104 [Listener at 127.0.0.1/10516] INFO  ha.SCMHAInvocationHandler (SCMHAInvocationHandler.java:invokeRatis(113)) - Invoking method public abstract void org.apache.hadoop.hdds.scm.container.ContainerStateManagerV2.addContainer(org.apache.hadoop.hdds.protocol.proto.HddsProtos$ContainerInfoProto) throws java.io.IOException on target org.apache.hadoop.hdds.scm.ha.SCMRatisServerImpl@183f041f, cost 21382.457us
2021-10-05 13:26:05,212 [Listener at 127.0.0.1/10516] INFO  ha.SCMHAInvocationHandler (SCMHAInvocationHandler.java:invokeRatis(113)) - Invoking method public abstract void org.apache.hadoop.hdds.scm.container.ContainerStateManagerV2.addContainer(org.apache.hadoop.hdds.protocol.proto.HddsProtos$ContainerInfoProto) throws java.io.IOException on target org.apache.hadoop.hdds.scm.ha.SCMRatisServerImpl@183f041f, cost 7292.401us
2021-10-05 13:26:05,327 [61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-StateMachineUpdater] INFO  ha.SCMStateMachine (SCMStateMachine.java:takeSnapshot(290)) - Current Snapshot Index 95, takeSnapshot took 0 ms
2021-10-05 13:26:05,327 [61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:takeSnapshot(281)) - 61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-StateMachineUpdater: Took a snapshot at index 95
2021-10-05 13:26:05,327 [61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:lambda$new$0(89)) - 61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-StateMachineUpdater: snapshotIndex: updateIncreasingly 90 -> 95
2021-10-05 13:26:05,327 [61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:purge(306)) - 61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-SegmentedRaftLog: purge 95
2021-10-05 13:26:05,327 [61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - 61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-SegmentedRaftLog: snapshotIndex: updateIncreasingly 90 -> 95
2021-10-05 13:26:05,327 [61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - 61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-SegmentedRaftLog: purgeIndex: updateToMax old=90, new=95, updated? true
2021-10-05 13:26:05,328 [Listener at 127.0.0.1/10516] INFO  ha.SCMHAInvocationHandler (SCMHAInvocationHandler.java:invokeRatis(113)) - Invoking method public abstract void org.apache.hadoop.hdds.scm.container.ContainerStateManagerV2.addContainer(org.apache.hadoop.hdds.protocol.proto.HddsProtos$ContainerInfoProto) throws java.io.IOException on target org.apache.hadoop.hdds.scm.ha.SCMRatisServerImpl@183f041f, cost 15015.745us
2021-10-05 13:26:05,336 [b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-StateMachineUpdater] INFO  ha.SCMStateMachine (SCMStateMachine.java:takeSnapshot(290)) - Current Snapshot Index 95, takeSnapshot took 0 ms
2021-10-05 13:26:05,336 [b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:takeSnapshot(281)) - b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-StateMachineUpdater: Took a snapshot at index 95
2021-10-05 13:26:05,336 [b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:lambda$new$0(89)) - b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-StateMachineUpdater: snapshotIndex: updateIncreasingly 90 -> 95
2021-10-05 13:26:05,336 [b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:purge(306)) - b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-SegmentedRaftLog: purge 95
2021-10-05 13:26:05,336 [b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-SegmentedRaftLog: snapshotIndex: updateIncreasingly 90 -> 95
2021-10-05 13:26:05,336 [b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-SegmentedRaftLog: purgeIndex: updateToMax old=90, new=95, updated? true
2021-10-05 13:26:05,402 [Datanode State Machine Thread - 0] ERROR datanode.RunningDatanodeState (RunningDatanodeState.java:computeNextContainerState(199)) - Error in executing end point task.
java.util.concurrent.ExecutionException: java.util.concurrent.TimeoutException
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.hadoop.ozone.container.common.states.datanode.RunningDatanodeState.computeNextContainerState(RunningDatanodeState.java:191)
	at org.apache.hadoop.ozone.container.common.states.datanode.RunningDatanodeState.await(RunningDatanodeState.java:231)
	at org.apache.hadoop.ozone.container.common.states.datanode.RunningDatanodeState.await(RunningDatanodeState.java:50)
	at org.apache.hadoop.ozone.container.common.statemachine.StateContext.execute(StateContext.java:629)
	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.start(DatanodeStateMachine.java:270)
	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.lambda$startDaemon$0(DatanodeStateMachine.java:457)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.util.concurrent.TimeoutException
	at java.util.concurrent.FutureTask.get(FutureTask.java:205)
	at org.apache.hadoop.ozone.container.common.states.datanode.RunningDatanodeState.lambda$execute$0(RunningDatanodeState.java:149)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
2021-10-05 13:26:05,440 [Listener at 127.0.0.1/10516] INFO  ha.SCMHAInvocationHandler (SCMHAInvocationHandler.java:invokeRatis(113)) - Invoking method public abstract void org.apache.hadoop.hdds.scm.container.ContainerStateManagerV2.addContainer(org.apache.hadoop.hdds.protocol.proto.HddsProtos$ContainerInfoProto) throws java.io.IOException on target org.apache.hadoop.hdds.scm.ha.SCMRatisServerImpl@183f041f, cost 11646.92us
2021-10-05 13:26:05,546 [Listener at 127.0.0.1/10516] INFO  ha.SCMHAInvocationHandler (SCMHAInvocationHandler.java:invokeRatis(113)) - Invoking method public abstract void org.apache.hadoop.hdds.scm.container.ContainerStateManagerV2.addContainer(org.apache.hadoop.hdds.protocol.proto.HddsProtos$ContainerInfoProto) throws java.io.IOException on target org.apache.hadoop.hdds.scm.ha.SCMRatisServerImpl@183f041f, cost 5967.274us
2021-10-05 13:26:05,564 [61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-StateMachineUpdater] INFO  ha.SCMStateMachine (SCMStateMachine.java:takeSnapshot(290)) - Current Snapshot Index 100, takeSnapshot took 0 ms
2021-10-05 13:26:05,564 [61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:takeSnapshot(281)) - 61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-StateMachineUpdater: Took a snapshot at index 100
2021-10-05 13:26:05,564 [61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:lambda$new$0(89)) - 61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-StateMachineUpdater: snapshotIndex: updateIncreasingly 95 -> 100
2021-10-05 13:26:05,564 [61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:purge(306)) - 61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-SegmentedRaftLog: purge 100
2021-10-05 13:26:05,564 [61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - 61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-SegmentedRaftLog: snapshotIndex: updateIncreasingly 95 -> 100
2021-10-05 13:26:05,564 [61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - 61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-SegmentedRaftLog: purgeIndex: updateToMax old=95, new=100, updated? true
2021-10-05 13:26:05,651 [b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-StateMachineUpdater] INFO  ha.SCMStateMachine (SCMStateMachine.java:takeSnapshot(290)) - Current Snapshot Index 100, takeSnapshot took 0 ms
2021-10-05 13:26:05,651 [b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:takeSnapshot(281)) - b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-StateMachineUpdater: Took a snapshot at index 100
2021-10-05 13:26:05,651 [b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:lambda$new$0(89)) - b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-StateMachineUpdater: snapshotIndex: updateIncreasingly 95 -> 100
2021-10-05 13:26:05,651 [b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:purge(306)) - b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-SegmentedRaftLog: purge 100
2021-10-05 13:26:05,652 [b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-SegmentedRaftLog: snapshotIndex: updateIncreasingly 95 -> 100
2021-10-05 13:26:05,652 [b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-StateMachineUpdater] INFO  raftlog.RaftLog (RaftLogBase.java:lambda$new$0(53)) - b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-SegmentedRaftLog: purgeIndex: updateToMax old=95, new=100, updated? true
2021-10-05 13:26:05,653 [Listener at 127.0.0.1/10516] INFO  ha.SCMHAInvocationHandler (SCMHAInvocationHandler.java:invokeRatis(113)) - Invoking method public abstract void org.apache.hadoop.hdds.scm.container.ContainerStateManagerV2.addContainer(org.apache.hadoop.hdds.protocol.proto.HddsProtos$ContainerInfoProto) throws java.io.IOException on target org.apache.hadoop.hdds.scm.ha.SCMRatisServerImpl@183f041f, cost 6361.011us
2021-10-05 13:26:05,786 [Listener at 127.0.0.1/10516] INFO  db.RDBCheckpointManager (RDBCheckpointManager.java:createCheckpoint(86)) - Created checkpoint at /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-62d231c0-d845-4dcd-88aa-c082e017c57e/scmNode-1/db.checkpoints/scm.db_checkpoint_1633440365753 in 32 milliseconds
2021-10-05 13:26:05,788 [EndpointStateMachine task thread for /127.0.0.1:15041 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15041. Already tried 12 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:26:05,875 [EndpointStateMachine task thread for /127.0.0.1:15021 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15021. Already tried 1 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:26:05,875 [EndpointStateMachine task thread for /127.0.0.1:15031 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15031. Already tried 1 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:26:05,883 [EndpointStateMachine task thread for /127.0.0.1:13549 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:13549. Already tried 3 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:26:05,883 [EndpointStateMachine task thread for /127.0.0.1:13529 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:13529. Already tried 3 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:26:05,915 [Listener at 127.0.0.1/10516] WARN  utils.HAUtils (HAUtils.java:getMetaDir(342)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2021-10-05 13:26:05,921 [Listener at 127.0.0.1/10516] WARN  db.DBStoreBuilder (DBStoreBuilder.java:applyDBDefinition(145)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2021-10-05 13:26:05,965 [EndpointStateMachine task thread for /127.0.0.1:13539 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:13539. Already tried 2 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:26:05,970 [Listener at 127.0.0.1/10516] WARN  utils.HAUtils (HAUtils.java:getMetaDir(342)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2021-10-05 13:26:05,970 [Listener at 127.0.0.1/10516] WARN  db.DBStoreBuilder (DBStoreBuilder.java:applyDBDefinition(145)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2021-10-05 13:26:06,094 [Listener at 127.0.0.1/10516] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:reinitialize(166)) - reinitialize SequenceIdGenerator.
2021-10-05 13:26:06,094 [Listener at 127.0.0.1/10516] INFO  pipeline.PipelineStateManagerImpl (PipelineStateManagerImpl.java:initialize(78)) - No pipeline exists in current db
2021-10-05 13:26:06,095 [Listener at 127.0.0.1/10516] ERROR ha.SCMHAManagerImpl (TestSCMInstallSnapshotWithHA.java:exitSystem(305)) - System Exit: Failed to reload SCM state and instantiate services.
java.io.IOException: Failed init RocksDB, db path : /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-62d231c0-d845-4dcd-88aa-c082e017c57e/scmNode-3/scm.db, exception :org.rocksdb.RocksDBException Corruption: IO error: No such file or directory: While open a file for random read: /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-62d231c0-d845-4dcd-88aa-c082e017c57e/scmNode-3/scm.db/000034.ldb: No such file or directory; status : Corruption; message : Corruption: IO error: No such file or directory: While open a file for random read: /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-62d231c0-d845-4dcd-88aa-c082e017c57e/scmNode-3/scm.db/000034.ldb: No such file or directory
	at org.apache.hadoop.hdds.utils.HddsServerUtil.toIOException(HddsServerUtil.java:564)
	at org.apache.hadoop.hdds.utils.db.RDBStore.<init>(RDBStore.java:164)
	at org.apache.hadoop.hdds.utils.db.DBStoreBuilder.build(DBStoreBuilder.java:191)
	at org.apache.hadoop.hdds.utils.db.DBStoreBuilder.createDBStore(DBStoreBuilder.java:98)
	at org.apache.hadoop.hdds.scm.metadata.SCMMetadataStoreImpl.start(SCMMetadataStoreImpl.java:130)
	at org.apache.hadoop.hdds.scm.ha.SCMHAManagerImpl.startServices(SCMHAManagerImpl.java:358)
	at org.apache.hadoop.hdds.scm.ha.SCMHAManagerImpl.reloadSCMState(SCMHAManagerImpl.java:317)
	at org.apache.hadoop.hdds.scm.ha.SCMHAManagerImpl.installCheckpoint(SCMHAManagerImpl.java:276)
	at org.apache.hadoop.ozone.scm.TestSCMInstallSnapshotWithHA.testInstallCorruptedCheckpointFailure(TestSCMInstallSnapshotWithHA.java:267)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.platform.commons.util.ReflectionUtils.invokeMethod(ReflectionUtils.java:688)
	at org.junit.jupiter.engine.execution.MethodInvocation.proceed(MethodInvocation.java:60)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain$ValidatingInvocation.proceed(InvocationInterceptorChain.java:131)
	at org.junit.jupiter.engine.extension.TimeoutInvocation.proceed(TimeoutInvocation.java:46)
	at org.junit.jupiter.engine.extension.TimeoutExtension.intercept(TimeoutExtension.java:149)
	at org.junit.jupiter.engine.extension.TimeoutExtension.interceptTestableMethod(TimeoutExtension.java:140)
	at org.junit.jupiter.engine.extension.TimeoutExtension.interceptTestMethod(TimeoutExtension.java:84)
	at org.junit.jupiter.engine.execution.ExecutableInvoker$ReflectiveInterceptorCall.lambda$ofVoidMethod$0(ExecutableInvoker.java:115)
	at org.junit.jupiter.engine.execution.ExecutableInvoker.lambda$invoke$0(ExecutableInvoker.java:105)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain$InterceptedInvocation.proceed(InvocationInterceptorChain.java:106)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.proceed(InvocationInterceptorChain.java:64)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.chainAndInvoke(InvocationInterceptorChain.java:45)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.invoke(InvocationInterceptorChain.java:37)
	at org.junit.jupiter.engine.execution.ExecutableInvoker.invoke(ExecutableInvoker.java:104)
	at org.junit.jupiter.engine.execution.ExecutableInvoker.invoke(ExecutableInvoker.java:98)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.lambda$invokeTestMethod$6(TestMethodTestDescriptor.java:210)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.invokeTestMethod(TestMethodTestDescriptor.java:206)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.execute(TestMethodTestDescriptor.java:131)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.execute(TestMethodTestDescriptor.java:65)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$5(NodeTestTask.java:139)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$7(NodeTestTask.java:129)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:127)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:126)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:84)
	at java.util.ArrayList.forEach(ArrayList.java:1259)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:38)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$5(NodeTestTask.java:143)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$7(NodeTestTask.java:129)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:127)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:126)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:84)
	at java.util.ArrayList.forEach(ArrayList.java:1259)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:38)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$5(NodeTestTask.java:143)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$7(NodeTestTask.java:129)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:127)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:126)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:84)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.submit(SameThreadHierarchicalTestExecutorService.java:32)
	at org.junit.platform.engine.support.hierarchical.HierarchicalTestExecutor.execute(HierarchicalTestExecutor.java:57)
	at org.junit.platform.engine.support.hierarchical.HierarchicalTestEngine.execute(HierarchicalTestEngine.java:51)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:108)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:88)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.lambda$execute$0(EngineExecutionOrchestrator.java:54)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.withInterceptedStreams(EngineExecutionOrchestrator.java:67)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:52)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:96)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:75)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:142)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:113)
	at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:384)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:345)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:126)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:418)
Caused by: org.rocksdb.RocksDBException: Corruption: IO error: No such file or directory: While open a file for random read: /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-62d231c0-d845-4dcd-88aa-c082e017c57e/scmNode-3/scm.db/000034.ldb: No such file or directory
	at org.rocksdb.RocksDB.open(Native Method)
	at org.rocksdb.RocksDB.open(RocksDB.java:306)
	at org.apache.hadoop.hdds.utils.db.RDBStore.<init>(RDBStore.java:119)
	... 75 more
2021-10-05 13:26:06,208 [Listener at 127.0.0.1/10516] WARN  utils.HAUtils (HAUtils.java:getMetaDir(342)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2021-10-05 13:26:06,212 [Listener at 127.0.0.1/10516] WARN  db.DBStoreBuilder (DBStoreBuilder.java:applyDBDefinition(145)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2021-10-05 13:26:06,286 [Listener at 127.0.0.1/10516] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:reinitialize(166)) - reinitialize SequenceIdGenerator.
2021-10-05 13:26:06,309 [Listener at 127.0.0.1/10516] INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:shutdown(453)) - Shutting down the Mini Ozone Cluster
2021-10-05 13:26:06,311 [Listener at 127.0.0.1/10516] INFO  ozone.MiniOzoneHAClusterImpl (MiniOzoneHAClusterImpl.java:stop(298)) - Stopping the OzoneManager omNode-1
2021-10-05 13:26:06,311 [Listener at 127.0.0.1/10516] INFO  om.OzoneManager (OzoneManager.java:stop(1644)) - Stopping Ozone Manager
2021-10-05 13:26:06,315 [Listener at 127.0.0.1/10516] INFO  ipc.Server (Server.java:stop(3414)) - Stopping server on 10516
2021-10-05 13:26:06,364 [IPC Server listener on 10516] INFO  ipc.Server (Server.java:run(1376)) - Stopping IPC Server listener on 10516
2021-10-05 13:26:06,364 [IPC Server Responder] INFO  ipc.Server (Server.java:run(1512)) - Stopping IPC Server Responder
2021-10-05 13:26:06,364 [Listener at 127.0.0.1/10516] INFO  server.RaftServer (RaftServerProxy.java:lambda$close$6(391)) - omNode-1: close
2021-10-05 13:26:06,365 [Listener at 127.0.0.1/10516] INFO  server.RaftServer$Division (RaftServerImpl.java:lambda$close$4(407)) - omNode-1@group-523986131536: shutdown
2021-10-05 13:26:06,365 [Listener at 127.0.0.1/10516] INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-523986131536,id=omNode-1
2021-10-05 13:26:06,365 [Listener at 127.0.0.1/10516] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(91)) - omNode-1: shutdown omNode-1@group-523986131536-LeaderStateImpl
2021-10-05 13:26:06,365 [Listener at 127.0.0.1/10516] INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(282)) - omNode-1@group-523986131536-PendingRequests: sendNotLeaderResponses
2021-10-05 13:26:06,371 [Listener at 127.0.0.1/10516] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(149)) - omNode-1@group-523986131536-StateMachineUpdater: set stopIndex = 0
2021-10-05 13:26:06,373 [omNode-1@group-523986131536-StateMachineUpdater] INFO  ratis.OzoneManagerStateMachine (OzoneManagerStateMachine.java:takeSnapshot(417)) - Current Snapshot Index (t:1, i:0)
2021-10-05 13:26:06,373 [omNode-1@group-523986131536-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:takeSnapshot(281)) - omNode-1@group-523986131536-StateMachineUpdater: Took a snapshot at index 0
2021-10-05 13:26:06,373 [omNode-1@group-523986131536-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:lambda$new$0(89)) - omNode-1@group-523986131536-StateMachineUpdater: snapshotIndex: updateIncreasingly -1 -> 0
2021-10-05 13:26:06,373 [omNode-1@group-523986131536-StateMachineUpdater] INFO  ratis.OzoneManagerStateMachine (OzoneManagerStateMachine.java:close(471)) - StateMachine has shutdown. Shutdown OzoneManager if not already shutdown.
2021-10-05 13:26:06,373 [Listener at 127.0.0.1/10516] INFO  server.RaftServer$Division (ServerState.java:close(419)) - omNode-1@group-523986131536: closes. applyIndex: 0
2021-10-05 13:26:06,373 [omNode-1@group-523986131536-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:run(327)) - omNode-1@group-523986131536-SegmentedRaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2021-10-05 13:26:06,375 [Listener at 127.0.0.1/10516] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:close(237)) - omNode-1@group-523986131536-SegmentedRaftLogWorker close()
2021-10-05 13:26:06,377 [Listener at 127.0.0.1/10516] INFO  server.GrpcService (GrpcService.java:closeImpl(262)) - omNode-1: shutdown server with port 10520 now
2021-10-05 13:26:06,377 [Listener at 127.0.0.1/10516] INFO  server.GrpcService (GrpcService.java:closeImpl(271)) - omNode-1: shutdown server with port 10520 successfully
2021-10-05 13:26:06,378 [org.apache.ratis.util.JvmPauseMonitor$$Lambda$499/1586779822@37107ea0] INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(109)) - JvmPauseMonitor-omNode-1: Stopped
2021-10-05 13:26:06,378 [Listener at 127.0.0.1/10516] INFO  ratis.OzoneManagerDoubleBuffer (OzoneManagerDoubleBuffer.java:stop(437)) - Stopping OMDoubleBuffer flush thread
2021-10-05 13:26:06,378 [OMDoubleBufferFlushThread] INFO  ratis.OzoneManagerDoubleBuffer (OzoneManagerDoubleBuffer.java:flushTransactions(356)) - OMDoubleBuffer flush thread OMDoubleBufferFlushThread is interrupted and will exit. OMDoubleBufferFlushThread
2021-10-05 13:26:06,378 [Listener at 127.0.0.1/10516] INFO  utils.BackgroundService (BackgroundService.java:shutdown(132)) - Shutting down service KeyDeletingService
2021-10-05 13:26:06,379 [Listener at 127.0.0.1/10516] INFO  utils.BackgroundService (BackgroundService.java:shutdown(132)) - Shutting down service DirectoryDeletingService
2021-10-05 13:26:06,386 [Listener at 127.0.0.1/10516] INFO  handler.ContextHandler (ContextHandler.java:doStop(1153)) - Stopped o.e.j.w.WebAppContext@79b5a9e6{ozoneManager,/,null,STOPPED}{file:/home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-classes/webapps/ozoneManager}
2021-10-05 13:26:06,390 [Listener at 127.0.0.1/10516] INFO  server.AbstractConnector (AbstractConnector.java:doStop(381)) - Stopped ServerConnector@2fdece0e{HTTP/1.1, (http/1.1)}{0.0.0.0:10518}
2021-10-05 13:26:06,390 [Listener at 127.0.0.1/10516] INFO  server.session (HouseKeeper.java:stopScavenging(149)) - node0 Stopped scavenging
2021-10-05 13:26:06,390 [Listener at 127.0.0.1/10516] INFO  handler.ContextHandler (ContextHandler.java:doStop(1153)) - Stopped o.e.j.s.ServletContextHandler@305c8bf{static,/static,file:///home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-classes/webapps/static,STOPPED}
2021-10-05 13:26:06,391 [Listener at 127.0.0.1/10516] INFO  handler.ContextHandler (ContextHandler.java:doStop(1153)) - Stopped o.e.j.s.ServletContextHandler@6b86a5a4{logs,/logs,file:///home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/log,STOPPED}
2021-10-05 13:26:06,395 [Listener at 127.0.0.1/10516] INFO  ozone.MiniOzoneHAClusterImpl (MiniOzoneHAClusterImpl.java:stop(306)) - Stopping the StorageContainerManager 61371ea4-f7c9-4e51-8ebe-bd324b8103e3
2021-10-05 13:26:06,395 [Listener at 127.0.0.1/10516] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1395)) - Stopping Container Balancer service.
2021-10-05 13:26:06,395 [Listener at 127.0.0.1/10516] INFO  balancer.ContainerBalancer (ContainerBalancer.java:stop(742)) - Container Balancer is not running.
2021-10-05 13:26:06,395 [Listener at 127.0.0.1/10516] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1402)) - Stopping Replication Manager Service.
2021-10-05 13:26:06,395 [Listener at 127.0.0.1/10516] INFO  container.ReplicationManager (ReplicationManager.java:stop(350)) - Stopping Replication Monitor Thread.
2021-10-05 13:26:06,395 [Listener at 127.0.0.1/10516] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1409)) - Stopping the Datanode Admin Monitor.
2021-10-05 13:26:06,396 [Listener at 127.0.0.1/10516] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1416)) - Stopping Lease Manager of the command watchers
2021-10-05 13:26:06,396 [Listener at 127.0.0.1/10516] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1423)) - Stopping datanode service RPC server
2021-10-05 13:26:06,396 [Listener at 127.0.0.1/10516] INFO  server.SCMDatanodeProtocolServer (SCMDatanodeProtocolServer.java:stop(389)) - Stopping the RPC server for DataNodes
2021-10-05 13:26:06,396 [Listener at 127.0.0.1/10516] INFO  ipc.Server (Server.java:stop(3414)) - Stopping server on 12121
2021-10-05 13:26:06,412 [IPC Server listener on 12121] INFO  ipc.Server (Server.java:run(1376)) - Stopping IPC Server listener on 12121
2021-10-05 13:26:06,418 [EndpointStateMachine task thread for /127.0.0.1:12121 - 0 ] WARN  statemachine.EndpointStateMachine (EndpointStateMachine.java:logIfNeeded(236)) - Unable to communicate to SCM server at 127.0.0.1:12121 for past 0 seconds.
java.io.EOFException: End of File Exception between local host is: "fv-az270-324/10.1.0.10"; destination host is: "localhost":12121; : java.io.EOFException; For more details see:  http://wiki.apache.org/hadoop/EOFException
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.hadoop.net.NetUtils.wrapWithMessage(NetUtils.java:913)
	at org.apache.hadoop.net.NetUtils.wrapException(NetUtils.java:862)
	at org.apache.hadoop.ipc.Client.getRpcResponse(Client.java:1577)
	at org.apache.hadoop.ipc.Client.call(Client.java:1519)
	at org.apache.hadoop.ipc.Client.call(Client.java:1416)
	at org.apache.hadoop.ipc.ProtobufRpcEngine$Invoker.invoke(ProtobufRpcEngine.java:236)
	at org.apache.hadoop.ipc.ProtobufRpcEngine$Invoker.invoke(ProtobufRpcEngine.java:123)
	at com.sun.proxy.$Proxy48.submitRequest(Unknown Source)
	at org.apache.hadoop.ozone.protocolPB.StorageContainerDatanodeProtocolClientSideTranslatorPB.submitRequest(StorageContainerDatanodeProtocolClientSideTranslatorPB.java:117)
	at org.apache.hadoop.ozone.protocolPB.StorageContainerDatanodeProtocolClientSideTranslatorPB.sendHeartbeat(StorageContainerDatanodeProtocolClientSideTranslatorPB.java:149)
	at org.apache.hadoop.ozone.container.common.states.endpoint.HeartbeatEndpointTask.call(HeartbeatEndpointTask.java:179)
	at org.apache.hadoop.ozone.container.common.states.endpoint.HeartbeatEndpointTask.call(HeartbeatEndpointTask.java:82)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.io.EOFException
	at java.io.DataInputStream.readInt(DataInputStream.java:392)
	at org.apache.hadoop.ipc.Client$IpcStreams.readResponse(Client.java:1892)
	at org.apache.hadoop.ipc.Client$Connection.receiveRpcResponse(Client.java:1202)
	at org.apache.hadoop.ipc.Client$Connection.run(Client.java:1098)
2021-10-05 13:26:06,418 [IPC Server Responder] INFO  ipc.Server (Server.java:run(1512)) - Stopping IPC Server Responder
2021-10-05 13:26:06,432 [106bb174-548c-482f-98a0-a37141c57762@group-C784995F1F78-FollowerState] INFO  impl.FollowerState (FollowerState.java:run(134)) - 106bb174-548c-482f-98a0-a37141c57762@group-C784995F1F78-FollowerState: change to CANDIDATE, lastRpcElapsedTime:5039727037ns, electionTimeout:5039ms
2021-10-05 13:26:06,432 [106bb174-548c-482f-98a0-a37141c57762@group-C784995F1F78-FollowerState] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(108)) - 106bb174-548c-482f-98a0-a37141c57762: shutdown 106bb174-548c-482f-98a0-a37141c57762@group-C784995F1F78-FollowerState
2021-10-05 13:26:06,432 [106bb174-548c-482f-98a0-a37141c57762@group-C784995F1F78-FollowerState] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(285)) - 106bb174-548c-482f-98a0-a37141c57762@group-C784995F1F78: changes role from  FOLLOWER to CANDIDATE at term 1 for changeToCandidate
2021-10-05 13:26:06,432 [106bb174-548c-482f-98a0-a37141c57762@group-C784995F1F78-FollowerState] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.leaderelection.pre-vote = false (custom)
2021-10-05 13:26:06,433 [106bb174-548c-482f-98a0-a37141c57762@group-C784995F1F78-FollowerState] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(130)) - 106bb174-548c-482f-98a0-a37141c57762: start 106bb174-548c-482f-98a0-a37141c57762@group-C784995F1F78-LeaderElection38
2021-10-05 13:26:06,455 [106bb174-548c-482f-98a0-a37141c57762@group-C784995F1F78-LeaderElection38] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(306)) - 106bb174-548c-482f-98a0-a37141c57762@group-C784995F1F78-LeaderElection38 ELECTION round 0: submit vote requests at term 2 for -1: [2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc|rpc:127.0.0.1:45481|dataStream:|priority:0, c2216084-e141-4b27-afe8-b6c5968528ec|rpc:127.0.0.1:39195|dataStream:|priority:0, 106bb174-548c-482f-98a0-a37141c57762|rpc:127.0.0.1:43635|dataStream:|priority:1], old=null
2021-10-05 13:26:06,472 [grpc-default-executor-4] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1043)) - 2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc@group-C784995F1F78: receive requestVote(ELECTION, 106bb174-548c-482f-98a0-a37141c57762, group-C784995F1F78, 2, (t:0, i:0))
2021-10-05 13:26:06,472 [grpc-default-executor-4] INFO  impl.VoteContext (VoteContext.java:log(48)) - 2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc@group-C784995F1F78-FOLLOWER: accept ELECTION from 106bb174-548c-482f-98a0-a37141c57762: our priority 0 <= candidate's priority 1
2021-10-05 13:26:06,472 [grpc-default-executor-4] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(285)) - 2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc@group-C784995F1F78: changes role from  FOLLOWER to FOLLOWER at term 2 for candidate:106bb174-548c-482f-98a0-a37141c57762
2021-10-05 13:26:06,472 [grpc-default-executor-4] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(108)) - 2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc: shutdown 2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc@group-C784995F1F78-FollowerState
2021-10-05 13:26:06,477 [grpc-default-executor-4] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(130)) - 2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc: start 2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc@group-C784995F1F78-FollowerState
2021-10-05 13:26:06,477 [2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc@group-C784995F1F78-FollowerState] INFO  impl.FollowerState (FollowerState.java:run(143)) - 2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc@group-C784995F1F78-FollowerState was interrupted: {}
java.lang.InterruptedException: sleep interrupted
	at java.lang.Thread.sleep(Native Method)
	at java.lang.Thread.sleep(Thread.java:340)
	at java.util.concurrent.TimeUnit.sleep(TimeUnit.java:386)
	at org.apache.ratis.util.TimeDuration.sleep(TimeDuration.java:324)
	at org.apache.ratis.util.TimeDuration.sleep(TimeDuration.java:309)
	at org.apache.ratis.server.impl.FollowerState.run(FollowerState.java:118)
2021-10-05 13:26:06,486 [grpc-default-executor-4] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1075)) - 2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc@group-C784995F1F78 replies to ELECTION vote request: 106bb174-548c-482f-98a0-a37141c57762<-2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc#0:OK-t2. Peer's state: 2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc@group-C784995F1F78:t2, leader=null, voted=106bb174-548c-482f-98a0-a37141c57762, raftlog=2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc@group-C784995F1F78-SegmentedRaftLog:OPENED:c-1,f-1,i0, conf=-1: [2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc|rpc:127.0.0.1:45481|priority:0, c2216084-e141-4b27-afe8-b6c5968528ec|rpc:127.0.0.1:39195|priority:0, 106bb174-548c-482f-98a0-a37141c57762|rpc:127.0.0.1:43635|priority:1], old=null
2021-10-05 13:26:06,495 [106bb174-548c-482f-98a0-a37141c57762@group-C784995F1F78-LeaderElection38] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(89)) - 106bb174-548c-482f-98a0-a37141c57762@group-C784995F1F78-LeaderElection38: ELECTION PASSED received 1 response(s) and 0 exception(s):
2021-10-05 13:26:06,495 [106bb174-548c-482f-98a0-a37141c57762@group-C784995F1F78-LeaderElection38] INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(93)) -   Response 0: 106bb174-548c-482f-98a0-a37141c57762<-2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc#0:OK-t2
2021-10-05 13:26:06,495 [106bb174-548c-482f-98a0-a37141c57762@group-C784995F1F78-LeaderElection38] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(308)) - 106bb174-548c-482f-98a0-a37141c57762@group-C784995F1F78-LeaderElection38 ELECTION round 0: result PASSED
2021-10-05 13:26:06,495 [106bb174-548c-482f-98a0-a37141c57762@group-C784995F1F78-LeaderElection38] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(121)) - 106bb174-548c-482f-98a0-a37141c57762: shutdown 106bb174-548c-482f-98a0-a37141c57762@group-C784995F1F78-LeaderElection38
2021-10-05 13:26:06,495 [106bb174-548c-482f-98a0-a37141c57762@group-C784995F1F78-LeaderElection38] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(285)) - 106bb174-548c-482f-98a0-a37141c57762@group-C784995F1F78: changes role from CANDIDATE to LEADER at term 2 for changeToLeader
2021-10-05 13:26:06,495 [106bb174-548c-482f-98a0-a37141c57762@group-C784995F1F78-LeaderElection38] INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:handleLeaderChangedNotification(861)) - Leader change notification received for group: group-C784995F1F78 with new leaderId: 106bb174-548c-482f-98a0-a37141c57762
2021-10-05 13:26:06,495 [106bb174-548c-482f-98a0-a37141c57762@group-C784995F1F78-LeaderElection38] INFO  server.RaftServer$Division (ServerState.java:setLeader(285)) - 106bb174-548c-482f-98a0-a37141c57762@group-C784995F1F78: change Leader from null to 106bb174-548c-482f-98a0-a37141c57762 at term 2 for becomeLeader, leader elected after 10288ms
2021-10-05 13:26:06,495 [106bb174-548c-482f-98a0-a37141c57762@group-C784995F1F78-LeaderElection38] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.staging.catchup.gap = 1000 (default)
2021-10-05 13:26:06,495 [106bb174-548c-482f-98a0-a37141c57762@group-C784995F1F78-LeaderElection38] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.write.element-limit = 1024 (custom)
2021-10-05 13:26:06,496 [106bb174-548c-482f-98a0-a37141c57762@group-C784995F1F78-LeaderElection38] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.write.byte-limit = 1024 M (=1073741824) (custom)
2021-10-05 13:26:06,496 [106bb174-548c-482f-98a0-a37141c57762@group-C784995F1F78-LeaderElection38] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.watch.timeout = 180s (custom)
2021-10-05 13:26:06,496 [106bb174-548c-482f-98a0-a37141c57762@group-C784995F1F78-LeaderElection38] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.watch.timeout.denomination = 1s (default)
2021-10-05 13:26:06,496 [106bb174-548c-482f-98a0-a37141c57762@group-C784995F1F78-LeaderElection38] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.watch.element-limit = 65536 (default)
2021-10-05 13:26:06,496 [106bb174-548c-482f-98a0-a37141c57762@group-C784995F1F78-LeaderElection38] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2021-10-05 13:26:06,496 [106bb174-548c-482f-98a0-a37141c57762@group-C784995F1F78-LeaderElection38] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2021-10-05 13:26:06,496 [106bb174-548c-482f-98a0-a37141c57762@group-C784995F1F78-LeaderElection38] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.appender.buffer.element-limit = 1 (custom)
2021-10-05 13:26:06,496 [106bb174-548c-482f-98a0-a37141c57762@group-C784995F1F78-LeaderElection38] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(44)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2021-10-05 13:26:06,496 [106bb174-548c-482f-98a0-a37141c57762@group-C784995F1F78-LeaderElection38] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.request.timeout = 60s (custom)
2021-10-05 13:26:06,496 [106bb174-548c-482f-98a0-a37141c57762@group-C784995F1F78-LeaderElection38] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.appender.install.snapshot.enabled = false (custom)
2021-10-05 13:26:06,497 [106bb174-548c-482f-98a0-a37141c57762@group-C784995F1F78-LeaderElection38] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2021-10-05 13:26:06,497 [106bb174-548c-482f-98a0-a37141c57762@group-C784995F1F78-LeaderElection38] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2021-10-05 13:26:06,497 [106bb174-548c-482f-98a0-a37141c57762@group-C784995F1F78-LeaderElection38] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.appender.buffer.element-limit = 1 (custom)
2021-10-05 13:26:06,497 [106bb174-548c-482f-98a0-a37141c57762@group-C784995F1F78-LeaderElection38] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(44)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2021-10-05 13:26:06,497 [106bb174-548c-482f-98a0-a37141c57762@group-C784995F1F78-LeaderElection38] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.request.timeout = 60s (custom)
2021-10-05 13:26:06,497 [106bb174-548c-482f-98a0-a37141c57762@group-C784995F1F78-LeaderElection38] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.appender.install.snapshot.enabled = false (custom)
2021-10-05 13:26:06,499 [EventQueue-PipelineReportForPipelineReportHandler] INFO  pipeline.PipelineManagerImpl (PipelineManagerImpl.java:openPipeline(282)) - Pipeline Pipeline[ Id: 695b8808-dd40-42c0-a85d-c784995f1f78, Nodes: 106bb174-548c-482f-98a0-a37141c57762{ip: 127.0.0.1, host: localhost, ports: [REPLICATION=38747, RATIS=43635, RATIS_ADMIN=43635, RATIS_SERVER=43635, STANDALONE=45889], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}c2216084-e141-4b27-afe8-b6c5968528ec{ip: 127.0.0.1, host: localhost, ports: [REPLICATION=45329, RATIS=39195, RATIS_ADMIN=39195, RATIS_SERVER=39195, STANDALONE=37211], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc{ip: 127.0.0.1, host: localhost, ports: [REPLICATION=42707, RATIS=45481, RATIS_ADMIN=45481, RATIS_SERVER=45481, STANDALONE=42383], networkLocation: /default-rack, certSerialId: null, persistedOpState: IN_SERVICE, persistedOpStateExpiryEpochSec: 0}, ReplicationConfig: RATIS/THREE, State:ALLOCATED, leaderId:106bb174-548c-482f-98a0-a37141c57762, CreationTimestamp2021-10-05T13:25:53.654Z[Etc/UTC]] moved to OPEN state
2021-10-05 13:26:06,499 [EventQueue-PipelineReportForPipelineReportHandler] INFO  ha.SCMHAInvocationHandler (SCMHAInvocationHandler.java:invokeRatis(113)) - Invoking method public abstract void org.apache.hadoop.hdds.scm.pipeline.PipelineStateManager.updatePipelineState(org.apache.hadoop.hdds.protocol.proto.HddsProtos$PipelineID,org.apache.hadoop.hdds.protocol.proto.HddsProtos$PipelineState) throws java.io.IOException on target org.apache.hadoop.hdds.scm.ha.SCMRatisServerImpl@1ffe502, cost 194.219us
2021-10-05 13:26:06,501 [106bb174-548c-482f-98a0-a37141c57762@group-C784995F1F78-LeaderElection38] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(130)) - 106bb174-548c-482f-98a0-a37141c57762: start 106bb174-548c-482f-98a0-a37141c57762@group-C784995F1F78-LeaderStateImpl
2021-10-05 13:26:06,502 [106bb174-548c-482f-98a0-a37141c57762@group-C784995F1F78-LeaderElection38] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:startLogSegment(394)) - 106bb174-548c-482f-98a0-a37141c57762@group-C784995F1F78-SegmentedRaftLogWorker: Starting segment from index:0
2021-10-05 13:26:06,503 [grpc-default-executor-2] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1043)) - c2216084-e141-4b27-afe8-b6c5968528ec@group-C784995F1F78: receive requestVote(ELECTION, 106bb174-548c-482f-98a0-a37141c57762, group-C784995F1F78, 2, (t:0, i:0))
2021-10-05 13:26:06,505 [grpc-default-executor-2] INFO  impl.VoteContext (VoteContext.java:log(48)) - c2216084-e141-4b27-afe8-b6c5968528ec@group-C784995F1F78-FOLLOWER: accept ELECTION from 106bb174-548c-482f-98a0-a37141c57762: our priority 0 <= candidate's priority 1
2021-10-05 13:26:06,505 [grpc-default-executor-2] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(285)) - c2216084-e141-4b27-afe8-b6c5968528ec@group-C784995F1F78: changes role from  FOLLOWER to FOLLOWER at term 2 for candidate:106bb174-548c-482f-98a0-a37141c57762
2021-10-05 13:26:06,505 [grpc-default-executor-2] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(108)) - c2216084-e141-4b27-afe8-b6c5968528ec: shutdown c2216084-e141-4b27-afe8-b6c5968528ec@group-C784995F1F78-FollowerState
2021-10-05 13:26:06,505 [grpc-default-executor-2] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(130)) - c2216084-e141-4b27-afe8-b6c5968528ec: start c2216084-e141-4b27-afe8-b6c5968528ec@group-C784995F1F78-FollowerState
2021-10-05 13:26:06,505 [c2216084-e141-4b27-afe8-b6c5968528ec@group-C784995F1F78-FollowerState] INFO  impl.FollowerState (FollowerState.java:run(143)) - c2216084-e141-4b27-afe8-b6c5968528ec@group-C784995F1F78-FollowerState was interrupted: {}
java.lang.InterruptedException: sleep interrupted
	at java.lang.Thread.sleep(Native Method)
	at java.lang.Thread.sleep(Thread.java:340)
	at java.util.concurrent.TimeUnit.sleep(TimeUnit.java:386)
	at org.apache.ratis.util.TimeDuration.sleep(TimeDuration.java:324)
	at org.apache.ratis.util.TimeDuration.sleep(TimeDuration.java:309)
	at org.apache.ratis.server.impl.FollowerState.run(FollowerState.java:118)
2021-10-05 13:26:06,510 [grpc-default-executor-0] INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:handleLeaderChangedNotification(861)) - Leader change notification received for group: group-C784995F1F78 with new leaderId: 106bb174-548c-482f-98a0-a37141c57762
2021-10-05 13:26:06,510 [grpc-default-executor-0] INFO  server.RaftServer$Division (ServerState.java:setLeader(285)) - 2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc@group-C784995F1F78: change Leader from null to 106bb174-548c-482f-98a0-a37141c57762 at term 2 for appendEntries, leader elected after 10333ms
2021-10-05 13:26:06,516 [106bb174-548c-482f-98a0-a37141c57762@group-C784995F1F78-LeaderElection38] INFO  server.RaftServer$Division (ServerState.java:setRaftConf(387)) - 106bb174-548c-482f-98a0-a37141c57762@group-C784995F1F78: set configuration 0: [2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc|rpc:127.0.0.1:45481|dataStream:|priority:0, c2216084-e141-4b27-afe8-b6c5968528ec|rpc:127.0.0.1:39195|dataStream:|priority:0, 106bb174-548c-482f-98a0-a37141c57762|rpc:127.0.0.1:43635|dataStream:|priority:1], old=null
2021-10-05 13:26:06,527 [106bb174-548c-482f-98a0-a37141c57762@group-C784995F1F78-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(601)) - 106bb174-548c-482f-98a0-a37141c57762@group-C784995F1F78-SegmentedRaftLogWorker: created new log segment /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-62d231c0-d845-4dcd-88aa-c082e017c57e/datanode-1/data/ratis/695b8808-dd40-42c0-a85d-c784995f1f78/current/log_inprogress_0
2021-10-05 13:26:06,544 [grpc-default-executor-2] INFO  server.RaftServer$Division (RaftServerImpl.java:requestVote(1075)) - c2216084-e141-4b27-afe8-b6c5968528ec@group-C784995F1F78 replies to ELECTION vote request: 106bb174-548c-482f-98a0-a37141c57762<-c2216084-e141-4b27-afe8-b6c5968528ec#0:OK-t2. Peer's state: c2216084-e141-4b27-afe8-b6c5968528ec@group-C784995F1F78:t2, leader=null, voted=106bb174-548c-482f-98a0-a37141c57762, raftlog=c2216084-e141-4b27-afe8-b6c5968528ec@group-C784995F1F78-SegmentedRaftLog:OPENED:c-1,f-1,i0, conf=-1: [2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc|rpc:127.0.0.1:45481|dataStream:|priority:0, c2216084-e141-4b27-afe8-b6c5968528ec|rpc:127.0.0.1:39195|dataStream:|priority:0, 106bb174-548c-482f-98a0-a37141c57762|rpc:127.0.0.1:43635|dataStream:|priority:1], old=null
2021-10-05 13:26:06,562 [grpc-default-executor-0] INFO  server.RaftServer$Division (ServerState.java:setRaftConf(387)) - 2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc@group-C784995F1F78: set configuration 0: [2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc|rpc:127.0.0.1:45481|dataStream:|priority:0, c2216084-e141-4b27-afe8-b6c5968528ec|rpc:127.0.0.1:39195|dataStream:|priority:0, 106bb174-548c-482f-98a0-a37141c57762|rpc:127.0.0.1:43635|dataStream:|priority:1], old=null
2021-10-05 13:26:06,562 [grpc-default-executor-0] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:startLogSegment(394)) - 2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc@group-C784995F1F78-SegmentedRaftLogWorker: Starting segment from index:0
2021-10-05 13:26:06,568 [grpc-default-executor-4] INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:handleLeaderChangedNotification(861)) - Leader change notification received for group: group-C784995F1F78 with new leaderId: 106bb174-548c-482f-98a0-a37141c57762
2021-10-05 13:26:06,568 [grpc-default-executor-4] INFO  server.RaftServer$Division (ServerState.java:setLeader(285)) - c2216084-e141-4b27-afe8-b6c5968528ec@group-C784995F1F78: change Leader from null to 106bb174-548c-482f-98a0-a37141c57762 at term 2 for appendEntries, leader elected after 10232ms
2021-10-05 13:26:06,569 [2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc@group-C784995F1F78-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(601)) - 2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc@group-C784995F1F78-SegmentedRaftLogWorker: created new log segment /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-62d231c0-d845-4dcd-88aa-c082e017c57e/datanode-0/data/ratis/695b8808-dd40-42c0-a85d-c784995f1f78/current/log_inprogress_0
2021-10-05 13:26:06,604 [grpc-default-executor-0] INFO  server.RaftServer$Division (ServerState.java:setRaftConf(387)) - c2216084-e141-4b27-afe8-b6c5968528ec@group-C784995F1F78: set configuration 0: [2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc|rpc:127.0.0.1:45481|dataStream:|priority:0, c2216084-e141-4b27-afe8-b6c5968528ec|rpc:127.0.0.1:39195|dataStream:|priority:0, 106bb174-548c-482f-98a0-a37141c57762|rpc:127.0.0.1:43635|dataStream:|priority:1], old=null
2021-10-05 13:26:06,604 [grpc-default-executor-0] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:startLogSegment(394)) - c2216084-e141-4b27-afe8-b6c5968528ec@group-C784995F1F78-SegmentedRaftLogWorker: Starting segment from index:0
2021-10-05 13:26:06,606 [c2216084-e141-4b27-afe8-b6c5968528ec@group-C784995F1F78-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(601)) - c2216084-e141-4b27-afe8-b6c5968528ec@group-C784995F1F78-SegmentedRaftLogWorker: created new log segment /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-62d231c0-d845-4dcd-88aa-c082e017c57e/datanode-2/data/ratis/695b8808-dd40-42c0-a85d-c784995f1f78/current/log_inprogress_0
2021-10-05 13:26:06,696 [SCM Heartbeat Processing Thread - 0] WARN  node.NodeStateManager (NodeStateManager.java:scheduleNextHealthCheck(799)) - Current Thread is interrupted, shutting down HB processing thread for Node Manager.
2021-10-05 13:26:06,698 [Listener at 127.0.0.1/10516] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1431)) - Stopping block service RPC server
2021-10-05 13:26:06,698 [Listener at 127.0.0.1/10516] INFO  server.SCMBlockProtocolServer (SCMBlockProtocolServer.java:stop(160)) - Stopping the RPC server for Block Protocol
2021-10-05 13:26:06,699 [Listener at 127.0.0.1/10516] INFO  ipc.Server (Server.java:stop(3414)) - Stopping server on 12122
2021-10-05 13:26:06,710 [IPC Server Responder] INFO  ipc.Server (Server.java:run(1512)) - Stopping IPC Server Responder
2021-10-05 13:26:06,710 [Listener at 127.0.0.1/10516] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1438)) - Stopping the StorageContainerLocationProtocol RPC server
2021-10-05 13:26:06,710 [Listener at 127.0.0.1/10516] INFO  server.SCMClientProtocolServer (SCMClientProtocolServer.java:stop(173)) - Stopping the RPC server for Client Protocol
2021-10-05 13:26:06,710 [Listener at 127.0.0.1/10516] INFO  ipc.Server (Server.java:stop(3414)) - Stopping server on 12123
2021-10-05 13:26:06,711 [IPC Server listener on 12122] INFO  ipc.Server (Server.java:run(1376)) - Stopping IPC Server listener on 12122
2021-10-05 13:26:06,720 [IPC Server listener on 12123] INFO  ipc.Server (Server.java:run(1376)) - Stopping IPC Server listener on 12123
2021-10-05 13:26:06,726 [Listener at 127.0.0.1/10516] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1445)) - Stopping Storage Container Manager HTTP server.
2021-10-05 13:26:06,727 [Listener at 127.0.0.1/10516] INFO  handler.ContextHandler (ContextHandler.java:doStop(1153)) - Stopped o.e.j.w.WebAppContext@151f0053{scm,/,null,STOPPED}{file:/home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-classes/webapps/scm}
2021-10-05 13:26:06,727 [IPC Server Responder] INFO  ipc.Server (Server.java:run(1512)) - Stopping IPC Server Responder
2021-10-05 13:26:06,727 [Listener at 127.0.0.1/10516] INFO  server.AbstractConnector (AbstractConnector.java:doStop(381)) - Stopped ServerConnector@535b24b5{HTTP/1.1, (http/1.1)}{0.0.0.0:12118}
2021-10-05 13:26:06,728 [Listener at 127.0.0.1/10516] INFO  server.session (HouseKeeper.java:stopScavenging(149)) - node0 Stopped scavenging
2021-10-05 13:26:06,728 [Listener at 127.0.0.1/10516] INFO  handler.ContextHandler (ContextHandler.java:doStop(1153)) - Stopped o.e.j.s.ServletContextHandler@45d9fe80{static,/static,file:///home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-classes/webapps/static,STOPPED}
2021-10-05 13:26:06,728 [Listener at 127.0.0.1/10516] INFO  handler.ContextHandler (ContextHandler.java:doStop(1153)) - Stopped o.e.j.s.ServletContextHandler@4770430{logs,/logs,file:///home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/log,STOPPED}
2021-10-05 13:26:06,729 [Listener at 127.0.0.1/10516] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1456)) - Stopping Block Manager Service.
2021-10-05 13:26:06,729 [Listener at 127.0.0.1/10516] INFO  utils.BackgroundService (BackgroundService.java:shutdown(132)) - Shutting down service SCMBlockDeletingService
2021-10-05 13:26:06,729 [Listener at 127.0.0.1/10516] INFO  utils.BackgroundService (BackgroundService.java:shutdown(132)) - Shutting down service SCMBlockDeletingService
2021-10-05 13:26:06,729 [Listener at 127.0.0.1/10516] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1483)) - Stopping SCM Event Queue.
2021-10-05 13:26:06,731 [Listener at 127.0.0.1/10516] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1494)) - Stopping SCM HA services.
2021-10-05 13:26:06,731 [Listener at 127.0.0.1/10516] INFO  ha.SCMRatisServerImpl (SCMRatisServerImpl.java:stop(236)) - stopping ratis server 0.0.0.0:12120
2021-10-05 13:26:06,732 [Listener at 127.0.0.1/10516] INFO  server.RaftServer (RaftServerProxy.java:lambda$close$6(391)) - 61371ea4-f7c9-4e51-8ebe-bd324b8103e3: close
2021-10-05 13:26:06,732 [Listener at 127.0.0.1/10516] INFO  server.RaftServer$Division (RaftServerImpl.java:lambda$close$4(407)) - 61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E: shutdown
2021-10-05 13:26:06,732 [Listener at 127.0.0.1/10516] INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-C082E017C57E,id=61371ea4-f7c9-4e51-8ebe-bd324b8103e3
2021-10-05 13:26:06,732 [Listener at 127.0.0.1/10516] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(91)) - 61371ea4-f7c9-4e51-8ebe-bd324b8103e3: shutdown 61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-LeaderStateImpl
2021-10-05 13:26:06,733 [61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E->b915fa46-3b5f-4935-be53-c7cfdbb15e4b-GrpcLogAppender-LogAppenderDaemon] WARN  server.GrpcLogAppender (GrpcLogAppender.java:mayWait(175)) - 61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E->b915fa46-3b5f-4935-be53-c7cfdbb15e4b-GrpcLogAppender: Wait interrupted by java.lang.InterruptedException
2021-10-05 13:26:06,733 [Listener at 127.0.0.1/10516] INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(282)) - 61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-PendingRequests: sendNotLeaderResponses
2021-10-05 13:26:06,733 [Listener at 127.0.0.1/10516] INFO  ha.SCMStateMachine (SCMStateMachine.java:notifyNotLeader(183)) - current leader SCM steps down.
2021-10-05 13:26:06,733 [Listener at 127.0.0.1/10516] INFO  ha.SCMContext (SCMContext.java:updateLeaderAndTerm(88)) - update <isLeader,term> from <true,2> to <false,0>
2021-10-05 13:26:06,733 [Listener at 127.0.0.1/10516] INFO  ha.SCMContext (SCMContext.java:updateLeaderAndTerm(95)) - update <isLeaderReady> from <false> to <false>
2021-10-05 13:26:06,733 [grpc-default-executor-0] INFO  server.GrpcServerProtocolService (GrpcServerProtocolService.java:onCompleted(140)) - b915fa46-3b5f-4935-be53-c7cfdbb15e4b: Completed APPEND_ENTRIES, lastRequest: 61371ea4-f7c9-4e51-8ebe-bd324b8103e3->b915fa46-3b5f-4935-be53-c7cfdbb15e4b#1338-t2,previous=(t:2, i:101),leaderCommit=101,initializing? true,entries: size=1, first=(t:2, i:102), METADATAENTRY(c:101)
2021-10-05 13:26:06,740 [grpc-default-executor-4] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onCompleted(344)) - 61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E->b915fa46-3b5f-4935-be53-c7cfdbb15e4b-AppendLogResponseHandler: follower responses appendEntries COMPLETED
2021-10-05 13:26:06,740 [grpc-default-executor-4] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(46)) - 61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E->b915fa46-3b5f-4935-be53-c7cfdbb15e4b: nextIndex: updateUnconditionally 103 -> 102
2021-10-05 13:26:06,744 [Listener at 127.0.0.1/10516] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(149)) - 61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-StateMachineUpdater: set stopIndex = 102
2021-10-05 13:26:06,745 [61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-StateMachineUpdater] INFO  ha.SCMStateMachine (SCMStateMachine.java:takeSnapshot(290)) - Current Snapshot Index 102, takeSnapshot took 1 ms
2021-10-05 13:26:06,745 [61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:takeSnapshot(281)) - 61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-StateMachineUpdater: Took a snapshot at index 102
2021-10-05 13:26:06,745 [61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:lambda$new$0(89)) - 61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-StateMachineUpdater: snapshotIndex: updateIncreasingly 100 -> 102
2021-10-05 13:26:06,745 [Listener at 127.0.0.1/10516] INFO  server.RaftServer$Division (ServerState.java:close(419)) - 61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E: closes. applyIndex: 102
2021-10-05 13:26:06,746 [61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:run(327)) - 61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-SegmentedRaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2021-10-05 13:26:06,746 [Listener at 127.0.0.1/10516] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:close(237)) - 61371ea4-f7c9-4e51-8ebe-bd324b8103e3@group-C082E017C57E-SegmentedRaftLogWorker close()
2021-10-05 13:26:06,747 [Listener at 127.0.0.1/10516] INFO  server.GrpcService (GrpcService.java:closeImpl(262)) - 61371ea4-f7c9-4e51-8ebe-bd324b8103e3: shutdown server with port 12120 now
2021-10-05 13:26:06,763 [Listener at 127.0.0.1/10516] INFO  server.GrpcService (GrpcService.java:closeImpl(271)) - 61371ea4-f7c9-4e51-8ebe-bd324b8103e3: shutdown server with port 12120 successfully
2021-10-05 13:26:06,763 [org.apache.ratis.util.JvmPauseMonitor$$Lambda$499/1586779822@1abf7c9d] INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(109)) - JvmPauseMonitor-61371ea4-f7c9-4e51-8ebe-bd324b8103e3: Stopped
2021-10-05 13:26:06,765 [Listener at 127.0.0.1/10516] INFO  pipeline.BackgroundPipelineCreator (BackgroundPipelineCreatorV2.java:stop(158)) - Stopping RatisPipelineUtilsThread.
2021-10-05 13:26:06,765 [Listener at 127.0.0.1/10516] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1504)) - Stopping SCM MetadataStore.
2021-10-05 13:26:06,766 [Listener at 127.0.0.1/10516] INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:stop(210)) - Stopping HddsDatanode metrics system...
2021-10-05 13:26:06,789 [EndpointStateMachine task thread for /127.0.0.1:15041 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15041. Already tried 13 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:26:06,795 [prometheus] INFO  impl.MetricsSinkAdapter (MetricsSinkAdapter.java:publishMetricsFromQueue(141)) - prometheus thread interrupted.
2021-10-05 13:26:06,795 [Listener at 127.0.0.1/10516] INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:stop(216)) - HddsDatanode metrics system stopped.
2021-10-05 13:26:06,795 [Listener at 127.0.0.1/10516] INFO  ozone.MiniOzoneHAClusterImpl (MiniOzoneHAClusterImpl.java:stop(306)) - Stopping the StorageContainerManager b915fa46-3b5f-4935-be53-c7cfdbb15e4b
2021-10-05 13:26:06,795 [Listener at 127.0.0.1/10516] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1395)) - Stopping Container Balancer service.
2021-10-05 13:26:06,795 [Listener at 127.0.0.1/10516] INFO  balancer.ContainerBalancer (ContainerBalancer.java:stop(742)) - Container Balancer is not running.
2021-10-05 13:26:06,795 [Listener at 127.0.0.1/10516] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1402)) - Stopping Replication Manager Service.
2021-10-05 13:26:06,795 [Listener at 127.0.0.1/10516] INFO  container.ReplicationManager (ReplicationManager.java:stop(350)) - Stopping Replication Monitor Thread.
2021-10-05 13:26:06,795 [Listener at 127.0.0.1/10516] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1409)) - Stopping the Datanode Admin Monitor.
2021-10-05 13:26:06,796 [Listener at 127.0.0.1/10516] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1416)) - Stopping Lease Manager of the command watchers
2021-10-05 13:26:06,796 [Listener at 127.0.0.1/10516] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1423)) - Stopping datanode service RPC server
2021-10-05 13:26:06,796 [Listener at 127.0.0.1/10516] INFO  server.SCMDatanodeProtocolServer (SCMDatanodeProtocolServer.java:stop(389)) - Stopping the RPC server for DataNodes
2021-10-05 13:26:06,796 [Listener at 127.0.0.1/10516] INFO  ipc.Server (Server.java:stop(3414)) - Stopping server on 12131
2021-10-05 13:26:06,800 [IPC Server Responder] INFO  ipc.Server (Server.java:run(1512)) - Stopping IPC Server Responder
2021-10-05 13:26:06,803 [IPC Server listener on 12131] INFO  ipc.Server (Server.java:run(1376)) - Stopping IPC Server listener on 12131
2021-10-05 13:26:06,831 [SCM Heartbeat Processing Thread - 0] WARN  node.NodeStateManager (NodeStateManager.java:scheduleNextHealthCheck(799)) - Current Thread is interrupted, shutting down HB processing thread for Node Manager.
2021-10-05 13:26:06,832 [Listener at 127.0.0.1/10516] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1431)) - Stopping block service RPC server
2021-10-05 13:26:06,832 [Listener at 127.0.0.1/10516] INFO  server.SCMBlockProtocolServer (SCMBlockProtocolServer.java:stop(160)) - Stopping the RPC server for Block Protocol
2021-10-05 13:26:06,832 [Listener at 127.0.0.1/10516] INFO  ipc.Server (Server.java:stop(3414)) - Stopping server on 12132
2021-10-05 13:26:06,833 [IPC Server Responder] INFO  ipc.Server (Server.java:run(1512)) - Stopping IPC Server Responder
2021-10-05 13:26:06,833 [Listener at 127.0.0.1/10516] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1438)) - Stopping the StorageContainerLocationProtocol RPC server
2021-10-05 13:26:06,833 [Listener at 127.0.0.1/10516] INFO  server.SCMClientProtocolServer (SCMClientProtocolServer.java:stop(173)) - Stopping the RPC server for Client Protocol
2021-10-05 13:26:06,833 [Listener at 127.0.0.1/10516] INFO  ipc.Server (Server.java:stop(3414)) - Stopping server on 12133
2021-10-05 13:26:06,834 [IPC Server listener on 12132] INFO  ipc.Server (Server.java:run(1376)) - Stopping IPC Server listener on 12132
2021-10-05 13:26:06,848 [Listener at 127.0.0.1/10516] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1445)) - Stopping Storage Container Manager HTTP server.
2021-10-05 13:26:06,848 [IPC Server Responder] INFO  ipc.Server (Server.java:run(1512)) - Stopping IPC Server Responder
2021-10-05 13:26:06,849 [Listener at 127.0.0.1/10516] INFO  handler.ContextHandler (ContextHandler.java:doStop(1153)) - Stopped o.e.j.w.WebAppContext@7f710b19{scm,/,null,STOPPED}{file:/home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-classes/webapps/scm}
2021-10-05 13:26:06,850 [Listener at 127.0.0.1/10516] INFO  server.AbstractConnector (AbstractConnector.java:doStop(381)) - Stopped ServerConnector@1b1d9369{HTTP/1.1, (http/1.1)}{0.0.0.0:12128}
2021-10-05 13:26:06,850 [Listener at 127.0.0.1/10516] INFO  server.session (HouseKeeper.java:stopScavenging(149)) - node0 Stopped scavenging
2021-10-05 13:26:06,850 [Listener at 127.0.0.1/10516] INFO  handler.ContextHandler (ContextHandler.java:doStop(1153)) - Stopped o.e.j.s.ServletContextHandler@78c3b3ec{static,/static,file:///home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-classes/webapps/static,STOPPED}
2021-10-05 13:26:06,850 [Listener at 127.0.0.1/10516] INFO  handler.ContextHandler (ContextHandler.java:doStop(1153)) - Stopped o.e.j.s.ServletContextHandler@47f71f50{logs,/logs,file:///home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/log,STOPPED}
2021-10-05 13:26:06,853 [EndpointStateMachine task thread for /127.0.0.1:12131 - 0 ] WARN  statemachine.EndpointStateMachine (EndpointStateMachine.java:logIfNeeded(236)) - Unable to communicate to SCM server at 127.0.0.1:12131 for past 0 seconds.
java.io.EOFException: End of File Exception between local host is: "fv-az270-324/10.1.0.10"; destination host is: "localhost":12131; : java.io.EOFException; For more details see:  http://wiki.apache.org/hadoop/EOFException
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.hadoop.net.NetUtils.wrapWithMessage(NetUtils.java:913)
	at org.apache.hadoop.net.NetUtils.wrapException(NetUtils.java:862)
	at org.apache.hadoop.ipc.Client.getRpcResponse(Client.java:1577)
	at org.apache.hadoop.ipc.Client.call(Client.java:1519)
	at org.apache.hadoop.ipc.Client.call(Client.java:1416)
	at org.apache.hadoop.ipc.ProtobufRpcEngine$Invoker.invoke(ProtobufRpcEngine.java:236)
	at org.apache.hadoop.ipc.ProtobufRpcEngine$Invoker.invoke(ProtobufRpcEngine.java:123)
	at com.sun.proxy.$Proxy48.submitRequest(Unknown Source)
	at org.apache.hadoop.ozone.protocolPB.StorageContainerDatanodeProtocolClientSideTranslatorPB.submitRequest(StorageContainerDatanodeProtocolClientSideTranslatorPB.java:117)
	at org.apache.hadoop.ozone.protocolPB.StorageContainerDatanodeProtocolClientSideTranslatorPB.sendHeartbeat(StorageContainerDatanodeProtocolClientSideTranslatorPB.java:149)
	at org.apache.hadoop.ozone.container.common.states.endpoint.HeartbeatEndpointTask.call(HeartbeatEndpointTask.java:179)
	at org.apache.hadoop.ozone.container.common.states.endpoint.HeartbeatEndpointTask.call(HeartbeatEndpointTask.java:82)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.io.EOFException
	at java.io.DataInputStream.readInt(DataInputStream.java:392)
	at org.apache.hadoop.ipc.Client$IpcStreams.readResponse(Client.java:1892)
	at org.apache.hadoop.ipc.Client$Connection.receiveRpcResponse(Client.java:1202)
	at org.apache.hadoop.ipc.Client$Connection.run(Client.java:1098)
2021-10-05 13:26:06,854 [IPC Server listener on 12133] INFO  ipc.Server (Server.java:run(1376)) - Stopping IPC Server listener on 12133
2021-10-05 13:26:06,859 [Listener at 127.0.0.1/10516] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1456)) - Stopping Block Manager Service.
2021-10-05 13:26:06,859 [Listener at 127.0.0.1/10516] INFO  utils.BackgroundService (BackgroundService.java:shutdown(132)) - Shutting down service SCMBlockDeletingService
2021-10-05 13:26:06,859 [Listener at 127.0.0.1/10516] INFO  utils.BackgroundService (BackgroundService.java:shutdown(132)) - Shutting down service SCMBlockDeletingService
2021-10-05 13:26:06,860 [Listener at 127.0.0.1/10516] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1483)) - Stopping SCM Event Queue.
2021-10-05 13:26:06,861 [Listener at 127.0.0.1/10516] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1494)) - Stopping SCM HA services.
2021-10-05 13:26:06,861 [Listener at 127.0.0.1/10516] INFO  ha.SCMRatisServerImpl (SCMRatisServerImpl.java:stop(236)) - stopping ratis server 0.0.0.0:12130
2021-10-05 13:26:06,862 [Listener at 127.0.0.1/10516] INFO  server.RaftServer (RaftServerProxy.java:lambda$close$6(391)) - b915fa46-3b5f-4935-be53-c7cfdbb15e4b: close
2021-10-05 13:26:06,862 [Listener at 127.0.0.1/10516] INFO  server.RaftServer$Division (RaftServerImpl.java:lambda$close$4(407)) - b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E: shutdown
2021-10-05 13:26:06,862 [Listener at 127.0.0.1/10516] INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-C082E017C57E,id=b915fa46-3b5f-4935-be53-c7cfdbb15e4b
2021-10-05 13:26:06,862 [Listener at 127.0.0.1/10516] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(108)) - b915fa46-3b5f-4935-be53-c7cfdbb15e4b: shutdown b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-FollowerState
2021-10-05 13:26:06,862 [b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-FollowerState] INFO  impl.FollowerState (FollowerState.java:run(143)) - b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-FollowerState was interrupted: {}
java.lang.InterruptedException: sleep interrupted
	at java.lang.Thread.sleep(Native Method)
	at java.lang.Thread.sleep(Thread.java:340)
	at java.util.concurrent.TimeUnit.sleep(TimeUnit.java:386)
	at org.apache.ratis.util.TimeDuration.sleep(TimeDuration.java:324)
	at org.apache.ratis.util.TimeDuration.sleep(TimeDuration.java:309)
	at org.apache.ratis.server.impl.FollowerState.run(FollowerState.java:118)
2021-10-05 13:26:06,862 [b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-StateMachineUpdater] INFO  ha.SCMStateMachine (SCMStateMachine.java:takeSnapshot(290)) - Current Snapshot Index 101, takeSnapshot took 0 ms
2021-10-05 13:26:06,863 [b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:takeSnapshot(281)) - b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-StateMachineUpdater: Took a snapshot at index 101
2021-10-05 13:26:06,863 [b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:lambda$new$0(89)) - b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-StateMachineUpdater: snapshotIndex: updateIncreasingly 100 -> 101
2021-10-05 13:26:06,863 [Listener at 127.0.0.1/10516] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(149)) - b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-StateMachineUpdater: set stopIndex = 101
2021-10-05 13:26:06,863 [Listener at 127.0.0.1/10516] INFO  server.RaftServer$Division (ServerState.java:close(419)) - b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E: closes. applyIndex: 100
2021-10-05 13:26:06,863 [b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:run(327)) - b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-SegmentedRaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2021-10-05 13:26:06,864 [Listener at 127.0.0.1/10516] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:close(237)) - b915fa46-3b5f-4935-be53-c7cfdbb15e4b@group-C082E017C57E-SegmentedRaftLogWorker close()
2021-10-05 13:26:06,865 [Listener at 127.0.0.1/10516] INFO  server.GrpcService (GrpcService.java:closeImpl(262)) - b915fa46-3b5f-4935-be53-c7cfdbb15e4b: shutdown server with port 12130 now
2021-10-05 13:26:06,866 [Listener at 127.0.0.1/10516] INFO  server.GrpcService (GrpcService.java:closeImpl(271)) - b915fa46-3b5f-4935-be53-c7cfdbb15e4b: shutdown server with port 12130 successfully
2021-10-05 13:26:06,866 [org.apache.ratis.util.JvmPauseMonitor$$Lambda$499/1586779822@23829a8f] INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(109)) - JvmPauseMonitor-b915fa46-3b5f-4935-be53-c7cfdbb15e4b: Stopped
2021-10-05 13:26:06,870 [Listener at 127.0.0.1/10516] INFO  pipeline.BackgroundPipelineCreator (BackgroundPipelineCreatorV2.java:stop(158)) - Stopping RatisPipelineUtilsThread.
2021-10-05 13:26:06,870 [Listener at 127.0.0.1/10516] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1504)) - Stopping SCM MetadataStore.
2021-10-05 13:26:06,871 [Listener at 127.0.0.1/10516] INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:stop(205)) - HddsDatanode metrics system stopped (again)
2021-10-05 13:26:06,871 [Listener at 127.0.0.1/10516] INFO  ozone.MiniOzoneHAClusterImpl (MiniOzoneHAClusterImpl.java:stop(306)) - Stopping the StorageContainerManager c0dc85a0-048d-4f44-9d3e-e7de6885deea
2021-10-05 13:26:06,871 [Listener at 127.0.0.1/10516] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1395)) - Stopping Container Balancer service.
2021-10-05 13:26:06,871 [Listener at 127.0.0.1/10516] INFO  balancer.ContainerBalancer (ContainerBalancer.java:stop(742)) - Container Balancer is not running.
2021-10-05 13:26:06,871 [Listener at 127.0.0.1/10516] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1402)) - Stopping Replication Manager Service.
2021-10-05 13:26:06,871 [Listener at 127.0.0.1/10516] INFO  container.ReplicationManager (ReplicationManager.java:stop(350)) - Stopping Replication Monitor Thread.
2021-10-05 13:26:06,874 [Listener at 127.0.0.1/10516] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1409)) - Stopping the Datanode Admin Monitor.
2021-10-05 13:26:06,874 [Listener at 127.0.0.1/10516] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1416)) - Stopping Lease Manager of the command watchers
2021-10-05 13:26:06,875 [Listener at 127.0.0.1/10516] ERROR server.StorageContainerManager (StorageContainerManager.java:stop(1419)) - Lease Manager of the command watchers stop failed
2021-10-05 13:26:06,875 [Listener at 127.0.0.1/10516] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1423)) - Stopping datanode service RPC server
2021-10-05 13:26:06,875 [Listener at 127.0.0.1/10516] INFO  server.SCMDatanodeProtocolServer (SCMDatanodeProtocolServer.java:stop(389)) - Stopping the RPC server for DataNodes
2021-10-05 13:26:06,875 [Listener at 127.0.0.1/10516] INFO  ipc.Server (Server.java:stop(3414)) - Stopping server on 12141
2021-10-05 13:26:06,875 [EndpointStateMachine task thread for /127.0.0.1:15021 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15021. Already tried 2 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:26:06,876 [EndpointStateMachine task thread for /127.0.0.1:15031 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15031. Already tried 2 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:26:06,884 [EndpointStateMachine task thread for /127.0.0.1:13549 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:13549. Already tried 4 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:26:06,884 [EndpointStateMachine task thread for /127.0.0.1:13529 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:13529. Already tried 4 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:26:06,966 [EndpointStateMachine task thread for /127.0.0.1:13539 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:13539. Already tried 3 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:26:06,973 [SCM Heartbeat Processing Thread - 0] WARN  node.NodeStateManager (NodeStateManager.java:scheduleNextHealthCheck(799)) - Current Thread is interrupted, shutting down HB processing thread for Node Manager.
2021-10-05 13:26:06,973 [Listener at 127.0.0.1/10516] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1431)) - Stopping block service RPC server
2021-10-05 13:26:06,973 [Listener at 127.0.0.1/10516] INFO  server.SCMBlockProtocolServer (SCMBlockProtocolServer.java:stop(160)) - Stopping the RPC server for Block Protocol
2021-10-05 13:26:06,973 [Listener at 127.0.0.1/10516] INFO  ipc.Server (Server.java:stop(3414)) - Stopping server on 12142
2021-10-05 13:26:06,974 [Listener at 127.0.0.1/10516] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1438)) - Stopping the StorageContainerLocationProtocol RPC server
2021-10-05 13:26:06,974 [Listener at 127.0.0.1/10516] INFO  server.SCMClientProtocolServer (SCMClientProtocolServer.java:stop(173)) - Stopping the RPC server for Client Protocol
2021-10-05 13:26:06,974 [Listener at 127.0.0.1/10516] INFO  ipc.Server (Server.java:stop(3414)) - Stopping server on 12143
2021-10-05 13:26:06,974 [Listener at 127.0.0.1/10516] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1445)) - Stopping Storage Container Manager HTTP server.
2021-10-05 13:26:06,975 [Listener at 127.0.0.1/10516] ERROR server.StorageContainerManager (StorageContainerManager.java:stop(1448)) - Storage Container Manager HTTP server stop failed.
java.lang.NullPointerException
	at org.apache.hadoop.hdds.scm.server.StorageContainerManager.stop(StorageContainerManager.java:1446)
	at org.apache.hadoop.ozone.MiniOzoneHAClusterImpl.stop(MiniOzoneHAClusterImpl.java:307)
	at org.apache.hadoop.ozone.MiniOzoneClusterImpl.shutdown(MiniOzoneClusterImpl.java:457)
	at org.apache.hadoop.ozone.scm.TestSCMInstallSnapshotWithHA.shutdown(TestSCMInstallSnapshotWithHA.java:113)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.platform.commons.util.ReflectionUtils.invokeMethod(ReflectionUtils.java:688)
	at org.junit.jupiter.engine.execution.MethodInvocation.proceed(MethodInvocation.java:60)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain$ValidatingInvocation.proceed(InvocationInterceptorChain.java:131)
	at org.junit.jupiter.engine.extension.TimeoutExtension.intercept(TimeoutExtension.java:149)
	at org.junit.jupiter.engine.extension.TimeoutExtension.interceptLifecycleMethod(TimeoutExtension.java:126)
	at org.junit.jupiter.engine.extension.TimeoutExtension.interceptAfterEachMethod(TimeoutExtension.java:108)
	at org.junit.jupiter.engine.execution.ExecutableInvoker$ReflectiveInterceptorCall.lambda$ofVoidMethod$0(ExecutableInvoker.java:115)
	at org.junit.jupiter.engine.execution.ExecutableInvoker.lambda$invoke$0(ExecutableInvoker.java:105)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain$InterceptedInvocation.proceed(InvocationInterceptorChain.java:106)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.proceed(InvocationInterceptorChain.java:64)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.chainAndInvoke(InvocationInterceptorChain.java:45)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.invoke(InvocationInterceptorChain.java:37)
	at org.junit.jupiter.engine.execution.ExecutableInvoker.invoke(ExecutableInvoker.java:104)
	at org.junit.jupiter.engine.execution.ExecutableInvoker.invoke(ExecutableInvoker.java:98)
	at org.junit.jupiter.engine.descriptor.ClassBasedTestDescriptor.invokeMethodInExtensionContext(ClassBasedTestDescriptor.java:490)
	at org.junit.jupiter.engine.descriptor.ClassBasedTestDescriptor.lambda$synthesizeAfterEachMethodAdapter$20(ClassBasedTestDescriptor.java:480)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.lambda$invokeAfterEachMethods$9(TestMethodTestDescriptor.java:236)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.lambda$invokeAllAfterMethodsOrCallbacks$12(TestMethodTestDescriptor.java:269)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.lambda$invokeAllAfterMethodsOrCallbacks$13(TestMethodTestDescriptor.java:269)
	at java.util.ArrayList.forEach(ArrayList.java:1259)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.invokeAllAfterMethodsOrCallbacks(TestMethodTestDescriptor.java:268)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.invokeAfterEachMethods(TestMethodTestDescriptor.java:234)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.execute(TestMethodTestDescriptor.java:135)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.execute(TestMethodTestDescriptor.java:65)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$5(NodeTestTask.java:139)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$7(NodeTestTask.java:129)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:127)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:126)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:84)
	at java.util.ArrayList.forEach(ArrayList.java:1259)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:38)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$5(NodeTestTask.java:143)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$7(NodeTestTask.java:129)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:127)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:126)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:84)
	at java.util.ArrayList.forEach(ArrayList.java:1259)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:38)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$5(NodeTestTask.java:143)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$7(NodeTestTask.java:129)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:127)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:126)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:84)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.submit(SameThreadHierarchicalTestExecutorService.java:32)
	at org.junit.platform.engine.support.hierarchical.HierarchicalTestExecutor.execute(HierarchicalTestExecutor.java:57)
	at org.junit.platform.engine.support.hierarchical.HierarchicalTestEngine.execute(HierarchicalTestEngine.java:51)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:108)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:88)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.lambda$execute$0(EngineExecutionOrchestrator.java:54)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.withInterceptedStreams(EngineExecutionOrchestrator.java:67)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:52)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:96)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:75)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:142)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:113)
	at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:384)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:345)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:126)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:418)
2021-10-05 13:26:06,975 [Listener at 127.0.0.1/10516] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1456)) - Stopping Block Manager Service.
2021-10-05 13:26:06,975 [Listener at 127.0.0.1/10516] INFO  utils.BackgroundService (BackgroundService.java:shutdown(132)) - Shutting down service SCMBlockDeletingService
2021-10-05 13:26:06,975 [Listener at 127.0.0.1/10516] INFO  utils.BackgroundService (BackgroundService.java:shutdown(132)) - Shutting down service SCMBlockDeletingService
2021-10-05 13:26:06,976 [Listener at 127.0.0.1/10516] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1483)) - Stopping SCM Event Queue.
2021-10-05 13:26:06,976 [Listener at 127.0.0.1/10516] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1494)) - Stopping SCM HA services.
2021-10-05 13:26:06,976 [Listener at 127.0.0.1/10516] INFO  ha.SCMRatisServerImpl (SCMRatisServerImpl.java:stop(236)) - stopping ratis server 0.0.0.0:12140
2021-10-05 13:26:06,976 [Listener at 127.0.0.1/10516] INFO  pipeline.BackgroundPipelineCreator (BackgroundPipelineCreatorV2.java:stop(158)) - Stopping RatisPipelineUtilsThread.
2021-10-05 13:26:06,977 [Listener at 127.0.0.1/10516] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1504)) - Stopping SCM MetadataStore.
2021-10-05 13:26:06,977 [Listener at 127.0.0.1/10516] INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:stop(468)) - Stopping the Mini Ozone Cluster
2021-10-05 13:26:06,978 [Listener at 127.0.0.1/10516] INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:stopDatanodes(527)) - Stopping the HddsDatanodes
2021-10-05 13:26:07,125 [Datanode State Machine Thread - 0] ERROR datanode.RunningDatanodeState (RunningDatanodeState.java:computeNextContainerState(199)) - Error in executing end point task.
java.util.concurrent.ExecutionException: java.util.concurrent.TimeoutException
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.hadoop.ozone.container.common.states.datanode.RunningDatanodeState.computeNextContainerState(RunningDatanodeState.java:191)
	at org.apache.hadoop.ozone.container.common.states.datanode.RunningDatanodeState.await(RunningDatanodeState.java:231)
	at org.apache.hadoop.ozone.container.common.states.datanode.RunningDatanodeState.await(RunningDatanodeState.java:50)
	at org.apache.hadoop.ozone.container.common.statemachine.StateContext.execute(StateContext.java:629)
	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.start(DatanodeStateMachine.java:270)
	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.lambda$startDaemon$0(DatanodeStateMachine.java:457)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.util.concurrent.TimeoutException
	at java.util.concurrent.FutureTask.get(FutureTask.java:205)
	at org.apache.hadoop.ozone.container.common.states.datanode.RunningDatanodeState.lambda$execute$0(RunningDatanodeState.java:149)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
2021-10-05 13:26:07,128 [Datanode State Machine Thread - 0] WARN  statemachine.StateContext (StateContext.java:setState(246)) - Ignore disallowed transition from SHUTDOWN to RUNNING
2021-10-05 13:26:07,498 [Datanode State Machine Thread - 0] ERROR datanode.RunningDatanodeState (RunningDatanodeState.java:computeNextContainerState(199)) - Error in executing end point task.
java.util.concurrent.ExecutionException: java.util.concurrent.TimeoutException
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.hadoop.ozone.container.common.states.datanode.RunningDatanodeState.computeNextContainerState(RunningDatanodeState.java:191)
	at org.apache.hadoop.ozone.container.common.states.datanode.RunningDatanodeState.await(RunningDatanodeState.java:231)
	at org.apache.hadoop.ozone.container.common.states.datanode.RunningDatanodeState.await(RunningDatanodeState.java:50)
	at org.apache.hadoop.ozone.container.common.statemachine.StateContext.execute(StateContext.java:629)
	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.start(DatanodeStateMachine.java:270)
	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.lambda$startDaemon$0(DatanodeStateMachine.java:457)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.util.concurrent.TimeoutException
	at java.util.concurrent.FutureTask.get(FutureTask.java:205)
	at org.apache.hadoop.ozone.container.common.states.datanode.RunningDatanodeState.lambda$execute$0(RunningDatanodeState.java:149)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
2021-10-05 13:26:07,499 [Datanode State Machine Thread - 0] WARN  statemachine.StateContext (StateContext.java:setState(246)) - Ignore disallowed transition from SHUTDOWN to RUNNING
2021-10-05 13:26:07,499 [EndpointStateMachine task thread for /127.0.0.1:12121 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:12121. Already tried 0 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:26:07,789 [EndpointStateMachine task thread for /127.0.0.1:15041 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15041. Already tried 14 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:26:07,852 [Datanode State Machine Thread - 0] ERROR datanode.RunningDatanodeState (RunningDatanodeState.java:computeNextContainerState(199)) - Error in executing end point task.
java.util.concurrent.ExecutionException: java.util.concurrent.TimeoutException
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.hadoop.ozone.container.common.states.datanode.RunningDatanodeState.computeNextContainerState(RunningDatanodeState.java:191)
	at org.apache.hadoop.ozone.container.common.states.datanode.RunningDatanodeState.await(RunningDatanodeState.java:231)
	at org.apache.hadoop.ozone.container.common.states.datanode.RunningDatanodeState.await(RunningDatanodeState.java:50)
	at org.apache.hadoop.ozone.container.common.statemachine.StateContext.execute(StateContext.java:629)
	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.start(DatanodeStateMachine.java:270)
	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.lambda$startDaemon$0(DatanodeStateMachine.java:457)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.util.concurrent.TimeoutException
	at java.util.concurrent.FutureTask.get(FutureTask.java:205)
	at org.apache.hadoop.ozone.container.common.states.datanode.RunningDatanodeState.lambda$execute$0(RunningDatanodeState.java:149)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
2021-10-05 13:26:07,876 [EndpointStateMachine task thread for /127.0.0.1:15021 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15021. Already tried 3 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:26:07,876 [EndpointStateMachine task thread for /127.0.0.1:15031 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15031. Already tried 3 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:26:07,884 [EndpointStateMachine task thread for /127.0.0.1:13549 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:13549. Already tried 5 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:26:07,884 [EndpointStateMachine task thread for /127.0.0.1:13529 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:13529. Already tried 5 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:26:07,888 [EndpointStateMachine task thread for /127.0.0.1:12141 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:12141. Already tried 0 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:26:07,968 [EndpointStateMachine task thread for /127.0.0.1:13539 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:13539. Already tried 4 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:26:08,500 [EndpointStateMachine task thread for /127.0.0.1:12121 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:12121. Already tried 1 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:26:08,863 [EndpointStateMachine task thread for /127.0.0.1:12131 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:12131. Already tried 0 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:26:08,876 [EndpointStateMachine task thread for /127.0.0.1:15021 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15021. Already tried 4 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:26:08,877 [EndpointStateMachine task thread for /127.0.0.1:15031 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15031. Already tried 4 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:26:08,884 [EndpointStateMachine task thread for /127.0.0.1:13549 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:13549. Already tried 6 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:26:08,884 [EndpointStateMachine task thread for /127.0.0.1:13529 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:13529. Already tried 6 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:26:08,888 [EndpointStateMachine task thread for /127.0.0.1:12141 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:12141. Already tried 1 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:26:08,968 [EndpointStateMachine task thread for /127.0.0.1:13539 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:13539. Already tried 5 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:26:09,500 [EndpointStateMachine task thread for /127.0.0.1:12121 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:12121. Already tried 2 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:26:09,862 [Datanode State Machine Thread - 0] ERROR datanode.RunningDatanodeState (RunningDatanodeState.java:computeNextContainerState(199)) - Error in executing end point task.
java.util.concurrent.ExecutionException: java.util.concurrent.TimeoutException
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.hadoop.ozone.container.common.states.datanode.RunningDatanodeState.computeNextContainerState(RunningDatanodeState.java:191)
	at org.apache.hadoop.ozone.container.common.states.datanode.RunningDatanodeState.await(RunningDatanodeState.java:231)
	at org.apache.hadoop.ozone.container.common.states.datanode.RunningDatanodeState.await(RunningDatanodeState.java:50)
	at org.apache.hadoop.ozone.container.common.statemachine.StateContext.execute(StateContext.java:629)
	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.start(DatanodeStateMachine.java:270)
	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.lambda$startDaemon$0(DatanodeStateMachine.java:457)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.util.concurrent.TimeoutException
	at java.util.concurrent.FutureTask.get(FutureTask.java:205)
	at org.apache.hadoop.ozone.container.common.states.datanode.RunningDatanodeState.lambda$execute$0(RunningDatanodeState.java:149)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
2021-10-05 13:26:09,864 [EndpointStateMachine task thread for /127.0.0.1:12131 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:12131. Already tried 1 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:26:09,877 [EndpointStateMachine task thread for /127.0.0.1:15021 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15021. Already tried 5 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:26:09,877 [EndpointStateMachine task thread for /127.0.0.1:15031 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15031. Already tried 5 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:26:09,884 [EndpointStateMachine task thread for /127.0.0.1:13549 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:13549. Already tried 7 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:26:09,887 [EndpointStateMachine task thread for /127.0.0.1:13529 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:13529. Already tried 7 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:26:09,889 [EndpointStateMachine task thread for /127.0.0.1:12141 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:12141. Already tried 2 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:26:09,969 [EndpointStateMachine task thread for /127.0.0.1:13539 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:13539. Already tried 6 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:26:10,501 [EndpointStateMachine task thread for /127.0.0.1:12121 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:12121. Already tried 3 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:26:10,864 [EndpointStateMachine task thread for /127.0.0.1:12131 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:12131. Already tried 2 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:26:10,878 [EndpointStateMachine task thread for /127.0.0.1:15021 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15021. Already tried 6 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:26:10,878 [EndpointStateMachine task thread for /127.0.0.1:15031 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15031. Already tried 6 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:26:10,885 [EndpointStateMachine task thread for /127.0.0.1:13549 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:13549. Already tried 8 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:26:10,888 [EndpointStateMachine task thread for /127.0.0.1:13529 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:13529. Already tried 8 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:26:10,889 [EndpointStateMachine task thread for /127.0.0.1:12141 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:12141. Already tried 3 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:26:10,969 [EndpointStateMachine task thread for /127.0.0.1:13539 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:13539. Already tried 7 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:26:11,502 [EndpointStateMachine task thread for /127.0.0.1:12121 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:12121. Already tried 4 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:26:11,865 [EndpointStateMachine task thread for /127.0.0.1:12131 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:12131. Already tried 3 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:26:11,878 [EndpointStateMachine task thread for /127.0.0.1:15021 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15021. Already tried 7 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:26:11,879 [EndpointStateMachine task thread for /127.0.0.1:15031 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15031. Already tried 7 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:26:11,885 [EndpointStateMachine task thread for /127.0.0.1:13549 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:13549. Already tried 9 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:26:11,888 [EndpointStateMachine task thread for /127.0.0.1:13529 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:13529. Already tried 9 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:26:11,890 [EndpointStateMachine task thread for /127.0.0.1:12141 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:12141. Already tried 4 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:26:11,970 [EndpointStateMachine task thread for /127.0.0.1:13539 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:13539. Already tried 8 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:26:11,979 [Listener at 127.0.0.1/10516] INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(325)) - Attempting to stop container services.
2021-10-05 13:26:11,979 [ForkJoinPool.commonPool-worker-1] INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(325)) - Attempting to stop container services.
2021-10-05 13:26:11,980 [Listener at 127.0.0.1/10516] INFO  server.RaftServer (RaftServerProxy.java:lambda$close$6(391)) - 106bb174-548c-482f-98a0-a37141c57762: close
2021-10-05 13:26:11,980 [ForkJoinPool.commonPool-worker-1] INFO  server.RaftServer (RaftServerProxy.java:lambda$close$6(391)) - 2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc: close
2021-10-05 13:26:11,980 [ForkJoinPool.commonPool-worker-1] INFO  server.RaftServer$Division (RaftServerImpl.java:lambda$close$4(407)) - 2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc@group-E674C48A3917: shutdown
2021-10-05 13:26:11,980 [ForkJoinPool.commonPool-worker-1] INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-E674C48A3917,id=2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc
2021-10-05 13:26:11,981 [ForkJoinPool.commonPool-worker-1] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(108)) - 2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc: shutdown 2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc@group-E674C48A3917-FollowerState
2021-10-05 13:26:11,981 [ForkJoinPool.commonPool-worker-1] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(149)) - 2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc@group-E674C48A3917-StateMachineUpdater: set stopIndex = 0
2021-10-05 13:26:11,981 [2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc@group-E674C48A3917-FollowerState] INFO  impl.FollowerState (FollowerState.java:run(143)) - 2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc@group-E674C48A3917-FollowerState was interrupted: {}
java.lang.InterruptedException: sleep interrupted
	at java.lang.Thread.sleep(Native Method)
	at java.lang.Thread.sleep(Thread.java:340)
	at java.util.concurrent.TimeUnit.sleep(TimeUnit.java:386)
	at org.apache.ratis.util.TimeDuration.sleep(TimeDuration.java:324)
	at org.apache.ratis.util.TimeDuration.sleep(TimeDuration.java:309)
	at org.apache.ratis.server.impl.FollowerState.run(FollowerState.java:118)
2021-10-05 13:26:11,982 [2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc@group-E674C48A3917-StateMachineUpdater] INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(292)) - group-E674C48A3917: Taking a snapshot at:(t:1, i:0) file /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-62d231c0-d845-4dcd-88aa-c082e017c57e/datanode-0/data/ratis/70d43e9a-313f-4a40-8629-e674c48a3917/sm/snapshot.1_0
2021-10-05 13:26:11,980 [Listener at 127.0.0.1/10516] INFO  server.RaftServer$Division (RaftServerImpl.java:lambda$close$4(407)) - 106bb174-548c-482f-98a0-a37141c57762@group-E674C48A3917: shutdown
2021-10-05 13:26:11,983 [2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc@group-E674C48A3917-StateMachineUpdater] INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(303)) - group-E674C48A3917: Finished taking a snapshot at:(t:1, i:0) file:/home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-62d231c0-d845-4dcd-88aa-c082e017c57e/datanode-0/data/ratis/70d43e9a-313f-4a40-8629-e674c48a3917/sm/snapshot.1_0 took: 2 ms
2021-10-05 13:26:11,995 [Listener at 127.0.0.1/10516] INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-E674C48A3917,id=106bb174-548c-482f-98a0-a37141c57762
2021-10-05 13:26:11,995 [2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc@group-E674C48A3917-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:takeSnapshot(281)) - 2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc@group-E674C48A3917-StateMachineUpdater: Took a snapshot at index 0
2021-10-05 13:26:11,996 [2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc@group-E674C48A3917-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:lambda$new$0(89)) - 2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc@group-E674C48A3917-StateMachineUpdater: snapshotIndex: updateIncreasingly -1 -> 0
2021-10-05 13:26:11,995 [Listener at 127.0.0.1/10516] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(108)) - 106bb174-548c-482f-98a0-a37141c57762: shutdown 106bb174-548c-482f-98a0-a37141c57762@group-E674C48A3917-FollowerState
2021-10-05 13:26:11,996 [Listener at 127.0.0.1/10516] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(149)) - 106bb174-548c-482f-98a0-a37141c57762@group-E674C48A3917-StateMachineUpdater: set stopIndex = 0
2021-10-05 13:26:11,996 [106bb174-548c-482f-98a0-a37141c57762@group-E674C48A3917-FollowerState] INFO  impl.FollowerState (FollowerState.java:run(143)) - 106bb174-548c-482f-98a0-a37141c57762@group-E674C48A3917-FollowerState was interrupted: {}
java.lang.InterruptedException: sleep interrupted
	at java.lang.Thread.sleep(Native Method)
	at java.lang.Thread.sleep(Thread.java:340)
	at java.util.concurrent.TimeUnit.sleep(TimeUnit.java:386)
	at org.apache.ratis.util.TimeDuration.sleep(TimeDuration.java:324)
	at org.apache.ratis.util.TimeDuration.sleep(TimeDuration.java:309)
	at org.apache.ratis.server.impl.FollowerState.run(FollowerState.java:118)
2021-10-05 13:26:11,996 [ForkJoinPool.commonPool-worker-1] INFO  server.RaftServer$Division (ServerState.java:close(419)) - 2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc@group-E674C48A3917: closes. applyIndex: 0
2021-10-05 13:26:11,996 [106bb174-548c-482f-98a0-a37141c57762@group-E674C48A3917-StateMachineUpdater] INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(292)) - group-E674C48A3917: Taking a snapshot at:(t:1, i:0) file /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-62d231c0-d845-4dcd-88aa-c082e017c57e/datanode-1/data/ratis/70d43e9a-313f-4a40-8629-e674c48a3917/sm/snapshot.1_0
2021-10-05 13:26:11,997 [2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc@group-E674C48A3917-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:run(327)) - 2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc@group-E674C48A3917-SegmentedRaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2021-10-05 13:26:11,998 [106bb174-548c-482f-98a0-a37141c57762@group-E674C48A3917-StateMachineUpdater] INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(303)) - group-E674C48A3917: Finished taking a snapshot at:(t:1, i:0) file:/home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-62d231c0-d845-4dcd-88aa-c082e017c57e/datanode-1/data/ratis/70d43e9a-313f-4a40-8629-e674c48a3917/sm/snapshot.1_0 took: 3 ms
2021-10-05 13:26:11,998 [ForkJoinPool.commonPool-worker-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:close(237)) - 2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc@group-E674C48A3917-SegmentedRaftLogWorker close()
2021-10-05 13:26:11,999 [ForkJoinPool.commonPool-worker-1] INFO  server.RaftServer$Division (RaftServerImpl.java:lambda$close$4(407)) - 2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc@group-C784995F1F78: shutdown
2021-10-05 13:26:11,999 [ForkJoinPool.commonPool-worker-1] INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-C784995F1F78,id=2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc
2021-10-05 13:26:12,000 [ForkJoinPool.commonPool-worker-1] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(108)) - 2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc: shutdown 2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc@group-C784995F1F78-FollowerState
2021-10-05 13:26:12,000 [ForkJoinPool.commonPool-worker-1] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(149)) - 2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc@group-C784995F1F78-StateMachineUpdater: set stopIndex = 0
2021-10-05 13:26:12,000 [2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc@group-C784995F1F78-FollowerState] INFO  impl.FollowerState (FollowerState.java:run(143)) - 2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc@group-C784995F1F78-FollowerState was interrupted: {}
java.lang.InterruptedException: sleep interrupted
	at java.lang.Thread.sleep(Native Method)
	at java.lang.Thread.sleep(Thread.java:340)
	at java.util.concurrent.TimeUnit.sleep(TimeUnit.java:386)
	at org.apache.ratis.util.TimeDuration.sleep(TimeDuration.java:324)
	at org.apache.ratis.util.TimeDuration.sleep(TimeDuration.java:309)
	at org.apache.ratis.server.impl.FollowerState.run(FollowerState.java:118)
2021-10-05 13:26:12,000 [2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc@group-C784995F1F78-StateMachineUpdater] INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(292)) - group-C784995F1F78: Taking a snapshot at:(t:2, i:0) file /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-62d231c0-d845-4dcd-88aa-c082e017c57e/datanode-0/data/ratis/695b8808-dd40-42c0-a85d-c784995f1f78/sm/snapshot.2_0
2021-10-05 13:26:12,002 [2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc@group-C784995F1F78-StateMachineUpdater] INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(303)) - group-C784995F1F78: Finished taking a snapshot at:(t:2, i:0) file:/home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-62d231c0-d845-4dcd-88aa-c082e017c57e/datanode-0/data/ratis/695b8808-dd40-42c0-a85d-c784995f1f78/sm/snapshot.2_0 took: 2 ms
2021-10-05 13:26:12,002 [2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc@group-C784995F1F78-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:takeSnapshot(281)) - 2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc@group-C784995F1F78-StateMachineUpdater: Took a snapshot at index 0
2021-10-05 13:26:12,002 [2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc@group-C784995F1F78-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:lambda$new$0(89)) - 2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc@group-C784995F1F78-StateMachineUpdater: snapshotIndex: updateIncreasingly -1 -> 0
2021-10-05 13:26:12,003 [ForkJoinPool.commonPool-worker-1] INFO  server.RaftServer$Division (ServerState.java:close(419)) - 2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc@group-C784995F1F78: closes. applyIndex: 0
2021-10-05 13:26:12,003 [2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc@group-C784995F1F78-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:run(327)) - 2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc@group-C784995F1F78-SegmentedRaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2021-10-05 13:26:12,007 [ForkJoinPool.commonPool-worker-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:close(237)) - 2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc@group-C784995F1F78-SegmentedRaftLogWorker close()
2021-10-05 13:26:12,008 [ForkJoinPool.commonPool-worker-1] INFO  server.RaftServer$Division (RaftServerImpl.java:lambda$close$4(407)) - 2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc@group-15090DED4481: shutdown
2021-10-05 13:26:12,008 [ForkJoinPool.commonPool-worker-1] INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-15090DED4481,id=2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc
2021-10-05 13:26:12,008 [ForkJoinPool.commonPool-worker-1] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(91)) - 2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc: shutdown 2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc@group-15090DED4481-LeaderStateImpl
2021-10-05 13:26:12,008 [ForkJoinPool.commonPool-worker-1] INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(282)) - 2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc@group-15090DED4481-PendingRequests: sendNotLeaderResponses
2021-10-05 13:26:12,008 [ForkJoinPool.commonPool-worker-1] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(149)) - 2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc@group-15090DED4481-StateMachineUpdater: set stopIndex = 0
2021-10-05 13:26:12,009 [2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc@group-15090DED4481-StateMachineUpdater] INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(292)) - group-15090DED4481: Taking a snapshot at:(t:1, i:0) file /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-62d231c0-d845-4dcd-88aa-c082e017c57e/datanode-0/data/ratis/b98fb588-c6d1-40ce-b522-15090ded4481/sm/snapshot.1_0
2021-10-05 13:26:12,011 [2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc@group-15090DED4481-StateMachineUpdater] INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(303)) - group-15090DED4481: Finished taking a snapshot at:(t:1, i:0) file:/home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-62d231c0-d845-4dcd-88aa-c082e017c57e/datanode-0/data/ratis/b98fb588-c6d1-40ce-b522-15090ded4481/sm/snapshot.1_0 took: 2 ms
2021-10-05 13:26:12,011 [2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc@group-15090DED4481-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:takeSnapshot(281)) - 2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc@group-15090DED4481-StateMachineUpdater: Took a snapshot at index 0
2021-10-05 13:26:12,011 [2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc@group-15090DED4481-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:lambda$new$0(89)) - 2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc@group-15090DED4481-StateMachineUpdater: snapshotIndex: updateIncreasingly -1 -> 0
2021-10-05 13:26:12,011 [ForkJoinPool.commonPool-worker-1] INFO  server.RaftServer$Division (ServerState.java:close(419)) - 2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc@group-15090DED4481: closes. applyIndex: 0
2021-10-05 13:26:12,011 [2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc@group-15090DED4481-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:run(327)) - 2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc@group-15090DED4481-SegmentedRaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2021-10-05 13:26:12,012 [ForkJoinPool.commonPool-worker-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:close(237)) - 2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc@group-15090DED4481-SegmentedRaftLogWorker close()
2021-10-05 13:26:12,016 [ForkJoinPool.commonPool-worker-1] INFO  server.GrpcService (GrpcService.java:closeImpl(262)) - 2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc: shutdown server with port 45481 now
2021-10-05 13:26:12,020 [grpc-default-executor-4] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(122)) - 2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc: installSnapshot onError, lastRequest: c2216084-e141-4b27-afe8-b6c5968528ec->2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc#1-t1,previous=(t:0, i:0),leaderCommit=-1,initializing? true,entries: size=1, first=(t:1, i:0), CONFIGURATIONENTRY: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2021-10-05 13:26:12,020 [grpc-default-executor-2] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(122)) - 2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc: installSnapshot onError, lastRequest: 106bb174-548c-482f-98a0-a37141c57762->2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc#1-t2,previous=(t:0, i:0),leaderCommit=-1,initializing? true,entries: size=1, first=(t:2, i:0), CONFIGURATIONENTRY: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2021-10-05 13:26:12,020 [grpc-default-executor-2] WARN  server.GrpcLogAppender (LogUtils.java:warn(122)) - c2216084-e141-4b27-afe8-b6c5968528ec@group-E674C48A3917->2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc-AppendLogResponseHandler: Failed appendEntries: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: HTTP/2 error code: CANCEL
Received Rst Stream
2021-10-05 13:26:12,021 [grpc-default-executor-2] WARN  server.GrpcLogAppender (GrpcLogAppender.java:resetClient(111)) - c2216084-e141-4b27-afe8-b6c5968528ec@group-E674C48A3917->2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc-GrpcLogAppender: Leader has not got in touch with Follower c2216084-e141-4b27-afe8-b6c5968528ec@group-E674C48A3917->2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc(c0,m0,n1, attendVote=true, lastRpcSendTime=584, lastRpcResponseTime=582) yet, just keep nextIndex unchanged and retry.
2021-10-05 13:26:12,021 [grpc-default-executor-4] WARN  server.GrpcLogAppender (LogUtils.java:warn(122)) - 106bb174-548c-482f-98a0-a37141c57762@group-C784995F1F78->2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc-AppendLogResponseHandler: Failed appendEntries: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: HTTP/2 error code: CANCEL
Received Rst Stream
2021-10-05 13:26:12,021 [grpc-default-executor-4] WARN  server.GrpcLogAppender (GrpcLogAppender.java:resetClient(111)) - 106bb174-548c-482f-98a0-a37141c57762@group-C784995F1F78->2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc-GrpcLogAppender: Leader has not got in touch with Follower 106bb174-548c-482f-98a0-a37141c57762@group-C784995F1F78->2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc(c0,m0,n1, attendVote=true, lastRpcSendTime=407, lastRpcResponseTime=393) yet, just keep nextIndex unchanged and retry.
2021-10-05 13:26:12,027 [106bb174-548c-482f-98a0-a37141c57762@group-E674C48A3917-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:takeSnapshot(281)) - 106bb174-548c-482f-98a0-a37141c57762@group-E674C48A3917-StateMachineUpdater: Took a snapshot at index 0
2021-10-05 13:26:12,027 [106bb174-548c-482f-98a0-a37141c57762@group-E674C48A3917-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:lambda$new$0(89)) - 106bb174-548c-482f-98a0-a37141c57762@group-E674C48A3917-StateMachineUpdater: snapshotIndex: updateIncreasingly -1 -> 0
2021-10-05 13:26:12,027 [Listener at 127.0.0.1/10516] INFO  server.RaftServer$Division (ServerState.java:close(419)) - 106bb174-548c-482f-98a0-a37141c57762@group-E674C48A3917: closes. applyIndex: 0
2021-10-05 13:26:12,028 [106bb174-548c-482f-98a0-a37141c57762@group-E674C48A3917-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:run(327)) - 106bb174-548c-482f-98a0-a37141c57762@group-E674C48A3917-SegmentedRaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2021-10-05 13:26:12,037 [Listener at 127.0.0.1/10516] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:close(237)) - 106bb174-548c-482f-98a0-a37141c57762@group-E674C48A3917-SegmentedRaftLogWorker close()
2021-10-05 13:26:12,037 [ForkJoinPool.commonPool-worker-1] INFO  server.GrpcService (GrpcService.java:closeImpl(271)) - 2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc: shutdown server with port 45481 successfully
2021-10-05 13:26:12,037 [org.apache.ratis.util.JvmPauseMonitor$$Lambda$499/1586779822@77717581] INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(109)) - JvmPauseMonitor-2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc: Stopped
2021-10-05 13:26:12,083 [ForkJoinPool.commonPool-worker-1] INFO  utils.BackgroundService (BackgroundService.java:shutdown(132)) - Shutting down service BlockDeletingService
2021-10-05 13:26:12,083 [Listener at 127.0.0.1/10516] INFO  server.RaftServer$Division (RaftServerImpl.java:lambda$close$4(407)) - 106bb174-548c-482f-98a0-a37141c57762@group-5EA95D3F2CF7: shutdown
2021-10-05 13:26:12,083 [Listener at 127.0.0.1/10516] INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-5EA95D3F2CF7,id=106bb174-548c-482f-98a0-a37141c57762
2021-10-05 13:26:12,083 [Listener at 127.0.0.1/10516] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(91)) - 106bb174-548c-482f-98a0-a37141c57762: shutdown 106bb174-548c-482f-98a0-a37141c57762@group-5EA95D3F2CF7-LeaderStateImpl
2021-10-05 13:26:12,084 [Listener at 127.0.0.1/10516] INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(282)) - 106bb174-548c-482f-98a0-a37141c57762@group-5EA95D3F2CF7-PendingRequests: sendNotLeaderResponses
2021-10-05 13:26:12,092 [Listener at 127.0.0.1/10516] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(149)) - 106bb174-548c-482f-98a0-a37141c57762@group-5EA95D3F2CF7-StateMachineUpdater: set stopIndex = 0
2021-10-05 13:26:12,092 [106bb174-548c-482f-98a0-a37141c57762@group-5EA95D3F2CF7-StateMachineUpdater] INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(292)) - group-5EA95D3F2CF7: Taking a snapshot at:(t:1, i:0) file /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-62d231c0-d845-4dcd-88aa-c082e017c57e/datanode-1/data/ratis/b3ab901a-6bcc-4c8d-8b24-5ea95d3f2cf7/sm/snapshot.1_0
2021-10-05 13:26:12,094 [106bb174-548c-482f-98a0-a37141c57762@group-5EA95D3F2CF7-StateMachineUpdater] INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(303)) - group-5EA95D3F2CF7: Finished taking a snapshot at:(t:1, i:0) file:/home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-62d231c0-d845-4dcd-88aa-c082e017c57e/datanode-1/data/ratis/b3ab901a-6bcc-4c8d-8b24-5ea95d3f2cf7/sm/snapshot.1_0 took: 2 ms
2021-10-05 13:26:12,094 [106bb174-548c-482f-98a0-a37141c57762@group-5EA95D3F2CF7-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:takeSnapshot(281)) - 106bb174-548c-482f-98a0-a37141c57762@group-5EA95D3F2CF7-StateMachineUpdater: Took a snapshot at index 0
2021-10-05 13:26:12,094 [106bb174-548c-482f-98a0-a37141c57762@group-5EA95D3F2CF7-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:lambda$new$0(89)) - 106bb174-548c-482f-98a0-a37141c57762@group-5EA95D3F2CF7-StateMachineUpdater: snapshotIndex: updateIncreasingly -1 -> 0
2021-10-05 13:26:12,098 [Listener at 127.0.0.1/10516] INFO  server.RaftServer$Division (ServerState.java:close(419)) - 106bb174-548c-482f-98a0-a37141c57762@group-5EA95D3F2CF7: closes. applyIndex: 0
2021-10-05 13:26:12,098 [106bb174-548c-482f-98a0-a37141c57762@group-5EA95D3F2CF7-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:run(327)) - 106bb174-548c-482f-98a0-a37141c57762@group-5EA95D3F2CF7-SegmentedRaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2021-10-05 13:26:12,109 [Listener at 127.0.0.1/10516] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:close(237)) - 106bb174-548c-482f-98a0-a37141c57762@group-5EA95D3F2CF7-SegmentedRaftLogWorker close()
2021-10-05 13:26:12,134 [Listener at 127.0.0.1/10516] INFO  server.RaftServer$Division (RaftServerImpl.java:lambda$close$4(407)) - 106bb174-548c-482f-98a0-a37141c57762@group-C784995F1F78: shutdown
2021-10-05 13:26:12,134 [Listener at 127.0.0.1/10516] INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-C784995F1F78,id=106bb174-548c-482f-98a0-a37141c57762
2021-10-05 13:26:12,134 [Listener at 127.0.0.1/10516] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(91)) - 106bb174-548c-482f-98a0-a37141c57762: shutdown 106bb174-548c-482f-98a0-a37141c57762@group-C784995F1F78-LeaderStateImpl
2021-10-05 13:26:12,134 [106bb174-548c-482f-98a0-a37141c57762@group-C784995F1F78->c2216084-e141-4b27-afe8-b6c5968528ec-GrpcLogAppender-LogAppenderDaemon] WARN  server.GrpcLogAppender (GrpcLogAppender.java:mayWait(175)) - 106bb174-548c-482f-98a0-a37141c57762@group-C784995F1F78->c2216084-e141-4b27-afe8-b6c5968528ec-GrpcLogAppender: Wait interrupted by java.lang.InterruptedException
2021-10-05 13:26:12,134 [Listener at 127.0.0.1/10516] INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(282)) - 106bb174-548c-482f-98a0-a37141c57762@group-C784995F1F78-PendingRequests: sendNotLeaderResponses
2021-10-05 13:26:12,135 [grpc-default-executor-4] INFO  server.GrpcServerProtocolService (GrpcServerProtocolService.java:onCompleted(140)) - c2216084-e141-4b27-afe8-b6c5968528ec: Completed APPEND_ENTRIES, lastRequest: 106bb174-548c-482f-98a0-a37141c57762->c2216084-e141-4b27-afe8-b6c5968528ec#1-t2,previous=(t:0, i:0),leaderCommit=0,initializing? true,entries: size=1, first=(t:2, i:0), CONFIGURATIONENTRY
2021-10-05 13:26:12,136 [Listener at 127.0.0.1/10516] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(149)) - 106bb174-548c-482f-98a0-a37141c57762@group-C784995F1F78-StateMachineUpdater: set stopIndex = 0
2021-10-05 13:26:12,136 [106bb174-548c-482f-98a0-a37141c57762@group-C784995F1F78-StateMachineUpdater] INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(292)) - group-C784995F1F78: Taking a snapshot at:(t:2, i:0) file /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-62d231c0-d845-4dcd-88aa-c082e017c57e/datanode-1/data/ratis/695b8808-dd40-42c0-a85d-c784995f1f78/sm/snapshot.2_0
2021-10-05 13:26:12,137 [grpc-default-executor-0] INFO  server.GrpcLogAppender (GrpcLogAppender.java:onCompleted(344)) - 106bb174-548c-482f-98a0-a37141c57762@group-C784995F1F78->c2216084-e141-4b27-afe8-b6c5968528ec-AppendLogResponseHandler: follower responses appendEntries COMPLETED
2021-10-05 13:26:12,137 [grpc-default-executor-0] INFO  leader.FollowerInfo (FollowerInfoImpl.java:lambda$new$0(46)) - 106bb174-548c-482f-98a0-a37141c57762@group-C784995F1F78->c2216084-e141-4b27-afe8-b6c5968528ec: nextIndex: updateUnconditionally 1 -> 0
2021-10-05 13:26:12,137 [106bb174-548c-482f-98a0-a37141c57762@group-C784995F1F78-StateMachineUpdater] INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(303)) - group-C784995F1F78: Finished taking a snapshot at:(t:2, i:0) file:/home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-62d231c0-d845-4dcd-88aa-c082e017c57e/datanode-1/data/ratis/695b8808-dd40-42c0-a85d-c784995f1f78/sm/snapshot.2_0 took: 2 ms
2021-10-05 13:26:12,137 [106bb174-548c-482f-98a0-a37141c57762@group-C784995F1F78-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:takeSnapshot(281)) - 106bb174-548c-482f-98a0-a37141c57762@group-C784995F1F78-StateMachineUpdater: Took a snapshot at index 0
2021-10-05 13:26:12,137 [106bb174-548c-482f-98a0-a37141c57762@group-C784995F1F78-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:lambda$new$0(89)) - 106bb174-548c-482f-98a0-a37141c57762@group-C784995F1F78-StateMachineUpdater: snapshotIndex: updateIncreasingly -1 -> 0
2021-10-05 13:26:12,138 [Listener at 127.0.0.1/10516] INFO  server.RaftServer$Division (ServerState.java:close(419)) - 106bb174-548c-482f-98a0-a37141c57762@group-C784995F1F78: closes. applyIndex: 0
2021-10-05 13:26:12,138 [106bb174-548c-482f-98a0-a37141c57762@group-C784995F1F78-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:run(327)) - 106bb174-548c-482f-98a0-a37141c57762@group-C784995F1F78-SegmentedRaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2021-10-05 13:26:12,139 [Listener at 127.0.0.1/10516] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:close(237)) - 106bb174-548c-482f-98a0-a37141c57762@group-C784995F1F78-SegmentedRaftLogWorker close()
2021-10-05 13:26:12,163 [Listener at 127.0.0.1/10516] INFO  server.GrpcService (GrpcService.java:closeImpl(262)) - 106bb174-548c-482f-98a0-a37141c57762: shutdown server with port 43635 now
2021-10-05 13:26:12,164 [grpc-default-executor-0] WARN  server.GrpcServerProtocolService (LogUtils.java:warn(122)) - 106bb174-548c-482f-98a0-a37141c57762: installSnapshot onError, lastRequest: c2216084-e141-4b27-afe8-b6c5968528ec->106bb174-548c-482f-98a0-a37141c57762#1-t1,previous=(t:0, i:0),leaderCommit=0,initializing? true,entries: size=1, first=(t:1, i:0), CONFIGURATIONENTRY: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: client cancelled
2021-10-05 13:26:12,165 [grpc-default-executor-0] WARN  server.GrpcLogAppender (LogUtils.java:warn(122)) - c2216084-e141-4b27-afe8-b6c5968528ec@group-E674C48A3917->106bb174-548c-482f-98a0-a37141c57762-AppendLogResponseHandler: Failed appendEntries: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: HTTP/2 error code: CANCEL
Received Rst Stream
2021-10-05 13:26:12,165 [grpc-default-executor-0] WARN  server.GrpcLogAppender (GrpcLogAppender.java:resetClient(111)) - c2216084-e141-4b27-afe8-b6c5968528ec@group-E674C48A3917->106bb174-548c-482f-98a0-a37141c57762-GrpcLogAppender: Leader has not got in touch with Follower c2216084-e141-4b27-afe8-b6c5968528ec@group-E674C48A3917->106bb174-548c-482f-98a0-a37141c57762(c0,m0,n1, attendVote=true, lastRpcSendTime=675, lastRpcResponseTime=666) yet, just keep nextIndex unchanged and retry.
2021-10-05 13:26:12,186 [Listener at 127.0.0.1/10516] INFO  server.GrpcService (GrpcService.java:closeImpl(271)) - 106bb174-548c-482f-98a0-a37141c57762: shutdown server with port 43635 successfully
2021-10-05 13:26:12,191 [org.apache.ratis.util.JvmPauseMonitor$$Lambda$499/1586779822@4e639591] INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(109)) - JvmPauseMonitor-106bb174-548c-482f-98a0-a37141c57762: Stopped
2021-10-05 13:26:12,216 [Listener at 127.0.0.1/10516] INFO  utils.BackgroundService (BackgroundService.java:shutdown(132)) - Shutting down service BlockDeletingService
2021-10-05 13:26:12,507 [EndpointStateMachine task thread for /127.0.0.1:12121 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:12121. Already tried 5 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:26:12,867 [EndpointStateMachine task thread for /127.0.0.1:12131 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:12131. Already tried 4 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:26:12,871 [Datanode State Machine Thread - 0] ERROR datanode.RunningDatanodeState (RunningDatanodeState.java:computeNextContainerState(199)) - Error in executing end point task.
java.util.concurrent.ExecutionException: java.util.concurrent.TimeoutException
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.hadoop.ozone.container.common.states.datanode.RunningDatanodeState.computeNextContainerState(RunningDatanodeState.java:191)
	at org.apache.hadoop.ozone.container.common.states.datanode.RunningDatanodeState.await(RunningDatanodeState.java:231)
	at org.apache.hadoop.ozone.container.common.states.datanode.RunningDatanodeState.await(RunningDatanodeState.java:50)
	at org.apache.hadoop.ozone.container.common.statemachine.StateContext.execute(StateContext.java:629)
	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.start(DatanodeStateMachine.java:270)
	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.lambda$startDaemon$0(DatanodeStateMachine.java:457)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.util.concurrent.TimeoutException
	at java.util.concurrent.FutureTask.get(FutureTask.java:205)
	at org.apache.hadoop.ozone.container.common.states.datanode.RunningDatanodeState.lambda$execute$0(RunningDatanodeState.java:149)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
2021-10-05 13:26:12,879 [EndpointStateMachine task thread for /127.0.0.1:15031 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15031. Already tried 8 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:26:12,880 [EndpointStateMachine task thread for /127.0.0.1:15021 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15021. Already tried 8 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:26:12,886 [EndpointStateMachine task thread for /127.0.0.1:13549 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:13549. Already tried 10 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:26:12,888 [EndpointStateMachine task thread for /127.0.0.1:13529 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:13529. Already tried 10 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:26:12,893 [EndpointStateMachine task thread for /127.0.0.1:12141 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:12141. Already tried 5 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:26:12,970 [EndpointStateMachine task thread for /127.0.0.1:13539 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:13539. Already tried 9 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:26:13,508 [EndpointStateMachine task thread for /127.0.0.1:12121 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:12121. Already tried 6 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:26:13,876 [Datanode State Machine Thread - 0] ERROR datanode.RunningDatanodeState (RunningDatanodeState.java:computeNextContainerState(199)) - Error in executing end point task.
java.util.concurrent.ExecutionException: java.util.concurrent.TimeoutException
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.hadoop.ozone.container.common.states.datanode.RunningDatanodeState.computeNextContainerState(RunningDatanodeState.java:191)
	at org.apache.hadoop.ozone.container.common.states.datanode.RunningDatanodeState.await(RunningDatanodeState.java:231)
	at org.apache.hadoop.ozone.container.common.states.datanode.RunningDatanodeState.await(RunningDatanodeState.java:50)
	at org.apache.hadoop.ozone.container.common.statemachine.StateContext.execute(StateContext.java:629)
	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.start(DatanodeStateMachine.java:270)
	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.lambda$startDaemon$0(DatanodeStateMachine.java:457)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.util.concurrent.TimeoutException
	at java.util.concurrent.FutureTask.get(FutureTask.java:205)
	at org.apache.hadoop.ozone.container.common.states.datanode.RunningDatanodeState.lambda$execute$0(RunningDatanodeState.java:149)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
2021-10-05 13:26:13,880 [EndpointStateMachine task thread for /127.0.0.1:15031 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15031. Already tried 9 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:26:13,880 [EndpointStateMachine task thread for /127.0.0.1:15021 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15021. Already tried 9 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:26:13,886 [EndpointStateMachine task thread for /127.0.0.1:13549 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:13549. Already tried 11 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:26:13,889 [EndpointStateMachine task thread for /127.0.0.1:13529 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:13529. Already tried 11 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:26:13,891 [EndpointStateMachine task thread for /127.0.0.1:12131 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:12131. Already tried 5 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:26:13,893 [EndpointStateMachine task thread for /127.0.0.1:12141 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:12141. Already tried 6 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:26:13,941 [grpc-default-executor-4] WARN  server.GrpcLogAppender (LogUtils.java:warn(122)) - c2216084-e141-4b27-afe8-b6c5968528ec@group-E674C48A3917->2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc-AppendLogResponseHandler: Failed appendEntries: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
2021-10-05 13:26:13,941 [grpc-default-executor-4] WARN  server.GrpcLogAppender (GrpcLogAppender.java:resetClient(111)) - c2216084-e141-4b27-afe8-b6c5968528ec@group-E674C48A3917->2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc-GrpcLogAppender: Leader has not got in touch with Follower c2216084-e141-4b27-afe8-b6c5968528ec@group-E674C48A3917->2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc(c0,m0,n1, attendVote=true, lastRpcSendTime=1, lastRpcResponseTime=2503) yet, just keep nextIndex unchanged and retry.
2021-10-05 13:26:13,970 [EndpointStateMachine task thread for /127.0.0.1:13539 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:13539. Already tried 10 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:26:14,067 [grpc-default-executor-4] WARN  server.GrpcLogAppender (LogUtils.java:warn(122)) - c2216084-e141-4b27-afe8-b6c5968528ec@group-E674C48A3917->106bb174-548c-482f-98a0-a37141c57762-AppendLogResponseHandler: Failed appendEntries: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
2021-10-05 13:26:14,067 [grpc-default-executor-4] WARN  server.GrpcLogAppender (GrpcLogAppender.java:resetClient(111)) - c2216084-e141-4b27-afe8-b6c5968528ec@group-E674C48A3917->106bb174-548c-482f-98a0-a37141c57762-GrpcLogAppender: Leader has not got in touch with Follower c2216084-e141-4b27-afe8-b6c5968528ec@group-E674C48A3917->106bb174-548c-482f-98a0-a37141c57762(c0,m0,n1, attendVote=true, lastRpcSendTime=2578, lastRpcResponseTime=2568) yet, just keep nextIndex unchanged and retry.
2021-10-05 13:26:14,508 [EndpointStateMachine task thread for /127.0.0.1:12121 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:12121. Already tried 7 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:26:14,880 [EndpointStateMachine task thread for /127.0.0.1:15031 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15031. Already tried 10 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:26:14,881 [EndpointStateMachine task thread for /127.0.0.1:15021 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15021. Already tried 10 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:26:14,886 [EndpointStateMachine task thread for /127.0.0.1:13549 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:13549. Already tried 12 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:26:14,889 [EndpointStateMachine task thread for /127.0.0.1:13529 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:13529. Already tried 12 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:26:14,893 [EndpointStateMachine task thread for /127.0.0.1:12131 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:12131. Already tried 6 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:26:14,893 [EndpointStateMachine task thread for /127.0.0.1:12141 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:12141. Already tried 7 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:26:14,971 [EndpointStateMachine task thread for /127.0.0.1:13539 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:13539. Already tried 11 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:26:15,094 [ForkJoinPool.commonPool-worker-1] INFO  statemachine.DatanodeStateMachine (DatanodeStateMachine.java:stopDaemon(515)) - Ozone container server stopped.
2021-10-05 13:26:15,111 [ForkJoinPool.commonPool-worker-1] INFO  handler.ContextHandler (ContextHandler.java:doStop(1153)) - Stopped o.e.j.w.WebAppContext@2b96d5ea{hddsDatanode,/,null,STOPPED}{jar:file:/home/runner/.m2/repository/org/apache/ozone/hdds-container-service/1.2.0-SNAPSHOT/hdds-container-service-1.2.0-SNAPSHOT.jar!/webapps/hddsDatanode}
2021-10-05 13:26:15,112 [ForkJoinPool.commonPool-worker-1] INFO  server.AbstractConnector (AbstractConnector.java:doStop(381)) - Stopped ServerConnector@3deec5a0{HTTP/1.1, (http/1.1)}{0.0.0.0:0}
2021-10-05 13:26:15,112 [ForkJoinPool.commonPool-worker-1] INFO  server.session (HouseKeeper.java:stopScavenging(149)) - node0 Stopped scavenging
2021-10-05 13:26:15,123 [ForkJoinPool.commonPool-worker-1] INFO  handler.ContextHandler (ContextHandler.java:doStop(1153)) - Stopped o.e.j.s.ServletContextHandler@210b558d{static,/static,jar:file:/home/runner/.m2/repository/org/apache/ozone/hdds-container-service/1.2.0-SNAPSHOT/hdds-container-service-1.2.0-SNAPSHOT.jar!/webapps/static,STOPPED}
2021-10-05 13:26:15,123 [ForkJoinPool.commonPool-worker-1] INFO  handler.ContextHandler (ContextHandler.java:doStop(1153)) - Stopped o.e.j.s.ServletContextHandler@1fbbc139{logs,/logs,file:///home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/log,STOPPED}
2021-10-05 13:26:15,258 [Listener at 127.0.0.1/10516] INFO  statemachine.DatanodeStateMachine (DatanodeStateMachine.java:stopDaemon(515)) - Ozone container server stopped.
2021-10-05 13:26:15,263 [Listener at 127.0.0.1/10516] INFO  handler.ContextHandler (ContextHandler.java:doStop(1153)) - Stopped o.e.j.w.WebAppContext@7f448d3d{hddsDatanode,/,null,STOPPED}{jar:file:/home/runner/.m2/repository/org/apache/ozone/hdds-container-service/1.2.0-SNAPSHOT/hdds-container-service-1.2.0-SNAPSHOT.jar!/webapps/hddsDatanode}
2021-10-05 13:26:15,264 [Listener at 127.0.0.1/10516] INFO  server.AbstractConnector (AbstractConnector.java:doStop(381)) - Stopped ServerConnector@2da64c8d{HTTP/1.1, (http/1.1)}{0.0.0.0:0}
2021-10-05 13:26:15,264 [Listener at 127.0.0.1/10516] INFO  server.session (HouseKeeper.java:stopScavenging(149)) - node0 Stopped scavenging
2021-10-05 13:26:15,264 [Listener at 127.0.0.1/10516] INFO  handler.ContextHandler (ContextHandler.java:doStop(1153)) - Stopped o.e.j.s.ServletContextHandler@6c3921{static,/static,jar:file:/home/runner/.m2/repository/org/apache/ozone/hdds-container-service/1.2.0-SNAPSHOT/hdds-container-service-1.2.0-SNAPSHOT.jar!/webapps/static,STOPPED}
2021-10-05 13:26:15,265 [Listener at 127.0.0.1/10516] INFO  handler.ContextHandler (ContextHandler.java:doStop(1153)) - Stopped o.e.j.s.ServletContextHandler@2838f58c{logs,/logs,file:///home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/log,STOPPED}
2021-10-05 13:26:15,531 [EndpointStateMachine task thread for /127.0.0.1:12121 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:12121. Already tried 8 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:26:15,880 [Datanode State Machine Thread - 0] WARN  statemachine.StateContext (StateContext.java:setState(246)) - Ignore disallowed transition from SHUTDOWN to RUNNING
2021-10-05 13:26:15,881 [EndpointStateMachine task thread for /127.0.0.1:15031 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15031. Already tried 11 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:26:15,882 [EndpointStateMachine task thread for /127.0.0.1:15021 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15021. Already tried 11 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:26:15,887 [EndpointStateMachine task thread for /127.0.0.1:13549 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:13549. Already tried 13 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:26:15,889 [EndpointStateMachine task thread for /127.0.0.1:13529 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:13529. Already tried 13 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:26:15,894 [EndpointStateMachine task thread for /127.0.0.1:12141 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:12141. Already tried 8 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:26:15,894 [EndpointStateMachine task thread for /127.0.0.1:12131 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:12131. Already tried 7 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:26:15,971 [EndpointStateMachine task thread for /127.0.0.1:13539 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:13539. Already tried 12 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:26:16,455 [grpc-default-executor-4] WARN  server.GrpcLogAppender (LogUtils.java:warn(122)) - c2216084-e141-4b27-afe8-b6c5968528ec@group-E674C48A3917->2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc-AppendLogResponseHandler: Failed appendEntries: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
2021-10-05 13:26:16,456 [grpc-default-executor-4] WARN  server.GrpcLogAppender (GrpcLogAppender.java:resetClient(111)) - c2216084-e141-4b27-afe8-b6c5968528ec@group-E674C48A3917->2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc-GrpcLogAppender: Leader has not got in touch with Follower c2216084-e141-4b27-afe8-b6c5968528ec@group-E674C48A3917->2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc(c0,m0,n1, attendVote=true, lastRpcSendTime=2516, lastRpcResponseTime=5018) yet, just keep nextIndex unchanged and retry.
2021-10-05 13:26:16,532 [EndpointStateMachine task thread for /127.0.0.1:12121 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:12121. Already tried 9 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:26:16,574 [grpc-default-executor-4] WARN  server.GrpcLogAppender (LogUtils.java:warn(122)) - c2216084-e141-4b27-afe8-b6c5968528ec@group-E674C48A3917->106bb174-548c-482f-98a0-a37141c57762-AppendLogResponseHandler: Failed appendEntries: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
2021-10-05 13:26:16,574 [grpc-default-executor-4] WARN  server.GrpcLogAppender (GrpcLogAppender.java:resetClient(111)) - c2216084-e141-4b27-afe8-b6c5968528ec@group-E674C48A3917->106bb174-548c-482f-98a0-a37141c57762-GrpcLogAppender: Leader has not got in touch with Follower c2216084-e141-4b27-afe8-b6c5968528ec@group-E674C48A3917->106bb174-548c-482f-98a0-a37141c57762(c0,m0,n1, attendVote=true, lastRpcSendTime=1, lastRpcResponseTime=5076) yet, just keep nextIndex unchanged and retry.
2021-10-05 13:26:16,881 [EndpointStateMachine task thread for /127.0.0.1:15031 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15031. Already tried 12 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:26:16,883 [EndpointStateMachine task thread for /127.0.0.1:15021 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15021. Already tried 12 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:26:16,886 [c2216084-e141-4b27-afe8-b6c5968528ec@group-E674C48A3917-LeaderStateImpl] WARN  server.RaftServer$Division (LeaderStateImpl.java:checkLeadership(944)) - c2216084-e141-4b27-afe8-b6c5968528ec@group-E674C48A3917-LeaderStateImpl: Lost leadership on term: 1. Election timeout: 5200ms. In charge for: 15650ms. Conf: 0: [2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc|rpc:127.0.0.1:45481|dataStream:|priority:0, c2216084-e141-4b27-afe8-b6c5968528ec|rpc:127.0.0.1:39195|dataStream:|priority:1, 106bb174-548c-482f-98a0-a37141c57762|rpc:127.0.0.1:43635|dataStream:|priority:0], old=null
2021-10-05 13:26:16,886 [c2216084-e141-4b27-afe8-b6c5968528ec@group-E674C48A3917-LeaderStateImpl] WARN  server.RaftServer$Division (LeaderStateImpl.java:lambda$checkLeadership$15(948)) - Follower c2216084-e141-4b27-afe8-b6c5968528ec@group-E674C48A3917->2c04e2dd-8dcd-4c15-a2e2-22d5a8b7c9fc(c0,m0,n1, attendVote=true, lastRpcSendTime=427, lastRpcResponseTime=5448)
2021-10-05 13:26:16,886 [c2216084-e141-4b27-afe8-b6c5968528ec@group-E674C48A3917-LeaderStateImpl] WARN  server.RaftServer$Division (LeaderStateImpl.java:lambda$checkLeadership$15(948)) - Follower c2216084-e141-4b27-afe8-b6c5968528ec@group-E674C48A3917->106bb174-548c-482f-98a0-a37141c57762(c0,m0,n1, attendVote=true, lastRpcSendTime=313, lastRpcResponseTime=5387)
2021-10-05 13:26:16,886 [c2216084-e141-4b27-afe8-b6c5968528ec@group-E674C48A3917-LeaderStateImpl] INFO  server.RaftServer$Division (RaftServerImpl.java:setRole(285)) - c2216084-e141-4b27-afe8-b6c5968528ec@group-E674C48A3917: changes role from    LEADER to FOLLOWER at term 1 for StepDownReason:LOST_MAJORITY_HEARTBEATS
2021-10-05 13:26:16,886 [c2216084-e141-4b27-afe8-b6c5968528ec@group-E674C48A3917-LeaderStateImpl] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(91)) - c2216084-e141-4b27-afe8-b6c5968528ec: shutdown c2216084-e141-4b27-afe8-b6c5968528ec@group-E674C48A3917-LeaderStateImpl
2021-10-05 13:26:16,887 [c2216084-e141-4b27-afe8-b6c5968528ec@group-E674C48A3917-LeaderStateImpl] INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(282)) - c2216084-e141-4b27-afe8-b6c5968528ec@group-E674C48A3917-PendingRequests: sendNotLeaderResponses
2021-10-05 13:26:16,887 [EndpointStateMachine task thread for /127.0.0.1:13549 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:13549. Already tried 14 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:26:16,888 [c2216084-e141-4b27-afe8-b6c5968528ec@group-E674C48A3917-LeaderStateImpl] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(130)) - c2216084-e141-4b27-afe8-b6c5968528ec: start c2216084-e141-4b27-afe8-b6c5968528ec@group-E674C48A3917-FollowerState
2021-10-05 13:26:16,890 [EndpointStateMachine task thread for /127.0.0.1:13529 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:13529. Already tried 14 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:26:16,894 [EndpointStateMachine task thread for /127.0.0.1:12141 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:12141. Already tried 9 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:26:16,894 [EndpointStateMachine task thread for /127.0.0.1:12131 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:12131. Already tried 8 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:26:16,971 [EndpointStateMachine task thread for /127.0.0.1:13539 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:13539. Already tried 13 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:26:17,533 [EndpointStateMachine task thread for /127.0.0.1:12121 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:12121. Already tried 10 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:26:17,882 [EndpointStateMachine task thread for /127.0.0.1:15031 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15031. Already tried 13 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:26:17,883 [EndpointStateMachine task thread for /127.0.0.1:15021 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15021. Already tried 13 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:26:17,888 [EndpointStateMachine task thread for /127.0.0.1:13549 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:13549. Already tried 0 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:26:17,894 [EndpointStateMachine task thread for /127.0.0.1:12141 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:12141. Already tried 10 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:26:17,894 [EndpointStateMachine task thread for /127.0.0.1:12131 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:12131. Already tried 9 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:26:17,900 [EndpointStateMachine task thread for /127.0.0.1:13529 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:13529. Already tried 0 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:26:17,972 [EndpointStateMachine task thread for /127.0.0.1:13539 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:13539. Already tried 14 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:26:18,534 [EndpointStateMachine task thread for /127.0.0.1:12121 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:12121. Already tried 11 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:26:18,882 [EndpointStateMachine task thread for /127.0.0.1:15031 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15031. Already tried 14 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:26:18,883 [EndpointStateMachine task thread for /127.0.0.1:15031 - 0 ] WARN  statemachine.EndpointStateMachine (EndpointStateMachine.java:logIfNeeded(236)) - Unable to communicate to SCM server at localhost:15031 for past 0 seconds.
java.net.ConnectException: Call From fv-az270-324/10.1.0.10 to localhost:15031 failed on connection exception: java.net.ConnectException: Connection refused; For more details see:  http://wiki.apache.org/hadoop/ConnectionRefused
	at sun.reflect.GeneratedConstructorAccessor42.newInstance(Unknown Source)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.hadoop.net.NetUtils.wrapWithMessage(NetUtils.java:913)
	at org.apache.hadoop.net.NetUtils.wrapException(NetUtils.java:828)
	at org.apache.hadoop.ipc.Client.getRpcResponse(Client.java:1577)
	at org.apache.hadoop.ipc.Client.call(Client.java:1519)
	at org.apache.hadoop.ipc.Client.call(Client.java:1416)
	at org.apache.hadoop.ipc.ProtobufRpcEngine$Invoker.invoke(ProtobufRpcEngine.java:236)
	at org.apache.hadoop.ipc.ProtobufRpcEngine$Invoker.invoke(ProtobufRpcEngine.java:123)
	at com.sun.proxy.$Proxy48.submitRequest(Unknown Source)
	at org.apache.hadoop.ozone.protocolPB.StorageContainerDatanodeProtocolClientSideTranslatorPB.submitRequest(StorageContainerDatanodeProtocolClientSideTranslatorPB.java:117)
	at org.apache.hadoop.ozone.protocolPB.StorageContainerDatanodeProtocolClientSideTranslatorPB.sendHeartbeat(StorageContainerDatanodeProtocolClientSideTranslatorPB.java:149)
	at org.apache.hadoop.ozone.container.common.states.endpoint.HeartbeatEndpointTask.call(HeartbeatEndpointTask.java:179)
	at org.apache.hadoop.ozone.container.common.states.endpoint.HeartbeatEndpointTask.call(HeartbeatEndpointTask.java:82)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.net.ConnectException: Connection refused
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:716)
	at org.apache.hadoop.net.SocketIOWithTimeout.connect(SocketIOWithTimeout.java:206)
	at org.apache.hadoop.net.NetUtils.connect(NetUtils.java:586)
	at org.apache.hadoop.ipc.Client$Connection.setupConnection(Client.java:701)
	at org.apache.hadoop.ipc.Client$Connection.setupIOstreams(Client.java:822)
	at org.apache.hadoop.ipc.Client$Connection.access$3800(Client.java:414)
	at org.apache.hadoop.ipc.Client.getConnection(Client.java:1647)
	at org.apache.hadoop.ipc.Client.call(Client.java:1463)
	... 12 more
2021-10-05 13:26:18,884 [EndpointStateMachine task thread for /127.0.0.1:15021 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15021. Already tried 14 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:26:18,884 [EndpointStateMachine task thread for /127.0.0.1:15021 - 0 ] WARN  statemachine.EndpointStateMachine (EndpointStateMachine.java:logIfNeeded(236)) - Unable to communicate to SCM server at localhost:15021 for past 0 seconds.
java.net.ConnectException: Call From fv-az270-324/10.1.0.10 to localhost:15021 failed on connection exception: java.net.ConnectException: Connection refused; For more details see:  http://wiki.apache.org/hadoop/ConnectionRefused
	at sun.reflect.GeneratedConstructorAccessor42.newInstance(Unknown Source)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.hadoop.net.NetUtils.wrapWithMessage(NetUtils.java:913)
	at org.apache.hadoop.net.NetUtils.wrapException(NetUtils.java:828)
	at org.apache.hadoop.ipc.Client.getRpcResponse(Client.java:1577)
	at org.apache.hadoop.ipc.Client.call(Client.java:1519)
	at org.apache.hadoop.ipc.Client.call(Client.java:1416)
	at org.apache.hadoop.ipc.ProtobufRpcEngine$Invoker.invoke(ProtobufRpcEngine.java:236)
	at org.apache.hadoop.ipc.ProtobufRpcEngine$Invoker.invoke(ProtobufRpcEngine.java:123)
	at com.sun.proxy.$Proxy48.submitRequest(Unknown Source)
	at org.apache.hadoop.ozone.protocolPB.StorageContainerDatanodeProtocolClientSideTranslatorPB.submitRequest(StorageContainerDatanodeProtocolClientSideTranslatorPB.java:117)
	at org.apache.hadoop.ozone.protocolPB.StorageContainerDatanodeProtocolClientSideTranslatorPB.sendHeartbeat(StorageContainerDatanodeProtocolClientSideTranslatorPB.java:149)
	at org.apache.hadoop.ozone.container.common.states.endpoint.HeartbeatEndpointTask.call(HeartbeatEndpointTask.java:179)
	at org.apache.hadoop.ozone.container.common.states.endpoint.HeartbeatEndpointTask.call(HeartbeatEndpointTask.java:82)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.net.ConnectException: Connection refused
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:716)
	at org.apache.hadoop.net.SocketIOWithTimeout.connect(SocketIOWithTimeout.java:206)
	at org.apache.hadoop.net.NetUtils.connect(NetUtils.java:586)
	at org.apache.hadoop.ipc.Client$Connection.setupConnection(Client.java:701)
	at org.apache.hadoop.ipc.Client$Connection.setupIOstreams(Client.java:822)
	at org.apache.hadoop.ipc.Client$Connection.access$3800(Client.java:414)
	at org.apache.hadoop.ipc.Client.getConnection(Client.java:1647)
	at org.apache.hadoop.ipc.Client.call(Client.java:1463)
	... 12 more
2021-10-05 13:26:18,888 [EndpointStateMachine task thread for /127.0.0.1:13549 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:13549. Already tried 1 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:26:18,894 [EndpointStateMachine task thread for /127.0.0.1:12141 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:12141. Already tried 11 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:26:18,895 [EndpointStateMachine task thread for /127.0.0.1:12131 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:12131. Already tried 10 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:26:18,900 [EndpointStateMachine task thread for /127.0.0.1:13529 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:13529. Already tried 1 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:26:18,974 [EndpointStateMachine task thread for /127.0.0.1:13539 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:13539. Already tried 0 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:26:19,534 [EndpointStateMachine task thread for /127.0.0.1:12121 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:12121. Already tried 12 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:26:19,883 [EndpointStateMachine task thread for /127.0.0.1:15031 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15031. Already tried 0 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:26:19,885 [EndpointStateMachine task thread for /127.0.0.1:15021 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15021. Already tried 0 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:26:19,888 [EndpointStateMachine task thread for /127.0.0.1:13549 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:13549. Already tried 2 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:26:19,895 [EndpointStateMachine task thread for /127.0.0.1:12141 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:12141. Already tried 12 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:26:19,899 [EndpointStateMachine task thread for /127.0.0.1:12131 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:12131. Already tried 11 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:26:19,900 [EndpointStateMachine task thread for /127.0.0.1:13529 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:13529. Already tried 2 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:26:19,975 [EndpointStateMachine task thread for /127.0.0.1:13539 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:13539. Already tried 1 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:26:20,128 [ForkJoinPool.commonPool-worker-1] INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(325)) - Attempting to stop container services.
2021-10-05 13:26:20,131 [ForkJoinPool.commonPool-worker-1] INFO  server.RaftServer (RaftServerProxy.java:lambda$close$6(391)) - c2216084-e141-4b27-afe8-b6c5968528ec: close
2021-10-05 13:26:20,131 [ForkJoinPool.commonPool-worker-1] INFO  server.RaftServer$Division (RaftServerImpl.java:lambda$close$4(407)) - c2216084-e141-4b27-afe8-b6c5968528ec@group-E674C48A3917: shutdown
2021-10-05 13:26:20,131 [ForkJoinPool.commonPool-worker-1] INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-E674C48A3917,id=c2216084-e141-4b27-afe8-b6c5968528ec
2021-10-05 13:26:20,132 [ForkJoinPool.commonPool-worker-1] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(108)) - c2216084-e141-4b27-afe8-b6c5968528ec: shutdown c2216084-e141-4b27-afe8-b6c5968528ec@group-E674C48A3917-FollowerState
2021-10-05 13:26:20,132 [ForkJoinPool.commonPool-worker-1] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(149)) - c2216084-e141-4b27-afe8-b6c5968528ec@group-E674C48A3917-StateMachineUpdater: set stopIndex = 0
2021-10-05 13:26:20,132 [c2216084-e141-4b27-afe8-b6c5968528ec@group-E674C48A3917-FollowerState] INFO  impl.FollowerState (FollowerState.java:run(143)) - c2216084-e141-4b27-afe8-b6c5968528ec@group-E674C48A3917-FollowerState was interrupted: {}
java.lang.InterruptedException: sleep interrupted
	at java.lang.Thread.sleep(Native Method)
	at java.lang.Thread.sleep(Thread.java:340)
	at java.util.concurrent.TimeUnit.sleep(TimeUnit.java:386)
	at org.apache.ratis.util.TimeDuration.sleep(TimeDuration.java:324)
	at org.apache.ratis.util.TimeDuration.sleep(TimeDuration.java:309)
	at org.apache.ratis.server.impl.FollowerState.run(FollowerState.java:118)
2021-10-05 13:26:20,132 [c2216084-e141-4b27-afe8-b6c5968528ec@group-E674C48A3917-StateMachineUpdater] INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(292)) - group-E674C48A3917: Taking a snapshot at:(t:1, i:0) file /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-62d231c0-d845-4dcd-88aa-c082e017c57e/datanode-2/data/ratis/70d43e9a-313f-4a40-8629-e674c48a3917/sm/snapshot.1_0
2021-10-05 13:26:20,134 [c2216084-e141-4b27-afe8-b6c5968528ec@group-E674C48A3917-StateMachineUpdater] INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(303)) - group-E674C48A3917: Finished taking a snapshot at:(t:1, i:0) file:/home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-62d231c0-d845-4dcd-88aa-c082e017c57e/datanode-2/data/ratis/70d43e9a-313f-4a40-8629-e674c48a3917/sm/snapshot.1_0 took: 1 ms
2021-10-05 13:26:20,134 [c2216084-e141-4b27-afe8-b6c5968528ec@group-E674C48A3917-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:takeSnapshot(281)) - c2216084-e141-4b27-afe8-b6c5968528ec@group-E674C48A3917-StateMachineUpdater: Took a snapshot at index 0
2021-10-05 13:26:20,134 [c2216084-e141-4b27-afe8-b6c5968528ec@group-E674C48A3917-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:lambda$new$0(89)) - c2216084-e141-4b27-afe8-b6c5968528ec@group-E674C48A3917-StateMachineUpdater: snapshotIndex: updateIncreasingly -1 -> 0
2021-10-05 13:26:20,134 [ForkJoinPool.commonPool-worker-1] INFO  server.RaftServer$Division (ServerState.java:close(419)) - c2216084-e141-4b27-afe8-b6c5968528ec@group-E674C48A3917: closes. applyIndex: 0
2021-10-05 13:26:20,137 [c2216084-e141-4b27-afe8-b6c5968528ec@group-E674C48A3917-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:run(327)) - c2216084-e141-4b27-afe8-b6c5968528ec@group-E674C48A3917-SegmentedRaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2021-10-05 13:26:20,138 [ForkJoinPool.commonPool-worker-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:close(237)) - c2216084-e141-4b27-afe8-b6c5968528ec@group-E674C48A3917-SegmentedRaftLogWorker close()
2021-10-05 13:26:20,140 [ForkJoinPool.commonPool-worker-1] INFO  server.RaftServer$Division (RaftServerImpl.java:lambda$close$4(407)) - c2216084-e141-4b27-afe8-b6c5968528ec@group-A4888BD7295A: shutdown
2021-10-05 13:26:20,140 [ForkJoinPool.commonPool-worker-1] INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-A4888BD7295A,id=c2216084-e141-4b27-afe8-b6c5968528ec
2021-10-05 13:26:20,140 [ForkJoinPool.commonPool-worker-1] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(91)) - c2216084-e141-4b27-afe8-b6c5968528ec: shutdown c2216084-e141-4b27-afe8-b6c5968528ec@group-A4888BD7295A-LeaderStateImpl
2021-10-05 13:26:20,140 [ForkJoinPool.commonPool-worker-1] INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(282)) - c2216084-e141-4b27-afe8-b6c5968528ec@group-A4888BD7295A-PendingRequests: sendNotLeaderResponses
2021-10-05 13:26:20,141 [c2216084-e141-4b27-afe8-b6c5968528ec@group-A4888BD7295A-StateMachineUpdater] INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(292)) - group-A4888BD7295A: Taking a snapshot at:(t:1, i:0) file /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-62d231c0-d845-4dcd-88aa-c082e017c57e/datanode-2/data/ratis/cdefc21d-4d0e-403d-8056-a4888bd7295a/sm/snapshot.1_0
2021-10-05 13:26:20,141 [ForkJoinPool.commonPool-worker-1] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(149)) - c2216084-e141-4b27-afe8-b6c5968528ec@group-A4888BD7295A-StateMachineUpdater: set stopIndex = 0
2021-10-05 13:26:20,142 [c2216084-e141-4b27-afe8-b6c5968528ec@group-A4888BD7295A-StateMachineUpdater] INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(303)) - group-A4888BD7295A: Finished taking a snapshot at:(t:1, i:0) file:/home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-62d231c0-d845-4dcd-88aa-c082e017c57e/datanode-2/data/ratis/cdefc21d-4d0e-403d-8056-a4888bd7295a/sm/snapshot.1_0 took: 1 ms
2021-10-05 13:26:20,142 [c2216084-e141-4b27-afe8-b6c5968528ec@group-A4888BD7295A-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:takeSnapshot(281)) - c2216084-e141-4b27-afe8-b6c5968528ec@group-A4888BD7295A-StateMachineUpdater: Took a snapshot at index 0
2021-10-05 13:26:20,142 [c2216084-e141-4b27-afe8-b6c5968528ec@group-A4888BD7295A-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:lambda$new$0(89)) - c2216084-e141-4b27-afe8-b6c5968528ec@group-A4888BD7295A-StateMachineUpdater: snapshotIndex: updateIncreasingly -1 -> 0
2021-10-05 13:26:20,142 [ForkJoinPool.commonPool-worker-1] INFO  server.RaftServer$Division (ServerState.java:close(419)) - c2216084-e141-4b27-afe8-b6c5968528ec@group-A4888BD7295A: closes. applyIndex: 0
2021-10-05 13:26:20,143 [c2216084-e141-4b27-afe8-b6c5968528ec@group-A4888BD7295A-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:run(327)) - c2216084-e141-4b27-afe8-b6c5968528ec@group-A4888BD7295A-SegmentedRaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2021-10-05 13:26:20,143 [ForkJoinPool.commonPool-worker-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:close(237)) - c2216084-e141-4b27-afe8-b6c5968528ec@group-A4888BD7295A-SegmentedRaftLogWorker close()
2021-10-05 13:26:20,143 [ForkJoinPool.commonPool-worker-1] INFO  server.RaftServer$Division (RaftServerImpl.java:lambda$close$4(407)) - c2216084-e141-4b27-afe8-b6c5968528ec@group-C784995F1F78: shutdown
2021-10-05 13:26:20,143 [ForkJoinPool.commonPool-worker-1] INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-C784995F1F78,id=c2216084-e141-4b27-afe8-b6c5968528ec
2021-10-05 13:26:20,144 [ForkJoinPool.commonPool-worker-1] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(108)) - c2216084-e141-4b27-afe8-b6c5968528ec: shutdown c2216084-e141-4b27-afe8-b6c5968528ec@group-C784995F1F78-FollowerState
2021-10-05 13:26:20,144 [c2216084-e141-4b27-afe8-b6c5968528ec@group-C784995F1F78-FollowerState] INFO  impl.FollowerState (FollowerState.java:run(143)) - c2216084-e141-4b27-afe8-b6c5968528ec@group-C784995F1F78-FollowerState was interrupted: {}
java.lang.InterruptedException: sleep interrupted
	at java.lang.Thread.sleep(Native Method)
	at java.lang.Thread.sleep(Thread.java:340)
	at java.util.concurrent.TimeUnit.sleep(TimeUnit.java:386)
	at org.apache.ratis.util.TimeDuration.sleep(TimeDuration.java:324)
	at org.apache.ratis.util.TimeDuration.sleep(TimeDuration.java:309)
	at org.apache.ratis.server.impl.FollowerState.run(FollowerState.java:118)
2021-10-05 13:26:20,144 [ForkJoinPool.commonPool-worker-1] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(149)) - c2216084-e141-4b27-afe8-b6c5968528ec@group-C784995F1F78-StateMachineUpdater: set stopIndex = 0
2021-10-05 13:26:20,144 [c2216084-e141-4b27-afe8-b6c5968528ec@group-C784995F1F78-StateMachineUpdater] INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(292)) - group-C784995F1F78: Taking a snapshot at:(t:2, i:0) file /home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-62d231c0-d845-4dcd-88aa-c082e017c57e/datanode-2/data/ratis/695b8808-dd40-42c0-a85d-c784995f1f78/sm/snapshot.2_0
2021-10-05 13:26:20,145 [c2216084-e141-4b27-afe8-b6c5968528ec@group-C784995F1F78-StateMachineUpdater] INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(303)) - group-C784995F1F78: Finished taking a snapshot at:(t:2, i:0) file:/home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-62d231c0-d845-4dcd-88aa-c082e017c57e/datanode-2/data/ratis/695b8808-dd40-42c0-a85d-c784995f1f78/sm/snapshot.2_0 took: 0 ms
2021-10-05 13:26:20,145 [c2216084-e141-4b27-afe8-b6c5968528ec@group-C784995F1F78-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:takeSnapshot(281)) - c2216084-e141-4b27-afe8-b6c5968528ec@group-C784995F1F78-StateMachineUpdater: Took a snapshot at index 0
2021-10-05 13:26:20,145 [c2216084-e141-4b27-afe8-b6c5968528ec@group-C784995F1F78-StateMachineUpdater] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:lambda$new$0(89)) - c2216084-e141-4b27-afe8-b6c5968528ec@group-C784995F1F78-StateMachineUpdater: snapshotIndex: updateIncreasingly -1 -> 0
2021-10-05 13:26:20,147 [ForkJoinPool.commonPool-worker-1] INFO  server.RaftServer$Division (ServerState.java:close(419)) - c2216084-e141-4b27-afe8-b6c5968528ec@group-C784995F1F78: closes. applyIndex: 0
2021-10-05 13:26:20,147 [c2216084-e141-4b27-afe8-b6c5968528ec@group-C784995F1F78-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:run(327)) - c2216084-e141-4b27-afe8-b6c5968528ec@group-C784995F1F78-SegmentedRaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2021-10-05 13:26:20,147 [ForkJoinPool.commonPool-worker-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:close(237)) - c2216084-e141-4b27-afe8-b6c5968528ec@group-C784995F1F78-SegmentedRaftLogWorker close()
2021-10-05 13:26:20,151 [ForkJoinPool.commonPool-worker-1] INFO  server.GrpcService (GrpcService.java:closeImpl(262)) - c2216084-e141-4b27-afe8-b6c5968528ec: shutdown server with port 39195 now
2021-10-05 13:26:20,174 [ForkJoinPool.commonPool-worker-1] INFO  server.GrpcService (GrpcService.java:closeImpl(271)) - c2216084-e141-4b27-afe8-b6c5968528ec: shutdown server with port 39195 successfully
2021-10-05 13:26:20,174 [org.apache.ratis.util.JvmPauseMonitor$$Lambda$499/1586779822@2c416b29] INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(109)) - JvmPauseMonitor-c2216084-e141-4b27-afe8-b6c5968528ec: Stopped
2021-10-05 13:26:20,176 [ForkJoinPool.commonPool-worker-1] INFO  utils.BackgroundService (BackgroundService.java:shutdown(132)) - Shutting down service BlockDeletingService
2021-10-05 13:26:20,535 [EndpointStateMachine task thread for /127.0.0.1:12121 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:12121. Already tried 13 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:26:20,884 [EndpointStateMachine task thread for /127.0.0.1:15031 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15031. Already tried 1 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:26:20,887 [EndpointStateMachine task thread for /127.0.0.1:15021 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15021. Already tried 1 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:26:20,889 [EndpointStateMachine task thread for /127.0.0.1:13549 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:13549. Already tried 3 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:26:20,895 [EndpointStateMachine task thread for /127.0.0.1:12141 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:12141. Already tried 13 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:26:20,899 [EndpointStateMachine task thread for /127.0.0.1:12131 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:12131. Already tried 12 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:26:20,900 [EndpointStateMachine task thread for /127.0.0.1:13529 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:13529. Already tried 3 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:26:20,976 [EndpointStateMachine task thread for /127.0.0.1:13539 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:13539. Already tried 2 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:26:21,535 [EndpointStateMachine task thread for /127.0.0.1:12121 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:12121. Already tried 14 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:26:21,887 [EndpointStateMachine task thread for /127.0.0.1:15021 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15021. Already tried 2 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:26:21,889 [EndpointStateMachine task thread for /127.0.0.1:15031 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15031. Already tried 2 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:26:21,892 [EndpointStateMachine task thread for /127.0.0.1:13549 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:13549. Already tried 4 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:26:21,895 [EndpointStateMachine task thread for /127.0.0.1:12141 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:12141. Already tried 14 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:26:21,900 [EndpointStateMachine task thread for /127.0.0.1:12131 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:12131. Already tried 13 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:26:21,901 [EndpointStateMachine task thread for /127.0.0.1:13529 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:13529. Already tried 4 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:26:21,976 [EndpointStateMachine task thread for /127.0.0.1:13539 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:13539. Already tried 3 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:26:22,536 [EndpointStateMachine task thread for /127.0.0.1:12121 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:12121. Already tried 0 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:26:22,888 [EndpointStateMachine task thread for /127.0.0.1:15021 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15021. Already tried 3 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:26:22,889 [EndpointStateMachine task thread for /127.0.0.1:15031 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:15031. Already tried 3 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:26:22,895 [EndpointStateMachine task thread for /127.0.0.1:13549 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:13549. Already tried 5 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:26:22,898 [EndpointStateMachine task thread for /127.0.0.1:12141 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:12141. Already tried 0 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:26:22,901 [EndpointStateMachine task thread for /127.0.0.1:13529 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:13529. Already tried 5 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:26:22,904 [EndpointStateMachine task thread for /127.0.0.1:12131 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:12131. Already tried 14 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:26:22,979 [EndpointStateMachine task thread for /127.0.0.1:13539 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:13539. Already tried 4 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
2021-10-05 13:26:23,199 [ForkJoinPool.commonPool-worker-1] INFO  statemachine.DatanodeStateMachine (DatanodeStateMachine.java:stopDaemon(515)) - Ozone container server stopped.
2021-10-05 13:26:23,213 [ForkJoinPool.commonPool-worker-1] INFO  handler.ContextHandler (ContextHandler.java:doStop(1153)) - Stopped o.e.j.w.WebAppContext@37904d56{hddsDatanode,/,null,STOPPED}{jar:file:/home/runner/.m2/repository/org/apache/ozone/hdds-container-service/1.2.0-SNAPSHOT/hdds-container-service-1.2.0-SNAPSHOT.jar!/webapps/hddsDatanode}
2021-10-05 13:26:23,219 [ForkJoinPool.commonPool-worker-1] INFO  server.AbstractConnector (AbstractConnector.java:doStop(381)) - Stopped ServerConnector@2eff4e88{HTTP/1.1, (http/1.1)}{0.0.0.0:0}
2021-10-05 13:26:23,219 [ForkJoinPool.commonPool-worker-1] INFO  server.session (HouseKeeper.java:stopScavenging(149)) - node0 Stopped scavenging
2021-10-05 13:26:23,220 [ForkJoinPool.commonPool-worker-1] INFO  handler.ContextHandler (ContextHandler.java:doStop(1153)) - Stopped o.e.j.s.ServletContextHandler@11e7bf7b{static,/static,jar:file:/home/runner/.m2/repository/org/apache/ozone/hdds-container-service/1.2.0-SNAPSHOT/hdds-container-service-1.2.0-SNAPSHOT.jar!/webapps/static,STOPPED}
2021-10-05 13:26:23,220 [ForkJoinPool.commonPool-worker-1] INFO  handler.ContextHandler (ContextHandler.java:doStop(1153)) - Stopped o.e.j.s.ServletContextHandler@1f980706{logs,/logs,file:///home/runner/work/ozone/ozone/hadoop-ozone/integration-test/target/log,STOPPED}
2021-10-05 13:26:23,537 [EndpointStateMachine task thread for /127.0.0.1:12121 - 0 ] INFO  ipc.Client (Client.java:handleConnectionFailure(977)) - Retrying connect to server: localhost/127.0.0.1:12121. Already tried 1 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=15, sleepTime=1000 MILLISECONDS)
