2021-08-23 12:50:13,341 [main] INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(90)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 1000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false.
2021-08-23 12:50:13,484 [Socket Reader #1 for port 37737] INFO  ipc.Server (Server.java:run(1265)) - Starting Socket Reader #1 for port 37737
2021-08-23 12:50:13,593 [Listener at 127.0.0.1/37737] WARN  util.NativeCodeLoader (NativeCodeLoader.java:<clinit>(60)) - Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
2021-08-23 12:50:13,657 [IPC Server Responder] INFO  ipc.Server (Server.java:run(1507)) - IPC Server Responder: starting
2021-08-23 12:50:13,657 [IPC Server listener on 37737] INFO  ipc.Server (Server.java:run(1344)) - IPC Server listener on 37737: starting
2021-08-23 12:50:13,770 [Listener at 127.0.0.1/37737] INFO  upgrade.AbstractLayoutVersionManager (AbstractLayoutVersionManager.java:init(70)) - Initializing Layout version manager with metadata layout = SCM_HA (version = 2), software layout = SCM_HA (version = 2)
2021-08-23 12:50:14,019 [Listener at 127.0.0.1/37737] INFO  reflections.Reflections (Reflections.java:scan(232)) - Reflections took 140 ms to scan 4 urls, producing 97 keys and 214 values 
2021-08-23 12:50:14,267 [Listener at 127.0.0.1/37737] INFO  volume.HddsVolume (HddsVolume.java:<init>(120)) - Creating HddsVolume: /home/runner/work/ozone/ozone/hadoop-hdds/container-service/target/test-dir/TestDatanodeStateMachine/data/hdds of storage type : DISK capacity : 9223372036854775807
2021-08-23 12:50:14,269 [Listener at 127.0.0.1/37737] INFO  volume.MutableVolumeSet (MutableVolumeSet.java:initializeVolumeSet(181)) - Added Volume : /home/runner/work/ozone/ozone/hadoop-hdds/container-service/target/test-dir/TestDatanodeStateMachine/data/hdds to VolumeSet
2021-08-23 12:50:14,270 [Listener at 127.0.0.1/37737] INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(141)) - Scheduling a check for /home/runner/work/ozone/ozone/hadoop-hdds/container-service/target/test-dir/TestDatanodeStateMachine/data/hdds
2021-08-23 12:50:14,304 [Listener at 127.0.0.1/37737] INFO  volume.StorageVolumeChecker (StorageVolumeChecker.java:checkAllVolumes(202)) - Scheduled health check for volume /home/runner/work/ozone/ozone/hadoop-hdds/container-service/target/test-dir/TestDatanodeStateMachine/data/hdds
2021-08-23 12:50:14,337 [Listener at 127.0.0.1/37737] WARN  server.ServerUtils (ServerUtils.java:getDefaultRatisDirectory(237)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2021-08-23 12:50:14,339 [Listener at 127.0.0.1/37737] INFO  volume.MutableVolumeSet (MutableVolumeSet.java:initializeVolumeSet(181)) - Added Volume : /home/runner/work/ozone/ozone/hadoop-hdds/container-service/target/test-dir/TestDatanodeStateMachine/scm/ratis to VolumeSet
2021-08-23 12:50:14,339 [Listener at 127.0.0.1/37737] INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(141)) - Scheduling a check for /home/runner/work/ozone/ozone/hadoop-hdds/container-service/target/test-dir/TestDatanodeStateMachine/scm/ratis
2021-08-23 12:50:14,340 [Listener at 127.0.0.1/37737] INFO  volume.StorageVolumeChecker (StorageVolumeChecker.java:checkAllVolumes(202)) - Scheduled health check for volume /home/runner/work/ozone/ozone/hadoop-hdds/container-service/target/test-dir/TestDatanodeStateMachine/scm/ratis
2021-08-23 12:50:14,367 [Listener at 127.0.0.1/37737] INFO  ozoneimpl.ContainerReader (ContainerReader.java:<init>(98)) - Running in upgrade mode:true
2021-08-23 12:50:14,369 [Thread-17] INFO  ozoneimpl.ContainerReader (ContainerReader.java:readVolume(142)) - Start to verify containers on volume /home/runner/work/ozone/ozone/hadoop-hdds/container-service/target/test-dir/TestDatanodeStateMachine/data/hdds
2021-08-23 12:50:14,369 [Thread-17] INFO  ozoneimpl.ContainerReader (ContainerReader.java:readVolume(174)) - Finish verifying containers on volume /home/runner/work/ozone/ozone/hadoop-hdds/container-service/target/test-dir/TestDatanodeStateMachine/data/hdds
2021-08-23 12:50:14,371 [Listener at 127.0.0.1/37737] INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:buildContainerSet(237)) - Build ContainerSet costs 0s
2021-08-23 12:50:15,047 [Listener at 127.0.0.1/37737] WARN  server.ServerUtils (ServerUtils.java:getDefaultRatisDirectory(237)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2021-08-23 12:50:15,094 [Listener at 127.0.0.1/37737] INFO  server.RaftServer (ConfUtils.java:logGet(44)) - raft.rpc.type = GRPC (default)
2021-08-23 12:50:15,143 [Listener at 127.0.0.1/37737] INFO  grpc.GrpcFactory (GrpcFactory.java:checkPooledByteBufAllocatorUseCacheForAllThreads(48)) - PERFORMANCE WARNING: useCacheForAllThreads is true that may cause Netty to create a lot garbage objects and, as a result, trigger GC.
	It is recommended to disable useCacheForAllThreads by setting -Dorg.apache.ratis.thirdparty.io.netty.allocator.useCacheForAllThreads=false in command line.
2021-08-23 12:50:15,146 [Listener at 127.0.0.1/37737] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(44)) - raft.grpc.admin.port = 0 (custom)
2021-08-23 12:50:15,147 [Listener at 127.0.0.1/37737] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(44)) - raft.grpc.client.port = 0 (custom)
2021-08-23 12:50:15,148 [Listener at 127.0.0.1/37737] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(44)) - raft.grpc.server.port = 0 (default)
2021-08-23 12:50:15,148 [Listener at 127.0.0.1/37737] INFO  server.GrpcService (ConfUtils.java:logGet(44)) - raft.grpc.message.size.max = 32MB (=33554432) (custom)
2021-08-23 12:50:15,149 [Listener at 127.0.0.1/37737] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2021-08-23 12:50:15,150 [Listener at 127.0.0.1/37737] INFO  server.GrpcService (ConfUtils.java:logGet(44)) - raft.grpc.flow.control.window = 5MB (=5242880) (custom)
2021-08-23 12:50:15,150 [Listener at 127.0.0.1/37737] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.request.timeout = 60s (custom)
2021-08-23 12:50:15,319 [Listener at 127.0.0.1/37737] INFO  impl.DataStreamServerImpl (ConfUtils.java:logGet(44)) - raft.datastream.type = DISABLED (default)
2021-08-23 12:50:15,428 [Listener at 127.0.0.1/37737] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.slowness.timeout = 300s (custom)
2021-08-23 12:50:15,428 [Listener at 127.0.0.1/37737] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.leaderelection.leader.step-down.wait-time = 10s (default)
2021-08-23 12:50:15,447 [Listener at 127.0.0.1/37737] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.storage.dir = [/home/runner/work/ozone/ozone/hadoop-hdds/container-service/target/test-dir/TestDatanodeStateMachine/scm/ratis] (custom)
2021-08-23 12:50:15,606 [Test Data Node State Machine Thread - 0] ERROR datanode.InitDatanodeState (InitDatanodeState.java:persistContainerDatanodeDetails(141)) - Writing to /home/runner/work/ozone/ozone/hadoop-hdds/container-service/target/test-dir/TestDatanodeStateMachine/datanodeID/datanode.id failed /home/runner/work/ozone/ozone/hadoop-hdds/container-service/target/test-dir/TestDatanodeStateMachine/datanodeID/datanode.id (Permission denied)
2021-08-23 12:50:15,612 [Listener at 127.0.0.1/37737] INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(326)) - Attempting to stop container services.
2021-08-23 12:50:15,614 [Listener at 127.0.0.1/37737] INFO  utils.BackgroundService (BackgroundService.java:shutdown(132)) - Shutting down service BlockDeletingService
2021-08-23 12:50:18,619 [Listener at 127.0.0.1/37737] INFO  ipc.Server (Server.java:stop(3414)) - Stopping server on 37737
2021-08-23 12:50:18,620 [IPC Server Responder] INFO  ipc.Server (Server.java:run(1512)) - Stopping IPC Server Responder
2021-08-23 12:50:18,622 [IPC Server listener on 37737] INFO  ipc.Server (Server.java:run(1376)) - Stopping IPC Server listener on 37737
2021-08-23 12:50:18,659 [Listener at 127.0.0.1/37737] INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(90)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 1000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false.
2021-08-23 12:50:18,666 [Socket Reader #1 for port 46459] INFO  ipc.Server (Server.java:run(1265)) - Starting Socket Reader #1 for port 46459
2021-08-23 12:50:18,682 [IPC Server Responder] INFO  ipc.Server (Server.java:run(1507)) - IPC Server Responder: starting
2021-08-23 12:50:18,690 [IPC Server listener on 46459] INFO  ipc.Server (Server.java:run(1344)) - IPC Server listener on 46459: starting
2021-08-23 12:50:18,730 [Listener at 127.0.0.1/46459] INFO  upgrade.AbstractLayoutVersionManager (AbstractLayoutVersionManager.java:init(70)) - Initializing Layout version manager with metadata layout = SCM_HA (version = 2), software layout = SCM_HA (version = 2)
2021-08-23 12:50:18,731 [Listener at 127.0.0.1/46459] WARN  util.MBeans (MBeans.java:getMBeanName(167)) - Error creating MBean object name: Hadoop:service=LayoutVersionManager,name=HDDSLayoutVersionManager
org.apache.hadoop.metrics2.MetricsException: org.apache.hadoop.metrics2.MetricsException: Hadoop:service=LayoutVersionManager,name=HDDSLayoutVersionManager already exists!
	at org.apache.hadoop.metrics2.lib.DefaultMetricsSystem.newObjectName(DefaultMetricsSystem.java:135)
	at org.apache.hadoop.metrics2.lib.DefaultMetricsSystem.newMBeanName(DefaultMetricsSystem.java:110)
	at org.apache.hadoop.metrics2.util.MBeans.getMBeanName(MBeans.java:165)
	at org.apache.hadoop.metrics2.util.MBeans.register(MBeans.java:97)
	at org.apache.hadoop.metrics2.util.MBeans.register(MBeans.java:73)
	at org.apache.hadoop.ozone.upgrade.AbstractLayoutVersionManager.init(AbstractLayoutVersionManager.java:75)
	at org.apache.hadoop.hdds.upgrade.HDDSLayoutVersionManager.<init>(HDDSLayoutVersionManager.java:50)
	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.<init>(DatanodeStateMachine.java:134)
	at org.apache.hadoop.ozone.container.common.TestDatanodeStateMachine.testStartStopDatanodeStateMachine(TestDatanodeStateMachine.java:156)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:365)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeWithRerun(JUnit4Provider.java:273)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:238)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:159)
	at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:384)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:345)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:126)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:418)
Caused by: org.apache.hadoop.metrics2.MetricsException: Hadoop:service=LayoutVersionManager,name=HDDSLayoutVersionManager already exists!
	at org.apache.hadoop.metrics2.lib.DefaultMetricsSystem.newObjectName(DefaultMetricsSystem.java:131)
	... 38 more
2021-08-23 12:50:18,806 [Listener at 127.0.0.1/46459] INFO  reflections.Reflections (Reflections.java:scan(232)) - Reflections took 60 ms to scan 4 urls, producing 97 keys and 214 values 
2021-08-23 12:50:18,823 [Listener at 127.0.0.1/46459] INFO  volume.HddsVolume (HddsVolume.java:<init>(120)) - Creating HddsVolume: /home/runner/work/ozone/ozone/hadoop-hdds/container-service/target/test-dir/TestDatanodeStateMachine/data/hdds of storage type : DISK capacity : 9223372036854775807
2021-08-23 12:50:18,823 [Listener at 127.0.0.1/46459] INFO  volume.MutableVolumeSet (MutableVolumeSet.java:initializeVolumeSet(181)) - Added Volume : /home/runner/work/ozone/ozone/hadoop-hdds/container-service/target/test-dir/TestDatanodeStateMachine/data/hdds to VolumeSet
2021-08-23 12:50:18,823 [Listener at 127.0.0.1/46459] INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(141)) - Scheduling a check for /home/runner/work/ozone/ozone/hadoop-hdds/container-service/target/test-dir/TestDatanodeStateMachine/data/hdds
2021-08-23 12:50:18,838 [Listener at 127.0.0.1/46459] INFO  volume.StorageVolumeChecker (StorageVolumeChecker.java:checkAllVolumes(202)) - Scheduled health check for volume /home/runner/work/ozone/ozone/hadoop-hdds/container-service/target/test-dir/TestDatanodeStateMachine/data/hdds
2021-08-23 12:50:18,855 [Listener at 127.0.0.1/46459] WARN  server.ServerUtils (ServerUtils.java:getDefaultRatisDirectory(237)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2021-08-23 12:50:18,856 [Listener at 127.0.0.1/46459] INFO  volume.MutableVolumeSet (MutableVolumeSet.java:initializeVolumeSet(181)) - Added Volume : /home/runner/work/ozone/ozone/hadoop-hdds/container-service/target/test-dir/TestDatanodeStateMachine/scm/ratis to VolumeSet
2021-08-23 12:50:18,856 [Listener at 127.0.0.1/46459] INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(141)) - Scheduling a check for /home/runner/work/ozone/ozone/hadoop-hdds/container-service/target/test-dir/TestDatanodeStateMachine/scm/ratis
2021-08-23 12:50:18,858 [Listener at 127.0.0.1/46459] INFO  volume.StorageVolumeChecker (StorageVolumeChecker.java:checkAllVolumes(202)) - Scheduled health check for volume /home/runner/work/ozone/ozone/hadoop-hdds/container-service/target/test-dir/TestDatanodeStateMachine/scm/ratis
2021-08-23 12:50:18,878 [Listener at 127.0.0.1/46459] INFO  ozoneimpl.ContainerReader (ContainerReader.java:<init>(98)) - Running in upgrade mode:true
2021-08-23 12:50:18,890 [Thread-32] INFO  ozoneimpl.ContainerReader (ContainerReader.java:readVolume(142)) - Start to verify containers on volume /home/runner/work/ozone/ozone/hadoop-hdds/container-service/target/test-dir/TestDatanodeStateMachine/data/hdds
2021-08-23 12:50:18,890 [Thread-32] INFO  ozoneimpl.ContainerReader (ContainerReader.java:readVolume(174)) - Finish verifying containers on volume /home/runner/work/ozone/ozone/hadoop-hdds/container-service/target/test-dir/TestDatanodeStateMachine/data/hdds
2021-08-23 12:50:18,891 [Listener at 127.0.0.1/46459] INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:buildContainerSet(237)) - Build ContainerSet costs 0s
2021-08-23 12:50:18,892 [Listener at 127.0.0.1/46459] WARN  server.ServerUtils (ServerUtils.java:getDefaultRatisDirectory(237)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2021-08-23 12:50:18,894 [Listener at 127.0.0.1/46459] INFO  server.RaftServer (ConfUtils.java:logGet(44)) - raft.rpc.type = GRPC (default)
2021-08-23 12:50:18,894 [Listener at 127.0.0.1/46459] INFO  grpc.GrpcFactory (GrpcFactory.java:checkPooledByteBufAllocatorUseCacheForAllThreads(48)) - PERFORMANCE WARNING: useCacheForAllThreads is true that may cause Netty to create a lot garbage objects and, as a result, trigger GC.
	It is recommended to disable useCacheForAllThreads by setting -Dorg.apache.ratis.thirdparty.io.netty.allocator.useCacheForAllThreads=false in command line.
2021-08-23 12:50:18,894 [Listener at 127.0.0.1/46459] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(44)) - raft.grpc.admin.port = 0 (custom)
2021-08-23 12:50:18,895 [Listener at 127.0.0.1/46459] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(44)) - raft.grpc.client.port = 0 (custom)
2021-08-23 12:50:18,895 [Listener at 127.0.0.1/46459] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(44)) - raft.grpc.server.port = 0 (default)
2021-08-23 12:50:18,895 [Listener at 127.0.0.1/46459] INFO  server.GrpcService (ConfUtils.java:logGet(44)) - raft.grpc.message.size.max = 32MB (=33554432) (custom)
2021-08-23 12:50:18,895 [Listener at 127.0.0.1/46459] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2021-08-23 12:50:18,895 [Listener at 127.0.0.1/46459] INFO  server.GrpcService (ConfUtils.java:logGet(44)) - raft.grpc.flow.control.window = 5MB (=5242880) (custom)
2021-08-23 12:50:18,895 [Listener at 127.0.0.1/46459] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.request.timeout = 60s (custom)
2021-08-23 12:50:18,896 [Listener at 127.0.0.1/46459] INFO  impl.DataStreamServerImpl (ConfUtils.java:logGet(44)) - raft.datastream.type = DISABLED (default)
2021-08-23 12:50:18,896 [Listener at 127.0.0.1/46459] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.slowness.timeout = 300s (custom)
2021-08-23 12:50:18,897 [Listener at 127.0.0.1/46459] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.leaderelection.leader.step-down.wait-time = 10s (default)
2021-08-23 12:50:18,897 [Listener at 127.0.0.1/46459] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.storage.dir = [/home/runner/work/ozone/ozone/hadoop-hdds/container-service/target/test-dir/TestDatanodeStateMachine/scm/ratis] (custom)
2021-08-23 12:50:18,923 [Listener at 127.0.0.1/46459] INFO  common.TestDatanodeStateMachine (TestDatanodeStateMachine.java:lambda$testStartStopDatanodeStateMachine$0(164)) - connectionManager.getValues().size() is 0
2021-08-23 12:50:18,947 [org.apache.hadoop.util.JvmPauseMonitor$Monitor@7c924fa3] INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(188)) - Starting JVM pause monitor
2021-08-23 12:50:18,976 [Datanode State Machine Task Thread - 0] INFO  datanode.InitDatanodeState (InitDatanodeState.java:persistContainerDatanodeDetails(145)) - DatanodeDetails is persisted to /home/runner/work/ozone/ozone/hadoop-hdds/container-service/target/test-dir/TestDatanodeStateMachine/datanodeID/datanode.id
2021-08-23 12:50:19,923 [Listener at 127.0.0.1/46459] INFO  common.TestDatanodeStateMachine (TestDatanodeStateMachine.java:lambda$testStartStopDatanodeStateMachine$0(164)) - connectionManager.getValues().size() is 1
2021-08-23 12:50:20,946 [Datanode State Machine Thread - 0] INFO  statemachine.DatanodeStateMachine (DatanodeStateMachine.java:lambda$startDaemon$0(457)) - Ozone container server started.
2021-08-23 12:50:24,924 [Listener at 127.0.0.1/46459] INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(326)) - Attempting to stop container services.
2021-08-23 12:50:24,924 [Listener at 127.0.0.1/46459] INFO  utils.BackgroundService (BackgroundService.java:shutdown(132)) - Shutting down service BlockDeletingService
2021-08-23 12:50:27,928 [Listener at 127.0.0.1/46459] INFO  statemachine.DatanodeStateMachine (DatanodeStateMachine.java:stopDaemon(515)) - Ozone container server stopped.
2021-08-23 12:50:27,928 [Listener at 127.0.0.1/46459] INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(326)) - Attempting to stop container services.
2021-08-23 12:50:27,928 [Listener at 127.0.0.1/46459] INFO  utils.BackgroundService (BackgroundService.java:shutdown(132)) - Shutting down service BlockDeletingService
2021-08-23 12:50:30,928 [Listener at 127.0.0.1/46459] INFO  ipc.Server (Server.java:stop(3414)) - Stopping server on 46459
2021-08-23 12:50:30,930 [IPC Server listener on 46459] INFO  ipc.Server (Server.java:run(1376)) - Stopping IPC Server listener on 46459
2021-08-23 12:50:30,931 [IPC Server Responder] INFO  ipc.Server (Server.java:run(1512)) - Stopping IPC Server Responder
2021-08-23 12:50:30,960 [Listener at 127.0.0.1/46459] INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(90)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 1000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false.
2021-08-23 12:50:30,969 [Socket Reader #1 for port 39619] INFO  ipc.Server (Server.java:run(1265)) - Starting Socket Reader #1 for port 39619
2021-08-23 12:50:30,982 [IPC Server Responder] INFO  ipc.Server (Server.java:run(1507)) - IPC Server Responder: starting
2021-08-23 12:50:30,987 [IPC Server listener on 39619] INFO  ipc.Server (Server.java:run(1344)) - IPC Server listener on 39619: starting
2021-08-23 12:50:30,992 [Listener at 127.0.0.1/39619] INFO  common.TestDatanodeStateMachine (TestDatanodeStateMachine.java:lambda$testDatanodeStateMachineWithInvalidConfiguration$2(405)) - Test with ozone.scm.names = 
2021-08-23 12:50:30,993 [Listener at 127.0.0.1/39619] INFO  upgrade.AbstractLayoutVersionManager (AbstractLayoutVersionManager.java:init(70)) - Initializing Layout version manager with metadata layout = SCM_HA (version = 2), software layout = SCM_HA (version = 2)
2021-08-23 12:50:30,993 [Listener at 127.0.0.1/39619] WARN  util.MBeans (MBeans.java:getMBeanName(167)) - Error creating MBean object name: Hadoop:service=LayoutVersionManager,name=HDDSLayoutVersionManager
org.apache.hadoop.metrics2.MetricsException: org.apache.hadoop.metrics2.MetricsException: Hadoop:service=LayoutVersionManager,name=HDDSLayoutVersionManager already exists!
	at org.apache.hadoop.metrics2.lib.DefaultMetricsSystem.newObjectName(DefaultMetricsSystem.java:135)
	at org.apache.hadoop.metrics2.lib.DefaultMetricsSystem.newMBeanName(DefaultMetricsSystem.java:110)
	at org.apache.hadoop.metrics2.util.MBeans.getMBeanName(MBeans.java:165)
	at org.apache.hadoop.metrics2.util.MBeans.register(MBeans.java:97)
	at org.apache.hadoop.metrics2.util.MBeans.register(MBeans.java:73)
	at org.apache.hadoop.ozone.upgrade.AbstractLayoutVersionManager.init(AbstractLayoutVersionManager.java:75)
	at org.apache.hadoop.hdds.upgrade.HDDSLayoutVersionManager.<init>(HDDSLayoutVersionManager.java:50)
	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.<init>(DatanodeStateMachine.java:134)
	at org.apache.hadoop.ozone.container.common.TestDatanodeStateMachine.lambda$testDatanodeStateMachineWithInvalidConfiguration$2(TestDatanodeStateMachine.java:407)
	at java.util.ArrayList.forEach(ArrayList.java:1259)
	at org.apache.hadoop.ozone.container.common.TestDatanodeStateMachine.testDatanodeStateMachineWithInvalidConfiguration(TestDatanodeStateMachine.java:402)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:365)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeWithRerun(JUnit4Provider.java:273)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:238)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:159)
	at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:384)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:345)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:126)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:418)
Caused by: org.apache.hadoop.metrics2.MetricsException: Hadoop:service=LayoutVersionManager,name=HDDSLayoutVersionManager already exists!
	at org.apache.hadoop.metrics2.lib.DefaultMetricsSystem.newObjectName(DefaultMetricsSystem.java:131)
	... 40 more
2021-08-23 12:50:31,057 [Listener at 127.0.0.1/39619] INFO  reflections.Reflections (Reflections.java:scan(232)) - Reflections took 62 ms to scan 4 urls, producing 97 keys and 214 values 
2021-08-23 12:50:31,068 [Listener at 127.0.0.1/39619] ERROR statemachine.DatanodeStateMachine (DatanodeStateMachine.java:getEndPointTaskThreadPoolSize(208)) - Fail to get scm addresses
java.lang.IllegalArgumentException: ozone.scm.names need to be a set of valid DNS names or IP addresses. Empty address list found.
	at org.apache.hadoop.hdds.HddsUtils.getSCMAddressForDatanodes(HddsUtils.java:267)
	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.getEndPointTaskThreadPoolSize(DatanodeStateMachine.java:206)
	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.<init>(DatanodeStateMachine.java:140)
	at org.apache.hadoop.ozone.container.common.TestDatanodeStateMachine.lambda$testDatanodeStateMachineWithInvalidConfiguration$2(TestDatanodeStateMachine.java:407)
	at java.util.ArrayList.forEach(ArrayList.java:1259)
	at org.apache.hadoop.ozone.container.common.TestDatanodeStateMachine.testDatanodeStateMachineWithInvalidConfiguration(TestDatanodeStateMachine.java:402)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:365)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeWithRerun(JUnit4Provider.java:273)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:238)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:159)
	at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:384)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:345)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:126)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:418)
2021-08-23 12:50:31,076 [Listener at 127.0.0.1/39619] INFO  volume.HddsVolume (HddsVolume.java:<init>(120)) - Creating HddsVolume: /home/runner/work/ozone/ozone/hadoop-hdds/container-service/target/test-dir/TestDatanodeStateMachine/data/hdds of storage type : DISK capacity : 9223372036854775807
2021-08-23 12:50:31,076 [Listener at 127.0.0.1/39619] INFO  volume.MutableVolumeSet (MutableVolumeSet.java:initializeVolumeSet(181)) - Added Volume : /home/runner/work/ozone/ozone/hadoop-hdds/container-service/target/test-dir/TestDatanodeStateMachine/data/hdds to VolumeSet
2021-08-23 12:50:31,076 [Listener at 127.0.0.1/39619] INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(141)) - Scheduling a check for /home/runner/work/ozone/ozone/hadoop-hdds/container-service/target/test-dir/TestDatanodeStateMachine/data/hdds
2021-08-23 12:50:31,077 [Listener at 127.0.0.1/39619] INFO  volume.StorageVolumeChecker (StorageVolumeChecker.java:checkAllVolumes(202)) - Scheduled health check for volume /home/runner/work/ozone/ozone/hadoop-hdds/container-service/target/test-dir/TestDatanodeStateMachine/data/hdds
2021-08-23 12:50:31,092 [Listener at 127.0.0.1/39619] WARN  server.ServerUtils (ServerUtils.java:getDefaultRatisDirectory(237)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2021-08-23 12:50:31,092 [Listener at 127.0.0.1/39619] INFO  volume.MutableVolumeSet (MutableVolumeSet.java:initializeVolumeSet(181)) - Added Volume : /home/runner/work/ozone/ozone/hadoop-hdds/container-service/target/test-dir/TestDatanodeStateMachine/scm/ratis to VolumeSet
2021-08-23 12:50:31,093 [Listener at 127.0.0.1/39619] INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(141)) - Scheduling a check for /home/runner/work/ozone/ozone/hadoop-hdds/container-service/target/test-dir/TestDatanodeStateMachine/scm/ratis
2021-08-23 12:50:31,093 [Listener at 127.0.0.1/39619] INFO  volume.StorageVolumeChecker (StorageVolumeChecker.java:checkAllVolumes(202)) - Scheduled health check for volume /home/runner/work/ozone/ozone/hadoop-hdds/container-service/target/test-dir/TestDatanodeStateMachine/scm/ratis
2021-08-23 12:50:31,100 [Listener at 127.0.0.1/39619] INFO  ozoneimpl.ContainerReader (ContainerReader.java:<init>(98)) - Running in upgrade mode:true
2021-08-23 12:50:31,104 [Thread-49] INFO  ozoneimpl.ContainerReader (ContainerReader.java:readVolume(142)) - Start to verify containers on volume /home/runner/work/ozone/ozone/hadoop-hdds/container-service/target/test-dir/TestDatanodeStateMachine/data/hdds
2021-08-23 12:50:31,106 [Thread-49] INFO  ozoneimpl.ContainerReader (ContainerReader.java:readVolume(174)) - Finish verifying containers on volume /home/runner/work/ozone/ozone/hadoop-hdds/container-service/target/test-dir/TestDatanodeStateMachine/data/hdds
2021-08-23 12:50:31,106 [Listener at 127.0.0.1/39619] INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:buildContainerSet(237)) - Build ContainerSet costs 0s
2021-08-23 12:50:31,107 [Listener at 127.0.0.1/39619] WARN  server.ServerUtils (ServerUtils.java:getDefaultRatisDirectory(237)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2021-08-23 12:50:31,109 [Listener at 127.0.0.1/39619] INFO  server.RaftServer (ConfUtils.java:logGet(44)) - raft.rpc.type = GRPC (default)
2021-08-23 12:50:31,109 [Listener at 127.0.0.1/39619] INFO  grpc.GrpcFactory (GrpcFactory.java:checkPooledByteBufAllocatorUseCacheForAllThreads(48)) - PERFORMANCE WARNING: useCacheForAllThreads is true that may cause Netty to create a lot garbage objects and, as a result, trigger GC.
	It is recommended to disable useCacheForAllThreads by setting -Dorg.apache.ratis.thirdparty.io.netty.allocator.useCacheForAllThreads=false in command line.
2021-08-23 12:50:31,109 [Listener at 127.0.0.1/39619] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(44)) - raft.grpc.admin.port = 0 (custom)
2021-08-23 12:50:31,109 [Listener at 127.0.0.1/39619] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(44)) - raft.grpc.client.port = 0 (custom)
2021-08-23 12:50:31,109 [Listener at 127.0.0.1/39619] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(44)) - raft.grpc.server.port = 0 (default)
2021-08-23 12:50:31,109 [Listener at 127.0.0.1/39619] INFO  server.GrpcService (ConfUtils.java:logGet(44)) - raft.grpc.message.size.max = 32MB (=33554432) (custom)
2021-08-23 12:50:31,109 [Listener at 127.0.0.1/39619] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2021-08-23 12:50:31,109 [Listener at 127.0.0.1/39619] INFO  server.GrpcService (ConfUtils.java:logGet(44)) - raft.grpc.flow.control.window = 5MB (=5242880) (custom)
2021-08-23 12:50:31,110 [Listener at 127.0.0.1/39619] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.request.timeout = 60s (custom)
2021-08-23 12:50:31,115 [Listener at 127.0.0.1/39619] INFO  impl.DataStreamServerImpl (ConfUtils.java:logGet(44)) - raft.datastream.type = DISABLED (default)
2021-08-23 12:50:31,116 [Listener at 127.0.0.1/39619] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.slowness.timeout = 300s (custom)
2021-08-23 12:50:31,116 [Listener at 127.0.0.1/39619] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.leaderelection.leader.step-down.wait-time = 10s (default)
2021-08-23 12:50:31,116 [Listener at 127.0.0.1/39619] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.storage.dir = [/home/runner/work/ozone/ozone/hadoop-hdds/container-service/target/test-dir/TestDatanodeStateMachine/scm/ratis] (custom)
2021-08-23 12:50:31,123 [Test Data Node State Machine Thread - 0] ERROR datanode.InitDatanodeState (InitDatanodeState.java:call(85)) - Failed to get SCM addresses: ozone.scm.names need to be a set of valid DNS names or IP addresses. Empty address list found.
2021-08-23 12:50:31,124 [Listener at 127.0.0.1/39619] INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(326)) - Attempting to stop container services.
2021-08-23 12:50:31,124 [Listener at 127.0.0.1/39619] INFO  utils.BackgroundService (BackgroundService.java:shutdown(132)) - Shutting down service BlockDeletingService
2021-08-23 12:50:34,125 [Listener at 127.0.0.1/39619] INFO  common.TestDatanodeStateMachine (TestDatanodeStateMachine.java:lambda$testDatanodeStateMachineWithInvalidConfiguration$2(405)) - Test with ozone.scm.names = 
2021-08-23 12:50:34,126 [Listener at 127.0.0.1/39619] INFO  upgrade.AbstractLayoutVersionManager (AbstractLayoutVersionManager.java:init(70)) - Initializing Layout version manager with metadata layout = SCM_HA (version = 2), software layout = SCM_HA (version = 2)
2021-08-23 12:50:34,126 [Listener at 127.0.0.1/39619] WARN  util.MBeans (MBeans.java:getMBeanName(167)) - Error creating MBean object name: Hadoop:service=LayoutVersionManager,name=HDDSLayoutVersionManager
org.apache.hadoop.metrics2.MetricsException: org.apache.hadoop.metrics2.MetricsException: Hadoop:service=LayoutVersionManager,name=HDDSLayoutVersionManager already exists!
	at org.apache.hadoop.metrics2.lib.DefaultMetricsSystem.newObjectName(DefaultMetricsSystem.java:135)
	at org.apache.hadoop.metrics2.lib.DefaultMetricsSystem.newMBeanName(DefaultMetricsSystem.java:110)
	at org.apache.hadoop.metrics2.util.MBeans.getMBeanName(MBeans.java:165)
	at org.apache.hadoop.metrics2.util.MBeans.register(MBeans.java:97)
	at org.apache.hadoop.metrics2.util.MBeans.register(MBeans.java:73)
	at org.apache.hadoop.ozone.upgrade.AbstractLayoutVersionManager.init(AbstractLayoutVersionManager.java:75)
	at org.apache.hadoop.hdds.upgrade.HDDSLayoutVersionManager.<init>(HDDSLayoutVersionManager.java:50)
	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.<init>(DatanodeStateMachine.java:134)
	at org.apache.hadoop.ozone.container.common.TestDatanodeStateMachine.lambda$testDatanodeStateMachineWithInvalidConfiguration$2(TestDatanodeStateMachine.java:407)
	at java.util.ArrayList.forEach(ArrayList.java:1259)
	at org.apache.hadoop.ozone.container.common.TestDatanodeStateMachine.testDatanodeStateMachineWithInvalidConfiguration(TestDatanodeStateMachine.java:402)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:365)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeWithRerun(JUnit4Provider.java:273)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:238)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:159)
	at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:384)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:345)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:126)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:418)
Caused by: org.apache.hadoop.metrics2.MetricsException: Hadoop:service=LayoutVersionManager,name=HDDSLayoutVersionManager already exists!
	at org.apache.hadoop.metrics2.lib.DefaultMetricsSystem.newObjectName(DefaultMetricsSystem.java:131)
	... 40 more
2021-08-23 12:50:34,174 [Listener at 127.0.0.1/39619] INFO  reflections.Reflections (Reflections.java:scan(232)) - Reflections took 47 ms to scan 4 urls, producing 97 keys and 214 values 
2021-08-23 12:50:34,176 [Listener at 127.0.0.1/39619] ERROR statemachine.DatanodeStateMachine (DatanodeStateMachine.java:getEndPointTaskThreadPoolSize(208)) - Fail to get scm addresses
java.lang.IllegalArgumentException: ozone.scm.names need to be a set of valid DNS names or IP addresses. Empty address list found.
	at org.apache.hadoop.hdds.HddsUtils.getSCMAddressForDatanodes(HddsUtils.java:267)
	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.getEndPointTaskThreadPoolSize(DatanodeStateMachine.java:206)
	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.<init>(DatanodeStateMachine.java:140)
	at org.apache.hadoop.ozone.container.common.TestDatanodeStateMachine.lambda$testDatanodeStateMachineWithInvalidConfiguration$2(TestDatanodeStateMachine.java:407)
	at java.util.ArrayList.forEach(ArrayList.java:1259)
	at org.apache.hadoop.ozone.container.common.TestDatanodeStateMachine.testDatanodeStateMachineWithInvalidConfiguration(TestDatanodeStateMachine.java:402)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:365)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeWithRerun(JUnit4Provider.java:273)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:238)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:159)
	at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:384)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:345)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:126)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:418)
2021-08-23 12:50:34,190 [Listener at 127.0.0.1/39619] INFO  volume.HddsVolume (HddsVolume.java:<init>(120)) - Creating HddsVolume: /home/runner/work/ozone/ozone/hadoop-hdds/container-service/target/test-dir/TestDatanodeStateMachine/data/hdds of storage type : DISK capacity : 9223372036854775807
2021-08-23 12:50:34,190 [Listener at 127.0.0.1/39619] INFO  volume.MutableVolumeSet (MutableVolumeSet.java:initializeVolumeSet(181)) - Added Volume : /home/runner/work/ozone/ozone/hadoop-hdds/container-service/target/test-dir/TestDatanodeStateMachine/data/hdds to VolumeSet
2021-08-23 12:50:34,191 [Listener at 127.0.0.1/39619] INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(141)) - Scheduling a check for /home/runner/work/ozone/ozone/hadoop-hdds/container-service/target/test-dir/TestDatanodeStateMachine/data/hdds
2021-08-23 12:50:34,202 [Listener at 127.0.0.1/39619] INFO  volume.StorageVolumeChecker (StorageVolumeChecker.java:checkAllVolumes(202)) - Scheduled health check for volume /home/runner/work/ozone/ozone/hadoop-hdds/container-service/target/test-dir/TestDatanodeStateMachine/data/hdds
2021-08-23 12:50:34,212 [Listener at 127.0.0.1/39619] WARN  server.ServerUtils (ServerUtils.java:getDefaultRatisDirectory(237)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2021-08-23 12:50:34,212 [Listener at 127.0.0.1/39619] INFO  volume.MutableVolumeSet (MutableVolumeSet.java:initializeVolumeSet(181)) - Added Volume : /home/runner/work/ozone/ozone/hadoop-hdds/container-service/target/test-dir/TestDatanodeStateMachine/scm/ratis to VolumeSet
2021-08-23 12:50:34,212 [Listener at 127.0.0.1/39619] INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(141)) - Scheduling a check for /home/runner/work/ozone/ozone/hadoop-hdds/container-service/target/test-dir/TestDatanodeStateMachine/scm/ratis
2021-08-23 12:50:34,213 [Listener at 127.0.0.1/39619] INFO  volume.StorageVolumeChecker (StorageVolumeChecker.java:checkAllVolumes(202)) - Scheduled health check for volume /home/runner/work/ozone/ozone/hadoop-hdds/container-service/target/test-dir/TestDatanodeStateMachine/scm/ratis
2021-08-23 12:50:34,220 [Listener at 127.0.0.1/39619] INFO  ozoneimpl.ContainerReader (ContainerReader.java:<init>(98)) - Running in upgrade mode:true
2021-08-23 12:50:34,220 [Thread-51] INFO  ozoneimpl.ContainerReader (ContainerReader.java:readVolume(142)) - Start to verify containers on volume /home/runner/work/ozone/ozone/hadoop-hdds/container-service/target/test-dir/TestDatanodeStateMachine/data/hdds
2021-08-23 12:50:34,220 [Thread-51] INFO  ozoneimpl.ContainerReader (ContainerReader.java:readVolume(174)) - Finish verifying containers on volume /home/runner/work/ozone/ozone/hadoop-hdds/container-service/target/test-dir/TestDatanodeStateMachine/data/hdds
2021-08-23 12:50:34,220 [Listener at 127.0.0.1/39619] INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:buildContainerSet(237)) - Build ContainerSet costs 0s
2021-08-23 12:50:34,222 [Listener at 127.0.0.1/39619] WARN  server.ServerUtils (ServerUtils.java:getDefaultRatisDirectory(237)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2021-08-23 12:50:34,223 [Listener at 127.0.0.1/39619] INFO  server.RaftServer (ConfUtils.java:logGet(44)) - raft.rpc.type = GRPC (default)
2021-08-23 12:50:34,223 [Listener at 127.0.0.1/39619] INFO  grpc.GrpcFactory (GrpcFactory.java:checkPooledByteBufAllocatorUseCacheForAllThreads(48)) - PERFORMANCE WARNING: useCacheForAllThreads is true that may cause Netty to create a lot garbage objects and, as a result, trigger GC.
	It is recommended to disable useCacheForAllThreads by setting -Dorg.apache.ratis.thirdparty.io.netty.allocator.useCacheForAllThreads=false in command line.
2021-08-23 12:50:34,223 [Listener at 127.0.0.1/39619] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(44)) - raft.grpc.admin.port = 0 (custom)
2021-08-23 12:50:34,224 [Listener at 127.0.0.1/39619] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(44)) - raft.grpc.client.port = 0 (custom)
2021-08-23 12:50:34,224 [Listener at 127.0.0.1/39619] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(44)) - raft.grpc.server.port = 0 (default)
2021-08-23 12:50:34,224 [Listener at 127.0.0.1/39619] INFO  server.GrpcService (ConfUtils.java:logGet(44)) - raft.grpc.message.size.max = 32MB (=33554432) (custom)
2021-08-23 12:50:34,224 [Listener at 127.0.0.1/39619] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2021-08-23 12:50:34,224 [Listener at 127.0.0.1/39619] INFO  server.GrpcService (ConfUtils.java:logGet(44)) - raft.grpc.flow.control.window = 5MB (=5242880) (custom)
2021-08-23 12:50:34,224 [Listener at 127.0.0.1/39619] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.request.timeout = 60s (custom)
2021-08-23 12:50:34,225 [Listener at 127.0.0.1/39619] INFO  impl.DataStreamServerImpl (ConfUtils.java:logGet(44)) - raft.datastream.type = DISABLED (default)
2021-08-23 12:50:34,225 [Listener at 127.0.0.1/39619] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.slowness.timeout = 300s (custom)
2021-08-23 12:50:34,226 [Listener at 127.0.0.1/39619] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.leaderelection.leader.step-down.wait-time = 10s (default)
2021-08-23 12:50:34,226 [Listener at 127.0.0.1/39619] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.storage.dir = [/home/runner/work/ozone/ozone/hadoop-hdds/container-service/target/test-dir/TestDatanodeStateMachine/scm/ratis] (custom)
2021-08-23 12:50:34,232 [Test Data Node State Machine Thread - 0] ERROR datanode.InitDatanodeState (InitDatanodeState.java:call(85)) - Failed to get SCM addresses: ozone.scm.names need to be a set of valid DNS names or IP addresses. Empty address list found.
2021-08-23 12:50:34,232 [Listener at 127.0.0.1/39619] INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(326)) - Attempting to stop container services.
2021-08-23 12:50:34,233 [Listener at 127.0.0.1/39619] INFO  utils.BackgroundService (BackgroundService.java:shutdown(132)) - Shutting down service BlockDeletingService
2021-08-23 12:50:37,234 [Listener at 127.0.0.1/39619] INFO  common.TestDatanodeStateMachine (TestDatanodeStateMachine.java:lambda$testDatanodeStateMachineWithInvalidConfiguration$2(405)) - Test with ozone.scm.names = x..y
2021-08-23 12:50:37,234 [Listener at 127.0.0.1/39619] INFO  upgrade.AbstractLayoutVersionManager (AbstractLayoutVersionManager.java:init(70)) - Initializing Layout version manager with metadata layout = SCM_HA (version = 2), software layout = SCM_HA (version = 2)
2021-08-23 12:50:37,235 [Listener at 127.0.0.1/39619] WARN  util.MBeans (MBeans.java:getMBeanName(167)) - Error creating MBean object name: Hadoop:service=LayoutVersionManager,name=HDDSLayoutVersionManager
org.apache.hadoop.metrics2.MetricsException: org.apache.hadoop.metrics2.MetricsException: Hadoop:service=LayoutVersionManager,name=HDDSLayoutVersionManager already exists!
	at org.apache.hadoop.metrics2.lib.DefaultMetricsSystem.newObjectName(DefaultMetricsSystem.java:135)
	at org.apache.hadoop.metrics2.lib.DefaultMetricsSystem.newMBeanName(DefaultMetricsSystem.java:110)
	at org.apache.hadoop.metrics2.util.MBeans.getMBeanName(MBeans.java:165)
	at org.apache.hadoop.metrics2.util.MBeans.register(MBeans.java:97)
	at org.apache.hadoop.metrics2.util.MBeans.register(MBeans.java:73)
	at org.apache.hadoop.ozone.upgrade.AbstractLayoutVersionManager.init(AbstractLayoutVersionManager.java:75)
	at org.apache.hadoop.hdds.upgrade.HDDSLayoutVersionManager.<init>(HDDSLayoutVersionManager.java:50)
	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.<init>(DatanodeStateMachine.java:134)
	at org.apache.hadoop.ozone.container.common.TestDatanodeStateMachine.lambda$testDatanodeStateMachineWithInvalidConfiguration$2(TestDatanodeStateMachine.java:407)
	at java.util.ArrayList.forEach(ArrayList.java:1259)
	at org.apache.hadoop.ozone.container.common.TestDatanodeStateMachine.testDatanodeStateMachineWithInvalidConfiguration(TestDatanodeStateMachine.java:402)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:365)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeWithRerun(JUnit4Provider.java:273)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:238)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:159)
	at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:384)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:345)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:126)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:418)
Caused by: org.apache.hadoop.metrics2.MetricsException: Hadoop:service=LayoutVersionManager,name=HDDSLayoutVersionManager already exists!
	at org.apache.hadoop.metrics2.lib.DefaultMetricsSystem.newObjectName(DefaultMetricsSystem.java:131)
	... 40 more
2021-08-23 12:50:37,286 [Listener at 127.0.0.1/39619] INFO  reflections.Reflections (Reflections.java:scan(232)) - Reflections took 48 ms to scan 4 urls, producing 97 keys and 214 values 
2021-08-23 12:50:37,288 [Listener at 127.0.0.1/39619] ERROR statemachine.DatanodeStateMachine (DatanodeStateMachine.java:getEndPointTaskThreadPoolSize(208)) - Fail to get scm addresses
java.lang.IllegalArgumentException: Does not contain a valid host:port authority: x..y
	at org.apache.hadoop.net.NetUtils.createSocketAddr(NetUtils.java:232)
	at org.apache.hadoop.net.NetUtils.createSocketAddr(NetUtils.java:189)
	at org.apache.hadoop.net.NetUtils.createSocketAddr(NetUtils.java:169)
	at org.apache.hadoop.hdds.HddsUtils.getSCMAddressForDatanodes(HddsUtils.java:282)
	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.getEndPointTaskThreadPoolSize(DatanodeStateMachine.java:206)
	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.<init>(DatanodeStateMachine.java:140)
	at org.apache.hadoop.ozone.container.common.TestDatanodeStateMachine.lambda$testDatanodeStateMachineWithInvalidConfiguration$2(TestDatanodeStateMachine.java:407)
	at java.util.ArrayList.forEach(ArrayList.java:1259)
	at org.apache.hadoop.ozone.container.common.TestDatanodeStateMachine.testDatanodeStateMachineWithInvalidConfiguration(TestDatanodeStateMachine.java:402)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:365)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeWithRerun(JUnit4Provider.java:273)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:238)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:159)
	at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:384)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:345)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:126)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:418)
2021-08-23 12:50:37,309 [Listener at 127.0.0.1/39619] INFO  volume.HddsVolume (HddsVolume.java:<init>(120)) - Creating HddsVolume: /home/runner/work/ozone/ozone/hadoop-hdds/container-service/target/test-dir/TestDatanodeStateMachine/data/hdds of storage type : DISK capacity : 9223372036854775807
2021-08-23 12:50:37,309 [Listener at 127.0.0.1/39619] INFO  volume.MutableVolumeSet (MutableVolumeSet.java:initializeVolumeSet(181)) - Added Volume : /home/runner/work/ozone/ozone/hadoop-hdds/container-service/target/test-dir/TestDatanodeStateMachine/data/hdds to VolumeSet
2021-08-23 12:50:37,309 [Listener at 127.0.0.1/39619] INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(141)) - Scheduling a check for /home/runner/work/ozone/ozone/hadoop-hdds/container-service/target/test-dir/TestDatanodeStateMachine/data/hdds
2021-08-23 12:50:37,315 [Listener at 127.0.0.1/39619] INFO  volume.StorageVolumeChecker (StorageVolumeChecker.java:checkAllVolumes(202)) - Scheduled health check for volume /home/runner/work/ozone/ozone/hadoop-hdds/container-service/target/test-dir/TestDatanodeStateMachine/data/hdds
2021-08-23 12:50:37,323 [Listener at 127.0.0.1/39619] WARN  server.ServerUtils (ServerUtils.java:getDefaultRatisDirectory(237)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2021-08-23 12:50:37,331 [Listener at 127.0.0.1/39619] INFO  volume.MutableVolumeSet (MutableVolumeSet.java:initializeVolumeSet(181)) - Added Volume : /home/runner/work/ozone/ozone/hadoop-hdds/container-service/target/test-dir/TestDatanodeStateMachine/scm/ratis to VolumeSet
2021-08-23 12:50:37,331 [Listener at 127.0.0.1/39619] INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(141)) - Scheduling a check for /home/runner/work/ozone/ozone/hadoop-hdds/container-service/target/test-dir/TestDatanodeStateMachine/scm/ratis
2021-08-23 12:50:37,331 [Listener at 127.0.0.1/39619] INFO  volume.StorageVolumeChecker (StorageVolumeChecker.java:checkAllVolumes(202)) - Scheduled health check for volume /home/runner/work/ozone/ozone/hadoop-hdds/container-service/target/test-dir/TestDatanodeStateMachine/scm/ratis
2021-08-23 12:50:37,350 [Listener at 127.0.0.1/39619] INFO  ozoneimpl.ContainerReader (ContainerReader.java:<init>(98)) - Running in upgrade mode:true
2021-08-23 12:50:37,352 [Thread-53] INFO  ozoneimpl.ContainerReader (ContainerReader.java:readVolume(142)) - Start to verify containers on volume /home/runner/work/ozone/ozone/hadoop-hdds/container-service/target/test-dir/TestDatanodeStateMachine/data/hdds
2021-08-23 12:50:37,352 [Thread-53] INFO  ozoneimpl.ContainerReader (ContainerReader.java:readVolume(174)) - Finish verifying containers on volume /home/runner/work/ozone/ozone/hadoop-hdds/container-service/target/test-dir/TestDatanodeStateMachine/data/hdds
2021-08-23 12:50:37,352 [Listener at 127.0.0.1/39619] INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:buildContainerSet(237)) - Build ContainerSet costs 0s
2021-08-23 12:50:37,353 [Listener at 127.0.0.1/39619] WARN  server.ServerUtils (ServerUtils.java:getDefaultRatisDirectory(237)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2021-08-23 12:50:37,354 [Listener at 127.0.0.1/39619] INFO  server.RaftServer (ConfUtils.java:logGet(44)) - raft.rpc.type = GRPC (default)
2021-08-23 12:50:37,355 [Listener at 127.0.0.1/39619] INFO  grpc.GrpcFactory (GrpcFactory.java:checkPooledByteBufAllocatorUseCacheForAllThreads(48)) - PERFORMANCE WARNING: useCacheForAllThreads is true that may cause Netty to create a lot garbage objects and, as a result, trigger GC.
	It is recommended to disable useCacheForAllThreads by setting -Dorg.apache.ratis.thirdparty.io.netty.allocator.useCacheForAllThreads=false in command line.
2021-08-23 12:50:37,355 [Listener at 127.0.0.1/39619] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(44)) - raft.grpc.admin.port = 0 (custom)
2021-08-23 12:50:37,355 [Listener at 127.0.0.1/39619] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(44)) - raft.grpc.client.port = 0 (custom)
2021-08-23 12:50:37,355 [Listener at 127.0.0.1/39619] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(44)) - raft.grpc.server.port = 0 (default)
2021-08-23 12:50:37,355 [Listener at 127.0.0.1/39619] INFO  server.GrpcService (ConfUtils.java:logGet(44)) - raft.grpc.message.size.max = 32MB (=33554432) (custom)
2021-08-23 12:50:37,355 [Listener at 127.0.0.1/39619] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2021-08-23 12:50:37,355 [Listener at 127.0.0.1/39619] INFO  server.GrpcService (ConfUtils.java:logGet(44)) - raft.grpc.flow.control.window = 5MB (=5242880) (custom)
2021-08-23 12:50:37,356 [Listener at 127.0.0.1/39619] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.request.timeout = 60s (custom)
2021-08-23 12:50:37,356 [Listener at 127.0.0.1/39619] INFO  impl.DataStreamServerImpl (ConfUtils.java:logGet(44)) - raft.datastream.type = DISABLED (default)
2021-08-23 12:50:37,357 [Listener at 127.0.0.1/39619] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.slowness.timeout = 300s (custom)
2021-08-23 12:50:37,357 [Listener at 127.0.0.1/39619] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.leaderelection.leader.step-down.wait-time = 10s (default)
2021-08-23 12:50:37,357 [Listener at 127.0.0.1/39619] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.storage.dir = [/home/runner/work/ozone/ozone/hadoop-hdds/container-service/target/test-dir/TestDatanodeStateMachine/scm/ratis] (custom)
2021-08-23 12:50:37,383 [Test Data Node State Machine Thread - 0] ERROR datanode.InitDatanodeState (InitDatanodeState.java:call(85)) - Failed to get SCM addresses: Does not contain a valid host:port authority: x..y
2021-08-23 12:50:37,383 [Listener at 127.0.0.1/39619] INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(326)) - Attempting to stop container services.
2021-08-23 12:50:37,384 [Listener at 127.0.0.1/39619] INFO  utils.BackgroundService (BackgroundService.java:shutdown(132)) - Shutting down service BlockDeletingService
2021-08-23 12:50:40,385 [Listener at 127.0.0.1/39619] INFO  common.TestDatanodeStateMachine (TestDatanodeStateMachine.java:lambda$testDatanodeStateMachineWithInvalidConfiguration$2(405)) - Test with ozone.scm.names = scm:xyz
2021-08-23 12:50:40,386 [Listener at 127.0.0.1/39619] INFO  upgrade.AbstractLayoutVersionManager (AbstractLayoutVersionManager.java:init(70)) - Initializing Layout version manager with metadata layout = SCM_HA (version = 2), software layout = SCM_HA (version = 2)
2021-08-23 12:50:40,386 [Listener at 127.0.0.1/39619] WARN  util.MBeans (MBeans.java:getMBeanName(167)) - Error creating MBean object name: Hadoop:service=LayoutVersionManager,name=HDDSLayoutVersionManager
org.apache.hadoop.metrics2.MetricsException: org.apache.hadoop.metrics2.MetricsException: Hadoop:service=LayoutVersionManager,name=HDDSLayoutVersionManager already exists!
	at org.apache.hadoop.metrics2.lib.DefaultMetricsSystem.newObjectName(DefaultMetricsSystem.java:135)
	at org.apache.hadoop.metrics2.lib.DefaultMetricsSystem.newMBeanName(DefaultMetricsSystem.java:110)
	at org.apache.hadoop.metrics2.util.MBeans.getMBeanName(MBeans.java:165)
	at org.apache.hadoop.metrics2.util.MBeans.register(MBeans.java:97)
	at org.apache.hadoop.metrics2.util.MBeans.register(MBeans.java:73)
	at org.apache.hadoop.ozone.upgrade.AbstractLayoutVersionManager.init(AbstractLayoutVersionManager.java:75)
	at org.apache.hadoop.hdds.upgrade.HDDSLayoutVersionManager.<init>(HDDSLayoutVersionManager.java:50)
	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.<init>(DatanodeStateMachine.java:134)
	at org.apache.hadoop.ozone.container.common.TestDatanodeStateMachine.lambda$testDatanodeStateMachineWithInvalidConfiguration$2(TestDatanodeStateMachine.java:407)
	at java.util.ArrayList.forEach(ArrayList.java:1259)
	at org.apache.hadoop.ozone.container.common.TestDatanodeStateMachine.testDatanodeStateMachineWithInvalidConfiguration(TestDatanodeStateMachine.java:402)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:365)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeWithRerun(JUnit4Provider.java:273)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:238)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:159)
	at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:384)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:345)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:126)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:418)
Caused by: org.apache.hadoop.metrics2.MetricsException: Hadoop:service=LayoutVersionManager,name=HDDSLayoutVersionManager already exists!
	at org.apache.hadoop.metrics2.lib.DefaultMetricsSystem.newObjectName(DefaultMetricsSystem.java:131)
	... 40 more
2021-08-23 12:50:40,423 [Listener at 127.0.0.1/39619] INFO  reflections.Reflections (Reflections.java:scan(232)) - Reflections took 36 ms to scan 4 urls, producing 97 keys and 214 values 
2021-08-23 12:50:40,425 [Listener at 127.0.0.1/39619] ERROR statemachine.DatanodeStateMachine (DatanodeStateMachine.java:getEndPointTaskThreadPoolSize(208)) - Fail to get scm addresses
java.lang.IllegalArgumentException: Unparseable port number: scm:xyz
	at com.google.common.net.HostAndPort.fromString(HostAndPort.java:196)
	at org.apache.hadoop.hdds.HddsUtils.getHostPort(HddsUtils.java:210)
	at org.apache.hadoop.hdds.HddsUtils.getSCMAddressForDatanodes(HddsUtils.java:279)
	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.getEndPointTaskThreadPoolSize(DatanodeStateMachine.java:206)
	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.<init>(DatanodeStateMachine.java:140)
	at org.apache.hadoop.ozone.container.common.TestDatanodeStateMachine.lambda$testDatanodeStateMachineWithInvalidConfiguration$2(TestDatanodeStateMachine.java:407)
	at java.util.ArrayList.forEach(ArrayList.java:1259)
	at org.apache.hadoop.ozone.container.common.TestDatanodeStateMachine.testDatanodeStateMachineWithInvalidConfiguration(TestDatanodeStateMachine.java:402)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:365)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeWithRerun(JUnit4Provider.java:273)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:238)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:159)
	at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:384)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:345)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:126)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:418)
2021-08-23 12:50:40,427 [Listener at 127.0.0.1/39619] INFO  volume.HddsVolume (HddsVolume.java:<init>(120)) - Creating HddsVolume: /home/runner/work/ozone/ozone/hadoop-hdds/container-service/target/test-dir/TestDatanodeStateMachine/data/hdds of storage type : DISK capacity : 9223372036854775807
2021-08-23 12:50:40,427 [Listener at 127.0.0.1/39619] INFO  volume.MutableVolumeSet (MutableVolumeSet.java:initializeVolumeSet(181)) - Added Volume : /home/runner/work/ozone/ozone/hadoop-hdds/container-service/target/test-dir/TestDatanodeStateMachine/data/hdds to VolumeSet
2021-08-23 12:50:40,427 [Listener at 127.0.0.1/39619] INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(141)) - Scheduling a check for /home/runner/work/ozone/ozone/hadoop-hdds/container-service/target/test-dir/TestDatanodeStateMachine/data/hdds
2021-08-23 12:50:40,427 [Listener at 127.0.0.1/39619] INFO  volume.StorageVolumeChecker (StorageVolumeChecker.java:checkAllVolumes(202)) - Scheduled health check for volume /home/runner/work/ozone/ozone/hadoop-hdds/container-service/target/test-dir/TestDatanodeStateMachine/data/hdds
2021-08-23 12:50:40,436 [Listener at 127.0.0.1/39619] WARN  server.ServerUtils (ServerUtils.java:getDefaultRatisDirectory(237)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2021-08-23 12:50:40,436 [Listener at 127.0.0.1/39619] INFO  volume.MutableVolumeSet (MutableVolumeSet.java:initializeVolumeSet(181)) - Added Volume : /home/runner/work/ozone/ozone/hadoop-hdds/container-service/target/test-dir/TestDatanodeStateMachine/scm/ratis to VolumeSet
2021-08-23 12:50:40,436 [Listener at 127.0.0.1/39619] INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(141)) - Scheduling a check for /home/runner/work/ozone/ozone/hadoop-hdds/container-service/target/test-dir/TestDatanodeStateMachine/scm/ratis
2021-08-23 12:50:40,436 [Listener at 127.0.0.1/39619] INFO  volume.StorageVolumeChecker (StorageVolumeChecker.java:checkAllVolumes(202)) - Scheduled health check for volume /home/runner/work/ozone/ozone/hadoop-hdds/container-service/target/test-dir/TestDatanodeStateMachine/scm/ratis
2021-08-23 12:50:40,460 [Listener at 127.0.0.1/39619] INFO  ozoneimpl.ContainerReader (ContainerReader.java:<init>(98)) - Running in upgrade mode:true
2021-08-23 12:50:40,460 [Thread-55] INFO  ozoneimpl.ContainerReader (ContainerReader.java:readVolume(142)) - Start to verify containers on volume /home/runner/work/ozone/ozone/hadoop-hdds/container-service/target/test-dir/TestDatanodeStateMachine/data/hdds
2021-08-23 12:50:40,460 [Thread-55] INFO  ozoneimpl.ContainerReader (ContainerReader.java:readVolume(174)) - Finish verifying containers on volume /home/runner/work/ozone/ozone/hadoop-hdds/container-service/target/test-dir/TestDatanodeStateMachine/data/hdds
2021-08-23 12:50:40,460 [Listener at 127.0.0.1/39619] INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:buildContainerSet(237)) - Build ContainerSet costs 0s
2021-08-23 12:50:40,462 [Listener at 127.0.0.1/39619] WARN  server.ServerUtils (ServerUtils.java:getDefaultRatisDirectory(237)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2021-08-23 12:50:40,463 [Listener at 127.0.0.1/39619] INFO  server.RaftServer (ConfUtils.java:logGet(44)) - raft.rpc.type = GRPC (default)
2021-08-23 12:50:40,463 [Listener at 127.0.0.1/39619] INFO  grpc.GrpcFactory (GrpcFactory.java:checkPooledByteBufAllocatorUseCacheForAllThreads(48)) - PERFORMANCE WARNING: useCacheForAllThreads is true that may cause Netty to create a lot garbage objects and, as a result, trigger GC.
	It is recommended to disable useCacheForAllThreads by setting -Dorg.apache.ratis.thirdparty.io.netty.allocator.useCacheForAllThreads=false in command line.
2021-08-23 12:50:40,465 [Listener at 127.0.0.1/39619] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(44)) - raft.grpc.admin.port = 0 (custom)
2021-08-23 12:50:40,465 [Listener at 127.0.0.1/39619] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(44)) - raft.grpc.client.port = 0 (custom)
2021-08-23 12:50:40,466 [Listener at 127.0.0.1/39619] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(44)) - raft.grpc.server.port = 0 (default)
2021-08-23 12:50:40,466 [Listener at 127.0.0.1/39619] INFO  server.GrpcService (ConfUtils.java:logGet(44)) - raft.grpc.message.size.max = 32MB (=33554432) (custom)
2021-08-23 12:50:40,466 [Listener at 127.0.0.1/39619] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2021-08-23 12:50:40,466 [Listener at 127.0.0.1/39619] INFO  server.GrpcService (ConfUtils.java:logGet(44)) - raft.grpc.flow.control.window = 5MB (=5242880) (custom)
2021-08-23 12:50:40,466 [Listener at 127.0.0.1/39619] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.request.timeout = 60s (custom)
2021-08-23 12:50:40,467 [Listener at 127.0.0.1/39619] INFO  impl.DataStreamServerImpl (ConfUtils.java:logGet(44)) - raft.datastream.type = DISABLED (default)
2021-08-23 12:50:40,467 [Listener at 127.0.0.1/39619] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.slowness.timeout = 300s (custom)
2021-08-23 12:50:40,468 [Listener at 127.0.0.1/39619] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.leaderelection.leader.step-down.wait-time = 10s (default)
2021-08-23 12:50:40,468 [Listener at 127.0.0.1/39619] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.storage.dir = [/home/runner/work/ozone/ozone/hadoop-hdds/container-service/target/test-dir/TestDatanodeStateMachine/scm/ratis] (custom)
2021-08-23 12:50:40,478 [Test Data Node State Machine Thread - 0] ERROR datanode.InitDatanodeState (InitDatanodeState.java:call(85)) - Failed to get SCM addresses: Unparseable port number: scm:xyz
2021-08-23 12:50:40,479 [Listener at 127.0.0.1/39619] INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(326)) - Attempting to stop container services.
2021-08-23 12:50:40,479 [Listener at 127.0.0.1/39619] INFO  utils.BackgroundService (BackgroundService.java:shutdown(132)) - Shutting down service BlockDeletingService
2021-08-23 12:50:43,481 [Listener at 127.0.0.1/39619] INFO  common.TestDatanodeStateMachine (TestDatanodeStateMachine.java:lambda$testDatanodeStateMachineWithInvalidConfiguration$2(405)) - Test with ozone.scm.names = scm:123456
2021-08-23 12:50:43,485 [Listener at 127.0.0.1/39619] INFO  upgrade.AbstractLayoutVersionManager (AbstractLayoutVersionManager.java:init(70)) - Initializing Layout version manager with metadata layout = SCM_HA (version = 2), software layout = SCM_HA (version = 2)
2021-08-23 12:50:43,486 [Listener at 127.0.0.1/39619] WARN  util.MBeans (MBeans.java:getMBeanName(167)) - Error creating MBean object name: Hadoop:service=LayoutVersionManager,name=HDDSLayoutVersionManager
org.apache.hadoop.metrics2.MetricsException: org.apache.hadoop.metrics2.MetricsException: Hadoop:service=LayoutVersionManager,name=HDDSLayoutVersionManager already exists!
	at org.apache.hadoop.metrics2.lib.DefaultMetricsSystem.newObjectName(DefaultMetricsSystem.java:135)
	at org.apache.hadoop.metrics2.lib.DefaultMetricsSystem.newMBeanName(DefaultMetricsSystem.java:110)
	at org.apache.hadoop.metrics2.util.MBeans.getMBeanName(MBeans.java:165)
	at org.apache.hadoop.metrics2.util.MBeans.register(MBeans.java:97)
	at org.apache.hadoop.metrics2.util.MBeans.register(MBeans.java:73)
	at org.apache.hadoop.ozone.upgrade.AbstractLayoutVersionManager.init(AbstractLayoutVersionManager.java:75)
	at org.apache.hadoop.hdds.upgrade.HDDSLayoutVersionManager.<init>(HDDSLayoutVersionManager.java:50)
	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.<init>(DatanodeStateMachine.java:134)
	at org.apache.hadoop.ozone.container.common.TestDatanodeStateMachine.lambda$testDatanodeStateMachineWithInvalidConfiguration$2(TestDatanodeStateMachine.java:407)
	at java.util.ArrayList.forEach(ArrayList.java:1259)
	at org.apache.hadoop.ozone.container.common.TestDatanodeStateMachine.testDatanodeStateMachineWithInvalidConfiguration(TestDatanodeStateMachine.java:402)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:365)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeWithRerun(JUnit4Provider.java:273)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:238)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:159)
	at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:384)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:345)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:126)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:418)
Caused by: org.apache.hadoop.metrics2.MetricsException: Hadoop:service=LayoutVersionManager,name=HDDSLayoutVersionManager already exists!
	at org.apache.hadoop.metrics2.lib.DefaultMetricsSystem.newObjectName(DefaultMetricsSystem.java:131)
	... 40 more
2021-08-23 12:50:43,556 [Listener at 127.0.0.1/39619] INFO  reflections.Reflections (Reflections.java:scan(232)) - Reflections took 62 ms to scan 4 urls, producing 97 keys and 214 values 
2021-08-23 12:50:43,560 [Listener at 127.0.0.1/39619] ERROR statemachine.DatanodeStateMachine (DatanodeStateMachine.java:getEndPointTaskThreadPoolSize(208)) - Fail to get scm addresses
java.lang.IllegalArgumentException: Port number out of range: scm:123456
	at com.google.common.base.Preconditions.checkArgument(Preconditions.java:219)
	at com.google.common.net.HostAndPort.fromString(HostAndPort.java:198)
	at org.apache.hadoop.hdds.HddsUtils.getHostPort(HddsUtils.java:210)
	at org.apache.hadoop.hdds.HddsUtils.getSCMAddressForDatanodes(HddsUtils.java:279)
	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.getEndPointTaskThreadPoolSize(DatanodeStateMachine.java:206)
	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.<init>(DatanodeStateMachine.java:140)
	at org.apache.hadoop.ozone.container.common.TestDatanodeStateMachine.lambda$testDatanodeStateMachineWithInvalidConfiguration$2(TestDatanodeStateMachine.java:407)
	at java.util.ArrayList.forEach(ArrayList.java:1259)
	at org.apache.hadoop.ozone.container.common.TestDatanodeStateMachine.testDatanodeStateMachineWithInvalidConfiguration(TestDatanodeStateMachine.java:402)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:365)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeWithRerun(JUnit4Provider.java:273)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:238)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:159)
	at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:384)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:345)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:126)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:418)
2021-08-23 12:50:43,573 [Listener at 127.0.0.1/39619] INFO  volume.HddsVolume (HddsVolume.java:<init>(120)) - Creating HddsVolume: /home/runner/work/ozone/ozone/hadoop-hdds/container-service/target/test-dir/TestDatanodeStateMachine/data/hdds of storage type : DISK capacity : 9223372036854775807
2021-08-23 12:50:43,573 [Listener at 127.0.0.1/39619] INFO  volume.MutableVolumeSet (MutableVolumeSet.java:initializeVolumeSet(181)) - Added Volume : /home/runner/work/ozone/ozone/hadoop-hdds/container-service/target/test-dir/TestDatanodeStateMachine/data/hdds to VolumeSet
2021-08-23 12:50:43,573 [Listener at 127.0.0.1/39619] INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(141)) - Scheduling a check for /home/runner/work/ozone/ozone/hadoop-hdds/container-service/target/test-dir/TestDatanodeStateMachine/data/hdds
2021-08-23 12:50:43,577 [Listener at 127.0.0.1/39619] INFO  volume.StorageVolumeChecker (StorageVolumeChecker.java:checkAllVolumes(202)) - Scheduled health check for volume /home/runner/work/ozone/ozone/hadoop-hdds/container-service/target/test-dir/TestDatanodeStateMachine/data/hdds
2021-08-23 12:50:43,592 [Listener at 127.0.0.1/39619] WARN  server.ServerUtils (ServerUtils.java:getDefaultRatisDirectory(237)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2021-08-23 12:50:43,593 [Listener at 127.0.0.1/39619] INFO  volume.MutableVolumeSet (MutableVolumeSet.java:initializeVolumeSet(181)) - Added Volume : /home/runner/work/ozone/ozone/hadoop-hdds/container-service/target/test-dir/TestDatanodeStateMachine/scm/ratis to VolumeSet
2021-08-23 12:50:43,598 [Listener at 127.0.0.1/39619] INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(141)) - Scheduling a check for /home/runner/work/ozone/ozone/hadoop-hdds/container-service/target/test-dir/TestDatanodeStateMachine/scm/ratis
2021-08-23 12:50:43,598 [Listener at 127.0.0.1/39619] INFO  volume.StorageVolumeChecker (StorageVolumeChecker.java:checkAllVolumes(202)) - Scheduled health check for volume /home/runner/work/ozone/ozone/hadoop-hdds/container-service/target/test-dir/TestDatanodeStateMachine/scm/ratis
2021-08-23 12:50:43,619 [Listener at 127.0.0.1/39619] INFO  ozoneimpl.ContainerReader (ContainerReader.java:<init>(98)) - Running in upgrade mode:true
2021-08-23 12:50:43,619 [Thread-57] INFO  ozoneimpl.ContainerReader (ContainerReader.java:readVolume(142)) - Start to verify containers on volume /home/runner/work/ozone/ozone/hadoop-hdds/container-service/target/test-dir/TestDatanodeStateMachine/data/hdds
2021-08-23 12:50:43,620 [Thread-57] INFO  ozoneimpl.ContainerReader (ContainerReader.java:readVolume(174)) - Finish verifying containers on volume /home/runner/work/ozone/ozone/hadoop-hdds/container-service/target/test-dir/TestDatanodeStateMachine/data/hdds
2021-08-23 12:50:43,620 [Listener at 127.0.0.1/39619] INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:buildContainerSet(237)) - Build ContainerSet costs 0s
2021-08-23 12:50:43,621 [Listener at 127.0.0.1/39619] WARN  server.ServerUtils (ServerUtils.java:getDefaultRatisDirectory(237)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2021-08-23 12:50:43,622 [Listener at 127.0.0.1/39619] INFO  server.RaftServer (ConfUtils.java:logGet(44)) - raft.rpc.type = GRPC (default)
2021-08-23 12:50:43,627 [Listener at 127.0.0.1/39619] INFO  grpc.GrpcFactory (GrpcFactory.java:checkPooledByteBufAllocatorUseCacheForAllThreads(48)) - PERFORMANCE WARNING: useCacheForAllThreads is true that may cause Netty to create a lot garbage objects and, as a result, trigger GC.
	It is recommended to disable useCacheForAllThreads by setting -Dorg.apache.ratis.thirdparty.io.netty.allocator.useCacheForAllThreads=false in command line.
2021-08-23 12:50:43,627 [Listener at 127.0.0.1/39619] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(44)) - raft.grpc.admin.port = 0 (custom)
2021-08-23 12:50:43,628 [Listener at 127.0.0.1/39619] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(44)) - raft.grpc.client.port = 0 (custom)
2021-08-23 12:50:43,628 [Listener at 127.0.0.1/39619] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(44)) - raft.grpc.server.port = 0 (default)
2021-08-23 12:50:43,628 [Listener at 127.0.0.1/39619] INFO  server.GrpcService (ConfUtils.java:logGet(44)) - raft.grpc.message.size.max = 32MB (=33554432) (custom)
2021-08-23 12:50:43,628 [Listener at 127.0.0.1/39619] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2021-08-23 12:50:43,629 [Listener at 127.0.0.1/39619] INFO  server.GrpcService (ConfUtils.java:logGet(44)) - raft.grpc.flow.control.window = 5MB (=5242880) (custom)
2021-08-23 12:50:43,629 [Listener at 127.0.0.1/39619] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.request.timeout = 60s (custom)
2021-08-23 12:50:43,630 [Listener at 127.0.0.1/39619] INFO  impl.DataStreamServerImpl (ConfUtils.java:logGet(44)) - raft.datastream.type = DISABLED (default)
2021-08-23 12:50:43,630 [Listener at 127.0.0.1/39619] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.slowness.timeout = 300s (custom)
2021-08-23 12:50:43,632 [Listener at 127.0.0.1/39619] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.leaderelection.leader.step-down.wait-time = 10s (default)
2021-08-23 12:50:43,634 [Listener at 127.0.0.1/39619] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.storage.dir = [/home/runner/work/ozone/ozone/hadoop-hdds/container-service/target/test-dir/TestDatanodeStateMachine/scm/ratis] (custom)
2021-08-23 12:50:43,656 [Test Data Node State Machine Thread - 0] ERROR datanode.InitDatanodeState (InitDatanodeState.java:call(85)) - Failed to get SCM addresses: Port number out of range: scm:123456
2021-08-23 12:50:43,656 [Listener at 127.0.0.1/39619] INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(326)) - Attempting to stop container services.
2021-08-23 12:50:43,656 [Listener at 127.0.0.1/39619] INFO  utils.BackgroundService (BackgroundService.java:shutdown(132)) - Shutting down service BlockDeletingService
2021-08-23 12:50:46,658 [Listener at 127.0.0.1/39619] INFO  common.TestDatanodeStateMachine (TestDatanodeStateMachine.java:lambda$testDatanodeStateMachineWithInvalidConfiguration$2(405)) - Test with ozone.scm.datanode.id.dir = 
2021-08-23 12:50:46,663 [Listener at 127.0.0.1/39619] INFO  upgrade.AbstractLayoutVersionManager (AbstractLayoutVersionManager.java:init(70)) - Initializing Layout version manager with metadata layout = SCM_HA (version = 2), software layout = SCM_HA (version = 2)
2021-08-23 12:50:46,664 [Listener at 127.0.0.1/39619] WARN  util.MBeans (MBeans.java:getMBeanName(167)) - Error creating MBean object name: Hadoop:service=LayoutVersionManager,name=HDDSLayoutVersionManager
org.apache.hadoop.metrics2.MetricsException: org.apache.hadoop.metrics2.MetricsException: Hadoop:service=LayoutVersionManager,name=HDDSLayoutVersionManager already exists!
	at org.apache.hadoop.metrics2.lib.DefaultMetricsSystem.newObjectName(DefaultMetricsSystem.java:135)
	at org.apache.hadoop.metrics2.lib.DefaultMetricsSystem.newMBeanName(DefaultMetricsSystem.java:110)
	at org.apache.hadoop.metrics2.util.MBeans.getMBeanName(MBeans.java:165)
	at org.apache.hadoop.metrics2.util.MBeans.register(MBeans.java:97)
	at org.apache.hadoop.metrics2.util.MBeans.register(MBeans.java:73)
	at org.apache.hadoop.ozone.upgrade.AbstractLayoutVersionManager.init(AbstractLayoutVersionManager.java:75)
	at org.apache.hadoop.hdds.upgrade.HDDSLayoutVersionManager.<init>(HDDSLayoutVersionManager.java:50)
	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.<init>(DatanodeStateMachine.java:134)
	at org.apache.hadoop.ozone.container.common.TestDatanodeStateMachine.lambda$testDatanodeStateMachineWithInvalidConfiguration$2(TestDatanodeStateMachine.java:407)
	at java.util.ArrayList.forEach(ArrayList.java:1259)
	at org.apache.hadoop.ozone.container.common.TestDatanodeStateMachine.testDatanodeStateMachineWithInvalidConfiguration(TestDatanodeStateMachine.java:402)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:365)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeWithRerun(JUnit4Provider.java:273)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:238)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:159)
	at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:384)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:345)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:126)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:418)
Caused by: org.apache.hadoop.metrics2.MetricsException: Hadoop:service=LayoutVersionManager,name=HDDSLayoutVersionManager already exists!
	at org.apache.hadoop.metrics2.lib.DefaultMetricsSystem.newObjectName(DefaultMetricsSystem.java:131)
	... 40 more
2021-08-23 12:50:46,819 [Listener at 127.0.0.1/39619] INFO  reflections.Reflections (Reflections.java:scan(232)) - Reflections took 143 ms to scan 4 urls, producing 97 keys and 214 values 
2021-08-23 12:50:46,837 [Listener at 127.0.0.1/39619] INFO  volume.HddsVolume (HddsVolume.java:<init>(120)) - Creating HddsVolume: /home/runner/work/ozone/ozone/hadoop-hdds/container-service/target/test-dir/TestDatanodeStateMachine/data/hdds of storage type : DISK capacity : 9223372036854775807
2021-08-23 12:50:46,837 [Listener at 127.0.0.1/39619] INFO  volume.MutableVolumeSet (MutableVolumeSet.java:initializeVolumeSet(181)) - Added Volume : /home/runner/work/ozone/ozone/hadoop-hdds/container-service/target/test-dir/TestDatanodeStateMachine/data/hdds to VolumeSet
2021-08-23 12:50:46,837 [Listener at 127.0.0.1/39619] INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(141)) - Scheduling a check for /home/runner/work/ozone/ozone/hadoop-hdds/container-service/target/test-dir/TestDatanodeStateMachine/data/hdds
2021-08-23 12:50:46,838 [Listener at 127.0.0.1/39619] INFO  volume.StorageVolumeChecker (StorageVolumeChecker.java:checkAllVolumes(202)) - Scheduled health check for volume /home/runner/work/ozone/ozone/hadoop-hdds/container-service/target/test-dir/TestDatanodeStateMachine/data/hdds
2021-08-23 12:50:46,863 [Listener at 127.0.0.1/39619] WARN  server.ServerUtils (ServerUtils.java:getDefaultRatisDirectory(237)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2021-08-23 12:50:46,864 [Listener at 127.0.0.1/39619] INFO  volume.MutableVolumeSet (MutableVolumeSet.java:initializeVolumeSet(181)) - Added Volume : /home/runner/work/ozone/ozone/hadoop-hdds/container-service/target/test-dir/TestDatanodeStateMachine/scm/ratis to VolumeSet
2021-08-23 12:50:46,864 [Listener at 127.0.0.1/39619] INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(141)) - Scheduling a check for /home/runner/work/ozone/ozone/hadoop-hdds/container-service/target/test-dir/TestDatanodeStateMachine/scm/ratis
2021-08-23 12:50:46,865 [Listener at 127.0.0.1/39619] INFO  volume.StorageVolumeChecker (StorageVolumeChecker.java:checkAllVolumes(202)) - Scheduled health check for volume /home/runner/work/ozone/ozone/hadoop-hdds/container-service/target/test-dir/TestDatanodeStateMachine/scm/ratis
2021-08-23 12:50:46,892 [Listener at 127.0.0.1/39619] INFO  ozoneimpl.ContainerReader (ContainerReader.java:<init>(98)) - Running in upgrade mode:true
2021-08-23 12:50:46,894 [Thread-59] INFO  ozoneimpl.ContainerReader (ContainerReader.java:readVolume(142)) - Start to verify containers on volume /home/runner/work/ozone/ozone/hadoop-hdds/container-service/target/test-dir/TestDatanodeStateMachine/data/hdds
2021-08-23 12:50:46,894 [Thread-59] INFO  ozoneimpl.ContainerReader (ContainerReader.java:readVolume(174)) - Finish verifying containers on volume /home/runner/work/ozone/ozone/hadoop-hdds/container-service/target/test-dir/TestDatanodeStateMachine/data/hdds
2021-08-23 12:50:46,894 [Listener at 127.0.0.1/39619] INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:buildContainerSet(237)) - Build ContainerSet costs 0s
2021-08-23 12:50:46,895 [Listener at 127.0.0.1/39619] WARN  server.ServerUtils (ServerUtils.java:getDefaultRatisDirectory(237)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2021-08-23 12:50:46,897 [Listener at 127.0.0.1/39619] INFO  server.RaftServer (ConfUtils.java:logGet(44)) - raft.rpc.type = GRPC (default)
2021-08-23 12:50:46,897 [Listener at 127.0.0.1/39619] INFO  grpc.GrpcFactory (GrpcFactory.java:checkPooledByteBufAllocatorUseCacheForAllThreads(48)) - PERFORMANCE WARNING: useCacheForAllThreads is true that may cause Netty to create a lot garbage objects and, as a result, trigger GC.
	It is recommended to disable useCacheForAllThreads by setting -Dorg.apache.ratis.thirdparty.io.netty.allocator.useCacheForAllThreads=false in command line.
2021-08-23 12:50:46,897 [Listener at 127.0.0.1/39619] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(44)) - raft.grpc.admin.port = 0 (custom)
2021-08-23 12:50:46,897 [Listener at 127.0.0.1/39619] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(44)) - raft.grpc.client.port = 0 (custom)
2021-08-23 12:50:46,897 [Listener at 127.0.0.1/39619] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(44)) - raft.grpc.server.port = 0 (default)
2021-08-23 12:50:46,897 [Listener at 127.0.0.1/39619] INFO  server.GrpcService (ConfUtils.java:logGet(44)) - raft.grpc.message.size.max = 32MB (=33554432) (custom)
2021-08-23 12:50:46,897 [Listener at 127.0.0.1/39619] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2021-08-23 12:50:46,898 [Listener at 127.0.0.1/39619] INFO  server.GrpcService (ConfUtils.java:logGet(44)) - raft.grpc.flow.control.window = 5MB (=5242880) (custom)
2021-08-23 12:50:46,898 [Listener at 127.0.0.1/39619] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.request.timeout = 60s (custom)
2021-08-23 12:50:46,911 [Listener at 127.0.0.1/39619] INFO  impl.DataStreamServerImpl (ConfUtils.java:logGet(44)) - raft.datastream.type = DISABLED (default)
2021-08-23 12:50:46,912 [Listener at 127.0.0.1/39619] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.slowness.timeout = 300s (custom)
2021-08-23 12:50:46,916 [Listener at 127.0.0.1/39619] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.leaderelection.leader.step-down.wait-time = 10s (default)
2021-08-23 12:50:46,917 [Listener at 127.0.0.1/39619] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.storage.dir = [/home/runner/work/ozone/ozone/hadoop-hdds/container-service/target/test-dir/TestDatanodeStateMachine/scm/ratis] (custom)
2021-08-23 12:50:46,939 [Test Data Node State Machine Thread - 0] ERROR datanode.InitDatanodeState (InitDatanodeState.java:persistContainerDatanodeDetails(141)) - Writing to /datanode.id failed /datanode.id (Permission denied)
2021-08-23 12:50:46,940 [Listener at 127.0.0.1/39619] INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(326)) - Attempting to stop container services.
2021-08-23 12:50:46,954 [Listener at 127.0.0.1/39619] INFO  utils.BackgroundService (BackgroundService.java:shutdown(132)) - Shutting down service BlockDeletingService
2021-08-23 12:50:49,955 [Listener at 127.0.0.1/39619] INFO  ipc.Server (Server.java:stop(3414)) - Stopping server on 39619
2021-08-23 12:50:49,961 [IPC Server Responder] INFO  ipc.Server (Server.java:run(1512)) - Stopping IPC Server Responder
2021-08-23 12:50:49,961 [IPC Server listener on 39619] INFO  ipc.Server (Server.java:run(1376)) - Stopping IPC Server listener on 39619
2021-08-23 12:50:50,064 [Listener at 127.0.0.1/39619] INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(90)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 1000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false.
2021-08-23 12:50:50,067 [Socket Reader #1 for port 40977] INFO  ipc.Server (Server.java:run(1265)) - Starting Socket Reader #1 for port 40977
2021-08-23 12:50:50,110 [IPC Server Responder] INFO  ipc.Server (Server.java:run(1507)) - IPC Server Responder: starting
2021-08-23 12:50:50,123 [IPC Server listener on 40977] INFO  ipc.Server (Server.java:run(1344)) - IPC Server listener on 40977: starting
2021-08-23 12:50:50,268 [Listener at 127.0.0.1/40977] INFO  upgrade.AbstractLayoutVersionManager (AbstractLayoutVersionManager.java:init(70)) - Initializing Layout version manager with metadata layout = INITIAL_VERSION (version = 0), software layout = SCM_HA (version = 2)
2021-08-23 12:50:50,268 [Listener at 127.0.0.1/40977] WARN  util.MBeans (MBeans.java:getMBeanName(167)) - Error creating MBean object name: Hadoop:service=LayoutVersionManager,name=HDDSLayoutVersionManager
org.apache.hadoop.metrics2.MetricsException: org.apache.hadoop.metrics2.MetricsException: Hadoop:service=LayoutVersionManager,name=HDDSLayoutVersionManager already exists!
	at org.apache.hadoop.metrics2.lib.DefaultMetricsSystem.newObjectName(DefaultMetricsSystem.java:135)
	at org.apache.hadoop.metrics2.lib.DefaultMetricsSystem.newMBeanName(DefaultMetricsSystem.java:110)
	at org.apache.hadoop.metrics2.util.MBeans.getMBeanName(MBeans.java:165)
	at org.apache.hadoop.metrics2.util.MBeans.register(MBeans.java:97)
	at org.apache.hadoop.metrics2.util.MBeans.register(MBeans.java:73)
	at org.apache.hadoop.ozone.upgrade.AbstractLayoutVersionManager.init(AbstractLayoutVersionManager.java:75)
	at org.apache.hadoop.hdds.upgrade.HDDSLayoutVersionManager.<init>(HDDSLayoutVersionManager.java:50)
	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.<init>(DatanodeStateMachine.java:134)
	at org.apache.hadoop.ozone.container.common.TestDatanodeStateMachine.testDatanodeStateContext(TestDatanodeStateMachine.java:219)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:365)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeWithRerun(JUnit4Provider.java:273)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:238)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:159)
	at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:384)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:345)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:126)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:418)
Caused by: org.apache.hadoop.metrics2.MetricsException: Hadoop:service=LayoutVersionManager,name=HDDSLayoutVersionManager already exists!
	at org.apache.hadoop.metrics2.lib.DefaultMetricsSystem.newObjectName(DefaultMetricsSystem.java:131)
	... 38 more
2021-08-23 12:50:50,443 [Listener at 127.0.0.1/40977] INFO  reflections.Reflections (Reflections.java:scan(232)) - Reflections took 173 ms to scan 4 urls, producing 97 keys and 214 values 
2021-08-23 12:50:50,445 [Listener at 127.0.0.1/40977] INFO  upgrade.HDDSLayoutVersionManager (HDDSLayoutVersionManager.java:lambda$registerUpgradeActions$0(76)) - Registering Upgrade Action : DatanodeSchemaV2FinalizeAction
2021-08-23 12:50:50,446 [Listener at 127.0.0.1/40977] INFO  upgrade.HDDSLayoutVersionManager (HDDSLayoutVersionManager.java:lambda$registerUpgradeActions$0(76)) - Registering Upgrade Action : ScmHAFirstUpgradeLayoutChangeAction
2021-08-23 12:50:50,474 [Listener at 127.0.0.1/40977] INFO  volume.HddsVolume (HddsVolume.java:<init>(120)) - Creating HddsVolume: /home/runner/work/ozone/ozone/hadoop-hdds/container-service/target/test-dir/TestDatanodeStateMachine/data/hdds of storage type : DISK capacity : 9223372036854775807
2021-08-23 12:50:50,474 [Listener at 127.0.0.1/40977] INFO  volume.MutableVolumeSet (MutableVolumeSet.java:initializeVolumeSet(181)) - Added Volume : /home/runner/work/ozone/ozone/hadoop-hdds/container-service/target/test-dir/TestDatanodeStateMachine/data/hdds to VolumeSet
2021-08-23 12:50:50,475 [Listener at 127.0.0.1/40977] INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(141)) - Scheduling a check for /home/runner/work/ozone/ozone/hadoop-hdds/container-service/target/test-dir/TestDatanodeStateMachine/data/hdds
2021-08-23 12:50:50,498 [Listener at 127.0.0.1/40977] INFO  volume.StorageVolumeChecker (StorageVolumeChecker.java:checkAllVolumes(202)) - Scheduled health check for volume /home/runner/work/ozone/ozone/hadoop-hdds/container-service/target/test-dir/TestDatanodeStateMachine/data/hdds
2021-08-23 12:50:50,571 [Listener at 127.0.0.1/40977] WARN  server.ServerUtils (ServerUtils.java:getDefaultRatisDirectory(237)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2021-08-23 12:50:50,575 [Listener at 127.0.0.1/40977] INFO  volume.MutableVolumeSet (MutableVolumeSet.java:initializeVolumeSet(181)) - Added Volume : /home/runner/work/ozone/ozone/hadoop-hdds/container-service/target/test-dir/TestDatanodeStateMachine/scm/ratis to VolumeSet
2021-08-23 12:50:50,590 [Listener at 127.0.0.1/40977] INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(141)) - Scheduling a check for /home/runner/work/ozone/ozone/hadoop-hdds/container-service/target/test-dir/TestDatanodeStateMachine/scm/ratis
2021-08-23 12:50:50,595 [Listener at 127.0.0.1/40977] INFO  volume.StorageVolumeChecker (StorageVolumeChecker.java:checkAllVolumes(202)) - Scheduled health check for volume /home/runner/work/ozone/ozone/hadoop-hdds/container-service/target/test-dir/TestDatanodeStateMachine/scm/ratis
2021-08-23 12:50:50,633 [Listener at 127.0.0.1/40977] INFO  ozoneimpl.ContainerReader (ContainerReader.java:<init>(98)) - Running in upgrade mode:true
2021-08-23 12:50:50,649 [Thread-74] INFO  ozoneimpl.ContainerReader (ContainerReader.java:readVolume(142)) - Start to verify containers on volume /home/runner/work/ozone/ozone/hadoop-hdds/container-service/target/test-dir/TestDatanodeStateMachine/data/hdds
2021-08-23 12:50:50,649 [Thread-74] INFO  ozoneimpl.ContainerReader (ContainerReader.java:readVolume(174)) - Finish verifying containers on volume /home/runner/work/ozone/ozone/hadoop-hdds/container-service/target/test-dir/TestDatanodeStateMachine/data/hdds
2021-08-23 12:50:50,649 [Listener at 127.0.0.1/40977] INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:buildContainerSet(237)) - Build ContainerSet costs 0s
2021-08-23 12:50:50,656 [Listener at 127.0.0.1/40977] WARN  server.ServerUtils (ServerUtils.java:getDefaultRatisDirectory(237)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2021-08-23 12:50:50,662 [Listener at 127.0.0.1/40977] INFO  server.RaftServer (ConfUtils.java:logGet(44)) - raft.rpc.type = GRPC (default)
2021-08-23 12:50:50,673 [Listener at 127.0.0.1/40977] INFO  grpc.GrpcFactory (GrpcFactory.java:checkPooledByteBufAllocatorUseCacheForAllThreads(48)) - PERFORMANCE WARNING: useCacheForAllThreads is true that may cause Netty to create a lot garbage objects and, as a result, trigger GC.
	It is recommended to disable useCacheForAllThreads by setting -Dorg.apache.ratis.thirdparty.io.netty.allocator.useCacheForAllThreads=false in command line.
2021-08-23 12:50:50,674 [Listener at 127.0.0.1/40977] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(44)) - raft.grpc.admin.port = 0 (custom)
2021-08-23 12:50:50,674 [Listener at 127.0.0.1/40977] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(44)) - raft.grpc.client.port = 0 (custom)
2021-08-23 12:50:50,675 [Listener at 127.0.0.1/40977] INFO  grpc.GrpcConfigKeys (ConfUtils.java:logGet(44)) - raft.grpc.server.port = 0 (default)
2021-08-23 12:50:50,675 [Listener at 127.0.0.1/40977] INFO  server.GrpcService (ConfUtils.java:logGet(44)) - raft.grpc.message.size.max = 32MB (=33554432) (custom)
2021-08-23 12:50:50,675 [Listener at 127.0.0.1/40977] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2021-08-23 12:50:50,676 [Listener at 127.0.0.1/40977] INFO  server.GrpcService (ConfUtils.java:logGet(44)) - raft.grpc.flow.control.window = 5MB (=5242880) (custom)
2021-08-23 12:50:50,676 [Listener at 127.0.0.1/40977] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.request.timeout = 60s (custom)
2021-08-23 12:50:50,678 [Listener at 127.0.0.1/40977] INFO  impl.DataStreamServerImpl (ConfUtils.java:logGet(44)) - raft.datastream.type = DISABLED (default)
2021-08-23 12:50:50,679 [Listener at 127.0.0.1/40977] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.rpc.slowness.timeout = 300s (custom)
2021-08-23 12:50:50,679 [Listener at 127.0.0.1/40977] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.leaderelection.leader.step-down.wait-time = 10s (default)
2021-08-23 12:50:50,680 [Listener at 127.0.0.1/40977] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(44)) - raft.server.storage.dir = [/home/runner/work/ozone/ozone/hadoop-hdds/container-service/target/test-dir/TestDatanodeStateMachine/scm/ratis] (custom)
2021-08-23 12:50:51,912 [EndpointStateMachine task thread for /127.0.0.1:40977 - 0 ] WARN  statemachine.EndpointStateMachine (EndpointStateMachine.java:logIfNeeded(236)) - Unable to communicate to SCM server at localhost:40977 for past 0 seconds.
java.net.SocketTimeoutException: Call From fv-az12-587/10.1.0.19 to localhost:40977 failed on socket timeout exception: java.net.SocketTimeoutException: 500 millis timeout while waiting for channel to be ready for read. ch : java.nio.channels.SocketChannel[connected local=/127.0.0.1:39394 remote=/127.0.0.1:40977]; For more details see:  http://wiki.apache.org/hadoop/SocketTimeout
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.hadoop.net.NetUtils.wrapWithMessage(NetUtils.java:913)
	at org.apache.hadoop.net.NetUtils.wrapException(NetUtils.java:848)
	at org.apache.hadoop.ipc.Client.getRpcResponse(Client.java:1577)
	at org.apache.hadoop.ipc.Client.call(Client.java:1519)
	at org.apache.hadoop.ipc.Client.call(Client.java:1416)
	at org.apache.hadoop.ipc.ProtobufRpcEngine$Invoker.invoke(ProtobufRpcEngine.java:236)
	at org.apache.hadoop.ipc.ProtobufRpcEngine$Invoker.invoke(ProtobufRpcEngine.java:123)
	at com.sun.proxy.$Proxy41.submitRequest(Unknown Source)
	at org.apache.hadoop.ozone.protocolPB.StorageContainerDatanodeProtocolClientSideTranslatorPB.submitRequest(StorageContainerDatanodeProtocolClientSideTranslatorPB.java:117)
	at org.apache.hadoop.ozone.protocolPB.StorageContainerDatanodeProtocolClientSideTranslatorPB.getVersion(StorageContainerDatanodeProtocolClientSideTranslatorPB.java:133)
	at org.apache.hadoop.ozone.container.common.states.endpoint.VersionEndpointTask.call(VersionEndpointTask.java:71)
	at org.apache.hadoop.ozone.container.common.states.endpoint.VersionEndpointTask.call(VersionEndpointTask.java:42)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.net.SocketTimeoutException: 500 millis timeout while waiting for channel to be ready for read. ch : java.nio.channels.SocketChannel[connected local=/127.0.0.1:39394 remote=/127.0.0.1:40977]
	at org.apache.hadoop.net.SocketIOWithTimeout.doIO(SocketIOWithTimeout.java:164)
	at org.apache.hadoop.net.SocketInputStream.read(SocketInputStream.java:161)
	at org.apache.hadoop.net.SocketInputStream.read(SocketInputStream.java:131)
	at java.io.FilterInputStream.read(FilterInputStream.java:133)
	at java.io.BufferedInputStream.fill(BufferedInputStream.java:246)
	at java.io.BufferedInputStream.read(BufferedInputStream.java:265)
	at java.io.FilterInputStream.read(FilterInputStream.java:83)
	at java.io.FilterInputStream.read(FilterInputStream.java:83)
	at org.apache.hadoop.ipc.Client$Connection$PingInputStream.read(Client.java:563)
	at java.io.DataInputStream.readInt(DataInputStream.java:387)
	at org.apache.hadoop.ipc.Client$IpcStreams.readResponse(Client.java:1892)
	at org.apache.hadoop.ipc.Client$Connection.receiveRpcResponse(Client.java:1202)
	at org.apache.hadoop.ipc.Client$Connection.run(Client.java:1098)
2021-08-23 12:50:52,052 [IPC Server handler 0 on default port 40977] WARN  ipc.Server (Server.java:processResponse(1717)) - IPC Server handler 0 on default port 40977, call Call#0 Retry#0 org.apache.hadoop.ozone.protocol.StorageContainerDatanodeProtocol.submitRequest from 127.0.0.1:39394: output error
2021-08-23 12:50:52,054 [IPC Server handler 0 on default port 40977] INFO  ipc.Server (Server.java:run(2979)) - IPC Server handler 0 on default port 40977 caught an exception
java.nio.channels.ClosedChannelException
	at sun.nio.ch.SocketChannelImpl.ensureWriteOpen(SocketChannelImpl.java:269)
	at sun.nio.ch.SocketChannelImpl.write(SocketChannelImpl.java:460)
	at org.apache.hadoop.ipc.Server.channelWrite(Server.java:3605)
	at org.apache.hadoop.ipc.Server.access$1700(Server.java:141)
	at org.apache.hadoop.ipc.Server$Responder.processResponse(Server.java:1667)
	at org.apache.hadoop.ipc.Server$Responder.doRespond(Server.java:1737)
	at org.apache.hadoop.ipc.Server$Connection.sendResponse(Server.java:2837)
	at org.apache.hadoop.ipc.Server$Connection.access$300(Server.java:1809)
	at org.apache.hadoop.ipc.Server$RpcCall.doResponse(Server.java:1117)
	at org.apache.hadoop.ipc.Server$Call.doResponse(Server.java:909)
	at org.apache.hadoop.ipc.Server$Call.sendResponse(Server.java:895)
	at org.apache.hadoop.ipc.Server$RpcCall.run(Server.java:1052)
	at org.apache.hadoop.ipc.Server$RpcCall.run(Server.java:963)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1878)
	at org.apache.hadoop.ipc.Server$Handler.run(Server.java:2966)
2021-08-23 12:51:42,026 [Listener at 127.0.0.1/40977] INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(326)) - Attempting to stop container services.
2021-08-23 12:51:42,027 [Listener at 127.0.0.1/40977] INFO  utils.BackgroundService (BackgroundService.java:shutdown(132)) - Shutting down service BlockDeletingService
2021-08-23 12:51:45,027 [Listener at 127.0.0.1/40977] INFO  ipc.Server (Server.java:stop(3414)) - Stopping server on 40977
2021-08-23 12:51:45,029 [IPC Server Responder] INFO  ipc.Server (Server.java:run(1512)) - Stopping IPC Server Responder
2021-08-23 12:51:45,038 [IPC Server listener on 40977] INFO  ipc.Server (Server.java:run(1376)) - Stopping IPC Server listener on 40977
