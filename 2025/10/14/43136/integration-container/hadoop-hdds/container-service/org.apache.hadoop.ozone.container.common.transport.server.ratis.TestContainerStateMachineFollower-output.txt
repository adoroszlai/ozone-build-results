WARNING: A Java agent has been loaded dynamically (/home/runner/.m2/repository/net/bytebuddy/byte-buddy-agent/1.12.19/byte-buddy-agent-1.12.19.jar)
WARNING: If a serviceability tool is in use, please run with -XX:+EnableDynamicAgentLoading to hide this warning
WARNING: If a serviceability tool is not in use, please run with -Djdk.instrument.traceUsage for more information
WARNING: Dynamic loading of agents will be disallowed by default in a future release
2025-10-14 18:55:04,291 [ChunkWriter-1-0] ERROR ratis.ContainerStateMachine (ContainerStateMachine.java:lambda$writeStateMachineData$2(626)) - null: writeChunk writeStateMachineData failed: blockIdcontainerID: 1
localID: 1
 logIndex 1 chunkName 
java.lang.RuntimeException
	at org.apache.hadoop.ozone.container.common.transport.server.ratis.ContainerStateMachine.dispatchCommand(ContainerStateMachine.java:567)
	at org.apache.hadoop.ozone.container.common.transport.server.ratis.ContainerStateMachine.lambda$writeStateMachineData$2(ContainerStateMachine.java:622)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:317)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1144)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:642)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-10-14 18:55:04,313 [ChunkWriter-1-0] WARN  ratis.ContainerStateMachine (ContainerUtils.java:logAndReturnError(94)) - Operation: WriteChunk , Trace ID:  , Message: Prev writes to containers [1] failed, stopping all writes to container , Result: CONTAINER_UNHEALTHY , StorageContainerException Occurred.
org.apache.hadoop.hdds.scm.container.common.helpers.StorageContainerException: Prev writes to containers [1] failed, stopping all writes to container
	at org.apache.hadoop.ozone.container.common.transport.server.ratis.ContainerStateMachine.checkContainerHealthy(ContainerStateMachine.java:407)
	at org.apache.hadoop.ozone.container.common.transport.server.ratis.ContainerStateMachine.lambda$writeStateMachineData$2(ContainerStateMachine.java:614)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:317)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1144)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:642)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-10-14 18:55:04,373 [ChunkWriter-1-0] ERROR ratis.ContainerStateMachine (ContainerStateMachine.java:handleCommandResult(662)) - null: writeChunk writeStateMachineData failed: blockIdcontainerID: 2
localID: 1
 logIndex 2 chunkName  Error message: Prev writes to containers [1] failed, stopping all writes to container Container Result: CONTAINER_UNHEALTHY
2025-10-14 18:55:04,410 [ChunkWriter-1-0] ERROR ratis.ContainerStateMachine (ContainerStateMachine.java:handleCommandResult(662)) - null: writeChunk writeStateMachineData failed: blockIdcontainerID: 1
localID: 1
 logIndex 1 chunkName  Error message:  Container Result: CONTAINER_INTERNAL_ERROR
2025-10-14 18:55:04,412 [ChunkWriter-1-0] WARN  ratis.ContainerStateMachine (ContainerUtils.java:logAndReturnError(94)) - Operation: WriteChunk , Trace ID:  , Message: Prev writes to containers [1] failed, stopping all writes to container , Result: CONTAINER_UNHEALTHY , StorageContainerException Occurred.
org.apache.hadoop.hdds.scm.container.common.helpers.StorageContainerException: Prev writes to containers [1] failed, stopping all writes to container
	at org.apache.hadoop.ozone.container.common.transport.server.ratis.ContainerStateMachine.checkContainerHealthy(ContainerStateMachine.java:407)
	at org.apache.hadoop.ozone.container.common.transport.server.ratis.ContainerStateMachine.lambda$writeStateMachineData$2(ContainerStateMachine.java:614)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:317)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1144)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:642)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-10-14 18:55:04,413 [ChunkWriter-1-0] ERROR ratis.ContainerStateMachine (ContainerStateMachine.java:handleCommandResult(662)) - null: writeChunk writeStateMachineData failed: blockIdcontainerID: 2
localID: 1
 logIndex 2 chunkName  Error message: Prev writes to containers [1] failed, stopping all writes to container Container Result: CONTAINER_UNHEALTHY
2025-10-14 18:55:06,432 [main] ERROR ratis.ContainerStateMachine (ContainerStateMachine.java:validateLongRunningWrite(706)) - Write chunk has taken 2001895360ns crossing threshold 1000000000ns for index 1 groupId null, cancelling pending write chunk for this group
2025-10-14 18:55:06,433 [ChunkWriter-1-0] ERROR ratis.ContainerStateMachine (ContainerStateMachine.java:lambda$writeStateMachineData$2(626)) - null: writeChunk writeStateMachineData failed: blockIdcontainerID: 1
localID: 1
 logIndex 1 chunkName 
java.lang.InterruptedException: sleep interrupted
	at java.base/java.lang.Thread.sleep0(Native Method)
	at java.base/java.lang.Thread.sleep(Thread.java:509)
	at org.apache.hadoop.ozone.container.common.transport.server.ratis.TestContainerStateMachine.lambda$testWriteTimout$1(TestContainerStateMachine.java:218)
	at org.mockito.internal.stubbing.StubbedInvocationMatcher.answer(StubbedInvocationMatcher.java:42)
	at org.mockito.internal.handler.MockHandlerImpl.handle(MockHandlerImpl.java:103)
	at org.mockito.internal.handler.NullResultGuardian.handle(NullResultGuardian.java:29)
	at org.mockito.internal.handler.InvocationNotifierHandler.handle(InvocationNotifierHandler.java:34)
	at org.mockito.internal.creation.bytebuddy.MockMethodInterceptor.doIntercept(MockMethodInterceptor.java:82)
	at org.mockito.internal.creation.bytebuddy.MockMethodInterceptor.doIntercept(MockMethodInterceptor.java:56)
	at org.mockito.internal.creation.bytebuddy.MockMethodInterceptor$DispatcherDefaultingToRealMethod.interceptAbstract(MockMethodInterceptor.java:161)
	at org.apache.hadoop.ozone.container.common.interfaces.ContainerDispatcher$MockitoMock$eUvyqyR3.dispatch(Unknown Source)
	at org.apache.hadoop.ozone.container.common.transport.server.ratis.ContainerStateMachine.dispatchCommand(ContainerStateMachine.java:567)
	at org.apache.hadoop.ozone.container.common.transport.server.ratis.ContainerStateMachine.lambda$writeStateMachineData$2(ContainerStateMachine.java:622)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:317)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1144)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:642)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-10-14 18:55:06,459 [containerOpContainerOp-829a2aad-2599-4371-97ae-10dcfcea91a4-0] ERROR ratis.ContainerStateMachine (ContainerStateMachine.java:lambda$applyTransaction$10(1136)) - null: failed to applyTransaction at logIndex 1 for WriteChunk
java.lang.RuntimeException
	at org.apache.hadoop.ozone.container.common.transport.server.ratis.ContainerStateMachine.dispatchCommand(ContainerStateMachine.java:567)
	at org.apache.hadoop.ozone.container.common.transport.server.ratis.ContainerStateMachine.lambda$applyTransaction$8(ContainerStateMachine.java:1061)
	at org.apache.ratis.util.TaskQueue.lambda$submit$0(TaskQueue.java:121)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:78)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:572)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:317)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1144)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:642)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-10-14 18:55:06,461 [main] ERROR ratis.ContainerStateMachine (ContainerStateMachine.java:lambda$applyTransaction$10(1136)) - null: failed to applyTransaction at logIndex 1 for WriteChunk
java.util.concurrent.CompletionException: java.lang.RuntimeException
	at java.base/java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:332)
	at java.base/java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:347)
	at java.base/java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:636)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2194)
	at org.apache.ratis.util.TaskQueue.lambda$submit$0(TaskQueue.java:131)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:78)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:572)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:317)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1144)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:642)
	at java.base/java.lang.Thread.run(Thread.java:1583)
Caused by: java.lang.RuntimeException
	at org.apache.hadoop.ozone.container.common.transport.server.ratis.ContainerStateMachine.dispatchCommand(ContainerStateMachine.java:567)
	at org.apache.hadoop.ozone.container.common.transport.server.ratis.ContainerStateMachine.lambda$applyTransaction$8(ContainerStateMachine.java:1061)
	at org.apache.ratis.util.TaskQueue.lambda$submit$0(TaskQueue.java:121)
	... 7 more
2025-10-14 18:55:06,465 [containerOpContainerOp-829a2aad-2599-4371-97ae-10dcfcea91a4-1] WARN  ratis.ContainerStateMachine (ContainerUtils.java:logAndReturnError(94)) - Operation: WriteChunk , Trace ID:  , Message: Prev writes to container 1 failed, stopping all writes to container , Result: CONTAINER_UNHEALTHY , StorageContainerException Occurred.
org.apache.hadoop.hdds.scm.container.common.helpers.StorageContainerException: Prev writes to container 1 failed, stopping all writes to container
	at org.apache.hadoop.ozone.container.common.transport.server.ratis.ContainerStateMachine.checkContainerHealthy(ContainerStateMachine.java:404)
	at org.apache.hadoop.ozone.container.common.transport.server.ratis.ContainerStateMachine.lambda$applyTransaction$8(ContainerStateMachine.java:1052)
	at org.apache.ratis.util.TaskQueue.lambda$submit$0(TaskQueue.java:121)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:78)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:572)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:317)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1144)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:642)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-10-14 18:55:06,467 [containerOpContainerOp-829a2aad-2599-4371-97ae-10dcfcea91a4-1] ERROR ratis.ContainerStateMachine (ContainerStateMachine.java:lambda$applyTransaction$11(1163)) - gid null : ApplyTransaction failed. cmd WriteChunk logIndex 1 msg : Prev writes to container 1 failed, stopping all writes to container Container Result: CONTAINER_UNHEALTHY
2025-10-14 18:55:06,489 [containerOpContainerOp-880efe2f-edfa-4b9f-8f96-470ce237b6cd-0] ERROR ratis.ContainerStateMachine (ContainerStateMachine.java:lambda$applyTransaction$11(1163)) - gid null : ApplyTransaction failed. cmd WriteChunk logIndex 1 msg :  Container Result: CONTAINER_INTERNAL_ERROR
2025-10-14 18:55:06,492 [containerOpContainerOp-880efe2f-edfa-4b9f-8f96-470ce237b6cd-1] ERROR ratis.ContainerStateMachine (ContainerStateMachine.java:lambda$applyTransaction$10(1136)) - null: failed to applyTransaction at logIndex 1 for WriteChunk
java.util.concurrent.CompletionException: java.lang.NullPointerException: Cannot invoke "org.apache.hadoop.hdds.protocol.datanode.proto.ContainerProtos$ContainerCommandResponseProto.getResult()" because "r" is null
	at java.base/java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:315)
	at java.base/java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:320)
	at java.base/java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:649)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510)
	at java.base/java.util.concurrent.CompletableFuture.complete(CompletableFuture.java:2179)
	at org.apache.ratis.util.TaskQueue.lambda$submit$0(TaskQueue.java:133)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:38)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:78)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:572)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:317)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1144)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:642)
	at java.base/java.lang.Thread.run(Thread.java:1583)
Caused by: java.lang.NullPointerException: Cannot invoke "org.apache.hadoop.hdds.protocol.datanode.proto.ContainerProtos$ContainerCommandResponseProto.getResult()" because "r" is null
	at org.apache.hadoop.ozone.container.common.transport.server.ratis.ContainerStateMachine.lambda$applyTransaction$11(ContainerStateMachine.java:1157)
	at java.base/java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:646)
	... 10 more
