2025-11-06 18:21:05,759 [main] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchemaFromFile(128)) - Loading schema from [jar:file:/home/runner/work/ozone/ozone/hadoop-hdds/common/target/hdds-common-2.2.0-SNAPSHOT.jar!/network-topology-default.xml]
2025-11-06 18:21:05,765 [main] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchema(175)) - Loading network topology layer schema file
2025-11-06 18:21:05,821 [main] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchemaFromFile(128)) - Loading schema from [jar:file:/home/runner/work/ozone/ozone/hadoop-hdds/common/target/hdds-common-2.2.0-SNAPSHOT.jar!/network-topology-default.xml]
2025-11-06 18:21:05,822 [main] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchema(175)) - Loading network topology layer schema file
2025-11-06 18:21:06,077 [main] INFO  reflections.Reflections (Reflections.java:scan(219)) - Reflections took 184 ms to scan 6 urls, producing 167 keys and 377 values
2025-11-06 18:21:06,191 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(133)) - Added a new node: /default-rack/2755d403-2f9d-4c34-b0e9-1e6e48af8d93
2025-11-06 18:21:06,192 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(133)) - Added a new node: /default-rack/467f2985-3a6e-4753-8461-13c44317b010
2025-11-06 18:21:06,192 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(133)) - Added a new node: /default-rack/c71f2a3a-d26b-4a2e-9b16-32824482472e
2025-11-06 18:21:06,193 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(133)) - Added a new node: /default-rack/8887879d-f24c-475c-b12a-1f4214dd06a8
2025-11-06 18:21:06,194 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(133)) - Added a new node: /default-rack/d84b8777-ba26-4b44-9365-18a23a6c6ce5
2025-11-06 18:21:06,194 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(133)) - Added a new node: /default-rack/41cf6789-f3be-4048-bb46-4d3fa6367dc5
2025-11-06 18:21:06,195 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(133)) - Added a new node: /default-rack/079be237-7f3f-4b4a-851d-6a36c373b41b
2025-11-06 18:21:06,195 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(133)) - Added a new node: /default-rack/770e7e6d-522d-414b-8325-dcd13ed30c54
2025-11-06 18:21:06,196 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(133)) - Added a new node: /default-rack/07653ddf-a879-4a2e-99f9-0fc082ba36b2
2025-11-06 18:21:06,197 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(133)) - Added a new node: /default-rack/06d54a94-3727-478c-80e4-5a677cedbe68
2025-11-06 18:21:06,407 [main] WARN  utils.HAUtils (HAUtils.java:getMetaDir(311)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2025-11-06 18:21:06,538 [main] WARN  db.DBStoreBuilder (DBStoreBuilder.java:getDBDirPath(157)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2025-11-06 18:21:06,650 [main] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:<init>(231)) - Init the HA SequenceIdGenerator.
2025-11-06 18:21:06,659 [main] INFO  pipeline.PipelineStateManagerImpl (PipelineStateManagerImpl.java:initialize(75)) - No pipeline exists in current db
2025-11-06 18:21:06,682 [main] INFO  algorithms.LeaderChoosePolicyFactory (LeaderChoosePolicyFactory.java:getPolicy(55)) - Create leader choose policy of type org.apache.hadoop.hdds.scm.pipeline.leader.choose.algorithms.MinLeaderCountChoosePolicy
2025-11-06 18:21:06,691 [main] INFO  algorithms.ContainerPlacementPolicyFactory (ContainerPlacementPolicyFactory.java:getPolicyInternal(83)) - Create container placement policy of type org.apache.hadoop.hdds.scm.container.placement.algorithms.SCMContainerPlacementRackScatter
2025-11-06 18:21:06,804 [main] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service BackgroundPipelineCreator.
2025-11-06 18:21:06,805 [main] INFO  pipeline.BackgroundPipelineCreator (BackgroundPipelineCreator.java:start(126)) - Starting RatisPipelineUtilsThread.
2025-11-06 18:21:06,809 [main] INFO  BackgroundPipelineScrubber (BackgroundSCMService.java:start(64)) - Starting BackgroundPipelineScrubber Service.
2025-11-06 18:21:06,810 [main] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service BackgroundPipelineScrubber.
2025-11-06 18:21:06,811 [main] INFO  algorithms.LeaderChoosePolicyFactory (LeaderChoosePolicyFactory.java:getPolicy(55)) - Create leader choose policy of type org.apache.hadoop.hdds.scm.pipeline.leader.choose.algorithms.MinLeaderCountChoosePolicy
2025-11-06 18:21:06,869 [main] INFO  safemode.SCMSafeModeManager (AbstractContainerSafeModeRule.java:initializeRule(83)) - Refreshed RATIS Containers threshold count to 0.
2025-11-06 18:21:06,870 [main] INFO  safemode.SCMSafeModeManager (AbstractContainerSafeModeRule.java:initializeRule(83)) - Refreshed EC Containers threshold count to 0.
2025-11-06 18:21:06,874 [main] INFO  safemode.HealthyPipelineSafeModeRule (HealthyPipelineSafeModeRule.java:initializeRule(230)) - Total pipeline count is 0, healthy pipeline threshold count is 1
2025-11-06 18:21:06,877 [main] INFO  safemode.OneReplicaPipelineSafeModeRule (OneReplicaPipelineSafeModeRule.java:initializeRule(189)) - Total pipeline count is 0, pipeline's with at least one datanode reported threshold count is 0
2025-11-06 18:21:06,877 [main] INFO  safemode.SCMSafeModeManager (SCMSafeModeManager.java:<init>(102)) - Safemode is disabled, skipping Safemode rule validation and force exiting Safemode.
2025-11-06 18:21:06,878 [main] INFO  ha.SCMContext (SCMContext.java:updateSafeModeStatus(224)) - Update SafeModeStatus from SafeModeStatus{safeModeStatus=false, preCheckPassed=true} to SafeModeStatus{safeModeStatus=false, preCheckPassed=true}.
2025-11-06 18:21:06,878 [main] INFO  pipeline.BackgroundPipelineCreator (BackgroundPipelineCreator.java:notifyStatusChanged(268)) - Service BackgroundPipelineCreator transitions to RUNNING.
2025-11-06 18:21:06,879 [main] INFO  BackgroundPipelineScrubber (BackgroundSCMService.java:notifyStatusChanged(78)) - Service BackgroundPipelineScrubber transitions to RUNNING.
2025-11-06 18:21:06,886 [main] WARN  server.ServerUtils (ServerUtils.java:getScmDbDir(138)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2025-11-06 18:21:06,905 [main] WARN  server.ServerUtils (ServerUtils.java:getScmDbDir(138)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2025-11-06 18:21:06,908 [main] INFO  ha.SCMHANodeDetails (SCMHANodeDetails.java:loadSCMHAConfig(162)) - ServiceID for StorageContainerManager is null
2025-11-06 18:21:06,908 [main] INFO  ha.SCMHANodeDetails (SCMHANodeDetails.java:loadSCMHAConfig(166)) - ozone.scm.default.service.id is not defined, falling back to ozone.scm.service.ids to find serviceID for StorageContainerManager if it is HA enabled cluster
2025-11-06 18:21:07,287 [main] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchemaFromFile(128)) - Loading schema from [jar:file:/home/runner/work/ozone/ozone/hadoop-hdds/common/target/hdds-common-2.2.0-SNAPSHOT.jar!/network-topology-default.xml]
2025-11-06 18:21:07,288 [main] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchema(175)) - Loading network topology layer schema file
2025-11-06 18:21:07,306 [main] INFO  upgrade.AbstractLayoutVersionManager (AbstractLayoutVersionManager.java:init(80)) - Initializing Layout version manager with metadata layout = WITNESSED_CONTAINER_DB_PROTO_VALUE (version = 9), software layout = WITNESSED_CONTAINER_DB_PROTO_VALUE (version = 9)
2025-11-06 18:21:07,412 [main] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:upgradeToSequenceId(353)) - upgrade localId to 115816896921600000
2025-11-06 18:21:07,413 [main] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:upgradeToSequenceId(363)) - upgrade delTxnId to 0
2025-11-06 18:21:07,414 [main] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:upgradeToSequenceId(379)) - upgrade containerId to 0
2025-11-06 18:21:07,416 [main] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:upgradeToCertificateSequenceId(414)) - upgrade CertificateId to 2
2025-11-06 18:21:07,417 [main] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:<init>(231)) - Init the HA SequenceIdGenerator.
2025-11-06 18:21:07,419 [main] INFO  algorithms.ContainerPlacementPolicyFactory (ContainerPlacementPolicyFactory.java:getPolicyInternal(83)) - Create container placement policy of type org.apache.hadoop.hdds.scm.container.placement.algorithms.SCMContainerPlacementRackAware
2025-11-06 18:21:07,420 [main] INFO  algorithms.ContainerPlacementPolicyFactory (ContainerPlacementPolicyFactory.java:getPolicyInternal(83)) - Create container placement policy of type org.apache.hadoop.hdds.scm.container.placement.algorithms.SCMContainerPlacementRackScatter
2025-11-06 18:21:07,431 [main] INFO  ExpiredContainerReplicaOpScrubber (BackgroundSCMService.java:start(64)) - Starting ExpiredContainerReplicaOpScrubber Service.
2025-11-06 18:21:07,432 [main] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service ExpiredContainerReplicaOpScrubber.
2025-11-06 18:21:07,436 [main] INFO  algorithms.PipelineChoosePolicyFactory (PipelineChoosePolicyFactory.java:createPipelineChoosePolicyFromClass(78)) - Create pipeline choose policy of type org.apache.hadoop.hdds.scm.pipeline.choose.algorithms.RandomPipelineChoosePolicy
2025-11-06 18:21:07,436 [main] INFO  algorithms.PipelineChoosePolicyFactory (PipelineChoosePolicyFactory.java:createPipelineChoosePolicyFromClass(78)) - Create pipeline choose policy of type org.apache.hadoop.hdds.scm.pipeline.choose.algorithms.RandomPipelineChoosePolicy
2025-11-06 18:21:07,467 [main] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service SCMBlockDeletingService.
2025-11-06 18:21:07,532 [main] INFO  replication.ReplicationManager (ReplicationManager.java:start(287)) - Starting Replication Monitor Thread.
2025-11-06 18:21:07,537 [main] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service ReplicationManager.
2025-11-06 18:21:07,537 [ReplicationMonitor] INFO  replication.ReplicationManager (ReplicationManager.java:processAll(359)) - Replication Manager is not ready to run until 300000ms after safemode exit
2025-11-06 18:21:07,584 [main] WARN  util.NativeCodeLoader (NativeCodeLoader.java:<clinit>(60)) - Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
2025-11-06 18:21:07,600 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:<init>(432)) - SCM start with adminUsers: [runner]
2025-11-06 18:21:07,761 [main] INFO  audit.AuditLogger (AuditLogger.java:refreshDebugCmdSet(133)) - Refresh DebugCmdSet for SCMAudit to [].
2025-11-06 18:21:07,785 [main] INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(93)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 10000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false, ipcFailOver: false.
2025-11-06 18:21:07,811 [main] INFO  ipc.Server (Server.java:<init>(1438)) - Listener at 0.0.0.0:33001
2025-11-06 18:21:07,814 [Socket Reader #1 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #1 for port 0
2025-11-06 18:21:07,815 [Socket Reader #5 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #5 for port 0
2025-11-06 18:21:07,814 [Socket Reader #4 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #4 for port 0
2025-11-06 18:21:07,814 [Socket Reader #3 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #3 for port 0
2025-11-06 18:21:07,814 [Socket Reader #2 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #2 for port 0
2025-11-06 18:21:07,817 [Socket Reader #6 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #6 for port 0
2025-11-06 18:21:07,817 [Socket Reader #7 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #7 for port 0
2025-11-06 18:21:07,817 [Socket Reader #8 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #8 for port 0
2025-11-06 18:21:07,818 [Socket Reader #9 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #9 for port 0
2025-11-06 18:21:07,820 [Socket Reader #10 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #10 for port 0
2025-11-06 18:21:07,853 [main] INFO  audit.AuditLogger (AuditLogger.java:refreshDebugCmdSet(133)) - Refresh DebugCmdSet for SCMAudit to [].
2025-11-06 18:21:07,859 [main] INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(93)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 10000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false, ipcFailOver: false.
2025-11-06 18:21:07,860 [main] INFO  ipc.Server (Server.java:<init>(1438)) - Listener at 0.0.0.0:33731
2025-11-06 18:21:07,861 [Socket Reader #1 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #1 for port 0
2025-11-06 18:21:07,861 [Socket Reader #2 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #2 for port 0
2025-11-06 18:21:07,862 [Socket Reader #4 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #4 for port 0
2025-11-06 18:21:07,863 [Socket Reader #3 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #3 for port 0
2025-11-06 18:21:07,863 [Socket Reader #5 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #5 for port 0
2025-11-06 18:21:07,863 [Socket Reader #6 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #6 for port 0
2025-11-06 18:21:07,864 [Socket Reader #7 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #7 for port 0
2025-11-06 18:21:07,864 [Socket Reader #8 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #8 for port 0
2025-11-06 18:21:07,865 [Socket Reader #9 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #9 for port 0
2025-11-06 18:21:07,866 [Socket Reader #10 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #10 for port 0
2025-11-06 18:21:07,893 [main] INFO  audit.AuditLogger (AuditLogger.java:refreshDebugCmdSet(133)) - Refresh DebugCmdSet for SCMAudit to [].
2025-11-06 18:21:07,905 [main] INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(93)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 10000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false, ipcFailOver: false.
2025-11-06 18:21:07,905 [main] INFO  ipc.Server (Server.java:<init>(1438)) - Listener at 0.0.0.0:42887
2025-11-06 18:21:07,907 [Socket Reader #1 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #1 for port 0
2025-11-06 18:21:07,907 [Socket Reader #3 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #3 for port 0
2025-11-06 18:21:07,907 [Socket Reader #2 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #2 for port 0
2025-11-06 18:21:07,908 [Socket Reader #5 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #5 for port 0
2025-11-06 18:21:07,908 [Socket Reader #7 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #7 for port 0
2025-11-06 18:21:07,908 [Socket Reader #4 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #4 for port 0
2025-11-06 18:21:07,908 [Socket Reader #6 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #6 for port 0
2025-11-06 18:21:07,910 [Socket Reader #8 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #8 for port 0
2025-11-06 18:21:07,910 [Socket Reader #9 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #9 for port 0
2025-11-06 18:21:07,910 [Socket Reader #10 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #10 for port 0
2025-11-06 18:21:07,975 [main] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service ContainerBalancer.
2025-11-06 18:21:07,976 [main] INFO  ha.SCMContext (SCMContext.java:updateSafeModeStatus(224)) - Update SafeModeStatus from SafeModeStatus{safeModeStatus=false, preCheckPassed=true} to SafeModeStatus{safeModeStatus=false, preCheckPassed=true}.
2025-11-06 18:21:07,989 [main] INFO  ha.SCMContext (SCMContext.java:updateSafeModeStatus(224)) - Update SafeModeStatus from SafeModeStatus{safeModeStatus=false, preCheckPassed=true} to SafeModeStatus{safeModeStatus=false, preCheckPassed=true}.
2025-11-06 18:21:08,017 [main] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(208)) - Sending CreatePipelineCommand for pipeline:Pipeline-6f687ec2-ffe9-447e-928b-fb88de235fee to datanode:8887879d-f24c-475c-b12a-1f4214dd06a8(localhost-178.32.116.2/178.32.116.2)
2025-11-06 18:21:08,019 [main] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(208)) - Sending CreatePipelineCommand for pipeline:Pipeline-6f687ec2-ffe9-447e-928b-fb88de235fee to datanode:770e7e6d-522d-414b-8325-dcd13ed30c54(localhost-116.86.113.255/116.86.113.255)
2025-11-06 18:21:08,019 [main] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(208)) - Sending CreatePipelineCommand for pipeline:Pipeline-6f687ec2-ffe9-447e-928b-fb88de235fee to datanode:d84b8777-ba26-4b44-9365-18a23a6c6ce5(localhost-173.189.121.221/173.189.121.221)
2025-11-06 18:21:08,068 [main] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(208)) - Sending CreatePipelineCommand for pipeline:Pipeline-b1b6229a-5a77-4ed7-857d-ee626b2f887b to datanode:079be237-7f3f-4b4a-851d-6a36c373b41b(localhost-188.216.165.103/188.216.165.103)
2025-11-06 18:21:08,069 [main] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(208)) - Sending CreatePipelineCommand for pipeline:Pipeline-b1b6229a-5a77-4ed7-857d-ee626b2f887b to datanode:c71f2a3a-d26b-4a2e-9b16-32824482472e(localhost-186.114.140.136/186.114.140.136)
2025-11-06 18:21:08,070 [main] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(208)) - Sending CreatePipelineCommand for pipeline:Pipeline-b1b6229a-5a77-4ed7-857d-ee626b2f887b to datanode:2755d403-2f9d-4c34-b0e9-1e6e48af8d93(localhost-191.105.180.82/191.105.180.82)
2025-11-06 18:21:08,098 [main] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:getNextId(135)) - Allocate a batch for containerId, change lastId from 0 to 1000.
2025-11-06 18:21:08,110 [main] WARN  ha.SequenceIdGenerator (SequenceIdGenerator.java:allocateBatch(248)) - Failed to allocate a batch for localId, expected lastId is 0, actual lastId is 115816896921600000.
2025-11-06 18:21:08,111 [main] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:getNextId(135)) - Allocate a batch for localId, change lastId from 115816896921600000 to 115816896921601000.
2025-11-06 18:21:08,203 [EventQueue-CloseContainerForCloseContainerEventHandler] INFO  container.CloseContainerEventHandler (CloseContainerEventHandler.java:onMessage(88)) - Close container Event triggered for container : #4, current state: OPEN
2025-11-06 18:21:08,210 [EventQueue-CloseContainerForCloseContainerEventHandler] INFO  container.CloseContainerEventHandler (CloseContainerEventHandler.java:onMessage(88)) - Close container Event triggered for container : #5, current state: OPEN
2025-11-06 18:21:08,211 [EventQueue-CloseContainerForCloseContainerEventHandler] INFO  container.CloseContainerEventHandler (CloseContainerEventHandler.java:onMessage(88)) - Close container Event triggered for container : #6, current state: OPEN
2025-11-06 18:21:08,212 [EventQueue-CloseContainerForCloseContainerEventHandler] INFO  container.CloseContainerEventHandler (CloseContainerEventHandler.java:onMessage(88)) - Close container Event triggered for container : #1, current state: OPEN
2025-11-06 18:21:08,213 [EventQueue-CloseContainerForCloseContainerEventHandler] INFO  container.CloseContainerEventHandler (CloseContainerEventHandler.java:onMessage(88)) - Close container Event triggered for container : #2, current state: OPEN
2025-11-06 18:21:08,214 [EventQueue-CloseContainerForCloseContainerEventHandler] INFO  container.CloseContainerEventHandler (CloseContainerEventHandler.java:onMessage(88)) - Close container Event triggered for container : #3, current state: OPEN
2025-11-06 18:21:08,315 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1616)) - Container Balancer is not running.
2025-11-06 18:21:08,316 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stopReplicationManager(1749)) - Stopping Replication Manager Service.
2025-11-06 18:21:08,316 [main] INFO  replication.ReplicationManager (ReplicationManager.java:stop(318)) - Stopping Replication Monitor Thread.
2025-11-06 18:21:08,317 [OverReplicatedProcessor] WARN  replication.UnhealthyReplicationProcessor (UnhealthyReplicationProcessor.java:run(178)) - OverReplicatedProcessor interrupted. Exiting...
2025-11-06 18:21:08,318 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1625)) - Stopping the Datanode Admin Monitor.
2025-11-06 18:21:08,318 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1632)) - Stopping datanode service RPC server
2025-11-06 18:21:08,318 [main] INFO  server.SCMDatanodeProtocolServer (SCMDatanodeProtocolServer.java:stop(455)) - Stopping the RPC server for DataNodes
2025-11-06 18:21:08,317 [UnderReplicatedProcessor] WARN  replication.UnhealthyReplicationProcessor (UnhealthyReplicationProcessor.java:run(178)) - UnderReplicatedProcessor interrupted. Exiting...
2025-11-06 18:21:08,320 [main] INFO  ipc.Server (Server.java:stop(3697)) - Stopping server on 33001
2025-11-06 18:21:08,319 [ReplicationMonitor] INFO  replication.ReplicationManager (ReplicationManager.java:run(938)) - Replication Monitor Thread is stopped
2025-11-06 18:21:08,323 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1640)) - Stopping block service RPC server
2025-11-06 18:21:08,323 [main] INFO  server.SCMBlockProtocolServer (SCMBlockProtocolServer.java:stop(175)) - Stopping the RPC server for Block Protocol
2025-11-06 18:21:08,324 [main] INFO  ipc.Server (Server.java:stop(3697)) - Stopping server on 33731
2025-11-06 18:21:08,326 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1647)) - Stopping the StorageContainerLocationProtocol RPC server
2025-11-06 18:21:08,327 [main] INFO  server.SCMClientProtocolServer (SCMClientProtocolServer.java:stop(218)) - Stopping the RPC server for Client Protocol
2025-11-06 18:21:08,327 [main] INFO  ipc.Server (Server.java:stop(3697)) - Stopping server on 42887
2025-11-06 18:21:08,329 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1654)) - Stopping Storage Container Manager HTTP server.
2025-11-06 18:21:08,329 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1662)) - Stopping SCM LayoutVersionManager Service.
2025-11-06 18:21:08,330 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1674)) - Stopping Block Manager Service.
2025-11-06 18:21:08,331 [main] INFO  utils.BackgroundService (BackgroundService.java:shutdown(195)) - Shutting down service SCMBlockDeletingService
2025-11-06 18:21:08,331 [main] INFO  utils.BackgroundService (BackgroundService.java:shutdown(195)) - Shutting down service SCMBlockDeletingService
2025-11-06 18:21:08,332 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1699)) - Stopping SCM Event Queue.
2025-11-06 18:21:08,334 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1706)) - Stopping SCM HA services.
2025-11-06 18:21:08,334 [main] INFO  pipeline.BackgroundPipelineCreator (BackgroundPipelineCreator.java:stop(154)) - Stopping RatisPipelineUtilsThread.
2025-11-06 18:21:08,335 [RatisPipelineUtilsThread-0] WARN  pipeline.BackgroundPipelineCreator (BackgroundPipelineCreator.java:run(185)) - RatisPipelineUtilsThread is interrupted.
2025-11-06 18:21:08,336 [main] INFO  BackgroundPipelineScrubber (BackgroundSCMService.java:stop(127)) - Stopping BackgroundPipelineScrubber Service.
2025-11-06 18:21:08,336 [BackgroundPipelineScrubber] WARN  BackgroundPipelineScrubber (BackgroundSCMService.java:run(111)) - BackgroundPipelineScrubber is interrupted, exit
2025-11-06 18:21:08,337 [main] INFO  ExpiredContainerReplicaOpScrubber (BackgroundSCMService.java:stop(127)) - Stopping ExpiredContainerReplicaOpScrubber Service.
2025-11-06 18:21:08,337 [ExpiredContainerReplicaOpScrubber] WARN  ExpiredContainerReplicaOpScrubber (BackgroundSCMService.java:run(111)) - ExpiredContainerReplicaOpScrubber is interrupted, exit
2025-11-06 18:21:08,338 [main] INFO  utils.BackgroundService (BackgroundService.java:shutdown(195)) - Shutting down service SCMBlockDeletingService
2025-11-06 18:21:08,338 [main] INFO  replication.ReplicationManager (ReplicationManager.java:stop(325)) - Replication Monitor Thread is not running.
2025-11-06 18:21:08,339 [main] WARN  balancer.ContainerBalancer (ContainerBalancer.java:stop(362)) - Cannot stop Container Balancer because it's not running or stopping
2025-11-06 18:21:08,339 [test-leaseManagerLeaseManager#LeaseMonitor] WARN  lease.LeaseManager (LeaseManager.java:run(285)) - Lease manager is interrupted. Shutting down...
java.lang.InterruptedException
	at java.base/java.util.concurrent.locks.AbstractQueuedSynchronizer.tryAcquireSharedNanos(AbstractQueuedSynchronizer.java:1167)
	at java.base/java.util.concurrent.Semaphore.tryAcquire(Semaphore.java:415)
	at org.apache.hadoop.ozone.lease.LeaseManager$LeaseMonitor.run(LeaseManager.java:283)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-11-06 18:21:08,339 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1740)) - Stopping SCM MetadataStore.
2025-11-06 18:21:08,396 [main] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchemaFromFile(128)) - Loading schema from [jar:file:/home/runner/work/ozone/ozone/hadoop-hdds/common/target/hdds-common-2.2.0-SNAPSHOT.jar!/network-topology-default.xml]
2025-11-06 18:21:08,396 [main] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchema(175)) - Loading network topology layer schema file
2025-11-06 18:21:08,415 [main] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchemaFromFile(128)) - Loading schema from [jar:file:/home/runner/work/ozone/ozone/hadoop-hdds/common/target/hdds-common-2.2.0-SNAPSHOT.jar!/network-topology-default.xml]
2025-11-06 18:21:08,415 [main] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchema(175)) - Loading network topology layer schema file
2025-11-06 18:21:08,418 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(133)) - Added a new node: /default-rack/22bf694d-4bb5-43ef-8c01-a853d64de3bb
2025-11-06 18:21:08,418 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(133)) - Added a new node: /default-rack/a3c8eede-2563-48bc-9df5-152690283de8
2025-11-06 18:21:08,419 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(133)) - Added a new node: /default-rack/e209645e-511f-4ee6-8a96-ac9acaf55f9c
2025-11-06 18:21:08,419 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(133)) - Added a new node: /default-rack/6c625bc3-cf46-4efb-ae0c-885b6af26308
2025-11-06 18:21:08,419 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(133)) - Added a new node: /default-rack/bd958b17-44a1-4448-9444-09832cf2bd4d
2025-11-06 18:21:08,420 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(133)) - Added a new node: /default-rack/8008126b-a590-4e6a-8139-284c6e91cc77
2025-11-06 18:21:08,420 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(133)) - Added a new node: /default-rack/112950e2-701f-4aff-b272-9f311a4e6896
2025-11-06 18:21:08,420 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(133)) - Added a new node: /default-rack/4698f9e5-7b72-4ed8-874b-8bce3f3bb0f0
2025-11-06 18:21:08,421 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(133)) - Added a new node: /default-rack/655d3278-8adc-43c8-a932-95c81e642625
2025-11-06 18:21:08,421 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(133)) - Added a new node: /default-rack/3315a547-8b05-422a-8b56-158cd5581f01
2025-11-06 18:21:08,421 [main] WARN  utils.HAUtils (HAUtils.java:getMetaDir(311)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2025-11-06 18:21:08,422 [main] WARN  db.DBStoreBuilder (DBStoreBuilder.java:getDBDirPath(157)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2025-11-06 18:21:08,487 [main] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:<init>(231)) - Init the HA SequenceIdGenerator.
2025-11-06 18:21:08,488 [main] INFO  pipeline.PipelineStateManagerImpl (PipelineStateManagerImpl.java:initialize(75)) - No pipeline exists in current db
2025-11-06 18:21:08,488 [main] INFO  algorithms.LeaderChoosePolicyFactory (LeaderChoosePolicyFactory.java:getPolicy(55)) - Create leader choose policy of type org.apache.hadoop.hdds.scm.pipeline.leader.choose.algorithms.MinLeaderCountChoosePolicy
2025-11-06 18:21:08,489 [main] INFO  algorithms.ContainerPlacementPolicyFactory (ContainerPlacementPolicyFactory.java:getPolicyInternal(83)) - Create container placement policy of type org.apache.hadoop.hdds.scm.container.placement.algorithms.SCMContainerPlacementRackScatter
2025-11-06 18:21:08,490 [main] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service BackgroundPipelineCreator.
2025-11-06 18:21:08,490 [main] INFO  pipeline.BackgroundPipelineCreator (BackgroundPipelineCreator.java:start(126)) - Starting RatisPipelineUtilsThread.
2025-11-06 18:21:08,490 [main] INFO  BackgroundPipelineScrubber (BackgroundSCMService.java:start(64)) - Starting BackgroundPipelineScrubber Service.
2025-11-06 18:21:08,491 [main] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service BackgroundPipelineScrubber.
2025-11-06 18:21:08,491 [main] INFO  algorithms.LeaderChoosePolicyFactory (LeaderChoosePolicyFactory.java:getPolicy(55)) - Create leader choose policy of type org.apache.hadoop.hdds.scm.pipeline.leader.choose.algorithms.MinLeaderCountChoosePolicy
2025-11-06 18:21:08,493 [main] INFO  safemode.SCMSafeModeManager (AbstractContainerSafeModeRule.java:initializeRule(83)) - Refreshed RATIS Containers threshold count to 0.
2025-11-06 18:21:08,494 [main] INFO  safemode.SCMSafeModeManager (AbstractContainerSafeModeRule.java:initializeRule(83)) - Refreshed EC Containers threshold count to 0.
2025-11-06 18:21:08,494 [main] INFO  safemode.HealthyPipelineSafeModeRule (HealthyPipelineSafeModeRule.java:initializeRule(230)) - Total pipeline count is 0, healthy pipeline threshold count is 1
2025-11-06 18:21:08,495 [main] INFO  safemode.OneReplicaPipelineSafeModeRule (OneReplicaPipelineSafeModeRule.java:initializeRule(189)) - Total pipeline count is 0, pipeline's with at least one datanode reported threshold count is 0
2025-11-06 18:21:08,495 [main] INFO  safemode.SCMSafeModeManager (SCMSafeModeManager.java:<init>(102)) - Safemode is disabled, skipping Safemode rule validation and force exiting Safemode.
2025-11-06 18:21:08,495 [main] INFO  ha.SCMContext (SCMContext.java:updateSafeModeStatus(224)) - Update SafeModeStatus from SafeModeStatus{safeModeStatus=false, preCheckPassed=true} to SafeModeStatus{safeModeStatus=false, preCheckPassed=true}.
2025-11-06 18:21:08,495 [main] INFO  pipeline.BackgroundPipelineCreator (BackgroundPipelineCreator.java:notifyStatusChanged(268)) - Service BackgroundPipelineCreator transitions to RUNNING.
2025-11-06 18:21:08,496 [main] INFO  BackgroundPipelineScrubber (BackgroundSCMService.java:notifyStatusChanged(78)) - Service BackgroundPipelineScrubber transitions to RUNNING.
2025-11-06 18:21:08,496 [main] WARN  server.ServerUtils (ServerUtils.java:getScmDbDir(138)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2025-11-06 18:21:08,498 [main] WARN  server.ServerUtils (ServerUtils.java:getScmDbDir(138)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2025-11-06 18:21:08,499 [main] INFO  ha.SCMHANodeDetails (SCMHANodeDetails.java:loadSCMHAConfig(162)) - ServiceID for StorageContainerManager is null
2025-11-06 18:21:08,499 [main] INFO  ha.SCMHANodeDetails (SCMHANodeDetails.java:loadSCMHAConfig(166)) - ozone.scm.default.service.id is not defined, falling back to ozone.scm.service.ids to find serviceID for StorageContainerManager if it is HA enabled cluster
2025-11-06 18:21:08,501 [main] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchemaFromFile(128)) - Loading schema from [jar:file:/home/runner/work/ozone/ozone/hadoop-hdds/common/target/hdds-common-2.2.0-SNAPSHOT.jar!/network-topology-default.xml]
2025-11-06 18:21:08,501 [main] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchema(175)) - Loading network topology layer schema file
2025-11-06 18:21:08,504 [main] INFO  upgrade.AbstractLayoutVersionManager (AbstractLayoutVersionManager.java:init(80)) - Initializing Layout version manager with metadata layout = WITNESSED_CONTAINER_DB_PROTO_VALUE (version = 9), software layout = WITNESSED_CONTAINER_DB_PROTO_VALUE (version = 9)
2025-11-06 18:21:08,506 [main] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:upgradeToSequenceId(353)) - upgrade localId to 115816896921600000
2025-11-06 18:21:08,507 [main] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:upgradeToSequenceId(363)) - upgrade delTxnId to 0
2025-11-06 18:21:08,508 [main] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:upgradeToSequenceId(379)) - upgrade containerId to 0
2025-11-06 18:21:08,509 [main] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:upgradeToCertificateSequenceId(414)) - upgrade CertificateId to 2
2025-11-06 18:21:08,509 [main] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:<init>(231)) - Init the HA SequenceIdGenerator.
2025-11-06 18:21:08,510 [main] INFO  algorithms.ContainerPlacementPolicyFactory (ContainerPlacementPolicyFactory.java:getPolicyInternal(83)) - Create container placement policy of type org.apache.hadoop.hdds.scm.container.placement.algorithms.SCMContainerPlacementRackAware
2025-11-06 18:21:08,510 [main] INFO  algorithms.ContainerPlacementPolicyFactory (ContainerPlacementPolicyFactory.java:getPolicyInternal(83)) - Create container placement policy of type org.apache.hadoop.hdds.scm.container.placement.algorithms.SCMContainerPlacementRackScatter
2025-11-06 18:21:08,511 [main] INFO  ExpiredContainerReplicaOpScrubber (BackgroundSCMService.java:start(64)) - Starting ExpiredContainerReplicaOpScrubber Service.
2025-11-06 18:21:08,511 [main] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service ExpiredContainerReplicaOpScrubber.
2025-11-06 18:21:08,512 [main] INFO  algorithms.PipelineChoosePolicyFactory (PipelineChoosePolicyFactory.java:createPipelineChoosePolicyFromClass(78)) - Create pipeline choose policy of type org.apache.hadoop.hdds.scm.pipeline.choose.algorithms.RandomPipelineChoosePolicy
2025-11-06 18:21:08,513 [main] INFO  algorithms.PipelineChoosePolicyFactory (PipelineChoosePolicyFactory.java:createPipelineChoosePolicyFromClass(78)) - Create pipeline choose policy of type org.apache.hadoop.hdds.scm.pipeline.choose.algorithms.RandomPipelineChoosePolicy
2025-11-06 18:21:08,515 [main] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service SCMBlockDeletingService.
2025-11-06 18:21:08,517 [main] INFO  replication.ReplicationManager (ReplicationManager.java:start(287)) - Starting Replication Monitor Thread.
2025-11-06 18:21:08,518 [main] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service ReplicationManager.
2025-11-06 18:21:08,518 [ReplicationMonitor] INFO  replication.ReplicationManager (ReplicationManager.java:processAll(359)) - Replication Manager is not ready to run until 300000ms after safemode exit
2025-11-06 18:21:08,519 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:<init>(432)) - SCM start with adminUsers: [runner]
2025-11-06 18:21:08,520 [main] INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(93)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 10000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false, ipcFailOver: false.
2025-11-06 18:21:08,520 [main] INFO  ipc.Server (Server.java:<init>(1438)) - Listener at 0.0.0.0:37747
2025-11-06 18:21:08,521 [Socket Reader #1 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #1 for port 0
2025-11-06 18:21:08,521 [Socket Reader #2 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #2 for port 0
2025-11-06 18:21:08,521 [Socket Reader #3 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #3 for port 0
2025-11-06 18:21:08,522 [Socket Reader #4 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #4 for port 0
2025-11-06 18:21:08,522 [Socket Reader #5 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #5 for port 0
2025-11-06 18:21:08,523 [Socket Reader #6 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #6 for port 0
2025-11-06 18:21:08,523 [Socket Reader #7 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #7 for port 0
2025-11-06 18:21:08,524 [Socket Reader #8 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #8 for port 0
2025-11-06 18:21:08,525 [Socket Reader #9 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #9 for port 0
2025-11-06 18:21:08,526 [Socket Reader #10 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #10 for port 0
2025-11-06 18:21:08,527 [main] INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(93)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 10000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false, ipcFailOver: false.
2025-11-06 18:21:08,528 [main] INFO  ipc.Server (Server.java:<init>(1438)) - Listener at 0.0.0.0:44827
2025-11-06 18:21:08,529 [Socket Reader #1 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #1 for port 0
2025-11-06 18:21:08,529 [Socket Reader #2 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #2 for port 0
2025-11-06 18:21:08,530 [Socket Reader #3 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #3 for port 0
2025-11-06 18:21:08,531 [Socket Reader #5 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #5 for port 0
2025-11-06 18:21:08,531 [Socket Reader #4 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #4 for port 0
2025-11-06 18:21:08,531 [Socket Reader #6 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #6 for port 0
2025-11-06 18:21:08,531 [Socket Reader #7 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #7 for port 0
2025-11-06 18:21:08,532 [Socket Reader #8 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #8 for port 0
2025-11-06 18:21:08,532 [Socket Reader #9 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #9 for port 0
2025-11-06 18:21:08,533 [Socket Reader #10 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #10 for port 0
2025-11-06 18:21:08,534 [main] INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(93)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 10000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false, ipcFailOver: false.
2025-11-06 18:21:08,535 [main] INFO  ipc.Server (Server.java:<init>(1438)) - Listener at 0.0.0.0:34725
2025-11-06 18:21:08,536 [Socket Reader #1 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #1 for port 0
2025-11-06 18:21:08,536 [Socket Reader #2 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #2 for port 0
2025-11-06 18:21:08,537 [Socket Reader #3 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #3 for port 0
2025-11-06 18:21:08,537 [Socket Reader #4 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #4 for port 0
2025-11-06 18:21:08,538 [Socket Reader #5 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #5 for port 0
2025-11-06 18:21:08,538 [Socket Reader #6 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #6 for port 0
2025-11-06 18:21:08,539 [Socket Reader #7 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #7 for port 0
2025-11-06 18:21:08,539 [Socket Reader #8 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #8 for port 0
2025-11-06 18:21:08,539 [Socket Reader #9 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #9 for port 0
2025-11-06 18:21:08,539 [Socket Reader #10 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #10 for port 0
2025-11-06 18:21:08,546 [main] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service ContainerBalancer.
2025-11-06 18:21:08,547 [main] INFO  ha.SCMContext (SCMContext.java:updateSafeModeStatus(224)) - Update SafeModeStatus from SafeModeStatus{safeModeStatus=false, preCheckPassed=true} to SafeModeStatus{safeModeStatus=false, preCheckPassed=true}.
2025-11-06 18:21:08,548 [main] INFO  ha.SCMContext (SCMContext.java:updateSafeModeStatus(224)) - Update SafeModeStatus from SafeModeStatus{safeModeStatus=false, preCheckPassed=true} to SafeModeStatus{safeModeStatus=false, preCheckPassed=true}.
2025-11-06 18:21:08,551 [main] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(208)) - Sending CreatePipelineCommand for pipeline:Pipeline-e7091542-9382-42a0-8a59-1c657f361dc1 to datanode:6c625bc3-cf46-4efb-ae0c-885b6af26308(localhost-113.30.229.251/113.30.229.251)
2025-11-06 18:21:08,552 [main] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(208)) - Sending CreatePipelineCommand for pipeline:Pipeline-e7091542-9382-42a0-8a59-1c657f361dc1 to datanode:bd958b17-44a1-4448-9444-09832cf2bd4d(localhost-150.107.209.236/150.107.209.236)
2025-11-06 18:21:08,552 [main] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(208)) - Sending CreatePipelineCommand for pipeline:Pipeline-e7091542-9382-42a0-8a59-1c657f361dc1 to datanode:22bf694d-4bb5-43ef-8c01-a853d64de3bb(localhost-19.221.226.32/19.221.226.32)
2025-11-06 18:21:08,556 [main] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(208)) - Sending CreatePipelineCommand for pipeline:Pipeline-753cf1af-b114-43a0-9a62-53175d3c2261 to datanode:4698f9e5-7b72-4ed8-874b-8bce3f3bb0f0(localhost-88.214.171.129/88.214.171.129)
2025-11-06 18:21:08,556 [main] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(208)) - Sending CreatePipelineCommand for pipeline:Pipeline-753cf1af-b114-43a0-9a62-53175d3c2261 to datanode:22bf694d-4bb5-43ef-8c01-a853d64de3bb(localhost-19.221.226.32/19.221.226.32)
2025-11-06 18:21:08,557 [main] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(208)) - Sending CreatePipelineCommand for pipeline:Pipeline-753cf1af-b114-43a0-9a62-53175d3c2261 to datanode:6c625bc3-cf46-4efb-ae0c-885b6af26308(localhost-113.30.229.251/113.30.229.251)
2025-11-06 18:21:08,562 [main] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:getNextId(135)) - Allocate a batch for containerId, change lastId from 0 to 1000.
2025-11-06 18:21:08,563 [main] WARN  ha.SequenceIdGenerator (SequenceIdGenerator.java:allocateBatch(248)) - Failed to allocate a batch for localId, expected lastId is 0, actual lastId is 115816896921600000.
2025-11-06 18:21:08,564 [main] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:getNextId(135)) - Allocate a batch for localId, change lastId from 115816896921600000 to 115816896921601000.
2025-11-06 18:21:08,566 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1616)) - Container Balancer is not running.
2025-11-06 18:21:08,566 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stopReplicationManager(1749)) - Stopping Replication Manager Service.
2025-11-06 18:21:08,566 [main] INFO  replication.ReplicationManager (ReplicationManager.java:stop(318)) - Stopping Replication Monitor Thread.
2025-11-06 18:21:08,567 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1625)) - Stopping the Datanode Admin Monitor.
2025-11-06 18:21:08,567 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1632)) - Stopping datanode service RPC server
2025-11-06 18:21:08,567 [main] INFO  server.SCMDatanodeProtocolServer (SCMDatanodeProtocolServer.java:stop(455)) - Stopping the RPC server for DataNodes
2025-11-06 18:21:08,567 [ReplicationMonitor] INFO  replication.ReplicationManager (ReplicationManager.java:run(938)) - Replication Monitor Thread is stopped
2025-11-06 18:21:08,568 [UnderReplicatedProcessor] WARN  replication.UnhealthyReplicationProcessor (UnhealthyReplicationProcessor.java:run(178)) - UnderReplicatedProcessor interrupted. Exiting...
2025-11-06 18:21:08,567 [OverReplicatedProcessor] WARN  replication.UnhealthyReplicationProcessor (UnhealthyReplicationProcessor.java:run(178)) - OverReplicatedProcessor interrupted. Exiting...
2025-11-06 18:21:08,567 [main] INFO  ipc.Server (Server.java:stop(3697)) - Stopping server on 37747
2025-11-06 18:21:08,571 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1640)) - Stopping block service RPC server
2025-11-06 18:21:08,572 [main] INFO  server.SCMBlockProtocolServer (SCMBlockProtocolServer.java:stop(175)) - Stopping the RPC server for Block Protocol
2025-11-06 18:21:08,572 [main] INFO  ipc.Server (Server.java:stop(3697)) - Stopping server on 44827
2025-11-06 18:21:08,574 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1647)) - Stopping the StorageContainerLocationProtocol RPC server
2025-11-06 18:21:08,574 [main] INFO  server.SCMClientProtocolServer (SCMClientProtocolServer.java:stop(218)) - Stopping the RPC server for Client Protocol
2025-11-06 18:21:08,575 [main] INFO  ipc.Server (Server.java:stop(3697)) - Stopping server on 34725
2025-11-06 18:21:08,577 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1654)) - Stopping Storage Container Manager HTTP server.
2025-11-06 18:21:08,578 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1662)) - Stopping SCM LayoutVersionManager Service.
2025-11-06 18:21:08,578 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1674)) - Stopping Block Manager Service.
2025-11-06 18:21:08,579 [main] INFO  utils.BackgroundService (BackgroundService.java:shutdown(195)) - Shutting down service SCMBlockDeletingService
2025-11-06 18:21:08,579 [main] INFO  utils.BackgroundService (BackgroundService.java:shutdown(195)) - Shutting down service SCMBlockDeletingService
2025-11-06 18:21:08,579 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1699)) - Stopping SCM Event Queue.
2025-11-06 18:21:08,581 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1706)) - Stopping SCM HA services.
2025-11-06 18:21:08,581 [main] INFO  pipeline.BackgroundPipelineCreator (BackgroundPipelineCreator.java:stop(154)) - Stopping RatisPipelineUtilsThread.
2025-11-06 18:21:08,582 [RatisPipelineUtilsThread-0] WARN  pipeline.BackgroundPipelineCreator (BackgroundPipelineCreator.java:run(185)) - RatisPipelineUtilsThread is interrupted.
2025-11-06 18:21:08,582 [BackgroundPipelineScrubber] WARN  BackgroundPipelineScrubber (BackgroundSCMService.java:run(111)) - BackgroundPipelineScrubber is interrupted, exit
2025-11-06 18:21:08,583 [main] INFO  BackgroundPipelineScrubber (BackgroundSCMService.java:stop(127)) - Stopping BackgroundPipelineScrubber Service.
2025-11-06 18:21:08,583 [main] INFO  ExpiredContainerReplicaOpScrubber (BackgroundSCMService.java:stop(127)) - Stopping ExpiredContainerReplicaOpScrubber Service.
2025-11-06 18:21:08,583 [ExpiredContainerReplicaOpScrubber] WARN  ExpiredContainerReplicaOpScrubber (BackgroundSCMService.java:run(111)) - ExpiredContainerReplicaOpScrubber is interrupted, exit
2025-11-06 18:21:08,583 [main] INFO  utils.BackgroundService (BackgroundService.java:shutdown(195)) - Shutting down service SCMBlockDeletingService
2025-11-06 18:21:08,584 [main] INFO  replication.ReplicationManager (ReplicationManager.java:stop(325)) - Replication Monitor Thread is not running.
2025-11-06 18:21:08,584 [main] WARN  balancer.ContainerBalancer (ContainerBalancer.java:stop(362)) - Cannot stop Container Balancer because it's not running or stopping
2025-11-06 18:21:08,584 [test-leaseManagerLeaseManager#LeaseMonitor] WARN  lease.LeaseManager (LeaseManager.java:run(285)) - Lease manager is interrupted. Shutting down...
java.lang.InterruptedException
	at java.base/java.util.concurrent.locks.AbstractQueuedSynchronizer.tryAcquireSharedNanos(AbstractQueuedSynchronizer.java:1167)
	at java.base/java.util.concurrent.Semaphore.tryAcquire(Semaphore.java:415)
	at org.apache.hadoop.ozone.lease.LeaseManager$LeaseMonitor.run(LeaseManager.java:283)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-11-06 18:21:08,584 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1740)) - Stopping SCM MetadataStore.
2025-11-06 18:21:08,621 [main] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchemaFromFile(128)) - Loading schema from [jar:file:/home/runner/work/ozone/ozone/hadoop-hdds/common/target/hdds-common-2.2.0-SNAPSHOT.jar!/network-topology-default.xml]
2025-11-06 18:21:08,621 [main] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchema(175)) - Loading network topology layer schema file
2025-11-06 18:21:08,638 [main] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchemaFromFile(128)) - Loading schema from [jar:file:/home/runner/work/ozone/ozone/hadoop-hdds/common/target/hdds-common-2.2.0-SNAPSHOT.jar!/network-topology-default.xml]
2025-11-06 18:21:08,639 [main] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchema(175)) - Loading network topology layer schema file
2025-11-06 18:21:08,642 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(133)) - Added a new node: /default-rack/3c46b83e-8d09-4f2b-893a-5d207851cbce
2025-11-06 18:21:08,642 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(133)) - Added a new node: /default-rack/21fc4152-b335-4574-964d-74bbe9403198
2025-11-06 18:21:08,642 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(133)) - Added a new node: /default-rack/6885974e-6cb3-403f-8469-4f0cfd8415df
2025-11-06 18:21:08,643 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(133)) - Added a new node: /default-rack/24e03349-7a7b-4d76-b3ab-7601a27055da
2025-11-06 18:21:08,643 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(133)) - Added a new node: /default-rack/a4288fed-572f-40fb-9535-e9a70c54e1ed
2025-11-06 18:21:08,643 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(133)) - Added a new node: /default-rack/34d6e16e-93e9-4fd8-803b-3c038134ce14
2025-11-06 18:21:08,644 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(133)) - Added a new node: /default-rack/dcf0ed37-2c46-4945-bbf2-2cbdcef61f75
2025-11-06 18:21:08,644 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(133)) - Added a new node: /default-rack/e199691c-6b18-4982-9253-f46938bee26f
2025-11-06 18:21:08,644 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(133)) - Added a new node: /default-rack/4d6c4e7a-f82d-4801-bb2c-61b00454b1a8
2025-11-06 18:21:08,645 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(133)) - Added a new node: /default-rack/29e78a66-f3b3-4eca-aadd-9e2dcdde6089
2025-11-06 18:21:08,645 [main] WARN  utils.HAUtils (HAUtils.java:getMetaDir(311)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2025-11-06 18:21:08,645 [main] WARN  db.DBStoreBuilder (DBStoreBuilder.java:getDBDirPath(157)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2025-11-06 18:21:08,699 [main] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:<init>(231)) - Init the HA SequenceIdGenerator.
2025-11-06 18:21:08,699 [main] INFO  pipeline.PipelineStateManagerImpl (PipelineStateManagerImpl.java:initialize(75)) - No pipeline exists in current db
2025-11-06 18:21:08,700 [main] INFO  algorithms.LeaderChoosePolicyFactory (LeaderChoosePolicyFactory.java:getPolicy(55)) - Create leader choose policy of type org.apache.hadoop.hdds.scm.pipeline.leader.choose.algorithms.MinLeaderCountChoosePolicy
2025-11-06 18:21:08,700 [main] INFO  algorithms.ContainerPlacementPolicyFactory (ContainerPlacementPolicyFactory.java:getPolicyInternal(83)) - Create container placement policy of type org.apache.hadoop.hdds.scm.container.placement.algorithms.SCMContainerPlacementRackScatter
2025-11-06 18:21:08,701 [main] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service BackgroundPipelineCreator.
2025-11-06 18:21:08,701 [main] INFO  pipeline.BackgroundPipelineCreator (BackgroundPipelineCreator.java:start(126)) - Starting RatisPipelineUtilsThread.
2025-11-06 18:21:08,701 [main] INFO  BackgroundPipelineScrubber (BackgroundSCMService.java:start(64)) - Starting BackgroundPipelineScrubber Service.
2025-11-06 18:21:08,702 [main] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service BackgroundPipelineScrubber.
2025-11-06 18:21:08,702 [main] INFO  algorithms.LeaderChoosePolicyFactory (LeaderChoosePolicyFactory.java:getPolicy(55)) - Create leader choose policy of type org.apache.hadoop.hdds.scm.pipeline.leader.choose.algorithms.MinLeaderCountChoosePolicy
2025-11-06 18:21:08,703 [main] INFO  safemode.SCMSafeModeManager (AbstractContainerSafeModeRule.java:initializeRule(83)) - Refreshed RATIS Containers threshold count to 0.
2025-11-06 18:21:08,704 [main] INFO  safemode.SCMSafeModeManager (AbstractContainerSafeModeRule.java:initializeRule(83)) - Refreshed EC Containers threshold count to 0.
2025-11-06 18:21:08,704 [main] INFO  safemode.HealthyPipelineSafeModeRule (HealthyPipelineSafeModeRule.java:initializeRule(230)) - Total pipeline count is 0, healthy pipeline threshold count is 1
2025-11-06 18:21:08,705 [main] INFO  safemode.OneReplicaPipelineSafeModeRule (OneReplicaPipelineSafeModeRule.java:initializeRule(189)) - Total pipeline count is 0, pipeline's with at least one datanode reported threshold count is 0
2025-11-06 18:21:08,705 [main] INFO  safemode.SCMSafeModeManager (SCMSafeModeManager.java:<init>(102)) - Safemode is disabled, skipping Safemode rule validation and force exiting Safemode.
2025-11-06 18:21:08,705 [main] INFO  ha.SCMContext (SCMContext.java:updateSafeModeStatus(224)) - Update SafeModeStatus from SafeModeStatus{safeModeStatus=false, preCheckPassed=true} to SafeModeStatus{safeModeStatus=false, preCheckPassed=true}.
2025-11-06 18:21:08,705 [main] INFO  pipeline.BackgroundPipelineCreator (BackgroundPipelineCreator.java:notifyStatusChanged(268)) - Service BackgroundPipelineCreator transitions to RUNNING.
2025-11-06 18:21:08,705 [main] INFO  BackgroundPipelineScrubber (BackgroundSCMService.java:notifyStatusChanged(78)) - Service BackgroundPipelineScrubber transitions to RUNNING.
2025-11-06 18:21:08,706 [main] WARN  server.ServerUtils (ServerUtils.java:getScmDbDir(138)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2025-11-06 18:21:08,708 [main] WARN  server.ServerUtils (ServerUtils.java:getScmDbDir(138)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2025-11-06 18:21:08,708 [main] INFO  ha.SCMHANodeDetails (SCMHANodeDetails.java:loadSCMHAConfig(162)) - ServiceID for StorageContainerManager is null
2025-11-06 18:21:08,709 [main] INFO  ha.SCMHANodeDetails (SCMHANodeDetails.java:loadSCMHAConfig(166)) - ozone.scm.default.service.id is not defined, falling back to ozone.scm.service.ids to find serviceID for StorageContainerManager if it is HA enabled cluster
2025-11-06 18:21:08,710 [main] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchemaFromFile(128)) - Loading schema from [jar:file:/home/runner/work/ozone/ozone/hadoop-hdds/common/target/hdds-common-2.2.0-SNAPSHOT.jar!/network-topology-default.xml]
2025-11-06 18:21:08,710 [main] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchema(175)) - Loading network topology layer schema file
2025-11-06 18:21:08,713 [main] INFO  upgrade.AbstractLayoutVersionManager (AbstractLayoutVersionManager.java:init(80)) - Initializing Layout version manager with metadata layout = WITNESSED_CONTAINER_DB_PROTO_VALUE (version = 9), software layout = WITNESSED_CONTAINER_DB_PROTO_VALUE (version = 9)
2025-11-06 18:21:08,714 [main] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:upgradeToSequenceId(353)) - upgrade localId to 115816896921600000
2025-11-06 18:21:08,715 [main] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:upgradeToSequenceId(363)) - upgrade delTxnId to 0
2025-11-06 18:21:08,716 [main] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:upgradeToSequenceId(379)) - upgrade containerId to 0
2025-11-06 18:21:08,716 [main] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:upgradeToCertificateSequenceId(414)) - upgrade CertificateId to 2
2025-11-06 18:21:08,716 [main] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:<init>(231)) - Init the HA SequenceIdGenerator.
2025-11-06 18:21:08,717 [main] INFO  algorithms.ContainerPlacementPolicyFactory (ContainerPlacementPolicyFactory.java:getPolicyInternal(83)) - Create container placement policy of type org.apache.hadoop.hdds.scm.container.placement.algorithms.SCMContainerPlacementRackAware
2025-11-06 18:21:08,717 [main] INFO  algorithms.ContainerPlacementPolicyFactory (ContainerPlacementPolicyFactory.java:getPolicyInternal(83)) - Create container placement policy of type org.apache.hadoop.hdds.scm.container.placement.algorithms.SCMContainerPlacementRackScatter
2025-11-06 18:21:08,718 [main] INFO  ExpiredContainerReplicaOpScrubber (BackgroundSCMService.java:start(64)) - Starting ExpiredContainerReplicaOpScrubber Service.
2025-11-06 18:21:08,718 [main] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service ExpiredContainerReplicaOpScrubber.
2025-11-06 18:21:08,719 [main] INFO  algorithms.PipelineChoosePolicyFactory (PipelineChoosePolicyFactory.java:createPipelineChoosePolicyFromClass(78)) - Create pipeline choose policy of type org.apache.hadoop.hdds.scm.pipeline.choose.algorithms.RandomPipelineChoosePolicy
2025-11-06 18:21:08,719 [main] INFO  algorithms.PipelineChoosePolicyFactory (PipelineChoosePolicyFactory.java:createPipelineChoosePolicyFromClass(78)) - Create pipeline choose policy of type org.apache.hadoop.hdds.scm.pipeline.choose.algorithms.RandomPipelineChoosePolicy
2025-11-06 18:21:08,721 [main] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service SCMBlockDeletingService.
2025-11-06 18:21:08,722 [main] INFO  replication.ReplicationManager (ReplicationManager.java:start(287)) - Starting Replication Monitor Thread.
2025-11-06 18:21:08,722 [main] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service ReplicationManager.
2025-11-06 18:21:08,723 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:<init>(432)) - SCM start with adminUsers: [runner]
2025-11-06 18:21:08,724 [main] INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(93)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 10000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false, ipcFailOver: false.
2025-11-06 18:21:08,731 [main] INFO  ipc.Server (Server.java:<init>(1438)) - Listener at 0.0.0.0:35721
2025-11-06 18:21:08,731 [LeakDetector-ManagedRocksObject0] WARN  managed.ManagedRocksObjectUtils (HddsUtils.java:reportLeak(902)) - ManagedWriteBatch is not closed properly
2025-11-06 18:21:08,733 [Socket Reader #1 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #1 for port 0
2025-11-06 18:21:08,733 [Socket Reader #2 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #2 for port 0
2025-11-06 18:21:08,733 [ReplicationMonitor] INFO  replication.ReplicationManager (ReplicationManager.java:processAll(359)) - Replication Manager is not ready to run until 300000ms after safemode exit
2025-11-06 18:21:08,734 [Socket Reader #3 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #3 for port 0
2025-11-06 18:21:08,734 [Socket Reader #4 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #4 for port 0
2025-11-06 18:21:08,734 [Socket Reader #5 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #5 for port 0
2025-11-06 18:21:08,735 [Socket Reader #6 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #6 for port 0
2025-11-06 18:21:08,735 [Socket Reader #7 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #7 for port 0
2025-11-06 18:21:08,735 [Socket Reader #8 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #8 for port 0
2025-11-06 18:21:08,736 [Socket Reader #9 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #9 for port 0
2025-11-06 18:21:08,736 [Socket Reader #10 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #10 for port 0
2025-11-06 18:21:08,738 [main] INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(93)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 10000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false, ipcFailOver: false.
2025-11-06 18:21:08,738 [main] INFO  ipc.Server (Server.java:<init>(1438)) - Listener at 0.0.0.0:34715
2025-11-06 18:21:08,738 [Socket Reader #1 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #1 for port 0
2025-11-06 18:21:08,739 [Socket Reader #2 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #2 for port 0
2025-11-06 18:21:08,739 [Socket Reader #3 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #3 for port 0
2025-11-06 18:21:08,739 [Socket Reader #4 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #4 for port 0
2025-11-06 18:21:08,740 [Socket Reader #5 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #5 for port 0
2025-11-06 18:21:08,740 [Socket Reader #6 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #6 for port 0
2025-11-06 18:21:08,740 [Socket Reader #7 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #7 for port 0
2025-11-06 18:21:08,740 [Socket Reader #8 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #8 for port 0
2025-11-06 18:21:08,741 [Socket Reader #9 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #9 for port 0
2025-11-06 18:21:08,741 [Socket Reader #10 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #10 for port 0
2025-11-06 18:21:08,743 [main] INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(93)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 10000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false, ipcFailOver: false.
2025-11-06 18:21:08,744 [main] INFO  ipc.Server (Server.java:<init>(1438)) - Listener at 0.0.0.0:44203
2025-11-06 18:21:08,745 [Socket Reader #1 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #1 for port 0
2025-11-06 18:21:08,745 [Socket Reader #2 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #2 for port 0
2025-11-06 18:21:08,745 [Socket Reader #3 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #3 for port 0
2025-11-06 18:21:08,746 [Socket Reader #4 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #4 for port 0
2025-11-06 18:21:08,746 [Socket Reader #5 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #5 for port 0
2025-11-06 18:21:08,747 [Socket Reader #7 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #7 for port 0
2025-11-06 18:21:08,747 [Socket Reader #6 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #6 for port 0
2025-11-06 18:21:08,747 [Socket Reader #8 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #8 for port 0
2025-11-06 18:21:08,749 [Socket Reader #9 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #9 for port 0
2025-11-06 18:21:08,749 [Socket Reader #10 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #10 for port 0
2025-11-06 18:21:08,756 [main] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service ContainerBalancer.
2025-11-06 18:21:08,757 [main] INFO  ha.SCMContext (SCMContext.java:updateSafeModeStatus(224)) - Update SafeModeStatus from SafeModeStatus{safeModeStatus=false, preCheckPassed=true} to SafeModeStatus{safeModeStatus=false, preCheckPassed=true}.
2025-11-06 18:21:08,758 [main] INFO  ha.SCMContext (SCMContext.java:updateSafeModeStatus(224)) - Update SafeModeStatus from SafeModeStatus{safeModeStatus=false, preCheckPassed=true} to SafeModeStatus{safeModeStatus=false, preCheckPassed=true}.
2025-11-06 18:21:08,761 [main] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(208)) - Sending CreatePipelineCommand for pipeline:Pipeline-e1a51f4d-541e-471a-9eb9-b48076c49a8d to datanode:e199691c-6b18-4982-9253-f46938bee26f(localhost-75.177.144.51/75.177.144.51)
2025-11-06 18:21:08,762 [main] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(208)) - Sending CreatePipelineCommand for pipeline:Pipeline-e1a51f4d-541e-471a-9eb9-b48076c49a8d to datanode:3c46b83e-8d09-4f2b-893a-5d207851cbce(localhost-95.229.101.71/95.229.101.71)
2025-11-06 18:21:08,763 [main] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(208)) - Sending CreatePipelineCommand for pipeline:Pipeline-e1a51f4d-541e-471a-9eb9-b48076c49a8d to datanode:34d6e16e-93e9-4fd8-803b-3c038134ce14(localhost-122.150.7.61/122.150.7.61)
2025-11-06 18:21:08,769 [main] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(208)) - Sending CreatePipelineCommand for pipeline:Pipeline-366a6758-33d1-48cc-a5b7-32fc54a5d156 to datanode:a4288fed-572f-40fb-9535-e9a70c54e1ed(localhost-170.204.24.110/170.204.24.110)
2025-11-06 18:21:08,769 [main] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(208)) - Sending CreatePipelineCommand for pipeline:Pipeline-366a6758-33d1-48cc-a5b7-32fc54a5d156 to datanode:3c46b83e-8d09-4f2b-893a-5d207851cbce(localhost-95.229.101.71/95.229.101.71)
2025-11-06 18:21:08,769 [main] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(208)) - Sending CreatePipelineCommand for pipeline:Pipeline-366a6758-33d1-48cc-a5b7-32fc54a5d156 to datanode:34d6e16e-93e9-4fd8-803b-3c038134ce14(localhost-122.150.7.61/122.150.7.61)
2025-11-06 18:21:08,773 [main] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(208)) - Sending CreatePipelineCommand for pipeline:Pipeline-3e260b7e-7c76-415e-8a64-ffabeaeaa6d3 to datanode:a4288fed-572f-40fb-9535-e9a70c54e1ed(localhost-170.204.24.110/170.204.24.110)
2025-11-06 18:21:08,773 [main] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(208)) - Sending CreatePipelineCommand for pipeline:Pipeline-3e260b7e-7c76-415e-8a64-ffabeaeaa6d3 to datanode:21fc4152-b335-4574-964d-74bbe9403198(localhost-8.185.231.128/8.185.231.128)
2025-11-06 18:21:08,773 [main] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(208)) - Sending CreatePipelineCommand for pipeline:Pipeline-3e260b7e-7c76-415e-8a64-ffabeaeaa6d3 to datanode:dcf0ed37-2c46-4945-bbf2-2cbdcef61f75(localhost-206.199.98.143/206.199.98.143)
2025-11-06 18:21:08,778 [main] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(208)) - Sending CreatePipelineCommand for pipeline:Pipeline-ad0d51b1-d81e-46ce-a64c-a1e997000b7d to datanode:21fc4152-b335-4574-964d-74bbe9403198(localhost-8.185.231.128/8.185.231.128)
2025-11-06 18:21:08,778 [main] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(208)) - Sending CreatePipelineCommand for pipeline:Pipeline-ad0d51b1-d81e-46ce-a64c-a1e997000b7d to datanode:24e03349-7a7b-4d76-b3ab-7601a27055da(localhost-46.109.121.56/46.109.121.56)
2025-11-06 18:21:08,778 [main] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(208)) - Sending CreatePipelineCommand for pipeline:Pipeline-ad0d51b1-d81e-46ce-a64c-a1e997000b7d to datanode:6885974e-6cb3-403f-8469-4f0cfd8415df(localhost-212.175.168.113/212.175.168.113)
2025-11-06 18:21:08,784 [main] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(208)) - Sending CreatePipelineCommand for pipeline:Pipeline-2550fca7-70e4-4b91-96e7-2ee4dd5cf26f to datanode:24e03349-7a7b-4d76-b3ab-7601a27055da(localhost-46.109.121.56/46.109.121.56)
2025-11-06 18:21:08,784 [main] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(208)) - Sending CreatePipelineCommand for pipeline:Pipeline-2550fca7-70e4-4b91-96e7-2ee4dd5cf26f to datanode:e199691c-6b18-4982-9253-f46938bee26f(localhost-75.177.144.51/75.177.144.51)
2025-11-06 18:21:08,784 [main] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(208)) - Sending CreatePipelineCommand for pipeline:Pipeline-2550fca7-70e4-4b91-96e7-2ee4dd5cf26f to datanode:6885974e-6cb3-403f-8469-4f0cfd8415df(localhost-212.175.168.113/212.175.168.113)
2025-11-06 18:21:08,790 [main] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:getNextId(135)) - Allocate a batch for containerId, change lastId from 0 to 1000.
2025-11-06 18:21:08,791 [main] WARN  ha.SequenceIdGenerator (SequenceIdGenerator.java:allocateBatch(248)) - Failed to allocate a batch for localId, expected lastId is 0, actual lastId is 115816896921600000.
2025-11-06 18:21:08,792 [main] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:getNextId(135)) - Allocate a batch for localId, change lastId from 115816896921600000 to 115816896921601000.
2025-11-06 18:21:08,835 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1616)) - Container Balancer is not running.
2025-11-06 18:21:08,835 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stopReplicationManager(1749)) - Stopping Replication Manager Service.
2025-11-06 18:21:08,835 [main] INFO  replication.ReplicationManager (ReplicationManager.java:stop(318)) - Stopping Replication Monitor Thread.
2025-11-06 18:21:08,836 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1625)) - Stopping the Datanode Admin Monitor.
2025-11-06 18:21:08,836 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1632)) - Stopping datanode service RPC server
2025-11-06 18:21:08,836 [main] INFO  server.SCMDatanodeProtocolServer (SCMDatanodeProtocolServer.java:stop(455)) - Stopping the RPC server for DataNodes
2025-11-06 18:21:08,836 [main] INFO  ipc.Server (Server.java:stop(3697)) - Stopping server on 35721
2025-11-06 18:21:08,836 [OverReplicatedProcessor] WARN  replication.UnhealthyReplicationProcessor (UnhealthyReplicationProcessor.java:run(178)) - OverReplicatedProcessor interrupted. Exiting...
2025-11-06 18:21:08,836 [ReplicationMonitor] INFO  replication.ReplicationManager (ReplicationManager.java:run(938)) - Replication Monitor Thread is stopped
2025-11-06 18:21:08,836 [UnderReplicatedProcessor] WARN  replication.UnhealthyReplicationProcessor (UnhealthyReplicationProcessor.java:run(178)) - UnderReplicatedProcessor interrupted. Exiting...
2025-11-06 18:21:08,838 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1640)) - Stopping block service RPC server
2025-11-06 18:21:08,838 [main] INFO  server.SCMBlockProtocolServer (SCMBlockProtocolServer.java:stop(175)) - Stopping the RPC server for Block Protocol
2025-11-06 18:21:08,838 [main] INFO  ipc.Server (Server.java:stop(3697)) - Stopping server on 34715
2025-11-06 18:21:08,839 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1647)) - Stopping the StorageContainerLocationProtocol RPC server
2025-11-06 18:21:08,839 [main] INFO  server.SCMClientProtocolServer (SCMClientProtocolServer.java:stop(218)) - Stopping the RPC server for Client Protocol
2025-11-06 18:21:08,839 [main] INFO  ipc.Server (Server.java:stop(3697)) - Stopping server on 44203
2025-11-06 18:21:08,840 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1654)) - Stopping Storage Container Manager HTTP server.
2025-11-06 18:21:08,840 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1662)) - Stopping SCM LayoutVersionManager Service.
2025-11-06 18:21:08,841 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1674)) - Stopping Block Manager Service.
2025-11-06 18:21:08,841 [main] INFO  utils.BackgroundService (BackgroundService.java:shutdown(195)) - Shutting down service SCMBlockDeletingService
2025-11-06 18:21:08,841 [main] INFO  utils.BackgroundService (BackgroundService.java:shutdown(195)) - Shutting down service SCMBlockDeletingService
2025-11-06 18:21:08,842 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1699)) - Stopping SCM Event Queue.
2025-11-06 18:21:08,842 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1706)) - Stopping SCM HA services.
2025-11-06 18:21:08,843 [main] INFO  pipeline.BackgroundPipelineCreator (BackgroundPipelineCreator.java:stop(154)) - Stopping RatisPipelineUtilsThread.
2025-11-06 18:21:08,843 [RatisPipelineUtilsThread-0] WARN  pipeline.BackgroundPipelineCreator (BackgroundPipelineCreator.java:run(185)) - RatisPipelineUtilsThread is interrupted.
2025-11-06 18:21:08,843 [main] INFO  BackgroundPipelineScrubber (BackgroundSCMService.java:stop(127)) - Stopping BackgroundPipelineScrubber Service.
2025-11-06 18:21:08,843 [BackgroundPipelineScrubber] WARN  BackgroundPipelineScrubber (BackgroundSCMService.java:run(111)) - BackgroundPipelineScrubber is interrupted, exit
2025-11-06 18:21:08,843 [main] INFO  ExpiredContainerReplicaOpScrubber (BackgroundSCMService.java:stop(127)) - Stopping ExpiredContainerReplicaOpScrubber Service.
2025-11-06 18:21:08,844 [main] INFO  utils.BackgroundService (BackgroundService.java:shutdown(195)) - Shutting down service SCMBlockDeletingService
2025-11-06 18:21:08,844 [main] INFO  replication.ReplicationManager (ReplicationManager.java:stop(325)) - Replication Monitor Thread is not running.
2025-11-06 18:21:08,844 [main] WARN  balancer.ContainerBalancer (ContainerBalancer.java:stop(362)) - Cannot stop Container Balancer because it's not running or stopping
2025-11-06 18:21:08,844 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1740)) - Stopping SCM MetadataStore.
2025-11-06 18:21:08,844 [test-leaseManagerLeaseManager#LeaseMonitor] WARN  lease.LeaseManager (LeaseManager.java:run(285)) - Lease manager is interrupted. Shutting down...
java.lang.InterruptedException
	at java.base/java.util.concurrent.locks.AbstractQueuedSynchronizer.tryAcquireSharedNanos(AbstractQueuedSynchronizer.java:1167)
	at java.base/java.util.concurrent.Semaphore.tryAcquire(Semaphore.java:415)
	at org.apache.hadoop.ozone.lease.LeaseManager$LeaseMonitor.run(LeaseManager.java:283)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-11-06 18:21:08,844 [ExpiredContainerReplicaOpScrubber] WARN  ExpiredContainerReplicaOpScrubber (BackgroundSCMService.java:run(111)) - ExpiredContainerReplicaOpScrubber is interrupted, exit
2025-11-06 18:21:08,873 [main] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchemaFromFile(128)) - Loading schema from [jar:file:/home/runner/work/ozone/ozone/hadoop-hdds/common/target/hdds-common-2.2.0-SNAPSHOT.jar!/network-topology-default.xml]
2025-11-06 18:21:08,873 [main] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchema(175)) - Loading network topology layer schema file
2025-11-06 18:21:08,888 [main] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchemaFromFile(128)) - Loading schema from [jar:file:/home/runner/work/ozone/ozone/hadoop-hdds/common/target/hdds-common-2.2.0-SNAPSHOT.jar!/network-topology-default.xml]
2025-11-06 18:21:08,888 [main] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchema(175)) - Loading network topology layer schema file
2025-11-06 18:21:08,890 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(133)) - Added a new node: /default-rack/1dc074f9-0c3b-445d-b1d8-60a2495a3c40
2025-11-06 18:21:08,890 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(133)) - Added a new node: /default-rack/304f3bec-58bf-495d-8698-c9b65809ce4a
2025-11-06 18:21:08,891 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(133)) - Added a new node: /default-rack/551f6555-8e78-49f8-8383-93ba2c01d307
2025-11-06 18:21:08,891 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(133)) - Added a new node: /default-rack/75a11327-9ca9-4082-a381-51dd80663598
2025-11-06 18:21:08,891 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(133)) - Added a new node: /default-rack/38579975-fdfc-44fd-b0ef-b6d068f0e8dc
2025-11-06 18:21:08,891 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(133)) - Added a new node: /default-rack/2c559760-c607-405d-92dc-421315bca0a1
2025-11-06 18:21:08,892 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(133)) - Added a new node: /default-rack/fff8f154-d57d-4031-a90e-779e285df722
2025-11-06 18:21:08,892 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(133)) - Added a new node: /default-rack/0e3a862b-b70e-42a3-b287-a273caa7a1e6
2025-11-06 18:21:08,892 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(133)) - Added a new node: /default-rack/345fae01-21b4-490a-bb65-5a8d81e731f0
2025-11-06 18:21:08,893 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(133)) - Added a new node: /default-rack/e37c1865-b52d-4ea0-a4a5-504eddc6815f
2025-11-06 18:21:08,893 [main] WARN  utils.HAUtils (HAUtils.java:getMetaDir(311)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2025-11-06 18:21:08,894 [main] WARN  db.DBStoreBuilder (DBStoreBuilder.java:getDBDirPath(157)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2025-11-06 18:21:08,937 [main] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:<init>(231)) - Init the HA SequenceIdGenerator.
2025-11-06 18:21:08,937 [main] INFO  pipeline.PipelineStateManagerImpl (PipelineStateManagerImpl.java:initialize(75)) - No pipeline exists in current db
2025-11-06 18:21:08,938 [main] INFO  algorithms.LeaderChoosePolicyFactory (LeaderChoosePolicyFactory.java:getPolicy(55)) - Create leader choose policy of type org.apache.hadoop.hdds.scm.pipeline.leader.choose.algorithms.MinLeaderCountChoosePolicy
2025-11-06 18:21:08,938 [main] INFO  algorithms.ContainerPlacementPolicyFactory (ContainerPlacementPolicyFactory.java:getPolicyInternal(83)) - Create container placement policy of type org.apache.hadoop.hdds.scm.container.placement.algorithms.SCMContainerPlacementRackScatter
2025-11-06 18:21:08,939 [main] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service BackgroundPipelineCreator.
2025-11-06 18:21:08,939 [main] INFO  pipeline.BackgroundPipelineCreator (BackgroundPipelineCreator.java:start(126)) - Starting RatisPipelineUtilsThread.
2025-11-06 18:21:08,939 [main] INFO  BackgroundPipelineScrubber (BackgroundSCMService.java:start(64)) - Starting BackgroundPipelineScrubber Service.
2025-11-06 18:21:08,940 [main] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service BackgroundPipelineScrubber.
2025-11-06 18:21:08,940 [main] INFO  algorithms.LeaderChoosePolicyFactory (LeaderChoosePolicyFactory.java:getPolicy(55)) - Create leader choose policy of type org.apache.hadoop.hdds.scm.pipeline.leader.choose.algorithms.MinLeaderCountChoosePolicy
2025-11-06 18:21:08,941 [main] INFO  safemode.SCMSafeModeManager (AbstractContainerSafeModeRule.java:initializeRule(83)) - Refreshed RATIS Containers threshold count to 0.
2025-11-06 18:21:08,942 [main] INFO  safemode.SCMSafeModeManager (AbstractContainerSafeModeRule.java:initializeRule(83)) - Refreshed EC Containers threshold count to 0.
2025-11-06 18:21:08,942 [main] INFO  safemode.HealthyPipelineSafeModeRule (HealthyPipelineSafeModeRule.java:initializeRule(230)) - Total pipeline count is 0, healthy pipeline threshold count is 1
2025-11-06 18:21:08,942 [main] INFO  safemode.OneReplicaPipelineSafeModeRule (OneReplicaPipelineSafeModeRule.java:initializeRule(189)) - Total pipeline count is 0, pipeline's with at least one datanode reported threshold count is 0
2025-11-06 18:21:08,943 [main] INFO  safemode.SCMSafeModeManager (SCMSafeModeManager.java:<init>(102)) - Safemode is disabled, skipping Safemode rule validation and force exiting Safemode.
2025-11-06 18:21:08,943 [main] INFO  ha.SCMContext (SCMContext.java:updateSafeModeStatus(224)) - Update SafeModeStatus from SafeModeStatus{safeModeStatus=false, preCheckPassed=true} to SafeModeStatus{safeModeStatus=false, preCheckPassed=true}.
2025-11-06 18:21:08,943 [main] INFO  pipeline.BackgroundPipelineCreator (BackgroundPipelineCreator.java:notifyStatusChanged(268)) - Service BackgroundPipelineCreator transitions to RUNNING.
2025-11-06 18:21:08,943 [main] INFO  BackgroundPipelineScrubber (BackgroundSCMService.java:notifyStatusChanged(78)) - Service BackgroundPipelineScrubber transitions to RUNNING.
2025-11-06 18:21:08,943 [main] WARN  server.ServerUtils (ServerUtils.java:getScmDbDir(138)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2025-11-06 18:21:08,946 [main] WARN  server.ServerUtils (ServerUtils.java:getScmDbDir(138)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2025-11-06 18:21:08,946 [main] INFO  ha.SCMHANodeDetails (SCMHANodeDetails.java:loadSCMHAConfig(162)) - ServiceID for StorageContainerManager is null
2025-11-06 18:21:08,947 [main] INFO  ha.SCMHANodeDetails (SCMHANodeDetails.java:loadSCMHAConfig(166)) - ozone.scm.default.service.id is not defined, falling back to ozone.scm.service.ids to find serviceID for StorageContainerManager if it is HA enabled cluster
2025-11-06 18:21:08,948 [main] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchemaFromFile(128)) - Loading schema from [jar:file:/home/runner/work/ozone/ozone/hadoop-hdds/common/target/hdds-common-2.2.0-SNAPSHOT.jar!/network-topology-default.xml]
2025-11-06 18:21:08,948 [main] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchema(175)) - Loading network topology layer schema file
2025-11-06 18:21:08,951 [main] INFO  upgrade.AbstractLayoutVersionManager (AbstractLayoutVersionManager.java:init(80)) - Initializing Layout version manager with metadata layout = WITNESSED_CONTAINER_DB_PROTO_VALUE (version = 9), software layout = WITNESSED_CONTAINER_DB_PROTO_VALUE (version = 9)
2025-11-06 18:21:08,952 [main] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:upgradeToSequenceId(353)) - upgrade localId to 115816896921600000
2025-11-06 18:21:08,953 [main] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:upgradeToSequenceId(363)) - upgrade delTxnId to 0
2025-11-06 18:21:08,954 [main] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:upgradeToSequenceId(379)) - upgrade containerId to 0
2025-11-06 18:21:08,955 [main] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:upgradeToCertificateSequenceId(414)) - upgrade CertificateId to 2
2025-11-06 18:21:08,955 [main] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:<init>(231)) - Init the HA SequenceIdGenerator.
2025-11-06 18:21:08,956 [main] INFO  algorithms.ContainerPlacementPolicyFactory (ContainerPlacementPolicyFactory.java:getPolicyInternal(83)) - Create container placement policy of type org.apache.hadoop.hdds.scm.container.placement.algorithms.SCMContainerPlacementRackAware
2025-11-06 18:21:08,956 [main] INFO  algorithms.ContainerPlacementPolicyFactory (ContainerPlacementPolicyFactory.java:getPolicyInternal(83)) - Create container placement policy of type org.apache.hadoop.hdds.scm.container.placement.algorithms.SCMContainerPlacementRackScatter
2025-11-06 18:21:08,957 [main] INFO  ExpiredContainerReplicaOpScrubber (BackgroundSCMService.java:start(64)) - Starting ExpiredContainerReplicaOpScrubber Service.
2025-11-06 18:21:08,957 [main] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service ExpiredContainerReplicaOpScrubber.
2025-11-06 18:21:08,957 [main] INFO  algorithms.PipelineChoosePolicyFactory (PipelineChoosePolicyFactory.java:createPipelineChoosePolicyFromClass(78)) - Create pipeline choose policy of type org.apache.hadoop.hdds.scm.pipeline.choose.algorithms.RandomPipelineChoosePolicy
2025-11-06 18:21:08,957 [main] INFO  algorithms.PipelineChoosePolicyFactory (PipelineChoosePolicyFactory.java:createPipelineChoosePolicyFromClass(78)) - Create pipeline choose policy of type org.apache.hadoop.hdds.scm.pipeline.choose.algorithms.RandomPipelineChoosePolicy
2025-11-06 18:21:08,959 [main] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service SCMBlockDeletingService.
2025-11-06 18:21:08,960 [main] INFO  replication.ReplicationManager (ReplicationManager.java:start(287)) - Starting Replication Monitor Thread.
2025-11-06 18:21:08,961 [main] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service ReplicationManager.
2025-11-06 18:21:08,961 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:<init>(432)) - SCM start with adminUsers: [runner]
2025-11-06 18:21:08,962 [ReplicationMonitor] INFO  replication.ReplicationManager (ReplicationManager.java:processAll(359)) - Replication Manager is not ready to run until 300000ms after safemode exit
2025-11-06 18:21:08,962 [main] INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(93)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 10000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false, ipcFailOver: false.
2025-11-06 18:21:08,962 [main] INFO  ipc.Server (Server.java:<init>(1438)) - Listener at 0.0.0.0:45451
2025-11-06 18:21:08,963 [Socket Reader #1 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #1 for port 0
2025-11-06 18:21:08,963 [Socket Reader #2 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #2 for port 0
2025-11-06 18:21:08,964 [Socket Reader #3 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #3 for port 0
2025-11-06 18:21:08,965 [Socket Reader #4 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #4 for port 0
2025-11-06 18:21:08,965 [Socket Reader #5 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #5 for port 0
2025-11-06 18:21:08,966 [Socket Reader #6 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #6 for port 0
2025-11-06 18:21:08,966 [Socket Reader #7 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #7 for port 0
2025-11-06 18:21:08,967 [Socket Reader #8 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #8 for port 0
2025-11-06 18:21:08,967 [Socket Reader #10 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #10 for port 0
2025-11-06 18:21:08,967 [Socket Reader #9 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #9 for port 0
2025-11-06 18:21:08,969 [main] INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(93)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 10000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false, ipcFailOver: false.
2025-11-06 18:21:08,970 [main] INFO  ipc.Server (Server.java:<init>(1438)) - Listener at 0.0.0.0:35559
2025-11-06 18:21:08,971 [Socket Reader #1 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #1 for port 0
2025-11-06 18:21:08,972 [Socket Reader #2 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #2 for port 0
2025-11-06 18:21:08,972 [Socket Reader #3 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #3 for port 0
2025-11-06 18:21:08,973 [Socket Reader #4 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #4 for port 0
2025-11-06 18:21:08,973 [Socket Reader #5 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #5 for port 0
2025-11-06 18:21:08,974 [Socket Reader #6 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #6 for port 0
2025-11-06 18:21:08,974 [Socket Reader #7 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #7 for port 0
2025-11-06 18:21:08,974 [Socket Reader #8 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #8 for port 0
2025-11-06 18:21:08,975 [Socket Reader #9 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #9 for port 0
2025-11-06 18:21:08,975 [Socket Reader #10 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #10 for port 0
2025-11-06 18:21:08,976 [main] INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(93)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 10000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false, ipcFailOver: false.
2025-11-06 18:21:08,977 [main] INFO  ipc.Server (Server.java:<init>(1438)) - Listener at 0.0.0.0:41933
2025-11-06 18:21:08,977 [Socket Reader #1 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #1 for port 0
2025-11-06 18:21:08,978 [Socket Reader #2 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #2 for port 0
2025-11-06 18:21:08,978 [Socket Reader #3 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #3 for port 0
2025-11-06 18:21:08,978 [Socket Reader #4 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #4 for port 0
2025-11-06 18:21:08,979 [Socket Reader #5 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #5 for port 0
2025-11-06 18:21:08,979 [Socket Reader #6 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #6 for port 0
2025-11-06 18:21:08,979 [Socket Reader #7 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #7 for port 0
2025-11-06 18:21:08,979 [Socket Reader #8 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #8 for port 0
2025-11-06 18:21:08,980 [Socket Reader #9 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #9 for port 0
2025-11-06 18:21:08,980 [Socket Reader #10 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #10 for port 0
2025-11-06 18:21:08,986 [main] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service ContainerBalancer.
2025-11-06 18:21:08,986 [main] INFO  ha.SCMContext (SCMContext.java:updateSafeModeStatus(224)) - Update SafeModeStatus from SafeModeStatus{safeModeStatus=false, preCheckPassed=true} to SafeModeStatus{safeModeStatus=false, preCheckPassed=true}.
2025-11-06 18:21:08,987 [main] INFO  ha.SCMContext (SCMContext.java:updateSafeModeStatus(224)) - Update SafeModeStatus from SafeModeStatus{safeModeStatus=false, preCheckPassed=true} to SafeModeStatus{safeModeStatus=false, preCheckPassed=true}.
2025-11-06 18:21:08,989 [main] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(208)) - Sending CreatePipelineCommand for pipeline:Pipeline-d41de566-5c42-445f-97a8-330cb4a6acd1 to datanode:0e3a862b-b70e-42a3-b287-a273caa7a1e6(localhost-41.88.145.56/41.88.145.56)
2025-11-06 18:21:08,990 [main] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(208)) - Sending CreatePipelineCommand for pipeline:Pipeline-d41de566-5c42-445f-97a8-330cb4a6acd1 to datanode:1dc074f9-0c3b-445d-b1d8-60a2495a3c40(localhost-236.167.100.180/236.167.100.180)
2025-11-06 18:21:08,990 [main] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(208)) - Sending CreatePipelineCommand for pipeline:Pipeline-d41de566-5c42-445f-97a8-330cb4a6acd1 to datanode:2c559760-c607-405d-92dc-421315bca0a1(localhost-96.67.246.98/96.67.246.98)
2025-11-06 18:21:08,997 [pool-111-thread-1] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:getNextId(135)) - Allocate a batch for containerId, change lastId from 0 to 1000.
2025-11-06 18:21:08,998 [pool-111-thread-1] WARN  ha.SequenceIdGenerator (SequenceIdGenerator.java:allocateBatch(248)) - Failed to allocate a batch for localId, expected lastId is 0, actual lastId is 115816896921600000.
2025-11-06 18:21:08,999 [pool-111-thread-1] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:getNextId(135)) - Allocate a batch for localId, change lastId from 115816896921600000 to 115816896921601000.
2025-11-06 18:21:09,006 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1616)) - Container Balancer is not running.
2025-11-06 18:21:09,006 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stopReplicationManager(1749)) - Stopping Replication Manager Service.
2025-11-06 18:21:09,006 [main] INFO  replication.ReplicationManager (ReplicationManager.java:stop(318)) - Stopping Replication Monitor Thread.
2025-11-06 18:21:09,007 [UnderReplicatedProcessor] WARN  replication.UnhealthyReplicationProcessor (UnhealthyReplicationProcessor.java:run(178)) - UnderReplicatedProcessor interrupted. Exiting...
2025-11-06 18:21:09,007 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1625)) - Stopping the Datanode Admin Monitor.
2025-11-06 18:21:09,007 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1632)) - Stopping datanode service RPC server
2025-11-06 18:21:09,007 [main] INFO  server.SCMDatanodeProtocolServer (SCMDatanodeProtocolServer.java:stop(455)) - Stopping the RPC server for DataNodes
2025-11-06 18:21:09,007 [OverReplicatedProcessor] WARN  replication.UnhealthyReplicationProcessor (UnhealthyReplicationProcessor.java:run(178)) - OverReplicatedProcessor interrupted. Exiting...
2025-11-06 18:21:09,007 [ReplicationMonitor] INFO  replication.ReplicationManager (ReplicationManager.java:run(938)) - Replication Monitor Thread is stopped
2025-11-06 18:21:09,007 [main] INFO  ipc.Server (Server.java:stop(3697)) - Stopping server on 45451
2025-11-06 18:21:09,009 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1640)) - Stopping block service RPC server
2025-11-06 18:21:09,009 [main] INFO  server.SCMBlockProtocolServer (SCMBlockProtocolServer.java:stop(175)) - Stopping the RPC server for Block Protocol
2025-11-06 18:21:09,009 [main] INFO  ipc.Server (Server.java:stop(3697)) - Stopping server on 35559
2025-11-06 18:21:09,010 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1647)) - Stopping the StorageContainerLocationProtocol RPC server
2025-11-06 18:21:09,011 [main] INFO  server.SCMClientProtocolServer (SCMClientProtocolServer.java:stop(218)) - Stopping the RPC server for Client Protocol
2025-11-06 18:21:09,011 [main] INFO  ipc.Server (Server.java:stop(3697)) - Stopping server on 41933
2025-11-06 18:21:09,012 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1654)) - Stopping Storage Container Manager HTTP server.
2025-11-06 18:21:09,012 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1662)) - Stopping SCM LayoutVersionManager Service.
2025-11-06 18:21:09,012 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1674)) - Stopping Block Manager Service.
2025-11-06 18:21:09,013 [main] INFO  utils.BackgroundService (BackgroundService.java:shutdown(195)) - Shutting down service SCMBlockDeletingService
2025-11-06 18:21:09,013 [main] INFO  utils.BackgroundService (BackgroundService.java:shutdown(195)) - Shutting down service SCMBlockDeletingService
2025-11-06 18:21:09,013 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1699)) - Stopping SCM Event Queue.
2025-11-06 18:21:09,014 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1706)) - Stopping SCM HA services.
2025-11-06 18:21:09,014 [main] INFO  pipeline.BackgroundPipelineCreator (BackgroundPipelineCreator.java:stop(154)) - Stopping RatisPipelineUtilsThread.
2025-11-06 18:21:09,014 [RatisPipelineUtilsThread-0] WARN  pipeline.BackgroundPipelineCreator (BackgroundPipelineCreator.java:run(185)) - RatisPipelineUtilsThread is interrupted.
2025-11-06 18:21:09,014 [main] INFO  BackgroundPipelineScrubber (BackgroundSCMService.java:stop(127)) - Stopping BackgroundPipelineScrubber Service.
2025-11-06 18:21:09,014 [BackgroundPipelineScrubber] WARN  BackgroundPipelineScrubber (BackgroundSCMService.java:run(111)) - BackgroundPipelineScrubber is interrupted, exit
2025-11-06 18:21:09,015 [ExpiredContainerReplicaOpScrubber] WARN  ExpiredContainerReplicaOpScrubber (BackgroundSCMService.java:run(111)) - ExpiredContainerReplicaOpScrubber is interrupted, exit
2025-11-06 18:21:09,015 [main] INFO  ExpiredContainerReplicaOpScrubber (BackgroundSCMService.java:stop(127)) - Stopping ExpiredContainerReplicaOpScrubber Service.
2025-11-06 18:21:09,015 [main] INFO  utils.BackgroundService (BackgroundService.java:shutdown(195)) - Shutting down service SCMBlockDeletingService
2025-11-06 18:21:09,016 [main] INFO  replication.ReplicationManager (ReplicationManager.java:stop(325)) - Replication Monitor Thread is not running.
2025-11-06 18:21:09,016 [main] WARN  balancer.ContainerBalancer (ContainerBalancer.java:stop(362)) - Cannot stop Container Balancer because it's not running or stopping
2025-11-06 18:21:09,016 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1740)) - Stopping SCM MetadataStore.
2025-11-06 18:21:09,016 [test-leaseManagerLeaseManager#LeaseMonitor] WARN  lease.LeaseManager (LeaseManager.java:run(285)) - Lease manager is interrupted. Shutting down...
java.lang.InterruptedException
	at java.base/java.util.concurrent.locks.AbstractQueuedSynchronizer.tryAcquireSharedNanos(AbstractQueuedSynchronizer.java:1167)
	at java.base/java.util.concurrent.Semaphore.tryAcquire(Semaphore.java:415)
	at org.apache.hadoop.ozone.lease.LeaseManager$LeaseMonitor.run(LeaseManager.java:283)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-11-06 18:21:09,045 [main] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchemaFromFile(128)) - Loading schema from [jar:file:/home/runner/work/ozone/ozone/hadoop-hdds/common/target/hdds-common-2.2.0-SNAPSHOT.jar!/network-topology-default.xml]
2025-11-06 18:21:09,045 [main] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchema(175)) - Loading network topology layer schema file
2025-11-06 18:21:09,059 [main] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchemaFromFile(128)) - Loading schema from [jar:file:/home/runner/work/ozone/ozone/hadoop-hdds/common/target/hdds-common-2.2.0-SNAPSHOT.jar!/network-topology-default.xml]
2025-11-06 18:21:09,059 [main] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchema(175)) - Loading network topology layer schema file
2025-11-06 18:21:09,061 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(133)) - Added a new node: /default-rack/e73ad485-0da9-493f-9d9d-35d414f7ae50
2025-11-06 18:21:09,062 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(133)) - Added a new node: /default-rack/2a9115b1-c8c1-4a69-9efd-e1fb647caaea
2025-11-06 18:21:09,062 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(133)) - Added a new node: /default-rack/13f9b244-f1f2-4ed1-97cd-85e70869ee75
2025-11-06 18:21:09,062 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(133)) - Added a new node: /default-rack/128dc48e-a81d-44e7-a7a2-5a65ee66771c
2025-11-06 18:21:09,062 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(133)) - Added a new node: /default-rack/17cd75e5-85de-41bb-9139-e3e53927d903
2025-11-06 18:21:09,063 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(133)) - Added a new node: /default-rack/cf44ffef-3aa4-4372-86b2-a4b9147a781f
2025-11-06 18:21:09,063 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(133)) - Added a new node: /default-rack/a35ce88b-fd20-4c62-b0bb-c61fa51012a5
2025-11-06 18:21:09,063 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(133)) - Added a new node: /default-rack/ebd751a5-27f4-4130-9e05-b945ffaa21b4
2025-11-06 18:21:09,063 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(133)) - Added a new node: /default-rack/9ab3680a-dbb5-40f0-9ec0-46815410cc38
2025-11-06 18:21:09,064 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(133)) - Added a new node: /default-rack/c2980b66-d76f-4ba8-827a-784ae7aecdd7
2025-11-06 18:21:09,064 [main] WARN  utils.HAUtils (HAUtils.java:getMetaDir(311)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2025-11-06 18:21:09,065 [main] WARN  db.DBStoreBuilder (DBStoreBuilder.java:getDBDirPath(157)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2025-11-06 18:21:09,122 [main] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:<init>(231)) - Init the HA SequenceIdGenerator.
2025-11-06 18:21:09,122 [main] INFO  pipeline.PipelineStateManagerImpl (PipelineStateManagerImpl.java:initialize(75)) - No pipeline exists in current db
2025-11-06 18:21:09,123 [main] INFO  algorithms.LeaderChoosePolicyFactory (LeaderChoosePolicyFactory.java:getPolicy(55)) - Create leader choose policy of type org.apache.hadoop.hdds.scm.pipeline.leader.choose.algorithms.MinLeaderCountChoosePolicy
2025-11-06 18:21:09,123 [main] INFO  algorithms.ContainerPlacementPolicyFactory (ContainerPlacementPolicyFactory.java:getPolicyInternal(83)) - Create container placement policy of type org.apache.hadoop.hdds.scm.container.placement.algorithms.SCMContainerPlacementRackScatter
2025-11-06 18:21:09,124 [main] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service BackgroundPipelineCreator.
2025-11-06 18:21:09,124 [main] INFO  pipeline.BackgroundPipelineCreator (BackgroundPipelineCreator.java:start(126)) - Starting RatisPipelineUtilsThread.
2025-11-06 18:21:09,124 [main] INFO  BackgroundPipelineScrubber (BackgroundSCMService.java:start(64)) - Starting BackgroundPipelineScrubber Service.
2025-11-06 18:21:09,125 [main] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service BackgroundPipelineScrubber.
2025-11-06 18:21:09,125 [main] INFO  algorithms.LeaderChoosePolicyFactory (LeaderChoosePolicyFactory.java:getPolicy(55)) - Create leader choose policy of type org.apache.hadoop.hdds.scm.pipeline.leader.choose.algorithms.MinLeaderCountChoosePolicy
2025-11-06 18:21:09,127 [main] INFO  safemode.SCMSafeModeManager (AbstractContainerSafeModeRule.java:initializeRule(83)) - Refreshed RATIS Containers threshold count to 0.
2025-11-06 18:21:09,127 [main] INFO  safemode.SCMSafeModeManager (AbstractContainerSafeModeRule.java:initializeRule(83)) - Refreshed EC Containers threshold count to 0.
2025-11-06 18:21:09,127 [main] INFO  safemode.HealthyPipelineSafeModeRule (HealthyPipelineSafeModeRule.java:initializeRule(230)) - Total pipeline count is 0, healthy pipeline threshold count is 1
2025-11-06 18:21:09,128 [main] INFO  safemode.OneReplicaPipelineSafeModeRule (OneReplicaPipelineSafeModeRule.java:initializeRule(189)) - Total pipeline count is 0, pipeline's with at least one datanode reported threshold count is 0
2025-11-06 18:21:09,128 [main] INFO  safemode.SCMSafeModeManager (SCMSafeModeManager.java:<init>(102)) - Safemode is disabled, skipping Safemode rule validation and force exiting Safemode.
2025-11-06 18:21:09,128 [main] INFO  ha.SCMContext (SCMContext.java:updateSafeModeStatus(224)) - Update SafeModeStatus from SafeModeStatus{safeModeStatus=false, preCheckPassed=true} to SafeModeStatus{safeModeStatus=false, preCheckPassed=true}.
2025-11-06 18:21:09,128 [main] INFO  pipeline.BackgroundPipelineCreator (BackgroundPipelineCreator.java:notifyStatusChanged(268)) - Service BackgroundPipelineCreator transitions to RUNNING.
2025-11-06 18:21:09,128 [main] INFO  BackgroundPipelineScrubber (BackgroundSCMService.java:notifyStatusChanged(78)) - Service BackgroundPipelineScrubber transitions to RUNNING.
2025-11-06 18:21:09,129 [main] WARN  server.ServerUtils (ServerUtils.java:getScmDbDir(138)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2025-11-06 18:21:09,131 [main] WARN  server.ServerUtils (ServerUtils.java:getScmDbDir(138)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2025-11-06 18:21:09,131 [main] INFO  ha.SCMHANodeDetails (SCMHANodeDetails.java:loadSCMHAConfig(162)) - ServiceID for StorageContainerManager is null
2025-11-06 18:21:09,131 [main] INFO  ha.SCMHANodeDetails (SCMHANodeDetails.java:loadSCMHAConfig(166)) - ozone.scm.default.service.id is not defined, falling back to ozone.scm.service.ids to find serviceID for StorageContainerManager if it is HA enabled cluster
2025-11-06 18:21:09,132 [main] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchemaFromFile(128)) - Loading schema from [jar:file:/home/runner/work/ozone/ozone/hadoop-hdds/common/target/hdds-common-2.2.0-SNAPSHOT.jar!/network-topology-default.xml]
2025-11-06 18:21:09,133 [main] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchema(175)) - Loading network topology layer schema file
2025-11-06 18:21:09,135 [main] INFO  upgrade.AbstractLayoutVersionManager (AbstractLayoutVersionManager.java:init(80)) - Initializing Layout version manager with metadata layout = WITNESSED_CONTAINER_DB_PROTO_VALUE (version = 9), software layout = WITNESSED_CONTAINER_DB_PROTO_VALUE (version = 9)
2025-11-06 18:21:09,136 [main] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:upgradeToSequenceId(353)) - upgrade localId to 115816896921600000
2025-11-06 18:21:09,137 [main] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:upgradeToSequenceId(363)) - upgrade delTxnId to 0
2025-11-06 18:21:09,138 [main] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:upgradeToSequenceId(379)) - upgrade containerId to 0
2025-11-06 18:21:09,139 [main] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:upgradeToCertificateSequenceId(414)) - upgrade CertificateId to 2
2025-11-06 18:21:09,139 [main] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:<init>(231)) - Init the HA SequenceIdGenerator.
2025-11-06 18:21:09,139 [main] INFO  algorithms.ContainerPlacementPolicyFactory (ContainerPlacementPolicyFactory.java:getPolicyInternal(83)) - Create container placement policy of type org.apache.hadoop.hdds.scm.container.placement.algorithms.SCMContainerPlacementRackAware
2025-11-06 18:21:09,139 [main] INFO  algorithms.ContainerPlacementPolicyFactory (ContainerPlacementPolicyFactory.java:getPolicyInternal(83)) - Create container placement policy of type org.apache.hadoop.hdds.scm.container.placement.algorithms.SCMContainerPlacementRackScatter
2025-11-06 18:21:09,140 [main] INFO  ExpiredContainerReplicaOpScrubber (BackgroundSCMService.java:start(64)) - Starting ExpiredContainerReplicaOpScrubber Service.
2025-11-06 18:21:09,141 [main] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service ExpiredContainerReplicaOpScrubber.
2025-11-06 18:21:09,141 [main] INFO  algorithms.PipelineChoosePolicyFactory (PipelineChoosePolicyFactory.java:createPipelineChoosePolicyFromClass(78)) - Create pipeline choose policy of type org.apache.hadoop.hdds.scm.pipeline.choose.algorithms.RandomPipelineChoosePolicy
2025-11-06 18:21:09,141 [main] INFO  algorithms.PipelineChoosePolicyFactory (PipelineChoosePolicyFactory.java:createPipelineChoosePolicyFromClass(78)) - Create pipeline choose policy of type org.apache.hadoop.hdds.scm.pipeline.choose.algorithms.RandomPipelineChoosePolicy
2025-11-06 18:21:09,143 [main] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service SCMBlockDeletingService.
2025-11-06 18:21:09,144 [main] INFO  replication.ReplicationManager (ReplicationManager.java:start(287)) - Starting Replication Monitor Thread.
2025-11-06 18:21:09,145 [main] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service ReplicationManager.
2025-11-06 18:21:09,145 [ReplicationMonitor] INFO  replication.ReplicationManager (ReplicationManager.java:processAll(359)) - Replication Manager is not ready to run until 300000ms after safemode exit
2025-11-06 18:21:09,146 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:<init>(432)) - SCM start with adminUsers: [runner]
2025-11-06 18:21:09,147 [main] INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(93)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 10000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false, ipcFailOver: false.
2025-11-06 18:21:09,148 [main] INFO  ipc.Server (Server.java:<init>(1438)) - Listener at 0.0.0.0:41359
2025-11-06 18:21:09,148 [Socket Reader #1 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #1 for port 0
2025-11-06 18:21:09,149 [Socket Reader #2 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #2 for port 0
2025-11-06 18:21:09,150 [Socket Reader #3 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #3 for port 0
2025-11-06 18:21:09,150 [Socket Reader #4 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #4 for port 0
2025-11-06 18:21:09,150 [Socket Reader #5 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #5 for port 0
2025-11-06 18:21:09,151 [Socket Reader #6 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #6 for port 0
2025-11-06 18:21:09,151 [Socket Reader #7 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #7 for port 0
2025-11-06 18:21:09,151 [Socket Reader #8 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #8 for port 0
2025-11-06 18:21:09,152 [Socket Reader #10 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #10 for port 0
2025-11-06 18:21:09,153 [Socket Reader #9 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #9 for port 0
2025-11-06 18:21:09,153 [main] INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(93)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 10000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false, ipcFailOver: false.
2025-11-06 18:21:09,154 [main] INFO  ipc.Server (Server.java:<init>(1438)) - Listener at 0.0.0.0:42903
2025-11-06 18:21:09,155 [Socket Reader #2 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #2 for port 0
2025-11-06 18:21:09,155 [Socket Reader #1 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #1 for port 0
2025-11-06 18:21:09,156 [Socket Reader #3 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #3 for port 0
2025-11-06 18:21:09,157 [Socket Reader #4 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #4 for port 0
2025-11-06 18:21:09,158 [Socket Reader #5 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #5 for port 0
2025-11-06 18:21:09,158 [Socket Reader #6 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #6 for port 0
2025-11-06 18:21:09,159 [Socket Reader #7 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #7 for port 0
2025-11-06 18:21:09,159 [Socket Reader #8 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #8 for port 0
2025-11-06 18:21:09,160 [Socket Reader #9 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #9 for port 0
2025-11-06 18:21:09,160 [Socket Reader #10 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #10 for port 0
2025-11-06 18:21:09,161 [main] INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(93)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 10000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false, ipcFailOver: false.
2025-11-06 18:21:09,162 [main] INFO  ipc.Server (Server.java:<init>(1438)) - Listener at 0.0.0.0:40811
2025-11-06 18:21:09,162 [Socket Reader #1 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #1 for port 0
2025-11-06 18:21:09,162 [Socket Reader #2 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #2 for port 0
2025-11-06 18:21:09,163 [Socket Reader #3 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #3 for port 0
2025-11-06 18:21:09,163 [Socket Reader #4 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #4 for port 0
2025-11-06 18:21:09,163 [Socket Reader #5 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #5 for port 0
2025-11-06 18:21:09,164 [Socket Reader #6 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #6 for port 0
2025-11-06 18:21:09,164 [Socket Reader #7 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #7 for port 0
2025-11-06 18:21:09,164 [Socket Reader #8 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #8 for port 0
2025-11-06 18:21:09,165 [Socket Reader #9 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #9 for port 0
2025-11-06 18:21:09,167 [Socket Reader #10 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #10 for port 0
2025-11-06 18:21:09,176 [main] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service ContainerBalancer.
2025-11-06 18:21:09,177 [main] INFO  ha.SCMContext (SCMContext.java:updateSafeModeStatus(224)) - Update SafeModeStatus from SafeModeStatus{safeModeStatus=false, preCheckPassed=true} to SafeModeStatus{safeModeStatus=false, preCheckPassed=true}.
2025-11-06 18:21:09,178 [main] INFO  ha.SCMContext (SCMContext.java:updateSafeModeStatus(224)) - Update SafeModeStatus from SafeModeStatus{safeModeStatus=false, preCheckPassed=true} to SafeModeStatus{safeModeStatus=false, preCheckPassed=true}.
2025-11-06 18:21:09,182 [pool-147-thread-1] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(208)) - Sending CreatePipelineCommand for pipeline:Pipeline-8d73f320-d597-4493-8e3b-e1f294a4c5b8 to datanode:17cd75e5-85de-41bb-9139-e3e53927d903(localhost-209.37.51.85/209.37.51.85)
2025-11-06 18:21:09,183 [pool-147-thread-1] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(208)) - Sending CreatePipelineCommand for pipeline:Pipeline-8d73f320-d597-4493-8e3b-e1f294a4c5b8 to datanode:128dc48e-a81d-44e7-a7a2-5a65ee66771c(localhost-200.7.125.132/200.7.125.132)
2025-11-06 18:21:09,184 [pool-147-thread-1] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(208)) - Sending CreatePipelineCommand for pipeline:Pipeline-8d73f320-d597-4493-8e3b-e1f294a4c5b8 to datanode:e73ad485-0da9-493f-9d9d-35d414f7ae50(localhost-101.80.167.3/101.80.167.3)
2025-11-06 18:21:09,187 [pool-154-thread-1] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(208)) - Sending CreatePipelineCommand for pipeline:Pipeline-23b39418-8c7d-4802-bbaf-501c50b44d1a to datanode:17cd75e5-85de-41bb-9139-e3e53927d903(localhost-209.37.51.85/209.37.51.85)
2025-11-06 18:21:09,187 [pool-154-thread-1] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(208)) - Sending CreatePipelineCommand for pipeline:Pipeline-23b39418-8c7d-4802-bbaf-501c50b44d1a to datanode:128dc48e-a81d-44e7-a7a2-5a65ee66771c(localhost-200.7.125.132/200.7.125.132)
2025-11-06 18:21:09,187 [pool-154-thread-1] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(208)) - Sending CreatePipelineCommand for pipeline:Pipeline-23b39418-8c7d-4802-bbaf-501c50b44d1a to datanode:e73ad485-0da9-493f-9d9d-35d414f7ae50(localhost-101.80.167.3/101.80.167.3)
2025-11-06 18:21:09,188 [pool-154-thread-1] INFO  pipeline.PipelineManagerImpl (PipelineManagerImpl.java:recordMetricsForPipeline(922)) - Pipeline-23b39418-8c7d-4802-bbaf-501c50b44d1a and Pipeline-8d73f320-d597-4493-8e3b-e1f294a4c5b8 have exactly the same set of datanodes: [17cd75e5-85de-41bb-9139-e3e53927d903(localhost-209.37.51.85/209.37.51.85), 128dc48e-a81d-44e7-a7a2-5a65ee66771c(localhost-200.7.125.132/200.7.125.132), e73ad485-0da9-493f-9d9d-35d414f7ae50(localhost-101.80.167.3/101.80.167.3)]
2025-11-06 18:21:09,190 [pool-148-thread-1] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(208)) - Sending CreatePipelineCommand for pipeline:Pipeline-9d232646-2d08-4523-9f85-20443afaf9e5 to datanode:2a9115b1-c8c1-4a69-9efd-e1fb647caaea(localhost-152.245.145.45/152.245.145.45)
2025-11-06 18:21:09,190 [pool-148-thread-1] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(208)) - Sending CreatePipelineCommand for pipeline:Pipeline-9d232646-2d08-4523-9f85-20443afaf9e5 to datanode:ebd751a5-27f4-4130-9e05-b945ffaa21b4(localhost-94.172.183.117/94.172.183.117)
2025-11-06 18:21:09,190 [pool-148-thread-1] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(208)) - Sending CreatePipelineCommand for pipeline:Pipeline-9d232646-2d08-4523-9f85-20443afaf9e5 to datanode:cf44ffef-3aa4-4372-86b2-a4b9147a781f(localhost-225.56.121.136/225.56.121.136)
2025-11-06 18:21:09,194 [pool-149-thread-1] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(208)) - Sending CreatePipelineCommand for pipeline:Pipeline-0900f14c-a7c0-49f2-8769-59f7eda15eaf to datanode:ebd751a5-27f4-4130-9e05-b945ffaa21b4(localhost-94.172.183.117/94.172.183.117)
2025-11-06 18:21:09,194 [pool-149-thread-1] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(208)) - Sending CreatePipelineCommand for pipeline:Pipeline-0900f14c-a7c0-49f2-8769-59f7eda15eaf to datanode:13f9b244-f1f2-4ed1-97cd-85e70869ee75(localhost-228.135.160.137/228.135.160.137)
2025-11-06 18:21:09,194 [pool-149-thread-1] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(208)) - Sending CreatePipelineCommand for pipeline:Pipeline-0900f14c-a7c0-49f2-8769-59f7eda15eaf to datanode:a35ce88b-fd20-4c62-b0bb-c61fa51012a5(localhost-199.30.11.155/199.30.11.155)
2025-11-06 18:21:09,196 [pool-150-thread-1] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(208)) - Sending CreatePipelineCommand for pipeline:Pipeline-6c63c135-2e76-4beb-9d9f-8f509c1a8fe2 to datanode:13f9b244-f1f2-4ed1-97cd-85e70869ee75(localhost-228.135.160.137/228.135.160.137)
2025-11-06 18:21:09,196 [pool-150-thread-1] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(208)) - Sending CreatePipelineCommand for pipeline:Pipeline-6c63c135-2e76-4beb-9d9f-8f509c1a8fe2 to datanode:2a9115b1-c8c1-4a69-9efd-e1fb647caaea(localhost-152.245.145.45/152.245.145.45)
2025-11-06 18:21:09,196 [pool-150-thread-1] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(208)) - Sending CreatePipelineCommand for pipeline:Pipeline-6c63c135-2e76-4beb-9d9f-8f509c1a8fe2 to datanode:a35ce88b-fd20-4c62-b0bb-c61fa51012a5(localhost-199.30.11.155/199.30.11.155)
2025-11-06 18:21:09,198 [pool-151-thread-1] WARN  pipeline.WritableRatisContainerProvider (WritableRatisContainerProvider.java:getContainer(97)) - Pipeline creation failed for repConfig RATIS/THREE Datanodes may be used up. Try to see if any pipeline is in ALLOCATED state, and then will wait for it to be OPEN
org.apache.hadoop.hdds.scm.exceptions.SCMException: Cannot create pipeline as it would exceed the limit per datanode: 2 replicationConfig: RATIS/THREE
	at org.apache.hadoop.hdds.scm.pipeline.RatisPipelineProvider.create(RatisPipelineProvider.java:155)
	at org.apache.hadoop.hdds.scm.pipeline.RatisPipelineProvider.create(RatisPipelineProvider.java:54)
	at org.apache.hadoop.hdds.scm.pipeline.PipelineFactory.create(PipelineFactory.java:86)
	at org.apache.hadoop.hdds.scm.pipeline.PipelineManagerImpl.createPipeline(PipelineManagerImpl.java:256)
	at org.apache.hadoop.hdds.scm.pipeline.PipelineManagerImpl.createPipeline(PipelineManagerImpl.java:242)
	at org.apache.hadoop.hdds.scm.pipeline.WritableRatisContainerProvider.getContainer(WritableRatisContainerProvider.java:91)
	at org.apache.hadoop.hdds.scm.pipeline.WritableContainerFactory.getContainer(WritableContainerFactory.java:72)
	at org.apache.hadoop.hdds.scm.block.BlockManagerImpl.allocateBlock(BlockManagerImpl.java:163)
	at org.apache.hadoop.hdds.scm.block.TestBlockManager.lambda$testAllocateBlockInParallel$0(TestBlockManager.java:249)
	at java.base/java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1768)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1144)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:642)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-11-06 18:21:09,199 [pool-153-thread-1] WARN  pipeline.WritableRatisContainerProvider (WritableRatisContainerProvider.java:getContainer(97)) - Pipeline creation failed for repConfig RATIS/THREE Datanodes may be used up. Try to see if any pipeline is in ALLOCATED state, and then will wait for it to be OPEN
org.apache.hadoop.hdds.scm.exceptions.SCMException: Cannot create pipeline as it would exceed the limit per datanode: 2 replicationConfig: RATIS/THREE
	at org.apache.hadoop.hdds.scm.pipeline.RatisPipelineProvider.create(RatisPipelineProvider.java:155)
	at org.apache.hadoop.hdds.scm.pipeline.RatisPipelineProvider.create(RatisPipelineProvider.java:54)
	at org.apache.hadoop.hdds.scm.pipeline.PipelineFactory.create(PipelineFactory.java:86)
	at org.apache.hadoop.hdds.scm.pipeline.PipelineManagerImpl.createPipeline(PipelineManagerImpl.java:256)
	at org.apache.hadoop.hdds.scm.pipeline.PipelineManagerImpl.createPipeline(PipelineManagerImpl.java:242)
	at org.apache.hadoop.hdds.scm.pipeline.WritableRatisContainerProvider.getContainer(WritableRatisContainerProvider.java:91)
	at org.apache.hadoop.hdds.scm.pipeline.WritableContainerFactory.getContainer(WritableContainerFactory.java:72)
	at org.apache.hadoop.hdds.scm.block.BlockManagerImpl.allocateBlock(BlockManagerImpl.java:163)
	at org.apache.hadoop.hdds.scm.block.TestBlockManager.lambda$testAllocateBlockInParallel$0(TestBlockManager.java:249)
	at java.base/java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1768)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1144)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:642)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-11-06 18:21:09,198 [pool-152-thread-1] WARN  pipeline.WritableRatisContainerProvider (WritableRatisContainerProvider.java:getContainer(97)) - Pipeline creation failed for repConfig RATIS/THREE Datanodes may be used up. Try to see if any pipeline is in ALLOCATED state, and then will wait for it to be OPEN
org.apache.hadoop.hdds.scm.exceptions.SCMException: Cannot create pipeline as it would exceed the limit per datanode: 2 replicationConfig: RATIS/THREE
	at org.apache.hadoop.hdds.scm.pipeline.RatisPipelineProvider.create(RatisPipelineProvider.java:155)
	at org.apache.hadoop.hdds.scm.pipeline.RatisPipelineProvider.create(RatisPipelineProvider.java:54)
	at org.apache.hadoop.hdds.scm.pipeline.PipelineFactory.create(PipelineFactory.java:86)
	at org.apache.hadoop.hdds.scm.pipeline.PipelineManagerImpl.createPipeline(PipelineManagerImpl.java:256)
	at org.apache.hadoop.hdds.scm.pipeline.PipelineManagerImpl.createPipeline(PipelineManagerImpl.java:242)
	at org.apache.hadoop.hdds.scm.pipeline.WritableRatisContainerProvider.getContainer(WritableRatisContainerProvider.java:91)
	at org.apache.hadoop.hdds.scm.pipeline.WritableContainerFactory.getContainer(WritableContainerFactory.java:72)
	at org.apache.hadoop.hdds.scm.block.BlockManagerImpl.allocateBlock(BlockManagerImpl.java:163)
	at org.apache.hadoop.hdds.scm.block.TestBlockManager.lambda$testAllocateBlockInParallel$0(TestBlockManager.java:249)
	at java.base/java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1768)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1144)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:642)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-11-06 18:21:09,201 [pool-155-thread-1] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:getNextId(135)) - Allocate a batch for containerId, change lastId from 0 to 1000.
2025-11-06 18:21:09,202 [pool-155-thread-1] WARN  ha.SequenceIdGenerator (SequenceIdGenerator.java:allocateBatch(248)) - Failed to allocate a batch for localId, expected lastId is 0, actual lastId is 115816896921600000.
2025-11-06 18:21:09,203 [pool-155-thread-1] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:getNextId(135)) - Allocate a batch for localId, change lastId from 115816896921600000 to 115816896921601000.
2025-11-06 18:21:09,303 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1616)) - Container Balancer is not running.
2025-11-06 18:21:09,303 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stopReplicationManager(1749)) - Stopping Replication Manager Service.
2025-11-06 18:21:09,304 [main] INFO  replication.ReplicationManager (ReplicationManager.java:stop(318)) - Stopping Replication Monitor Thread.
2025-11-06 18:21:09,304 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1625)) - Stopping the Datanode Admin Monitor.
2025-11-06 18:21:09,304 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1632)) - Stopping datanode service RPC server
2025-11-06 18:21:09,304 [main] INFO  server.SCMDatanodeProtocolServer (SCMDatanodeProtocolServer.java:stop(455)) - Stopping the RPC server for DataNodes
2025-11-06 18:21:09,304 [main] INFO  ipc.Server (Server.java:stop(3697)) - Stopping server on 41359
2025-11-06 18:21:09,304 [OverReplicatedProcessor] WARN  replication.UnhealthyReplicationProcessor (UnhealthyReplicationProcessor.java:run(178)) - OverReplicatedProcessor interrupted. Exiting...
2025-11-06 18:21:09,305 [UnderReplicatedProcessor] WARN  replication.UnhealthyReplicationProcessor (UnhealthyReplicationProcessor.java:run(178)) - UnderReplicatedProcessor interrupted. Exiting...
2025-11-06 18:21:09,305 [ReplicationMonitor] INFO  replication.ReplicationManager (ReplicationManager.java:run(938)) - Replication Monitor Thread is stopped
2025-11-06 18:21:09,306 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1640)) - Stopping block service RPC server
2025-11-06 18:21:09,306 [main] INFO  server.SCMBlockProtocolServer (SCMBlockProtocolServer.java:stop(175)) - Stopping the RPC server for Block Protocol
2025-11-06 18:21:09,306 [main] INFO  ipc.Server (Server.java:stop(3697)) - Stopping server on 42903
2025-11-06 18:21:09,308 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1647)) - Stopping the StorageContainerLocationProtocol RPC server
2025-11-06 18:21:09,308 [main] INFO  server.SCMClientProtocolServer (SCMClientProtocolServer.java:stop(218)) - Stopping the RPC server for Client Protocol
2025-11-06 18:21:09,308 [main] INFO  ipc.Server (Server.java:stop(3697)) - Stopping server on 40811
2025-11-06 18:21:09,310 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1654)) - Stopping Storage Container Manager HTTP server.
2025-11-06 18:21:09,310 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1662)) - Stopping SCM LayoutVersionManager Service.
2025-11-06 18:21:09,311 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1674)) - Stopping Block Manager Service.
2025-11-06 18:21:09,311 [main] INFO  utils.BackgroundService (BackgroundService.java:shutdown(195)) - Shutting down service SCMBlockDeletingService
2025-11-06 18:21:09,311 [main] INFO  utils.BackgroundService (BackgroundService.java:shutdown(195)) - Shutting down service SCMBlockDeletingService
2025-11-06 18:21:09,311 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1699)) - Stopping SCM Event Queue.
2025-11-06 18:21:09,312 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1706)) - Stopping SCM HA services.
2025-11-06 18:21:09,312 [main] INFO  pipeline.BackgroundPipelineCreator (BackgroundPipelineCreator.java:stop(154)) - Stopping RatisPipelineUtilsThread.
2025-11-06 18:21:09,312 [RatisPipelineUtilsThread-0] WARN  pipeline.BackgroundPipelineCreator (BackgroundPipelineCreator.java:run(185)) - RatisPipelineUtilsThread is interrupted.
2025-11-06 18:21:09,312 [BackgroundPipelineScrubber] WARN  BackgroundPipelineScrubber (BackgroundSCMService.java:run(111)) - BackgroundPipelineScrubber is interrupted, exit
2025-11-06 18:21:09,313 [main] INFO  BackgroundPipelineScrubber (BackgroundSCMService.java:stop(127)) - Stopping BackgroundPipelineScrubber Service.
2025-11-06 18:21:09,313 [main] INFO  ExpiredContainerReplicaOpScrubber (BackgroundSCMService.java:stop(127)) - Stopping ExpiredContainerReplicaOpScrubber Service.
2025-11-06 18:21:09,313 [main] INFO  utils.BackgroundService (BackgroundService.java:shutdown(195)) - Shutting down service SCMBlockDeletingService
2025-11-06 18:21:09,313 [ExpiredContainerReplicaOpScrubber] WARN  ExpiredContainerReplicaOpScrubber (BackgroundSCMService.java:run(111)) - ExpiredContainerReplicaOpScrubber is interrupted, exit
2025-11-06 18:21:09,313 [main] INFO  replication.ReplicationManager (ReplicationManager.java:stop(325)) - Replication Monitor Thread is not running.
2025-11-06 18:21:09,314 [main] WARN  balancer.ContainerBalancer (ContainerBalancer.java:stop(362)) - Cannot stop Container Balancer because it's not running or stopping
2025-11-06 18:21:09,314 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1740)) - Stopping SCM MetadataStore.
2025-11-06 18:21:09,314 [test-leaseManagerLeaseManager#LeaseMonitor] WARN  lease.LeaseManager (LeaseManager.java:run(285)) - Lease manager is interrupted. Shutting down...
java.lang.InterruptedException
	at java.base/java.util.concurrent.locks.AbstractQueuedSynchronizer.tryAcquireSharedNanos(AbstractQueuedSynchronizer.java:1167)
	at java.base/java.util.concurrent.Semaphore.tryAcquire(Semaphore.java:415)
	at org.apache.hadoop.ozone.lease.LeaseManager$LeaseMonitor.run(LeaseManager.java:283)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-11-06 18:21:09,351 [main] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchemaFromFile(128)) - Loading schema from [jar:file:/home/runner/work/ozone/ozone/hadoop-hdds/common/target/hdds-common-2.2.0-SNAPSHOT.jar!/network-topology-default.xml]
2025-11-06 18:21:09,351 [main] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchema(175)) - Loading network topology layer schema file
2025-11-06 18:21:09,362 [main] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchemaFromFile(128)) - Loading schema from [jar:file:/home/runner/work/ozone/ozone/hadoop-hdds/common/target/hdds-common-2.2.0-SNAPSHOT.jar!/network-topology-default.xml]
2025-11-06 18:21:09,362 [main] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchema(175)) - Loading network topology layer schema file
2025-11-06 18:21:09,364 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(133)) - Added a new node: /default-rack/74def35c-d69a-49d6-aadd-6d63d3499a14
2025-11-06 18:21:09,364 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(133)) - Added a new node: /default-rack/9c4671cd-a2d6-4eb5-a9d0-a4e6e65e2d86
2025-11-06 18:21:09,364 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(133)) - Added a new node: /default-rack/05630233-9150-4ec0-b651-d07dbcea692a
2025-11-06 18:21:09,364 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(133)) - Added a new node: /default-rack/5517a305-fc8b-4151-9cfd-80eb56799536
2025-11-06 18:21:09,365 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(133)) - Added a new node: /default-rack/deb1b3fd-c00c-419c-a032-5fa3955eb5d7
2025-11-06 18:21:09,365 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(133)) - Added a new node: /default-rack/48f38880-3267-4175-a7bd-441d0c45c4ba
2025-11-06 18:21:09,365 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(133)) - Added a new node: /default-rack/a56e05fc-9eba-4d6f-8d2b-f4ad76f89e9c
2025-11-06 18:21:09,365 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(133)) - Added a new node: /default-rack/e5a336a0-728e-4801-a378-f98896a07157
2025-11-06 18:21:09,366 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(133)) - Added a new node: /default-rack/272435f2-9e1c-4033-82a2-7be0b98da061
2025-11-06 18:21:09,366 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(133)) - Added a new node: /default-rack/5d0e391f-38ea-4bd1-ab8a-d41bd5470e58
2025-11-06 18:21:09,366 [main] WARN  utils.HAUtils (HAUtils.java:getMetaDir(311)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2025-11-06 18:21:09,367 [main] WARN  db.DBStoreBuilder (DBStoreBuilder.java:getDBDirPath(157)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2025-11-06 18:21:09,414 [main] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:<init>(231)) - Init the HA SequenceIdGenerator.
2025-11-06 18:21:09,415 [main] INFO  pipeline.PipelineStateManagerImpl (PipelineStateManagerImpl.java:initialize(75)) - No pipeline exists in current db
2025-11-06 18:21:09,415 [main] INFO  algorithms.LeaderChoosePolicyFactory (LeaderChoosePolicyFactory.java:getPolicy(55)) - Create leader choose policy of type org.apache.hadoop.hdds.scm.pipeline.leader.choose.algorithms.MinLeaderCountChoosePolicy
2025-11-06 18:21:09,415 [main] INFO  algorithms.ContainerPlacementPolicyFactory (ContainerPlacementPolicyFactory.java:getPolicyInternal(83)) - Create container placement policy of type org.apache.hadoop.hdds.scm.container.placement.algorithms.SCMContainerPlacementRackScatter
2025-11-06 18:21:09,416 [main] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service BackgroundPipelineCreator.
2025-11-06 18:21:09,416 [main] INFO  pipeline.BackgroundPipelineCreator (BackgroundPipelineCreator.java:start(126)) - Starting RatisPipelineUtilsThread.
2025-11-06 18:21:09,417 [main] INFO  BackgroundPipelineScrubber (BackgroundSCMService.java:start(64)) - Starting BackgroundPipelineScrubber Service.
2025-11-06 18:21:09,417 [main] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service BackgroundPipelineScrubber.
2025-11-06 18:21:09,417 [main] INFO  algorithms.LeaderChoosePolicyFactory (LeaderChoosePolicyFactory.java:getPolicy(55)) - Create leader choose policy of type org.apache.hadoop.hdds.scm.pipeline.leader.choose.algorithms.MinLeaderCountChoosePolicy
2025-11-06 18:21:09,419 [main] INFO  safemode.SCMSafeModeManager (AbstractContainerSafeModeRule.java:initializeRule(83)) - Refreshed RATIS Containers threshold count to 0.
2025-11-06 18:21:09,419 [main] INFO  safemode.SCMSafeModeManager (AbstractContainerSafeModeRule.java:initializeRule(83)) - Refreshed EC Containers threshold count to 0.
2025-11-06 18:21:09,419 [main] INFO  safemode.HealthyPipelineSafeModeRule (HealthyPipelineSafeModeRule.java:initializeRule(230)) - Total pipeline count is 0, healthy pipeline threshold count is 1
2025-11-06 18:21:09,420 [main] INFO  safemode.OneReplicaPipelineSafeModeRule (OneReplicaPipelineSafeModeRule.java:initializeRule(189)) - Total pipeline count is 0, pipeline's with at least one datanode reported threshold count is 0
2025-11-06 18:21:09,420 [main] INFO  safemode.SCMSafeModeManager (SCMSafeModeManager.java:<init>(102)) - Safemode is disabled, skipping Safemode rule validation and force exiting Safemode.
2025-11-06 18:21:09,420 [main] INFO  ha.SCMContext (SCMContext.java:updateSafeModeStatus(224)) - Update SafeModeStatus from SafeModeStatus{safeModeStatus=false, preCheckPassed=true} to SafeModeStatus{safeModeStatus=false, preCheckPassed=true}.
2025-11-06 18:21:09,420 [main] INFO  pipeline.BackgroundPipelineCreator (BackgroundPipelineCreator.java:notifyStatusChanged(268)) - Service BackgroundPipelineCreator transitions to RUNNING.
2025-11-06 18:21:09,420 [main] INFO  BackgroundPipelineScrubber (BackgroundSCMService.java:notifyStatusChanged(78)) - Service BackgroundPipelineScrubber transitions to RUNNING.
2025-11-06 18:21:09,420 [main] WARN  server.ServerUtils (ServerUtils.java:getScmDbDir(138)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2025-11-06 18:21:09,423 [main] WARN  server.ServerUtils (ServerUtils.java:getScmDbDir(138)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2025-11-06 18:21:09,424 [main] INFO  ha.SCMHANodeDetails (SCMHANodeDetails.java:loadSCMHAConfig(162)) - ServiceID for StorageContainerManager is null
2025-11-06 18:21:09,424 [main] INFO  ha.SCMHANodeDetails (SCMHANodeDetails.java:loadSCMHAConfig(166)) - ozone.scm.default.service.id is not defined, falling back to ozone.scm.service.ids to find serviceID for StorageContainerManager if it is HA enabled cluster
2025-11-06 18:21:09,425 [main] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchemaFromFile(128)) - Loading schema from [jar:file:/home/runner/work/ozone/ozone/hadoop-hdds/common/target/hdds-common-2.2.0-SNAPSHOT.jar!/network-topology-default.xml]
2025-11-06 18:21:09,425 [main] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchema(175)) - Loading network topology layer schema file
2025-11-06 18:21:09,428 [main] INFO  upgrade.AbstractLayoutVersionManager (AbstractLayoutVersionManager.java:init(80)) - Initializing Layout version manager with metadata layout = WITNESSED_CONTAINER_DB_PROTO_VALUE (version = 9), software layout = WITNESSED_CONTAINER_DB_PROTO_VALUE (version = 9)
2025-11-06 18:21:09,430 [main] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:upgradeToSequenceId(353)) - upgrade localId to 115816896921600000
2025-11-06 18:21:09,431 [main] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:upgradeToSequenceId(363)) - upgrade delTxnId to 0
2025-11-06 18:21:09,432 [main] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:upgradeToSequenceId(379)) - upgrade containerId to 0
2025-11-06 18:21:09,433 [main] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:upgradeToCertificateSequenceId(414)) - upgrade CertificateId to 2
2025-11-06 18:21:09,433 [main] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:<init>(231)) - Init the HA SequenceIdGenerator.
2025-11-06 18:21:09,433 [main] INFO  algorithms.ContainerPlacementPolicyFactory (ContainerPlacementPolicyFactory.java:getPolicyInternal(83)) - Create container placement policy of type org.apache.hadoop.hdds.scm.container.placement.algorithms.SCMContainerPlacementRackAware
2025-11-06 18:21:09,433 [main] INFO  algorithms.ContainerPlacementPolicyFactory (ContainerPlacementPolicyFactory.java:getPolicyInternal(83)) - Create container placement policy of type org.apache.hadoop.hdds.scm.container.placement.algorithms.SCMContainerPlacementRackScatter
2025-11-06 18:21:09,434 [main] INFO  ExpiredContainerReplicaOpScrubber (BackgroundSCMService.java:start(64)) - Starting ExpiredContainerReplicaOpScrubber Service.
2025-11-06 18:21:09,434 [main] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service ExpiredContainerReplicaOpScrubber.
2025-11-06 18:21:09,435 [main] INFO  algorithms.PipelineChoosePolicyFactory (PipelineChoosePolicyFactory.java:createPipelineChoosePolicyFromClass(78)) - Create pipeline choose policy of type org.apache.hadoop.hdds.scm.pipeline.choose.algorithms.RandomPipelineChoosePolicy
2025-11-06 18:21:09,435 [main] INFO  algorithms.PipelineChoosePolicyFactory (PipelineChoosePolicyFactory.java:createPipelineChoosePolicyFromClass(78)) - Create pipeline choose policy of type org.apache.hadoop.hdds.scm.pipeline.choose.algorithms.RandomPipelineChoosePolicy
2025-11-06 18:21:09,436 [main] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service SCMBlockDeletingService.
2025-11-06 18:21:09,437 [main] INFO  replication.ReplicationManager (ReplicationManager.java:start(287)) - Starting Replication Monitor Thread.
2025-11-06 18:21:09,438 [main] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service ReplicationManager.
2025-11-06 18:21:09,438 [ReplicationMonitor] INFO  replication.ReplicationManager (ReplicationManager.java:processAll(359)) - Replication Manager is not ready to run until 300000ms after safemode exit
2025-11-06 18:21:09,439 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:<init>(432)) - SCM start with adminUsers: [runner]
2025-11-06 18:21:09,439 [main] INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(93)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 10000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false, ipcFailOver: false.
2025-11-06 18:21:09,439 [main] INFO  ipc.Server (Server.java:<init>(1438)) - Listener at 0.0.0.0:34935
2025-11-06 18:21:09,440 [Socket Reader #1 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #1 for port 0
2025-11-06 18:21:09,440 [Socket Reader #2 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #2 for port 0
2025-11-06 18:21:09,441 [Socket Reader #3 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #3 for port 0
2025-11-06 18:21:09,441 [Socket Reader #4 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #4 for port 0
2025-11-06 18:21:09,441 [Socket Reader #5 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #5 for port 0
2025-11-06 18:21:09,442 [Socket Reader #6 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #6 for port 0
2025-11-06 18:21:09,442 [Socket Reader #7 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #7 for port 0
2025-11-06 18:21:09,442 [Socket Reader #8 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #8 for port 0
2025-11-06 18:21:09,442 [Socket Reader #9 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #9 for port 0
2025-11-06 18:21:09,443 [Socket Reader #10 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #10 for port 0
2025-11-06 18:21:09,444 [main] INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(93)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 10000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false, ipcFailOver: false.
2025-11-06 18:21:09,444 [main] INFO  ipc.Server (Server.java:<init>(1438)) - Listener at 0.0.0.0:42339
2025-11-06 18:21:09,445 [Socket Reader #1 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #1 for port 0
2025-11-06 18:21:09,445 [Socket Reader #2 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #2 for port 0
2025-11-06 18:21:09,445 [Socket Reader #3 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #3 for port 0
2025-11-06 18:21:09,446 [Socket Reader #4 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #4 for port 0
2025-11-06 18:21:09,446 [Socket Reader #5 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #5 for port 0
2025-11-06 18:21:09,446 [Socket Reader #6 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #6 for port 0
2025-11-06 18:21:09,447 [Socket Reader #7 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #7 for port 0
2025-11-06 18:21:09,447 [Socket Reader #8 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #8 for port 0
2025-11-06 18:21:09,447 [Socket Reader #9 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #9 for port 0
2025-11-06 18:21:09,447 [Socket Reader #10 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #10 for port 0
2025-11-06 18:21:09,448 [main] INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(93)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 10000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false, ipcFailOver: false.
2025-11-06 18:21:09,448 [main] INFO  ipc.Server (Server.java:<init>(1438)) - Listener at 0.0.0.0:43377
2025-11-06 18:21:09,449 [Socket Reader #1 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #1 for port 0
2025-11-06 18:21:09,449 [Socket Reader #2 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #2 for port 0
2025-11-06 18:21:09,449 [Socket Reader #3 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #3 for port 0
2025-11-06 18:21:09,449 [Socket Reader #4 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #4 for port 0
2025-11-06 18:21:09,449 [Socket Reader #5 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #5 for port 0
2025-11-06 18:21:09,450 [Socket Reader #6 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #6 for port 0
2025-11-06 18:21:09,450 [Socket Reader #7 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #7 for port 0
2025-11-06 18:21:09,450 [Socket Reader #8 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #8 for port 0
2025-11-06 18:21:09,450 [Socket Reader #9 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #9 for port 0
2025-11-06 18:21:09,450 [Socket Reader #10 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #10 for port 0
2025-11-06 18:21:09,455 [main] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service ContainerBalancer.
2025-11-06 18:21:09,455 [main] INFO  ha.SCMContext (SCMContext.java:updateSafeModeStatus(224)) - Update SafeModeStatus from SafeModeStatus{safeModeStatus=false, preCheckPassed=true} to SafeModeStatus{safeModeStatus=false, preCheckPassed=true}.
2025-11-06 18:21:09,456 [main] INFO  ha.SCMContext (SCMContext.java:updateSafeModeStatus(224)) - Update SafeModeStatus from SafeModeStatus{safeModeStatus=false, preCheckPassed=true} to SafeModeStatus{safeModeStatus=false, preCheckPassed=true}.
2025-11-06 18:21:09,457 [main] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(208)) - Sending CreatePipelineCommand for pipeline:Pipeline-5ab167da-623a-44dc-bfb6-b101742fe99d to datanode:48f38880-3267-4175-a7bd-441d0c45c4ba(localhost-30.133.216.249/30.133.216.249)
2025-11-06 18:21:09,459 [main] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(208)) - Sending CreatePipelineCommand for pipeline:Pipeline-5ab167da-623a-44dc-bfb6-b101742fe99d to datanode:deb1b3fd-c00c-419c-a032-5fa3955eb5d7(localhost-164.50.182.184/164.50.182.184)
2025-11-06 18:21:09,460 [main] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(208)) - Sending CreatePipelineCommand for pipeline:Pipeline-5ab167da-623a-44dc-bfb6-b101742fe99d to datanode:5517a305-fc8b-4151-9cfd-80eb56799536(localhost-71.139.100.190/71.139.100.190)
2025-11-06 18:21:09,562 [main] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:getNextId(135)) - Allocate a batch for containerId, change lastId from 0 to 1000.
2025-11-06 18:21:09,563 [main] WARN  ha.SequenceIdGenerator (SequenceIdGenerator.java:allocateBatch(248)) - Failed to allocate a batch for localId, expected lastId is 0, actual lastId is 115816896921600000.
2025-11-06 18:21:09,564 [main] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:getNextId(135)) - Allocate a batch for localId, change lastId from 115816896921600000 to 115816896921601000.
2025-11-06 18:21:09,564 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1616)) - Container Balancer is not running.
2025-11-06 18:21:09,565 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stopReplicationManager(1749)) - Stopping Replication Manager Service.
2025-11-06 18:21:09,565 [main] INFO  replication.ReplicationManager (ReplicationManager.java:stop(318)) - Stopping Replication Monitor Thread.
2025-11-06 18:21:09,569 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1625)) - Stopping the Datanode Admin Monitor.
2025-11-06 18:21:09,569 [LeakDetector-ManagedRocksObject0] WARN  managed.ManagedRocksObjectUtils (HddsUtils.java:reportLeak(902)) - ManagedWriteBatch is not closed properly
2025-11-06 18:21:09,569 [LeakDetector-ManagedRocksObject0] WARN  managed.ManagedRocksObjectUtils (HddsUtils.java:reportLeak(902)) - ManagedWriteBatch is not closed properly
2025-11-06 18:21:09,569 [LeakDetector-ManagedRocksObject0] WARN  managed.ManagedRocksObjectUtils (HddsUtils.java:reportLeak(902)) - ManagedWriteBatch is not closed properly
2025-11-06 18:21:09,569 [OverReplicatedProcessor] WARN  replication.UnhealthyReplicationProcessor (UnhealthyReplicationProcessor.java:run(178)) - OverReplicatedProcessor interrupted. Exiting...
2025-11-06 18:21:09,569 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1632)) - Stopping datanode service RPC server
2025-11-06 18:21:09,570 [UnderReplicatedProcessor] WARN  replication.UnhealthyReplicationProcessor (UnhealthyReplicationProcessor.java:run(178)) - UnderReplicatedProcessor interrupted. Exiting...
2025-11-06 18:21:09,569 [ReplicationMonitor] INFO  replication.ReplicationManager (ReplicationManager.java:run(938)) - Replication Monitor Thread is stopped
2025-11-06 18:21:09,570 [main] INFO  server.SCMDatanodeProtocolServer (SCMDatanodeProtocolServer.java:stop(455)) - Stopping the RPC server for DataNodes
2025-11-06 18:21:09,572 [main] INFO  ipc.Server (Server.java:stop(3697)) - Stopping server on 34935
2025-11-06 18:21:09,574 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1640)) - Stopping block service RPC server
2025-11-06 18:21:09,574 [main] INFO  server.SCMBlockProtocolServer (SCMBlockProtocolServer.java:stop(175)) - Stopping the RPC server for Block Protocol
2025-11-06 18:21:09,574 [main] INFO  ipc.Server (Server.java:stop(3697)) - Stopping server on 42339
2025-11-06 18:21:09,576 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1647)) - Stopping the StorageContainerLocationProtocol RPC server
2025-11-06 18:21:09,576 [main] INFO  server.SCMClientProtocolServer (SCMClientProtocolServer.java:stop(218)) - Stopping the RPC server for Client Protocol
2025-11-06 18:21:09,576 [main] INFO  ipc.Server (Server.java:stop(3697)) - Stopping server on 43377
2025-11-06 18:21:09,577 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1654)) - Stopping Storage Container Manager HTTP server.
2025-11-06 18:21:09,577 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1662)) - Stopping SCM LayoutVersionManager Service.
2025-11-06 18:21:09,577 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1674)) - Stopping Block Manager Service.
2025-11-06 18:21:09,578 [main] INFO  utils.BackgroundService (BackgroundService.java:shutdown(195)) - Shutting down service SCMBlockDeletingService
2025-11-06 18:21:09,578 [main] INFO  utils.BackgroundService (BackgroundService.java:shutdown(195)) - Shutting down service SCMBlockDeletingService
2025-11-06 18:21:09,578 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1699)) - Stopping SCM Event Queue.
2025-11-06 18:21:09,580 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1706)) - Stopping SCM HA services.
2025-11-06 18:21:09,580 [main] INFO  pipeline.BackgroundPipelineCreator (BackgroundPipelineCreator.java:stop(154)) - Stopping RatisPipelineUtilsThread.
2025-11-06 18:21:09,580 [RatisPipelineUtilsThread-0] WARN  pipeline.BackgroundPipelineCreator (BackgroundPipelineCreator.java:run(185)) - RatisPipelineUtilsThread is interrupted.
2025-11-06 18:21:09,581 [BackgroundPipelineScrubber] WARN  BackgroundPipelineScrubber (BackgroundSCMService.java:run(111)) - BackgroundPipelineScrubber is interrupted, exit
2025-11-06 18:21:09,582 [main] INFO  BackgroundPipelineScrubber (BackgroundSCMService.java:stop(127)) - Stopping BackgroundPipelineScrubber Service.
2025-11-06 18:21:09,582 [main] INFO  ExpiredContainerReplicaOpScrubber (BackgroundSCMService.java:stop(127)) - Stopping ExpiredContainerReplicaOpScrubber Service.
2025-11-06 18:21:09,582 [main] INFO  utils.BackgroundService (BackgroundService.java:shutdown(195)) - Shutting down service SCMBlockDeletingService
2025-11-06 18:21:09,582 [main] INFO  replication.ReplicationManager (ReplicationManager.java:stop(325)) - Replication Monitor Thread is not running.
2025-11-06 18:21:09,582 [main] WARN  balancer.ContainerBalancer (ContainerBalancer.java:stop(362)) - Cannot stop Container Balancer because it's not running or stopping
2025-11-06 18:21:09,582 [ExpiredContainerReplicaOpScrubber] WARN  ExpiredContainerReplicaOpScrubber (BackgroundSCMService.java:run(111)) - ExpiredContainerReplicaOpScrubber is interrupted, exit
2025-11-06 18:21:09,582 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1740)) - Stopping SCM MetadataStore.
2025-11-06 18:21:09,583 [test-leaseManagerLeaseManager#LeaseMonitor] WARN  lease.LeaseManager (LeaseManager.java:run(285)) - Lease manager is interrupted. Shutting down...
java.lang.InterruptedException
	at java.base/java.util.concurrent.locks.AbstractQueuedSynchronizer.tryAcquireSharedNanos(AbstractQueuedSynchronizer.java:1167)
	at java.base/java.util.concurrent.Semaphore.tryAcquire(Semaphore.java:415)
	at org.apache.hadoop.ozone.lease.LeaseManager$LeaseMonitor.run(LeaseManager.java:283)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-11-06 18:21:09,616 [main] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchemaFromFile(128)) - Loading schema from [jar:file:/home/runner/work/ozone/ozone/hadoop-hdds/common/target/hdds-common-2.2.0-SNAPSHOT.jar!/network-topology-default.xml]
2025-11-06 18:21:09,616 [main] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchema(175)) - Loading network topology layer schema file
2025-11-06 18:21:09,629 [main] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchemaFromFile(128)) - Loading schema from [jar:file:/home/runner/work/ozone/ozone/hadoop-hdds/common/target/hdds-common-2.2.0-SNAPSHOT.jar!/network-topology-default.xml]
2025-11-06 18:21:09,629 [main] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchema(175)) - Loading network topology layer schema file
2025-11-06 18:21:09,631 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(133)) - Added a new node: /default-rack/7b43a54d-0a71-4c18-b0a0-f4dbb2de3999
2025-11-06 18:21:09,632 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(133)) - Added a new node: /default-rack/259aff54-4867-4cb7-98a0-b7fb743de2a6
2025-11-06 18:21:09,632 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(133)) - Added a new node: /default-rack/01897f1f-513f-4989-a079-6aa87e113749
2025-11-06 18:21:09,632 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(133)) - Added a new node: /default-rack/4712d580-8d51-436b-aedd-72de1bdc8326
2025-11-06 18:21:09,632 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(133)) - Added a new node: /default-rack/535cedcc-f24a-47b2-98f4-e32fb989fa58
2025-11-06 18:21:09,632 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(133)) - Added a new node: /default-rack/76716bb0-9ac8-47b2-9ffd-cba1571cd14e
2025-11-06 18:21:09,633 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(133)) - Added a new node: /default-rack/9bddda33-e006-48e8-85d4-3bf277dd5311
2025-11-06 18:21:09,633 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(133)) - Added a new node: /default-rack/7f7a6d6b-c3b5-4b92-a695-7012f847ec1d
2025-11-06 18:21:09,633 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(133)) - Added a new node: /default-rack/40c20ef2-5d29-4477-8d2d-f2e16a739620
2025-11-06 18:21:09,633 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(133)) - Added a new node: /default-rack/5134e949-e02c-49f5-802a-88907d0e5ccd
2025-11-06 18:21:09,634 [main] WARN  utils.HAUtils (HAUtils.java:getMetaDir(311)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2025-11-06 18:21:09,634 [main] WARN  db.DBStoreBuilder (DBStoreBuilder.java:getDBDirPath(157)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2025-11-06 18:21:09,676 [main] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:<init>(231)) - Init the HA SequenceIdGenerator.
2025-11-06 18:21:09,677 [main] INFO  pipeline.PipelineStateManagerImpl (PipelineStateManagerImpl.java:initialize(75)) - No pipeline exists in current db
2025-11-06 18:21:09,677 [main] INFO  algorithms.LeaderChoosePolicyFactory (LeaderChoosePolicyFactory.java:getPolicy(55)) - Create leader choose policy of type org.apache.hadoop.hdds.scm.pipeline.leader.choose.algorithms.MinLeaderCountChoosePolicy
2025-11-06 18:21:09,677 [main] INFO  algorithms.ContainerPlacementPolicyFactory (ContainerPlacementPolicyFactory.java:getPolicyInternal(83)) - Create container placement policy of type org.apache.hadoop.hdds.scm.container.placement.algorithms.SCMContainerPlacementRackScatter
2025-11-06 18:21:09,678 [main] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service BackgroundPipelineCreator.
2025-11-06 18:21:09,678 [main] INFO  pipeline.BackgroundPipelineCreator (BackgroundPipelineCreator.java:start(126)) - Starting RatisPipelineUtilsThread.
2025-11-06 18:21:09,679 [main] INFO  BackgroundPipelineScrubber (BackgroundSCMService.java:start(64)) - Starting BackgroundPipelineScrubber Service.
2025-11-06 18:21:09,679 [main] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service BackgroundPipelineScrubber.
2025-11-06 18:21:09,680 [main] INFO  algorithms.LeaderChoosePolicyFactory (LeaderChoosePolicyFactory.java:getPolicy(55)) - Create leader choose policy of type org.apache.hadoop.hdds.scm.pipeline.leader.choose.algorithms.MinLeaderCountChoosePolicy
2025-11-06 18:21:09,681 [main] INFO  safemode.SCMSafeModeManager (AbstractContainerSafeModeRule.java:initializeRule(83)) - Refreshed RATIS Containers threshold count to 0.
2025-11-06 18:21:09,681 [main] INFO  safemode.SCMSafeModeManager (AbstractContainerSafeModeRule.java:initializeRule(83)) - Refreshed EC Containers threshold count to 0.
2025-11-06 18:21:09,681 [main] INFO  safemode.HealthyPipelineSafeModeRule (HealthyPipelineSafeModeRule.java:initializeRule(230)) - Total pipeline count is 0, healthy pipeline threshold count is 1
2025-11-06 18:21:09,682 [main] INFO  safemode.OneReplicaPipelineSafeModeRule (OneReplicaPipelineSafeModeRule.java:initializeRule(189)) - Total pipeline count is 0, pipeline's with at least one datanode reported threshold count is 0
2025-11-06 18:21:09,682 [main] INFO  safemode.SCMSafeModeManager (SCMSafeModeManager.java:<init>(102)) - Safemode is disabled, skipping Safemode rule validation and force exiting Safemode.
2025-11-06 18:21:09,682 [main] INFO  ha.SCMContext (SCMContext.java:updateSafeModeStatus(224)) - Update SafeModeStatus from SafeModeStatus{safeModeStatus=false, preCheckPassed=true} to SafeModeStatus{safeModeStatus=false, preCheckPassed=true}.
2025-11-06 18:21:09,682 [main] INFO  pipeline.BackgroundPipelineCreator (BackgroundPipelineCreator.java:notifyStatusChanged(268)) - Service BackgroundPipelineCreator transitions to RUNNING.
2025-11-06 18:21:09,682 [main] INFO  BackgroundPipelineScrubber (BackgroundSCMService.java:notifyStatusChanged(78)) - Service BackgroundPipelineScrubber transitions to RUNNING.
2025-11-06 18:21:09,682 [main] WARN  server.ServerUtils (ServerUtils.java:getScmDbDir(138)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2025-11-06 18:21:09,686 [main] WARN  server.ServerUtils (ServerUtils.java:getScmDbDir(138)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2025-11-06 18:21:09,687 [main] INFO  ha.SCMHANodeDetails (SCMHANodeDetails.java:loadSCMHAConfig(162)) - ServiceID for StorageContainerManager is null
2025-11-06 18:21:09,688 [main] INFO  ha.SCMHANodeDetails (SCMHANodeDetails.java:loadSCMHAConfig(166)) - ozone.scm.default.service.id is not defined, falling back to ozone.scm.service.ids to find serviceID for StorageContainerManager if it is HA enabled cluster
2025-11-06 18:21:09,689 [main] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchemaFromFile(128)) - Loading schema from [jar:file:/home/runner/work/ozone/ozone/hadoop-hdds/common/target/hdds-common-2.2.0-SNAPSHOT.jar!/network-topology-default.xml]
2025-11-06 18:21:09,689 [main] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchema(175)) - Loading network topology layer schema file
2025-11-06 18:21:09,694 [main] INFO  upgrade.AbstractLayoutVersionManager (AbstractLayoutVersionManager.java:init(80)) - Initializing Layout version manager with metadata layout = WITNESSED_CONTAINER_DB_PROTO_VALUE (version = 9), software layout = WITNESSED_CONTAINER_DB_PROTO_VALUE (version = 9)
2025-11-06 18:21:09,697 [main] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:upgradeToSequenceId(353)) - upgrade localId to 115816896921600000
2025-11-06 18:21:09,699 [main] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:upgradeToSequenceId(363)) - upgrade delTxnId to 0
2025-11-06 18:21:09,700 [main] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:upgradeToSequenceId(379)) - upgrade containerId to 0
2025-11-06 18:21:09,701 [main] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:upgradeToCertificateSequenceId(414)) - upgrade CertificateId to 2
2025-11-06 18:21:09,702 [main] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:<init>(231)) - Init the HA SequenceIdGenerator.
2025-11-06 18:21:09,702 [main] INFO  algorithms.ContainerPlacementPolicyFactory (ContainerPlacementPolicyFactory.java:getPolicyInternal(83)) - Create container placement policy of type org.apache.hadoop.hdds.scm.container.placement.algorithms.SCMContainerPlacementRackAware
2025-11-06 18:21:09,703 [main] INFO  algorithms.ContainerPlacementPolicyFactory (ContainerPlacementPolicyFactory.java:getPolicyInternal(83)) - Create container placement policy of type org.apache.hadoop.hdds.scm.container.placement.algorithms.SCMContainerPlacementRackScatter
2025-11-06 18:21:09,703 [main] INFO  ExpiredContainerReplicaOpScrubber (BackgroundSCMService.java:start(64)) - Starting ExpiredContainerReplicaOpScrubber Service.
2025-11-06 18:21:09,704 [main] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service ExpiredContainerReplicaOpScrubber.
2025-11-06 18:21:09,704 [main] INFO  algorithms.PipelineChoosePolicyFactory (PipelineChoosePolicyFactory.java:createPipelineChoosePolicyFromClass(78)) - Create pipeline choose policy of type org.apache.hadoop.hdds.scm.pipeline.choose.algorithms.RandomPipelineChoosePolicy
2025-11-06 18:21:09,704 [main] INFO  algorithms.PipelineChoosePolicyFactory (PipelineChoosePolicyFactory.java:createPipelineChoosePolicyFromClass(78)) - Create pipeline choose policy of type org.apache.hadoop.hdds.scm.pipeline.choose.algorithms.RandomPipelineChoosePolicy
2025-11-06 18:21:09,706 [main] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service SCMBlockDeletingService.
2025-11-06 18:21:09,707 [main] INFO  replication.ReplicationManager (ReplicationManager.java:start(287)) - Starting Replication Monitor Thread.
2025-11-06 18:21:09,707 [main] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service ReplicationManager.
2025-11-06 18:21:09,708 [ReplicationMonitor] INFO  replication.ReplicationManager (ReplicationManager.java:processAll(359)) - Replication Manager is not ready to run until 300000ms after safemode exit
2025-11-06 18:21:09,709 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:<init>(432)) - SCM start with adminUsers: [runner]
2025-11-06 18:21:09,709 [main] INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(93)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 10000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false, ipcFailOver: false.
2025-11-06 18:21:09,710 [main] INFO  ipc.Server (Server.java:<init>(1438)) - Listener at 0.0.0.0:38367
2025-11-06 18:21:09,710 [Socket Reader #1 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #1 for port 0
2025-11-06 18:21:09,711 [Socket Reader #2 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #2 for port 0
2025-11-06 18:21:09,712 [Socket Reader #3 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #3 for port 0
2025-11-06 18:21:09,713 [Socket Reader #4 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #4 for port 0
2025-11-06 18:21:09,714 [Socket Reader #5 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #5 for port 0
2025-11-06 18:21:09,715 [Socket Reader #7 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #7 for port 0
2025-11-06 18:21:09,715 [Socket Reader #6 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #6 for port 0
2025-11-06 18:21:09,716 [Socket Reader #8 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #8 for port 0
2025-11-06 18:21:09,716 [Socket Reader #9 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #9 for port 0
2025-11-06 18:21:09,717 [Socket Reader #10 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #10 for port 0
2025-11-06 18:21:09,718 [main] INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(93)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 10000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false, ipcFailOver: false.
2025-11-06 18:21:09,719 [main] INFO  ipc.Server (Server.java:<init>(1438)) - Listener at 0.0.0.0:39115
2025-11-06 18:21:09,720 [Socket Reader #1 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #1 for port 0
2025-11-06 18:21:09,720 [Socket Reader #2 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #2 for port 0
2025-11-06 18:21:09,720 [Socket Reader #3 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #3 for port 0
2025-11-06 18:21:09,721 [Socket Reader #5 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #5 for port 0
2025-11-06 18:21:09,721 [Socket Reader #4 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #4 for port 0
2025-11-06 18:21:09,721 [Socket Reader #6 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #6 for port 0
2025-11-06 18:21:09,722 [Socket Reader #7 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #7 for port 0
2025-11-06 18:21:09,722 [Socket Reader #8 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #8 for port 0
2025-11-06 18:21:09,722 [Socket Reader #9 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #9 for port 0
2025-11-06 18:21:09,723 [Socket Reader #10 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #10 for port 0
2025-11-06 18:21:09,724 [main] INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(93)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 10000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false, ipcFailOver: false.
2025-11-06 18:21:09,724 [main] INFO  ipc.Server (Server.java:<init>(1438)) - Listener at 0.0.0.0:36067
2025-11-06 18:21:09,725 [Socket Reader #1 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #1 for port 0
2025-11-06 18:21:09,725 [Socket Reader #2 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #2 for port 0
2025-11-06 18:21:09,725 [Socket Reader #3 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #3 for port 0
2025-11-06 18:21:09,726 [Socket Reader #4 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #4 for port 0
2025-11-06 18:21:09,727 [Socket Reader #5 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #5 for port 0
2025-11-06 18:21:09,727 [Socket Reader #7 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #7 for port 0
2025-11-06 18:21:09,727 [Socket Reader #8 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #8 for port 0
2025-11-06 18:21:09,727 [Socket Reader #6 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #6 for port 0
2025-11-06 18:21:09,728 [Socket Reader #9 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #9 for port 0
2025-11-06 18:21:09,728 [Socket Reader #10 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #10 for port 0
2025-11-06 18:21:09,735 [main] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service ContainerBalancer.
2025-11-06 18:21:09,735 [main] INFO  ha.SCMContext (SCMContext.java:updateSafeModeStatus(224)) - Update SafeModeStatus from SafeModeStatus{safeModeStatus=false, preCheckPassed=true} to SafeModeStatus{safeModeStatus=false, preCheckPassed=true}.
2025-11-06 18:21:09,736 [main] INFO  ha.SCMContext (SCMContext.java:updateSafeModeStatus(224)) - Update SafeModeStatus from SafeModeStatus{safeModeStatus=false, preCheckPassed=true} to SafeModeStatus{safeModeStatus=false, preCheckPassed=true}.
2025-11-06 18:21:09,739 [main] WARN  block.BlockManagerImpl (BlockManagerImpl.java:allocateBlock(158)) - Invalid block size requested : 6442450944
2025-11-06 18:21:09,739 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1616)) - Container Balancer is not running.
2025-11-06 18:21:09,739 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stopReplicationManager(1749)) - Stopping Replication Manager Service.
2025-11-06 18:21:09,740 [main] INFO  replication.ReplicationManager (ReplicationManager.java:stop(318)) - Stopping Replication Monitor Thread.
2025-11-06 18:21:09,740 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1625)) - Stopping the Datanode Admin Monitor.
2025-11-06 18:21:09,740 [UnderReplicatedProcessor] WARN  replication.UnhealthyReplicationProcessor (UnhealthyReplicationProcessor.java:run(178)) - UnderReplicatedProcessor interrupted. Exiting...
2025-11-06 18:21:09,740 [ReplicationMonitor] INFO  replication.ReplicationManager (ReplicationManager.java:run(938)) - Replication Monitor Thread is stopped
2025-11-06 18:21:09,740 [OverReplicatedProcessor] WARN  replication.UnhealthyReplicationProcessor (UnhealthyReplicationProcessor.java:run(178)) - OverReplicatedProcessor interrupted. Exiting...
2025-11-06 18:21:09,741 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1632)) - Stopping datanode service RPC server
2025-11-06 18:21:09,741 [main] INFO  server.SCMDatanodeProtocolServer (SCMDatanodeProtocolServer.java:stop(455)) - Stopping the RPC server for DataNodes
2025-11-06 18:21:09,741 [main] INFO  ipc.Server (Server.java:stop(3697)) - Stopping server on 38367
2025-11-06 18:21:09,743 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1640)) - Stopping block service RPC server
2025-11-06 18:21:09,743 [main] INFO  server.SCMBlockProtocolServer (SCMBlockProtocolServer.java:stop(175)) - Stopping the RPC server for Block Protocol
2025-11-06 18:21:09,743 [main] INFO  ipc.Server (Server.java:stop(3697)) - Stopping server on 39115
2025-11-06 18:21:09,745 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1647)) - Stopping the StorageContainerLocationProtocol RPC server
2025-11-06 18:21:09,745 [main] INFO  server.SCMClientProtocolServer (SCMClientProtocolServer.java:stop(218)) - Stopping the RPC server for Client Protocol
2025-11-06 18:21:09,745 [main] INFO  ipc.Server (Server.java:stop(3697)) - Stopping server on 36067
2025-11-06 18:21:09,747 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1654)) - Stopping Storage Container Manager HTTP server.
2025-11-06 18:21:09,747 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1662)) - Stopping SCM LayoutVersionManager Service.
2025-11-06 18:21:09,747 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1674)) - Stopping Block Manager Service.
2025-11-06 18:21:09,747 [main] INFO  utils.BackgroundService (BackgroundService.java:shutdown(195)) - Shutting down service SCMBlockDeletingService
2025-11-06 18:21:09,747 [main] INFO  utils.BackgroundService (BackgroundService.java:shutdown(195)) - Shutting down service SCMBlockDeletingService
2025-11-06 18:21:09,748 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1699)) - Stopping SCM Event Queue.
2025-11-06 18:21:09,748 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1706)) - Stopping SCM HA services.
2025-11-06 18:21:09,748 [main] INFO  pipeline.BackgroundPipelineCreator (BackgroundPipelineCreator.java:stop(154)) - Stopping RatisPipelineUtilsThread.
2025-11-06 18:21:09,749 [RatisPipelineUtilsThread-0] WARN  pipeline.BackgroundPipelineCreator (BackgroundPipelineCreator.java:run(185)) - RatisPipelineUtilsThread is interrupted.
2025-11-06 18:21:09,749 [main] INFO  BackgroundPipelineScrubber (BackgroundSCMService.java:stop(127)) - Stopping BackgroundPipelineScrubber Service.
2025-11-06 18:21:09,750 [main] INFO  ExpiredContainerReplicaOpScrubber (BackgroundSCMService.java:stop(127)) - Stopping ExpiredContainerReplicaOpScrubber Service.
2025-11-06 18:21:09,750 [main] INFO  utils.BackgroundService (BackgroundService.java:shutdown(195)) - Shutting down service SCMBlockDeletingService
2025-11-06 18:21:09,750 [main] INFO  replication.ReplicationManager (ReplicationManager.java:stop(325)) - Replication Monitor Thread is not running.
2025-11-06 18:21:09,750 [main] WARN  balancer.ContainerBalancer (ContainerBalancer.java:stop(362)) - Cannot stop Container Balancer because it's not running or stopping
2025-11-06 18:21:09,750 [ExpiredContainerReplicaOpScrubber] WARN  ExpiredContainerReplicaOpScrubber (BackgroundSCMService.java:run(111)) - ExpiredContainerReplicaOpScrubber is interrupted, exit
2025-11-06 18:21:09,751 [test-leaseManagerLeaseManager#LeaseMonitor] WARN  lease.LeaseManager (LeaseManager.java:run(285)) - Lease manager is interrupted. Shutting down...
java.lang.InterruptedException
	at java.base/java.util.concurrent.locks.AbstractQueuedSynchronizer.tryAcquireSharedNanos(AbstractQueuedSynchronizer.java:1167)
	at java.base/java.util.concurrent.Semaphore.tryAcquire(Semaphore.java:415)
	at org.apache.hadoop.ozone.lease.LeaseManager$LeaseMonitor.run(LeaseManager.java:283)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-11-06 18:21:09,751 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1740)) - Stopping SCM MetadataStore.
2025-11-06 18:21:09,751 [BackgroundPipelineScrubber] WARN  BackgroundPipelineScrubber (BackgroundSCMService.java:run(111)) - BackgroundPipelineScrubber is interrupted, exit
2025-11-06 18:21:09,790 [main] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchemaFromFile(128)) - Loading schema from [jar:file:/home/runner/work/ozone/ozone/hadoop-hdds/common/target/hdds-common-2.2.0-SNAPSHOT.jar!/network-topology-default.xml]
2025-11-06 18:21:09,791 [main] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchema(175)) - Loading network topology layer schema file
2025-11-06 18:21:09,806 [main] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchemaFromFile(128)) - Loading schema from [jar:file:/home/runner/work/ozone/ozone/hadoop-hdds/common/target/hdds-common-2.2.0-SNAPSHOT.jar!/network-topology-default.xml]
2025-11-06 18:21:09,806 [main] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchema(175)) - Loading network topology layer schema file
2025-11-06 18:21:09,808 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(133)) - Added a new node: /default-rack/2dac065b-e357-4f13-8772-60e8c907691c
2025-11-06 18:21:09,809 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(133)) - Added a new node: /default-rack/ee119137-02cc-424e-90d9-da5fb0c7f899
2025-11-06 18:21:09,809 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(133)) - Added a new node: /default-rack/dd1edd85-cc61-4a22-a8cb-44b61a04aff5
2025-11-06 18:21:09,809 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(133)) - Added a new node: /default-rack/a868a881-d0c8-47b9-921f-c4aeddc663f4
2025-11-06 18:21:09,810 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(133)) - Added a new node: /default-rack/161a91b3-e051-4f2c-9f45-56b203bc243e
2025-11-06 18:21:09,810 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(133)) - Added a new node: /default-rack/a1593371-16c7-4306-afdd-ba0ca0312bfc
2025-11-06 18:21:09,810 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(133)) - Added a new node: /default-rack/ea287663-8815-4035-8b79-e76f767d7adc
2025-11-06 18:21:09,810 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(133)) - Added a new node: /default-rack/7fb6b431-678e-471f-a6eb-cd76d8c9c1cf
2025-11-06 18:21:09,811 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(133)) - Added a new node: /default-rack/7dafa508-caec-44dc-b662-ddc07d25171e
2025-11-06 18:21:09,811 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(133)) - Added a new node: /default-rack/fbde6dc4-d802-4955-b700-996c117b6fc9
2025-11-06 18:21:09,811 [main] WARN  utils.HAUtils (HAUtils.java:getMetaDir(311)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2025-11-06 18:21:09,812 [main] WARN  db.DBStoreBuilder (DBStoreBuilder.java:getDBDirPath(157)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2025-11-06 18:21:09,873 [main] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:<init>(231)) - Init the HA SequenceIdGenerator.
2025-11-06 18:21:09,873 [main] INFO  pipeline.PipelineStateManagerImpl (PipelineStateManagerImpl.java:initialize(75)) - No pipeline exists in current db
2025-11-06 18:21:09,874 [main] INFO  algorithms.LeaderChoosePolicyFactory (LeaderChoosePolicyFactory.java:getPolicy(55)) - Create leader choose policy of type org.apache.hadoop.hdds.scm.pipeline.leader.choose.algorithms.MinLeaderCountChoosePolicy
2025-11-06 18:21:09,874 [main] INFO  algorithms.ContainerPlacementPolicyFactory (ContainerPlacementPolicyFactory.java:getPolicyInternal(83)) - Create container placement policy of type org.apache.hadoop.hdds.scm.container.placement.algorithms.SCMContainerPlacementRackScatter
2025-11-06 18:21:09,874 [main] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service BackgroundPipelineCreator.
2025-11-06 18:21:09,875 [main] INFO  pipeline.BackgroundPipelineCreator (BackgroundPipelineCreator.java:start(126)) - Starting RatisPipelineUtilsThread.
2025-11-06 18:21:09,875 [main] INFO  BackgroundPipelineScrubber (BackgroundSCMService.java:start(64)) - Starting BackgroundPipelineScrubber Service.
2025-11-06 18:21:09,875 [main] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service BackgroundPipelineScrubber.
2025-11-06 18:21:09,876 [main] INFO  algorithms.LeaderChoosePolicyFactory (LeaderChoosePolicyFactory.java:getPolicy(55)) - Create leader choose policy of type org.apache.hadoop.hdds.scm.pipeline.leader.choose.algorithms.MinLeaderCountChoosePolicy
2025-11-06 18:21:09,877 [main] INFO  safemode.SCMSafeModeManager (AbstractContainerSafeModeRule.java:initializeRule(83)) - Refreshed RATIS Containers threshold count to 0.
2025-11-06 18:21:09,877 [main] INFO  safemode.SCMSafeModeManager (AbstractContainerSafeModeRule.java:initializeRule(83)) - Refreshed EC Containers threshold count to 0.
2025-11-06 18:21:09,877 [main] INFO  safemode.HealthyPipelineSafeModeRule (HealthyPipelineSafeModeRule.java:initializeRule(230)) - Total pipeline count is 0, healthy pipeline threshold count is 1
2025-11-06 18:21:09,877 [main] INFO  safemode.OneReplicaPipelineSafeModeRule (OneReplicaPipelineSafeModeRule.java:initializeRule(189)) - Total pipeline count is 0, pipeline's with at least one datanode reported threshold count is 0
2025-11-06 18:21:09,877 [main] INFO  safemode.SCMSafeModeManager (SCMSafeModeManager.java:<init>(102)) - Safemode is disabled, skipping Safemode rule validation and force exiting Safemode.
2025-11-06 18:21:09,877 [main] INFO  ha.SCMContext (SCMContext.java:updateSafeModeStatus(224)) - Update SafeModeStatus from SafeModeStatus{safeModeStatus=false, preCheckPassed=true} to SafeModeStatus{safeModeStatus=false, preCheckPassed=true}.
2025-11-06 18:21:09,878 [main] INFO  pipeline.BackgroundPipelineCreator (BackgroundPipelineCreator.java:notifyStatusChanged(268)) - Service BackgroundPipelineCreator transitions to RUNNING.
2025-11-06 18:21:09,878 [main] INFO  BackgroundPipelineScrubber (BackgroundSCMService.java:notifyStatusChanged(78)) - Service BackgroundPipelineScrubber transitions to RUNNING.
2025-11-06 18:21:09,878 [main] WARN  server.ServerUtils (ServerUtils.java:getScmDbDir(138)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2025-11-06 18:21:09,880 [main] WARN  server.ServerUtils (ServerUtils.java:getScmDbDir(138)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2025-11-06 18:21:09,880 [main] INFO  ha.SCMHANodeDetails (SCMHANodeDetails.java:loadSCMHAConfig(162)) - ServiceID for StorageContainerManager is null
2025-11-06 18:21:09,880 [main] INFO  ha.SCMHANodeDetails (SCMHANodeDetails.java:loadSCMHAConfig(166)) - ozone.scm.default.service.id is not defined, falling back to ozone.scm.service.ids to find serviceID for StorageContainerManager if it is HA enabled cluster
2025-11-06 18:21:09,882 [main] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchemaFromFile(128)) - Loading schema from [jar:file:/home/runner/work/ozone/ozone/hadoop-hdds/common/target/hdds-common-2.2.0-SNAPSHOT.jar!/network-topology-default.xml]
2025-11-06 18:21:09,882 [main] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchema(175)) - Loading network topology layer schema file
2025-11-06 18:21:09,884 [main] INFO  upgrade.AbstractLayoutVersionManager (AbstractLayoutVersionManager.java:init(80)) - Initializing Layout version manager with metadata layout = WITNESSED_CONTAINER_DB_PROTO_VALUE (version = 9), software layout = WITNESSED_CONTAINER_DB_PROTO_VALUE (version = 9)
2025-11-06 18:21:09,886 [main] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:upgradeToSequenceId(353)) - upgrade localId to 115816896921600000
2025-11-06 18:21:09,886 [main] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:upgradeToSequenceId(363)) - upgrade delTxnId to 0
2025-11-06 18:21:09,887 [main] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:upgradeToSequenceId(379)) - upgrade containerId to 0
2025-11-06 18:21:09,887 [main] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:upgradeToCertificateSequenceId(414)) - upgrade CertificateId to 2
2025-11-06 18:21:09,887 [main] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:<init>(231)) - Init the HA SequenceIdGenerator.
2025-11-06 18:21:09,888 [main] INFO  algorithms.ContainerPlacementPolicyFactory (ContainerPlacementPolicyFactory.java:getPolicyInternal(83)) - Create container placement policy of type org.apache.hadoop.hdds.scm.container.placement.algorithms.SCMContainerPlacementRackAware
2025-11-06 18:21:09,888 [main] INFO  algorithms.ContainerPlacementPolicyFactory (ContainerPlacementPolicyFactory.java:getPolicyInternal(83)) - Create container placement policy of type org.apache.hadoop.hdds.scm.container.placement.algorithms.SCMContainerPlacementRackScatter
2025-11-06 18:21:09,888 [main] INFO  ExpiredContainerReplicaOpScrubber (BackgroundSCMService.java:start(64)) - Starting ExpiredContainerReplicaOpScrubber Service.
2025-11-06 18:21:09,889 [main] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service ExpiredContainerReplicaOpScrubber.
2025-11-06 18:21:09,889 [main] INFO  algorithms.PipelineChoosePolicyFactory (PipelineChoosePolicyFactory.java:createPipelineChoosePolicyFromClass(78)) - Create pipeline choose policy of type org.apache.hadoop.hdds.scm.pipeline.choose.algorithms.RandomPipelineChoosePolicy
2025-11-06 18:21:09,889 [main] INFO  algorithms.PipelineChoosePolicyFactory (PipelineChoosePolicyFactory.java:createPipelineChoosePolicyFromClass(78)) - Create pipeline choose policy of type org.apache.hadoop.hdds.scm.pipeline.choose.algorithms.RandomPipelineChoosePolicy
2025-11-06 18:21:09,891 [main] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service SCMBlockDeletingService.
2025-11-06 18:21:09,891 [main] INFO  replication.ReplicationManager (ReplicationManager.java:start(287)) - Starting Replication Monitor Thread.
2025-11-06 18:21:09,892 [main] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service ReplicationManager.
2025-11-06 18:21:09,892 [ReplicationMonitor] INFO  replication.ReplicationManager (ReplicationManager.java:processAll(359)) - Replication Manager is not ready to run until 300000ms after safemode exit
2025-11-06 18:21:09,893 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:<init>(432)) - SCM start with adminUsers: [runner]
2025-11-06 18:21:09,893 [main] INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(93)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 10000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false, ipcFailOver: false.
2025-11-06 18:21:09,893 [main] INFO  ipc.Server (Server.java:<init>(1438)) - Listener at 0.0.0.0:46207
2025-11-06 18:21:09,894 [Socket Reader #1 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #1 for port 0
2025-11-06 18:21:09,894 [Socket Reader #2 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #2 for port 0
2025-11-06 18:21:09,894 [Socket Reader #3 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #3 for port 0
2025-11-06 18:21:09,894 [Socket Reader #4 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #4 for port 0
2025-11-06 18:21:09,895 [Socket Reader #5 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #5 for port 0
2025-11-06 18:21:09,895 [Socket Reader #6 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #6 for port 0
2025-11-06 18:21:09,895 [Socket Reader #7 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #7 for port 0
2025-11-06 18:21:09,895 [Socket Reader #8 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #8 for port 0
2025-11-06 18:21:09,895 [Socket Reader #9 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #9 for port 0
2025-11-06 18:21:09,896 [Socket Reader #10 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #10 for port 0
2025-11-06 18:21:09,897 [main] INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(93)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 10000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false, ipcFailOver: false.
2025-11-06 18:21:09,897 [main] INFO  ipc.Server (Server.java:<init>(1438)) - Listener at 0.0.0.0:46377
2025-11-06 18:21:09,897 [Socket Reader #1 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #1 for port 0
2025-11-06 18:21:09,897 [Socket Reader #2 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #2 for port 0
2025-11-06 18:21:09,898 [Socket Reader #3 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #3 for port 0
2025-11-06 18:21:09,898 [Socket Reader #4 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #4 for port 0
2025-11-06 18:21:09,898 [Socket Reader #5 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #5 for port 0
2025-11-06 18:21:09,898 [Socket Reader #6 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #6 for port 0
2025-11-06 18:21:09,899 [Socket Reader #7 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #7 for port 0
2025-11-06 18:21:09,899 [Socket Reader #8 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #8 for port 0
2025-11-06 18:21:09,899 [Socket Reader #9 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #9 for port 0
2025-11-06 18:21:09,899 [Socket Reader #10 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #10 for port 0
2025-11-06 18:21:09,900 [main] INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(93)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 10000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false, ipcFailOver: false.
2025-11-06 18:21:09,900 [main] INFO  ipc.Server (Server.java:<init>(1438)) - Listener at 0.0.0.0:33965
2025-11-06 18:21:09,901 [Socket Reader #1 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #1 for port 0
2025-11-06 18:21:09,901 [Socket Reader #2 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #2 for port 0
2025-11-06 18:21:09,901 [Socket Reader #3 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #3 for port 0
2025-11-06 18:21:09,901 [Socket Reader #4 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #4 for port 0
2025-11-06 18:21:09,902 [Socket Reader #5 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #5 for port 0
2025-11-06 18:21:09,902 [Socket Reader #6 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #6 for port 0
2025-11-06 18:21:09,902 [Socket Reader #7 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #7 for port 0
2025-11-06 18:21:09,902 [Socket Reader #8 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #8 for port 0
2025-11-06 18:21:09,902 [Socket Reader #9 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #9 for port 0
2025-11-06 18:21:09,903 [Socket Reader #10 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #10 for port 0
2025-11-06 18:21:09,909 [main] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service ContainerBalancer.
2025-11-06 18:21:09,909 [main] INFO  ha.SCMContext (SCMContext.java:updateSafeModeStatus(224)) - Update SafeModeStatus from SafeModeStatus{safeModeStatus=false, preCheckPassed=true} to SafeModeStatus{safeModeStatus=false, preCheckPassed=true}.
2025-11-06 18:21:09,910 [main] INFO  ha.SCMContext (SCMContext.java:updateSafeModeStatus(224)) - Update SafeModeStatus from SafeModeStatus{safeModeStatus=false, preCheckPassed=true} to SafeModeStatus{safeModeStatus=false, preCheckPassed=true}.
2025-11-06 18:21:09,910 [main] INFO  ha.SCMContext (SCMContext.java:updateSafeModeStatus(224)) - Update SafeModeStatus from SafeModeStatus{safeModeStatus=false, preCheckPassed=true} to SafeModeStatus{safeModeStatus=true, preCheckPassed=true}.
2025-11-06 18:21:09,911 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1616)) - Container Balancer is not running.
2025-11-06 18:21:09,912 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stopReplicationManager(1749)) - Stopping Replication Manager Service.
2025-11-06 18:21:09,912 [main] INFO  replication.ReplicationManager (ReplicationManager.java:stop(318)) - Stopping Replication Monitor Thread.
2025-11-06 18:21:09,912 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1625)) - Stopping the Datanode Admin Monitor.
2025-11-06 18:21:09,912 [ReplicationMonitor] INFO  replication.ReplicationManager (ReplicationManager.java:run(938)) - Replication Monitor Thread is stopped
2025-11-06 18:21:09,912 [OverReplicatedProcessor] WARN  replication.UnhealthyReplicationProcessor (UnhealthyReplicationProcessor.java:run(178)) - OverReplicatedProcessor interrupted. Exiting...
2025-11-06 18:21:09,912 [UnderReplicatedProcessor] WARN  replication.UnhealthyReplicationProcessor (UnhealthyReplicationProcessor.java:run(178)) - UnderReplicatedProcessor interrupted. Exiting...
2025-11-06 18:21:09,912 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1632)) - Stopping datanode service RPC server
2025-11-06 18:21:09,913 [main] INFO  server.SCMDatanodeProtocolServer (SCMDatanodeProtocolServer.java:stop(455)) - Stopping the RPC server for DataNodes
2025-11-06 18:21:09,913 [main] INFO  ipc.Server (Server.java:stop(3697)) - Stopping server on 46207
2025-11-06 18:21:09,914 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1640)) - Stopping block service RPC server
2025-11-06 18:21:09,914 [main] INFO  server.SCMBlockProtocolServer (SCMBlockProtocolServer.java:stop(175)) - Stopping the RPC server for Block Protocol
2025-11-06 18:21:09,915 [main] INFO  ipc.Server (Server.java:stop(3697)) - Stopping server on 46377
2025-11-06 18:21:09,916 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1647)) - Stopping the StorageContainerLocationProtocol RPC server
2025-11-06 18:21:09,916 [main] INFO  server.SCMClientProtocolServer (SCMClientProtocolServer.java:stop(218)) - Stopping the RPC server for Client Protocol
2025-11-06 18:21:09,917 [main] INFO  ipc.Server (Server.java:stop(3697)) - Stopping server on 33965
2025-11-06 18:21:09,918 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1654)) - Stopping Storage Container Manager HTTP server.
2025-11-06 18:21:09,918 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1662)) - Stopping SCM LayoutVersionManager Service.
2025-11-06 18:21:09,918 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1674)) - Stopping Block Manager Service.
2025-11-06 18:21:09,918 [main] INFO  utils.BackgroundService (BackgroundService.java:shutdown(195)) - Shutting down service SCMBlockDeletingService
2025-11-06 18:21:09,919 [main] INFO  utils.BackgroundService (BackgroundService.java:shutdown(195)) - Shutting down service SCMBlockDeletingService
2025-11-06 18:21:09,919 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1699)) - Stopping SCM Event Queue.
2025-11-06 18:21:09,919 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1706)) - Stopping SCM HA services.
2025-11-06 18:21:09,920 [main] INFO  pipeline.BackgroundPipelineCreator (BackgroundPipelineCreator.java:stop(154)) - Stopping RatisPipelineUtilsThread.
2025-11-06 18:21:09,920 [RatisPipelineUtilsThread-0] WARN  pipeline.BackgroundPipelineCreator (BackgroundPipelineCreator.java:run(185)) - RatisPipelineUtilsThread is interrupted.
2025-11-06 18:21:09,921 [main] INFO  BackgroundPipelineScrubber (BackgroundSCMService.java:stop(127)) - Stopping BackgroundPipelineScrubber Service.
2025-11-06 18:21:09,922 [main] INFO  ExpiredContainerReplicaOpScrubber (BackgroundSCMService.java:stop(127)) - Stopping ExpiredContainerReplicaOpScrubber Service.
2025-11-06 18:21:09,922 [main] INFO  utils.BackgroundService (BackgroundService.java:shutdown(195)) - Shutting down service SCMBlockDeletingService
2025-11-06 18:21:09,922 [main] INFO  replication.ReplicationManager (ReplicationManager.java:stop(325)) - Replication Monitor Thread is not running.
2025-11-06 18:21:09,922 [main] WARN  balancer.ContainerBalancer (ContainerBalancer.java:stop(362)) - Cannot stop Container Balancer because it's not running or stopping
2025-11-06 18:21:09,921 [BackgroundPipelineScrubber] WARN  BackgroundPipelineScrubber (BackgroundSCMService.java:run(111)) - BackgroundPipelineScrubber is interrupted, exit
2025-11-06 18:21:09,922 [ExpiredContainerReplicaOpScrubber] WARN  ExpiredContainerReplicaOpScrubber (BackgroundSCMService.java:run(111)) - ExpiredContainerReplicaOpScrubber is interrupted, exit
2025-11-06 18:21:09,923 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1740)) - Stopping SCM MetadataStore.
2025-11-06 18:21:09,951 [main] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchemaFromFile(128)) - Loading schema from [jar:file:/home/runner/work/ozone/ozone/hadoop-hdds/common/target/hdds-common-2.2.0-SNAPSHOT.jar!/network-topology-default.xml]
2025-11-06 18:21:09,951 [main] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchema(175)) - Loading network topology layer schema file
2025-11-06 18:21:09,961 [main] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchemaFromFile(128)) - Loading schema from [jar:file:/home/runner/work/ozone/ozone/hadoop-hdds/common/target/hdds-common-2.2.0-SNAPSHOT.jar!/network-topology-default.xml]
2025-11-06 18:21:09,961 [main] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchema(175)) - Loading network topology layer schema file
2025-11-06 18:21:09,963 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(133)) - Added a new node: /default-rack/76f5f070-efe0-4834-9cb4-6d7bf1982a05
2025-11-06 18:21:09,963 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(133)) - Added a new node: /default-rack/ab33ef22-c70c-48f3-914f-6220121523aa
2025-11-06 18:21:09,963 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(133)) - Added a new node: /default-rack/c812acdf-7772-486f-b0b6-52cc8aa93aa1
2025-11-06 18:21:09,964 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(133)) - Added a new node: /default-rack/2fbeffb2-6590-4175-8921-e1d67f97db74
2025-11-06 18:21:09,964 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(133)) - Added a new node: /default-rack/9f1680ce-ad03-492e-ab39-5f66f282a18b
2025-11-06 18:21:09,964 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(133)) - Added a new node: /default-rack/a19d70f6-3da1-4336-84a2-7c13eb95f515
2025-11-06 18:21:09,964 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(133)) - Added a new node: /default-rack/47891504-ac45-4127-a348-6975b1cdb334
2025-11-06 18:21:09,964 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(133)) - Added a new node: /default-rack/9c92938b-7d87-4c12-9580-327723fe7162
2025-11-06 18:21:09,965 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(133)) - Added a new node: /default-rack/b959f46b-2b35-4015-8b59-cfd4e3da14c4
2025-11-06 18:21:09,965 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(133)) - Added a new node: /default-rack/f0f096ca-2150-4ed2-8134-a8cf8f2ba49e
2025-11-06 18:21:09,965 [main] WARN  utils.HAUtils (HAUtils.java:getMetaDir(311)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2025-11-06 18:21:09,966 [main] WARN  db.DBStoreBuilder (DBStoreBuilder.java:getDBDirPath(157)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2025-11-06 18:21:10,008 [main] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:<init>(231)) - Init the HA SequenceIdGenerator.
2025-11-06 18:21:10,009 [main] INFO  pipeline.PipelineStateManagerImpl (PipelineStateManagerImpl.java:initialize(75)) - No pipeline exists in current db
2025-11-06 18:21:10,009 [main] INFO  algorithms.LeaderChoosePolicyFactory (LeaderChoosePolicyFactory.java:getPolicy(55)) - Create leader choose policy of type org.apache.hadoop.hdds.scm.pipeline.leader.choose.algorithms.MinLeaderCountChoosePolicy
2025-11-06 18:21:10,009 [main] INFO  algorithms.ContainerPlacementPolicyFactory (ContainerPlacementPolicyFactory.java:getPolicyInternal(83)) - Create container placement policy of type org.apache.hadoop.hdds.scm.container.placement.algorithms.SCMContainerPlacementRackScatter
2025-11-06 18:21:10,010 [main] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service BackgroundPipelineCreator.
2025-11-06 18:21:10,010 [main] INFO  pipeline.BackgroundPipelineCreator (BackgroundPipelineCreator.java:start(126)) - Starting RatisPipelineUtilsThread.
2025-11-06 18:21:10,010 [main] INFO  BackgroundPipelineScrubber (BackgroundSCMService.java:start(64)) - Starting BackgroundPipelineScrubber Service.
2025-11-06 18:21:10,011 [main] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service BackgroundPipelineScrubber.
2025-11-06 18:21:10,011 [main] INFO  algorithms.LeaderChoosePolicyFactory (LeaderChoosePolicyFactory.java:getPolicy(55)) - Create leader choose policy of type org.apache.hadoop.hdds.scm.pipeline.leader.choose.algorithms.MinLeaderCountChoosePolicy
2025-11-06 18:21:10,012 [main] INFO  safemode.SCMSafeModeManager (AbstractContainerSafeModeRule.java:initializeRule(83)) - Refreshed RATIS Containers threshold count to 0.
2025-11-06 18:21:10,012 [main] INFO  safemode.SCMSafeModeManager (AbstractContainerSafeModeRule.java:initializeRule(83)) - Refreshed EC Containers threshold count to 0.
2025-11-06 18:21:10,012 [main] INFO  safemode.HealthyPipelineSafeModeRule (HealthyPipelineSafeModeRule.java:initializeRule(230)) - Total pipeline count is 0, healthy pipeline threshold count is 1
2025-11-06 18:21:10,013 [main] INFO  safemode.OneReplicaPipelineSafeModeRule (OneReplicaPipelineSafeModeRule.java:initializeRule(189)) - Total pipeline count is 0, pipeline's with at least one datanode reported threshold count is 0
2025-11-06 18:21:10,013 [main] INFO  safemode.SCMSafeModeManager (SCMSafeModeManager.java:<init>(102)) - Safemode is disabled, skipping Safemode rule validation and force exiting Safemode.
2025-11-06 18:21:10,013 [main] INFO  ha.SCMContext (SCMContext.java:updateSafeModeStatus(224)) - Update SafeModeStatus from SafeModeStatus{safeModeStatus=false, preCheckPassed=true} to SafeModeStatus{safeModeStatus=false, preCheckPassed=true}.
2025-11-06 18:21:10,013 [main] INFO  pipeline.BackgroundPipelineCreator (BackgroundPipelineCreator.java:notifyStatusChanged(268)) - Service BackgroundPipelineCreator transitions to RUNNING.
2025-11-06 18:21:10,013 [main] INFO  BackgroundPipelineScrubber (BackgroundSCMService.java:notifyStatusChanged(78)) - Service BackgroundPipelineScrubber transitions to RUNNING.
2025-11-06 18:21:10,013 [main] WARN  server.ServerUtils (ServerUtils.java:getScmDbDir(138)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2025-11-06 18:21:10,015 [main] WARN  server.ServerUtils (ServerUtils.java:getScmDbDir(138)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2025-11-06 18:21:10,016 [main] INFO  ha.SCMHANodeDetails (SCMHANodeDetails.java:loadSCMHAConfig(162)) - ServiceID for StorageContainerManager is null
2025-11-06 18:21:10,016 [main] INFO  ha.SCMHANodeDetails (SCMHANodeDetails.java:loadSCMHAConfig(166)) - ozone.scm.default.service.id is not defined, falling back to ozone.scm.service.ids to find serviceID for StorageContainerManager if it is HA enabled cluster
2025-11-06 18:21:10,017 [main] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchemaFromFile(128)) - Loading schema from [jar:file:/home/runner/work/ozone/ozone/hadoop-hdds/common/target/hdds-common-2.2.0-SNAPSHOT.jar!/network-topology-default.xml]
2025-11-06 18:21:10,017 [main] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchema(175)) - Loading network topology layer schema file
2025-11-06 18:21:10,019 [main] INFO  upgrade.AbstractLayoutVersionManager (AbstractLayoutVersionManager.java:init(80)) - Initializing Layout version manager with metadata layout = WITNESSED_CONTAINER_DB_PROTO_VALUE (version = 9), software layout = WITNESSED_CONTAINER_DB_PROTO_VALUE (version = 9)
2025-11-06 18:21:10,020 [main] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:upgradeToSequenceId(353)) - upgrade localId to 115816896921600000
2025-11-06 18:21:10,020 [main] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:upgradeToSequenceId(363)) - upgrade delTxnId to 0
2025-11-06 18:21:10,021 [main] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:upgradeToSequenceId(379)) - upgrade containerId to 0
2025-11-06 18:21:10,021 [main] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:upgradeToCertificateSequenceId(414)) - upgrade CertificateId to 2
2025-11-06 18:21:10,021 [main] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:<init>(231)) - Init the HA SequenceIdGenerator.
2025-11-06 18:21:10,021 [main] INFO  algorithms.ContainerPlacementPolicyFactory (ContainerPlacementPolicyFactory.java:getPolicyInternal(83)) - Create container placement policy of type org.apache.hadoop.hdds.scm.container.placement.algorithms.SCMContainerPlacementRackAware
2025-11-06 18:21:10,022 [main] INFO  algorithms.ContainerPlacementPolicyFactory (ContainerPlacementPolicyFactory.java:getPolicyInternal(83)) - Create container placement policy of type org.apache.hadoop.hdds.scm.container.placement.algorithms.SCMContainerPlacementRackScatter
2025-11-06 18:21:10,022 [main] INFO  ExpiredContainerReplicaOpScrubber (BackgroundSCMService.java:start(64)) - Starting ExpiredContainerReplicaOpScrubber Service.
2025-11-06 18:21:10,023 [main] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service ExpiredContainerReplicaOpScrubber.
2025-11-06 18:21:10,023 [main] INFO  algorithms.PipelineChoosePolicyFactory (PipelineChoosePolicyFactory.java:createPipelineChoosePolicyFromClass(78)) - Create pipeline choose policy of type org.apache.hadoop.hdds.scm.pipeline.choose.algorithms.RandomPipelineChoosePolicy
2025-11-06 18:21:10,023 [main] INFO  algorithms.PipelineChoosePolicyFactory (PipelineChoosePolicyFactory.java:createPipelineChoosePolicyFromClass(78)) - Create pipeline choose policy of type org.apache.hadoop.hdds.scm.pipeline.choose.algorithms.RandomPipelineChoosePolicy
2025-11-06 18:21:10,024 [main] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service SCMBlockDeletingService.
2025-11-06 18:21:10,025 [main] INFO  replication.ReplicationManager (ReplicationManager.java:start(287)) - Starting Replication Monitor Thread.
2025-11-06 18:21:10,025 [main] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service ReplicationManager.
2025-11-06 18:21:10,026 [ReplicationMonitor] INFO  replication.ReplicationManager (ReplicationManager.java:processAll(359)) - Replication Manager is not ready to run until 300000ms after safemode exit
2025-11-06 18:21:10,026 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:<init>(432)) - SCM start with adminUsers: [runner]
2025-11-06 18:21:10,026 [main] INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(93)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 10000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false, ipcFailOver: false.
2025-11-06 18:21:10,027 [main] INFO  ipc.Server (Server.java:<init>(1438)) - Listener at 0.0.0.0:42459
2025-11-06 18:21:10,027 [Socket Reader #1 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #1 for port 0
2025-11-06 18:21:10,027 [Socket Reader #2 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #2 for port 0
2025-11-06 18:21:10,027 [Socket Reader #3 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #3 for port 0
2025-11-06 18:21:10,028 [Socket Reader #4 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #4 for port 0
2025-11-06 18:21:10,028 [Socket Reader #5 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #5 for port 0
2025-11-06 18:21:10,028 [Socket Reader #6 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #6 for port 0
2025-11-06 18:21:10,028 [Socket Reader #7 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #7 for port 0
2025-11-06 18:21:10,028 [Socket Reader #8 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #8 for port 0
2025-11-06 18:21:10,028 [Socket Reader #9 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #9 for port 0
2025-11-06 18:21:10,028 [Socket Reader #10 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #10 for port 0
2025-11-06 18:21:10,029 [main] INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(93)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 10000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false, ipcFailOver: false.
2025-11-06 18:21:10,030 [main] INFO  ipc.Server (Server.java:<init>(1438)) - Listener at 0.0.0.0:38715
2025-11-06 18:21:10,030 [Socket Reader #1 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #1 for port 0
2025-11-06 18:21:10,030 [Socket Reader #2 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #2 for port 0
2025-11-06 18:21:10,030 [Socket Reader #3 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #3 for port 0
2025-11-06 18:21:10,030 [Socket Reader #4 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #4 for port 0
2025-11-06 18:21:10,030 [Socket Reader #5 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #5 for port 0
2025-11-06 18:21:10,031 [Socket Reader #6 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #6 for port 0
2025-11-06 18:21:10,031 [Socket Reader #7 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #7 for port 0
2025-11-06 18:21:10,031 [Socket Reader #8 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #8 for port 0
2025-11-06 18:21:10,031 [Socket Reader #9 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #9 for port 0
2025-11-06 18:21:10,031 [Socket Reader #10 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #10 for port 0
2025-11-06 18:21:10,032 [main] INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(93)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 10000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false, ipcFailOver: false.
2025-11-06 18:21:10,033 [main] INFO  ipc.Server (Server.java:<init>(1438)) - Listener at 0.0.0.0:46799
2025-11-06 18:21:10,033 [Socket Reader #1 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #1 for port 0
2025-11-06 18:21:10,034 [Socket Reader #2 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #2 for port 0
2025-11-06 18:21:10,034 [Socket Reader #3 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #3 for port 0
2025-11-06 18:21:10,034 [Socket Reader #4 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #4 for port 0
2025-11-06 18:21:10,034 [Socket Reader #5 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #5 for port 0
2025-11-06 18:21:10,034 [Socket Reader #6 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #6 for port 0
2025-11-06 18:21:10,035 [Socket Reader #7 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #7 for port 0
2025-11-06 18:21:10,035 [Socket Reader #8 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #8 for port 0
2025-11-06 18:21:10,035 [Socket Reader #9 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #9 for port 0
2025-11-06 18:21:10,035 [Socket Reader #10 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #10 for port 0
2025-11-06 18:21:10,041 [main] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service ContainerBalancer.
2025-11-06 18:21:10,041 [main] INFO  ha.SCMContext (SCMContext.java:updateSafeModeStatus(224)) - Update SafeModeStatus from SafeModeStatus{safeModeStatus=false, preCheckPassed=true} to SafeModeStatus{safeModeStatus=false, preCheckPassed=true}.
2025-11-06 18:21:10,042 [main] INFO  ha.SCMContext (SCMContext.java:updateSafeModeStatus(224)) - Update SafeModeStatus from SafeModeStatus{safeModeStatus=false, preCheckPassed=true} to SafeModeStatus{safeModeStatus=false, preCheckPassed=true}.
2025-11-06 18:21:10,044 [main] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(208)) - Sending CreatePipelineCommand for pipeline:Pipeline-cc3c1891-6b8d-4012-baa9-c001db1ca7cc to datanode:a19d70f6-3da1-4336-84a2-7c13eb95f515(localhost-112.51.90.107/112.51.90.107)
2025-11-06 18:21:10,044 [main] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(208)) - Sending CreatePipelineCommand for pipeline:Pipeline-cc3c1891-6b8d-4012-baa9-c001db1ca7cc to datanode:47891504-ac45-4127-a348-6975b1cdb334(localhost-148.144.58.143/148.144.58.143)
2025-11-06 18:21:10,044 [main] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(208)) - Sending CreatePipelineCommand for pipeline:Pipeline-cc3c1891-6b8d-4012-baa9-c001db1ca7cc to datanode:76f5f070-efe0-4834-9cb4-6d7bf1982a05(localhost-222.105.145.4/222.105.145.4)
2025-11-06 18:21:10,048 [main] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:getNextId(135)) - Allocate a batch for containerId, change lastId from 0 to 1000.
2025-11-06 18:21:10,049 [main] WARN  ha.SequenceIdGenerator (SequenceIdGenerator.java:allocateBatch(248)) - Failed to allocate a batch for localId, expected lastId is 0, actual lastId is 115816896921600000.
2025-11-06 18:21:10,050 [main] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:getNextId(135)) - Allocate a batch for localId, change lastId from 115816896921600000 to 115816896921601000.
2025-11-06 18:21:10,050 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1616)) - Container Balancer is not running.
2025-11-06 18:21:10,050 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stopReplicationManager(1749)) - Stopping Replication Manager Service.
2025-11-06 18:21:10,050 [main] INFO  replication.ReplicationManager (ReplicationManager.java:stop(318)) - Stopping Replication Monitor Thread.
2025-11-06 18:21:10,050 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1625)) - Stopping the Datanode Admin Monitor.
2025-11-06 18:21:10,051 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1632)) - Stopping datanode service RPC server
2025-11-06 18:21:10,051 [main] INFO  server.SCMDatanodeProtocolServer (SCMDatanodeProtocolServer.java:stop(455)) - Stopping the RPC server for DataNodes
2025-11-06 18:21:10,051 [main] INFO  ipc.Server (Server.java:stop(3697)) - Stopping server on 42459
2025-11-06 18:21:10,051 [UnderReplicatedProcessor] WARN  replication.UnhealthyReplicationProcessor (UnhealthyReplicationProcessor.java:run(178)) - UnderReplicatedProcessor interrupted. Exiting...
2025-11-06 18:21:10,051 [ReplicationMonitor] INFO  replication.ReplicationManager (ReplicationManager.java:run(938)) - Replication Monitor Thread is stopped
2025-11-06 18:21:10,051 [OverReplicatedProcessor] WARN  replication.UnhealthyReplicationProcessor (UnhealthyReplicationProcessor.java:run(178)) - OverReplicatedProcessor interrupted. Exiting...
2025-11-06 18:21:10,053 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1640)) - Stopping block service RPC server
2025-11-06 18:21:10,053 [main] INFO  server.SCMBlockProtocolServer (SCMBlockProtocolServer.java:stop(175)) - Stopping the RPC server for Block Protocol
2025-11-06 18:21:10,053 [main] INFO  ipc.Server (Server.java:stop(3697)) - Stopping server on 38715
2025-11-06 18:21:10,055 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1647)) - Stopping the StorageContainerLocationProtocol RPC server
2025-11-06 18:21:10,055 [main] INFO  server.SCMClientProtocolServer (SCMClientProtocolServer.java:stop(218)) - Stopping the RPC server for Client Protocol
2025-11-06 18:21:10,056 [main] INFO  ipc.Server (Server.java:stop(3697)) - Stopping server on 46799
2025-11-06 18:21:10,057 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1654)) - Stopping Storage Container Manager HTTP server.
2025-11-06 18:21:10,057 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1662)) - Stopping SCM LayoutVersionManager Service.
2025-11-06 18:21:10,058 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1674)) - Stopping Block Manager Service.
2025-11-06 18:21:10,058 [main] INFO  utils.BackgroundService (BackgroundService.java:shutdown(195)) - Shutting down service SCMBlockDeletingService
2025-11-06 18:21:10,058 [main] INFO  utils.BackgroundService (BackgroundService.java:shutdown(195)) - Shutting down service SCMBlockDeletingService
2025-11-06 18:21:10,058 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1699)) - Stopping SCM Event Queue.
2025-11-06 18:21:10,059 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1706)) - Stopping SCM HA services.
2025-11-06 18:21:10,059 [main] INFO  pipeline.BackgroundPipelineCreator (BackgroundPipelineCreator.java:stop(154)) - Stopping RatisPipelineUtilsThread.
2025-11-06 18:21:10,059 [RatisPipelineUtilsThread-0] WARN  pipeline.BackgroundPipelineCreator (BackgroundPipelineCreator.java:run(185)) - RatisPipelineUtilsThread is interrupted.
2025-11-06 18:21:10,059 [main] INFO  BackgroundPipelineScrubber (BackgroundSCMService.java:stop(127)) - Stopping BackgroundPipelineScrubber Service.
2025-11-06 18:21:10,060 [main] INFO  ExpiredContainerReplicaOpScrubber (BackgroundSCMService.java:stop(127)) - Stopping ExpiredContainerReplicaOpScrubber Service.
2025-11-06 18:21:10,061 [main] INFO  utils.BackgroundService (BackgroundService.java:shutdown(195)) - Shutting down service SCMBlockDeletingService
2025-11-06 18:21:10,061 [main] INFO  replication.ReplicationManager (ReplicationManager.java:stop(325)) - Replication Monitor Thread is not running.
2025-11-06 18:21:10,060 [ExpiredContainerReplicaOpScrubber] WARN  ExpiredContainerReplicaOpScrubber (BackgroundSCMService.java:run(111)) - ExpiredContainerReplicaOpScrubber is interrupted, exit
2025-11-06 18:21:10,060 [BackgroundPipelineScrubber] WARN  BackgroundPipelineScrubber (BackgroundSCMService.java:run(111)) - BackgroundPipelineScrubber is interrupted, exit
2025-11-06 18:21:10,061 [main] WARN  balancer.ContainerBalancer (ContainerBalancer.java:stop(362)) - Cannot stop Container Balancer because it's not running or stopping
2025-11-06 18:21:10,061 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1740)) - Stopping SCM MetadataStore.
2025-11-06 18:21:10,061 [test-leaseManagerLeaseManager#LeaseMonitor] WARN  lease.LeaseManager (LeaseManager.java:run(285)) - Lease manager is interrupted. Shutting down...
java.lang.InterruptedException
	at java.base/java.util.concurrent.locks.AbstractQueuedSynchronizer.tryAcquireSharedNanos(AbstractQueuedSynchronizer.java:1167)
	at java.base/java.util.concurrent.Semaphore.tryAcquire(Semaphore.java:415)
	at org.apache.hadoop.ozone.lease.LeaseManager$LeaseMonitor.run(LeaseManager.java:283)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-11-06 18:21:10,090 [main] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchemaFromFile(128)) - Loading schema from [jar:file:/home/runner/work/ozone/ozone/hadoop-hdds/common/target/hdds-common-2.2.0-SNAPSHOT.jar!/network-topology-default.xml]
2025-11-06 18:21:10,090 [main] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchema(175)) - Loading network topology layer schema file
2025-11-06 18:21:10,103 [main] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchemaFromFile(128)) - Loading schema from [jar:file:/home/runner/work/ozone/ozone/hadoop-hdds/common/target/hdds-common-2.2.0-SNAPSHOT.jar!/network-topology-default.xml]
2025-11-06 18:21:10,103 [main] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchema(175)) - Loading network topology layer schema file
2025-11-06 18:21:10,105 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(133)) - Added a new node: /default-rack/74077b86-d1ca-4cac-8c21-89a195e8a791
2025-11-06 18:21:10,105 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(133)) - Added a new node: /default-rack/cde16d54-a83d-49fa-8871-71f8e6b1c71b
2025-11-06 18:21:10,105 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(133)) - Added a new node: /default-rack/6710b287-1f7c-4c68-bc50-7df6640e9ffe
2025-11-06 18:21:10,106 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(133)) - Added a new node: /default-rack/60c2f567-b007-4df7-a41f-43e47fd1c47a
2025-11-06 18:21:10,106 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(133)) - Added a new node: /default-rack/2940a19e-a7ed-47f4-a173-67966ce004fc
2025-11-06 18:21:10,106 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(133)) - Added a new node: /default-rack/76bf0321-ce3e-4b20-afc7-fb2ee684537c
2025-11-06 18:21:10,108 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(133)) - Added a new node: /default-rack/5f5e398b-aa17-46c6-b484-3ae18ea963f3
2025-11-06 18:21:10,109 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(133)) - Added a new node: /default-rack/b079a8ac-0880-4f6a-8e7e-029b9501b278
2025-11-06 18:21:10,109 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(133)) - Added a new node: /default-rack/18419a9a-7776-4941-94df-574975e946e1
2025-11-06 18:21:10,109 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(133)) - Added a new node: /default-rack/f9c9fc6a-4671-4422-822d-d57df4584e4a
2025-11-06 18:21:10,109 [main] WARN  utils.HAUtils (HAUtils.java:getMetaDir(311)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2025-11-06 18:21:10,110 [main] WARN  db.DBStoreBuilder (DBStoreBuilder.java:getDBDirPath(157)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2025-11-06 18:21:10,161 [main] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:<init>(231)) - Init the HA SequenceIdGenerator.
2025-11-06 18:21:10,161 [main] INFO  pipeline.PipelineStateManagerImpl (PipelineStateManagerImpl.java:initialize(75)) - No pipeline exists in current db
2025-11-06 18:21:10,161 [main] INFO  algorithms.LeaderChoosePolicyFactory (LeaderChoosePolicyFactory.java:getPolicy(55)) - Create leader choose policy of type org.apache.hadoop.hdds.scm.pipeline.leader.choose.algorithms.MinLeaderCountChoosePolicy
2025-11-06 18:21:10,162 [main] INFO  algorithms.ContainerPlacementPolicyFactory (ContainerPlacementPolicyFactory.java:getPolicyInternal(83)) - Create container placement policy of type org.apache.hadoop.hdds.scm.container.placement.algorithms.SCMContainerPlacementRackScatter
2025-11-06 18:21:10,162 [main] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service BackgroundPipelineCreator.
2025-11-06 18:21:10,162 [main] INFO  pipeline.BackgroundPipelineCreator (BackgroundPipelineCreator.java:start(126)) - Starting RatisPipelineUtilsThread.
2025-11-06 18:21:10,163 [main] INFO  BackgroundPipelineScrubber (BackgroundSCMService.java:start(64)) - Starting BackgroundPipelineScrubber Service.
2025-11-06 18:21:10,163 [main] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service BackgroundPipelineScrubber.
2025-11-06 18:21:10,163 [main] INFO  algorithms.LeaderChoosePolicyFactory (LeaderChoosePolicyFactory.java:getPolicy(55)) - Create leader choose policy of type org.apache.hadoop.hdds.scm.pipeline.leader.choose.algorithms.MinLeaderCountChoosePolicy
2025-11-06 18:21:10,164 [main] INFO  safemode.SCMSafeModeManager (AbstractContainerSafeModeRule.java:initializeRule(83)) - Refreshed RATIS Containers threshold count to 0.
2025-11-06 18:21:10,165 [main] INFO  safemode.SCMSafeModeManager (AbstractContainerSafeModeRule.java:initializeRule(83)) - Refreshed EC Containers threshold count to 0.
2025-11-06 18:21:10,165 [main] INFO  safemode.HealthyPipelineSafeModeRule (HealthyPipelineSafeModeRule.java:initializeRule(230)) - Total pipeline count is 0, healthy pipeline threshold count is 1
2025-11-06 18:21:10,165 [main] INFO  safemode.OneReplicaPipelineSafeModeRule (OneReplicaPipelineSafeModeRule.java:initializeRule(189)) - Total pipeline count is 0, pipeline's with at least one datanode reported threshold count is 0
2025-11-06 18:21:10,166 [main] INFO  safemode.SCMSafeModeManager (SCMSafeModeManager.java:<init>(102)) - Safemode is disabled, skipping Safemode rule validation and force exiting Safemode.
2025-11-06 18:21:10,166 [main] INFO  ha.SCMContext (SCMContext.java:updateSafeModeStatus(224)) - Update SafeModeStatus from SafeModeStatus{safeModeStatus=false, preCheckPassed=true} to SafeModeStatus{safeModeStatus=false, preCheckPassed=true}.
2025-11-06 18:21:10,166 [main] INFO  pipeline.BackgroundPipelineCreator (BackgroundPipelineCreator.java:notifyStatusChanged(268)) - Service BackgroundPipelineCreator transitions to RUNNING.
2025-11-06 18:21:10,166 [main] INFO  BackgroundPipelineScrubber (BackgroundSCMService.java:notifyStatusChanged(78)) - Service BackgroundPipelineScrubber transitions to RUNNING.
2025-11-06 18:21:10,166 [main] WARN  server.ServerUtils (ServerUtils.java:getScmDbDir(138)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2025-11-06 18:21:10,168 [main] WARN  server.ServerUtils (ServerUtils.java:getScmDbDir(138)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2025-11-06 18:21:10,168 [main] INFO  ha.SCMHANodeDetails (SCMHANodeDetails.java:loadSCMHAConfig(162)) - ServiceID for StorageContainerManager is null
2025-11-06 18:21:10,168 [main] INFO  ha.SCMHANodeDetails (SCMHANodeDetails.java:loadSCMHAConfig(166)) - ozone.scm.default.service.id is not defined, falling back to ozone.scm.service.ids to find serviceID for StorageContainerManager if it is HA enabled cluster
2025-11-06 18:21:10,170 [main] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchemaFromFile(128)) - Loading schema from [jar:file:/home/runner/work/ozone/ozone/hadoop-hdds/common/target/hdds-common-2.2.0-SNAPSHOT.jar!/network-topology-default.xml]
2025-11-06 18:21:10,170 [main] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchema(175)) - Loading network topology layer schema file
2025-11-06 18:21:10,171 [main] INFO  upgrade.AbstractLayoutVersionManager (AbstractLayoutVersionManager.java:init(80)) - Initializing Layout version manager with metadata layout = WITNESSED_CONTAINER_DB_PROTO_VALUE (version = 9), software layout = WITNESSED_CONTAINER_DB_PROTO_VALUE (version = 9)
2025-11-06 18:21:10,173 [main] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:upgradeToSequenceId(353)) - upgrade localId to 115816896921600000
2025-11-06 18:21:10,173 [main] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:upgradeToSequenceId(363)) - upgrade delTxnId to 0
2025-11-06 18:21:10,174 [main] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:upgradeToSequenceId(379)) - upgrade containerId to 0
2025-11-06 18:21:10,174 [main] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:upgradeToCertificateSequenceId(414)) - upgrade CertificateId to 2
2025-11-06 18:21:10,174 [main] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:<init>(231)) - Init the HA SequenceIdGenerator.
2025-11-06 18:21:10,175 [main] INFO  algorithms.ContainerPlacementPolicyFactory (ContainerPlacementPolicyFactory.java:getPolicyInternal(83)) - Create container placement policy of type org.apache.hadoop.hdds.scm.container.placement.algorithms.SCMContainerPlacementRackAware
2025-11-06 18:21:10,175 [main] INFO  algorithms.ContainerPlacementPolicyFactory (ContainerPlacementPolicyFactory.java:getPolicyInternal(83)) - Create container placement policy of type org.apache.hadoop.hdds.scm.container.placement.algorithms.SCMContainerPlacementRackScatter
2025-11-06 18:21:10,175 [main] INFO  ExpiredContainerReplicaOpScrubber (BackgroundSCMService.java:start(64)) - Starting ExpiredContainerReplicaOpScrubber Service.
2025-11-06 18:21:10,176 [main] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service ExpiredContainerReplicaOpScrubber.
2025-11-06 18:21:10,177 [main] INFO  algorithms.PipelineChoosePolicyFactory (PipelineChoosePolicyFactory.java:createPipelineChoosePolicyFromClass(78)) - Create pipeline choose policy of type org.apache.hadoop.hdds.scm.pipeline.choose.algorithms.RandomPipelineChoosePolicy
2025-11-06 18:21:10,177 [main] INFO  algorithms.PipelineChoosePolicyFactory (PipelineChoosePolicyFactory.java:createPipelineChoosePolicyFromClass(78)) - Create pipeline choose policy of type org.apache.hadoop.hdds.scm.pipeline.choose.algorithms.RandomPipelineChoosePolicy
2025-11-06 18:21:10,178 [main] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service SCMBlockDeletingService.
2025-11-06 18:21:10,179 [main] INFO  replication.ReplicationManager (ReplicationManager.java:start(287)) - Starting Replication Monitor Thread.
2025-11-06 18:21:10,179 [main] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service ReplicationManager.
2025-11-06 18:21:10,180 [ReplicationMonitor] INFO  replication.ReplicationManager (ReplicationManager.java:processAll(359)) - Replication Manager is not ready to run until 300000ms after safemode exit
2025-11-06 18:21:10,180 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:<init>(432)) - SCM start with adminUsers: [runner]
2025-11-06 18:21:10,181 [main] INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(93)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 10000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false, ipcFailOver: false.
2025-11-06 18:21:10,181 [main] INFO  ipc.Server (Server.java:<init>(1438)) - Listener at 0.0.0.0:32771
2025-11-06 18:21:10,182 [Socket Reader #1 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #1 for port 0
2025-11-06 18:21:10,182 [Socket Reader #2 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #2 for port 0
2025-11-06 18:21:10,182 [Socket Reader #3 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #3 for port 0
2025-11-06 18:21:10,183 [Socket Reader #4 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #4 for port 0
2025-11-06 18:21:10,183 [Socket Reader #5 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #5 for port 0
2025-11-06 18:21:10,184 [Socket Reader #6 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #6 for port 0
2025-11-06 18:21:10,184 [Socket Reader #7 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #7 for port 0
2025-11-06 18:21:10,184 [Socket Reader #9 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #9 for port 0
2025-11-06 18:21:10,184 [Socket Reader #8 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #8 for port 0
2025-11-06 18:21:10,185 [Socket Reader #10 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #10 for port 0
2025-11-06 18:21:10,186 [main] INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(93)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 10000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false, ipcFailOver: false.
2025-11-06 18:21:10,186 [main] INFO  ipc.Server (Server.java:<init>(1438)) - Listener at 0.0.0.0:46871
2025-11-06 18:21:10,186 [Socket Reader #1 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #1 for port 0
2025-11-06 18:21:10,187 [Socket Reader #3 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #3 for port 0
2025-11-06 18:21:10,186 [Socket Reader #2 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #2 for port 0
2025-11-06 18:21:10,187 [Socket Reader #4 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #4 for port 0
2025-11-06 18:21:10,187 [Socket Reader #5 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #5 for port 0
2025-11-06 18:21:10,187 [Socket Reader #6 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #6 for port 0
2025-11-06 18:21:10,188 [Socket Reader #7 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #7 for port 0
2025-11-06 18:21:10,188 [Socket Reader #8 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #8 for port 0
2025-11-06 18:21:10,188 [Socket Reader #9 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #9 for port 0
2025-11-06 18:21:10,188 [Socket Reader #10 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #10 for port 0
2025-11-06 18:21:10,189 [main] INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(93)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 10000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false, ipcFailOver: false.
2025-11-06 18:21:10,190 [main] INFO  ipc.Server (Server.java:<init>(1438)) - Listener at 0.0.0.0:33643
2025-11-06 18:21:10,190 [Socket Reader #1 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #1 for port 0
2025-11-06 18:21:10,190 [Socket Reader #2 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #2 for port 0
2025-11-06 18:21:10,190 [Socket Reader #3 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #3 for port 0
2025-11-06 18:21:10,191 [Socket Reader #4 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #4 for port 0
2025-11-06 18:21:10,191 [Socket Reader #5 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #5 for port 0
2025-11-06 18:21:10,191 [Socket Reader #6 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #6 for port 0
2025-11-06 18:21:10,191 [Socket Reader #7 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #7 for port 0
2025-11-06 18:21:10,191 [Socket Reader #8 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #8 for port 0
2025-11-06 18:21:10,192 [Socket Reader #9 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #9 for port 0
2025-11-06 18:21:10,192 [Socket Reader #10 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #10 for port 0
2025-11-06 18:21:10,196 [main] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service ContainerBalancer.
2025-11-06 18:21:10,197 [main] INFO  ha.SCMContext (SCMContext.java:updateSafeModeStatus(224)) - Update SafeModeStatus from SafeModeStatus{safeModeStatus=false, preCheckPassed=true} to SafeModeStatus{safeModeStatus=false, preCheckPassed=true}.
2025-11-06 18:21:10,197 [main] INFO  ha.SCMContext (SCMContext.java:updateSafeModeStatus(224)) - Update SafeModeStatus from SafeModeStatus{safeModeStatus=false, preCheckPassed=true} to SafeModeStatus{safeModeStatus=false, preCheckPassed=true}.
2025-11-06 18:21:10,199 [main] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(208)) - Sending CreatePipelineCommand for pipeline:Pipeline-0e8cc617-006c-4244-9a2b-a8a3fa5a7d33 to datanode:cde16d54-a83d-49fa-8871-71f8e6b1c71b(localhost-69.55.20.159/69.55.20.159)
2025-11-06 18:21:10,199 [main] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(208)) - Sending CreatePipelineCommand for pipeline:Pipeline-0e8cc617-006c-4244-9a2b-a8a3fa5a7d33 to datanode:b079a8ac-0880-4f6a-8e7e-029b9501b278(localhost-144.63.233.140/144.63.233.140)
2025-11-06 18:21:10,200 [main] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(208)) - Sending CreatePipelineCommand for pipeline:Pipeline-0e8cc617-006c-4244-9a2b-a8a3fa5a7d33 to datanode:5f5e398b-aa17-46c6-b484-3ae18ea963f3(localhost-201.40.212.195/201.40.212.195)
2025-11-06 18:21:10,203 [pool-302-thread-1] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:getNextId(135)) - Allocate a batch for containerId, change lastId from 0 to 1000.
2025-11-06 18:21:10,204 [pool-302-thread-1] WARN  ha.SequenceIdGenerator (SequenceIdGenerator.java:allocateBatch(248)) - Failed to allocate a batch for localId, expected lastId is 0, actual lastId is 115816896921600000.
2025-11-06 18:21:10,204 [pool-302-thread-1] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:getNextId(135)) - Allocate a batch for localId, change lastId from 115816896921600000 to 115816896921601000.
2025-11-06 18:21:10,212 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1616)) - Container Balancer is not running.
2025-11-06 18:21:10,212 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stopReplicationManager(1749)) - Stopping Replication Manager Service.
2025-11-06 18:21:10,212 [main] INFO  replication.ReplicationManager (ReplicationManager.java:stop(318)) - Stopping Replication Monitor Thread.
2025-11-06 18:21:10,212 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1625)) - Stopping the Datanode Admin Monitor.
2025-11-06 18:21:10,213 [UnderReplicatedProcessor] WARN  replication.UnhealthyReplicationProcessor (UnhealthyReplicationProcessor.java:run(178)) - UnderReplicatedProcessor interrupted. Exiting...
2025-11-06 18:21:10,213 [ReplicationMonitor] INFO  replication.ReplicationManager (ReplicationManager.java:run(938)) - Replication Monitor Thread is stopped
2025-11-06 18:21:10,213 [OverReplicatedProcessor] WARN  replication.UnhealthyReplicationProcessor (UnhealthyReplicationProcessor.java:run(178)) - OverReplicatedProcessor interrupted. Exiting...
2025-11-06 18:21:10,213 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1632)) - Stopping datanode service RPC server
2025-11-06 18:21:10,213 [main] INFO  server.SCMDatanodeProtocolServer (SCMDatanodeProtocolServer.java:stop(455)) - Stopping the RPC server for DataNodes
2025-11-06 18:21:10,214 [main] INFO  ipc.Server (Server.java:stop(3697)) - Stopping server on 32771
2025-11-06 18:21:10,216 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1640)) - Stopping block service RPC server
2025-11-06 18:21:10,216 [main] INFO  server.SCMBlockProtocolServer (SCMBlockProtocolServer.java:stop(175)) - Stopping the RPC server for Block Protocol
2025-11-06 18:21:10,216 [main] INFO  ipc.Server (Server.java:stop(3697)) - Stopping server on 46871
2025-11-06 18:21:10,218 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1647)) - Stopping the StorageContainerLocationProtocol RPC server
2025-11-06 18:21:10,218 [main] INFO  server.SCMClientProtocolServer (SCMClientProtocolServer.java:stop(218)) - Stopping the RPC server for Client Protocol
2025-11-06 18:21:10,218 [main] INFO  ipc.Server (Server.java:stop(3697)) - Stopping server on 33643
2025-11-06 18:21:10,220 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1654)) - Stopping Storage Container Manager HTTP server.
2025-11-06 18:21:10,220 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1662)) - Stopping SCM LayoutVersionManager Service.
2025-11-06 18:21:10,220 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1674)) - Stopping Block Manager Service.
2025-11-06 18:21:10,220 [main] INFO  utils.BackgroundService (BackgroundService.java:shutdown(195)) - Shutting down service SCMBlockDeletingService
2025-11-06 18:21:10,221 [main] INFO  utils.BackgroundService (BackgroundService.java:shutdown(195)) - Shutting down service SCMBlockDeletingService
2025-11-06 18:21:10,221 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1699)) - Stopping SCM Event Queue.
2025-11-06 18:21:10,221 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1706)) - Stopping SCM HA services.
2025-11-06 18:21:10,221 [main] INFO  pipeline.BackgroundPipelineCreator (BackgroundPipelineCreator.java:stop(154)) - Stopping RatisPipelineUtilsThread.
2025-11-06 18:21:10,222 [RatisPipelineUtilsThread-0] WARN  pipeline.BackgroundPipelineCreator (BackgroundPipelineCreator.java:run(185)) - RatisPipelineUtilsThread is interrupted.
2025-11-06 18:21:10,222 [main] INFO  BackgroundPipelineScrubber (BackgroundSCMService.java:stop(127)) - Stopping BackgroundPipelineScrubber Service.
2025-11-06 18:21:10,222 [main] INFO  ExpiredContainerReplicaOpScrubber (BackgroundSCMService.java:stop(127)) - Stopping ExpiredContainerReplicaOpScrubber Service.
2025-11-06 18:21:10,222 [BackgroundPipelineScrubber] WARN  BackgroundPipelineScrubber (BackgroundSCMService.java:run(111)) - BackgroundPipelineScrubber is interrupted, exit
2025-11-06 18:21:10,222 [ExpiredContainerReplicaOpScrubber] WARN  ExpiredContainerReplicaOpScrubber (BackgroundSCMService.java:run(111)) - ExpiredContainerReplicaOpScrubber is interrupted, exit
2025-11-06 18:21:10,222 [main] INFO  utils.BackgroundService (BackgroundService.java:shutdown(195)) - Shutting down service SCMBlockDeletingService
2025-11-06 18:21:10,223 [main] INFO  replication.ReplicationManager (ReplicationManager.java:stop(325)) - Replication Monitor Thread is not running.
2025-11-06 18:21:10,223 [main] WARN  balancer.ContainerBalancer (ContainerBalancer.java:stop(362)) - Cannot stop Container Balancer because it's not running or stopping
2025-11-06 18:21:10,223 [test-leaseManagerLeaseManager#LeaseMonitor] WARN  lease.LeaseManager (LeaseManager.java:run(285)) - Lease manager is interrupted. Shutting down...
java.lang.InterruptedException
	at java.base/java.util.concurrent.locks.AbstractQueuedSynchronizer.tryAcquireSharedNanos(AbstractQueuedSynchronizer.java:1167)
	at java.base/java.util.concurrent.Semaphore.tryAcquire(Semaphore.java:415)
	at org.apache.hadoop.ozone.lease.LeaseManager$LeaseMonitor.run(LeaseManager.java:283)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-11-06 18:21:10,223 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1740)) - Stopping SCM MetadataStore.
2025-11-06 18:21:10,250 [main] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchemaFromFile(128)) - Loading schema from [jar:file:/home/runner/work/ozone/ozone/hadoop-hdds/common/target/hdds-common-2.2.0-SNAPSHOT.jar!/network-topology-default.xml]
2025-11-06 18:21:10,251 [main] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchema(175)) - Loading network topology layer schema file
2025-11-06 18:21:10,261 [main] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchemaFromFile(128)) - Loading schema from [jar:file:/home/runner/work/ozone/ozone/hadoop-hdds/common/target/hdds-common-2.2.0-SNAPSHOT.jar!/network-topology-default.xml]
2025-11-06 18:21:10,261 [main] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchema(175)) - Loading network topology layer schema file
2025-11-06 18:21:10,263 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(133)) - Added a new node: /default-rack/269afa60-442b-4273-964c-aa75621a7143
2025-11-06 18:21:10,263 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(133)) - Added a new node: /default-rack/76d3d7f3-38f2-4831-93bb-85c637f87706
2025-11-06 18:21:10,263 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(133)) - Added a new node: /default-rack/ec6ea205-5ec3-4087-b7b8-1f225157b09e
2025-11-06 18:21:10,263 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(133)) - Added a new node: /default-rack/020f186b-944a-4529-8626-f89378472003
2025-11-06 18:21:10,264 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(133)) - Added a new node: /default-rack/09d2cef9-d5b8-4991-a21b-faac1292add6
2025-11-06 18:21:10,264 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(133)) - Added a new node: /default-rack/286ae0b4-06c0-4df5-a244-ab2c07bd916d
2025-11-06 18:21:10,264 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(133)) - Added a new node: /default-rack/e32a3437-e9ec-4880-8bf0-be17e9f889a3
2025-11-06 18:21:10,264 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(133)) - Added a new node: /default-rack/5190beb3-7f4c-4dcc-8285-018e10b1f6fd
2025-11-06 18:21:10,264 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(133)) - Added a new node: /default-rack/10f17624-e445-4ea7-a162-f43b85328c1d
2025-11-06 18:21:10,265 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(133)) - Added a new node: /default-rack/5939016e-2fa2-48bf-afc4-85caeec9962a
2025-11-06 18:21:10,265 [main] WARN  utils.HAUtils (HAUtils.java:getMetaDir(311)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2025-11-06 18:21:10,265 [main] WARN  db.DBStoreBuilder (DBStoreBuilder.java:getDBDirPath(157)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2025-11-06 18:21:10,318 [main] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:<init>(231)) - Init the HA SequenceIdGenerator.
2025-11-06 18:21:10,318 [main] INFO  pipeline.PipelineStateManagerImpl (PipelineStateManagerImpl.java:initialize(75)) - No pipeline exists in current db
2025-11-06 18:21:10,319 [main] INFO  algorithms.LeaderChoosePolicyFactory (LeaderChoosePolicyFactory.java:getPolicy(55)) - Create leader choose policy of type org.apache.hadoop.hdds.scm.pipeline.leader.choose.algorithms.MinLeaderCountChoosePolicy
2025-11-06 18:21:10,319 [main] INFO  algorithms.ContainerPlacementPolicyFactory (ContainerPlacementPolicyFactory.java:getPolicyInternal(83)) - Create container placement policy of type org.apache.hadoop.hdds.scm.container.placement.algorithms.SCMContainerPlacementRackScatter
2025-11-06 18:21:10,319 [main] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service BackgroundPipelineCreator.
2025-11-06 18:21:10,320 [main] INFO  pipeline.BackgroundPipelineCreator (BackgroundPipelineCreator.java:start(126)) - Starting RatisPipelineUtilsThread.
2025-11-06 18:21:10,320 [main] INFO  BackgroundPipelineScrubber (BackgroundSCMService.java:start(64)) - Starting BackgroundPipelineScrubber Service.
2025-11-06 18:21:10,320 [main] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service BackgroundPipelineScrubber.
2025-11-06 18:21:10,321 [main] INFO  algorithms.LeaderChoosePolicyFactory (LeaderChoosePolicyFactory.java:getPolicy(55)) - Create leader choose policy of type org.apache.hadoop.hdds.scm.pipeline.leader.choose.algorithms.MinLeaderCountChoosePolicy
2025-11-06 18:21:10,322 [main] INFO  safemode.SCMSafeModeManager (AbstractContainerSafeModeRule.java:initializeRule(83)) - Refreshed RATIS Containers threshold count to 0.
2025-11-06 18:21:10,322 [main] INFO  safemode.SCMSafeModeManager (AbstractContainerSafeModeRule.java:initializeRule(83)) - Refreshed EC Containers threshold count to 0.
2025-11-06 18:21:10,322 [main] INFO  safemode.HealthyPipelineSafeModeRule (HealthyPipelineSafeModeRule.java:initializeRule(230)) - Total pipeline count is 0, healthy pipeline threshold count is 1
2025-11-06 18:21:10,323 [main] INFO  safemode.OneReplicaPipelineSafeModeRule (OneReplicaPipelineSafeModeRule.java:initializeRule(189)) - Total pipeline count is 0, pipeline's with at least one datanode reported threshold count is 0
2025-11-06 18:21:10,323 [main] INFO  safemode.SCMSafeModeManager (SCMSafeModeManager.java:<init>(102)) - Safemode is disabled, skipping Safemode rule validation and force exiting Safemode.
2025-11-06 18:21:10,323 [main] INFO  ha.SCMContext (SCMContext.java:updateSafeModeStatus(224)) - Update SafeModeStatus from SafeModeStatus{safeModeStatus=false, preCheckPassed=true} to SafeModeStatus{safeModeStatus=false, preCheckPassed=true}.
2025-11-06 18:21:10,324 [main] INFO  pipeline.BackgroundPipelineCreator (BackgroundPipelineCreator.java:notifyStatusChanged(268)) - Service BackgroundPipelineCreator transitions to RUNNING.
2025-11-06 18:21:10,324 [main] INFO  BackgroundPipelineScrubber (BackgroundSCMService.java:notifyStatusChanged(78)) - Service BackgroundPipelineScrubber transitions to RUNNING.
2025-11-06 18:21:10,324 [main] WARN  server.ServerUtils (ServerUtils.java:getScmDbDir(138)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2025-11-06 18:21:10,326 [main] WARN  server.ServerUtils (ServerUtils.java:getScmDbDir(138)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2025-11-06 18:21:10,326 [main] INFO  ha.SCMHANodeDetails (SCMHANodeDetails.java:loadSCMHAConfig(162)) - ServiceID for StorageContainerManager is null
2025-11-06 18:21:10,326 [main] INFO  ha.SCMHANodeDetails (SCMHANodeDetails.java:loadSCMHAConfig(166)) - ozone.scm.default.service.id is not defined, falling back to ozone.scm.service.ids to find serviceID for StorageContainerManager if it is HA enabled cluster
2025-11-06 18:21:10,327 [main] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchemaFromFile(128)) - Loading schema from [jar:file:/home/runner/work/ozone/ozone/hadoop-hdds/common/target/hdds-common-2.2.0-SNAPSHOT.jar!/network-topology-default.xml]
2025-11-06 18:21:10,328 [main] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchema(175)) - Loading network topology layer schema file
2025-11-06 18:21:10,329 [main] INFO  upgrade.AbstractLayoutVersionManager (AbstractLayoutVersionManager.java:init(80)) - Initializing Layout version manager with metadata layout = WITNESSED_CONTAINER_DB_PROTO_VALUE (version = 9), software layout = WITNESSED_CONTAINER_DB_PROTO_VALUE (version = 9)
2025-11-06 18:21:10,331 [main] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:upgradeToSequenceId(353)) - upgrade localId to 115816896921600000
2025-11-06 18:21:10,332 [main] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:upgradeToSequenceId(363)) - upgrade delTxnId to 0
2025-11-06 18:21:10,332 [main] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:upgradeToSequenceId(379)) - upgrade containerId to 0
2025-11-06 18:21:10,333 [main] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:upgradeToCertificateSequenceId(414)) - upgrade CertificateId to 2
2025-11-06 18:21:10,333 [main] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:<init>(231)) - Init the HA SequenceIdGenerator.
2025-11-06 18:21:10,333 [main] INFO  algorithms.ContainerPlacementPolicyFactory (ContainerPlacementPolicyFactory.java:getPolicyInternal(83)) - Create container placement policy of type org.apache.hadoop.hdds.scm.container.placement.algorithms.SCMContainerPlacementRackAware
2025-11-06 18:21:10,333 [main] INFO  algorithms.ContainerPlacementPolicyFactory (ContainerPlacementPolicyFactory.java:getPolicyInternal(83)) - Create container placement policy of type org.apache.hadoop.hdds.scm.container.placement.algorithms.SCMContainerPlacementRackScatter
2025-11-06 18:21:10,334 [main] INFO  ExpiredContainerReplicaOpScrubber (BackgroundSCMService.java:start(64)) - Starting ExpiredContainerReplicaOpScrubber Service.
2025-11-06 18:21:10,334 [main] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service ExpiredContainerReplicaOpScrubber.
2025-11-06 18:21:10,334 [main] INFO  algorithms.PipelineChoosePolicyFactory (PipelineChoosePolicyFactory.java:createPipelineChoosePolicyFromClass(78)) - Create pipeline choose policy of type org.apache.hadoop.hdds.scm.pipeline.choose.algorithms.RandomPipelineChoosePolicy
2025-11-06 18:21:10,335 [main] INFO  algorithms.PipelineChoosePolicyFactory (PipelineChoosePolicyFactory.java:createPipelineChoosePolicyFromClass(78)) - Create pipeline choose policy of type org.apache.hadoop.hdds.scm.pipeline.choose.algorithms.RandomPipelineChoosePolicy
2025-11-06 18:21:10,336 [main] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service SCMBlockDeletingService.
2025-11-06 18:21:10,337 [main] INFO  replication.ReplicationManager (ReplicationManager.java:start(287)) - Starting Replication Monitor Thread.
2025-11-06 18:21:10,337 [main] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service ReplicationManager.
2025-11-06 18:21:10,342 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:<init>(432)) - SCM start with adminUsers: [runner]
2025-11-06 18:21:10,343 [main] INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(93)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 10000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false, ipcFailOver: false.
2025-11-06 18:21:10,343 [main] INFO  ipc.Server (Server.java:<init>(1438)) - Listener at 0.0.0.0:37703
2025-11-06 18:21:10,343 [ReplicationMonitor] INFO  replication.ReplicationManager (ReplicationManager.java:processAll(359)) - Replication Manager is not ready to run until 300000ms after safemode exit
2025-11-06 18:21:10,344 [Socket Reader #1 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #1 for port 0
2025-11-06 18:21:10,345 [Socket Reader #2 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #2 for port 0
2025-11-06 18:21:10,346 [LeakDetector-ManagedRocksObject0] WARN  managed.ManagedRocksObjectUtils (HddsUtils.java:reportLeak(902)) - ManagedWriteBatch is not closed properly
2025-11-06 18:21:10,346 [LeakDetector-ManagedRocksObject0] WARN  managed.ManagedRocksObjectUtils (HddsUtils.java:reportLeak(902)) - ManagedWriteBatch is not closed properly
2025-11-06 18:21:10,346 [LeakDetector-ManagedRocksObject0] WARN  managed.ManagedRocksObjectUtils (HddsUtils.java:reportLeak(902)) - ManagedWriteBatch is not closed properly
2025-11-06 18:21:10,347 [Socket Reader #3 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #3 for port 0
2025-11-06 18:21:10,347 [Socket Reader #4 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #4 for port 0
2025-11-06 18:21:10,348 [Socket Reader #5 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #5 for port 0
2025-11-06 18:21:10,348 [Socket Reader #6 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #6 for port 0
2025-11-06 18:21:10,348 [Socket Reader #7 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #7 for port 0
2025-11-06 18:21:10,348 [Socket Reader #8 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #8 for port 0
2025-11-06 18:21:10,349 [Socket Reader #9 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #9 for port 0
2025-11-06 18:21:10,349 [Socket Reader #10 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #10 for port 0
2025-11-06 18:21:10,350 [main] INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(93)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 10000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false, ipcFailOver: false.
2025-11-06 18:21:10,351 [main] INFO  ipc.Server (Server.java:<init>(1438)) - Listener at 0.0.0.0:35413
2025-11-06 18:21:10,351 [Socket Reader #1 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #1 for port 0
2025-11-06 18:21:10,351 [Socket Reader #2 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #2 for port 0
2025-11-06 18:21:10,352 [Socket Reader #3 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #3 for port 0
2025-11-06 18:21:10,352 [Socket Reader #4 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #4 for port 0
2025-11-06 18:21:10,352 [Socket Reader #5 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #5 for port 0
2025-11-06 18:21:10,352 [Socket Reader #6 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #6 for port 0
2025-11-06 18:21:10,353 [Socket Reader #7 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #7 for port 0
2025-11-06 18:21:10,353 [Socket Reader #8 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #8 for port 0
2025-11-06 18:21:10,353 [Socket Reader #9 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #9 for port 0
2025-11-06 18:21:10,353 [Socket Reader #10 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #10 for port 0
2025-11-06 18:21:10,355 [main] INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(93)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 10000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false, ipcFailOver: false.
2025-11-06 18:21:10,355 [main] INFO  ipc.Server (Server.java:<init>(1438)) - Listener at 0.0.0.0:33421
2025-11-06 18:21:10,355 [Socket Reader #1 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #1 for port 0
2025-11-06 18:21:10,356 [Socket Reader #2 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #2 for port 0
2025-11-06 18:21:10,356 [Socket Reader #3 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #3 for port 0
2025-11-06 18:21:10,357 [Socket Reader #4 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #4 for port 0
2025-11-06 18:21:10,357 [Socket Reader #5 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #5 for port 0
2025-11-06 18:21:10,357 [Socket Reader #6 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #6 for port 0
2025-11-06 18:21:10,358 [Socket Reader #7 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #7 for port 0
2025-11-06 18:21:10,358 [Socket Reader #8 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #8 for port 0
2025-11-06 18:21:10,358 [Socket Reader #9 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #9 for port 0
2025-11-06 18:21:10,358 [Socket Reader #10 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #10 for port 0
2025-11-06 18:21:10,364 [main] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service ContainerBalancer.
2025-11-06 18:21:10,365 [main] INFO  ha.SCMContext (SCMContext.java:updateSafeModeStatus(224)) - Update SafeModeStatus from SafeModeStatus{safeModeStatus=false, preCheckPassed=true} to SafeModeStatus{safeModeStatus=false, preCheckPassed=true}.
2025-11-06 18:21:10,366 [main] INFO  ha.SCMContext (SCMContext.java:updateSafeModeStatus(224)) - Update SafeModeStatus from SafeModeStatus{safeModeStatus=false, preCheckPassed=true} to SafeModeStatus{safeModeStatus=false, preCheckPassed=true}.
2025-11-06 18:21:10,368 [main] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(208)) - Sending CreatePipelineCommand for pipeline:Pipeline-989e6dfc-0faa-45be-aa87-d857989de574 to datanode:5190beb3-7f4c-4dcc-8285-018e10b1f6fd(localhost-118.234.217.131/118.234.217.131)
2025-11-06 18:21:10,368 [main] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(208)) - Sending CreatePipelineCommand for pipeline:Pipeline-989e6dfc-0faa-45be-aa87-d857989de574 to datanode:e32a3437-e9ec-4880-8bf0-be17e9f889a3(localhost-183.157.111.191/183.157.111.191)
2025-11-06 18:21:10,369 [main] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(208)) - Sending CreatePipelineCommand for pipeline:Pipeline-989e6dfc-0faa-45be-aa87-d857989de574 to datanode:269afa60-442b-4273-964c-aa75621a7143(localhost-169.186.95.144/169.186.95.144)
2025-11-06 18:21:10,372 [pool-338-thread-1] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:getNextId(135)) - Allocate a batch for containerId, change lastId from 0 to 1000.
2025-11-06 18:21:10,374 [pool-338-thread-1] WARN  ha.SequenceIdGenerator (SequenceIdGenerator.java:allocateBatch(248)) - Failed to allocate a batch for localId, expected lastId is 0, actual lastId is 115816896921600000.
2025-11-06 18:21:10,375 [pool-338-thread-1] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:getNextId(135)) - Allocate a batch for localId, change lastId from 115816896921600000 to 115816896921601000.
2025-11-06 18:21:10,380 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1616)) - Container Balancer is not running.
2025-11-06 18:21:10,380 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stopReplicationManager(1749)) - Stopping Replication Manager Service.
2025-11-06 18:21:10,380 [main] INFO  replication.ReplicationManager (ReplicationManager.java:stop(318)) - Stopping Replication Monitor Thread.
2025-11-06 18:21:10,380 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1625)) - Stopping the Datanode Admin Monitor.
2025-11-06 18:21:10,380 [OverReplicatedProcessor] WARN  replication.UnhealthyReplicationProcessor (UnhealthyReplicationProcessor.java:run(178)) - OverReplicatedProcessor interrupted. Exiting...
2025-11-06 18:21:10,380 [UnderReplicatedProcessor] WARN  replication.UnhealthyReplicationProcessor (UnhealthyReplicationProcessor.java:run(178)) - UnderReplicatedProcessor interrupted. Exiting...
2025-11-06 18:21:10,380 [ReplicationMonitor] INFO  replication.ReplicationManager (ReplicationManager.java:run(938)) - Replication Monitor Thread is stopped
2025-11-06 18:21:10,380 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1632)) - Stopping datanode service RPC server
2025-11-06 18:21:10,381 [main] INFO  server.SCMDatanodeProtocolServer (SCMDatanodeProtocolServer.java:stop(455)) - Stopping the RPC server for DataNodes
2025-11-06 18:21:10,381 [main] INFO  ipc.Server (Server.java:stop(3697)) - Stopping server on 37703
2025-11-06 18:21:10,382 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1640)) - Stopping block service RPC server
2025-11-06 18:21:10,382 [main] INFO  server.SCMBlockProtocolServer (SCMBlockProtocolServer.java:stop(175)) - Stopping the RPC server for Block Protocol
2025-11-06 18:21:10,383 [main] INFO  ipc.Server (Server.java:stop(3697)) - Stopping server on 35413
2025-11-06 18:21:10,384 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1647)) - Stopping the StorageContainerLocationProtocol RPC server
2025-11-06 18:21:10,384 [main] INFO  server.SCMClientProtocolServer (SCMClientProtocolServer.java:stop(218)) - Stopping the RPC server for Client Protocol
2025-11-06 18:21:10,384 [main] INFO  ipc.Server (Server.java:stop(3697)) - Stopping server on 33421
2025-11-06 18:21:10,385 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1654)) - Stopping Storage Container Manager HTTP server.
2025-11-06 18:21:10,386 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1662)) - Stopping SCM LayoutVersionManager Service.
2025-11-06 18:21:10,386 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1674)) - Stopping Block Manager Service.
2025-11-06 18:21:10,386 [main] INFO  utils.BackgroundService (BackgroundService.java:shutdown(195)) - Shutting down service SCMBlockDeletingService
2025-11-06 18:21:10,386 [main] INFO  utils.BackgroundService (BackgroundService.java:shutdown(195)) - Shutting down service SCMBlockDeletingService
2025-11-06 18:21:10,386 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1699)) - Stopping SCM Event Queue.
2025-11-06 18:21:10,387 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1706)) - Stopping SCM HA services.
2025-11-06 18:21:10,387 [main] INFO  pipeline.BackgroundPipelineCreator (BackgroundPipelineCreator.java:stop(154)) - Stopping RatisPipelineUtilsThread.
2025-11-06 18:21:10,387 [RatisPipelineUtilsThread-0] WARN  pipeline.BackgroundPipelineCreator (BackgroundPipelineCreator.java:run(185)) - RatisPipelineUtilsThread is interrupted.
2025-11-06 18:21:10,387 [BackgroundPipelineScrubber] WARN  BackgroundPipelineScrubber (BackgroundSCMService.java:run(111)) - BackgroundPipelineScrubber is interrupted, exit
2025-11-06 18:21:10,387 [main] INFO  BackgroundPipelineScrubber (BackgroundSCMService.java:stop(127)) - Stopping BackgroundPipelineScrubber Service.
2025-11-06 18:21:10,388 [ExpiredContainerReplicaOpScrubber] WARN  ExpiredContainerReplicaOpScrubber (BackgroundSCMService.java:run(111)) - ExpiredContainerReplicaOpScrubber is interrupted, exit
2025-11-06 18:21:10,388 [main] INFO  ExpiredContainerReplicaOpScrubber (BackgroundSCMService.java:stop(127)) - Stopping ExpiredContainerReplicaOpScrubber Service.
2025-11-06 18:21:10,388 [main] INFO  utils.BackgroundService (BackgroundService.java:shutdown(195)) - Shutting down service SCMBlockDeletingService
2025-11-06 18:21:10,389 [main] INFO  replication.ReplicationManager (ReplicationManager.java:stop(325)) - Replication Monitor Thread is not running.
2025-11-06 18:21:10,389 [main] WARN  balancer.ContainerBalancer (ContainerBalancer.java:stop(362)) - Cannot stop Container Balancer because it's not running or stopping
2025-11-06 18:21:10,389 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1740)) - Stopping SCM MetadataStore.
2025-11-06 18:21:10,389 [test-leaseManagerLeaseManager#LeaseMonitor] WARN  lease.LeaseManager (LeaseManager.java:run(285)) - Lease manager is interrupted. Shutting down...
java.lang.InterruptedException
	at java.base/java.util.concurrent.locks.AbstractQueuedSynchronizer.tryAcquireSharedNanos(AbstractQueuedSynchronizer.java:1167)
	at java.base/java.util.concurrent.Semaphore.tryAcquire(Semaphore.java:415)
	at org.apache.hadoop.ozone.lease.LeaseManager$LeaseMonitor.run(LeaseManager.java:283)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-11-06 18:21:10,425 [main] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchemaFromFile(128)) - Loading schema from [jar:file:/home/runner/work/ozone/ozone/hadoop-hdds/common/target/hdds-common-2.2.0-SNAPSHOT.jar!/network-topology-default.xml]
2025-11-06 18:21:10,426 [main] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchema(175)) - Loading network topology layer schema file
2025-11-06 18:21:10,439 [main] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchemaFromFile(128)) - Loading schema from [jar:file:/home/runner/work/ozone/ozone/hadoop-hdds/common/target/hdds-common-2.2.0-SNAPSHOT.jar!/network-topology-default.xml]
2025-11-06 18:21:10,440 [main] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchema(175)) - Loading network topology layer schema file
2025-11-06 18:21:10,441 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(133)) - Added a new node: /default-rack/80021e56-af19-4b0b-9ee4-2f686c1a1ca2
2025-11-06 18:21:10,441 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(133)) - Added a new node: /default-rack/2c97a72f-cef1-4566-9096-69e46c5931cc
2025-11-06 18:21:10,441 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(133)) - Added a new node: /default-rack/cb833c4e-d855-4c98-924d-057f6bbb231b
2025-11-06 18:21:10,442 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(133)) - Added a new node: /default-rack/fc20b8f4-5bae-4b3c-8baf-8e77beb5811a
2025-11-06 18:21:10,442 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(133)) - Added a new node: /default-rack/f4133ac6-ce48-4d80-baf5-f4f9d58a6259
2025-11-06 18:21:10,442 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(133)) - Added a new node: /default-rack/767c572a-6cd5-450a-9f39-c110fdb38210
2025-11-06 18:21:10,442 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(133)) - Added a new node: /default-rack/a25212d8-609f-48da-a300-ffa1c9e39695
2025-11-06 18:21:10,442 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(133)) - Added a new node: /default-rack/f58e37a1-7fcd-4aa7-94d8-b45ae1b7b077
2025-11-06 18:21:10,443 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(133)) - Added a new node: /default-rack/38b18494-bb07-4d91-83c8-64c7c3b1a228
2025-11-06 18:21:10,443 [main] INFO  net.NetworkTopologyImpl (NetworkTopologyImpl.java:add(133)) - Added a new node: /default-rack/e6522af1-d3a3-42ef-8d5a-6b19e274e182
2025-11-06 18:21:10,443 [main] WARN  utils.HAUtils (HAUtils.java:getMetaDir(311)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2025-11-06 18:21:10,443 [main] WARN  db.DBStoreBuilder (DBStoreBuilder.java:getDBDirPath(157)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2025-11-06 18:21:10,490 [main] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:<init>(231)) - Init the HA SequenceIdGenerator.
2025-11-06 18:21:10,491 [main] INFO  pipeline.PipelineStateManagerImpl (PipelineStateManagerImpl.java:initialize(75)) - No pipeline exists in current db
2025-11-06 18:21:10,491 [main] INFO  algorithms.LeaderChoosePolicyFactory (LeaderChoosePolicyFactory.java:getPolicy(55)) - Create leader choose policy of type org.apache.hadoop.hdds.scm.pipeline.leader.choose.algorithms.MinLeaderCountChoosePolicy
2025-11-06 18:21:10,491 [main] INFO  algorithms.ContainerPlacementPolicyFactory (ContainerPlacementPolicyFactory.java:getPolicyInternal(83)) - Create container placement policy of type org.apache.hadoop.hdds.scm.container.placement.algorithms.SCMContainerPlacementRackScatter
2025-11-06 18:21:10,492 [main] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service BackgroundPipelineCreator.
2025-11-06 18:21:10,492 [main] INFO  pipeline.BackgroundPipelineCreator (BackgroundPipelineCreator.java:start(126)) - Starting RatisPipelineUtilsThread.
2025-11-06 18:21:10,492 [main] INFO  BackgroundPipelineScrubber (BackgroundSCMService.java:start(64)) - Starting BackgroundPipelineScrubber Service.
2025-11-06 18:21:10,493 [main] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service BackgroundPipelineScrubber.
2025-11-06 18:21:10,493 [main] INFO  algorithms.LeaderChoosePolicyFactory (LeaderChoosePolicyFactory.java:getPolicy(55)) - Create leader choose policy of type org.apache.hadoop.hdds.scm.pipeline.leader.choose.algorithms.MinLeaderCountChoosePolicy
2025-11-06 18:21:10,494 [main] INFO  safemode.SCMSafeModeManager (AbstractContainerSafeModeRule.java:initializeRule(83)) - Refreshed RATIS Containers threshold count to 0.
2025-11-06 18:21:10,494 [main] INFO  safemode.SCMSafeModeManager (AbstractContainerSafeModeRule.java:initializeRule(83)) - Refreshed EC Containers threshold count to 0.
2025-11-06 18:21:10,494 [main] INFO  safemode.HealthyPipelineSafeModeRule (HealthyPipelineSafeModeRule.java:initializeRule(230)) - Total pipeline count is 0, healthy pipeline threshold count is 1
2025-11-06 18:21:10,495 [main] INFO  safemode.OneReplicaPipelineSafeModeRule (OneReplicaPipelineSafeModeRule.java:initializeRule(189)) - Total pipeline count is 0, pipeline's with at least one datanode reported threshold count is 0
2025-11-06 18:21:10,495 [main] INFO  safemode.SCMSafeModeManager (SCMSafeModeManager.java:<init>(102)) - Safemode is disabled, skipping Safemode rule validation and force exiting Safemode.
2025-11-06 18:21:10,495 [main] INFO  ha.SCMContext (SCMContext.java:updateSafeModeStatus(224)) - Update SafeModeStatus from SafeModeStatus{safeModeStatus=false, preCheckPassed=true} to SafeModeStatus{safeModeStatus=false, preCheckPassed=true}.
2025-11-06 18:21:10,495 [main] INFO  pipeline.BackgroundPipelineCreator (BackgroundPipelineCreator.java:notifyStatusChanged(268)) - Service BackgroundPipelineCreator transitions to RUNNING.
2025-11-06 18:21:10,495 [main] INFO  BackgroundPipelineScrubber (BackgroundSCMService.java:notifyStatusChanged(78)) - Service BackgroundPipelineScrubber transitions to RUNNING.
2025-11-06 18:21:10,495 [main] WARN  server.ServerUtils (ServerUtils.java:getScmDbDir(138)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2025-11-06 18:21:10,497 [main] WARN  server.ServerUtils (ServerUtils.java:getScmDbDir(138)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2025-11-06 18:21:10,497 [main] INFO  ha.SCMHANodeDetails (SCMHANodeDetails.java:loadSCMHAConfig(162)) - ServiceID for StorageContainerManager is null
2025-11-06 18:21:10,497 [main] INFO  ha.SCMHANodeDetails (SCMHANodeDetails.java:loadSCMHAConfig(166)) - ozone.scm.default.service.id is not defined, falling back to ozone.scm.service.ids to find serviceID for StorageContainerManager if it is HA enabled cluster
2025-11-06 18:21:10,498 [main] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchemaFromFile(128)) - Loading schema from [jar:file:/home/runner/work/ozone/ozone/hadoop-hdds/common/target/hdds-common-2.2.0-SNAPSHOT.jar!/network-topology-default.xml]
2025-11-06 18:21:10,498 [main] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchema(175)) - Loading network topology layer schema file
2025-11-06 18:21:10,500 [main] INFO  upgrade.AbstractLayoutVersionManager (AbstractLayoutVersionManager.java:init(80)) - Initializing Layout version manager with metadata layout = WITNESSED_CONTAINER_DB_PROTO_VALUE (version = 9), software layout = WITNESSED_CONTAINER_DB_PROTO_VALUE (version = 9)
2025-11-06 18:21:10,501 [main] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:upgradeToSequenceId(353)) - upgrade localId to 115816896921600000
2025-11-06 18:21:10,501 [main] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:upgradeToSequenceId(363)) - upgrade delTxnId to 0
2025-11-06 18:21:10,502 [main] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:upgradeToSequenceId(379)) - upgrade containerId to 0
2025-11-06 18:21:10,502 [main] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:upgradeToCertificateSequenceId(414)) - upgrade CertificateId to 2
2025-11-06 18:21:10,502 [main] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:<init>(231)) - Init the HA SequenceIdGenerator.
2025-11-06 18:21:10,503 [main] INFO  algorithms.ContainerPlacementPolicyFactory (ContainerPlacementPolicyFactory.java:getPolicyInternal(83)) - Create container placement policy of type org.apache.hadoop.hdds.scm.container.placement.algorithms.SCMContainerPlacementRackAware
2025-11-06 18:21:10,503 [main] INFO  algorithms.ContainerPlacementPolicyFactory (ContainerPlacementPolicyFactory.java:getPolicyInternal(83)) - Create container placement policy of type org.apache.hadoop.hdds.scm.container.placement.algorithms.SCMContainerPlacementRackScatter
2025-11-06 18:21:10,503 [main] INFO  ExpiredContainerReplicaOpScrubber (BackgroundSCMService.java:start(64)) - Starting ExpiredContainerReplicaOpScrubber Service.
2025-11-06 18:21:10,504 [main] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service ExpiredContainerReplicaOpScrubber.
2025-11-06 18:21:10,504 [main] INFO  algorithms.PipelineChoosePolicyFactory (PipelineChoosePolicyFactory.java:createPipelineChoosePolicyFromClass(78)) - Create pipeline choose policy of type org.apache.hadoop.hdds.scm.pipeline.choose.algorithms.RandomPipelineChoosePolicy
2025-11-06 18:21:10,505 [main] INFO  algorithms.PipelineChoosePolicyFactory (PipelineChoosePolicyFactory.java:createPipelineChoosePolicyFromClass(78)) - Create pipeline choose policy of type org.apache.hadoop.hdds.scm.pipeline.choose.algorithms.RandomPipelineChoosePolicy
2025-11-06 18:21:10,506 [main] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service SCMBlockDeletingService.
2025-11-06 18:21:10,506 [main] INFO  replication.ReplicationManager (ReplicationManager.java:start(287)) - Starting Replication Monitor Thread.
2025-11-06 18:21:10,507 [main] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service ReplicationManager.
2025-11-06 18:21:10,507 [ReplicationMonitor] INFO  replication.ReplicationManager (ReplicationManager.java:processAll(359)) - Replication Manager is not ready to run until 300000ms after safemode exit
2025-11-06 18:21:10,508 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:<init>(432)) - SCM start with adminUsers: [runner]
2025-11-06 18:21:10,508 [main] INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(93)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 10000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false, ipcFailOver: false.
2025-11-06 18:21:10,508 [main] INFO  ipc.Server (Server.java:<init>(1438)) - Listener at 0.0.0.0:34407
2025-11-06 18:21:10,509 [Socket Reader #1 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #1 for port 0
2025-11-06 18:21:10,509 [Socket Reader #2 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #2 for port 0
2025-11-06 18:21:10,509 [Socket Reader #3 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #3 for port 0
2025-11-06 18:21:10,509 [Socket Reader #4 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #4 for port 0
2025-11-06 18:21:10,510 [Socket Reader #5 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #5 for port 0
2025-11-06 18:21:10,510 [Socket Reader #6 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #6 for port 0
2025-11-06 18:21:10,510 [Socket Reader #7 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #7 for port 0
2025-11-06 18:21:10,511 [Socket Reader #8 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #8 for port 0
2025-11-06 18:21:10,511 [Socket Reader #9 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #9 for port 0
2025-11-06 18:21:10,511 [Socket Reader #10 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #10 for port 0
2025-11-06 18:21:10,513 [main] INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(93)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 10000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false, ipcFailOver: false.
2025-11-06 18:21:10,513 [main] INFO  ipc.Server (Server.java:<init>(1438)) - Listener at 0.0.0.0:40433
2025-11-06 18:21:10,514 [Socket Reader #1 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #1 for port 0
2025-11-06 18:21:10,514 [Socket Reader #2 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #2 for port 0
2025-11-06 18:21:10,514 [Socket Reader #3 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #3 for port 0
2025-11-06 18:21:10,514 [Socket Reader #4 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #4 for port 0
2025-11-06 18:21:10,514 [Socket Reader #5 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #5 for port 0
2025-11-06 18:21:10,515 [Socket Reader #6 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #6 for port 0
2025-11-06 18:21:10,515 [Socket Reader #7 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #7 for port 0
2025-11-06 18:21:10,515 [Socket Reader #8 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #8 for port 0
2025-11-06 18:21:10,515 [Socket Reader #9 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #9 for port 0
2025-11-06 18:21:10,516 [Socket Reader #10 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #10 for port 0
2025-11-06 18:21:10,517 [main] INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(93)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 10000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false, ipcFailOver: false.
2025-11-06 18:21:10,517 [main] INFO  ipc.Server (Server.java:<init>(1438)) - Listener at 0.0.0.0:46613
2025-11-06 18:21:10,518 [Socket Reader #1 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #1 for port 0
2025-11-06 18:21:10,518 [Socket Reader #2 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #2 for port 0
2025-11-06 18:21:10,518 [Socket Reader #3 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #3 for port 0
2025-11-06 18:21:10,519 [Socket Reader #4 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #4 for port 0
2025-11-06 18:21:10,519 [Socket Reader #6 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #6 for port 0
2025-11-06 18:21:10,519 [Socket Reader #7 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #7 for port 0
2025-11-06 18:21:10,520 [Socket Reader #8 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #8 for port 0
2025-11-06 18:21:10,520 [Socket Reader #5 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #5 for port 0
2025-11-06 18:21:10,520 [Socket Reader #9 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #9 for port 0
2025-11-06 18:21:10,520 [Socket Reader #10 for port 0] INFO  ipc.Server (Server.java:run(1474)) - Starting Socket Reader #10 for port 0
2025-11-06 18:21:10,524 [main] INFO  ha.SCMServiceManager (SCMServiceManager.java:register(42)) - Registering service ContainerBalancer.
2025-11-06 18:21:10,524 [main] INFO  ha.SCMContext (SCMContext.java:updateSafeModeStatus(224)) - Update SafeModeStatus from SafeModeStatus{safeModeStatus=false, preCheckPassed=true} to SafeModeStatus{safeModeStatus=false, preCheckPassed=true}.
2025-11-06 18:21:10,525 [main] INFO  ha.SCMContext (SCMContext.java:updateSafeModeStatus(224)) - Update SafeModeStatus from SafeModeStatus{safeModeStatus=false, preCheckPassed=true} to SafeModeStatus{safeModeStatus=false, preCheckPassed=true}.
2025-11-06 18:21:10,527 [main] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(208)) - Sending CreatePipelineCommand for pipeline:Pipeline-ffb48906-cb7a-4d38-bd1f-bbc54f838bcb to datanode:80021e56-af19-4b0b-9ee4-2f686c1a1ca2(localhost-46.93.103.220/46.93.103.220)
2025-11-06 18:21:10,527 [main] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(208)) - Sending CreatePipelineCommand for pipeline:Pipeline-ffb48906-cb7a-4d38-bd1f-bbc54f838bcb to datanode:f4133ac6-ce48-4d80-baf5-f4f9d58a6259(localhost-80.252.91.69/80.252.91.69)
2025-11-06 18:21:10,527 [main] INFO  pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$create$0(208)) - Sending CreatePipelineCommand for pipeline:Pipeline-ffb48906-cb7a-4d38-bd1f-bbc54f838bcb to datanode:767c572a-6cd5-450a-9f39-c110fdb38210(localhost-168.13.160.171/168.13.160.171)
2025-11-06 18:21:10,630 [main] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:getNextId(135)) - Allocate a batch for containerId, change lastId from 0 to 1000.
2025-11-06 18:21:10,631 [main] WARN  ha.SequenceIdGenerator (SequenceIdGenerator.java:allocateBatch(248)) - Failed to allocate a batch for localId, expected lastId is 0, actual lastId is 115816896921600000.
2025-11-06 18:21:10,631 [main] INFO  ha.SequenceIdGenerator (SequenceIdGenerator.java:getNextId(135)) - Allocate a batch for localId, change lastId from 115816896921600000 to 115816896921601000.
2025-11-06 18:21:10,632 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1616)) - Container Balancer is not running.
2025-11-06 18:21:10,632 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stopReplicationManager(1749)) - Stopping Replication Manager Service.
2025-11-06 18:21:10,632 [main] INFO  replication.ReplicationManager (ReplicationManager.java:stop(318)) - Stopping Replication Monitor Thread.
2025-11-06 18:21:10,632 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1625)) - Stopping the Datanode Admin Monitor.
2025-11-06 18:21:10,632 [UnderReplicatedProcessor] WARN  replication.UnhealthyReplicationProcessor (UnhealthyReplicationProcessor.java:run(178)) - UnderReplicatedProcessor interrupted. Exiting...
2025-11-06 18:21:10,632 [ReplicationMonitor] INFO  replication.ReplicationManager (ReplicationManager.java:run(938)) - Replication Monitor Thread is stopped
2025-11-06 18:21:10,632 [OverReplicatedProcessor] WARN  replication.UnhealthyReplicationProcessor (UnhealthyReplicationProcessor.java:run(178)) - OverReplicatedProcessor interrupted. Exiting...
2025-11-06 18:21:10,632 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1632)) - Stopping datanode service RPC server
2025-11-06 18:21:10,633 [main] INFO  server.SCMDatanodeProtocolServer (SCMDatanodeProtocolServer.java:stop(455)) - Stopping the RPC server for DataNodes
2025-11-06 18:21:10,633 [main] INFO  ipc.Server (Server.java:stop(3697)) - Stopping server on 34407
2025-11-06 18:21:10,634 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1640)) - Stopping block service RPC server
2025-11-06 18:21:10,634 [main] INFO  server.SCMBlockProtocolServer (SCMBlockProtocolServer.java:stop(175)) - Stopping the RPC server for Block Protocol
2025-11-06 18:21:10,634 [main] INFO  ipc.Server (Server.java:stop(3697)) - Stopping server on 40433
2025-11-06 18:21:10,635 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1647)) - Stopping the StorageContainerLocationProtocol RPC server
2025-11-06 18:21:10,636 [main] INFO  server.SCMClientProtocolServer (SCMClientProtocolServer.java:stop(218)) - Stopping the RPC server for Client Protocol
2025-11-06 18:21:10,636 [main] INFO  ipc.Server (Server.java:stop(3697)) - Stopping server on 46613
2025-11-06 18:21:10,637 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1654)) - Stopping Storage Container Manager HTTP server.
2025-11-06 18:21:10,637 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1662)) - Stopping SCM LayoutVersionManager Service.
2025-11-06 18:21:10,637 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1674)) - Stopping Block Manager Service.
2025-11-06 18:21:10,637 [main] INFO  utils.BackgroundService (BackgroundService.java:shutdown(195)) - Shutting down service SCMBlockDeletingService
2025-11-06 18:21:10,637 [main] INFO  utils.BackgroundService (BackgroundService.java:shutdown(195)) - Shutting down service SCMBlockDeletingService
2025-11-06 18:21:10,637 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1699)) - Stopping SCM Event Queue.
2025-11-06 18:21:10,637 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1706)) - Stopping SCM HA services.
2025-11-06 18:21:10,638 [main] INFO  pipeline.BackgroundPipelineCreator (BackgroundPipelineCreator.java:stop(154)) - Stopping RatisPipelineUtilsThread.
2025-11-06 18:21:10,638 [RatisPipelineUtilsThread-0] WARN  pipeline.BackgroundPipelineCreator (BackgroundPipelineCreator.java:run(185)) - RatisPipelineUtilsThread is interrupted.
2025-11-06 18:21:10,638 [main] INFO  BackgroundPipelineScrubber (BackgroundSCMService.java:stop(127)) - Stopping BackgroundPipelineScrubber Service.
2025-11-06 18:21:10,638 [BackgroundPipelineScrubber] WARN  BackgroundPipelineScrubber (BackgroundSCMService.java:run(111)) - BackgroundPipelineScrubber is interrupted, exit
2025-11-06 18:21:10,638 [main] INFO  ExpiredContainerReplicaOpScrubber (BackgroundSCMService.java:stop(127)) - Stopping ExpiredContainerReplicaOpScrubber Service.
2025-11-06 18:21:10,638 [ExpiredContainerReplicaOpScrubber] WARN  ExpiredContainerReplicaOpScrubber (BackgroundSCMService.java:run(111)) - ExpiredContainerReplicaOpScrubber is interrupted, exit
2025-11-06 18:21:10,638 [main] INFO  utils.BackgroundService (BackgroundService.java:shutdown(195)) - Shutting down service SCMBlockDeletingService
2025-11-06 18:21:10,638 [main] INFO  replication.ReplicationManager (ReplicationManager.java:stop(325)) - Replication Monitor Thread is not running.
2025-11-06 18:21:10,638 [main] WARN  balancer.ContainerBalancer (ContainerBalancer.java:stop(362)) - Cannot stop Container Balancer because it's not running or stopping
2025-11-06 18:21:10,639 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:stop(1740)) - Stopping SCM MetadataStore.
2025-11-06 18:21:10,639 [test-leaseManagerLeaseManager#LeaseMonitor] WARN  lease.LeaseManager (LeaseManager.java:run(285)) - Lease manager is interrupted. Shutting down...
java.lang.InterruptedException
	at java.base/java.util.concurrent.locks.AbstractQueuedSynchronizer.tryAcquireSharedNanos(AbstractQueuedSynchronizer.java:1167)
	at java.base/java.util.concurrent.Semaphore.tryAcquire(Semaphore.java:415)
	at org.apache.hadoop.ozone.lease.LeaseManager$LeaseMonitor.run(LeaseManager.java:283)
	at java.base/java.lang.Thread.run(Thread.java:1583)
